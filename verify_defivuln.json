[{"findings":[{"id": "c2fa7005fa4a", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(true);", "highlightLines": [8]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/demo/demo.sol", "line": 8, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "403aac588ea8", "fix": {"template": null, "available": false}, "title": "address(this) directly in emit - likely wrong address (should use token/handler variable)", "ruleId": "rules.sol-emit-address-this", "snippet": {"code": "        emit log_named_address(\"address\", address(this));", "highlightLines": [21]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/demo/demo.sol", "line": 21, "column": 9}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "ddaa3335ce7e", "fix": {"template": null, "available": false}, "title": "address(this) emitted in event - may emit wrong address (handler vs token confusion)", "ruleId": "rules.sol-address-this-in-event", "snippet": {"code": "        emit log_named_address(\"address\", address(this));", "highlightLines": [21]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/demo/demo.sol", "line": 21, "column": 9}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "c1753b241c33", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event log_old_named_uint(bytes32,uint);", "highlightLines": [38]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/demo/demo.sol", "line": 38, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "2c76d1292dd7", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [68]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/demo/demo.sol", "line": 68, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "8b5b1d308ddf", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        string memory err = \"this test has failed!\";\n        emit log(\"## assertTrue(bool)\\n\");\n        assertTrue(false);\n        emit log(\"\\n\");\n        assertTrue(false, err);\n\n        emit log(\"\\n## assertEq(address,address)\\n\");\n        assertEq(address(this), msg.sender);\n        emit log(\"\\n\");\n        assertEq(address(this), msg.sender, err);\n\n        emit log(\"\\n## assertEq32(bytes32,bytes32)\\n\");\n        assertEq32(\"bytes 1\", \"bytes 2\");\n        emit log(\"\\n\");\n        assertEq32(\"bytes 1\", \"bytes 2\", err);\n\n        emit log(\"\\n## assertEq(bytes32,bytes32)\\n\");\n        assertEq32(\"bytes 1\", \"bytes 2\");\n        emit log(\"\\n\");\n        assertEq32(\"bytes 1\", \"bytes 2\", err);\n\n        emit log(\"\\n## assertEq(uint,uint)\\n\");\n        assertEq(uint(0), 1);\n        emit log(\"\\n\");\n        assertEq(uint(0), 1, err);\n\n        emit log(\"\\n## assertEq(int,int)\\n\");\n        assertEq(-1, -2);\n        emit log(\"\\n\");\n        assertEq(-1, -2, err);\n\n        emit log(\"\\n## assertEqDecimal(int,int,uint)\\n\");\n        assertEqDecimal(-1.0e18, -1.1e18, 18);\n        emit log(\"\\n\");\n        assertEqDecimal(-1.0e18, -1.1e18, 18, err);\n\n        emit log(\"\\n## assertEqDecimal(uint,uint,uint)\\n\");\n        assertEqDecimal(uint(1.0e18), 1.1e18, 18);\n        emit log(\"\\n\");\n        assertEqDecimal(uint(1.0e18), 1.1e18, 18, err);\n\n        emit log(\"\\n## assertGt(uint,uint)\\n\");\n        assertGt(uint(0), 0);\n        emit log(\"\\n\");\n        assertGt(uint(0), 0, err);\n\n        emit log(\"\\n## assertGt(int,int)\\n\");\n        assertGt(-1, -1);\n        emit log(\"\\n\");\n        assertGt(-1, -1, err);\n\n        emit log(\"\\n## assertGtDecimal(int,int,uint)\\n\");\n        assertGtDecimal(-2.0e18, -1.1e18, 18);\n        emit log(\"\\n\");\n        assertGtDecimal(-2.0e18, -1.1e18, 18, err);\n\n        emit log(\"\\n## assertGtDecimal(uint,uint,uint)\\n\");\n        assertGtDecimal(uint(1.0e18), 1.1e18, 18);\n        emit log(\"\\n\");\n        assertGtDecimal(uint(1.0e18), 1.1e18, 18, err);\n\n        emit log(\"\\n## assertGe(uint,uint)\\n\");\n        assertGe(uint(0), 1);\n        emit log(\"\\n\");\n        assertGe(uint(0), 1, err);\n\n        emit log(\"\\n## assertGe(int,int)\\n\");\n        assertGe(-1, 0);\n        emit log(\"\\n\");\n        assertGe(-1, 0, err);\n\n        emit log(\"\\n## assertGeDecimal(int,int,uint)\\n\");\n        assertGeDecimal(-2.0e18, -1.1e18, 18);\n        emit log(\"\\n\");\n        assertGeDecimal(-2.0e18, -1.1e18, 18, err);\n\n        emit log(\"\\n## assertGeDecimal(uint,uint,uint)\\n\");\n        assertGeDecimal(uint(1.0e18), 1.1e18, 18);\n        emit log(\"\\n\");\n        assertGeDecimal(uint(1.0e18), 1.1e18, 18, err);\n\n        emit log(\"\\n## assertLt(uint,uint)\\n\");\n        assertLt(uint(0), 0);\n        emit log(\"\\n\");\n        assertLt(uint(0), 0, err);\n\n        emit log(\"\\n## assertLt(int,int)\\n\");\n        assertLt(-1, -1);\n        emit log(\"\\n\");\n        assertLt(-1, -1, err);\n\n        emit log(\"\\n## assertLtDecimal(int,int,uint)\\n\");\n        assertLtDecimal(-1.0e18, -1.1e18, 18);\n        emit log(\"\\n\");\n        assertLtDecimal(-1.0e18, -1.1e18, 18, err);\n\n        emit log(\"\\n## assertLtDecimal(uint,uint,uint)\\n\");\n        assertLtDecimal(uint(2.0e18), 1.1e18, 18);\n        emit log(\"\\n\");\n        assertLtDecimal(uint(2.0e18), 1.1e18, 18, err);\n\n        emit log(\"\\n## assertLe(uint,uint)\\n\");\n        assertLe(uint(1), 0);\n        emit log(\"\\n\");\n        assertLe(uint(1), 0, err);\n\n        emit log(\"\\n## assertLe(int,int)\\n\");\n        assertLe(0, -1);\n        emit log(\"\\n\");\n        assertLe(0, -1, err);\n\n        emit log(\"\\n## assertLeDecimal(int,int,uint)\\n\");\n        assertLeDecimal(-1.0e18, -1.1e18, 18);\n        emit log(\"\\n\");\n        assertLeDecimal(-1.0e18, -1.1e18, 18, err);\n\n        emit log(\"\\n## assertLeDecimal(uint,uint,uint)\\n\");\n        assertLeDecimal(uint(2.0e18), 1.1e18, 18);\n        emit log(\"\\n\");\n        assertLeDecimal(uint(2.0e18), 1.1e18, 18, err);\n\n        emit log(\"\\n## assertEq(string,string)\\n\");\n        string memory s1 = \"string 1\";", "highlightLines": [82]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/demo/demo.sol", "line": 82, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "b6baa1aad5c6", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "        assertEq(uint(0), 1);", "highlightLines": [104]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/demo/demo.sol", "line": 104, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "67deda22b0b3", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "        assertEq(uint(0), 1, err);", "highlightLines": [106]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/demo/demo.sol", "line": 106, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "2b3a5b07d95b", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        assertEqDecimal(-1.0e18, -1.1e18, 18);", "highlightLines": [114]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/demo/demo.sol", "line": 114, "column": 37}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "aa24b8a4b37f", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        assertEqDecimal(-1.0e18, -1.1e18, 18, err);", "highlightLines": [116]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/demo/demo.sol", "line": 116, "column": 37}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "57afe7b6cf48", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "        assertEqDecimal(uint(1.0e18), 1.1e18, 18);", "highlightLines": [119]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/demo/demo.sol", "line": 119, "column": 25}, "severity": "info", "references": [], "description": ""}, {"id": "aabbc2c7157b", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        assertEqDecimal(uint(1.0e18), 1.1e18, 18);", "highlightLines": [119]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/demo/demo.sol", "line": 119, "column": 41}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "52a52500e34f", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "        assertEqDecimal(uint(1.0e18), 1.1e18, 18, err);", "highlightLines": [121]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/demo/demo.sol", "line": 121, "column": 25}, "severity": "info", "references": [], "description": ""}, {"id": "e265b7fb7f6e", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        assertEqDecimal(uint(1.0e18), 1.1e18, 18, err);", "highlightLines": [121]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/demo/demo.sol", "line": 121, "column": 41}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "721b2ea3ba2f", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "        assertGt(uint(0), 0);", "highlightLines": [124]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/demo/demo.sol", "line": 124, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "2ff964e0a610", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "        assertGt(uint(0), 0, err);", "highlightLines": [126]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/demo/demo.sol", "line": 126, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "e73ca37f8f5f", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        assertGtDecimal(-2.0e18, -1.1e18, 18);", "highlightLines": [134]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/demo/demo.sol", "line": 134, "column": 37}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "40ef80f0d4e4", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        assertGtDecimal(-2.0e18, -1.1e18, 18, err);", "highlightLines": [136]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/demo/demo.sol", "line": 136, "column": 37}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "993ed4c3cd35", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "        assertGtDecimal(uint(1.0e18), 1.1e18, 18);", "highlightLines": [139]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/demo/demo.sol", "line": 139, "column": 25}, "severity": "info", "references": [], "description": ""}, {"id": "ef0d455ad92a", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        assertGtDecimal(uint(1.0e18), 1.1e18, 18);", "highlightLines": [139]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/demo/demo.sol", "line": 139, "column": 41}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "789f4ab8bb66", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "        assertGtDecimal(uint(1.0e18), 1.1e18, 18, err);", "highlightLines": [141]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/demo/demo.sol", "line": 141, "column": 25}, "severity": "info", "references": [], "description": ""}, {"id": "45420404f423", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        assertGtDecimal(uint(1.0e18), 1.1e18, 18, err);", "highlightLines": [141]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/demo/demo.sol", "line": 141, "column": 41}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "8dd9f83c4dc8", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "        assertGe(uint(0), 1);", "highlightLines": [144]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/demo/demo.sol", "line": 144, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "215be05d5bf0", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "        assertGe(uint(0), 1, err);", "highlightLines": [146]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/demo/demo.sol", "line": 146, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "d05752262730", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        assertGeDecimal(-2.0e18, -1.1e18, 18);", "highlightLines": [154]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/demo/demo.sol", "line": 154, "column": 37}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "7691531d54d7", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        assertGeDecimal(-2.0e18, -1.1e18, 18, err);", "highlightLines": [156]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/demo/demo.sol", "line": 156, "column": 37}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "cc7f0c08515b", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "        assertGeDecimal(uint(1.0e18), 1.1e18, 18);", "highlightLines": [159]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/demo/demo.sol", "line": 159, "column": 25}, "severity": "info", "references": [], "description": ""}, {"id": "26098be09f31", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        assertGeDecimal(uint(1.0e18), 1.1e18, 18);", "highlightLines": [159]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/demo/demo.sol", "line": 159, "column": 41}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "7a48f9fb4ccb", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "        assertGeDecimal(uint(1.0e18), 1.1e18, 18, err);", "highlightLines": [161]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/demo/demo.sol", "line": 161, "column": 25}, "severity": "info", "references": [], "description": ""}, {"id": "e4e81e8bb232", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        assertGeDecimal(uint(1.0e18), 1.1e18, 18, err);", "highlightLines": [161]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/demo/demo.sol", "line": 161, "column": 41}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "bdfe959f7b16", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "        assertLt(uint(0), 0);", "highlightLines": [164]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/demo/demo.sol", "line": 164, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "2a371f3a9837", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "        assertLt(uint(0), 0, err);", "highlightLines": [166]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/demo/demo.sol", "line": 166, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "dd1fa059b85c", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        assertLtDecimal(-1.0e18, -1.1e18, 18);", "highlightLines": [174]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/demo/demo.sol", "line": 174, "column": 37}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "e775e251e32d", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        assertLtDecimal(-1.0e18, -1.1e18, 18, err);", "highlightLines": [176]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/demo/demo.sol", "line": 176, "column": 37}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "110734065b55", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "        assertLtDecimal(uint(2.0e18), 1.1e18, 18);", "highlightLines": [179]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/demo/demo.sol", "line": 179, "column": 25}, "severity": "info", "references": [], "description": ""}, {"id": "e5c75afaba6c", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        assertLtDecimal(uint(2.0e18), 1.1e18, 18);", "highlightLines": [179]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/demo/demo.sol", "line": 179, "column": 41}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "113dee2c36d4", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "        assertLtDecimal(uint(2.0e18), 1.1e18, 18, err);", "highlightLines": [181]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/demo/demo.sol", "line": 181, "column": 25}, "severity": "info", "references": [], "description": ""}, {"id": "312ce3a37996", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        assertLtDecimal(uint(2.0e18), 1.1e18, 18, err);", "highlightLines": [181]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/demo/demo.sol", "line": 181, "column": 41}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "df056876199a", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "        assertLe(uint(1), 0);", "highlightLines": [184]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/demo/demo.sol", "line": 184, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "500c7b076d9b", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "        assertLe(uint(1), 0, err);", "highlightLines": [186]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/demo/demo.sol", "line": 186, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "e3b57dd1e93a", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        assertLeDecimal(-1.0e18, -1.1e18, 18);", "highlightLines": [194]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/demo/demo.sol", "line": 194, "column": 37}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "6f646a824d69", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        assertLeDecimal(-1.0e18, -1.1e18, 18, err);", "highlightLines": [196]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/demo/demo.sol", "line": 196, "column": 37}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "599740509d31", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "        assertLeDecimal(uint(2.0e18), 1.1e18, 18);", "highlightLines": [199]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/demo/demo.sol", "line": 199, "column": 25}, "severity": "info", "references": [], "description": ""}, {"id": "2c27ac88195c", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        assertLeDecimal(uint(2.0e18), 1.1e18, 18);", "highlightLines": [199]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/demo/demo.sol", "line": 199, "column": 41}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "d6a6cd5bf9c9", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "        assertLeDecimal(uint(2.0e18), 1.1e18, 18, err);", "highlightLines": [201]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/demo/demo.sol", "line": 201, "column": 25}, "severity": "info", "references": [], "description": ""}, {"id": "da57c52e6fa7", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        assertLeDecimal(uint(2.0e18), 1.1e18, 18, err);", "highlightLines": [201]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/demo/demo.sol", "line": 201, "column": 41}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "5456b593b28d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        string memory s1 = \"string 1\";\n        string memory s2 = \"string 2\";", "highlightLines": [204]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/demo/demo.sol", "line": 204, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "47cd93ec8c31", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event log                    (string);", "highlightLines": [19]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 19, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "d1442a1660aa", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event logs                   (bytes);", "highlightLines": [20]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 20, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "a5aeb75e6a6d", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event log_address            (address);", "highlightLines": [22]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 22, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "5bef4fee61be", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event log_bytes32            (bytes32);", "highlightLines": [23]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 23, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "aa8aa69df756", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event log_int                (int);", "highlightLines": [24]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 24, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "f326626a8f88", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event log_uint               (uint);", "highlightLines": [25]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 25, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "4061a41402c8", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event log_bytes              (bytes);", "highlightLines": [26]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 26, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "802811ac1058", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event log_string             (string);", "highlightLines": [27]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 27, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "73c596c289d1", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event log_named_address      (string key, address val);", "highlightLines": [29]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 29, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "3ebc4d04ea5e", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event log_named_bytes32      (string key, bytes32 val);", "highlightLines": [30]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 30, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "9c092217b0a5", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event log_named_decimal_int  (string key, int val, uint decimals);", "highlightLines": [31]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 31, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "a790dd8d7f36", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event log_named_decimal_uint (string key, uint val, uint decimals);", "highlightLines": [32]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 32, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "ef1813be3788", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event log_named_int          (string key, int val);", "highlightLines": [33]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 33, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "1ac6ce0b2c46", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event log_named_uint         (string key, uint val);", "highlightLines": [34]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 34, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "f6d8b577cd1f", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event log_named_bytes        (string key, bytes val);", "highlightLines": [35]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 35, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "b21b830b6c56", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event log_named_string       (string key, string val);", "highlightLines": [36]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 36, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "1c61fda3a8c3", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier mayRevert() { _; }", "highlightLines": [44]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 44, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "b0f30df57d5a", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier testopts(string memory) { _; }", "highlightLines": [45]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 45, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "8a6a97585380", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "    modifier testopts(string memory) { _; }", "highlightLines": [45]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 45, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "4bed973fb525", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            bool globalFailed = false;", "highlightLines": [51]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 51, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d68e3bf701d3", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            bool globalFailed = false;\n            if (hasHEVMContext()) {\n                (, bytes memory retdata) = HEVM_ADDRESS.call(\n                    abi.encodePacked(\n                        bytes4(keccak256(\"load(address,bytes32)\")),\n                        abi.encode(HEVM_ADDRESS, bytes32(\"failed\"))\n                    )\n                );\n                globalFailed = abi.decode(retdata, (bool));\n            }", "highlightLines": [51]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 51, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "d7cd7e028e03", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "                (, bytes memory retdata) = HEVM_ADDRESS.call(\n                    abi.encodePacked(\n                        bytes4(keccak256(\"load(address,bytes32)\")),\n                        abi.encode(HEVM_ADDRESS, bytes32(\"failed\"))\n                    )\n                );\n                globalFailed = abi.decode(retdata, (bool));", "highlightLines": [53]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 53, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "cbf7612302ed", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "                (, bytes memory retdata) = HEVM_ADDRESS.call(\n                    abi.encodePacked(\n                        bytes4(keccak256(\"load(address,bytes32)\")),", "highlightLines": [53]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 53, "column": 44}, "severity": "medium", "references": [], "description": ""}, {"id": "d13fb0eab868", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "                    abi.encodePacked(\n                        bytes4(keccak256(\"load(address,bytes32)\")),\n                        abi.encode(HEVM_ADDRESS, bytes32(\"failed\"))\n                    )", "highlightLines": [54]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 54, "column": 21}, "severity": "medium", "references": [], "description": ""}, {"id": "4fc1b982f7c8", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "            (bool status, ) = HEVM_ADDRESS.call(\n                abi.encodePacked(\n                    bytes4(keccak256(\"store(address,bytes32,bytes32)\")),", "highlightLines": [67]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 67, "column": 31}, "severity": "medium", "references": [], "description": ""}, {"id": "daad669a4cf7", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "                abi.encodePacked(\n                    bytes4(keccak256(\"store(address,bytes32,bytes32)\")),\n                    abi.encode(HEVM_ADDRESS, bytes32(\"failed\"), bytes32(uint256(0x01)))\n                )", "highlightLines": [68]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 68, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "54fc8baaecc9", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function hasHEVMContext() internal view returns (bool) {\n        uint256 hevmCodeSize = 0;", "highlightLines": [78]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 78, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "5f9a12d068bd", "fix": {"template": null, "available": false}, "title": "View/pure function uses assembly - may modify state unexpectedly", "ruleId": "rules.sol-constant-function-assembly", "snippet": {"code": "    function hasHEVMContext() internal view returns (bool) {\n        uint256 hevmCodeSize = 0;\n        assembly {", "highlightLines": [78]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 78, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-using-assembly-code"], "description": ""}, {"id": "691f48f7559f", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 hevmCodeSize = 0;", "highlightLines": [79]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 79, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "802d7d5fa71e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 hevmCodeSize = 0;\n        assembly {\n            hevmCodeSize := extcodesize(0x7109709ECfa91a80626fF3989D68f67F5b1DD12D)\n        }", "highlightLines": [79]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 79, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "093645c6337b", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [80]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 80, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "0e25228ce093", "fix": {"template": null, "available": false}, "title": "isContract check can be bypassed by calling from constructor - extcodesize is 0 during construction", "ruleId": "rules.sol-ethernaut-iscontract-bypass", "snippet": {"code": "        assembly {\n            hevmCodeSize := extcodesize(0x7109709ECfa91a80626fF3989D68f67F5b1DD12D)\n        }", "highlightLines": [80]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 80, "column": 9}, "severity": "high", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2943"], "description": ""}, {"id": "53cad3799252", "fix": {"template": null, "available": false}, "title": "extcodesize check can be bypassed during constructor - contracts have size 0 while being created", "ruleId": "rules.sol-extcodesize-check", "snippet": {"code": "            hevmCodeSize := extcodesize(0x7109709ECfa91a80626fF3989D68f67F5b1DD12D)", "highlightLines": [81]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 81, "column": 29}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/18"], "description": ""}, {"id": "e88139512716", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier logs_gas() {\n        uint startGas = gasleft();\n        _;\n        uint endGas = gasleft();\n        emit log_named_uint(\"gas\", startGas - endGas);\n    }", "highlightLines": [86]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 86, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "1a2c728dea26", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "    modifier logs_gas() {\n        uint startGas = gasleft();\n        _;\n        uint endGas = gasleft();\n        emit log_named_uint(\"gas\", startGas - endGas);\n    }", "highlightLines": [86]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 86, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "2e5f2749d808", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint startGas = gasleft();", "highlightLines": [87]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 87, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "611a80de9e88", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint startGas = gasleft();\n        _;\n        uint endGas = gasleft();", "highlightLines": [87]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 87, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "3ffed850b3ad", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [88]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 88, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "18bb48ed03fb", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint endGas = gasleft();", "highlightLines": [89]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 89, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e79b21811244", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function assertEq(address a, address b) internal {\n        if (a != b) {\n            emit log(\"Error: a == b not satisfied [address]\");", "highlightLines": [107]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 107, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "28f8eca14316", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function assertEq(bytes32 a, bytes32 b) internal {\n        if (a != b) {\n            emit log(\"Error: a == b not satisfied [bytes32]\");", "highlightLines": [122]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 122, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "04ca0cc04142", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function assertEq(int a, int b) internal {\n        if (a != b) {\n            emit log(\"Error: a == b not satisfied [int]\");", "highlightLines": [143]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 143, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "910f643729b5", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function assertEq(uint a, uint b) internal {\n        if (a != b) {\n            emit log(\"Error: a == b not satisfied [uint]\");", "highlightLines": [157]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 157, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "9de6755c3334", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function assertEqDecimal(int a, int b, uint decimals) internal {\n        if (a != b) {\n            emit log(\"Error: a == b not satisfied [decimal int]\");", "highlightLines": [171]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 171, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "5e09704afcd4", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function assertEqDecimal(uint a, uint b, uint decimals) internal {\n        if (a != b) {\n            emit log(\"Error: a == b not satisfied [decimal uint]\");", "highlightLines": [185]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 185, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "f3f13b01d135", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function assertEq(string memory a, string memory b) internal {\n        if (keccak256(abi.encodePacked(a)) != keccak256(abi.encodePacked(b))) {\n            emit log(\"Error: a == b not satisfied [string]\");", "highlightLines": [428]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 428, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "e44ee4fba402", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        if (keccak256(abi.encodePacked(a)) != keccak256(abi.encodePacked(b))) {", "highlightLines": [429]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 429, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "38ca98f57f71", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        if (keccak256(abi.encodePacked(a)) != keccak256(abi.encodePacked(b))) {", "highlightLines": [437]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 437, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "65d1ff7af490", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function checkEq0(bytes memory a, bytes memory b) internal pure returns (bool ok) {\n        ok = true;\n        if (a.length == b.length) {\n            for (uint i = 0; i < a.length; i++) {\n                if (a[i] != b[i]) {\n                    ok = false;", "highlightLines": [443]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 443, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "ddba1b3f2fb9", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        ok = true;\n        if (a.length == b.length) {\n            for (uint i = 0; i < a.length; i++) {\n                if (a[i] != b[i]) {\n                    ok = false;\n                }\n            }\n        } else {\n            ok = false;\n        }", "highlightLines": [444]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 444, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "5f7cba7bd155", "fix": {"template": null, "available": false}, "title": "Empty array bypasses loop logic - add length check before loop", "ruleId": "rules.sol-empty-array-loop-bypass", "snippet": {"code": "            for (uint i = 0; i < a.length; i++) {", "highlightLines": [446]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 446, "column": 13}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/empty-loop.sol"], "description": ""}, {"id": "366e4209abf0", "fix": {"template": null, "available": false}, "title": "Unbounded loop over array - potential DOS via gas limit", "ruleId": "rules.sol-unbounded-loop", "snippet": {"code": "            for (uint i = 0; i < a.length; i++) {\n                if (a[i] != b[i]) {\n                    ok = false;\n                }\n            }", "highlightLines": [446]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 446, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "a6476d918529", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function assertEq0(bytes memory a, bytes memory b) internal {\n        if (!checkEq0(a, b)) {\n            emit log(\"Error: a == b not satisfied [bytes]\");", "highlightLines": [455]}, "category": "code", "location": {"file": "lib/forge-std/lib/ds-test/src/test.sol", "line": 455, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "ee28e535e061", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function computeCreateAddress(address deployer, uint256 nonce) internal pure returns (address) {\n        // The integer zero is treated as an empty byte string, and as a result it only has a length prefix, 0x80, computed via 0x80 + 0.\n        // A one byte integer uses its own value as its length prefix, there is no additional \"0x80 + length\" prefix that comes before it.\n        if (nonce == 0x00)             return addressFromLast20Bytes(keccak256(abi.encodePacked(bytes1(0xd6), bytes1(0x94), deployer, bytes1(0x80))));", "highlightLines": [17]}, "category": "code", "location": {"file": "lib/forge-std/src/Script.sol", "line": 17, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "3a2dd38e7de5", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function computeCreateAddress(address deployer, uint256 nonce) internal pure returns (address) {\n        // The integer zero is treated as an empty byte string, and as a result it only has a length prefix, 0x80, computed via 0x80 + 0.\n        // A one byte integer uses its own value as its length prefix, there is no additional \"0x80 + length\" prefix that comes before it.\n        if (nonce == 0x00)             return addressFromLast20Bytes(keccak256(abi.encodePacked(bytes1(0xd6), bytes1(0x94), deployer, bytes1(0x80))));\n        if (nonce <= 0x7f)             return addressFromLast20Bytes(keccak256(abi.encodePacked(bytes1(0xd6), bytes1(0x94), deployer, uint8(nonce))));\n\n        // Nonces greater than 1 byte all follow a consistent encoding scheme, where each value is preceded by a prefix of 0x80 + length.\n        if (nonce <= 2**8 - 1)  return addressFromLast20Bytes(keccak256(abi.encodePacked(bytes1(0xd7), bytes1(0x94), deployer, bytes1(0x81), uint8(nonce))));\n        if (nonce <= 2**16 - 1) return addressFromLast20Bytes(keccak256(abi.encodePacked(bytes1(0xd8), bytes1(0x94), deployer, bytes1(0x82), uint16(nonce))));\n        if (nonce <= 2**24 - 1) return addressFromLast20Bytes(keccak256(abi.encodePacked(bytes1(0xd9), bytes1(0x94), deployer, bytes1(0x83), uint24(nonce))));\n\n        // More details about RLP encoding can be found here: https://eth.wiki/fundamentals/rlp\n        // 0xda = 0xc0 (short RLP prefix) + 0x16 (length of: 0x94 ++ proxy ++ 0x84 ++ nonce)\n        // 0x94 = 0x80 + 0x14 (0x14 = the length of an address, 20 bytes, in hex)\n        // 0x84 = 0x80 + 0x04 (0x04 = the bytes length of the nonce, 4 bytes, in hex)", "highlightLines": [17]}, "category": "code", "location": {"file": "lib/forge-std/src/Script.sol", "line": 17, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "52ecd3fb561f", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "        if (nonce == 0x00)             return addressFromLast20Bytes(keccak256(abi.encodePacked(bytes1(0xd6), bytes1(0x94), deployer, bytes1(0x80))));", "highlightLines": [20]}, "category": "code", "location": {"file": "lib/forge-std/src/Script.sol", "line": 20, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "604de28ec315", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "        if (nonce == 0x00)             return addressFromLast20Bytes(keccak256(abi.encodePacked(bytes1(0xd6), bytes1(0x94), deployer, bytes1(0x80))));\n        if (nonce <= 0x7f)             return addressFromLast20Bytes(keccak256(abi.encodePacked(bytes1(0xd6), bytes1(0x94), deployer, uint8(nonce))));", "highlightLines": [20]}, "category": "code", "location": {"file": "lib/forge-std/src/Script.sol", "line": 20, "column": 40}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "10ed06cfbb47", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        if (nonce == 0x00)             return addressFromLast20Bytes(keccak256(abi.encodePacked(bytes1(0xd6), bytes1(0x94), deployer, bytes1(0x80))));", "highlightLines": [20]}, "category": "code", "location": {"file": "lib/forge-std/src/Script.sol", "line": 20, "column": 70}, "severity": "high", "references": [], "description": ""}, {"id": "d770f8bed181", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "        if (nonce == 0x00)             return addressFromLast20Bytes(keccak256(abi.encodePacked(bytes1(0xd6), bytes1(0x94), deployer, bytes1(0x80))));", "highlightLines": [20]}, "category": "code", "location": {"file": "lib/forge-std/src/Script.sol", "line": 20, "column": 80}, "severity": "medium", "references": [], "description": ""}, {"id": "b7fb2217fa3d", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        if (nonce <= 0x7f)             return addressFromLast20Bytes(keccak256(abi.encodePacked(bytes1(0xd6), bytes1(0x94), deployer, uint8(nonce))));", "highlightLines": [21]}, "category": "code", "location": {"file": "lib/forge-std/src/Script.sol", "line": 21, "column": 70}, "severity": "high", "references": [], "description": ""}, {"id": "e690c002dd81", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "        if (nonce <= 0x7f)             return addressFromLast20Bytes(keccak256(abi.encodePacked(bytes1(0xd6), bytes1(0x94), deployer, uint8(nonce))));", "highlightLines": [21]}, "category": "code", "location": {"file": "lib/forge-std/src/Script.sol", "line": 21, "column": 80}, "severity": "medium", "references": [], "description": ""}, {"id": "b59b60b73620", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        if (nonce <= 0x7f)             return addressFromLast20Bytes(keccak256(abi.encodePacked(bytes1(0xd6), bytes1(0x94), deployer, uint8(nonce))));", "highlightLines": [21]}, "category": "code", "location": {"file": "lib/forge-std/src/Script.sol", "line": 21, "column": 135}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "aed59564a1b0", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "        if (nonce <= 2**8 - 1)  return addressFromLast20Bytes(keccak256(abi.encodePacked(bytes1(0xd7), bytes1(0x94), deployer, bytes1(0x81), uint8(nonce))));\n        if (nonce <= 2**16 - 1) return addressFromLast20Bytes(keccak256(abi.encodePacked(bytes1(0xd8), bytes1(0x94), deployer, bytes1(0x82), uint16(nonce))));", "highlightLines": [24]}, "category": "code", "location": {"file": "lib/forge-std/src/Script.sol", "line": 24, "column": 33}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "276cbbf89923", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        if (nonce <= 2**8 - 1)  return addressFromLast20Bytes(keccak256(abi.encodePacked(bytes1(0xd7), bytes1(0x94), deployer, bytes1(0x81), uint8(nonce))));", "highlightLines": [24]}, "category": "code", "location": {"file": "lib/forge-std/src/Script.sol", "line": 24, "column": 63}, "severity": "high", "references": [], "description": ""}, {"id": "8364cdd7a65d", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "        if (nonce <= 2**8 - 1)  return addressFromLast20Bytes(keccak256(abi.encodePacked(bytes1(0xd7), bytes1(0x94), deployer, bytes1(0x81), uint8(nonce))));", "highlightLines": [24]}, "category": "code", "location": {"file": "lib/forge-std/src/Script.sol", "line": 24, "column": 73}, "severity": "medium", "references": [], "description": ""}, {"id": "4e7d98525762", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        if (nonce <= 2**8 - 1)  return addressFromLast20Bytes(keccak256(abi.encodePacked(bytes1(0xd7), bytes1(0x94), deployer, bytes1(0x81), uint8(nonce))));", "highlightLines": [24]}, "category": "code", "location": {"file": "lib/forge-std/src/Script.sol", "line": 24, "column": 142}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "2012b833cc6b", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "        if (nonce <= 2**16 - 1) return addressFromLast20Bytes(keccak256(abi.encodePacked(bytes1(0xd8), bytes1(0x94), deployer, bytes1(0x82), uint16(nonce))));\n        if (nonce <= 2**24 - 1) return addressFromLast20Bytes(keccak256(abi.encodePacked(bytes1(0xd9), bytes1(0x94), deployer, bytes1(0x83), uint24(nonce))));", "highlightLines": [25]}, "category": "code", "location": {"file": "lib/forge-std/src/Script.sol", "line": 25, "column": 33}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "2ed8f1c1de05", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        if (nonce <= 2**16 - 1) return addressFromLast20Bytes(keccak256(abi.encodePacked(bytes1(0xd8), bytes1(0x94), deployer, bytes1(0x82), uint16(nonce))));", "highlightLines": [25]}, "category": "code", "location": {"file": "lib/forge-std/src/Script.sol", "line": 25, "column": 63}, "severity": "high", "references": [], "description": ""}, {"id": "122b5031b251", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "        if (nonce <= 2**16 - 1) return addressFromLast20Bytes(keccak256(abi.encodePacked(bytes1(0xd8), bytes1(0x94), deployer, bytes1(0x82), uint16(nonce))));", "highlightLines": [25]}, "category": "code", "location": {"file": "lib/forge-std/src/Script.sol", "line": 25, "column": 73}, "severity": "medium", "references": [], "description": ""}, {"id": "06d6a309b5b2", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        if (nonce <= 2**16 - 1) return addressFromLast20Bytes(keccak256(abi.encodePacked(bytes1(0xd8), bytes1(0x94), deployer, bytes1(0x82), uint16(nonce))));", "highlightLines": [25]}, "category": "code", "location": {"file": "lib/forge-std/src/Script.sol", "line": 25, "column": 142}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "1a1522721775", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        if (nonce <= 2**24 - 1) return addressFromLast20Bytes(keccak256(abi.encodePacked(bytes1(0xd9), bytes1(0x94), deployer, bytes1(0x83), uint24(nonce))));", "highlightLines": [26]}, "category": "code", "location": {"file": "lib/forge-std/src/Script.sol", "line": 26, "column": 63}, "severity": "high", "references": [], "description": ""}, {"id": "f44a4a590850", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "        if (nonce <= 2**24 - 1) return addressFromLast20Bytes(keccak256(abi.encodePacked(bytes1(0xd9), bytes1(0x94), deployer, bytes1(0x83), uint24(nonce))));", "highlightLines": [26]}, "category": "code", "location": {"file": "lib/forge-std/src/Script.sol", "line": 26, "column": 73}, "severity": "medium", "references": [], "description": ""}, {"id": "65dfd25af9f1", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        return addressFromLast20Bytes(keccak256(abi.encodePacked(bytes1(0xda), bytes1(0x94), deployer, bytes1(0x84), uint32(nonce))));", "highlightLines": [33]}, "category": "code", "location": {"file": "lib/forge-std/src/Script.sol", "line": 33, "column": 39}, "severity": "high", "references": [], "description": ""}, {"id": "7cc1725ad9b0", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "        return addressFromLast20Bytes(keccak256(abi.encodePacked(bytes1(0xda), bytes1(0x94), deployer, bytes1(0x84), uint32(nonce))));", "highlightLines": [33]}, "category": "code", "location": {"file": "lib/forge-std/src/Script.sol", "line": 33, "column": 49}, "severity": "medium", "references": [], "description": ""}, {"id": "b8dcd0892461", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        return addressFromLast20Bytes(keccak256(abi.encodePacked(bytes1(0xda), bytes1(0x94), deployer, bytes1(0x84), uint32(nonce))));", "highlightLines": [33]}, "category": "code", "location": {"file": "lib/forge-std/src/Script.sol", "line": 33, "column": 118}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "0d2bcfce05d6", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        115792089237316195423570985008687907853269984665640564039457584007913129639935;", "highlightLines": [12]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 12, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "16f3b6d27bfe", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event log_array(uint256[] val);", "highlightLines": [20]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 20, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "5f54e4dc8106", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event log_array(int256[] val);", "highlightLines": [21]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 21, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "084d170b5ee3", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event log_array(address[] val);", "highlightLines": [22]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 22, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "1e70396c35d2", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event log_named_array(string key, uint256[] val);", "highlightLines": [23]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 23, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "7be3fe62eccf", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event log_named_array(string key, int256[] val);", "highlightLines": [24]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 24, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "4db585e65c23", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event log_named_array(string key, address[] val);", "highlightLines": [25]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 25, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "a5b15e763811", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        vm.warp(block.timestamp + time);", "highlightLines": [33]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 33, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "f0f7dac23367", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        vm.warp(block.timestamp - time);", "highlightLines": [37]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 37, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "75bd42fbac3b", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "        vm.deal(who, 1 << 128);", "highlightLines": [42]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 42, "column": 22}, "severity": "medium", "references": [], "description": ""}, {"id": "6afa52821c65", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "        vm.deal(who, 1 << 128);", "highlightLines": [52]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 52, "column": 22}, "severity": "medium", "references": [], "description": ""}, {"id": "0f2173a06be0", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "        vm.deal(who, 1 << 128);", "highlightLines": [63]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 63, "column": 22}, "severity": "medium", "references": [], "description": ""}, {"id": "6031545f11d0", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "        vm.deal(who, 1 << 128);", "highlightLines": [75]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 75, "column": 22}, "severity": "medium", "references": [], "description": ""}, {"id": "14402fcfaff8", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "        stdstore\n            .target(token)\n            .sig(0x70a08231)", "highlightLines": [92]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 92, "column": 9}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "0b11d222df65", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        (, bytes memory balData) = token.call(abi.encodeWithSelector(0x70a08231, to));\n        uint256 prevBal = abi.decode(balData, (uint256));", "highlightLines": [113]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 113, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "fccf3674dca2", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "        (, bytes memory balData) = token.call(abi.encodeWithSelector(0x70a08231, to));\n        uint256 prevBal = abi.decode(balData, (uint256));\n\n        // update balance\n        stdstore\n            .target(token)\n            .sig(0x70a08231)\n            .with_key(to)\n            .checked_write(give);\n\n        // update total supply\n        if(adjust){\n            (, bytes memory totSupData) = token.call(abi.encodeWithSelector(0x18160ddd));\n            uint256 totSup = abi.decode(totSupData, (uint256));\n            if(give < prevBal) {\n                totSup -= (prevBal - give);\n            } else {\n                totSup += (give - prevBal);\n            }\n            stdstore\n                .target(token)\n                .sig(0x18160ddd)\n                .checked_write(totSup);\n        }", "highlightLines": [113]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 113, "column": 9}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "fbaf4e7ceac9", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "        (, bytes memory balData) = token.call(abi.encodeWithSelector(0x70a08231, to));", "highlightLines": [113]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 113, "column": 36}, "severity": "medium", "references": [], "description": ""}, {"id": "5ff14d77e961", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 prevBal = abi.decode(balData, (uint256));", "highlightLines": [114]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 114, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "416e565d12c3", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "        uint256 prevBal = abi.decode(balData, (uint256));\n\n        // update balance\n        stdstore\n            .target(token)\n            .sig(0x70a08231)\n            .with_key(to)\n            .checked_write(give);\n\n        // update total supply\n        if(adjust){\n            (, bytes memory totSupData) = token.call(abi.encodeWithSelector(0x18160ddd));\n            uint256 totSup = abi.decode(totSupData, (uint256));\n            if(give < prevBal) {\n                totSup -= (prevBal - give);\n            } else {\n                totSup += (give - prevBal);\n            }\n            stdstore\n                .target(token)\n                .sig(0x18160ddd)\n                .checked_write(totSup);\n        }", "highlightLines": [114]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 114, "column": 9}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "3d87e9ab5d01", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 prevBal = abi.decode(balData, (uint256));\n\n        // update balance\n        stdstore\n            .target(token)\n            .sig(0x70a08231)\n            .with_key(to)\n            .checked_write(give);\n\n        // update total supply\n        if(adjust){\n            (, bytes memory totSupData) = token.call(abi.encodeWithSelector(0x18160ddd));\n            uint256 totSup = abi.decode(totSupData, (uint256));\n            if(give < prevBal) {\n                totSup -= (prevBal - give);\n            } else {\n                totSup += (give - prevBal);\n            }\n            stdstore\n                .target(token)\n                .sig(0x18160ddd)\n                .checked_write(totSup);\n        }", "highlightLines": [114]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 114, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "bc0f068663b1", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "        stdstore\n            .target(token)\n            .sig(0x70a08231)", "highlightLines": [117]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 117, "column": 9}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "7edac51882e5", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            (, bytes memory totSupData) = token.call(abi.encodeWithSelector(0x18160ddd));\n            uint256 totSup = abi.decode(totSupData, (uint256));", "highlightLines": [125]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 125, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "1981367ad053", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "            (, bytes memory totSupData) = token.call(abi.encodeWithSelector(0x18160ddd));", "highlightLines": [125]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 125, "column": 43}, "severity": "medium", "references": [], "description": ""}, {"id": "2ab75020c558", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint256 totSup = abi.decode(totSupData, (uint256));", "highlightLines": [126]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 126, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "24edfd61960e", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "            stdstore\n                .target(token)\n                .sig(0x18160ddd)", "highlightLines": [132]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 132, "column": 13}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "1b670dd2fdca", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 size = max - min;", "highlightLines": [141]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 141, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "dbd013446f8b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 size = max - min;\n\n        if (size == 0)\n        {\n            result = min;\n        }\n        else if (size == UINT256_MAX)\n        {\n            result = x;\n        }\n        else\n        {\n            ++size; // make `max` inclusive\n            uint256 mod = x % size;\n            result = min + mod;\n        }", "highlightLines": [142]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 142, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "4d520b8b51fd", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint256 mod = x % size;", "highlightLines": [155]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 155, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d76d69777868", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            uint256 mod = x % size;\n            result = min + mod;", "highlightLines": [155]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 155, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "c47da7b5865e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes memory bytecode = abi.encodePacked(vm.getCode(what), args);\n        /// @solidity memory-safe-assembly\n        assembly {\n            addr := create(0, add(bytecode, 0x20), mload(bytecode))\n        }", "highlightLines": [169]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 169, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "3df24c49f940", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "        bytes memory bytecode = abi.encodePacked(vm.getCode(what), args);", "highlightLines": [169]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 169, "column": 33}, "severity": "medium", "references": [], "description": ""}, {"id": "508f53305260", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [171]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 171, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "4f6c58fb9f3a", "fix": {"template": null, "available": false}, "title": "Raw bytecode deployment via create/create2 - verify bytecode source and intent (MagicNumber pattern)", "ruleId": "rules.sol-raw-bytecode-create", "snippet": {"code": "            addr := create(0, add(bytecode, 0x20), mload(bytecode))", "highlightLines": [172]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 172, "column": 21}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/18"], "description": ""}, {"id": "cc3ac0b63de7", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes memory bytecode = vm.getCode(what);\n        /// @solidity memory-safe-assembly\n        assembly {\n            addr := create(0, add(bytecode, 0x20), mload(bytecode))\n        }", "highlightLines": [185]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 185, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "aff1a4a452c1", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [187]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 187, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "05b932fa781d", "fix": {"template": null, "available": false}, "title": "Raw bytecode deployment via create/create2 - verify bytecode source and intent (MagicNumber pattern)", "ruleId": "rules.sol-raw-bytecode-create", "snippet": {"code": "            addr := create(0, add(bytecode, 0x20), mload(bytecode))", "highlightLines": [188]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 188, "column": 21}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/18"], "description": ""}, {"id": "66439bc0021c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes memory bytecode = abi.encodePacked(vm.getCode(what), args);\n        /// @solidity memory-safe-assembly\n        assembly {\n            addr := create(val, add(bytecode, 0x20), mload(bytecode))\n        }", "highlightLines": [202]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 202, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "0749aedd1c63", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "        bytes memory bytecode = abi.encodePacked(vm.getCode(what), args);", "highlightLines": [202]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 202, "column": 33}, "severity": "medium", "references": [], "description": ""}, {"id": "a2f2f43e7c3b", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [204]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 204, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "fd3d2d6ae153", "fix": {"template": null, "available": false}, "title": "Raw bytecode deployment via create/create2 - verify bytecode source and intent (MagicNumber pattern)", "ruleId": "rules.sol-raw-bytecode-create", "snippet": {"code": "            addr := create(val, add(bytecode, 0x20), mload(bytecode))", "highlightLines": [205]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 205, "column": 21}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/18"], "description": ""}, {"id": "6a4b88281218", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes memory bytecode = vm.getCode(what);\n        /// @solidity memory-safe-assembly\n        assembly {\n            addr := create(val, add(bytecode, 0x20), mload(bytecode))\n        }", "highlightLines": [218]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 218, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "6d9b55dab65d", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [220]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 220, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "3b97c15735ba", "fix": {"template": null, "available": false}, "title": "Raw bytecode deployment via create/create2 - verify bytecode source and intent (MagicNumber pattern)", "ruleId": "rules.sol-raw-bytecode-create", "snippet": {"code": "            addr := create(val, add(bytecode, 0x20), mload(bytecode))", "highlightLines": [221]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 221, "column": 21}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/18"], "description": ""}, {"id": "b368a0fa4f6f", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function assertEq(bool a, bool b) internal {\n        if (a != b) {\n            emit log                (\"Error: a == b not satisfied [bool]\");", "highlightLines": [247]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 247, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "1e164c98fc9d", "fix": {"template": null, "available": false}, "title": "Storage array passed by value to internal function - changes won't persist", "ruleId": "rules.sol-array-by-reference", "snippet": {"code": "    function assertEq(uint256[] memory a, uint256[] memory b) internal {", "highlightLines": [271]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 271, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#modifying-storage-array-by-value"], "description": ""}, {"id": "5d6fc75f2234", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function assertEq(uint256[] memory a, uint256[] memory b) internal {\n        if (keccak256(abi.encode(a)) != keccak256(abi.encode(b))) {\n            emit log(\"Error: a == b not satisfied [uint[]]\");", "highlightLines": [271]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 271, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "4fb6ad138858", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        if (keccak256(abi.encode(a)) != keccak256(abi.encode(b))) {", "highlightLines": [272]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 272, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "7030123e1e5f", "fix": {"template": null, "available": false}, "title": "Storage array passed by value to internal function - changes won't persist", "ruleId": "rules.sol-array-by-reference", "snippet": {"code": "    function assertEq(int256[] memory a, int256[] memory b) internal {", "highlightLines": [280]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 280, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#modifying-storage-array-by-value"], "description": ""}, {"id": "21422ab4830d", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function assertEq(int256[] memory a, int256[] memory b) internal {\n        if (keccak256(abi.encode(a)) != keccak256(abi.encode(b))) {\n            emit log(\"Error: a == b not satisfied [int[]]\");", "highlightLines": [280]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 280, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "55745948cd57", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        if (keccak256(abi.encode(a)) != keccak256(abi.encode(b))) {", "highlightLines": [281]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 281, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "1d71dc479617", "fix": {"template": null, "available": false}, "title": "Storage array passed by value to internal function - changes won't persist", "ruleId": "rules.sol-array-by-reference", "snippet": {"code": "    function assertEq(address[] memory a, address[] memory b) internal {", "highlightLines": [289]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 289, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#modifying-storage-array-by-value"], "description": ""}, {"id": "14c2f2d3fbb9", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function assertEq(address[] memory a, address[] memory b) internal {\n        if (keccak256(abi.encode(a)) != keccak256(abi.encode(b))) {\n            emit log(\"Error: a == b not satisfied [address[]]\");", "highlightLines": [289]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 289, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "fcc547163df8", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        if (keccak256(abi.encode(a)) != keccak256(abi.encode(b))) {", "highlightLines": [290]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 290, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "8bec04b25471", "fix": {"template": null, "available": false}, "title": "Storage array passed by value to internal function - changes won't persist", "ruleId": "rules.sol-array-by-reference", "snippet": {"code": "    function assertEq(uint256[] memory a, uint256[] memory b, string memory err) internal {", "highlightLines": [298]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 298, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#modifying-storage-array-by-value"], "description": ""}, {"id": "9e8188c1de5c", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        if (keccak256(abi.encode(a)) != keccak256(abi.encode(b))) {", "highlightLines": [299]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 299, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "745e4832fffc", "fix": {"template": null, "available": false}, "title": "Storage array passed by value to internal function - changes won't persist", "ruleId": "rules.sol-array-by-reference", "snippet": {"code": "    function assertEq(int256[] memory a, int256[] memory b, string memory err) internal {", "highlightLines": [305]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 305, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#modifying-storage-array-by-value"], "description": ""}, {"id": "0dd460ea55e5", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        if (keccak256(abi.encode(a)) != keccak256(abi.encode(b))) {", "highlightLines": [306]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 306, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "66f86307d745", "fix": {"template": null, "available": false}, "title": "Storage array passed by value to internal function - changes won't persist", "ruleId": "rules.sol-array-by-reference", "snippet": {"code": "    function assertEq(address[] memory a, address[] memory b, string memory err) internal {", "highlightLines": [313]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 313, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#modifying-storage-array-by-value"], "description": ""}, {"id": "bd4442643f99", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        if (keccak256(abi.encode(a)) != keccak256(abi.encode(b))) {", "highlightLines": [314]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 314, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "c1bbd2b3f506", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 delta = stdMath.delta(a, b);", "highlightLines": [325]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 325, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "765c087ca1b9", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 delta = stdMath.delta(a, b);", "highlightLines": [343]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 343, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "63b78d0eb5b1", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 delta = stdMath.delta(a, b);", "highlightLines": [356]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 356, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0a41d862f90a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 delta = stdMath.delta(a, b);", "highlightLines": [374]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 374, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "45449f542996", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function assertApproxEqRel(\n        uint256 a,\n        uint256 b,\n        uint256 maxPercentDelta // An 18 decimal fixed point number, where 1e18 == 100%\n    ) internal virtual {\n        if (b == 0) return assertEq(a, b); // If the expected is 0, actual must be too.", "highlightLines": [382]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 382, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "cb1ef0d3cecf", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        uint256 maxPercentDelta // An 18 decimal fixed point number, where 1e18 == 100%", "highlightLines": [385]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 385, "column": 76}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "a4c45687ceae", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "        if (b == 0) return assertEq(a, b); // If the expected is 0, actual must be too.", "highlightLines": [387]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 387, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "951c826eebd9", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 percentDelta = stdMath.percentDelta(a, b);", "highlightLines": [388]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 388, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8d6950c05199", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function assertApproxEqRel(\n        uint256 a,\n        uint256 b,\n        uint256 maxPercentDelta, // An 18 decimal fixed point number, where 1e18 == 100%\n        string memory err\n    ) internal virtual {\n        if (b == 0) return assertEq(a, b); // If the expected is 0, actual must be too.", "highlightLines": [401]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 401, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "312ca8973825", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        uint256 maxPercentDelta, // An 18 decimal fixed point number, where 1e18 == 100%", "highlightLines": [404]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 404, "column": 77}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "e67a88c08bdb", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "        if (b == 0) return assertEq(a, b); // If the expected is 0, actual must be too.", "highlightLines": [407]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 407, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "b8a609ec3d46", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 percentDelta = stdMath.percentDelta(a, b);", "highlightLines": [408]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 408, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "baacdd2c02c8", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function assertApproxEqRel(\n        int256 a,\n        int256 b,\n        uint256 maxPercentDelta\n    ) internal virtual {\n        if (b == 0) return assertEq(a, b); // If the expected is 0, actual must be too.", "highlightLines": [417]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 417, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "8b280168665d", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "        if (b == 0) return assertEq(a, b); // If the expected is 0, actual must be too.", "highlightLines": [422]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 422, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "872ed17a543a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 percentDelta = stdMath.percentDelta(a, b);", "highlightLines": [423]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 423, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "cdde7b33655e", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function assertApproxEqRel(\n        int256 a,\n        int256 b,\n        uint256 maxPercentDelta,\n        string memory err\n    ) internal virtual {\n        if (b == 0) return assertEq(a, b); // If the expected is 0, actual must be too.", "highlightLines": [436]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 436, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "a96f706ec0ae", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "        if (b == 0) return assertEq(a, b); // If the expected is 0, actual must be too.", "highlightLines": [442]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 442, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "f42a35f4f594", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 percentDelta = stdMath.percentDelta(a, b);", "highlightLines": [443]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 443, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "67c11315b272", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    bytes4 _sig;", "highlightLines": [480]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 480, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "17bda25bf641", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 _depth;", "highlightLines": [481]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 481, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a14eabd92a7c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address _target;", "highlightLines": [482]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 482, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0df3fb1e903c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    bytes32 _set;", "highlightLines": [483]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 483, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "db76603b2f14", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event SlotFound(address who, bytes4 fsig, bytes32 keysHash, uint slot);", "highlightLines": [487]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 487, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "f8de2a971972", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event SlotFound(address who, bytes4 fsig, bytes32 keysHash, uint slot);", "highlightLines": [487]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 487, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "f17c051e4722", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event WARNING_UninitedSlot(address who, uint slot);", "highlightLines": [488]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 488, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "30733186b046", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event WARNING_UninitedSlot(address who, uint slot);", "highlightLines": [488]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 488, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "c6661e1c03e6", "fix": {"template": null, "available": false}, "title": "Foundry cheatcode address detected - test code using privileged VM operations", "ruleId": "rules.sol-foundry-cheatcode-address", "snippet": {"code": "    Vm private constant vm_std_store = Vm(address(uint160(uint256(keccak256('hevm cheat code')))));", "highlightLines": [493]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 493, "column": 43}, "severity": "info", "references": [], "description": ""}, {"id": "82c2f345eb5e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address who = self._target;", "highlightLines": [517]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 517, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d9e32607027d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address who = self._target;\n        bytes4 fsig = self._sig;", "highlightLines": [517]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 517, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "329df10d3479", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes4 fsig = self._sig;", "highlightLines": [518]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 518, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "581d479976c8", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes4 fsig = self._sig;\n        uint256 field_depth = self._depth;", "highlightLines": [518]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 518, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "3584d7da19a3", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 field_depth = self._depth;", "highlightLines": [519]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 519, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "2387d147d6cc", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 field_depth = self._depth;\n        bytes32[] memory ins = self._keys;", "highlightLines": [519]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 519, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "373ad4d9b8d1", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes32[] memory ins = self._keys;\n\n        // calldata to test against\n        if (self.finds[who][fsig][keccak256(abi.encodePacked(ins, field_depth))]) {\n            return self.slots[who][fsig][keccak256(abi.encodePacked(ins, field_depth))];\n        }\n        bytes memory cald = abi.encodePacked(fsig, flatten(ins));", "highlightLines": [520]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 520, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "6ff2efa5e8be", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        if (self.finds[who][fsig][keccak256(abi.encodePacked(ins, field_depth))]) {", "highlightLines": [523]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 523, "column": 35}, "severity": "high", "references": [], "description": ""}, {"id": "4aee1a3b7a5b", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "        if (self.finds[who][fsig][keccak256(abi.encodePacked(ins, field_depth))]) {", "highlightLines": [523]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 523, "column": 45}, "severity": "medium", "references": [], "description": ""}, {"id": "6c5cb8ac9a8f", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "            return self.slots[who][fsig][keccak256(abi.encodePacked(ins, field_depth))];", "highlightLines": [524]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 524, "column": 42}, "severity": "high", "references": [], "description": ""}, {"id": "3c2b2d6bcbb4", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "            return self.slots[who][fsig][keccak256(abi.encodePacked(ins, field_depth))];", "highlightLines": [524]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 524, "column": 52}, "severity": "medium", "references": [], "description": ""}, {"id": "df86a4e3f37d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes memory cald = abi.encodePacked(fsig, flatten(ins));\n        vm_std_store.record();\n        bytes32 fdat;\n        {\n            (, bytes memory rdat) = who.staticcall(cald);\n            fdat = bytesToBytes32(rdat, 32*field_depth);\n        }", "highlightLines": [526]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 526, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "f4c0c89d267b", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "        bytes memory cald = abi.encodePacked(fsig, flatten(ins));", "highlightLines": [526]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 526, "column": 29}, "severity": "medium", "references": [], "description": ""}, {"id": "afc80f223fde", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 fdat;", "highlightLines": [528]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 528, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f8f289c23c57", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            (, bytes memory rdat) = who.staticcall(cald);\n            fdat = bytesToBytes32(rdat, 32*field_depth);", "highlightLines": [530]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 530, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "64617ca65f5b", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "            (, bytes memory rdat) = who.staticcall(cald);", "highlightLines": [530]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 530, "column": 37}, "severity": "medium", "references": [], "description": ""}, {"id": "53959e1369fd", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "        (bytes32[] memory reads, ) = vm_std_store.accesses(address(who));\n        if (reads.length == 1) {\n            bytes32 curr = vm_std_store.load(who, reads[0]);\n            if (curr == bytes32(0)) {\n                emit WARNING_UninitedSlot(who, uint256(reads[0]));\n            }\n            if (fdat != curr) {\n                require(false, \"stdStorage find(StdStorage): Packed slot. This would cause dangerous overwriting and currently isn't supported.\");\n            }\n            emit SlotFound(who, fsig, keccak256(abi.encodePacked(ins, field_depth)), uint256(reads[0]));\n            self.slots[who][fsig][keccak256(abi.encodePacked(ins, field_depth))] = uint256(reads[0]);\n            self.finds[who][fsig][keccak256(abi.encodePacked(ins, field_depth))] = true;\n        } else if (reads.length > 1) {\n            for (uint256 i = 0; i < reads.length; i++) {\n                bytes32 prev = vm_std_store.load(who, reads[i]);\n                if (prev == bytes32(0)) {\n                    emit WARNING_UninitedSlot(who, uint256(reads[i]));\n                }\n                // store\n                vm_std_store.store(who, reads[i], bytes32(hex\"1337\"));\n                bool success;\n                bytes memory rdat;\n                {\n                    (success, rdat) = who.staticcall(cald);\n                    fdat = bytesToBytes32(rdat, 32*field_depth);\n                }\n\n                if (success && fdat == bytes32(hex\"1337\")) {\n                    // we found which of the slots is the actual one\n                    emit SlotFound(who, fsig, keccak256(abi.encodePacked(ins, field_depth)), uint256(reads[i]));\n                    self.slots[who][fsig][keccak256(abi.encodePacked(ins, field_depth))] = uint256(reads[i]);\n                    self.finds[who][fsig][keccak256(abi.encodePacked(ins, field_depth))] = true;\n                    vm_std_store.store(who, reads[i], prev);\n                    break;\n                }\n                vm_std_store.store(who, reads[i], prev);\n            }\n        } else {\n            require(false, \"stdStorage find(StdStorage): No storage use detected for target.\");\n        }", "highlightLines": [534]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 534, "column": 9}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "45d7c49be0d5", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        (bytes32[] memory reads, ) = vm_std_store.accesses(address(who));\n        if (reads.length == 1) {\n            bytes32 curr = vm_std_store.load(who, reads[0]);\n            if (curr == bytes32(0)) {\n                emit WARNING_UninitedSlot(who, uint256(reads[0]));\n            }\n            if (fdat != curr) {\n                require(false, \"stdStorage find(StdStorage): Packed slot. This would cause dangerous overwriting and currently isn't supported.\");\n            }\n            emit SlotFound(who, fsig, keccak256(abi.encodePacked(ins, field_depth)), uint256(reads[0]));\n            self.slots[who][fsig][keccak256(abi.encodePacked(ins, field_depth))] = uint256(reads[0]);\n            self.finds[who][fsig][keccak256(abi.encodePacked(ins, field_depth))] = true;\n        } else if (reads.length > 1) {\n            for (uint256 i = 0; i < reads.length; i++) {\n                bytes32 prev = vm_std_store.load(who, reads[i]);\n                if (prev == bytes32(0)) {\n                    emit WARNING_UninitedSlot(who, uint256(reads[i]));\n                }\n                // store\n                vm_std_store.store(who, reads[i], bytes32(hex\"1337\"));\n                bool success;\n                bytes memory rdat;\n                {\n                    (success, rdat) = who.staticcall(cald);\n                    fdat = bytesToBytes32(rdat, 32*field_depth);\n                }\n\n                if (success && fdat == bytes32(hex\"1337\")) {\n                    // we found which of the slots is the actual one\n                    emit SlotFound(who, fsig, keccak256(abi.encodePacked(ins, field_depth)), uint256(reads[i]));\n                    self.slots[who][fsig][keccak256(abi.encodePacked(ins, field_depth))] = uint256(reads[i]);\n                    self.finds[who][fsig][keccak256(abi.encodePacked(ins, field_depth))] = true;\n                    vm_std_store.store(who, reads[i], prev);\n                    break;\n                }\n                vm_std_store.store(who, reads[i], prev);\n            }\n        } else {\n            require(false, \"stdStorage find(StdStorage): No storage use detected for target.\");\n        }", "highlightLines": [534]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 534, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "a291739da215", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            bytes32 curr = vm_std_store.load(who, reads[0]);", "highlightLines": [536]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 536, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b1fbb0cebd7a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            bytes32 curr = vm_std_store.load(who, reads[0]);\n            if (curr == bytes32(0)) {\n                emit WARNING_UninitedSlot(who, uint256(reads[0]));\n            }\n            if (fdat != curr) {\n                require(false, \"stdStorage find(StdStorage): Packed slot. This would cause dangerous overwriting and currently isn't supported.\");\n            }\n            emit SlotFound(who, fsig, keccak256(abi.encodePacked(ins, field_depth)), uint256(reads[0]));\n            self.slots[who][fsig][keccak256(abi.encodePacked(ins, field_depth))] = uint256(reads[0]);", "highlightLines": [536]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 536, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "7cba8963c25f", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "            emit SlotFound(who, fsig, keccak256(abi.encodePacked(ins, field_depth)), uint256(reads[0]));", "highlightLines": [543]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 543, "column": 39}, "severity": "high", "references": [], "description": ""}, {"id": "3e62c33f8a0d", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "            emit SlotFound(who, fsig, keccak256(abi.encodePacked(ins, field_depth)), uint256(reads[0]));", "highlightLines": [543]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 543, "column": 49}, "severity": "medium", "references": [], "description": ""}, {"id": "e0b4efda0694", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            self.slots[who][fsig][keccak256(abi.encodePacked(ins, field_depth))] = uint256(reads[0]);\n            self.finds[who][fsig][keccak256(abi.encodePacked(ins, field_depth))] = true;", "highlightLines": [544]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 544, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "6895b016b41f", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "            self.slots[who][fsig][keccak256(abi.encodePacked(ins, field_depth))] = uint256(reads[0]);", "highlightLines": [544]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 544, "column": 35}, "severity": "high", "references": [], "description": ""}, {"id": "1eaf37b97738", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "            self.slots[who][fsig][keccak256(abi.encodePacked(ins, field_depth))] = uint256(reads[0]);", "highlightLines": [544]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 544, "column": 45}, "severity": "medium", "references": [], "description": ""}, {"id": "e7f05e7eb59e", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "            self.finds[who][fsig][keccak256(abi.encodePacked(ins, field_depth))] = true;", "highlightLines": [545]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 545, "column": 35}, "severity": "high", "references": [], "description": ""}, {"id": "bdebe88509a5", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "            self.finds[who][fsig][keccak256(abi.encodePacked(ins, field_depth))] = true;", "highlightLines": [545]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 545, "column": 45}, "severity": "medium", "references": [], "description": ""}, {"id": "16b1b3ba78b0", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "                bytes32 prev = vm_std_store.load(who, reads[i]);", "highlightLines": [548]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 548, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4b6a4bf6d343", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "                bytes32 prev = vm_std_store.load(who, reads[i]);\n                if (prev == bytes32(0)) {\n                    emit WARNING_UninitedSlot(who, uint256(reads[i]));\n                }\n                // store\n                vm_std_store.store(who, reads[i], bytes32(hex\"1337\"));\n                bool success;\n                bytes memory rdat;\n                {\n                    (success, rdat) = who.staticcall(cald);\n                    fdat = bytesToBytes32(rdat, 32*field_depth);\n                }", "highlightLines": [548]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 548, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "ae786c1753c3", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "                bool success;", "highlightLines": [554]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 554, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b7c9f45d9c36", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "                    (success, rdat) = who.staticcall(cald);\n                    fdat = bytesToBytes32(rdat, 32*field_depth);", "highlightLines": [557]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 557, "column": 21}, "severity": "medium", "references": [], "description": ""}, {"id": "52b0f4d0acff", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "                    (success, rdat) = who.staticcall(cald);", "highlightLines": [557]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 557, "column": 39}, "severity": "medium", "references": [], "description": ""}, {"id": "6733507cd167", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "                    emit SlotFound(who, fsig, keccak256(abi.encodePacked(ins, field_depth)), uint256(reads[i]));", "highlightLines": [563]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 563, "column": 47}, "severity": "high", "references": [], "description": ""}, {"id": "1dda64e65446", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "                    emit SlotFound(who, fsig, keccak256(abi.encodePacked(ins, field_depth)), uint256(reads[i]));", "highlightLines": [563]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 563, "column": 57}, "severity": "medium", "references": [], "description": ""}, {"id": "99eeeb13eb25", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "                    self.slots[who][fsig][keccak256(abi.encodePacked(ins, field_depth))] = uint256(reads[i]);\n                    self.finds[who][fsig][keccak256(abi.encodePacked(ins, field_depth))] = true;", "highlightLines": [564]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 564, "column": 21}, "severity": "medium", "references": [], "description": ""}, {"id": "2f951f393fd2", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "                    self.slots[who][fsig][keccak256(abi.encodePacked(ins, field_depth))] = uint256(reads[i]);", "highlightLines": [564]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 564, "column": 43}, "severity": "high", "references": [], "description": ""}, {"id": "adf828f66ff2", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "                    self.slots[who][fsig][keccak256(abi.encodePacked(ins, field_depth))] = uint256(reads[i]);", "highlightLines": [564]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 564, "column": 53}, "severity": "medium", "references": [], "description": ""}, {"id": "87c1450555ed", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "                    self.finds[who][fsig][keccak256(abi.encodePacked(ins, field_depth))] = true;", "highlightLines": [565]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 565, "column": 43}, "severity": "high", "references": [], "description": ""}, {"id": "f757fe15d7f1", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "                    self.finds[who][fsig][keccak256(abi.encodePacked(ins, field_depth))] = true;", "highlightLines": [565]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 565, "column": 53}, "severity": "medium", "references": [], "description": ""}, {"id": "262a27f5583e", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "                    break;", "highlightLines": [567]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 567, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "1061367374d2", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        require(self.finds[who][fsig][keccak256(abi.encodePacked(ins, field_depth))], \"stdStorage find(StdStorage): Slot(s) not found.\");", "highlightLines": [575]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 575, "column": 39}, "severity": "high", "references": [], "description": ""}, {"id": "0b85befe4a69", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "        require(self.finds[who][fsig][keccak256(abi.encodePacked(ins, field_depth))], \"stdStorage find(StdStorage): Slot(s) not found.\");", "highlightLines": [575]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 575, "column": 49}, "severity": "medium", "references": [], "description": ""}, {"id": "91c6c9c403cc", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        return self.slots[who][fsig][keccak256(abi.encodePacked(ins, field_depth))];", "highlightLines": [582]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 582, "column": 38}, "severity": "high", "references": [], "description": ""}, {"id": "2875dc5c9ea3", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "        return self.slots[who][fsig][keccak256(abi.encodePacked(ins, field_depth))];", "highlightLines": [582]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 582, "column": 48}, "severity": "medium", "references": [], "description": ""}, {"id": "ca5402a28439", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function target(StdStorage storage self, address _target) internal returns (StdStorage storage) {\n        self._target = _target;", "highlightLines": [585]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 585, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "7a9172f70bb5", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function sig(StdStorage storage self, bytes4 _sig) internal returns (StdStorage storage) {\n        self._sig = _sig;", "highlightLines": [590]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 590, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "77f9a6745586", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function sig(StdStorage storage self, string memory _sig) internal returns (StdStorage storage) {\n        self._sig = sigs(_sig);", "highlightLines": [595]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 595, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "0d6a467d8031", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function depth(StdStorage storage self, uint256 _depth) internal returns (StdStorage storage) {\n        self._depth = _depth;", "highlightLines": [614]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 614, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "c0f313f04891", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 t;", "highlightLines": [628]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 628, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "17b01acc53a9", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [630]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 630, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "9f1b4f2c292a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address who = self._target;", "highlightLines": [640]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 640, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "cff0d13028ae", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address who = self._target;\n        bytes4 fsig = self._sig;", "highlightLines": [640]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 640, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "8a721429af60", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes4 fsig = self._sig;", "highlightLines": [641]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 641, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "068051cde584", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes4 fsig = self._sig;\n        uint256 field_depth = self._depth;", "highlightLines": [641]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 641, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "523ec68a4068", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 field_depth = self._depth;", "highlightLines": [642]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 642, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a6348686d0da", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 field_depth = self._depth;\n        bytes32[] memory ins = self._keys;", "highlightLines": [642]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 642, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "484e66b93c8f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes32[] memory ins = self._keys;\n\n        bytes memory cald = abi.encodePacked(fsig, flatten(ins));", "highlightLines": [643]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 643, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "908ff285dd8b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes memory cald = abi.encodePacked(fsig, flatten(ins));\n        if (!self.finds[who][fsig][keccak256(abi.encodePacked(ins, field_depth))]) {\n            find(self);\n        }\n        bytes32 slot = bytes32(self.slots[who][fsig][keccak256(abi.encodePacked(ins, field_depth))]);", "highlightLines": [645]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 645, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "54c5ad8d3827", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "        bytes memory cald = abi.encodePacked(fsig, flatten(ins));", "highlightLines": [645]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 645, "column": 29}, "severity": "medium", "references": [], "description": ""}, {"id": "bfde4e9ae79d", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        if (!self.finds[who][fsig][keccak256(abi.encodePacked(ins, field_depth))]) {", "highlightLines": [646]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 646, "column": 36}, "severity": "high", "references": [], "description": ""}, {"id": "27ac1a0faab2", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "        if (!self.finds[who][fsig][keccak256(abi.encodePacked(ins, field_depth))]) {", "highlightLines": [646]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 646, "column": 46}, "severity": "medium", "references": [], "description": ""}, {"id": "7c17920994f5", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 slot = bytes32(self.slots[who][fsig][keccak256(abi.encodePacked(ins, field_depth))]);", "highlightLines": [649]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 649, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3490e9e2ea7b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes32 slot = bytes32(self.slots[who][fsig][keccak256(abi.encodePacked(ins, field_depth))]);\n\n        bytes32 fdat;\n        {\n            (, bytes memory rdat) = who.staticcall(cald);\n            fdat = bytesToBytes32(rdat, 32*field_depth);\n        }", "highlightLines": [649]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 649, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "c6e994b57612", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        bytes32 slot = bytes32(self.slots[who][fsig][keccak256(abi.encodePacked(ins, field_depth))]);", "highlightLines": [649]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 649, "column": 54}, "severity": "high", "references": [], "description": ""}, {"id": "80a82cfa1fdd", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "        bytes32 slot = bytes32(self.slots[who][fsig][keccak256(abi.encodePacked(ins, field_depth))]);", "highlightLines": [649]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 649, "column": 64}, "severity": "medium", "references": [], "description": ""}, {"id": "193253cf4eed", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        bytes32 fdat;", "highlightLines": [650]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 650, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4a9af08fcf55", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            (, bytes memory rdat) = who.staticcall(cald);\n            fdat = bytesToBytes32(rdat, 32*field_depth);", "highlightLines": [653]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 653, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "9d237d868741", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "            (, bytes memory rdat) = who.staticcall(cald);", "highlightLines": [653]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 653, "column": 37}, "severity": "medium", "references": [], "description": ""}, {"id": "48397a6e05e5", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 curr = vm_std_store.load(who, slot);", "highlightLines": [656]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 656, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "434657a41b6d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address t = self._target;", "highlightLines": [669]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 669, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "750fbdc794bd", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address t = self._target;\n        uint256 s = find(self);", "highlightLines": [669]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 669, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "04667da15a61", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 s = find(self);", "highlightLines": [670]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 670, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "33e90d5cb65d", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "    function read_bool(StdStorage storage self) internal returns (bool) {\n        int256 v = read_int(self);\n        if (v == 0) return false;\n        if (v == 1) return true;\n        revert(\"stdStorage read_bool(StdStorage): Cannot decode. Make sure you are reading a bool.\");", "highlightLines": [679]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 679, "column": 5}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "1f9c6b529715", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        int256 v = read_int(self);", "highlightLines": [680]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 680, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "015a2869ffa5", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "        if (v == 0) return false;\n        if (v == 1) return true;", "highlightLines": [681]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 681, "column": 21}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "2a4e83d1d605", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "        if (v == 1) return true;\n        revert(\"stdStorage read_bool(StdStorage): Cannot decode. Make sure you are reading a bool.\");", "highlightLines": [682]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 682, "column": 21}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "57ebd9935861", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function bytesToBytes32(bytes memory b, uint offset) public pure returns (bytes32) {\n        bytes32 out;\n\n        uint256 max = b.length > 32 ? 32 : b.length;\n        for (uint i = 0; i < max; i++) {", "highlightLines": [698]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 698, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "68c6ba24b7b9", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 out;", "highlightLines": [699]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 699, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f3cbd31f5bf6", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 max = b.length > 32 ? 32 : b.length;", "highlightLines": [700]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 700, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "726a42cc0860", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "            out |= bytes32(b[offset + i] & 0xFF) >> (i * 8);", "highlightLines": [703]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 703, "column": 20}, "severity": "medium", "references": [], "description": ""}, {"id": "a33a1743d6e0", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function flatten(bytes32[] memory b) private pure returns (bytes memory)\n    {\n        bytes memory result = new bytes(b.length * 32);\n        for (uint256 i = 0; i < b.length; i++) {\n            bytes32 k = b[i];", "highlightLines": [708]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 708, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "130c4a0c9fc7", "fix": {"template": null, "available": false}, "title": "View/pure function uses assembly - may modify state unexpectedly", "ruleId": "rules.sol-constant-function-assembly", "snippet": {"code": "    function flatten(bytes32[] memory b) private pure returns (bytes memory)\n    {\n        bytes memory result = new bytes(b.length * 32);\n        for (uint256 i = 0; i < b.length; i++) {\n            bytes32 k = b[i];\n            /// @solidity memory-safe-assembly\n            assembly {", "highlightLines": [708]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 708, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-using-assembly-code"], "description": ""}, {"id": "cd12feeaffa3", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes memory result = new bytes(b.length * 32);\n        for (uint256 i = 0; i < b.length; i++) {\n            bytes32 k = b[i];\n            /// @solidity memory-safe-assembly\n            assembly {\n                mstore(add(result, add(32, mul(32, i))), k)\n            }\n        }", "highlightLines": [710]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 710, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "a757d6baaabe", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        bytes memory result = new bytes(b.length * 32);", "highlightLines": [710]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 710, "column": 31}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "1fd78752e60e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            bytes32 k = b[i];", "highlightLines": [712]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 712, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "bc22eec758f1", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "            assembly {", "highlightLines": [714]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 714, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "b27d55acaf18", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function abs(int256 a) internal pure returns (uint256) {\n        // Required or it will fail when `a = type(int256).min`", "highlightLines": [730]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 730, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "21d5cea66fc1", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function abs(int256 a) internal pure returns (uint256) {\n        // Required or it will fail when `a = type(int256).min`\n        if (a == INT256_MIN)", "highlightLines": [730]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 730, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "c3ca36e65fae", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "            return 57896044618658097711785492504343953926634992332820282019728792003956564819968;\n\n        return uint256(a > 0 ? a : -a);", "highlightLines": [733]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 733, "column": 13}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "2855af2cda37", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function percentDelta(uint256 a, uint256 b) internal pure returns (uint256) {\n        uint256 absDelta = delta(a, b);", "highlightLines": [755]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 755, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "951d105a9e72", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 absDelta = delta(a, b);", "highlightLines": [756]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 756, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a6e6f602fcbd", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimal assumption - tokens with >18 or <18 decimals will cause overflow/underflow", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        return absDelta * 1e18 / b;", "highlightLines": [758]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 758, "column": 25}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20"], "description": ""}, {"id": "414c864d32ad", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        return absDelta * 1e18 / b;", "highlightLines": [758]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 758, "column": 27}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "0d60cc0a90c0", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function percentDelta(int256 a, int256 b) internal pure returns (uint256) {\n        uint256 absDelta = delta(a, b);\n        uint256 absB = abs(b);", "highlightLines": [761]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 761, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "898e051e764e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 absDelta = delta(a, b);", "highlightLines": [762]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 762, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "519d3cf49f4c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 absDelta = delta(a, b);\n        uint256 absB = abs(b);", "highlightLines": [762]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 762, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "24c2557ed28a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 absB = abs(b);", "highlightLines": [763]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 763, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "169fd16c2e2a", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimal assumption - tokens with >18 or <18 decimals will cause overflow/underflow", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        return absDelta * 1e18 / absB;", "highlightLines": [765]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 765, "column": 25}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20"], "description": ""}, {"id": "b070bbb19b43", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        return absDelta * 1e18 / absB;", "highlightLines": [765]}, "category": "code", "location": {"file": "lib/forge-std/src/Test.sol", "line": 765, "column": 27}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "f5167fd5ac5c", "fix": {"template": null, "available": false}, "title": "ABIEncoderV2 is experimental and has had 20+ high-severity bugs - avoid in production", "ruleId": "rules.sol-abiencoderv2-experimental", "snippet": {"code": "pragma experimental ABIEncoderV2;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/forge-std/src/Vm.sol", "line": 3, "column": 1}, "severity": "medium", "references": [], "description": ""}, {"id": "dfb51253b5b9", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes data;", "highlightLines": [8]}, "category": "code", "location": {"file": "lib/forge-std/src/Vm.sol", "line": 8, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "5c28f73ae265", "fix": {"template": null, "available": false}, "title": "Storage write without access control - arbitrary data manipulation", "ruleId": "rules.sol-unprotected-storage-write", "snippet": {"code": "    function store(address,bytes32,bytes32) external;\n    // Signs data, (privateKey, digest) => (v, r, s)\n    function sign(uint256,bytes32) external returns (uint8,bytes32,bytes32);\n    // Gets the address for a given private key, (privateKey) => (address)\n    function addr(uint256) external returns (address);\n    // Gets the nonce of an account\n    function getNonce(address) external returns (uint64);\n    // Sets the nonce of an account; must be higher than the current nonce of the account\n    function setNonce(address, uint64) external;\n    // Performs a foreign function call via the terminal, (stringInputs) => (result)\n    function ffi(string[] calldata) external returns (bytes memory);\n    // Sets environment variables, (name, value)\n    function setEnv(string calldata, string calldata) external;\n    // Reads environment variables, (name) => (value)\n    function envBool(string calldata) external returns (bool);\n    function envUint(string calldata) external returns (uint256);\n    function envInt(string calldata) external returns (int256);\n    function envAddress(string calldata) external returns (address);\n    function envBytes32(string calldata) external returns (bytes32);\n    function envString(string calldata) external returns (string memory);\n    function envBytes(string calldata) external returns (bytes memory);\n    // Reads environment variables as arrays, (name, delim) => (value[])\n    function envBool(string calldata, string calldata) external returns (bool[] memory);\n    function envUint(string calldata, string calldata) external returns (uint256[] memory);\n    function envInt(string calldata, string calldata) external returns (int256[] memory);\n    function envAddress(string calldata, string calldata) external returns (address[] memory);\n    function envBytes32(string calldata, string calldata) external returns (bytes32[] memory);\n    function envString(string calldata, string calldata) external returns (string[] memory);\n    function envBytes(string calldata, string calldata) external returns (bytes[] memory);\n    // Sets the *next* call's msg.sender to be the input address\n    function prank(address) external;\n    // Sets all subsequent calls' msg.sender to be the input address until `stopPrank` is called\n    function startPrank(address) external;\n    // Sets the *next* call's msg.sender to be the input address, and the tx.origin to be the second input\n    function prank(address,address) external;\n    // Sets all subsequent calls' msg.sender to be the input address until `stopPrank` is called, and the tx.origin to be the second input\n    function startPrank(address,address) external;\n    // Resets subsequent calls' msg.sender to be `address(this)`\n    function stopPrank() external;\n    // Sets an address' balance, (who, newBalance)\n    function deal(address, uint256) external;\n    // Sets an address' code, (who, newCode)\n    function etch(address, bytes calldata) external;\n    // Expects an error on next call\n    function expectRevert(bytes calldata) external;\n    function expectRevert(bytes4) external;\n    function expectRevert() external;\n    // Records all storage reads and writes\n    function record() external;\n    // Gets all accessed reads and write slot from a recording session, for a given address\n    function accesses(address) external returns (bytes32[] memory reads, bytes32[] memory writes);\n    // Prepare an expected log with (bool checkTopic1, bool checkTopic2, bool checkTopic3, bool checkData).\n    // Call this function, then emit an event, then call a function. Internally after the call, we check if\n    // logs were emitted in the expected order with the expected topics and data (as specified by the booleans)\n    function expectEmit(bool,bool,bool,bool) external;\n    function expectEmit(bool,bool,bool,bool,address) external;\n    // Mocks a call to an address, returning specified data.\n    // Calldata can either be strict or a partial match, e.g. if you only\n    // pass a Solidity selector to the expected calldata, then the entire Solidity\n    // function will be mocked.\n    function mockCall(address,bytes calldata,bytes calldata) external;\n    // Mocks a call to an address with a specific msg.value, returning specified data.\n    // Calldata match takes precedence over msg.value in case of ambiguity.\n    function mockCall(address,uint256,bytes calldata,bytes calldata) external;\n    // Clears all mocked calls\n    function clearMockedCalls() external;\n    // Expects a call to an address with the specified calldata.\n    // Calldata can either be a strict or a partial match\n    function expectCall(address,bytes calldata) external;\n    // Expects a call to an address with the specified msg.value and calldata\n    function expectCall(address,uint256,bytes calldata) external;\n    // Gets the code from an artifact file. Takes in the relative path to the json file\n    function getCode(string calldata) external returns (bytes memory);\n    // Labels an address in call traces\n    function label(address, string calldata) external;\n    // If the condition is false, discard this run's fuzz inputs and generate new ones\n    function assume(bool) external;\n    // Sets block.coinbase (who)\n    function coinbase(address) external;\n    // Using the address that calls the test contract, has the next call (at this call depth only) create a transaction that can later be signed and sent onchain\n    function broadcast() external;\n    // Has the next call (at this call depth only) create a transaction with the address provided as the sender that can later be signed and sent onchain\n    function broadcast(address) external;\n    // Using the address that calls the test contract, has all subsequent calls (at this call depth only) create transactions that can later be signed and sent onchain\n    function startBroadcast() external;\n    // Has all subsequent calls (at this call depth only) create transactions that can later be signed and sent onchain\n    function startBroadcast(address) external;\n    // Stops collecting onchain transactions\n    function stopBroadcast() external;\n    // Reads the entire content of file to string, (path) => (data)\n    function readFile(string calldata) external returns (string memory);\n    // Reads next line of file to string, (path) => (line)\n    function readLine(string calldata) external returns (string memory);\n    // Writes data to file, creating a file if it does not exist, and entirely replacing its contents if it does.\n    // (path, data) => ()\n    function writeFile(string calldata, string calldata) external;\n    // Writes line to file, creating a file if it does not exist.\n    // (path, data) => ()\n    function writeLine(string calldata, string calldata) external;\n    // Closes file for reading, resetting the offset and allowing to read it from beginning with readLine.\n    // (path) => ()\n    function closeFile(string calldata) external;\n    // Removes file. This cheatcode will revert in the following situations, but is not limited to just these cases:\n    // - Path points to a directory.\n    // - The file doesn't exist.\n    // - The user lacks permissions to remove the file.\n    // (path) => ()\n    function removeFile(string calldata) external;\n    // Convert values to a string, (value) => (stringified value)\n    function toString(address) external returns(string memory);\n    function toString(bytes calldata) external returns(string memory);\n    function toString(bytes32) external returns(string memory);\n    function toString(bool) external returns(string memory);\n    function toString(uint256) external returns(string memory);\n    function toString(int256) external returns(string memory);\n    // Record all the transaction logs\n    function recordLogs() external;\n    // Gets all the recorded logs, () => (logs)\n    function getRecordedLogs() external returns (Log[] memory);\n    // Snapshot the current state of the evm.\n    // Returns the id of the snapshot that was created.\n    // To revert a snapshot use `revertTo`\n    function snapshot() external returns(uint256);\n    // Revert the state of the evm to a previous snapshot\n    // Takes the snapshot id to revert to.\n    // This deletes the snapshot and all snapshots taken after the given snapshot id.\n    function revertTo(uint256) external returns(bool);\n    // Creates a new fork with the given endpoint and block and returns the identifier of the fork\n    function createFork(string calldata,uint256) external returns(uint256);\n    // Creates a new fork with the given endpoint and the _latest_ block and returns the identifier of the fork\n    function createFork(string calldata) external returns(uint256);\n    // Creates _and_ also selects a new fork with the given endpoint and block and returns the identifier of the fork\n    function createSelectFork(string calldata,uint256) external returns(uint256);\n    // Creates _and_ also selects a new fork with the given endpoint and the latest block and returns the identifier of the fork\n    function createSelectFork(string calldata) external returns(uint256);\n    // Takes a fork identifier created by `createFork` and sets the corresponding forked state as active.\n    function selectFork(uint256) external;\n    /// Returns the currently active fork\n    /// Reverts if no fork is currently active\n    function activeFork() external returns(uint256);\n    // Updates the currently active fork to given block number\n    // This is similar to `roll` but for the currently active fork\n    function rollFork(uint256) external;\n    // Updates the given fork to given block number\n    function rollFork(uint256 forkId, uint256 blockNumber) external;\n    /// Returns the RPC url for the given alias\n    function rpcUrl(string calldata) external returns(string memory);\n    /// Returns all rpc urls and their aliases `[alias, url][]`\n    function rpcUrls() external returns(string[2][] memory);\n    // Derive a private key from a provided mnenomic string (or mnenomic file path) at the derivation path m/44'/60'/0'/0/{index}", "highlightLines": [22]}, "category": "code", "location": {"file": "lib/forge-std/src/Vm.sol", "line": 22, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "f3c4847e662e", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function _sendLogPayload(bytes memory payload) private view {\n        uint256 payloadLength = payload.length;\n        address consoleAddress = CONSOLE_ADDRESS;", "highlightLines": [7]}, "category": "code", "location": {"file": "lib/forge-std/src/console.sol", "line": 7, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "8b21dbb9ef48", "fix": {"template": null, "available": false}, "title": "View/pure function uses assembly - may modify state unexpectedly", "ruleId": "rules.sol-constant-function-assembly", "snippet": {"code": "    function _sendLogPayload(bytes memory payload) private view {\n        uint256 payloadLength = payload.length;\n        address consoleAddress = CONSOLE_ADDRESS;\n        /// @solidity memory-safe-assembly\n        assembly {", "highlightLines": [7]}, "category": "code", "location": {"file": "lib/forge-std/src/console.sol", "line": 7, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-using-assembly-code"], "description": ""}, {"id": "28a37d2bf43d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 payloadLength = payload.length;", "highlightLines": [8]}, "category": "code", "location": {"file": "lib/forge-std/src/console.sol", "line": 8, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "2bd158b86a4c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 payloadLength = payload.length;\n        address consoleAddress = CONSOLE_ADDRESS;", "highlightLines": [8]}, "category": "code", "location": {"file": "lib/forge-std/src/console.sol", "line": 8, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "ec026c126555", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address consoleAddress = CONSOLE_ADDRESS;", "highlightLines": [9]}, "category": "code", "location": {"file": "lib/forge-std/src/console.sol", "line": 9, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e5c9b344c7a7", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address consoleAddress = CONSOLE_ADDRESS;\n        /// @solidity memory-safe-assembly\n        assembly {\n            let payloadStart := add(payload, 32)\n            let r := staticcall(gas(), consoleAddress, payloadStart, payloadLength, 0, 0)\n        }", "highlightLines": [9]}, "category": "code", "location": {"file": "lib/forge-std/src/console.sol", "line": 9, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "b2ea201c5c78", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [11]}, "category": "code", "location": {"file": "lib/forge-std/src/console.sol", "line": 11, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "f83de7bf65fc", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            let payloadStart := add(payload, 32)\n            let r := staticcall(gas(), consoleAddress, payloadStart, payloadLength, 0, 0)", "highlightLines": [12]}, "category": "code", "location": {"file": "lib/forge-std/src/console.sol", "line": 12, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "164e0e0f4e20", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function _sendLogPayload(bytes memory payload) private view {\n        uint256 payloadLength = payload.length;\n        address consoleAddress = CONSOLE_ADDRESS;", "highlightLines": [13]}, "category": "code", "location": {"file": "lib/forge-std/src/console2.sol", "line": 13, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "7903c0131626", "fix": {"template": null, "available": false}, "title": "View/pure function uses assembly - may modify state unexpectedly", "ruleId": "rules.sol-constant-function-assembly", "snippet": {"code": "    function _sendLogPayload(bytes memory payload) private view {\n        uint256 payloadLength = payload.length;\n        address consoleAddress = CONSOLE_ADDRESS;\n        assembly {", "highlightLines": [13]}, "category": "code", "location": {"file": "lib/forge-std/src/console2.sol", "line": 13, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-using-assembly-code"], "description": ""}, {"id": "fccb0cba43f0", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 payloadLength = payload.length;", "highlightLines": [14]}, "category": "code", "location": {"file": "lib/forge-std/src/console2.sol", "line": 14, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "61cac9ae3248", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 payloadLength = payload.length;\n        address consoleAddress = CONSOLE_ADDRESS;", "highlightLines": [14]}, "category": "code", "location": {"file": "lib/forge-std/src/console2.sol", "line": 14, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "6604eb27a5b4", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address consoleAddress = CONSOLE_ADDRESS;", "highlightLines": [15]}, "category": "code", "location": {"file": "lib/forge-std/src/console2.sol", "line": 15, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "1a2db8f4ffb7", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address consoleAddress = CONSOLE_ADDRESS;\n        assembly {\n            let payloadStart := add(payload, 32)\n            let r := staticcall(gas(), consoleAddress, payloadStart, payloadLength, 0, 0)\n        }", "highlightLines": [15]}, "category": "code", "location": {"file": "lib/forge-std/src/console2.sol", "line": 15, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "59909d6b9e34", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [16]}, "category": "code", "location": {"file": "lib/forge-std/src/console2.sol", "line": 16, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "6c24988b4963", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            let payloadStart := add(payload, 32)\n            let r := staticcall(gas(), consoleAddress, payloadStart, payloadLength, 0, 0)", "highlightLines": [17]}, "category": "code", "location": {"file": "lib/forge-std/src/console2.sol", "line": 17, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "3e8afbc96ed9", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract ScriptTest is Test\n{\n     function testGenerateCorrectAddress() external {\n        address creation = computeCreateAddress(0x6C9FC64A53c1b71FB3f9Af64d1ae3A4931A5f4E9, 14);", "highlightLines": [6]}, "category": "code", "location": {"file": "lib/forge-std/src/test/Script.t.sol", "line": 6, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "9bd02aa1dd31", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address creation = computeCreateAddress(0x6C9FC64A53c1b71FB3f9Af64d1ae3A4931A5f4E9, 14);", "highlightLines": [9]}, "category": "code", "location": {"file": "lib/forge-std/src/test/Script.t.sol", "line": 9, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "aba08edfbf8e", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    TestTest t = new TestTest();", "highlightLines": [13]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 13, "column": 18}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "19f2b2f8d1fe", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function testAssertEq_Bool_Pass(bool a, bool b) external {\n        vm.assume(a == b);", "highlightLines": [53]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 53, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "e748209e895a", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function testAssertEq_Bool_Fail(bool a, bool b) external {\n        vm.assume(a != b);\n\n        vm.expectEmit(false, false, false, true);\n        emit log(\"Error: a == b not satisfied [bool]\");", "highlightLines": [59]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 59, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "512cd18d7429", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function testAssertEq_BoolErr_Pass(bool a, bool b) external {\n        vm.assume(a == b);", "highlightLines": [67]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 67, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "2fb4a2e92271", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function testAssertEq_Bytes_Fail(bytes calldata a, bytes calldata b) external {\n        vm.assume(keccak256(a) != keccak256(b));\n\n        vm.expectEmit(false, false, false, true);\n        emit log(\"Error: a == b not satisfied [bytes]\");", "highlightLines": [91]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 91, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "24eb489fe270", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256[] memory a = new uint256[](3);\n        a[0] = e0;", "highlightLines": [118]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 118, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "ef0fb79fdb45", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        uint256[] memory a = new uint256[](3);", "highlightLines": [118]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 118, "column": 30}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "f8390d546c81", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        a[0] = e0;\n        a[1] = e1;", "highlightLines": [119]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 119, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "b939179531be", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        a[1] = e1;\n        a[2] = e2;", "highlightLines": [120]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 120, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "278abc0cd3ee", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        a[2] = e2;\n        uint256[] memory b = new uint256[](3);", "highlightLines": [121]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 121, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "57b1847bf834", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256[] memory b = new uint256[](3);\n        b[0] = e0;", "highlightLines": [122]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 122, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "14eb169c39a8", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        uint256[] memory b = new uint256[](3);", "highlightLines": [122]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 122, "column": 30}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "8a674f732f43", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        b[0] = e0;\n        b[1] = e1;", "highlightLines": [123]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 123, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e807bf7cdf7b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        b[1] = e1;\n        b[2] = e2;", "highlightLines": [124]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 124, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "477eb70f3068", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        int256[] memory a = new int256[](3);\n        a[0] = e0;", "highlightLines": [131]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 131, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "1312781036e6", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        int256[] memory a = new int256[](3);", "highlightLines": [131]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 131, "column": 29}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "df19fb07ebd2", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        a[0] = e0;\n        a[1] = e1;", "highlightLines": [132]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 132, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "9cbe7e594ee2", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        a[1] = e1;\n        a[2] = e2;", "highlightLines": [133]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 133, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "b827124bb69a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        a[2] = e2;\n        int256[] memory b = new int256[](3);", "highlightLines": [134]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 134, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "2ff69e9f93a4", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        int256[] memory b = new int256[](3);\n        b[0] = e0;", "highlightLines": [135]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 135, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "99bf163a9786", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        int256[] memory b = new int256[](3);", "highlightLines": [135]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 135, "column": 29}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "e0a69bf9fc21", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        b[0] = e0;\n        b[1] = e1;", "highlightLines": [136]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 136, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "9bf3bfc03807", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        b[1] = e1;\n        b[2] = e2;", "highlightLines": [137]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 137, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "1fc44f7256a7", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address[] memory a = new address[](3);\n        a[0] = e0;", "highlightLines": [144]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 144, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "6b557a290e90", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        address[] memory a = new address[](3);", "highlightLines": [144]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 144, "column": 30}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "893f4bd46c36", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        a[0] = e0;\n        a[1] = e1;", "highlightLines": [145]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 145, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "1a6bf3d94d05", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        a[1] = e1;\n        a[2] = e2;", "highlightLines": [146]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 146, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "17ed8f69f8e2", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        a[2] = e2;\n        address[] memory b = new address[](3);", "highlightLines": [147]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 147, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d65e12f4d0bc", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address[] memory b = new address[](3);\n        b[0] = e0;", "highlightLines": [148]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 148, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "040779c3e2a9", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        address[] memory b = new address[](3);", "highlightLines": [148]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 148, "column": 30}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "1938e4166220", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        b[0] = e0;\n        b[1] = e1;", "highlightLines": [149]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 149, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e1e7258c1571", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        b[1] = e1;\n        b[2] = e2;", "highlightLines": [150]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 150, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "3fd557bc3431", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256[] memory a = new uint256[](3);\n        uint256[] memory b = new uint256[](3);", "highlightLines": [158]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 158, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "35697a32f055", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        uint256[] memory a = new uint256[](3);", "highlightLines": [158]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 158, "column": 30}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "5b8b953f5f1e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256[] memory b = new uint256[](3);\n        b[1] = e1;", "highlightLines": [159]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 159, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "5fb73095bf18", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        uint256[] memory b = new uint256[](3);", "highlightLines": [159]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 159, "column": 30}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "407c27d5b35b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        int256[] memory a = new int256[](3);\n        int256[] memory b = new int256[](3);", "highlightLines": [169]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 169, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "6ae916de0f61", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        int256[] memory a = new int256[](3);", "highlightLines": [169]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 169, "column": 29}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "c0e893184c09", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        int256[] memory b = new int256[](3);\n        b[1] = e1;", "highlightLines": [170]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 170, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "85eb0c5c1101", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        int256[] memory b = new int256[](3);", "highlightLines": [170]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 170, "column": 29}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "f227028d8130", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address[] memory a = new address[](3);\n        address[] memory b = new address[](3);", "highlightLines": [181]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 181, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "ae3b026b5ab1", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        address[] memory a = new address[](3);", "highlightLines": [181]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 181, "column": 30}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "cf2d9671ed28", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address[] memory b = new address[](3);\n        b[1] = e1;", "highlightLines": [182]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 182, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "720477febcb3", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        address[] memory b = new address[](3);", "highlightLines": [182]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 182, "column": 30}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "bce9658c9af0", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256[] memory a = new uint256[](3);\n        uint256[] memory b = new uint256[](3);", "highlightLines": [192]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 192, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "96bd86b107a4", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        uint256[] memory a = new uint256[](3);", "highlightLines": [192]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 192, "column": 30}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "eda884734ba1", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256[] memory b = new uint256[](3);\n        b[1] = e1;", "highlightLines": [193]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 193, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "9555c427d539", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        uint256[] memory b = new uint256[](3);", "highlightLines": [193]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 193, "column": 30}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "5cb743e5aa44", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        int256[] memory a = new int256[](3);\n        int256[] memory b = new int256[](3);", "highlightLines": [205]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 205, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "8ac052db9d1e", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        int256[] memory a = new int256[](3);", "highlightLines": [205]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 205, "column": 29}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "4fef49bf0022", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        int256[] memory b = new int256[](3);\n        b[1] = e1;", "highlightLines": [206]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 206, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "090cf4186a78", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        int256[] memory b = new int256[](3);", "highlightLines": [206]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 206, "column": 29}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "d17ee0d9f013", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address[] memory a = new address[](3);\n        address[] memory b = new address[](3);", "highlightLines": [219]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 219, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "70d4829c38ee", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        address[] memory a = new address[](3);", "highlightLines": [219]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 219, "column": 30}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "501369aab69d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address[] memory b = new address[](3);\n        b[1] = e1;", "highlightLines": [220]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 220, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "29d2a27f2adb", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        address[] memory b = new address[](3);", "highlightLines": [220]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 220, "column": 30}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "cd60a44cfeab", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256[] memory a = new uint256[](lenA);\n        uint256[] memory b = new uint256[](lenB);", "highlightLines": [234]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 234, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d4fe5758816e", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        uint256[] memory a = new uint256[](lenA);", "highlightLines": [234]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 234, "column": 30}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "9d5a81b787c6", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        uint256[] memory b = new uint256[](lenB);", "highlightLines": [235]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 235, "column": 30}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "289b70aa2243", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        int256[] memory a = new int256[](lenA);\n        int256[] memory b = new int256[](lenB);", "highlightLines": [246]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 246, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "b1ab8b7f7744", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        int256[] memory a = new int256[](lenA);", "highlightLines": [246]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 246, "column": 29}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "980ee0d58b85", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        int256[] memory b = new int256[](lenB);", "highlightLines": [247]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 247, "column": 29}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "b172995c391e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address[] memory a = new address[](lenA);\n        address[] memory b = new address[](lenB);", "highlightLines": [258]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 258, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "7a1e1d2854fd", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        address[] memory a = new address[](lenA);", "highlightLines": [258]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 258, "column": 30}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "7425cb37440c", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        address[] memory b = new address[](lenB);", "highlightLines": [259]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 259, "column": 30}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "378f485c24d5", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256[] memory a = new uint256[](lenA);\n        uint256[] memory b = new uint256[](lenB);", "highlightLines": [270]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 270, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "383bce25be0e", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        uint256[] memory a = new uint256[](lenA);", "highlightLines": [270]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 270, "column": 30}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "1340ded96f1c", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        uint256[] memory b = new uint256[](lenB);", "highlightLines": [271]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 271, "column": 30}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "8a6dd7ca65cc", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        int256[] memory a = new int256[](lenA);\n        int256[] memory b = new int256[](lenB);", "highlightLines": [284]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 284, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "baa65f10b534", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        int256[] memory a = new int256[](lenA);", "highlightLines": [284]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 284, "column": 29}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "637b30ba8e92", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        int256[] memory b = new int256[](lenB);", "highlightLines": [285]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 285, "column": 29}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "16af48fa9b6f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address[] memory a = new address[](lenA);\n        address[] memory b = new address[](lenB);", "highlightLines": [298]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 298, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "67510721d69a", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        address[] memory a = new address[](lenA);", "highlightLines": [298]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 298, "column": 30}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "772af2328642", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        address[] memory b = new address[](lenB);", "highlightLines": [299]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 299, "column": 30}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "73a9b97b9c9d", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract TestTest is Test\n{\n    modifier expectFailure(bool expectFail) {\n        bool preState = vm.load(HEVM_ADDRESS, bytes32(\"failed\")) != bytes32(0x00);\n        _;\n        bool postState = vm.load(HEVM_ADDRESS, bytes32(\"failed\")) != bytes32(0x00);", "highlightLines": [446]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 446, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "3f172a85d5e2", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "    modifier expectFailure(bool expectFail) {\n        bool preState = vm.load(HEVM_ADDRESS, bytes32(\"failed\")) != bytes32(0x00);\n        _;\n        bool postState = vm.load(HEVM_ADDRESS, bytes32(\"failed\")) != bytes32(0x00);\n\n        if (preState == true) {\n            return;\n        }", "highlightLines": [448]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 448, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "21054c996602", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier expectFailure(bool expectFail) {\n        bool preState = vm.load(HEVM_ADDRESS, bytes32(\"failed\")) != bytes32(0x00);\n        _;\n        bool postState = vm.load(HEVM_ADDRESS, bytes32(\"failed\")) != bytes32(0x00);\n\n        if (preState == true) {\n            return;\n        }\n\n        if (expectFail) {\n            require(postState == true, \"expected failure not triggered\");\n\n            // unwind the expected failure\n            vm.store(HEVM_ADDRESS, bytes32(\"failed\"), bytes32(uint256(0x00)));\n        } else {\n            require(postState == false, \"unexpected failure was triggered\");\n        }\n    }", "highlightLines": [448]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 448, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "4c172a1fbd37", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool preState = vm.load(HEVM_ADDRESS, bytes32(\"failed\")) != bytes32(0x00);", "highlightLines": [449]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 449, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "29d6882392fd", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bool preState = vm.load(HEVM_ADDRESS, bytes32(\"failed\")) != bytes32(0x00);\n        _;\n        bool postState = vm.load(HEVM_ADDRESS, bytes32(\"failed\")) != bytes32(0x00);", "highlightLines": [449]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 449, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "9cbb562a0e42", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [450]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 450, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "b53141ba13ed", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool postState = vm.load(HEVM_ADDRESS, bytes32(\"failed\")) != bytes32(0x00);", "highlightLines": [451]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 451, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "acb19fc3f4e5", "fix": {"template": null, "available": false}, "title": "Unnecessary comparison to boolean constant - use variable directly", "ruleId": "rules.sol-boolean-constant-comparison", "snippet": {"code": "        if (preState == true) {", "highlightLines": [453]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 453, "column": 22}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#boolean-equality"], "description": ""}, {"id": "ece751d6b174", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "            return;", "highlightLines": [454]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 454, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "05120cd7d3bc", "fix": {"template": null, "available": false}, "title": "Unnecessary comparison to boolean constant - use variable directly", "ruleId": "rules.sol-boolean-constant-comparison", "snippet": {"code": "            require(postState == true, \"expected failure not triggered\");", "highlightLines": [458]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 458, "column": 31}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#boolean-equality"], "description": ""}, {"id": "6a5092c7383d", "fix": {"template": null, "available": false}, "title": "Foundry vm.store() can modify arbitrary storage slots - bypasses all access controls", "ruleId": "rules.sol-foundry-vm-store", "snippet": {"code": "            vm.store(HEVM_ADDRESS, bytes32(\"failed\"), bytes32(uint256(0x00)));", "highlightLines": [461]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 461, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "698c8d4cbe56", "fix": {"template": null, "available": false}, "title": "Unnecessary comparison to boolean constant - use variable directly", "ruleId": "rules.sol-boolean-constant-comparison", "snippet": {"code": "            require(postState == false, \"unexpected failure was triggered\");", "highlightLines": [463]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdAssertions.t.sol", "line": 463, "column": 31}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#boolean-equality"], "description": ""}, {"id": "824d427a354d", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        test = new Bar();", "highlightLines": [10]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdCheats.t.sol", "line": 10, "column": 16}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "f04fbcd1d61e", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        assertEq(block.timestamp, 125);", "highlightLines": [16]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdCheats.t.sol", "line": 16, "column": 18}, "severity": "medium", "references": [], "description": ""}, {"id": "9545a28dc572", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        assertEq(block.timestamp, 75);", "highlightLines": [22]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdCheats.t.sol", "line": 22, "column": 18}, "severity": "medium", "references": [], "description": ""}, {"id": "06492012ae5b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        Bar barToken = new Bar();\n        address bar = address(barToken);", "highlightLines": [72]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdCheats.t.sol", "line": 72, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "057dc41576e5", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        Bar barToken = new Bar();", "highlightLines": [72]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdCheats.t.sol", "line": 72, "column": 24}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "5c3d10d75447", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address bar = address(barToken);", "highlightLines": [73]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdCheats.t.sol", "line": 73, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "cec255a8d53a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        Bar barToken = new Bar();\n        address bar = address(barToken);", "highlightLines": [79]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdCheats.t.sol", "line": 79, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "b8baec300abb", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        Bar barToken = new Bar();", "highlightLines": [79]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdCheats.t.sol", "line": 79, "column": 24}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "f326d0f045ea", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address bar = address(barToken);", "highlightLines": [80]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdCheats.t.sol", "line": 80, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "5cf8066512eb", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 bounded = bound(num, min, max);", "highlightLines": [109]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdCheats.t.sol", "line": 109, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b6741705510e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address deployed = deployCode(\"StdCheats.t.sol:StdCheatsTest\", bytes(\"\"));", "highlightLines": [132]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdCheats.t.sol", "line": 132, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "31bd14b03901", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address deployed = deployCode(\"StdCheats.t.sol:StdCheatsTest\");", "highlightLines": [137]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdCheats.t.sol", "line": 137, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "dbab99ac2faf", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor() payable {}", "highlightLines": [142]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdCheats.t.sol", "line": 142, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "c1186faf49f1", "fix": {"template": null, "available": false}, "title": "Empty constructor or constructor with no effect - may indicate incomplete implementation", "ruleId": "rules.sol-void-constructor", "snippet": {"code": "    constructor() payable {}", "highlightLines": [142]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdCheats.t.sol", "line": 142, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "610480a49a38", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address deployed = deployCode(\"StdCheats.t.sol:StdCheatsTest\", bytes(\"\"), 1 ether);", "highlightLines": [145]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdCheats.t.sol", "line": 145, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d47088ec2e6a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address deployed = deployCode(\"StdCheats.t.sol:StdCheatsTest\", 1 ether);", "highlightLines": [151]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdCheats.t.sol", "line": 151, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4a350a40136d", "fix": {"template": null, "available": false}, "title": "View/pure function uses assembly - may modify state unexpectedly", "ruleId": "rules.sol-constant-function-assembly", "snippet": {"code": "    function getCode(address who) internal view returns (bytes memory o_code) {\n        /// @solidity memory-safe-assembly\n        assembly {", "highlightLines": [166]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdCheats.t.sol", "line": 166, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-using-assembly-code"], "description": ""}, {"id": "d5699a2428dd", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function getCode(address who) internal view returns (bytes memory o_code) {\n        /// @solidity memory-safe-assembly\n        assembly {\n            // retrieve the size of the code, this needs assembly\n            let size := extcodesize(who)\n            // allocate output byte array - this could also be done without assembly\n            // by using o_code = new bytes(size)", "highlightLines": [166]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdCheats.t.sol", "line": 166, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "3ca32fc877e7", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [168]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdCheats.t.sol", "line": 168, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "509c5d56ee9d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            let size := extcodesize(who)\n            // allocate output byte array - this could also be done without assembly\n            // by using o_code = new bytes(size)\n            o_code := mload(0x40)", "highlightLines": [170]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdCheats.t.sol", "line": 170, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "545c18a100a9", "fix": {"template": null, "available": false}, "title": "extcodesize check can be bypassed during constructor - contracts have size 0 while being created", "ruleId": "rules.sol-extcodesize-check", "snippet": {"code": "            let size := extcodesize(who)", "highlightLines": [170]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdCheats.t.sol", "line": 170, "column": 25}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/18"], "description": ""}, {"id": "c6b8f26b65d9", "fix": {"template": null, "available": false}, "title": "extcodecopy from user-controlled address - can read arbitrary contract bytecode", "ruleId": "rules.sol-extcodecopy-arbitrary-address", "snippet": {"code": "            extcodecopy(who, add(o_code, 0x20), 0, size)", "highlightLines": [179]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdCheats.t.sol", "line": 179, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "8259e533c3b1", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor() {\n        /// `DEAL` STDCHEAT\n        totalSupply = 10000e18;\n        balanceOf[address(this)] = totalSupply;\n    }", "highlightLines": [185]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdCheats.t.sol", "line": 185, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "2c2c4ffcdbd9", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        totalSupply = 10000e18;\n        balanceOf[address(this)] = totalSupply;", "highlightLines": [187]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdCheats.t.sol", "line": 187, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "7edf37c23b25", "fix": {"template": null, "available": false}, "title": "tx.origin used for authorization - vulnerable to phishing attacks", "ruleId": "rules.sol-tx-origin-auth", "snippet": {"code": "        require(tx.origin == expectedSender, \"!prank\");", "highlightLines": [197]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdCheats.t.sol", "line": 197, "column": 9}, "severity": "high", "references": [], "description": ""}, {"id": "0e3bfc1c68a5", "fix": {"template": null, "available": false}, "title": "tx.origin used for authorization - vulnerable to phishing attacks", "ruleId": "rules.sol-tx-origin-auth", "snippet": {"code": "        require(tx.origin == expectedOrigin, \"!prank\");", "highlightLines": [201]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdCheats.t.sol", "line": 201, "column": 9}, "severity": "high", "references": [], "description": ""}, {"id": "12f3a2b514b8", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor() {\n        revert();\n    }", "highlightLines": [210]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdCheats.t.sol", "line": 210, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "bfb3476eb14a", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        test = new ErrorsTest();", "highlightLines": [10]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdError.t.sol", "line": 10, "column": 16}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "cf6256b68aff", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    bytes someBytes;", "highlightLines": [75]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdError.t.sol", "line": 75, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3c306b0fd7c6", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [99]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdError.t.sol", "line": 99, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "ea087c722d6b", "fix": {"template": null, "available": false}, "title": "Assembly sstore to function pointer slot - can hijack control flow", "ruleId": "rules.sol-sstore-function-pointer", "snippet": {"code": "        assembly {\n            sstore(someBytes.slot, 1)", "highlightLines": [99]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdError.t.sol", "line": 99, "column": 9}, "severity": "high", "references": [], "description": ""}, {"id": "5ea0ac002c05", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function indexOOBError(uint256 a) public pure {\n        uint256[] memory t = new uint256[](0);", "highlightLines": [109]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdError.t.sol", "line": 109, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "729ca2ba2742", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        uint256[] memory t = new uint256[](0);", "highlightLines": [110]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdError.t.sol", "line": 110, "column": 30}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "9d317e7a5fb3", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function mem() public pure {\n        uint256 l = 2**256 / 32;", "highlightLines": [114]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdError.t.sol", "line": 114, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "1a3c1db04899", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 l = 2**256 / 32;", "highlightLines": [115]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdError.t.sol", "line": 115, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "538b0051b294", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        new uint256[](l);", "highlightLines": [116]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdError.t.sol", "line": 116, "column": 9}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "29c4179e1a37", "fix": {"template": null, "available": false}, "title": "Function pointer stored in state variable - potential hijack target", "ruleId": "rules.sol-function-pointer-state", "snippet": {"code": "        function(uint256) internal returns (uint256) x;", "highlightLines": [120]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdError.t.sol", "line": 120, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "2ae71019ffe3", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "        assertEq(stdMath.abs(type(int256).min), (type(uint256).max >> 1) + 1);", "highlightLines": [14]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 14, "column": 50}, "severity": "medium", "references": [], "description": ""}, {"id": "ae66bf0fc1d2", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "        assertEq(stdMath.abs(type(int256).max), (type(uint256).max >> 1));", "highlightLines": [15]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 15, "column": 50}, "severity": "medium", "references": [], "description": ""}, {"id": "21c9e4dd4fca", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 manualAbs = getAbs(a);", "highlightLines": [19]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 19, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b3819d436e70", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 manualAbs = getAbs(a);\n\n        uint256 abs = stdMath.abs(a);", "highlightLines": [19]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 19, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "b2d80ed121a7", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 abs = stdMath.abs(a);", "highlightLines": [20]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 20, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c26b9cb73236", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 manualDelta;", "highlightLines": [45]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 45, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "761bf8132421", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 delta = stdMath.delta(a, b);", "highlightLines": [51]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 51, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "47d21b82f8f6", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "        assertEq(stdMath.delta(int256(0),           type(int64).max),   type(uint64).max >> 1);", "highlightLines": [60]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 60, "column": 73}, "severity": "medium", "references": [], "description": ""}, {"id": "ef7d4d7cb1e1", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "        assertEq(stdMath.delta(int256(0),           type(int128).max),  type(uint128).max >> 1);", "highlightLines": [61]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 61, "column": 73}, "severity": "medium", "references": [], "description": ""}, {"id": "ac984f401ed4", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "        assertEq(stdMath.delta(int256(0),           type(int256).max),  type(uint256).max >> 1);", "highlightLines": [62]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 62, "column": 73}, "severity": "medium", "references": [], "description": ""}, {"id": "4fc7c14a0051", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "        assertEq(stdMath.delta(type(int64).max,     int256(0)),         type(uint64).max >> 1);", "highlightLines": [66]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 66, "column": 73}, "severity": "medium", "references": [], "description": ""}, {"id": "b8e7cdd9eef4", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "        assertEq(stdMath.delta(type(int128).max,    int256(0)),         type(uint128).max >> 1);", "highlightLines": [67]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 67, "column": 73}, "severity": "medium", "references": [], "description": ""}, {"id": "2bbff11c10d1", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "        assertEq(stdMath.delta(type(int256).max,    int256(0)),         type(uint256).max >> 1);", "highlightLines": [68]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 68, "column": 73}, "severity": "medium", "references": [], "description": ""}, {"id": "9614b90fac95", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "        assertEq(stdMath.delta(type(int64).min,     int256(0)),         (type(uint64).max >> 1) + 1);", "highlightLines": [72]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 72, "column": 74}, "severity": "medium", "references": [], "description": ""}, {"id": "87031e1ba4c9", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "        assertEq(stdMath.delta(type(int128).min,    int256(0)),         (type(uint128).max >> 1) + 1);", "highlightLines": [73]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 73, "column": 74}, "severity": "medium", "references": [], "description": ""}, {"id": "e3c864d863e0", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "        assertEq(stdMath.delta(type(int256).min,    int256(0)),         (type(uint256).max >> 1) + 1);", "highlightLines": [74]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 74, "column": 74}, "severity": "medium", "references": [], "description": ""}, {"id": "a2bfa90eda58", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "        assertEq(stdMath.delta(int256(0),           type(int64).min),   (type(uint64).max >> 1) + 1);", "highlightLines": [78]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 78, "column": 74}, "severity": "medium", "references": [], "description": ""}, {"id": "9fc01b492086", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "        assertEq(stdMath.delta(int256(0),           type(int128).min),  (type(uint128).max >> 1) + 1);", "highlightLines": [79]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 79, "column": 74}, "severity": "medium", "references": [], "description": ""}, {"id": "4a75f4a5384e", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "        assertEq(stdMath.delta(int256(0),           type(int256).min),  (type(uint256).max >> 1) + 1);", "highlightLines": [80]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 80, "column": 74}, "severity": "medium", "references": [], "description": ""}, {"id": "6a3a4a9c052e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 absA = getAbs(a);", "highlightLines": [90]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 90, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "2a2e57f8e4ed", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 absA = getAbs(a);\n        uint256 absB = getAbs(b);", "highlightLines": [90]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 90, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "7be0901335b1", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 absB = getAbs(b);", "highlightLines": [91]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 91, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "781cabbed4fb", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 absB = getAbs(b);\n        uint256 absDelta = absA > absB\n            ? absA - absB\n            : absB - absA;", "highlightLines": [91]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 91, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "3c7cc63b7c12", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 absDelta = absA > absB", "highlightLines": [92]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 92, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d25cf896fd2e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 absDelta = absA > absB\n            ? absA - absB\n            : absB - absA;\n\n        uint256 manualDelta;\n        if ((a >= 0 && b >= 0) || (a < 0 && b < 0)) {\n            manualDelta = absDelta;\n        }\n        // (a < 0 && b >= 0) || (a >= 0 && b < 0)\n        else {\n            manualDelta = absA + absB;\n        }", "highlightLines": [92]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 92, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "cbbd37790c86", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 manualDelta;", "highlightLines": [95]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 95, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d9c3151c1373", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 delta = stdMath.delta(a, b);", "highlightLines": [104]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 104, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "62e43b674a64", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        assertEq(stdMath.percentDelta(uint256(0),           uint256(1337)),     1e18);", "highlightLines": [111]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 111, "column": 81}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "2c407b82920c", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        assertEq(stdMath.percentDelta(uint256(0),           type(uint64).max),  1e18);", "highlightLines": [112]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 112, "column": 81}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "2cf73ff7b545", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        assertEq(stdMath.percentDelta(uint256(0),           type(uint128).max), 1e18);", "highlightLines": [113]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 113, "column": 81}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "cbb257acb5fe", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        assertEq(stdMath.percentDelta(uint256(0),           type(uint192).max), 1e18);", "highlightLines": [114]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 114, "column": 81}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "af046fd64b9a", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        assertEq(stdMath.percentDelta(0,                    uint256(2500)),     1e18);", "highlightLines": [118]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 118, "column": 81}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "a8b01dc9938f", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        assertEq(stdMath.percentDelta(5000,                 uint256(2500)),     1e18);", "highlightLines": [120]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 120, "column": 81}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "adcdcd88adb5", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 manualDelta;", "highlightLines": [129]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 129, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "47874c5831aa", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 manualPercentDelta = manualDelta * 1e18 / b;", "highlightLines": [135]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 135, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "924e96c7cfb8", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 manualPercentDelta = manualDelta * 1e18 / b;\n        uint256 percentDelta = stdMath.percentDelta(a, b);", "highlightLines": [136]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 136, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "403812c9754d", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimal assumption - tokens with >18 or <18 decimals will cause overflow/underflow", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        uint256 manualPercentDelta = manualDelta * 1e18 / b;", "highlightLines": [136]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 136, "column": 50}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20"], "description": ""}, {"id": "aeccd46cd69d", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        uint256 manualPercentDelta = manualDelta * 1e18 / b;", "highlightLines": [136]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 136, "column": 52}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "64a1b2bf64a9", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 percentDelta = stdMath.percentDelta(a, b);", "highlightLines": [137]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 137, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "6a39a09b9f3d", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        assertEq(stdMath.percentDelta(int256(0),        int256(1337)),      1e18);", "highlightLines": [143]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 143, "column": 77}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "f30ebbf586e1", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        assertEq(stdMath.percentDelta(int256(0),        -1337),             1e18);", "highlightLines": [144]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 144, "column": 77}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "2a5cdcb92d3f", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        assertEq(stdMath.percentDelta(int256(0),        type(int64).min),   1e18);", "highlightLines": [145]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 145, "column": 77}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "2b4020e990d3", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        assertEq(stdMath.percentDelta(int256(0),        type(int128).min),  1e18);", "highlightLines": [146]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 146, "column": 77}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "ec6f24114719", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        assertEq(stdMath.percentDelta(int256(0),        type(int192).min),  1e18);", "highlightLines": [147]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 147, "column": 77}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "f6b756a27dd4", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        assertEq(stdMath.percentDelta(int256(0),        type(int64).max),   1e18);", "highlightLines": [148]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 148, "column": 77}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "bd29b1342ecb", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        assertEq(stdMath.percentDelta(int256(0),        type(int128).max),  1e18);", "highlightLines": [149]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 149, "column": 77}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "9681a5589d13", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        assertEq(stdMath.percentDelta(int256(0),        type(int192).max),  1e18);", "highlightLines": [150]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 150, "column": 77}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "82582ab9308c", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        assertEq(stdMath.percentDelta(0,                int256(2500)),      1e18);", "highlightLines": [158]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 158, "column": 77}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "4ac7fb5ac6c3", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        assertEq(stdMath.percentDelta(5000,             int256(2500)),      1e18);", "highlightLines": [160]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 160, "column": 77}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "8e4d3298e68e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 absA = getAbs(a);", "highlightLines": [169]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 169, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e91d3b489b6e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 absA = getAbs(a);\n        uint256 absB = getAbs(b);", "highlightLines": [169]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 169, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d98c6bbbdec8", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 absB = getAbs(b);", "highlightLines": [170]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 170, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a8270fcca108", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 absB = getAbs(b);\n        uint256 absDelta = absA > absB\n            ? absA - absB\n            : absB - absA;", "highlightLines": [170]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 170, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "62019c6e8a6d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 absDelta = absA > absB", "highlightLines": [171]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 171, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e6b6ad166ec8", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 absDelta = absA > absB\n            ? absA - absB\n            : absB - absA;\n\n        uint256 manualDelta;\n        if ((a >= 0 && b >= 0) || (a < 0 && b < 0)) {\n            manualDelta = absDelta;\n        }\n        // (a < 0 && b >= 0) || (a >= 0 && b < 0)\n        else {\n            manualDelta = absA + absB;\n        }", "highlightLines": [171]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 171, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "01a69710b586", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 manualDelta;", "highlightLines": [174]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 174, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f9365bde9538", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 manualPercentDelta = manualDelta * 1e18 / absB;", "highlightLines": [183]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 183, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ce1f8faac606", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 manualPercentDelta = manualDelta * 1e18 / absB;\n        uint256 percentDelta = stdMath.percentDelta(a, b);", "highlightLines": [184]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 184, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "84b24e153709", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimal assumption - tokens with >18 or <18 decimals will cause overflow/underflow", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        uint256 manualPercentDelta = manualDelta * 1e18 / absB;", "highlightLines": [184]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 184, "column": 50}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20"], "description": ""}, {"id": "7f26592eee46", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        uint256 manualPercentDelta = manualDelta * 1e18 / absB;", "highlightLines": [184]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 184, "column": 52}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "5ae7074048fe", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 percentDelta = stdMath.percentDelta(a, b);", "highlightLines": [185]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 185, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "1385fc1427dd", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function getAbs(int256 a) private pure returns (uint256) {\n        if (a < 0)\n            return a == type(int256).min ? uint256(type(int256).max) + 1 : uint256(-a);", "highlightLines": [194]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 194, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "76d391f1369e", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "            return a == type(int256).min ? uint256(type(int256).max) + 1 : uint256(-a);\n\n        return uint256(a);", "highlightLines": [196]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdMath.t.sol", "line": 196, "column": 13}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "7530541f769e", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        test = new StorageTest();", "highlightLines": [12]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdStorage.t.sol", "line": 12, "column": 16}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "fa43bb856fce", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 slot = stdstore", "highlightLines": [34]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdStorage.t.sol", "line": 34, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a1d91788e661", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        assertEq(uint256(keccak256(abi.encode(address(this), 4))), slot);", "highlightLines": [40]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdStorage.t.sol", "line": 40, "column": 26}, "severity": "high", "references": [], "description": ""}, {"id": "8fd7e138a614", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 slot = stdstore", "highlightLines": [44]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdStorage.t.sol", "line": 44, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7adade126b2a", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "       assertEq(uint256(keccak256(abi.encode(address(this), 4))) + 1, slot);", "highlightLines": [50]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdStorage.t.sol", "line": 50, "column": 25}, "severity": "high", "references": [], "description": ""}, {"id": "46fd4e3f6242", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 slot = stdstore", "highlightLines": [54]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdStorage.t.sol", "line": 54, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8585469625a1", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        assertEq(uint256(keccak256(abi.encode(address(this), keccak256(abi.encode(address(this), uint(5)))))), slot);", "highlightLines": [60]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdStorage.t.sol", "line": 60, "column": 26}, "severity": "high", "references": [], "description": ""}, {"id": "e988ae9eeb58", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "        assertEq(uint256(keccak256(abi.encode(address(this), keccak256(abi.encode(address(this), uint(5)))))), slot);", "highlightLines": [60]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdStorage.t.sol", "line": 60, "column": 98}, "severity": "info", "references": [], "description": ""}, {"id": "00dda8e2280a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 slot = stdstore", "highlightLines": [74]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdStorage.t.sol", "line": 74, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4dbb44e4cab2", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        assertEq(bytes32(uint256(keccak256(abi.encode(address(this), keccak256(abi.encode(address(this), uint(6)))))) + 0), bytes32(slot));", "highlightLines": [81]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdStorage.t.sol", "line": 81, "column": 34}, "severity": "high", "references": [], "description": ""}, {"id": "72226b6f2255", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "        assertEq(bytes32(uint256(keccak256(abi.encode(address(this), keccak256(abi.encode(address(this), uint(6)))))) + 0), bytes32(slot));", "highlightLines": [81]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdStorage.t.sol", "line": 81, "column": 106}, "severity": "info", "references": [], "description": ""}, {"id": "fdb285423eb7", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 slot = stdstore", "highlightLines": [85]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdStorage.t.sol", "line": 85, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "504014afc80b", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        assertEq(bytes32(uint256(keccak256(abi.encode(address(this), keccak256(abi.encode(address(this), uint(6)))))) + 1), bytes32(slot));", "highlightLines": [92]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdStorage.t.sol", "line": 92, "column": 34}, "severity": "high", "references": [], "description": ""}, {"id": "a656d3f18446", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "        assertEq(bytes32(uint256(keccak256(abi.encode(address(this), keccak256(abi.encode(address(this), uint(6)))))) + 1), bytes32(slot));", "highlightLines": [92]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdStorage.t.sol", "line": 92, "column": 106}, "severity": "info", "references": [], "description": ""}, {"id": "0189c203f8e1", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 slot = stdstore.target(address(test)).sig(test.basic.selector).depth(0).find();", "highlightLines": [146]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdStorage.t.sol", "line": 146, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e0da535e852f", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 slot = stdstore.target(address(test)).sig(test.basic.selector).depth(1).find();", "highlightLines": [151]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdStorage.t.sol", "line": 151, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "89dab6c17a42", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 slot = stdstore.target(address(test)).sig(test.map_addr.selector).with_key(address(this)).find();", "highlightLines": [170]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdStorage.t.sol", "line": 170, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "65e5e7f8d007", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        assertEq(uint256(keccak256(abi.encode(address(this), uint(1)))), slot);", "highlightLines": [171]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdStorage.t.sol", "line": 171, "column": 26}, "severity": "high", "references": [], "description": ""}, {"id": "8b8598a27ae5", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "        assertEq(uint256(keccak256(abi.encode(address(this), uint(1)))), slot);", "highlightLines": [171]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdStorage.t.sol", "line": 171, "column": 62}, "severity": "info", "references": [], "description": ""}, {"id": "4e9ec7fb03ef", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 slot = stdstore.target(address(test)).sig(test.map_uint.selector).with_key(100).find();", "highlightLines": [175]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdStorage.t.sol", "line": 175, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "07e9f0317337", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        assertEq(uint256(keccak256(abi.encode(100, uint(2)))), slot);", "highlightLines": [176]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdStorage.t.sol", "line": 176, "column": 26}, "severity": "high", "references": [], "description": ""}, {"id": "9298ece3a512", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "        assertEq(uint256(keccak256(abi.encode(100, uint(2)))), slot);", "highlightLines": [176]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdStorage.t.sol", "line": 176, "column": 52}, "severity": "info", "references": [], "description": ""}, {"id": "5d5a2b329718", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 full = test.map_packed(address(1337));", "highlightLines": [200]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdStorage.t.sol", "line": 200, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f4e61c582d31", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 full = test.map_packed(address(1337));\n        // keep upper 128, set lower 128 to 1337\n        full = (full & (uint256((1 << 128) - 1) << 128)) | 1337;", "highlightLines": [200]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdStorage.t.sol", "line": 200, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "bc8e93f3f4c8", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "        full = (full & (uint256((1 << 128) - 1) << 128)) | 1337;", "highlightLines": [202]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdStorage.t.sol", "line": 202, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "d1ea3fb20573", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 val = stdstore.target(address(test)).sig(test.tE.selector).read_bytes32();", "highlightLines": [222]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdStorage.t.sol", "line": 222, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b8eadaf5db75", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool val = stdstore.target(address(test)).sig(test.tB.selector).read_bool();", "highlightLines": [227]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdStorage.t.sol", "line": 227, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ed3e222c259d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool val = stdstore.target(address(test)).sig(test.tH.selector).read_bool();", "highlightLines": [232]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdStorage.t.sol", "line": 232, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "85d607206000", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address val = stdstore.target(address(test)).sig(test.tF.selector).read_address();", "highlightLines": [246]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdStorage.t.sol", "line": 246, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "1f7c81ca302c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 val = stdstore.target(address(test)).sig(test.exists.selector).read_uint();", "highlightLines": [251]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdStorage.t.sol", "line": 251, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0ae9d022be1c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        int256 val = stdstore.target(address(test)).sig(test.tG.selector).read_int();", "highlightLines": [256]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdStorage.t.sol", "line": 256, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ca16be2cb4b7", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 a;", "highlightLines": [280]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdStorage.t.sol", "line": 280, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8576d4a53239", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 b;", "highlightLines": [281]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdStorage.t.sol", "line": 281, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3a28085bf7c7", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor() {\n        basic = UnpackedStruct({\n            a: 1337,\n            b: 1337\n        });\n\n        uint256 two = (1<<128) | 1;\n        map_packed[msg.sender] = two;\n        map_packed[address(bytes20(uint160(1337)))] = 1<<128;\n    }", "highlightLines": [291]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdStorage.t.sol", "line": 291, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "6b99e18c2976", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        basic = UnpackedStruct({\n            a: 1337,\n            b: 1337\n        });\n\n        uint256 two = (1<<128) | 1;", "highlightLines": [292]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdStorage.t.sol", "line": 292, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e56e96a8db67", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 two = (1<<128) | 1;", "highlightLines": [296]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdStorage.t.sol", "line": 296, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "6239cbcd2e11", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 two = (1<<128) | 1;\n        map_packed[msg.sender] = two;", "highlightLines": [297]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdStorage.t.sol", "line": 297, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "ccafed37bef4", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "        uint256 two = (1<<128) | 1;", "highlightLines": [297]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdStorage.t.sol", "line": 297, "column": 24}, "severity": "medium", "references": [], "description": ""}, {"id": "83d855db0d61", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        map_packed[msg.sender] = two;\n        map_packed[address(bytes20(uint160(1337)))] = 1<<128;", "highlightLines": [298]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdStorage.t.sol", "line": 298, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "edef051bbd22", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "        map_packed[address(bytes20(uint160(1337)))] = 1<<128;", "highlightLines": [299]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdStorage.t.sol", "line": 299, "column": 55}, "severity": "medium", "references": [], "description": ""}, {"id": "1bb4929d7fc6", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "        return map_packed[who] >> 128;", "highlightLines": [303]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdStorage.t.sol", "line": 303, "column": 16}, "severity": "medium", "references": [], "description": ""}, {"id": "74cd3ff38faf", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "        return map_packed[who] & ((1 << 128) - 1);", "highlightLines": [307]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdStorage.t.sol", "line": 307, "column": 16}, "severity": "medium", "references": [], "description": ""}, {"id": "bd3ca89240f1", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function hidden() public view returns (bytes32 t) {\n        bytes32 slot = keccak256(\"my.random.var\");", "highlightLines": [310]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdStorage.t.sol", "line": 310, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "2ea021eef22c", "fix": {"template": null, "available": false}, "title": "View/pure function uses assembly - may modify state unexpectedly", "ruleId": "rules.sol-constant-function-assembly", "snippet": {"code": "    function hidden() public view returns (bytes32 t) {\n        bytes32 slot = keccak256(\"my.random.var\");\n        /// @solidity memory-safe-assembly\n        assembly {", "highlightLines": [310]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdStorage.t.sol", "line": 310, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-using-assembly-code"], "description": ""}, {"id": "08ad98d48228", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 slot = keccak256(\"my.random.var\");", "highlightLines": [311]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdStorage.t.sol", "line": 311, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "48f2a5d53d8b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes32 slot = keccak256(\"my.random.var\");\n        /// @solidity memory-safe-assembly\n        assembly {\n            t := sload(slot)\n        }", "highlightLines": [311]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdStorage.t.sol", "line": 311, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "0a03ed5841e2", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [313]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdStorage.t.sol", "line": 313, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "8d8a509ea071", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function const() public pure returns (bytes32 t) {\n        t = bytes32(hex\"1337\");", "highlightLines": [318]}, "category": "code", "location": {"file": "lib/forge-std/src/test/StdStorage.t.sol", "line": 318, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "aa571537426c", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(string memory name, string memory symbol) ERC20Permit(name) ERC20(name, symbol) {}", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/certora/harnesses/ERC20VotesHarness.sol", "line": 4, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "ef1cb85f7611", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.2;", "highlightLines": [2]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/certora/harnesses/WizardControlFirstPriority.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "3342f3adc500", "fix": {"template": null, "available": false}, "title": "Base constructor called multiple times through diamond inheritance - may initialize twice", "ruleId": "rules.sol-reused-constructor", "snippet": {"code": "contract WizardControlFirstPriority is Governor, GovernorProposalThreshold, GovernorCountingSimple, GovernorVotes, GovernorVotesQuorumFraction, GovernorTimelockControl {", "highlightLines": [18]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/certora/harnesses/WizardControlFirstPriority.sol", "line": 18, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#reused-base-constructor"], "description": ""}, {"id": "296af622e8cc", "fix": {"template": null, "available": false}, "title": "SWC-125: Multiple inheritance may cause incorrect function resolution - check C3 linearization", "ruleId": "rules.sol-swc-125-inheritance-order", "snippet": {"code": "contract WizardControlFirstPriority is Governor, GovernorProposalThreshold, GovernorCountingSimple, GovernorVotes, GovernorVotesQuorumFraction, GovernorTimelockControl {", "highlightLines": [18]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/certora/harnesses/WizardControlFirstPriority.sol", "line": 18, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-125"], "description": ""}, {"id": "f0a81d56153e", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "contract WizardControlFirstPriority is Governor, GovernorProposalThreshold, GovernorCountingSimple, GovernorVotes, GovernorVotesQuorumFraction, GovernorTimelockControl {", "highlightLines": [18]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/certora/harnesses/WizardControlFirstPriority.sol", "line": 18, "column": 40}, "severity": "info", "references": [], "description": ""}, {"id": "91b87512e889", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(ERC20Votes _token, TimelockController _timelock, string memory name, uint256 quorumFraction)\n        Governor(name)\n        GovernorVotes(_token)\n        GovernorVotesQuorumFraction(quorumFraction)\n        GovernorTimelockControl(_timelock)\n    {}", "highlightLines": [19]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/certora/harnesses/WizardControlFirstPriority.sol", "line": 19, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "ce942345ae9a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 _votingDelay;", "highlightLines": [35]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/certora/harnesses/WizardControlFirstPriority.sol", "line": 35, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a176383aa946", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 _votingPeriod;", "highlightLines": [37]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/certora/harnesses/WizardControlFirstPriority.sol", "line": 37, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "12f8b398454a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 _proposalThreshold;", "highlightLines": [39]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/certora/harnesses/WizardControlFirstPriority.sol", "line": 39, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4b34f32d379f", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        \n        uint256 deltaWeight = super._castVote(proposalId, account, support, reason);  //HARNESS", "highlightLines": [50]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/certora/harnesses/WizardControlFirstPriority.sol", "line": 50, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "eeb8131beff9", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "        override(IGovernor, GovernorVotesQuorumFraction)", "highlightLines": [86]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/certora/harnesses/WizardControlFirstPriority.sol", "line": 86, "column": 19}, "severity": "info", "references": [], "description": ""}, {"id": "3336fa30aec3", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "        override(IGovernor, GovernorVotes)", "highlightLines": [95]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/certora/harnesses/WizardControlFirstPriority.sol", "line": 95, "column": 19}, "severity": "info", "references": [], "description": ""}, {"id": "89b51b9cf86c", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "        override(Governor, GovernorTimelockControl)", "highlightLines": [104]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/certora/harnesses/WizardControlFirstPriority.sol", "line": 104, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "44d1d8e08597", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "        override(Governor, GovernorProposalThreshold, IGovernor)", "highlightLines": [112]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/certora/harnesses/WizardControlFirstPriority.sol", "line": 112, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "f48340abc333", "fix": {"template": null, "available": false}, "title": "Storage array passed by value to internal function - changes won't persist", "ruleId": "rules.sol-array-by-reference", "snippet": {"code": "    function _execute(uint256 proposalId, address[] memory targets, uint256[] memory values, bytes[] memory calldatas, bytes32 descriptionHash)\n        internal", "highlightLines": [118]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/certora/harnesses/WizardControlFirstPriority.sol", "line": 118, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#modifying-storage-array-by-value"], "description": ""}, {"id": "d70ff3dd5337", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "        override(Governor, GovernorTimelockControl)", "highlightLines": [120]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/certora/harnesses/WizardControlFirstPriority.sol", "line": 120, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "f61845e8877b", "fix": {"template": null, "available": false}, "title": "Storage array passed by value to internal function - changes won't persist", "ruleId": "rules.sol-array-by-reference", "snippet": {"code": "    function _cancel(address[] memory targets, uint256[] memory values, bytes[] memory calldatas, bytes32 descriptionHash)\n        internal", "highlightLines": [125]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/certora/harnesses/WizardControlFirstPriority.sol", "line": 125, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#modifying-storage-array-by-value"], "description": ""}, {"id": "30e102d6d821", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "        override(Governor, GovernorTimelockControl)", "highlightLines": [127]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/certora/harnesses/WizardControlFirstPriority.sol", "line": 127, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "410d00d7a760", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "        override(Governor, GovernorTimelockControl)", "highlightLines": [136]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/certora/harnesses/WizardControlFirstPriority.sol", "line": 136, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "625cb741a543", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "        override(Governor, GovernorTimelockControl)", "highlightLines": [145]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/certora/harnesses/WizardControlFirstPriority.sol", "line": 145, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "667aa392387f", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.2;", "highlightLines": [2]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/certora/harnesses/WizardFirstTry.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "cd022ed0179c", "fix": {"template": null, "available": false}, "title": "Base constructor called multiple times through diamond inheritance - may initialize twice", "ruleId": "rules.sol-reused-constructor", "snippet": {"code": "contract WizardFirstTry is Governor, GovernorCountingSimple, GovernorVotes, GovernorVotesQuorumFraction, GovernorTimelockCompound {", "highlightLines": [16]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/certora/harnesses/WizardFirstTry.sol", "line": 16, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#reused-base-constructor"], "description": ""}, {"id": "1b9a46a53c4c", "fix": {"template": null, "available": false}, "title": "SWC-125: Multiple inheritance may cause incorrect function resolution - check C3 linearization", "ruleId": "rules.sol-swc-125-inheritance-order", "snippet": {"code": "contract WizardFirstTry is Governor, GovernorCountingSimple, GovernorVotes, GovernorVotesQuorumFraction, GovernorTimelockCompound {", "highlightLines": [16]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/certora/harnesses/WizardFirstTry.sol", "line": 16, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-125"], "description": ""}, {"id": "47c328478175", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "contract WizardFirstTry is Governor, GovernorCountingSimple, GovernorVotes, GovernorVotesQuorumFraction, GovernorTimelockCompound {", "highlightLines": [16]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/certora/harnesses/WizardFirstTry.sol", "line": 16, "column": 28}, "severity": "info", "references": [], "description": ""}, {"id": "23939aa46bcd", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(ERC20Votes _token, ICompoundTimelock _timelock, string memory name, uint256 quorumFraction)\n        Governor(name)\n        GovernorVotes(_token)\n        GovernorVotesQuorumFraction(quorumFraction)\n        GovernorTimelockCompound(_timelock)\n    {}", "highlightLines": [17]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/certora/harnesses/WizardFirstTry.sol", "line": 17, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "2f469c5a23ca", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 _votingDelay;", "highlightLines": [41]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/certora/harnesses/WizardFirstTry.sol", "line": 41, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "fa1192caba15", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 _votingPeriod;", "highlightLines": [43]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/certora/harnesses/WizardFirstTry.sol", "line": 43, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "056b50d2ca5a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        \n        uint256 deltaWeight = super._castVote(proposalId, account, support, reason);  //HARNESS", "highlightLines": [54]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/certora/harnesses/WizardFirstTry.sol", "line": 54, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "80e2b48b03fb", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "        override(IGovernor, GovernorVotesQuorumFraction)", "highlightLines": [77]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/certora/harnesses/WizardFirstTry.sol", "line": 77, "column": 19}, "severity": "info", "references": [], "description": ""}, {"id": "2b17dc6343d7", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "        override(IGovernor, GovernorVotes)", "highlightLines": [86]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/certora/harnesses/WizardFirstTry.sol", "line": 86, "column": 19}, "severity": "info", "references": [], "description": ""}, {"id": "895e7a668d8a", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "        override(Governor, GovernorTimelockCompound)", "highlightLines": [95]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/certora/harnesses/WizardFirstTry.sol", "line": 95, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "6f954d40ca31", "fix": {"template": null, "available": false}, "title": "Storage array passed by value to internal function - changes won't persist", "ruleId": "rules.sol-array-by-reference", "snippet": {"code": "    function _execute(uint256 proposalId, address[] memory targets, uint256[] memory values, bytes[] memory calldatas, bytes32 descriptionHash)\n        internal", "highlightLines": [109]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/certora/harnesses/WizardFirstTry.sol", "line": 109, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#modifying-storage-array-by-value"], "description": ""}, {"id": "d73c0408eab5", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "        override(Governor, GovernorTimelockCompound)", "highlightLines": [111]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/certora/harnesses/WizardFirstTry.sol", "line": 111, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "87e4f9b5aed5", "fix": {"template": null, "available": false}, "title": "Storage array passed by value to internal function - changes won't persist", "ruleId": "rules.sol-array-by-reference", "snippet": {"code": "    function _cancel(address[] memory targets, uint256[] memory values, bytes[] memory calldatas, bytes32 descriptionHash)\n        internal", "highlightLines": [116]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/certora/harnesses/WizardFirstTry.sol", "line": 116, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#modifying-storage-array-by-value"], "description": ""}, {"id": "da28c7409add", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "        override(Governor, GovernorTimelockCompound)", "highlightLines": [118]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/certora/harnesses/WizardFirstTry.sol", "line": 118, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "5098b5e8c011", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "        override(Governor, GovernorTimelockCompound)", "highlightLines": [127]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/certora/harnesses/WizardFirstTry.sol", "line": 127, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "abf66b0f5253", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "        override(Governor, GovernorTimelockCompound)", "highlightLines": [136]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/certora/harnesses/WizardFirstTry.sol", "line": 136, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "85adc51af3f8", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/access/AccessControl.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "ccfe3ddb5fbb", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "abstract contract AccessControl is Context, IAccessControl, ERC165 {", "highlightLines": [49]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/access/AccessControl.sol", "line": 49, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "637d95dab7ff", "fix": {"template": null, "available": false}, "title": "Base constructor called multiple times through diamond inheritance - may initialize twice", "ruleId": "rules.sol-reused-constructor", "snippet": {"code": "abstract contract AccessControl is Context, IAccessControl, ERC165 {", "highlightLines": [49]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/access/AccessControl.sol", "line": 49, "column": 10}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#reused-base-constructor"], "description": ""}, {"id": "f8c9472e13c0", "fix": {"template": null, "available": false}, "title": "SWC-125: Multiple inheritance may cause incorrect function resolution - check C3 linearization", "ruleId": "rules.sol-swc-125-inheritance-order", "snippet": {"code": "abstract contract AccessControl is Context, IAccessControl, ERC165 {", "highlightLines": [49]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/access/AccessControl.sol", "line": 49, "column": 10}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-125"], "description": ""}, {"id": "66201251bcbc", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "abstract contract AccessControl is Context, IAccessControl, ERC165 {\n    struct RoleData {\n        mapping(address => bool) members;\n        bytes32 adminRole;", "highlightLines": [49]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/access/AccessControl.sol", "line": 49, "column": 10}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "e9cbe2355a77", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 adminRole;", "highlightLines": [52]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/access/AccessControl.sol", "line": 52, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "57d533ad7614", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyRole(bytes32 role) {\n        _checkRole(role);\n        _;\n    }", "highlightLines": [69]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/access/AccessControl.sol", "line": 69, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "ec3b2b120909", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "    modifier onlyRole(bytes32 role) {\n        _checkRole(role);\n        _;\n    }", "highlightLines": [69]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/access/AccessControl.sol", "line": 69, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "d1f898998ff4", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [71]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/access/AccessControl.sol", "line": 71, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "b468f5041ef7", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function supportsInterface(bytes4 interfaceId) public view virtual override returns (bool) {\n        return interfaceId == type(IAccessControl).interfaceId || super.supportsInterface(interfaceId);", "highlightLines": [77]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/access/AccessControl.sol", "line": 77, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "23f220bb81fd", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "                    abi.encodePacked(\n                        \"AccessControl: account \",\n                        Strings.toHexString(account),\n                        \" is missing role \",\n                        Strings.toHexString(uint256(role), 32)\n                    )", "highlightLines": [111]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/access/AccessControl.sol", "line": 111, "column": 21}, "severity": "medium", "references": [], "description": ""}, {"id": "14816d1014df", "fix": {"template": null, "available": false}, "title": "Access control change without event emission - harder to monitor and audit", "ruleId": "rules.sol-missing-events-access-control", "snippet": {"code": "    function grantRole(bytes32 role, address account) public virtual override onlyRole(getRoleAdmin(role)) {", "highlightLines": [144]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/access/AccessControl.sol", "line": 144, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-access-control"], "description": ""}, {"id": "56a75ecf2ab8", "fix": {"template": null, "available": false}, "title": "Access control change without event emission - harder to monitor and audit", "ruleId": "rules.sol-missing-events-access-control", "snippet": {"code": "    function revokeRole(bytes32 role, address account) public virtual override onlyRole(getRoleAdmin(role)) {", "highlightLines": [159]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/access/AccessControl.sol", "line": 159, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-access-control"], "description": ""}, {"id": "c202070e1677", "fix": {"template": null, "available": false}, "title": "Access control change without event emission - harder to monitor and audit", "ruleId": "rules.sol-missing-events-access-control", "snippet": {"code": "    function renounceRole(bytes32 role, address account) public virtual override {", "highlightLines": [179]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/access/AccessControl.sol", "line": 179, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-access-control"], "description": ""}, {"id": "d03b33820458", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function renounceRole(bytes32 role, address account) public virtual override {\n        require(account == _msgSender(), \"AccessControl: can only renounce roles for self\");", "highlightLines": [179]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/access/AccessControl.sol", "line": 179, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "457972039bf8", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function _setRoleAdmin(bytes32 role, bytes32 adminRole) internal virtual {\n        bytes32 previousAdminRole = getRoleAdmin(role);\n        _roles[role].adminRole = adminRole;", "highlightLines": [214]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/access/AccessControl.sol", "line": 214, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "d9ddd67522b8", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 previousAdminRole = getRoleAdmin(role);", "highlightLines": [215]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/access/AccessControl.sol", "line": 215, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "506375fa2395", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes32 previousAdminRole = getRoleAdmin(role);\n        _roles[role].adminRole = adminRole;", "highlightLines": [215]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/access/AccessControl.sol", "line": 215, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "94331ee9148b", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.4;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/access/AccessControlCrossChain.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "ae367e05e8be", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/access/AccessControlEnumerable.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "886fd730ee4f", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "abstract contract AccessControlEnumerable is IAccessControlEnumerable, AccessControl {", "highlightLines": [13]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/access/AccessControlEnumerable.sol", "line": 13, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "614f07677dc2", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function supportsInterface(bytes4 interfaceId) public view virtual override returns (bool) {\n        return interfaceId == type(IAccessControlEnumerable).interfaceId || super.supportsInterface(interfaceId);", "highlightLines": [21]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/access/AccessControlEnumerable.sol", "line": 21, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "9b7ed321a12d", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/access/IAccessControl.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "3eab07839899", "fix": {"template": null, "available": false}, "title": "Access control change without event emission - harder to monitor and audit", "ruleId": "rules.sol-missing-events-access-control", "snippet": {"code": "    function grantRole(bytes32 role, address account) external;\n\n    /**\n     * @dev Revokes `role` from `account`.\n     *\n     * If `account` had been granted `role`, emits a {RoleRevoked} event.", "highlightLines": [60]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/access/IAccessControl.sol", "line": 60, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-access-control"], "description": ""}, {"id": "32b35b4a6c4b", "fix": {"template": null, "available": false}, "title": "Access control change without event emission - harder to monitor and audit", "ruleId": "rules.sol-missing-events-access-control", "snippet": {"code": "    function revokeRole(bytes32 role, address account) external;\n\n    /**\n     * @dev Revokes `role` from the calling account.\n     *\n     * Roles are often managed via {grantRole} and {revokeRole}: this function's", "highlightLines": [71]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/access/IAccessControl.sol", "line": 71, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-access-control"], "description": ""}, {"id": "886cc6c2f677", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/access/IAccessControlEnumerable.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "a010be5dd1e7", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/access/Ownable.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "5d0d8bf4ba94", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "abstract contract Ownable is Context {\n    address private _owner;", "highlightLines": [20]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/access/Ownable.sol", "line": 20, "column": 10}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "f4349e40c350", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event OwnershipTransferred(address indexed previousOwner, address indexed newOwner);", "highlightLines": [23]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/access/Ownable.sol", "line": 23, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "3376f20a4d2c", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor() {\n        _transferOwnership(_msgSender());\n    }", "highlightLines": [28]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/access/Ownable.sol", "line": 28, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "9cff4853a360", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyOwner() {\n        _checkOwner();\n        _;\n    }", "highlightLines": [35]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/access/Ownable.sol", "line": 35, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "a6e6956ef12c", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "    modifier onlyOwner() {\n        _checkOwner();\n        _;\n    }", "highlightLines": [35]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/access/Ownable.sol", "line": 35, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "da23181626b8", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [37]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/access/Ownable.sol", "line": 37, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "18c1fa283cc4", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function renounceOwnership() public virtual onlyOwner {", "highlightLines": [61]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/access/Ownable.sol", "line": 61, "column": 49}, "severity": "info", "references": [], "description": ""}, {"id": "635a23e7231b", "fix": {"template": null, "available": false}, "title": "Access control change without event emission - harder to monitor and audit", "ruleId": "rules.sol-missing-events-access-control", "snippet": {"code": "    function transferOwnership(address newOwner) public virtual onlyOwner {", "highlightLines": [69]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/access/Ownable.sol", "line": 69, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-access-control"], "description": ""}, {"id": "835917909240", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function transferOwnership(address newOwner) public virtual onlyOwner {", "highlightLines": [69]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/access/Ownable.sol", "line": 69, "column": 65}, "severity": "info", "references": [], "description": ""}, {"id": "483214b6cfa4", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address oldOwner = _owner;", "highlightLines": [79]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/access/Ownable.sol", "line": 79, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4b4cb2f9b392", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address oldOwner = _owner;\n        _owner = newOwner;", "highlightLines": [79]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/access/Ownable.sol", "line": 79, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "de3d60160b26", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.4;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/crosschain/CrossChainEnabled.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "83a739a2fa2e", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyCrossChain() {\n        if (!_isCrossChain()) revert NotCrossChainCall();\n        _;\n    }", "highlightLines": [25]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/crosschain/CrossChainEnabled.sol", "line": 25, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "e831c6a74066", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [27]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/crosschain/CrossChainEnabled.sol", "line": 27, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "ee2f37946837", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyCrossChainSender(address expected) {\n        address actual = _crossChainSender();\n        if (expected != actual) revert InvalidCrossChainSender(actual, expected);\n        _;\n    }", "highlightLines": [34]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/crosschain/CrossChainEnabled.sol", "line": 34, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "53f6febbd908", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "    modifier onlyCrossChainSender(address expected) {\n        address actual = _crossChainSender();\n        if (expected != actual) revert InvalidCrossChainSender(actual, expected);\n        _;\n    }", "highlightLines": [34]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/crosschain/CrossChainEnabled.sol", "line": 34, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "7d93b8d4e52c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address actual = _crossChainSender();", "highlightLines": [35]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/crosschain/CrossChainEnabled.sol", "line": 35, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3f43866f2e34", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [37]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/crosschain/CrossChainEnabled.sol", "line": 37, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "0650226855e6", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.4;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/crosschain/amb/CrossChainEnabledAMB.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "75a6bc9e987e", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(address bridge) {\n        _bridge = bridge;\n    }", "highlightLines": [32]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/crosschain/amb/CrossChainEnabledAMB.sol", "line": 32, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "b6d4ebb73961", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.4;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/crosschain/amb/LibAMB.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "d930c93a515e", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "        return AMB_Bridge(bridge).messageSender();", "highlightLines": [33]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/crosschain/amb/LibAMB.sol", "line": 33, "column": 16}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "44b4a11f8fbf", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.4;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/crosschain/arbitrum/CrossChainEnabledArbitrumL1.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "8bc301ca357a", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(address bridge) {\n        _bridge = bridge;\n    }", "highlightLines": [27]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/crosschain/arbitrum/CrossChainEnabledArbitrumL1.sol", "line": 27, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "74c68433523b", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.4;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/crosschain/arbitrum/CrossChainEnabledArbitrumL2.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "467ac20abbb2", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.4;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/crosschain/arbitrum/LibArbitrumL1.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "f3140af56eae", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function crossChainSender(address bridge) internal view returns (address) {\n        if (!isCrossChain(bridge)) revert NotCrossChainCall();\n\n        address sender = ArbitrumL1_Outbox(ArbitrumL1_Bridge(bridge).activeOutbox()).l2ToL1Sender();", "highlightLines": [35]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/crosschain/arbitrum/LibArbitrumL1.sol", "line": 35, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "d6ff93f12a1d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        address sender = ArbitrumL1_Outbox(ArbitrumL1_Bridge(bridge).activeOutbox()).l2ToL1Sender();", "highlightLines": [37]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/crosschain/arbitrum/LibArbitrumL1.sol", "line": 37, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "851a81eb1cd2", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "        address sender = ArbitrumL1_Outbox(ArbitrumL1_Bridge(bridge).activeOutbox()).l2ToL1Sender();", "highlightLines": [38]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/crosschain/arbitrum/LibArbitrumL1.sol", "line": 38, "column": 44}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "072ad1692660", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.4;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/crosschain/arbitrum/LibArbitrumL2.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "694dffe72a07", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "        return ArbitrumL2_Bridge(arbsys).isTopLevelCall();", "highlightLines": [24]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/crosschain/arbitrum/LibArbitrumL2.sol", "line": 24, "column": 16}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "a2486d88d9b3", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "            ArbitrumL2_Bridge(arbsys).wasMyCallersAddressAliased()", "highlightLines": [39]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/crosschain/arbitrum/LibArbitrumL2.sol", "line": 39, "column": 13}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "c92bed5ce4db", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "                ? ArbitrumL2_Bridge(arbsys).myCallersAddressWithoutAliasing()", "highlightLines": [40]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/crosschain/arbitrum/LibArbitrumL2.sol", "line": 40, "column": 19}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "ecf6c2e95ebc", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.4;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/crosschain/errors.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "95c593f290c8", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.4;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/crosschain/optimism/CrossChainEnabledOptimism.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "cf320f48f89b", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(address messenger) {\n        _messenger = messenger;\n    }", "highlightLines": [24]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/crosschain/optimism/CrossChainEnabledOptimism.sol", "line": 24, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "8e7f5db9e5a4", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.4;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/crosschain/optimism/LibOptimism.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "490cdd84947e", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "        return Optimism_Bridge(messenger).xDomainMessageSender();", "highlightLines": [34]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/crosschain/optimism/LibOptimism.sol", "line": 34, "column": 16}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "7e20e2e36b90", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.4;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/crosschain/polygon/CrossChainEnabledPolygonChild.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "5bdcabdf29ab", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "abstract contract CrossChainEnabledPolygonChild is IFxMessageProcessor, CrossChainEnabled, ReentrancyGuard {", "highlightLines": [26]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/crosschain/polygon/CrossChainEnabledPolygonChild.sol", "line": 26, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "13c32f0905d0", "fix": {"template": null, "available": false}, "title": "Base constructor called multiple times through diamond inheritance - may initialize twice", "ruleId": "rules.sol-reused-constructor", "snippet": {"code": "abstract contract CrossChainEnabledPolygonChild is IFxMessageProcessor, CrossChainEnabled, ReentrancyGuard {", "highlightLines": [26]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/crosschain/polygon/CrossChainEnabledPolygonChild.sol", "line": 26, "column": 10}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#reused-base-constructor"], "description": ""}, {"id": "10a30636afee", "fix": {"template": null, "available": false}, "title": "SWC-125: Multiple inheritance may cause incorrect function resolution - check C3 linearization", "ruleId": "rules.sol-swc-125-inheritance-order", "snippet": {"code": "abstract contract CrossChainEnabledPolygonChild is IFxMessageProcessor, CrossChainEnabled, ReentrancyGuard {", "highlightLines": [26]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/crosschain/polygon/CrossChainEnabledPolygonChild.sol", "line": 26, "column": 10}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-125"], "description": ""}, {"id": "5fcd511e342d", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "abstract contract CrossChainEnabledPolygonChild is IFxMessageProcessor, CrossChainEnabled, ReentrancyGuard {\n    /// @custom:oz-upgrades-unsafe-allow state-variable-immutable\n    address private immutable _fxChild;\n    address private _sender = DEFAULT_SENDER;", "highlightLines": [26]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/crosschain/polygon/CrossChainEnabledPolygonChild.sol", "line": 26, "column": 10}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "1f8406cd7624", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(address fxChild) {\n        _fxChild = fxChild;\n    }", "highlightLines": [32]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/crosschain/polygon/CrossChainEnabledPolygonChild.sol", "line": 32, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "d1d08991e15a", "fix": {"template": null, "available": false}, "title": "Operation executed without checking PENDING status - double execution possible", "ruleId": "rules.sol-missing-pending-check", "snippet": {"code": "    function processMessageFromRoot(\n        uint256, /* stateId */\n        address rootMessageSender,\n        bytes calldata data\n    ) external override nonReentrant {", "highlightLines": [61]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/crosschain/polygon/CrossChainEnabledPolygonChild.sol", "line": 61, "column": 5}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "5c96fa0be7e5", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        _sender = rootMessageSender;\n        Address.functionDelegateCall(address(this), data, \"cross-chain execution failed\");\n        _sender = DEFAULT_SENDER;", "highlightLines": [68]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/crosschain/polygon/CrossChainEnabledPolygonChild.sol", "line": 68, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "38439c4e6fdb", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/finance/PaymentSplitter.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "fa9b17b2b300", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract PaymentSplitter is Context {\n    event PayeeAdded(address account, uint256 shares);\n    event PaymentReleased(address to, uint256 amount);\n    event ERC20PaymentReleased(IERC20 indexed token, address to, uint256 amount);\n    event PaymentReceived(address from, uint256 amount);\n\n    uint256 private _totalShares;\n    uint256 private _totalReleased;\n\n    mapping(address => uint256) private _shares;\n    mapping(address => uint256) private _released;\n    address[] private _payees;\n\n    mapping(IERC20 => uint256) private _erc20TotalReleased;\n    mapping(IERC20 => mapping(address => uint256)) private _erc20Released;\n\n    /**\n     * @dev Creates an instance of `PaymentSplitter` where each account in `payees` is assigned the number of shares at\n     * the matching position in the `shares` array.\n     *\n     * All addresses in `payees` must be non-zero. Both arrays must have the same non-zero length, and there must be no\n     * duplicates in `payees`.\n     */\n    constructor(address[] memory payees, uint256[] memory shares_) payable {\n        require(payees.length == shares_.length, \"PaymentSplitter: payees and shares length mismatch\");\n        require(payees.length > 0, \"PaymentSplitter: no payees\");\n\n        for (uint256 i = 0; i < payees.length; i++) {", "highlightLines": [28]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/finance/PaymentSplitter.sol", "line": 28, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "039c94e67d95", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event PayeeAdded(address account, uint256 shares);", "highlightLines": [29]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/finance/PaymentSplitter.sol", "line": 29, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "4ff9cb9b57f4", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event PayeeAdded(address account, uint256 shares);", "highlightLines": [29]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/finance/PaymentSplitter.sol", "line": 29, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "f41c4f6ebc27", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event PaymentReleased(address to, uint256 amount);", "highlightLines": [30]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/finance/PaymentSplitter.sol", "line": 30, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "228926ad17db", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event PaymentReleased(address to, uint256 amount);", "highlightLines": [30]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/finance/PaymentSplitter.sol", "line": 30, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "668a81dadf38", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event PaymentReceived(address from, uint256 amount);", "highlightLines": [32]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/finance/PaymentSplitter.sol", "line": 32, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "fd187327d54f", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event PaymentReceived(address from, uint256 amount);", "highlightLines": [32]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/finance/PaymentSplitter.sol", "line": 32, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "226351dfe047", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(address[] memory payees, uint256[] memory shares_) payable {\n        require(payees.length == shares_.length, \"PaymentSplitter: payees and shares length mismatch\");\n        require(payees.length > 0, \"PaymentSplitter: no payees\");\n\n        for (uint256 i = 0; i < payees.length; i++) {\n            _addPayee(payees[i], shares_[i]);\n        }\n    }", "highlightLines": [51]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/finance/PaymentSplitter.sol", "line": 51, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "54313da74c17", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function releasable(address account) public view returns (uint256) {\n        uint256 totalReceived = address(this).balance + totalReleased();", "highlightLines": [127]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/finance/PaymentSplitter.sol", "line": 127, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "26452052533b", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 totalReceived = address(this).balance + totalReleased();", "highlightLines": [128]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/finance/PaymentSplitter.sol", "line": 128, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e4095839f42c", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "        uint256 totalReceived = address(this).balance + totalReleased();", "highlightLines": [128]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/finance/PaymentSplitter.sol", "line": 128, "column": 9}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "870b90c391f9", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function releasable(IERC20 token, address account) public view returns (uint256) {\n        uint256 totalReceived = token.balanceOf(address(this)) + totalReleased(token);", "highlightLines": [136]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/finance/PaymentSplitter.sol", "line": 136, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "158529b5abd7", "fix": {"template": null, "available": false}, "title": "View function reads state that may be stale during callback - read-only reentrancy risk", "ruleId": "rules.sol-read-only-reentrancy", "snippet": {"code": "    function releasable(IERC20 token, address account) public view returns (uint256) {\n        uint256 totalReceived = token.balanceOf(address(this)) + totalReleased(token);", "highlightLines": [136]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/finance/PaymentSplitter.sol", "line": 136, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs", "https://chainsecurity.com/curve-lp-oracle-manipulation-post-mortem/"], "description": ""}, {"id": "bca1fa43a553", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 totalReceived = token.balanceOf(address(this)) + totalReleased(token);", "highlightLines": [137]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/finance/PaymentSplitter.sol", "line": 137, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c6bdca5892cb", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "        uint256 totalReceived = token.balanceOf(address(this)) + totalReleased(token);", "highlightLines": [137]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/finance/PaymentSplitter.sol", "line": 137, "column": 9}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "5b95c316f0a3", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 payment = releasable(account);", "highlightLines": [147]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/finance/PaymentSplitter.sol", "line": 147, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "344a895b8b6f", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 payment = releasable(token, account);", "highlightLines": [170]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/finance/PaymentSplitter.sol", "line": 170, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "336cc804cab8", "fix": {"template": null, "available": false}, "title": "Share update without corresponding balance update - accounting inconsistency", "ruleId": "rules.sol-shares-balance-mismatch", "snippet": {"code": "        require(_shares[account] == 0, \"PaymentSplitter: account already has shares\");", "highlightLines": [207]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/finance/PaymentSplitter.sol", "line": 207, "column": 18}, "severity": "medium", "references": [], "description": ""}, {"id": "e81a74b16f8d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        _shares[account] = shares_;\n        _totalShares = _totalShares + shares_;", "highlightLines": [210]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/finance/PaymentSplitter.sol", "line": 210, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e320743aa4ce", "fix": {"template": null, "available": false}, "title": "Share update without corresponding balance update - accounting inconsistency", "ruleId": "rules.sol-shares-balance-mismatch", "snippet": {"code": "        _shares[account] = shares_;", "highlightLines": [210]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/finance/PaymentSplitter.sol", "line": 210, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "2238011a6e71", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/finance/VestingWallet.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "98656263b2f8", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract VestingWallet is Context {\n    event EtherReleased(uint256 amount);\n    event ERC20Released(address indexed token, uint256 amount);\n\n    uint256 private _released;", "highlightLines": [20]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/finance/VestingWallet.sol", "line": 20, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "de967a8bfce5", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event EtherReleased(uint256 amount);", "highlightLines": [21]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/finance/VestingWallet.sol", "line": 21, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "7a81478c7aa2", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event ERC20Released(address indexed token, uint256 amount);", "highlightLines": [22]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/finance/VestingWallet.sol", "line": 22, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "d87096a033f8", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(\n        address beneficiaryAddress,\n        uint64 startTimestamp,\n        uint64 durationSeconds\n    ) {\n        require(beneficiaryAddress != address(0), \"VestingWallet: beneficiary is zero address\");\n        _beneficiary = beneficiaryAddress;\n        _start = startTimestamp;\n        _duration = durationSeconds;\n    }", "highlightLines": [33]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/finance/VestingWallet.sol", "line": 33, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "e5252aa6e68e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        _beneficiary = beneficiaryAddress;\n        _start = startTimestamp;", "highlightLines": [39]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/finance/VestingWallet.sol", "line": 39, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "854c3c811c3c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        _start = startTimestamp;\n        _duration = durationSeconds;", "highlightLines": [40]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/finance/VestingWallet.sol", "line": 40, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "80c3413dda9e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 releasable = vestedAmount(uint64(block.timestamp)) - released();", "highlightLines": [90]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/finance/VestingWallet.sol", "line": 90, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "bd216efb1e85", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        uint256 releasable = vestedAmount(uint64(block.timestamp)) - released();", "highlightLines": [90]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/finance/VestingWallet.sol", "line": 90, "column": 43}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "6f9021c4fb4d", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        uint256 releasable = vestedAmount(uint64(block.timestamp)) - released();", "highlightLines": [90]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/finance/VestingWallet.sol", "line": 90, "column": 50}, "severity": "medium", "references": [], "description": ""}, {"id": "ed927890e280", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 releasable = vestedAmount(token, uint64(block.timestamp)) - released(token);", "highlightLines": [102]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/finance/VestingWallet.sol", "line": 102, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "07263c29c936", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        uint256 releasable = vestedAmount(token, uint64(block.timestamp)) - released(token);", "highlightLines": [102]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/finance/VestingWallet.sol", "line": 102, "column": 50}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "a091426f7069", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        uint256 releasable = vestedAmount(token, uint64(block.timestamp)) - released(token);", "highlightLines": [102]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/finance/VestingWallet.sol", "line": 102, "column": 57}, "severity": "medium", "references": [], "description": ""}, {"id": "a53f2c0b389e", "fix": {"template": null, "available": false}, "title": "View function reads state that may be stale during callback - read-only reentrancy risk", "ruleId": "rules.sol-read-only-reentrancy", "snippet": {"code": "    function vestedAmount(address token, uint64 timestamp) public view virtual returns (uint256) {\n        return _vestingSchedule(IERC20(token).balanceOf(address(this)) + released(token), timestamp);", "highlightLines": [118]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/finance/VestingWallet.sol", "line": 118, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs", "https://chainsecurity.com/curve-lp-oracle-manipulation-post-mortem/"], "description": ""}, {"id": "51cc57b3ed81", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "        return _vestingSchedule(IERC20(token).balanceOf(address(this)) + released(token), timestamp);", "highlightLines": [119]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/finance/VestingWallet.sol", "line": 119, "column": 33}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "60c847de34e6", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "0f11ee99d090", "fix": {"template": null, "available": false}, "title": "Base constructor called multiple times through diamond inheritance - may initialize twice", "ruleId": "rules.sol-reused-constructor", "snippet": {"code": "abstract contract Governor is Context, ERC165, EIP712, IGovernor, IERC721Receiver, IERC1155Receiver {", "highlightLines": [29]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 29, "column": 10}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#reused-base-constructor"], "description": ""}, {"id": "ee2651fe90f1", "fix": {"template": null, "available": false}, "title": "SWC-125: Multiple inheritance may cause incorrect function resolution - check C3 linearization", "ruleId": "rules.sol-swc-125-inheritance-order", "snippet": {"code": "abstract contract Governor is Context, ERC165, EIP712, IGovernor, IERC721Receiver, IERC1155Receiver {", "highlightLines": [29]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 29, "column": 10}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-125"], "description": ""}, {"id": "a4cea88aa8b2", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "abstract contract Governor is Context, ERC165, EIP712, IGovernor, IERC721Receiver, IERC1155Receiver {", "highlightLines": [29]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 29, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "3f0475a83fd1", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "abstract contract Governor is Context, ERC165, EIP712, IGovernor, IERC721Receiver, IERC1155Receiver {\n    using DoubleEndedQueue for DoubleEndedQueue.Bytes32Deque;\n    using SafeCast for uint256;\n    using Timers for Timers.BlockNumber;\n\n    bytes32 public constant BALLOT_TYPEHASH = keccak256(\"Ballot(uint256 proposalId,uint8 support)\");\n    bytes32 public constant EXTENDED_BALLOT_TYPEHASH =\n        keccak256(\"ExtendedBallot(uint256 proposalId,uint8 support,string reason,bytes params)\");\n\n    struct ProposalCore {\n        Timers.BlockNumber voteStart;\n        Timers.BlockNumber voteEnd;\n        bool executed;\n        bool canceled;", "highlightLines": [29]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 29, "column": 10}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "e06653772008", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool executed;", "highlightLines": [41]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 41, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0ada27b873a0", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool canceled;", "highlightLines": [42]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 42, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "fd1b1a2f57b2", "fix": {"template": null, "available": false}, "title": "Governance can execute arbitrary calls - verify this is intentional and secured", "ruleId": "rules.sol-ethernaut-governance-arbitrary-call", "snippet": {"code": "    // {onlyGovernance} modifier needs to be whitelisted in this queue. Whitelisting is set in {_beforeExecute},", "highlightLines": [50]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 50, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e451657936bc", "fix": {"template": null, "available": false}, "title": "Governance can execute arbitrary calls - verify this is intentional and secured", "ruleId": "rules.sol-ethernaut-governance-arbitrary-call", "snippet": {"code": "    // consumed by the {onlyGovernance} modifier and eventually reset in {_afterExecute}. This ensures that the", "highlightLines": [51]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 51, "column": 25}, "severity": "medium", "references": [], "description": ""}, {"id": "2729b8a45321", "fix": {"template": null, "available": false}, "title": "Governance can execute arbitrary calls - verify this is intentional and secured", "ruleId": "rules.sol-ethernaut-governance-arbitrary-call", "snippet": {"code": "    // execution of {onlyGovernance} protected calls can only be achieved through successful proposals.", "highlightLines": [52]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 52, "column": 22}, "severity": "medium", "references": [], "description": ""}, {"id": "764c965771b9", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "    modifier onlyGovernance() {\n        require(_msgSender() == _executor(), \"Governor: onlyGovernance\");\n        if (_executor() != address(this)) {\n            bytes32 msgDataHash = keccak256(_msgData());\n            // loop until popping the expected operation - throw if deque is empty (operation not authorized)\n            while (_governanceCall.popFront() != msgDataHash) {}", "highlightLines": [65]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 65, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "1f12b3193118", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyGovernance() {\n        require(_msgSender() == _executor(), \"Governor: onlyGovernance\");\n        if (_executor() != address(this)) {\n            bytes32 msgDataHash = keccak256(_msgData());\n            // loop until popping the expected operation - throw if deque is empty (operation not authorized)\n            while (_governanceCall.popFront() != msgDataHash) {}\n        }\n        _;\n    }", "highlightLines": [65]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 65, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "2866ea29b042", "fix": {"template": null, "available": false}, "title": "Governance can execute arbitrary calls - verify this is intentional and secured", "ruleId": "rules.sol-ethernaut-governance-arbitrary-call", "snippet": {"code": "    modifier onlyGovernance() {", "highlightLines": [65]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 65, "column": 14}, "severity": "medium", "references": [], "description": ""}, {"id": "bb44071862ad", "fix": {"template": null, "available": false}, "title": "Governance can execute arbitrary calls - verify this is intentional and secured", "ruleId": "rules.sol-ethernaut-governance-arbitrary-call", "snippet": {"code": "        require(_msgSender() == _executor(), \"Governor: onlyGovernance\");", "highlightLines": [66]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 66, "column": 57}, "severity": "medium", "references": [], "description": ""}, {"id": "9ecbda4ceb1d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            bytes32 msgDataHash = keccak256(_msgData());", "highlightLines": [68]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 68, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "be98c35ed79d", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [72]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 72, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "63586806b0f5", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(string memory name_) EIP712(name_, version()) {\n        _name = name_;\n    }", "highlightLines": [78]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 78, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "ffac69f730e8", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_executor() == address(this));", "highlightLines": [86]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 86, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "2c22c32d5546", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function supportsInterface(bytes4 interfaceId) public view virtual override(IERC165, ERC165) returns (bool) {\n        // In addition to the current interfaceId, also support previous version of the interfaceId that did not\n        // include the castVoteWithReasonAndParams() function as standard\n        return\n            interfaceId ==\n            (type(IGovernor).interfaceId ^\n                this.castVoteWithReasonAndParams.selector ^\n                this.castVoteWithReasonAndParamsBySig.selector ^\n                this.getVotesWithParams.selector) ||\n            interfaceId == type(IGovernor).interfaceId ||\n            interfaceId == type(IERC1155Receiver).interfaceId ||", "highlightLines": [92]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 92, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "0708b6442fe5", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        return uint256(keccak256(abi.encode(targets, values, calldatas, descriptionHash)));", "highlightLines": [139]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 139, "column": 24}, "severity": "high", "references": [], "description": ""}, {"id": "ca6a82ffb109", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function state(uint256 proposalId) public view virtual override returns (ProposalState) {\n        ProposalCore storage proposal = _proposals[proposalId];", "highlightLines": [145]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 145, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "ed535e9a993d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        ProposalCore storage proposal = _proposals[proposalId];\n\n        if (proposal.executed) {\n            return ProposalState.Executed;\n        }\n\n        if (proposal.canceled) {\n            return ProposalState.Canceled;\n        }\n\n        uint256 snapshot = proposalSnapshot(proposalId);", "highlightLines": [146]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 146, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "cd4f0c4a3ee0", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 snapshot = proposalSnapshot(proposalId);", "highlightLines": [155]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 155, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "22141a41646d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 snapshot = proposalSnapshot(proposalId);\n\n        if (snapshot == 0) {\n            revert(\"Governor: unknown proposal id\");\n        }\n\n        if (snapshot >= block.number) {\n            return ProposalState.Pending;\n        }\n\n        uint256 deadline = proposalDeadline(proposalId);", "highlightLines": [156]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 156, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "ff16159d6c0d", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "        if (snapshot == 0) {\n            revert(\"Governor: unknown proposal id\");\n        }", "highlightLines": [158]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 158, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "2db2bfe55ca8", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 deadline = proposalDeadline(proposalId);", "highlightLines": [165]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 165, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ad8ba2d9e837", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function _getVotes(\n        address account,\n        uint256 blockNumber,\n        bytes memory params\n    ) internal view virtual returns (uint256);", "highlightLines": [213]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 213, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "86263e980023", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 proposalId = hashProposal(targets, values, calldatas, keccak256(bytes(description)));", "highlightLines": [255]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 255, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3c1bd5feed9c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 proposalId = hashProposal(targets, values, calldatas, keccak256(bytes(description)));\n\n        require(targets.length == values.length, \"Governor: invalid proposal length\");\n        require(targets.length == calldatas.length, \"Governor: invalid proposal length\");\n        require(targets.length > 0, \"Governor: empty proposal\");\n\n        ProposalCore storage proposal = _proposals[proposalId];", "highlightLines": [256]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 256, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "31698df39802", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        ProposalCore storage proposal = _proposals[proposalId];\n        require(proposal.voteStart.isUnset(), \"Governor: proposal already exists\");\n\n        uint64 snapshot = block.number.toUint64() + votingDelay().toUint64();", "highlightLines": [262]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 262, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "c557c128c58a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint64 snapshot = block.number.toUint64() + votingDelay().toUint64();", "highlightLines": [264]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 264, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "31f1c9807f41", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint64 snapshot = block.number.toUint64() + votingDelay().toUint64();\n        uint64 deadline = snapshot + votingPeriod().toUint64();", "highlightLines": [265]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 265, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "cf3c98a3899f", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint64 deadline = snapshot + votingPeriod().toUint64();", "highlightLines": [266]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 266, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c1f70dc54654", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "            new string[](targets.length),", "highlightLines": [276]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 276, "column": 13}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "9177f9aa2052", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 proposalId = hashProposal(targets, values, calldatas, descriptionHash);", "highlightLines": [295]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 295, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "9f1680fa2837", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 proposalId = hashProposal(targets, values, calldatas, descriptionHash);\n\n        ProposalState status = state(proposalId);", "highlightLines": [295]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 295, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "33b9081aba15", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        ProposalState status = state(proposalId);\n        require(\n            status == ProposalState.Succeeded || status == ProposalState.Queued,\n            \"Governor: proposal not successful\"\n        );\n        _proposals[proposalId].executed = true;", "highlightLines": [297]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 297, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "dc2fd0f2e37c", "fix": {"template": null, "available": false}, "title": "Storage array passed by value to internal function - changes won't persist", "ruleId": "rules.sol-array-by-reference", "snippet": {"code": "    function _execute(\n        uint256, /* proposalId */\n        address[] memory targets,\n        uint256[] memory values,\n        bytes[] memory calldatas,\n        bytes32 /*descriptionHash*/\n    ) internal virtual {", "highlightLines": [316]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 316, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#modifying-storage-array-by-value"], "description": ""}, {"id": "a3fee4f00cb0", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        string memory errorMessage = \"Governor: call reverted without message\";\n        for (uint256 i = 0; i < targets.length; ++i) {\n            (bool success, bytes memory returndata) = targets[i].call{value: values[i]}(calldatas[i]);\n            Address.verifyCallResult(success, returndata, errorMessage);\n        }", "highlightLines": [323]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 323, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "57e54f7eb17b", "fix": {"template": null, "available": false}, "title": "Unbounded loop iterating over dynamic array - can cause out-of-gas DoS", "ruleId": "rules.sol-unbounded-loop-dos", "snippet": {"code": "        for (uint256 i = 0; i < targets.length; ++i) {\n            (bool success, bytes memory returndata) = targets[i].call{value: values[i]}(calldatas[i]);", "highlightLines": [324]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 324, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "bdd2e594e48b", "fix": {"template": null, "available": false}, "title": "Unbounded loop over dynamic array - can cause DoS if array grows large", "ruleId": "rules.sol-unbounded-protocol-loop", "snippet": {"code": "        for (uint256 i = 0; i < targets.length; ++i) {\n            (bool success, bytes memory returndata) = targets[i].call{value: values[i]}(calldatas[i]);", "highlightLines": [324]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 324, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "6e903c8e38fd", "fix": {"template": null, "available": false}, "title": "Call success variable declared but never checked - funds may be lost", "ruleId": "rules.sol-call-success-not-required", "snippet": {"code": "            (bool success, bytes memory returndata) = targets[i].call{value: values[i]}(calldatas[i]);", "highlightLines": [325]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 325, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "6cdc00eb4bf6", "fix": {"template": null, "available": false}, "title": "Low-level call without checking return value - silent failure possible", "ruleId": "rules.sol-unchecked-call-return", "snippet": {"code": "            (bool success, bytes memory returndata) = targets[i].call{value: values[i]}(calldatas[i]);", "highlightLines": [325]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 325, "column": 65}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-104/", "https://blocksecteam.medium.com/li-fi-attack"], "description": ""}, {"id": "cc956f82174c", "fix": {"template": null, "available": false}, "title": "State change after external call - potential reentrancy vulnerability", "ruleId": "rules.sol-external-call-state-change", "snippet": {"code": "            (bool success, bytes memory returndata) = targets[i].call{value: values[i]}(calldatas[i]);\n            Address.verifyCallResult(success, returndata, errorMessage);\n        }\n    }\n\n    /**\n     * @dev Hook before execution is triggered.\n     */\n    function _beforeExecute(\n        uint256, /* proposalId */\n        address[] memory targets,\n        uint256[] memory, /* values */\n        bytes[] memory calldatas,\n        bytes32 /*descriptionHash*/\n    ) internal virtual {\n        if (_executor() != address(this)) {\n            for (uint256 i = 0; i < targets.length; ++i) {", "highlightLines": [325]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 325, "column": 65}, "severity": "high", "references": ["https://consensys.github.io/smart-contract-best-practices/attacks/reentrancy/"], "description": ""}, {"id": "16c62b3839d5", "fix": {"template": null, "available": false}, "title": "Storage array passed by value to internal function - changes won't persist", "ruleId": "rules.sol-array-by-reference", "snippet": {"code": "    function _beforeExecute(\n        uint256, /* proposalId */\n        address[] memory targets,\n        uint256[] memory, /* values */\n        bytes[] memory calldatas,\n        bytes32 /*descriptionHash*/\n    ) internal virtual {", "highlightLines": [333]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 333, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#modifying-storage-array-by-value"], "description": ""}, {"id": "012e7c206217", "fix": {"template": null, "available": false}, "title": "Storage variable modified in loop - should cache in memory for gas savings", "ruleId": "rules.sol-memory-vs-storage-loop", "snippet": {"code": "            for (uint256 i = 0; i < targets.length; ++i) {\n                if (targets[i] == address(this)) {", "highlightLines": [341]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 341, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "be2fdd21850f", "fix": {"template": null, "available": false}, "title": "Unbounded loop iterating over dynamic array - can cause out-of-gas DoS", "ruleId": "rules.sol-unbounded-loop-dos", "snippet": {"code": "            for (uint256 i = 0; i < targets.length; ++i) {\n                if (targets[i] == address(this)) {\n                    _governanceCall.pushBack(keccak256(calldatas[i]));", "highlightLines": [341]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 341, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "d571f4d6242b", "fix": {"template": null, "available": false}, "title": "Unbounded loop over dynamic array - can cause DoS if array grows large", "ruleId": "rules.sol-unbounded-protocol-loop", "snippet": {"code": "            for (uint256 i = 0; i < targets.length; ++i) {\n                if (targets[i] == address(this)) {\n                    _governanceCall.pushBack(keccak256(calldatas[i]));", "highlightLines": [341]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 341, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "641d41201fd0", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "                if (targets[i] == address(this)) {\n                    _governanceCall.pushBack(keccak256(calldatas[i]));\n                }", "highlightLines": [342]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 342, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "e15165dd28cf", "fix": {"template": null, "available": false}, "title": "address(this) stored in mapping - contracts often confuse handler address with token address", "ruleId": "rules.sol-address-this-in-mapping-storage", "snippet": {"code": "                if (targets[i] == address(this)) {", "highlightLines": [342]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 342, "column": 21}, "severity": "medium", "references": [], "description": ""}, {"id": "e2bdbd205d50", "fix": {"template": null, "available": false}, "title": "Storage array passed by value to internal function - changes won't persist", "ruleId": "rules.sol-array-by-reference", "snippet": {"code": "    function _cancel(\n        address[] memory targets,\n        uint256[] memory values,\n        bytes[] memory calldatas,\n        bytes32 descriptionHash\n    ) internal virtual returns (uint256) {", "highlightLines": [372]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 372, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#modifying-storage-array-by-value"], "description": ""}, {"id": "c764c6fdcf6f", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 proposalId = hashProposal(targets, values, calldatas, descriptionHash);", "highlightLines": [378]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 378, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "9a2bed675343", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 proposalId = hashProposal(targets, values, calldatas, descriptionHash);\n        ProposalState status = state(proposalId);", "highlightLines": [378]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 378, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "5aa8005c4f53", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        ProposalState status = state(proposalId);\n\n        require(\n            status != ProposalState.Canceled && status != ProposalState.Expired && status != ProposalState.Executed,\n            \"Governor: proposal not active\"\n        );\n        _proposals[proposalId].canceled = true;", "highlightLines": [379]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 379, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "0dbad16e7674", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address voter = _msgSender();", "highlightLines": [414]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 414, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "6023069b4301", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address voter = _msgSender();", "highlightLines": [426]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 426, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "cbeb3f8eb81d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address voter = _msgSender();", "highlightLines": [439]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 439, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "40eb061cbc92", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address voter = ECDSA.recover(", "highlightLines": [453]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 453, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e72ba63f5639", "fix": {"template": null, "available": false}, "title": "ecrecover result not checked for zero address - invalid signatures return address(0)", "ruleId": "rules.sol-ethernaut-ecrecover-no-zero-check", "snippet": {"code": "        address voter = ECDSA.recover(\n            _hashTypedDataV4(keccak256(abi.encode(BALLOT_TYPEHASH, proposalId, support))),\n            v,\n            r,\n            s\n        );", "highlightLines": [453]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 453, "column": 25}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-117", "https://swcregistry.io/docs/SWC-122"], "description": ""}, {"id": "27197bccfa4b", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "            _hashTypedDataV4(keccak256(abi.encode(BALLOT_TYPEHASH, proposalId, support))),", "highlightLines": [454]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 454, "column": 30}, "severity": "high", "references": [], "description": ""}, {"id": "f14d4f1728c4", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address voter = ECDSA.recover(", "highlightLines": [474]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 474, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "58e193668c66", "fix": {"template": null, "available": false}, "title": "ecrecover result not checked for zero address - invalid signatures return address(0)", "ruleId": "rules.sol-ethernaut-ecrecover-no-zero-check", "snippet": {"code": "        address voter = ECDSA.recover(\n            _hashTypedDataV4(\n                keccak256(\n                    abi.encode(\n                        EXTENDED_BALLOT_TYPEHASH,\n                        proposalId,\n                        support,\n                        keccak256(bytes(reason)),\n                        keccak256(params)\n                    )\n                )\n            ),\n            v,\n            r,\n            s\n        );", "highlightLines": [474]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 474, "column": 25}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-117", "https://swcregistry.io/docs/SWC-122"], "description": ""}, {"id": "06241fa43c58", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "                keccak256(\n                    abi.encode(\n                        EXTENDED_BALLOT_TYPEHASH,\n                        proposalId,\n                        support,\n                        keccak256(bytes(reason)),\n                        keccak256(params)\n                    )\n                )", "highlightLines": [476]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 476, "column": 17}, "severity": "high", "references": [], "description": ""}, {"id": "ad4bd46a828c", "fix": {"template": null, "available": false}, "title": "Signature verification without EIP-712 domain separator - vulnerable to cross-chain/cross-contract replay", "ruleId": "rules.sol-ethernaut-missing-eip712-domain", "snippet": {"code": "                keccak256(\n                    abi.encode(\n                        EXTENDED_BALLOT_TYPEHASH,\n                        proposalId,\n                        support,\n                        keccak256(bytes(reason)),\n                        keccak256(params)\n                    )\n                )", "highlightLines": [476]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 476, "column": 17}, "severity": "high", "references": ["https://eips.ethereum.org/EIPS/eip-712", "https://ethernaut.openzeppelin.com/"], "description": ""}, {"id": "0e0b9b0c05d4", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        ProposalCore storage proposal = _proposals[proposalId];\n        require(state(proposalId) == ProposalState.Active, \"Governor: vote not currently active\");\n\n        uint256 weight = _getVotes(account, proposal.voteStart.getDeadline(), params);", "highlightLines": [522]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 522, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "7dfeb367473b", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 weight = _getVotes(account, proposal.voteStart.getDeadline(), params);", "highlightLines": [524]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 524, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d340f02ba6ab", "fix": {"template": null, "available": false}, "title": "Governance can execute arbitrary calls - verify this is intentional and secured", "ruleId": "rules.sol-ethernaut-governance-arbitrary-call", "snippet": {"code": "    ) external virtual onlyGovernance {", "highlightLines": [547]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 547, "column": 24}, "severity": "medium", "references": [], "description": ""}, {"id": "8a75babc64ec", "fix": {"template": null, "available": false}, "title": "Token callback function without reentrancy protection - ERC777/721/1155 callbacks can reenter", "ruleId": "rules.sol-callback-without-reentrancy-guard", "snippet": {"code": "    function onERC721Received(\n        address,\n        address,\n        uint256,\n        bytes memory\n    ) public virtual override returns (bytes4) {", "highlightLines": [562]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 562, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "ce5dd389f909", "fix": {"template": null, "available": false}, "title": "Token callback function without reentrancy protection - ERC777/721/1155 callbacks can reenter", "ruleId": "rules.sol-callback-without-reentrancy-guard", "snippet": {"code": "    function onERC1155Received(\n        address,\n        address,\n        uint256,\n        uint256,\n        bytes memory\n    ) public virtual override returns (bytes4) {", "highlightLines": [574]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 574, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "d9d5cfd11d1c", "fix": {"template": null, "available": false}, "title": "Token callback function without reentrancy protection - ERC777/721/1155 callbacks can reenter", "ruleId": "rules.sol-callback-without-reentrancy-guard", "snippet": {"code": "    function onERC1155BatchReceived(\n        address,\n        address,\n        uint256[] memory,\n        uint256[] memory,\n        bytes memory\n    ) public virtual override returns (bytes4) {", "highlightLines": [587]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/Governor.sol", "line": 587, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "10d71be45107", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/IGovernor.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "7afc1edac1dd", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "abstract contract IGovernor is IERC165 {", "highlightLines": [13]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/IGovernor.sol", "line": 13, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "573ab34ee9af", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event ProposalCreated(\n        uint256 proposalId,\n        address proposer,\n        address[] targets,\n        uint256[] values,\n        string[] signatures,\n        bytes[] calldatas,\n        uint256 startBlock,\n        uint256 endBlock,\n        string description\n    );", "highlightLines": [28]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/IGovernor.sol", "line": 28, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "3b103a12b7d9", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event ProposalCanceled(uint256 proposalId);", "highlightLines": [43]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/IGovernor.sol", "line": 43, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "61a8d321054d", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event ProposalExecuted(uint256 proposalId);", "highlightLines": [48]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/IGovernor.sol", "line": 48, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "e4d6482de2e9", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event VoteCast(address indexed voter, uint256 proposalId, uint8 support, uint256 weight, string reason);", "highlightLines": [55]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/IGovernor.sol", "line": 55, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "679caa4da2fc", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event VoteCastWithParams(\n        address indexed voter,\n        uint256 proposalId,\n        uint8 support,\n        uint256 weight,\n        string reason,\n        bytes params\n    );", "highlightLines": [63]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/IGovernor.sol", "line": 63, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "ada3cb17a3f0", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event VoteCastWithParams(\n        address indexed voter,\n        uint256 proposalId,\n        uint8 support,\n        uint256 weight,\n        string reason,\n        bytes params\n    );", "highlightLines": [63]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/IGovernor.sol", "line": 63, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "b83ccf842f72", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function getVotes(address account, uint256 blockNumber) public view virtual returns (uint256);", "highlightLines": [173]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/IGovernor.sol", "line": 173, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "86beffdcfbcf", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function getVotesWithParams(\n        address account,\n        uint256 blockNumber,\n        bytes memory params\n    ) public view virtual returns (uint256);", "highlightLines": [179]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/IGovernor.sol", "line": 179, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "34a1865200b6", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/TimelockController.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "95f5ba55964e", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "contract TimelockController is AccessControl, IERC721Receiver, IERC1155Receiver {", "highlightLines": [26]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/TimelockController.sol", "line": 26, "column": 1}, "severity": "medium", "references": [], "description": ""}, {"id": "50fcbad647be", "fix": {"template": null, "available": false}, "title": "Base constructor called multiple times through diamond inheritance - may initialize twice", "ruleId": "rules.sol-reused-constructor", "snippet": {"code": "contract TimelockController is AccessControl, IERC721Receiver, IERC1155Receiver {", "highlightLines": [26]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/TimelockController.sol", "line": 26, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#reused-base-constructor"], "description": ""}, {"id": "18d4f532b5ff", "fix": {"template": null, "available": false}, "title": "SWC-125: Multiple inheritance may cause incorrect function resolution - check C3 linearization", "ruleId": "rules.sol-swc-125-inheritance-order", "snippet": {"code": "contract TimelockController is AccessControl, IERC721Receiver, IERC1155Receiver {", "highlightLines": [26]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/TimelockController.sol", "line": 26, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-125"], "description": ""}, {"id": "21dbb2e1b112", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract TimelockController is AccessControl, IERC721Receiver, IERC1155Receiver {\n    bytes32 public constant TIMELOCK_ADMIN_ROLE = keccak256(\"TIMELOCK_ADMIN_ROLE\");\n    bytes32 public constant PROPOSER_ROLE = keccak256(\"PROPOSER_ROLE\");\n    bytes32 public constant EXECUTOR_ROLE = keccak256(\"EXECUTOR_ROLE\");\n    bytes32 public constant CANCELLER_ROLE = keccak256(\"CANCELLER_ROLE\");\n    uint256 internal constant _DONE_TIMESTAMP = uint256(1);\n\n    mapping(bytes32 => uint256) private _timestamps;\n    uint256 private _minDelay;\n\n    /**\n     * @dev Emitted when a call is scheduled as part of operation `id`.\n     */\n    event CallScheduled(\n        bytes32 indexed id,\n        uint256 indexed index,\n        address target,\n        uint256 value,\n        bytes data,\n        bytes32 predecessor,\n        uint256 delay\n    );\n\n    /**\n     * @dev Emitted when a call is performed as part of operation `id`.\n     */\n    event CallExecuted(bytes32 indexed id, uint256 indexed index, address target, uint256 value, bytes data);\n\n    /**\n     * @dev Emitted when operation `id` is cancelled.\n     */\n    event Cancelled(bytes32 indexed id);\n\n    /**\n     * @dev Emitted when the minimum delay for future operations is modified.\n     */\n    event MinDelayChange(uint256 oldDuration, uint256 newDuration);\n\n    /**\n     * @dev Initializes the contract with a given `minDelay`, and a list of\n     * initial proposers and executors. The proposers receive both the\n     * proposer and the canceller role (for backward compatibility). The\n     * executors receive the executor role.\n     *\n     * NOTE: At construction, both the deployer and the timelock itself are\n     * administrators. This helps further configuration of the timelock by the\n     * deployer. After configuration is done, it is recommended that the\n     * deployer renounces its admin position and relies on timelocked\n     * operations to perform future maintenance.\n     */\n    constructor(\n        uint256 minDelay,\n        address[] memory proposers,\n        address[] memory executors\n    ) {\n        _setRoleAdmin(TIMELOCK_ADMIN_ROLE, TIMELOCK_ADMIN_ROLE);\n        _setRoleAdmin(PROPOSER_ROLE, TIMELOCK_ADMIN_ROLE);\n        _setRoleAdmin(EXECUTOR_ROLE, TIMELOCK_ADMIN_ROLE);\n        _setRoleAdmin(CANCELLER_ROLE, TIMELOCK_ADMIN_ROLE);\n\n        // deployer + self administration\n        _setupRole(TIMELOCK_ADMIN_ROLE, _msgSender());\n        _setupRole(TIMELOCK_ADMIN_ROLE, address(this));\n\n        // register proposers and cancellers\n        for (uint256 i = 0; i < proposers.length; ++i) {", "highlightLines": [26]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/TimelockController.sol", "line": 26, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "503943e9ca2e", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event CallScheduled(\n        bytes32 indexed id,\n        uint256 indexed index,\n        address target,\n        uint256 value,\n        bytes data,\n        bytes32 predecessor,\n        uint256 delay\n    );", "highlightLines": [39]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/TimelockController.sol", "line": 39, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "ab8b4dea86cd", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event MinDelayChange(uint256 oldDuration, uint256 newDuration);", "highlightLines": [62]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/TimelockController.sol", "line": 62, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "50af785604fe", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(\n        uint256 minDelay,\n        address[] memory proposers,\n        address[] memory executors\n    ) {\n        _setRoleAdmin(TIMELOCK_ADMIN_ROLE, TIMELOCK_ADMIN_ROLE);\n        _setRoleAdmin(PROPOSER_ROLE, TIMELOCK_ADMIN_ROLE);\n        _setRoleAdmin(EXECUTOR_ROLE, TIMELOCK_ADMIN_ROLE);\n        _setRoleAdmin(CANCELLER_ROLE, TIMELOCK_ADMIN_ROLE);\n\n        // deployer + self administration\n        _setupRole(TIMELOCK_ADMIN_ROLE, _msgSender());\n        _setupRole(TIMELOCK_ADMIN_ROLE, address(this));\n\n        // register proposers and cancellers\n        for (uint256 i = 0; i < proposers.length; ++i) {\n            _setupRole(PROPOSER_ROLE, proposers[i]);\n            _setupRole(CANCELLER_ROLE, proposers[i]);\n        }\n\n        // register executors\n        for (uint256 i = 0; i < executors.length; ++i) {\n            _setupRole(EXECUTOR_ROLE, executors[i]);\n        }\n\n        _minDelay = minDelay;\n        emit MinDelayChange(0, minDelay);\n    }", "highlightLines": [76]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/TimelockController.sol", "line": 76, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "29cc72df0c39", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyRoleOrOpenRole(bytes32 role) {\n        if (!hasRole(role, address(0))) {\n            _checkRole(role, _msgSender());\n        }\n        _;\n    }", "highlightLines": [111]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/TimelockController.sol", "line": 111, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "c05ac1b2fba0", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [115]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/TimelockController.sol", "line": 115, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "4626cfaafddf", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    receive() external payable {}", "highlightLines": [121]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/TimelockController.sol", "line": 121, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "1c27b0a0324f", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "    receive() external payable {}", "highlightLines": [121]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/TimelockController.sol", "line": 121, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "987668596948", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function supportsInterface(bytes4 interfaceId) public view virtual override(IERC165, AccessControl) returns (bool) {\n        return interfaceId == type(IERC1155Receiver).interfaceId || super.supportsInterface(interfaceId);", "highlightLines": [126]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/TimelockController.sol", "line": 126, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "4cbc9c573f61", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function isOperationReady(bytes32 id) public view virtual returns (bool ready) {\n        uint256 timestamp = getTimestamp(id);", "highlightLines": [148]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/TimelockController.sol", "line": 148, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "650dc6e9d70f", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 timestamp = getTimestamp(id);", "highlightLines": [149]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/TimelockController.sol", "line": 149, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "849146efffaa", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        return timestamp > _DONE_TIMESTAMP && timestamp <= block.timestamp;", "highlightLines": [150]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/TimelockController.sol", "line": 150, "column": 60}, "severity": "medium", "references": [], "description": ""}, {"id": "6397c8e2206b", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        return keccak256(abi.encode(target, value, data, predecessor, salt));", "highlightLines": [188]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/TimelockController.sol", "line": 188, "column": 16}, "severity": "high", "references": [], "description": ""}, {"id": "1d667058aadd", "fix": {"template": null, "available": false}, "title": "Signature verification without EIP-712 domain separator - vulnerable to cross-chain/cross-contract replay", "ruleId": "rules.sol-ethernaut-missing-eip712-domain", "snippet": {"code": "        return keccak256(abi.encode(target, value, data, predecessor, salt));", "highlightLines": [188]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/TimelockController.sol", "line": 188, "column": 16}, "severity": "high", "references": ["https://eips.ethereum.org/EIPS/eip-712", "https://ethernaut.openzeppelin.com/"], "description": ""}, {"id": "d026d2dd1b84", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        return keccak256(abi.encode(targets, values, payloads, predecessor, salt));", "highlightLines": [202]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/TimelockController.sol", "line": 202, "column": 16}, "severity": "high", "references": [], "description": ""}, {"id": "3e23b5446e92", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 id = hashOperation(target, value, data, predecessor, salt);", "highlightLines": [222]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/TimelockController.sol", "line": 222, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "687eae153734", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        bytes32 id = hashOperationBatch(targets, values, payloads, predecessor, salt);", "highlightLines": [246]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/TimelockController.sol", "line": 246, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "aabbff1443e5", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        _timestamps[id] = block.timestamp + delay;", "highlightLines": [260]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/TimelockController.sol", "line": 260, "column": 27}, "severity": "medium", "references": [], "description": ""}, {"id": "be201005dd4c", "fix": {"template": null, "available": false}, "title": "Deleting mapping inside struct leaves nested data - use separate mapping deletion", "ruleId": "rules.sol-mapping-deletion", "snippet": {"code": "        delete _timestamps[id];", "highlightLines": [272]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/TimelockController.sol", "line": 272, "column": 9}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#deletion-on-mapping-containing-a-structure"], "description": ""}, {"id": "8222810d2139", "fix": {"template": null, "available": false}, "title": "delete array[i] leaves gap with zero value - use swap-and-pop pattern instead", "ruleId": "rules.sol-array-element-delete", "snippet": {"code": "        delete _timestamps[id];", "highlightLines": [272]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/TimelockController.sol", "line": 272, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/Array-deletion.sol"], "description": ""}, {"id": "15da4dd41130", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 id = hashOperation(target, value, payload, predecessor, salt);", "highlightLines": [296]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/TimelockController.sol", "line": 296, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "63e4d72bd52c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        bytes32 id = hashOperationBatch(targets, values, payloads, predecessor, salt);", "highlightLines": [322]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/TimelockController.sol", "line": 322, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "485dbe087920", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes32 id = hashOperationBatch(targets, values, payloads, predecessor, salt);\n\n        _beforeCall(id, predecessor);\n        for (uint256 i = 0; i < targets.length; ++i) {\n            address target = targets[i];\n            uint256 value = values[i];\n            bytes calldata payload = payloads[i];\n            _execute(target, value, payload);\n            emit CallExecuted(id, i, target, value, payload);\n        }", "highlightLines": [323]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/TimelockController.sol", "line": 323, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d93613eaafa4", "fix": {"template": null, "available": false}, "title": "Unbounded loop iterating over dynamic array - can cause out-of-gas DoS", "ruleId": "rules.sol-unbounded-loop-dos", "snippet": {"code": "        for (uint256 i = 0; i < targets.length; ++i) {\n            address target = targets[i];\n            uint256 value = values[i];\n            bytes calldata payload = payloads[i];", "highlightLines": [326]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/TimelockController.sol", "line": 326, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "cd1971ea777f", "fix": {"template": null, "available": false}, "title": "Unbounded loop over dynamic array - can cause DoS if array grows large", "ruleId": "rules.sol-unbounded-protocol-loop", "snippet": {"code": "        for (uint256 i = 0; i < targets.length; ++i) {\n            address target = targets[i];\n            uint256 value = values[i];\n            bytes calldata payload = payloads[i];", "highlightLines": [326]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/TimelockController.sol", "line": 326, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "61ff44e41111", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            address target = targets[i];", "highlightLines": [327]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/TimelockController.sol", "line": 327, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "23e8dbdaba1c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            address target = targets[i];\n            uint256 value = values[i];", "highlightLines": [327]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/TimelockController.sol", "line": 327, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "f8dd67e39daf", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint256 value = values[i];", "highlightLines": [328]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/TimelockController.sol", "line": 328, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "fbc46386bfb3", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            uint256 value = values[i];\n            bytes calldata payload = payloads[i];", "highlightLines": [328]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/TimelockController.sol", "line": 328, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "33d1883405bf", "fix": {"template": null, "available": false}, "title": "Low-level call without checking return value - silent failure possible", "ruleId": "rules.sol-unchecked-call-return", "snippet": {"code": "        (bool success, ) = target.call{value: value}(data);", "highlightLines": [344]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/TimelockController.sol", "line": 344, "column": 34}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-104/", "https://blocksecteam.medium.com/li-fi-attack"], "description": ""}, {"id": "f0d4fc552ba7", "fix": {"template": null, "available": false}, "title": "State change after external call - potential reentrancy vulnerability", "ruleId": "rules.sol-external-call-state-change", "snippet": {"code": "        (bool success, ) = target.call{value: value}(data);\n        require(success, \"TimelockController: underlying transaction reverted\");\n    }\n\n    /**\n     * @dev Checks before execution of an operation's calls.\n     */\n    function _beforeCall(bytes32 id, bytes32 predecessor) private view {\n        require(isOperationReady(id), \"TimelockController: operation is not ready\");\n        require(predecessor == bytes32(0) || isOperationDone(predecessor), \"TimelockController: missing dependency\");", "highlightLines": [344]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/TimelockController.sol", "line": 344, "column": 34}, "severity": "high", "references": ["https://consensys.github.io/smart-contract-best-practices/attacks/reentrancy/"], "description": ""}, {"id": "43cbfb575d6e", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function _beforeCall(bytes32 id, bytes32 predecessor) private view {\n        require(isOperationReady(id), \"TimelockController: operation is not ready\");\n        require(predecessor == bytes32(0) || isOperationDone(predecessor), \"TimelockController: missing dependency\");", "highlightLines": [351]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/TimelockController.sol", "line": 351, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "703dc01f44ca", "fix": {"template": null, "available": false}, "title": "Token callback function without reentrancy protection - ERC777/721/1155 callbacks can reenter", "ruleId": "rules.sol-callback-without-reentrancy-guard", "snippet": {"code": "    function onERC721Received(\n        address,\n        address,\n        uint256,\n        bytes memory\n    ) public virtual override returns (bytes4) {", "highlightLines": [383]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/TimelockController.sol", "line": 383, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "ebf7e6975a37", "fix": {"template": null, "available": false}, "title": "Token callback function without reentrancy protection - ERC777/721/1155 callbacks can reenter", "ruleId": "rules.sol-callback-without-reentrancy-guard", "snippet": {"code": "    function onERC1155Received(\n        address,\n        address,\n        uint256,\n        uint256,\n        bytes memory\n    ) public virtual override returns (bytes4) {", "highlightLines": [395]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/TimelockController.sol", "line": 395, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "54543f56e56c", "fix": {"template": null, "available": false}, "title": "Token callback function without reentrancy protection - ERC777/721/1155 callbacks can reenter", "ruleId": "rules.sol-callback-without-reentrancy-guard", "snippet": {"code": "    function onERC1155BatchReceived(\n        address,\n        address,\n        uint256[] memory,\n        uint256[] memory,\n        bytes memory\n    ) public virtual override returns (bytes4) {", "highlightLines": [408]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/TimelockController.sol", "line": 408, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "6f7d370c88c7", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "29457907d735", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "abstract contract GovernorCompatibilityBravo is IGovernorTimelock, IGovernorCompatibilityBravo, Governor {", "highlightLines": [21]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 21, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "f445f36d16e7", "fix": {"template": null, "available": false}, "title": "Base constructor called multiple times through diamond inheritance - may initialize twice", "ruleId": "rules.sol-reused-constructor", "snippet": {"code": "abstract contract GovernorCompatibilityBravo is IGovernorTimelock, IGovernorCompatibilityBravo, Governor {", "highlightLines": [21]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 21, "column": 10}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#reused-base-constructor"], "description": ""}, {"id": "8fbb725e31e5", "fix": {"template": null, "available": false}, "title": "SWC-125: Multiple inheritance may cause incorrect function resolution - check C3 linearization", "ruleId": "rules.sol-swc-125-inheritance-order", "snippet": {"code": "abstract contract GovernorCompatibilityBravo is IGovernorTimelock, IGovernorCompatibilityBravo, Governor {", "highlightLines": [21]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 21, "column": 10}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-125"], "description": ""}, {"id": "290a578e8e63", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address proposer;", "highlightLines": [29]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 29, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b12235d83728", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 forVotes;", "highlightLines": [34]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 34, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "35f4e70ae503", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 againstVotes;", "highlightLines": [35]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 35, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b9fdd42a4a40", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 abstainVotes;", "highlightLines": [36]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 36, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b44583c9c2ce", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 descriptionHash;", "highlightLines": [38]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 38, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "451ebb5ed7c0", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function COUNTING_MODE() public pure virtual override returns (string memory) {\n        return \"support=bravo&quorum=bravo\";", "highlightLines": [44]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 44, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "cf36713edd03", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        _storeProposal(_msgSender(), targets, values, new string[](calldatas.length), calldatas, description);", "highlightLines": [58]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 58, "column": 55}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "26fc1f5982a2", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function _encodeCalldata(string[] memory signatures, bytes[] memory calldatas)\n        private\n        pure\n        returns (bytes[] memory)\n    {\n        bytes[] memory fullcalldatas = new bytes[](calldatas.length);\n\n        for (uint256 i = 0; i < signatures.length; ++i) {", "highlightLines": [121]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 121, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "fd71d7c312f8", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes[] memory fullcalldatas = new bytes[](calldatas.length);\n\n        for (uint256 i = 0; i < signatures.length; ++i) {\n            fullcalldatas[i] = bytes(signatures[i]).length == 0\n                ? calldatas[i]\n                : abi.encodePacked(bytes4(keccak256(bytes(signatures[i]))), calldatas[i]);\n        }", "highlightLines": [126]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 126, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "fcd28b75ef62", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        bytes[] memory fullcalldatas = new bytes[](calldatas.length);", "highlightLines": [126]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 126, "column": 40}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "7cd7f1994beb", "fix": {"template": null, "available": false}, "title": "Storage variable modified in loop - should cache in memory for gas savings", "ruleId": "rules.sol-memory-vs-storage-loop", "snippet": {"code": "        for (uint256 i = 0; i < signatures.length; ++i) {\n            fullcalldatas[i] = bytes(signatures[i]).length == 0", "highlightLines": [128]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 128, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "500ab573aa43", "fix": {"template": null, "available": false}, "title": "Unbounded loop iterating over dynamic array - can cause out-of-gas DoS", "ruleId": "rules.sol-unbounded-loop-dos", "snippet": {"code": "        for (uint256 i = 0; i < signatures.length; ++i) {\n            fullcalldatas[i] = bytes(signatures[i]).length == 0\n                ? calldatas[i]\n                : abi.encodePacked(bytes4(keccak256(bytes(signatures[i]))), calldatas[i]);", "highlightLines": [128]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 128, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "f5ab86ee9461", "fix": {"template": null, "available": false}, "title": "Unbounded loop over dynamic array - can cause DoS if array grows large", "ruleId": "rules.sol-unbounded-protocol-loop", "snippet": {"code": "        for (uint256 i = 0; i < signatures.length; ++i) {\n            fullcalldatas[i] = bytes(signatures[i]).length == 0\n                ? calldatas[i]\n                : abi.encodePacked(bytes4(keccak256(bytes(signatures[i]))), calldatas[i]);", "highlightLines": [128]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 128, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "0c4a32195880", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function _storeProposal(\n        address proposer,\n        address[] memory targets,\n        uint256[] memory values,\n        string[] memory signatures,\n        bytes[] memory calldatas,\n        string memory description\n    ) private {\n        bytes32 descriptionHash = keccak256(bytes(description));\n        uint256 proposalId = hashProposal(targets, values, _encodeCalldata(signatures, calldatas), descriptionHash);\n\n        ProposalDetails storage details = _proposalDetails[proposalId];\n        if (details.descriptionHash == bytes32(0)) {\n            details.proposer = proposer;\n            details.targets = targets;\n            details.values = values;\n            details.signatures = signatures;\n            details.calldatas = calldatas;", "highlightLines": [140]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 140, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "6d4c5396b68e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 descriptionHash = keccak256(bytes(description));", "highlightLines": [148]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 148, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "eaf3ea492711", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes32 descriptionHash = keccak256(bytes(description));\n        uint256 proposalId = hashProposal(targets, values, _encodeCalldata(signatures, calldatas), descriptionHash);", "highlightLines": [148]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 148, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "a696f81c64bc", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 proposalId = hashProposal(targets, values, _encodeCalldata(signatures, calldatas), descriptionHash);", "highlightLines": [149]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 149, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7321d8fd1dfe", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 proposalId = hashProposal(targets, values, _encodeCalldata(signatures, calldatas), descriptionHash);\n\n        ProposalDetails storage details = _proposalDetails[proposalId];", "highlightLines": [149]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 149, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "43955cf66bb7", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        ProposalDetails storage details = _proposalDetails[proposalId];\n        if (details.descriptionHash == bytes32(0)) {\n            details.proposer = proposer;\n            details.targets = targets;\n            details.values = values;\n            details.signatures = signatures;\n            details.calldatas = calldatas;\n            details.descriptionHash = descriptionHash;\n        }", "highlightLines": [151]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 151, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "de78cbf0a2ca", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            details.proposer = proposer;\n            details.targets = targets;", "highlightLines": [153]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 153, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "5c08123128ff", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            details.targets = targets;\n            details.values = values;", "highlightLines": [154]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 154, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "ed6f95c035bd", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            details.values = values;\n            details.signatures = signatures;", "highlightLines": [155]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 155, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "9cde0f6d7eef", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            details.signatures = signatures;\n            details.calldatas = calldatas;", "highlightLines": [156]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 156, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "cb1884ec1515", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            details.calldatas = calldatas;\n            details.descriptionHash = descriptionHash;", "highlightLines": [157]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 157, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "a6b2394f2059", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function proposals(uint256 proposalId)\n        public\n        view\n        virtual\n        override\n        returns (\n            uint256 id,\n            address proposer,\n            uint256 eta,\n            uint256 startBlock,\n            uint256 endBlock,\n            uint256 forVotes,\n            uint256 againstVotes,\n            uint256 abstainVotes,\n            bool canceled,\n            bool executed\n        )\n    {\n        id = proposalId;\n        eta = proposalEta(proposalId);\n        startBlock = proposalSnapshot(proposalId);\n        endBlock = proposalDeadline(proposalId);\n\n        ProposalDetails storage details = _proposalDetails[proposalId];\n        proposer = details.proposer;\n        forVotes = details.forVotes;\n        againstVotes = details.againstVotes;\n        abstainVotes = details.abstainVotes;\n\n        ProposalState status = state(proposalId);\n        canceled = status == ProposalState.Canceled;\n        executed = status == ProposalState.Executed;", "highlightLines": [166]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 166, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "a63b1033c14e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        id = proposalId;\n        eta = proposalEta(proposalId);", "highlightLines": [184]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 184, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "2c089bb42c93", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        eta = proposalEta(proposalId);\n        startBlock = proposalSnapshot(proposalId);", "highlightLines": [185]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 185, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "3a9a86d0cfa6", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        startBlock = proposalSnapshot(proposalId);\n        endBlock = proposalDeadline(proposalId);", "highlightLines": [186]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 186, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "ec27dc6c978d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        endBlock = proposalDeadline(proposalId);\n\n        ProposalDetails storage details = _proposalDetails[proposalId];", "highlightLines": [187]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 187, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d0dc4b03581b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        ProposalDetails storage details = _proposalDetails[proposalId];\n        proposer = details.proposer;", "highlightLines": [189]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 189, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "1e8d2eb53840", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        proposer = details.proposer;\n        forVotes = details.forVotes;", "highlightLines": [190]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 190, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "10fdb5b98692", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        forVotes = details.forVotes;\n        againstVotes = details.againstVotes;", "highlightLines": [191]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 191, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "cfb57c747e1b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        againstVotes = details.againstVotes;\n        abstainVotes = details.abstainVotes;", "highlightLines": [192]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 192, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "4eaf9b52fc69", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        abstainVotes = details.abstainVotes;\n\n        ProposalState status = state(proposalId);", "highlightLines": [193]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 193, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "0accbaaa9f5f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        ProposalState status = state(proposalId);\n        canceled = status == ProposalState.Canceled;", "highlightLines": [195]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 195, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "426ef695bb6c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        canceled = status == ProposalState.Canceled;\n        executed = status == ProposalState.Executed;", "highlightLines": [196]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 196, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "2eb832dc103a", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function getActions(uint256 proposalId)\n        public\n        view\n        virtual\n        override\n        returns (\n            address[] memory targets,\n            uint256[] memory values,\n            string[] memory signatures,\n            bytes[] memory calldatas\n        )\n    {\n        ProposalDetails storage details = _proposalDetails[proposalId];", "highlightLines": [203]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 203, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "32a91990a568", "fix": {"template": null, "available": false}, "title": "External call in view/pure function - can enable reentrancy during reads", "ruleId": "rules.sol-reentrancy-in-view", "snippet": {"code": "    function getActions(uint256 proposalId)\n        public\n        view\n        virtual\n        override\n        returns (\n            address[] memory targets,\n            uint256[] memory values,\n            string[] memory signatures,\n            bytes[] memory calldatas\n        )\n    {\n        ProposalDetails storage details = _proposalDetails[proposalId];\n        return (details.targets, details.values, details.signatures, details.calldatas);", "highlightLines": [203]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 203, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "7c8815ab125e", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function _quorumReached(uint256 proposalId) internal view virtual override returns (bool) {\n        ProposalDetails storage details = _proposalDetails[proposalId];", "highlightLines": [244]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 244, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "538fb8bb8857", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function _voteSucceeded(uint256 proposalId) internal view virtual override returns (bool) {\n        ProposalDetails storage details = _proposalDetails[proposalId];", "highlightLines": [252]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 252, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "1fbe4f0d3bf8", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function _countVote(\n        uint256 proposalId,\n        address account,\n        uint8 support,\n        uint256 weight,\n        bytes memory // params\n    ) internal virtual override {\n        ProposalDetails storage details = _proposalDetails[proposalId];\n        Receipt storage receipt = details.receipts[account];\n\n        require(!receipt.hasVoted, \"GovernorCompatibilityBravo: vote already cast\");\n        receipt.hasVoted = true;\n        receipt.support = support;\n        receipt.votes = SafeCast.toUint96(weight);\n\n        if (support == uint8(VoteType.Against)) {", "highlightLines": [260]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 260, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "bec48243cff8", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        ProposalDetails storage details = _proposalDetails[proposalId];\n        Receipt storage receipt = details.receipts[account];", "highlightLines": [267]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 267, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d36cb3b7a5fc", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        Receipt storage receipt = details.receipts[account];\n\n        require(!receipt.hasVoted, \"GovernorCompatibilityBravo: vote already cast\");\n        receipt.hasVoted = true;", "highlightLines": [268]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 268, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e068b027ef13", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        receipt.hasVoted = true;\n        receipt.support = support;", "highlightLines": [271]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 271, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "fdc834161546", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        receipt.support = support;\n        receipt.votes = SafeCast.toUint96(weight);", "highlightLines": [272]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 272, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "19c1ae93a0a7", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        if (support == uint8(VoteType.Against)) {", "highlightLines": [275]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 275, "column": 24}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "c779bc2a3f90", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        } else if (support == uint8(VoteType.For)) {", "highlightLines": [277]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 277, "column": 31}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "d07d55df1148", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        } else if (support == uint8(VoteType.Abstain)) {", "highlightLines": [279]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/GovernorCompatibilityBravo.sol", "line": 279, "column": 31}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "c96a6115e73c", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/IGovernorCompatibilityBravo.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "14306cce0204", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "abstract contract IGovernorCompatibilityBravo is IGovernor {", "highlightLines": [13]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/IGovernorCompatibilityBravo.sol", "line": 13, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "0277abf78bd3", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 id;", "highlightLines": [19]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/IGovernorCompatibilityBravo.sol", "line": 19, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7fa3a9c8f87e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address proposer;", "highlightLines": [20]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/IGovernorCompatibilityBravo.sol", "line": 20, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ac9e94624dd8", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 eta;", "highlightLines": [21]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/IGovernorCompatibilityBravo.sol", "line": 21, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "9c1a568f0b5c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 startBlock;", "highlightLines": [26]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/IGovernorCompatibilityBravo.sol", "line": 26, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "786678950ec0", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 endBlock;", "highlightLines": [27]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/IGovernorCompatibilityBravo.sol", "line": 27, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4369d7b2995e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 forVotes;", "highlightLines": [28]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/IGovernorCompatibilityBravo.sol", "line": 28, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4b7a2b02c287", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 againstVotes;", "highlightLines": [29]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/IGovernorCompatibilityBravo.sol", "line": 29, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7ef91add2d00", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 abstainVotes;", "highlightLines": [30]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/IGovernorCompatibilityBravo.sol", "line": 30, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "9cfc03e33787", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool canceled;", "highlightLines": [31]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/IGovernorCompatibilityBravo.sol", "line": 31, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4e91e95ed567", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool executed;", "highlightLines": [32]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/IGovernorCompatibilityBravo.sol", "line": 32, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "49b0322538bd", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool hasVoted;", "highlightLines": [40]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/IGovernorCompatibilityBravo.sol", "line": 40, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a057552be297", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint8 support;", "highlightLines": [41]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/IGovernorCompatibilityBravo.sol", "line": 41, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c0caa9cc4b04", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint96 votes;", "highlightLines": [42]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/compatibility/IGovernorCompatibilityBravo.sol", "line": 42, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "2035ddd47967", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorCountingSimple.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "3c2e6e4d8875", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 againstVotes;", "highlightLines": [24]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorCountingSimple.sol", "line": 24, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4b068094d196", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 forVotes;", "highlightLines": [25]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorCountingSimple.sol", "line": 25, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f0a7de18a923", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 abstainVotes;", "highlightLines": [26]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorCountingSimple.sol", "line": 26, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "286fb08de7a2", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function COUNTING_MODE() public pure virtual override returns (string memory) {\n        return \"support=bravo&quorum=for,abstain\";", "highlightLines": [36]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorCountingSimple.sol", "line": 36, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "b37e8ec6b048", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function proposalVotes(uint256 proposalId)\n        public\n        view\n        virtual\n        returns (\n            uint256 againstVotes,\n            uint256 forVotes,\n            uint256 abstainVotes\n        )\n    {\n        ProposalVote storage proposalvote = _proposalVotes[proposalId];", "highlightLines": [50]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorCountingSimple.sol", "line": 50, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "f7d60164b277", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function _quorumReached(uint256 proposalId) internal view virtual override returns (bool) {\n        ProposalVote storage proposalvote = _proposalVotes[proposalId];", "highlightLines": [67]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorCountingSimple.sol", "line": 67, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "9773de0df7d4", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function _voteSucceeded(uint256 proposalId) internal view virtual override returns (bool) {\n        ProposalVote storage proposalvote = _proposalVotes[proposalId];", "highlightLines": [76]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorCountingSimple.sol", "line": 76, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "f906771d1070", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function _countVote(\n        uint256 proposalId,\n        address account,\n        uint8 support,\n        uint256 weight,\n        bytes memory // params\n    ) internal virtual override {\n        ProposalVote storage proposalvote = _proposalVotes[proposalId];\n\n        require(!proposalvote.hasVoted[account], \"GovernorVotingSimple: vote already cast\");\n        proposalvote.hasVoted[account] = true;\n\n        if (support == uint8(VoteType.Against)) {", "highlightLines": [85]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorCountingSimple.sol", "line": 85, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "b65185aa1ebb", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        ProposalVote storage proposalvote = _proposalVotes[proposalId];\n\n        require(!proposalvote.hasVoted[account], \"GovernorVotingSimple: vote already cast\");\n        proposalvote.hasVoted[account] = true;", "highlightLines": [92]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorCountingSimple.sol", "line": 92, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "73f6a99093d7", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        if (support == uint8(VoteType.Against)) {", "highlightLines": [97]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorCountingSimple.sol", "line": 97, "column": 24}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "b1782645cfbc", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        } else if (support == uint8(VoteType.For)) {", "highlightLines": [99]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorCountingSimple.sol", "line": 99, "column": 31}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "6b203410a628", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        } else if (support == uint8(VoteType.Abstain)) {", "highlightLines": [101]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorCountingSimple.sol", "line": 101, "column": 31}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "0d840244eb73", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorPreventLateQuorum.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "e94c10f64b8e", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "abstract contract GovernorPreventLateQuorum is Governor {\n    using SafeCast for uint256;\n    using Timers for Timers.BlockNumber;\n\n    uint64 private _voteExtension;", "highlightLines": [20]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorPreventLateQuorum.sol", "line": 20, "column": 10}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "9e44ab711508", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event LateQuorumVoteExtensionSet(uint64 oldVoteExtension, uint64 newVoteExtension);", "highlightLines": [31]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorPreventLateQuorum.sol", "line": 31, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "9f515ec4fab1", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(uint64 initialVoteExtension) {\n        _setLateQuorumVoteExtension(initialVoteExtension);\n    }", "highlightLines": [38]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorPreventLateQuorum.sol", "line": 38, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "22f2146e057d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 result = super._castVote(proposalId, account, support, reason, params);", "highlightLines": [63]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorPreventLateQuorum.sol", "line": 63, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "bcdedf2353a8", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 result = super._castVote(proposalId, account, support, reason, params);\n\n        Timers.BlockNumber storage extendedDeadline = _extendedDeadlines[proposalId];", "highlightLines": [63]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorPreventLateQuorum.sol", "line": 63, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "738eb6597bc7", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        Timers.BlockNumber storage extendedDeadline = _extendedDeadlines[proposalId];\n\n        if (extendedDeadline.isUnset() && _quorumReached(proposalId)) {\n            uint64 extendedDeadlineValue = block.number.toUint64() + lateQuorumVoteExtension();\n\n            if (extendedDeadlineValue > proposalDeadline(proposalId)) {\n                emit ProposalExtended(proposalId, extendedDeadlineValue);\n            }\n\n            extendedDeadline.setDeadline(extendedDeadlineValue);\n        }", "highlightLines": [65]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorPreventLateQuorum.sol", "line": 65, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "2193b8b5ca23", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint64 extendedDeadlineValue = block.number.toUint64() + lateQuorumVoteExtension();", "highlightLines": [68]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorPreventLateQuorum.sol", "line": 68, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "6bbf59e69e40", "fix": {"template": null, "available": false}, "title": "Governance can execute arbitrary calls - verify this is intentional and secured", "ruleId": "rules.sol-ethernaut-governance-arbitrary-call", "snippet": {"code": "    function setLateQuorumVoteExtension(uint64 newVoteExtension) public virtual onlyGovernance {", "highlightLines": [94]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorPreventLateQuorum.sol", "line": 94, "column": 81}, "severity": "medium", "references": [], "description": ""}, {"id": "20a0a3bce3d4", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorProposalThreshold.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "d29a3a825e69", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorSettings.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "25558989cf18", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "abstract contract GovernorSettings is Governor {\n    uint256 private _votingDelay;\n    uint256 private _votingPeriod;\n    uint256 private _proposalThreshold;", "highlightLines": [13]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorSettings.sol", "line": 13, "column": 10}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "e2ad376ffbee", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event VotingDelaySet(uint256 oldVotingDelay, uint256 newVotingDelay);", "highlightLines": [18]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorSettings.sol", "line": 18, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "26c17b79e73a", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event VotingPeriodSet(uint256 oldVotingPeriod, uint256 newVotingPeriod);", "highlightLines": [19]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorSettings.sol", "line": 19, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "ddff235835a1", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event ProposalThresholdSet(uint256 oldProposalThreshold, uint256 newProposalThreshold);", "highlightLines": [20]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorSettings.sol", "line": 20, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "e87e5f019759", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(\n        uint256 initialVotingDelay,\n        uint256 initialVotingPeriod,\n        uint256 initialProposalThreshold\n    ) {\n        _setVotingDelay(initialVotingDelay);\n        _setVotingPeriod(initialVotingPeriod);\n        _setProposalThreshold(initialProposalThreshold);\n    }", "highlightLines": [25]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorSettings.sol", "line": 25, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "54daca1e9ee4", "fix": {"template": null, "available": false}, "title": "Governance can execute arbitrary calls - verify this is intentional and secured", "ruleId": "rules.sol-ethernaut-governance-arbitrary-call", "snippet": {"code": "    function setVotingDelay(uint256 newVotingDelay) public virtual onlyGovernance {", "highlightLines": [61]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorSettings.sol", "line": 61, "column": 68}, "severity": "medium", "references": [], "description": ""}, {"id": "6e37d26d0709", "fix": {"template": null, "available": false}, "title": "Governance can execute arbitrary calls - verify this is intentional and secured", "ruleId": "rules.sol-ethernaut-governance-arbitrary-call", "snippet": {"code": "    function setVotingPeriod(uint256 newVotingPeriod) public virtual onlyGovernance {", "highlightLines": [70]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorSettings.sol", "line": 70, "column": 70}, "severity": "medium", "references": [], "description": ""}, {"id": "817b5a1f7a6a", "fix": {"template": null, "available": false}, "title": "Governance can execute arbitrary calls - verify this is intentional and secured", "ruleId": "rules.sol-ethernaut-governance-arbitrary-call", "snippet": {"code": "    function setProposalThreshold(uint256 newProposalThreshold) public virtual onlyGovernance {", "highlightLines": [79]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorSettings.sol", "line": 79, "column": 80}, "severity": "medium", "references": [], "description": ""}, {"id": "846b3ce18c06", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockCompound.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "b7b42a4f5e70", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "abstract contract GovernorTimelockCompound is IGovernorTimelock, Governor {", "highlightLines": [23]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockCompound.sol", "line": 23, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "bfd521b48eb6", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event TimelockChange(address oldTimelock, address newTimelock);", "highlightLines": [38]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockCompound.sol", "line": 38, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "965ea24b1e51", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event TimelockChange(address oldTimelock, address newTimelock);", "highlightLines": [38]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockCompound.sol", "line": 38, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "89a09d945909", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(ICompoundTimelock timelockAddress) {\n        _updateTimelock(timelockAddress);\n    }", "highlightLines": [43]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockCompound.sol", "line": 43, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "4f369aef7def", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function supportsInterface(bytes4 interfaceId) public view virtual override(IERC165, Governor) returns (bool) {\n        return interfaceId == type(IGovernorTimelock).interfaceId || super.supportsInterface(interfaceId);", "highlightLines": [50]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockCompound.sol", "line": 50, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "e8edb43cbc6e", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function state(uint256 proposalId) public view virtual override(IGovernor, Governor) returns (ProposalState) {\n        ProposalState status = super.state(proposalId);", "highlightLines": [57]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockCompound.sol", "line": 57, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "b68e235b1cc6", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        ProposalState status = super.state(proposalId);\n\n        if (status != ProposalState.Succeeded) {\n            return status;\n        }\n\n        uint256 eta = proposalEta(proposalId);", "highlightLines": [58]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockCompound.sol", "line": 58, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d2f82ddf343d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 eta = proposalEta(proposalId);", "highlightLines": [63]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockCompound.sol", "line": 63, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "27e8a55a91cf", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        } else if (block.timestamp >= eta + _timelock.GRACE_PERIOD()) {", "highlightLines": [67]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockCompound.sol", "line": 67, "column": 20}, "severity": "medium", "references": [], "description": ""}, {"id": "e467621a66c1", "fix": {"template": null, "available": false}, "title": "Block timestamp used for critical logic - miners can manipulate within ~15 second window", "ruleId": "rules.sol-block-timestamp-manipulation", "snippet": {"code": "        } else if (block.timestamp >= eta + _timelock.GRACE_PERIOD()) {", "highlightLines": [67]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockCompound.sol", "line": 67, "column": 20}, "severity": "medium", "references": ["https://consensys.github.io/smart-contract-best-practices/development-recommendations/solidity-specific/timestamp-dependence/"], "description": ""}, {"id": "7e7f49b37fc3", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 proposalId = hashProposal(targets, values, calldatas, descriptionHash);", "highlightLines": [97]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockCompound.sol", "line": 97, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "624f6d3362e9", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 proposalId = hashProposal(targets, values, calldatas, descriptionHash);\n\n        require(state(proposalId) == ProposalState.Succeeded, \"Governor: proposal not successful\");\n\n        uint256 eta = block.timestamp + _timelock.delay();", "highlightLines": [97]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockCompound.sol", "line": 97, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "f66ee4e55f70", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 eta = block.timestamp + _timelock.delay();", "highlightLines": [100]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockCompound.sol", "line": 100, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "57c4547b36a1", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        uint256 eta = block.timestamp + _timelock.delay();", "highlightLines": [101]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockCompound.sol", "line": 101, "column": 23}, "severity": "medium", "references": [], "description": ""}, {"id": "c7d2e394ed24", "fix": {"template": null, "available": false}, "title": "Unbounded loop iterating over dynamic array - can cause out-of-gas DoS", "ruleId": "rules.sol-unbounded-loop-dos", "snippet": {"code": "        for (uint256 i = 0; i < targets.length; ++i) {\n            require(\n                !_timelock.queuedTransactions(keccak256(abi.encode(targets[i], values[i], \"\", calldatas[i], eta))),\n                \"GovernorTimelockCompound: identical proposal action already queued\"\n            );\n            _timelock.queueTransaction(targets[i], values[i], \"\", calldatas[i], eta);", "highlightLines": [103]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockCompound.sol", "line": 103, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "057ee687a54f", "fix": {"template": null, "available": false}, "title": "Unbounded loop over dynamic array - can cause DoS if array grows large", "ruleId": "rules.sol-unbounded-protocol-loop", "snippet": {"code": "        for (uint256 i = 0; i < targets.length; ++i) {\n            require(\n                !_timelock.queuedTransactions(keccak256(abi.encode(targets[i], values[i], \"\", calldatas[i], eta))),\n                \"GovernorTimelockCompound: identical proposal action already queued\"\n            );\n            _timelock.queueTransaction(targets[i], values[i], \"\", calldatas[i], eta);", "highlightLines": [103]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockCompound.sol", "line": 103, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "7097ddf2f923", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "                !_timelock.queuedTransactions(keccak256(abi.encode(targets[i], values[i], \"\", calldatas[i], eta))),", "highlightLines": [105]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockCompound.sol", "line": 105, "column": 47}, "severity": "high", "references": [], "description": ""}, {"id": "fcf9f73e4d63", "fix": {"template": null, "available": false}, "title": "Storage array passed by value to internal function - changes won't persist", "ruleId": "rules.sol-array-by-reference", "snippet": {"code": "    function _execute(\n        uint256 proposalId,\n        address[] memory targets,\n        uint256[] memory values,\n        bytes[] memory calldatas,\n        bytes32 /*descriptionHash*/\n    ) internal virtual override {", "highlightLines": [119]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockCompound.sol", "line": 119, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#modifying-storage-array-by-value"], "description": ""}, {"id": "3e3c5899b3d0", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 eta = proposalEta(proposalId);", "highlightLines": [126]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockCompound.sol", "line": 126, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4ac4330ae364", "fix": {"template": null, "available": false}, "title": "Unbounded loop iterating over dynamic array - can cause out-of-gas DoS", "ruleId": "rules.sol-unbounded-loop-dos", "snippet": {"code": "        for (uint256 i = 0; i < targets.length; ++i) {\n            _timelock.executeTransaction(targets[i], values[i], \"\", calldatas[i], eta);", "highlightLines": [129]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockCompound.sol", "line": 129, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "95a1545f4f8a", "fix": {"template": null, "available": false}, "title": "Unbounded loop over dynamic array - can cause DoS if array grows large", "ruleId": "rules.sol-unbounded-protocol-loop", "snippet": {"code": "        for (uint256 i = 0; i < targets.length; ++i) {\n            _timelock.executeTransaction(targets[i], values[i], \"\", calldatas[i], eta);", "highlightLines": [129]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockCompound.sol", "line": 129, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "786752b9d565", "fix": {"template": null, "available": false}, "title": "Storage array passed by value to internal function - changes won't persist", "ruleId": "rules.sol-array-by-reference", "snippet": {"code": "    function _cancel(\n        address[] memory targets,\n        uint256[] memory values,\n        bytes[] memory calldatas,\n        bytes32 descriptionHash\n    ) internal virtual override returns (uint256) {", "highlightLines": [138]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockCompound.sol", "line": 138, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#modifying-storage-array-by-value"], "description": ""}, {"id": "73e62c879d93", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 proposalId = super._cancel(targets, values, calldatas, descriptionHash);", "highlightLines": [144]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockCompound.sol", "line": 144, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3be29e9cc339", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 proposalId = super._cancel(targets, values, calldatas, descriptionHash);\n\n        uint256 eta = proposalEta(proposalId);", "highlightLines": [144]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockCompound.sol", "line": 144, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "58511392e461", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 eta = proposalEta(proposalId);", "highlightLines": [145]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockCompound.sol", "line": 145, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "fea9b46447ab", "fix": {"template": null, "available": false}, "title": "Unbounded loop iterating over dynamic array - can cause out-of-gas DoS", "ruleId": "rules.sol-unbounded-loop-dos", "snippet": {"code": "            for (uint256 i = 0; i < targets.length; ++i) {\n                _timelock.cancelTransaction(targets[i], values[i], \"\", calldatas[i], eta);", "highlightLines": [148]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockCompound.sol", "line": 148, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "a724d5d185fd", "fix": {"template": null, "available": false}, "title": "Unbounded loop over dynamic array - can cause DoS if array grows large", "ruleId": "rules.sol-unbounded-protocol-loop", "snippet": {"code": "            for (uint256 i = 0; i < targets.length; ++i) {\n                _timelock.cancelTransaction(targets[i], values[i], \"\", calldatas[i], eta);", "highlightLines": [148]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockCompound.sol", "line": 148, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "d073363e3490", "fix": {"template": null, "available": false}, "title": "Governance can execute arbitrary calls - verify this is intentional and secured", "ruleId": "rules.sol-ethernaut-governance-arbitrary-call", "snippet": {"code": "    function updateTimelock(ICompoundTimelock newTimelock) external virtual onlyGovernance {", "highlightLines": [185]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockCompound.sol", "line": 185, "column": 77}, "severity": "medium", "references": [], "description": ""}, {"id": "eb6fd4876109", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockControl.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "c34ed3ed0ae4", "fix": {"template": null, "available": false}, "title": "Governance can execute arbitrary calls - verify this is intentional and secured", "ruleId": "rules.sol-ethernaut-governance-arbitrary-call", "snippet": {"code": " * grants them powers that they must be trusted or known not to use: 1) {onlyGovernance} functions like {relay} are", "highlightLines": [20]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockControl.sol", "line": 20, "column": 74}, "severity": "medium", "references": [], "description": ""}, {"id": "8467293fef67", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "abstract contract GovernorTimelockControl is IGovernorTimelock, Governor {", "highlightLines": [26]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockControl.sol", "line": 26, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "c37a520b5629", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event TimelockChange(address oldTimelock, address newTimelock);", "highlightLines": [33]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockControl.sol", "line": 33, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "b7b121069d2f", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event TimelockChange(address oldTimelock, address newTimelock);", "highlightLines": [33]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockControl.sol", "line": 33, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "63843402d331", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(TimelockController timelockAddress) {\n        _updateTimelock(timelockAddress);\n    }", "highlightLines": [38]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockControl.sol", "line": 38, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "c8bc41ee992b", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function supportsInterface(bytes4 interfaceId) public view virtual override(IERC165, Governor) returns (bool) {\n        return interfaceId == type(IGovernorTimelock).interfaceId || super.supportsInterface(interfaceId);", "highlightLines": [45]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockControl.sol", "line": 45, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "b6c152bc1fc6", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function state(uint256 proposalId) public view virtual override(IGovernor, Governor) returns (ProposalState) {\n        ProposalState status = super.state(proposalId);", "highlightLines": [52]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockControl.sol", "line": 52, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "6ff5115d3d19", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        ProposalState status = super.state(proposalId);\n\n        if (status != ProposalState.Succeeded) {\n            return status;\n        }\n\n        // core tracks execution, so we just have to check if successful proposal have been queued.\n        bytes32 queueid = _timelockIds[proposalId];", "highlightLines": [53]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockControl.sol", "line": 53, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "0a99370c16a0", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 queueid = _timelockIds[proposalId];", "highlightLines": [60]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockControl.sol", "line": 60, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "05fbe2c48aa5", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function proposalEta(uint256 proposalId) public view virtual override returns (uint256) {\n        uint256 eta = _timelock.getTimestamp(_timelockIds[proposalId]);", "highlightLines": [82]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockControl.sol", "line": 82, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "bb297cdc9cac", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 eta = _timelock.getTimestamp(_timelockIds[proposalId]);", "highlightLines": [83]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockControl.sol", "line": 83, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "08ef17314cff", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 proposalId = hashProposal(targets, values, calldatas, descriptionHash);", "highlightLines": [96]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockControl.sol", "line": 96, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d8e13ed0976d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 proposalId = hashProposal(targets, values, calldatas, descriptionHash);\n\n        require(state(proposalId) == ProposalState.Succeeded, \"Governor: proposal not successful\");\n\n        uint256 delay = _timelock.getMinDelay();", "highlightLines": [96]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockControl.sol", "line": 96, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "a0d9b164c8fe", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 delay = _timelock.getMinDelay();", "highlightLines": [99]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockControl.sol", "line": 99, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "48a49adfe380", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "        uint256 delay = _timelock.getMinDelay();\n        _timelockIds[proposalId] = _timelock.hashOperationBatch(targets, values, calldatas, 0, descriptionHash);", "highlightLines": [100]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockControl.sol", "line": 100, "column": 9}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "b9eb67a1d979", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 delay = _timelock.getMinDelay();\n        _timelockIds[proposalId] = _timelock.hashOperationBatch(targets, values, calldatas, 0, descriptionHash);", "highlightLines": [100]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockControl.sol", "line": 100, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "b040eac587da", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        emit ProposalQueued(proposalId, block.timestamp + delay);", "highlightLines": [104]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockControl.sol", "line": 104, "column": 41}, "severity": "medium", "references": [], "description": ""}, {"id": "3540f98ba792", "fix": {"template": null, "available": false}, "title": "Storage array passed by value to internal function - changes won't persist", "ruleId": "rules.sol-array-by-reference", "snippet": {"code": "    function _execute(\n        uint256, /* proposalId */\n        address[] memory targets,\n        uint256[] memory values,\n        bytes[] memory calldatas,\n        bytes32 descriptionHash\n    ) internal virtual override {", "highlightLines": [112]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockControl.sol", "line": 112, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#modifying-storage-array-by-value"], "description": ""}, {"id": "67568bc98add", "fix": {"template": null, "available": false}, "title": "Storage array passed by value to internal function - changes won't persist", "ruleId": "rules.sol-array-by-reference", "snippet": {"code": "    function _cancel(\n        address[] memory targets,\n        uint256[] memory values,\n        bytes[] memory calldatas,\n        bytes32 descriptionHash\n    ) internal virtual override returns (uint256) {", "highlightLines": [129]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockControl.sol", "line": 129, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#modifying-storage-array-by-value"], "description": ""}, {"id": "2be6319772dd", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 proposalId = super._cancel(targets, values, calldatas, descriptionHash);", "highlightLines": [135]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockControl.sol", "line": 135, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "cd31ca5f2633", "fix": {"template": null, "available": false}, "title": "Deleting mapping inside struct leaves nested data - use separate mapping deletion", "ruleId": "rules.sol-mapping-deletion", "snippet": {"code": "            delete _timelockIds[proposalId];", "highlightLines": [139]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockControl.sol", "line": 139, "column": 13}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#deletion-on-mapping-containing-a-structure"], "description": ""}, {"id": "958052ac9cfa", "fix": {"template": null, "available": false}, "title": "delete array[i] leaves gap with zero value - use swap-and-pop pattern instead", "ruleId": "rules.sol-array-element-delete", "snippet": {"code": "            delete _timelockIds[proposalId];", "highlightLines": [139]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockControl.sol", "line": 139, "column": 13}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/Array-deletion.sol"], "description": ""}, {"id": "96fae3c9f3ed", "fix": {"template": null, "available": false}, "title": "Governance can execute arbitrary calls - verify this is intentional and secured", "ruleId": "rules.sol-ethernaut-governance-arbitrary-call", "snippet": {"code": "    function updateTimelock(TimelockController newTimelock) external virtual onlyGovernance {", "highlightLines": [158]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorTimelockControl.sol", "line": 158, "column": 78}, "severity": "medium", "references": [], "description": ""}, {"id": "f44ddaa86bf8", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorVotes.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "9a4ce233a029", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(IVotes tokenAddress) {\n        token = tokenAddress;\n    }", "highlightLines": [17]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorVotes.sol", "line": 17, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "c9d5260f40c6", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorVotesComp.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "4afc5f42939d", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(ERC20VotesComp token_) {\n        token = token_;\n    }", "highlightLines": [17]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorVotesComp.sol", "line": 17, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "b4fd85a96bf0", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorVotesQuorumFraction.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "df73496f21a1", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "abstract contract GovernorVotesQuorumFraction is GovernorVotes {\n    uint256 private _quorumNumerator;", "highlightLines": [14]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorVotesQuorumFraction.sol", "line": 14, "column": 10}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "43914b0b5223", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event QuorumNumeratorUpdated(uint256 oldQuorumNumerator, uint256 newQuorumNumerator);", "highlightLines": [17]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorVotesQuorumFraction.sol", "line": 17, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "e937d4e6ebfc", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(uint256 quorumNumeratorValue) {\n        _updateQuorumNumerator(quorumNumeratorValue);\n    }", "highlightLines": [26]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorVotesQuorumFraction.sol", "line": 26, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "4b6412680dcc", "fix": {"template": null, "available": false}, "title": "Governance can execute arbitrary calls - verify this is intentional and secured", "ruleId": "rules.sol-ethernaut-governance-arbitrary-call", "snippet": {"code": "    function updateQuorumNumerator(uint256 newQuorumNumerator) external virtual onlyGovernance {", "highlightLines": [61]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorVotesQuorumFraction.sol", "line": 61, "column": 81}, "severity": "medium", "references": [], "description": ""}, {"id": "519041f8cfb9", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 oldQuorumNumerator = _quorumNumerator;", "highlightLines": [79]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorVotesQuorumFraction.sol", "line": 79, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ce90e9aa64c4", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 oldQuorumNumerator = _quorumNumerator;\n        _quorumNumerator = newQuorumNumerator;", "highlightLines": [80]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorVotesQuorumFraction.sol", "line": 80, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d8eabb45b23b", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/IGovernorTimelock.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "690c6e5fd1d1", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "abstract contract IGovernorTimelock is IGovernor {", "highlightLines": [13]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/IGovernorTimelock.sol", "line": 13, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "e87177820a22", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event ProposalQueued(uint256 proposalId, uint256 eta);", "highlightLines": [14]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/IGovernorTimelock.sol", "line": 14, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "ac36cbf7ba6b", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/utils/IVotes.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "6821570ac755", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event DelegateChanged(address indexed delegator, address indexed fromDelegate, address indexed toDelegate);", "highlightLines": [14]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/utils/IVotes.sol", "line": 14, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "aef807167a16", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event DelegateVotesChanged(address indexed delegate, uint256 previousBalance, uint256 newBalance);", "highlightLines": [19]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/utils/IVotes.sol", "line": 19, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "86863aafbeba", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function getVotes(address account) external view returns (uint256);", "highlightLines": [24]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/utils/IVotes.sol", "line": 24, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "43447eabacef", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function getPastVotes(address account, uint256 blockNumber) external view returns (uint256);", "highlightLines": [29]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/utils/IVotes.sol", "line": 29, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "f4114b804a24", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function delegates(address account) external view returns (address);", "highlightLines": [43]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/utils/IVotes.sol", "line": 43, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "8d88ff910fb4", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function delegate(address delegatee) external;", "highlightLines": [48]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/utils/IVotes.sol", "line": 48, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "24e591e9f235", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function delegateBySig(\n        address delegatee,\n        uint256 nonce,\n        uint256 expiry,\n        uint8 v,\n        bytes32 r,\n        bytes32 s\n    ) external;", "highlightLines": [53]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/utils/IVotes.sol", "line": 53, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "ce5346083162", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/utils/Votes.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "81f4dc9ff3c0", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": " * When using this module the derived contract must implement {_getVotingUnits} (for example, make it return\n * {ERC721-balanceOf}), and can use {_transferVotingUnits} to track a change in the distribution of those units (in the\n * previous example, it would be included in {ERC721-_beforeTokenTransfer}).\n *\n * _Available since v4.5._\n */\nabstract contract Votes is IVotes, Context, EIP712 {\n    using Checkpoints for Checkpoints.History;\n    using Counters for Counters.Counter;", "highlightLines": [25]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/utils/Votes.sol", "line": 25, "column": 103}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "0c039952eaaf", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "abstract contract Votes is IVotes, Context, EIP712 {", "highlightLines": [31]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/utils/Votes.sol", "line": 31, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "c9d21c7e2969", "fix": {"template": null, "available": false}, "title": "Base constructor called multiple times through diamond inheritance - may initialize twice", "ruleId": "rules.sol-reused-constructor", "snippet": {"code": "abstract contract Votes is IVotes, Context, EIP712 {", "highlightLines": [31]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/utils/Votes.sol", "line": 31, "column": 10}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#reused-base-constructor"], "description": ""}, {"id": "6ec33eb20c7b", "fix": {"template": null, "available": false}, "title": "SWC-125: Multiple inheritance may cause incorrect function resolution - check C3 linearization", "ruleId": "rules.sol-swc-125-inheritance-order", "snippet": {"code": "abstract contract Votes is IVotes, Context, EIP712 {", "highlightLines": [31]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/utils/Votes.sol", "line": 31, "column": 10}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-125"], "description": ""}, {"id": "471e36b15323", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address account = _msgSender();", "highlightLines": [96]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/utils/Votes.sol", "line": 96, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d9b2b22da622", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function delegateBySig(\n        address delegatee,\n        uint256 nonce,\n        uint256 expiry,\n        uint8 v,\n        bytes32 r,\n        bytes32 s\n    ) public virtual override {\n        require(block.timestamp <= expiry, \"Votes: signature expired\");\n        address signer = ECDSA.recover(\n            _hashTypedDataV4(keccak256(abi.encode(_DELEGATION_TYPEHASH, delegatee, nonce, expiry))),\n            v,\n            r,\n            s\n        );\n        require(nonce == _useNonce(signer), \"Votes: invalid nonce\");", "highlightLines": [103]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/utils/Votes.sol", "line": 103, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "959501d610c3", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        require(block.timestamp <= expiry, \"Votes: signature expired\");", "highlightLines": [111]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/utils/Votes.sol", "line": 111, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "19f1f7fb1d90", "fix": {"template": null, "available": false}, "title": "Block timestamp used for critical logic - miners can manipulate within ~15 second window", "ruleId": "rules.sol-block-timestamp-manipulation", "snippet": {"code": "        require(block.timestamp <= expiry, \"Votes: signature expired\");", "highlightLines": [111]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/utils/Votes.sol", "line": 111, "column": 17}, "severity": "medium", "references": ["https://consensys.github.io/smart-contract-best-practices/development-recommendations/solidity-specific/timestamp-dependence/"], "description": ""}, {"id": "700a2def3c54", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address signer = ECDSA.recover(", "highlightLines": [112]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/utils/Votes.sol", "line": 112, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ff2a20af5505", "fix": {"template": null, "available": false}, "title": "ecrecover result not checked for zero address - invalid signatures return address(0)", "ruleId": "rules.sol-ethernaut-ecrecover-no-zero-check", "snippet": {"code": "        address signer = ECDSA.recover(\n            _hashTypedDataV4(keccak256(abi.encode(_DELEGATION_TYPEHASH, delegatee, nonce, expiry))),\n            v,\n            r,\n            s\n        );", "highlightLines": [112]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/utils/Votes.sol", "line": 112, "column": 26}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-117", "https://swcregistry.io/docs/SWC-122"], "description": ""}, {"id": "e9263f71a9b1", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "            _hashTypedDataV4(keccak256(abi.encode(_DELEGATION_TYPEHASH, delegatee, nonce, expiry))),", "highlightLines": [113]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/utils/Votes.sol", "line": 113, "column": 30}, "severity": "high", "references": [], "description": ""}, {"id": "445a54c367d0", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address oldDelegate = delegates(account);", "highlightLines": [128]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/utils/Votes.sol", "line": 128, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "5811bbaf24f6", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address oldDelegate = delegates(account);\n        _delegation[account] = delegatee;", "highlightLines": [128]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/utils/Votes.sol", "line": 128, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "87654ad8d80e", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function _transferVotingUnits(\n        address from,\n        address to,\n        uint256 amount\n    ) internal virtual {\n        if (from == address(0)) {", "highlightLines": [139]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/utils/Votes.sol", "line": 139, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "3a49d13f868e", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "        if (from == address(0)) {\n            _totalCheckpoints.push(_add, amount);\n        }", "highlightLines": [144]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/utils/Votes.sol", "line": 144, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "f86884dd06d0", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "        if (to == address(0)) {\n            _totalCheckpoints.push(_subtract, amount);\n        }", "highlightLines": [147]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/utils/Votes.sol", "line": 147, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "f5aa409dd25c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        Counters.Counter storage nonce = _nonces[owner];\n        current = nonce.current();", "highlightLines": [187]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/utils/Votes.sol", "line": 187, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "ff1d6cc5ac86", "fix": {"template": null, "available": false}, "title": "Custom function named DOMAIN_SEPARATOR may collide with EIP-712 implementation", "ruleId": "rules.sol-domain-separator-collision", "snippet": {"code": "    function DOMAIN_SEPARATOR() external view returns (bytes32) {", "highlightLines": [203]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/utils/Votes.sol", "line": 203, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#domain-separator-collision"], "description": ""}, {"id": "5fab7d295392", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/IERC1155.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "df32944dd10e", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/IERC1155MetadataURI.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "39da355bdcc3", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/IERC1155Receiver.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "3ac096a1091d", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/IERC1271.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "2996bed80978", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/IERC1363.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "7acbec8d9d1c", "fix": {"template": null, "available": false}, "title": "approveAndCall pattern enables callback attacks - verify callback target", "ruleId": "rules.sol-approve-and-call-callback", "snippet": {"code": "     *   bytes4(keccak256('approveAndCall(address,uint256)')) ^", "highlightLines": [22]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/IERC1363.sol", "line": 22, "column": 28}, "severity": "medium", "references": [], "description": ""}, {"id": "8ea4318c0c14", "fix": {"template": null, "available": false}, "title": "approveAndCall pattern enables callback attacks - verify callback target", "ruleId": "rules.sol-approve-and-call-callback", "snippet": {"code": "     *   bytes4(keccak256('approveAndCall(address,uint256,bytes)'))", "highlightLines": [23]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/IERC1363.sol", "line": 23, "column": 28}, "severity": "medium", "references": [], "description": ""}, {"id": "5001faa98c75", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function transferAndCall(address to, uint256 value) external returns (bool);", "highlightLines": [32]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/IERC1363.sol", "line": 32, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "243ede0ef6f4", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function transferAndCall(\n        address to,\n        uint256 value,\n        bytes memory data\n    ) external returns (bool);", "highlightLines": [41]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/IERC1363.sol", "line": 41, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "a993ba67a7d2", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function transferFromAndCall(\n        address from,\n        address to,\n        uint256 value\n    ) external returns (bool);", "highlightLines": [54]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/IERC1363.sol", "line": 54, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "f187696d72fc", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function transferFromAndCall(\n        address from,\n        address to,\n        uint256 value,\n        bytes memory data\n    ) external returns (bool);", "highlightLines": [68]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/IERC1363.sol", "line": 68, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "4eeb8d9ae160", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function approveAndCall(address spender, uint256 value) external returns (bool);", "highlightLines": [81]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/IERC1363.sol", "line": 81, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "521d0fd045c2", "fix": {"template": null, "available": false}, "title": "approveAndCall pattern enables callback attacks - verify callback target", "ruleId": "rules.sol-approve-and-call-callback", "snippet": {"code": "    function approveAndCall(address spender, uint256 value) external returns (bool);", "highlightLines": [81]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/IERC1363.sol", "line": 81, "column": 14}, "severity": "medium", "references": [], "description": ""}, {"id": "aa3f35069cc3", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function approveAndCall(\n        address spender,\n        uint256 value,\n        bytes memory data\n    ) external returns (bool);", "highlightLines": [90]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/IERC1363.sol", "line": 90, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "bac66a9d98b9", "fix": {"template": null, "available": false}, "title": "approveAndCall pattern enables callback attacks - verify callback target", "ruleId": "rules.sol-approve-and-call-callback", "snippet": {"code": "    function approveAndCall(", "highlightLines": [90]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/IERC1363.sol", "line": 90, "column": 14}, "severity": "medium", "references": [], "description": ""}, {"id": "79d4f4d25912", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/IERC1363Receiver.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "f951b0e4a89b", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function onTransferReceived(\n        address operator,\n        address from,\n        uint256 value,\n        bytes memory data\n    ) external returns (bytes4);", "highlightLines": [26]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/IERC1363Receiver.sol", "line": 26, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "3a5177935e85", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/IERC1363Spender.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "0942eeeb75b7", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function onApprovalReceived(\n        address owner,\n        uint256 value,\n        bytes memory data\n    ) external returns (bytes4);", "highlightLines": [25]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/IERC1363Spender.sol", "line": 25, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "0d0b2577ed40", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/IERC165.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "14d245ab9dc0", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/IERC1820Implementer.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "39211833067f", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/IERC1820Registry.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "aca0c335a05d", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/IERC20.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "75335a5c0ecf", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/IERC20Metadata.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "c5637c9bc59e", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/IERC2981.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "8641669aec05", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/IERC3156.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "5a79ee0e82dc", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/IERC3156FlashBorrower.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "f1169632757c", "fix": {"template": null, "available": false}, "title": "Callback function without caller validation - external contracts can trigger unexpected behavior", "ruleId": "rules.sol-unprotected-callback", "snippet": {"code": "    function onFlashLoan(\n        address initiator,\n        address token,\n        uint256 amount,\n        uint256 fee,\n        bytes calldata data\n    ) external returns (bytes32);", "highlightLines": [22]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/IERC3156FlashBorrower.sol", "line": 22, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "7a4d71fecefd", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function onFlashLoan(\n        address initiator,\n        address token,\n        uint256 amount,\n        uint256 fee,\n        bytes calldata data\n    ) external returns (bytes32);", "highlightLines": [22]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/IERC3156FlashBorrower.sol", "line": 22, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "2631406d9249", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/IERC3156FlashLender.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "2f66b3b6427c", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function maxFlashLoan(address token) external view returns (uint256);", "highlightLines": [20]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/IERC3156FlashLender.sol", "line": 20, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "1c86fd27aa36", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function flashFee(address token, uint256 amount) external view returns (uint256);", "highlightLines": [28]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/IERC3156FlashLender.sol", "line": 28, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "81ad6de3be31", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/IERC4626.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "495bd8561104", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "interface IERC4626 is IERC20, IERC20Metadata {", "highlightLines": [15]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/IERC4626.sol", "line": 15, "column": 23}, "severity": "info", "references": [], "description": ""}, {"id": "9e12e141bc1b", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Deposit(address indexed caller, address indexed owner, uint256 assets, uint256 shares);", "highlightLines": [16]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/IERC4626.sol", "line": 16, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "ec5a4540f5a3", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event Withdraw(\n        address indexed caller,\n        address indexed receiver,\n        address indexed owner,\n        uint256 assets,\n        uint256 shares\n    );", "highlightLines": [18]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/IERC4626.sol", "line": 18, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "3574ad8c6549", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Withdraw(\n        address indexed caller,\n        address indexed receiver,\n        address indexed owner,\n        uint256 assets,\n        uint256 shares\n    );", "highlightLines": [18]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/IERC4626.sol", "line": 18, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "98ff561583ad", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function maxDeposit(address receiver) external view returns (uint256 maxAssets);", "highlightLines": [81]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/IERC4626.sol", "line": 81, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "bdde5d3678d8", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function maxMint(address receiver) external view returns (uint256 maxShares);", "highlightLines": [119]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/IERC4626.sol", "line": 119, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "0359eae53e3d", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function mint(uint256 shares, address receiver) external returns (uint256 assets);", "highlightLines": [149]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/IERC4626.sol", "line": 149, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "94948c435e7b", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function maxWithdraw(address owner) external view returns (uint256 maxAssets);", "highlightLines": [158]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/IERC4626.sol", "line": 158, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "debb89bd4bfd", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function maxRedeem(address owner) external view returns (uint256 maxShares);", "highlightLines": [204]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/IERC4626.sol", "line": 204, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "57d71bf8a89b", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/IERC721.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "473543b28b0b", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/IERC721Enumerable.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "7bf278ee2348", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/IERC721Metadata.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "c5ab864a88eb", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/IERC721Receiver.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "11f9ece7ae74", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/IERC777.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "791101f47cbf", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/IERC777Recipient.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "7cb75ee42d09", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/IERC777Sender.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "c21e7d0e62ab", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/draft-IERC1822.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "54183fecfb91", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "     * @dev Returns the storage slot that the proxiable contract assumes is being used to store the implementation\n     * address.\n     *\n     * IMPORTANT: A proxy pointing at a proxiable contract should not be considered proxiable itself, because this risks", "highlightLines": [12]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/draft-IERC1822.sol", "line": 12, "column": 57}, "severity": "medium", "references": [], "description": ""}, {"id": "6d92bb10d65e", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/interfaces/draft-IERC2612.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "205f3f7f8087", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.9;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/metatx/ERC2771Context.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "91e057721a69", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(address trustedForwarder) {\n        _trustedForwarder = trustedForwarder;\n    }", "highlightLines": [16]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/metatx/ERC2771Context.sol", "line": 16, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "6e273b5c2f70", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function isTrustedForwarder(address forwarder) public view virtual returns (bool) {\n        return forwarder == _trustedForwarder;", "highlightLines": [20]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/metatx/ERC2771Context.sol", "line": 20, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "9e9af3866ffe", "fix": {"template": null, "available": false}, "title": "View/pure function uses assembly - may modify state unexpectedly", "ruleId": "rules.sol-constant-function-assembly", "snippet": {"code": "    function _msgSender() internal view virtual override returns (address sender) {\n        if (isTrustedForwarder(msg.sender)) {\n            // The assembly code is more direct than the Solidity version using `abi.decode`.\n            /// @solidity memory-safe-assembly\n            assembly {", "highlightLines": [24]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/metatx/ERC2771Context.sol", "line": 24, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-using-assembly-code"], "description": ""}, {"id": "34b6ae6da187", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "            assembly {", "highlightLines": [28]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/metatx/ERC2771Context.sol", "line": 28, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "b28cb66ffff0", "fix": {"template": null, "available": false}, "title": "Assembly block uses calldataload - ensure proper type handling for smaller parameter types", "ruleId": "rules.sol-ethernaut-assembly-calldataload", "snippet": {"code": "            assembly {\n                sender := shr(96, calldataload(sub(calldatasize(), 20)))", "highlightLines": [28]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/metatx/ERC2771Context.sol", "line": 28, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "407d7f0ad7bb", "fix": {"template": null, "available": false}, "title": "Assembly extracts token/address from calldata without bounds validation - calldata injection possible", "ruleId": "rules.sol-assembly-token-from-calldata", "snippet": {"code": "            assembly {\n                sender := shr(96, calldataload(sub(calldatasize(), 20)))\n            }", "highlightLines": [28]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/metatx/ERC2771Context.sol", "line": 28, "column": 13}, "severity": "high", "references": ["https://code4rena.com/reports/2021-07-sherlock"], "description": ""}, {"id": "4b52113fc8dc", "fix": {"template": null, "available": false}, "title": "Assembly calldataload without calldatasize check - calldata injection possible", "ruleId": "rules.sol-calldataload-no-length-check", "snippet": {"code": "            assembly {\n                sender := shr(96, calldataload(sub(calldatasize(), 20)))\n            }", "highlightLines": [28]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/metatx/ERC2771Context.sol", "line": 28, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "8d5d790fa531", "fix": {"template": null, "available": false}, "title": "Incorrect shift in assembly - parameters may be reversed (value, shift vs shift, value)", "ruleId": "rules.sol-incorrect-shift-assembly", "snippet": {"code": "            assembly {\n                sender := shr(96, calldataload(sub(calldatasize(), 20)))\n            }", "highlightLines": [28]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/metatx/ERC2771Context.sol", "line": 28, "column": 13}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-shift-in-assembly"], "description": ""}, {"id": "63bc76efbda2", "fix": {"template": null, "available": false}, "title": "calldataload reads 32 bytes - if function has smaller parameter types (uint8/uint16), this can cause type confusion", "ruleId": "rules.sol-ethernaut-calldataload-type-confusion", "snippet": {"code": "                sender := shr(96, calldataload(sub(calldatasize(), 20)))", "highlightLines": [29]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/metatx/ERC2771Context.sol", "line": 29, "column": 35}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/"], "description": ""}, {"id": "d48edb84875d", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/metatx/MinimalForwarder.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "fe81ba9a4a36", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "contract MinimalForwarder is EIP712 {", "highlightLines": [17]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/metatx/MinimalForwarder.sol", "line": 17, "column": 1}, "severity": "medium", "references": [], "description": ""}, {"id": "b20c581f04d3", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract MinimalForwarder is EIP712 {\n    using ECDSA for bytes32;\n\n    struct ForwardRequest {\n        address from;\n        address to;\n        uint256 value;\n        uint256 gas;\n        uint256 nonce;\n        bytes data;", "highlightLines": [17]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/metatx/MinimalForwarder.sol", "line": 17, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "5f2a59c50f62", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address from;", "highlightLines": [21]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/metatx/MinimalForwarder.sol", "line": 21, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "48ade74fc3b7", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address to;", "highlightLines": [22]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/metatx/MinimalForwarder.sol", "line": 22, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "700fec698788", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 value;", "highlightLines": [23]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/metatx/MinimalForwarder.sol", "line": 23, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "11c48ead0e28", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 gas;", "highlightLines": [24]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/metatx/MinimalForwarder.sol", "line": 24, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "dbc7f08d1d32", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 nonce;", "highlightLines": [25]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/metatx/MinimalForwarder.sol", "line": 25, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "914351c5c4fd", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes data;", "highlightLines": [26]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/metatx/MinimalForwarder.sol", "line": 26, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8aceac0bd127", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor() EIP712(\"MinimalForwarder\", \"0.0.1\") {}", "highlightLines": [34]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/metatx/MinimalForwarder.sol", "line": 34, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "4a2a7d429b2d", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function verify(ForwardRequest calldata req, bytes calldata signature) public view returns (bool) {\n        address signer = _hashTypedDataV4(", "highlightLines": [40]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/metatx/MinimalForwarder.sol", "line": 40, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "76e43e03b80c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address signer = _hashTypedDataV4(", "highlightLines": [41]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/metatx/MinimalForwarder.sol", "line": 41, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "39b886587202", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "            keccak256(abi.encode(_TYPEHASH, req.from, req.to, req.value, req.gas, req.nonce, keccak256(req.data)))", "highlightLines": [42]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/metatx/MinimalForwarder.sol", "line": 42, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "124f68cfb554", "fix": {"template": null, "available": false}, "title": "Signature verification without EIP-712 domain separator - vulnerable to cross-chain/cross-contract replay", "ruleId": "rules.sol-ethernaut-missing-eip712-domain", "snippet": {"code": "            keccak256(abi.encode(_TYPEHASH, req.from, req.to, req.value, req.gas, req.nonce, keccak256(req.data)))", "highlightLines": [42]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/metatx/MinimalForwarder.sol", "line": 42, "column": 13}, "severity": "high", "references": ["https://eips.ethereum.org/EIPS/eip-712", "https://ethernaut.openzeppelin.com/"], "description": ""}, {"id": "44d58589fa96", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "    function execute(ForwardRequest calldata req, bytes calldata signature)\n        public\n        payable\n        returns (bool, bytes memory)\n    {\n        require(verify(req, signature), \"MinimalForwarder: signature does not match request\");", "highlightLines": [47]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/metatx/MinimalForwarder.sol", "line": 47, "column": 5}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "42a10fbd194e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        _nonces[req.from] = req.nonce + 1;\n\n        (bool success, bytes memory returndata) = req.to.call{gas: req.gas, value: req.value}(\n            abi.encodePacked(req.data, req.from)\n        );", "highlightLines": [53]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/metatx/MinimalForwarder.sol", "line": 53, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "f8394819b3f8", "fix": {"template": null, "available": false}, "title": "Call success variable declared but never checked - funds may be lost", "ruleId": "rules.sol-call-success-not-required", "snippet": {"code": "        (bool success, bytes memory returndata) = req.to.call{gas: req.gas, value: req.value}(\n            abi.encodePacked(req.data, req.from)\n        );", "highlightLines": [55]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/metatx/MinimalForwarder.sol", "line": 55, "column": 9}, "severity": "high", "references": [], "description": ""}, {"id": "46641126795a", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "            abi.encodePacked(req.data, req.from)", "highlightLines": [56]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/metatx/MinimalForwarder.sol", "line": 56, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "973ddc568306", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "            assembly {", "highlightLines": [66]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/metatx/MinimalForwarder.sol", "line": 66, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "fd902e060f2f", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.4;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/AccessControlCrossChainMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "e4eb19fea030", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "contract AccessControlCrossChainMock is AccessControlCrossChain, CrossChainEnabledArbitrumL2 {", "highlightLines": [8]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/AccessControlCrossChainMock.sol", "line": 8, "column": 54}, "severity": "info", "references": [], "description": ""}, {"id": "0386afe01706", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor() {\n        _setupRole(DEFAULT_ADMIN_ROLE, _msgSender());\n    }", "highlightLines": [9]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/AccessControlCrossChainMock.sol", "line": 9, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "69117fb6bff4", "fix": {"template": null, "available": false}, "title": "Storage write without access control - arbitrary data manipulation", "ruleId": "rules.sol-unprotected-storage-write", "snippet": {"code": "    function setRoleAdmin(bytes32 roleId, bytes32 adminRoleId) public {", "highlightLines": [13]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/AccessControlCrossChainMock.sol", "line": 13, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "1ebf301dd455", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/AccessControlEnumerableMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "626531866076", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor() {\n        _setupRole(DEFAULT_ADMIN_ROLE, _msgSender());\n    }", "highlightLines": [8]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/AccessControlEnumerableMock.sol", "line": 8, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "a9915816f5cd", "fix": {"template": null, "available": false}, "title": "Storage write without access control - arbitrary data manipulation", "ruleId": "rules.sol-unprotected-storage-write", "snippet": {"code": "    function setRoleAdmin(bytes32 roleId, bytes32 adminRoleId) public {", "highlightLines": [12]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/AccessControlEnumerableMock.sol", "line": 12, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "a16cddb2155d", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/AccessControlMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "6339cb563be1", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor() {\n        _setupRole(DEFAULT_ADMIN_ROLE, _msgSender());\n    }", "highlightLines": [8]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/AccessControlMock.sol", "line": 8, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "6ccb291e238b", "fix": {"template": null, "available": false}, "title": "Storage write without access control - arbitrary data manipulation", "ruleId": "rules.sol-unprotected-storage-write", "snippet": {"code": "    function setRoleAdmin(bytes32 roleId, bytes32 adminRoleId) public {", "highlightLines": [12]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/AccessControlMock.sol", "line": 12, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "380eae1a5dcc", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/AddressImpl.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "9299b2c06a53", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event CallReturnValue(string data);", "highlightLines": [10]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/AddressImpl.sol", "line": 10, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "0ade3207157f", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    receive() external payable {}", "highlightLines": [45]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/AddressImpl.sol", "line": 45, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "49c9d06904c9", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "    receive() external payable {}", "highlightLines": [45]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/AddressImpl.sol", "line": 45, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "bc95b7877f65", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ArraysImpl.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "319f66132b70", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(uint256[] memory array) {\n        _array = array;\n    }", "highlightLines": [12]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ArraysImpl.sol", "line": 12, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "5ed2325b12ac", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/BadBeacon.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "ca5e3d45fd33", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/Base64Mock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "58f68af4164b", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/BitmapMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "023b56f03206", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/CallReceiverMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "38f55363fc44", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event MockFunctionCalledWithArgs(uint256 a, uint256 b);", "highlightLines": [9]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/CallReceiverMock.sol", "line": 9, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "a7ba461dfc02", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/CheckpointsImpl.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "9e32ebeef8cb", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ClashingImplementation.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "54e19110fafd", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ClonesMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "d95af4542561", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event NewInstance(address instance);", "highlightLines": [12]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ClonesMock.sol", "line": 12, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "cfcdf99851b3", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event NewInstance(address instance);", "highlightLines": [12]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ClonesMock.sol", "line": 12, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "b5b787be2af2", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ConditionalEscrowMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "e621eaea9be9", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ContextMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "45041d5df800", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event Sender(address sender);", "highlightLines": [8]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ContextMock.sol", "line": 8, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "cdf42d692a8e", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Sender(address sender);", "highlightLines": [8]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ContextMock.sol", "line": 8, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "f3c83c2741da", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event Data(bytes data, uint256 integerValue, string stringValue);", "highlightLines": [14]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ContextMock.sol", "line": 14, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "61fdc8946cab", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/CountersImpl.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "29dbd5360197", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/Create2Impl.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "28060aba7b63", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    receive() external payable {}", "highlightLines": [33]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/Create2Impl.sol", "line": 33, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "8b8fa2d596ae", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "    receive() external payable {}", "highlightLines": [33]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/Create2Impl.sol", "line": 33, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "87c24b16b4ea", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/DoubleEndedQueueMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "e87dd07fd3bd", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event OperationResult(bytes32 value);", "highlightLines": [11]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/DoubleEndedQueueMock.sol", "line": 11, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "8c0db4820e88", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 value = _vector.popFront();", "highlightLines": [24]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/DoubleEndedQueueMock.sol", "line": 24, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4cc1885e490a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 value = _vector.popBack();", "highlightLines": [30]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/DoubleEndedQueueMock.sol", "line": 30, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0706d3f13994", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/DummyImplementation.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "63f017e2686b", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function version() public pure virtual returns (string memory);\n}\n\ncontract DummyImplementation {\n    uint256 public value;\n    string public text;\n    uint256[] public values;\n\n    function initializeNonPayable() public {\n        value = 10;", "highlightLines": [6]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/DummyImplementation.sol", "line": 6, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "6cb52bbb56f3", "fix": {"template": null, "available": false}, "title": "Initializer function not protected - can be called multiple times", "ruleId": "rules.sol-initializer-not-protected", "snippet": {"code": "    function initializeNonPayable() public {", "highlightLines": [14]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/DummyImplementation.sol", "line": 14, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "eae18bf36c45", "fix": {"template": null, "available": false}, "title": "Initializer function not protected - can be called multiple times", "ruleId": "rules.sol-initializer-not-protected", "snippet": {"code": "    function initializePayable() public payable {", "highlightLines": [18]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/DummyImplementation.sol", "line": 18, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "f9628bd78c42", "fix": {"template": null, "available": false}, "title": "Initializer function not protected - can be called multiple times", "ruleId": "rules.sol-initializer-not-protected", "snippet": {"code": "    function initializeNonPayableWithValue(uint256 _value) public {", "highlightLines": [22]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/DummyImplementation.sol", "line": 22, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "6477b8971de8", "fix": {"template": null, "available": false}, "title": "Initializer function not protected - can be called multiple times", "ruleId": "rules.sol-initializer-not-protected", "snippet": {"code": "    function initializePayableWithValue(uint256 _value) public payable {", "highlightLines": [26]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/DummyImplementation.sol", "line": 26, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "ff172f284084", "fix": {"template": null, "available": false}, "title": "Initialization function can be front-run - use initializer modifier or constructor", "ruleId": "rules.sol-initialization-frontrun", "snippet": {"code": "    function initialize(\n        uint256 _value,\n        string memory _text,\n        uint256[] memory _values\n    ) public {", "highlightLines": [30]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/DummyImplementation.sol", "line": 30, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "eeb6cbc49253", "fix": {"template": null, "available": false}, "title": "Clone/minimal proxy initializer without protection - can be front-run and hijacked", "ruleId": "rules.sol-unprotected-clone-initializer", "snippet": {"code": "    function initialize(\n        uint256 _value,\n        string memory _text,\n        uint256[] memory _values\n    ) public {", "highlightLines": [30]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/DummyImplementation.sol", "line": 30, "column": 5}, "severity": "high", "references": ["https://blog.openzeppelin.com/security-advisory-initialize-uups-implementation-contracts"], "description": ""}, {"id": "85c0c3c828f8", "fix": {"template": null, "available": false}, "title": "Initializer function not protected - can be called multiple times", "ruleId": "rules.sol-initializer-not-protected", "snippet": {"code": "    function initialize(\n        uint256 _value,\n        string memory _text,\n        uint256[] memory _values\n    ) public {", "highlightLines": [30]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/DummyImplementation.sol", "line": 30, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "82ebef4e21fd", "fix": {"template": null, "available": false}, "title": "initialize() without initializer modifier - can be called multiple times", "ruleId": "rules.sol-initialize-not-protected", "snippet": {"code": "    function initialize(\n        uint256 _value,\n        string memory _text,\n        uint256[] memory _values\n    ) public {\n        value = _value;\n        text = _text;\n        values = _values;\n    }", "highlightLines": [30]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/DummyImplementation.sol", "line": 30, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "6263230d3016", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        value = _value;\n        text = _text;", "highlightLines": [35]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/DummyImplementation.sol", "line": 35, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "73fca3123d9e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        text = _text;\n        values = _values;", "highlightLines": [36]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/DummyImplementation.sol", "line": 36, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "761ac79b62a2", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ECDSAMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "a7e7d60cdc4e", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/EIP712External.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "f581454b5cac", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "contract EIP712External is EIP712 {", "highlightLines": [8]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/EIP712External.sol", "line": 8, "column": 1}, "severity": "medium", "references": [], "description": ""}, {"id": "f8ad6b8202f1", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(string memory name, string memory version) EIP712(name, version) {}", "highlightLines": [9]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/EIP712External.sol", "line": 9, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "46e2f9c9dcec", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function verify(\n        bytes memory signature,\n        address signer,\n        address mailTo,\n        string memory mailContents\n    ) external view {\n        bytes32 digest = _hashTypedDataV4(\n            keccak256(abi.encode(keccak256(\"Mail(address to,string contents)\"), mailTo, keccak256(bytes(mailContents))))\n        );\n        address recoveredSigner = ECDSA.recover(digest, signature);", "highlightLines": [15]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/EIP712External.sol", "line": 15, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "49d7daeef81a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 digest = _hashTypedDataV4(", "highlightLines": [21]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/EIP712External.sol", "line": 21, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e4df47be00e6", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes32 digest = _hashTypedDataV4(\n            keccak256(abi.encode(keccak256(\"Mail(address to,string contents)\"), mailTo, keccak256(bytes(mailContents))))\n        );\n        address recoveredSigner = ECDSA.recover(digest, signature);", "highlightLines": [21]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/EIP712External.sol", "line": 21, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "4f11b452e66f", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "            keccak256(abi.encode(keccak256(\"Mail(address to,string contents)\"), mailTo, keccak256(bytes(mailContents))))", "highlightLines": [22]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/EIP712External.sol", "line": 22, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "028afe809c1b", "fix": {"template": null, "available": false}, "title": "Signature verification without EIP-712 domain separator - vulnerable to cross-chain/cross-contract replay", "ruleId": "rules.sol-ethernaut-missing-eip712-domain", "snippet": {"code": "            keccak256(abi.encode(keccak256(\"Mail(address to,string contents)\"), mailTo, keccak256(bytes(mailContents))))", "highlightLines": [22]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/EIP712External.sol", "line": 22, "column": 13}, "severity": "high", "references": ["https://eips.ethereum.org/EIPS/eip-712", "https://ethernaut.openzeppelin.com/"], "description": ""}, {"id": "7aaa63addef9", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address recoveredSigner = ECDSA.recover(digest, signature);", "highlightLines": [24]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/EIP712External.sol", "line": 24, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "11310ec9eacb", "fix": {"template": null, "available": false}, "title": "ecrecover result not checked for zero address - invalid signatures return address(0)", "ruleId": "rules.sol-ethernaut-ecrecover-no-zero-check", "snippet": {"code": "        address recoveredSigner = ECDSA.recover(digest, signature);", "highlightLines": [24]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/EIP712External.sol", "line": 24, "column": 35}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-117", "https://swcregistry.io/docs/SWC-122"], "description": ""}, {"id": "f1b62f286145", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(recoveredSigner == signer);", "highlightLines": [25]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/EIP712External.sol", "line": 25, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "945c0ce6a7e0", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC1155BurnableMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "4cbfb09ec4f9", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(string memory uri) ERC1155(uri) {}", "highlightLines": [8]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC1155BurnableMock.sol", "line": 8, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "67b6cbf2cfd8", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function mint(\n        address to,\n        uint256 id,\n        uint256 value,\n        bytes memory data\n    ) public {", "highlightLines": [10]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC1155BurnableMock.sol", "line": 10, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "f905ecff7170", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function mint(\n        address to,\n        uint256 id,\n        uint256 value,\n        bytes memory data\n    ) public {", "highlightLines": [10]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC1155BurnableMock.sol", "line": 10, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "4dfae000e476", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC1155Mock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "f1b76247e985", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(string memory uri) ERC1155(uri) {}", "highlightLines": [12]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC1155Mock.sol", "line": 12, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "46c487cc5cb3", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function mint(\n        address to,\n        uint256 id,\n        uint256 value,\n        bytes memory data\n    ) public {", "highlightLines": [18]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC1155Mock.sol", "line": 18, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "7bce7fcf9e71", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function mint(\n        address to,\n        uint256 id,\n        uint256 value,\n        bytes memory data\n    ) public {", "highlightLines": [18]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC1155Mock.sol", "line": 18, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "b74d6b053104", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function burn(\n        address owner,\n        uint256 id,\n        uint256 value\n    ) public {", "highlightLines": [36]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC1155Mock.sol", "line": 36, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "bd89a4542a4b", "fix": {"template": null, "available": false}, "title": "Public burn function without access control - anyone can burn tokens", "ruleId": "rules.sol-erc20-public-burn", "snippet": {"code": "    function burn(\n        address owner,\n        uint256 id,\n        uint256 value\n    ) public {", "highlightLines": [36]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC1155Mock.sol", "line": 36, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "5568a5f67f8b", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function burn(\n        address owner,\n        uint256 id,\n        uint256 value\n    ) public {", "highlightLines": [36]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC1155Mock.sol", "line": 36, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "c3ac67a0afd3", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC1155PausableMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "77dbaf6bbebe", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(string memory uri) ERC1155Mock(uri) {}", "highlightLines": [9]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC1155PausableMock.sol", "line": 9, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "9c1f3316415e", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function pause() external {", "highlightLines": [11]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC1155PausableMock.sol", "line": 11, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "bce73c8d4f5e", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function unpause() external {", "highlightLines": [15]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC1155PausableMock.sol", "line": 15, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "049ca1f8bd2d", "fix": {"template": null, "available": false}, "title": "Storage array passed by value to internal function - changes won't persist", "ruleId": "rules.sol-array-by-reference", "snippet": {"code": "    function _beforeTokenTransfer(\n        address operator,\n        address from,\n        address to,\n        uint256[] memory ids,\n        uint256[] memory amounts,\n        bytes memory data\n    ) internal virtual override(ERC1155, ERC1155Pausable) {", "highlightLines": [19]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC1155PausableMock.sol", "line": 19, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#modifying-storage-array-by-value"], "description": ""}, {"id": "41ff9306c0fa", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "    ) internal virtual override(ERC1155, ERC1155Pausable) {", "highlightLines": [26]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC1155PausableMock.sol", "line": 26, "column": 33}, "severity": "info", "references": [], "description": ""}, {"id": "570735b7206c", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC1155ReceiverMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "51dc5cb46c7d", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "contract ERC1155ReceiverMock is ERC165, IERC1155Receiver {", "highlightLines": [8]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC1155ReceiverMock.sol", "line": 8, "column": 1}, "severity": "medium", "references": [], "description": ""}, {"id": "3fe444be3f2d", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract ERC1155ReceiverMock is ERC165, IERC1155Receiver {\n    bytes4 private _recRetval;\n    bool private _recReverts;\n    bytes4 private _batRetval;\n    bool private _batReverts;", "highlightLines": [8]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC1155ReceiverMock.sol", "line": 8, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "2fd277b68587", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event Received(address operator, address from, uint256 id, uint256 value, bytes data, uint256 gas);", "highlightLines": [14]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC1155ReceiverMock.sol", "line": 14, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "a4aecf897345", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Received(address operator, address from, uint256 id, uint256 value, bytes data, uint256 gas);", "highlightLines": [14]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC1155ReceiverMock.sol", "line": 14, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "8c25aaeb2633", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event BatchReceived(address operator, address from, uint256[] ids, uint256[] values, bytes data, uint256 gas);", "highlightLines": [15]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC1155ReceiverMock.sol", "line": 15, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "2dc54af1c469", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event BatchReceived(address operator, address from, uint256[] ids, uint256[] values, bytes data, uint256 gas);", "highlightLines": [15]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC1155ReceiverMock.sol", "line": 15, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "29fcfe2938a0", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(\n        bytes4 recRetval,\n        bool recReverts,\n        bytes4 batRetval,\n        bool batReverts\n    ) {\n        _recRetval = recRetval;\n        _recReverts = recReverts;\n        _batRetval = batRetval;\n        _batReverts = batReverts;\n    }", "highlightLines": [17]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC1155ReceiverMock.sol", "line": 17, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "8ed3fedc1d35", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        _recRetval = recRetval;\n        _recReverts = recReverts;", "highlightLines": [23]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC1155ReceiverMock.sol", "line": 23, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "24aabad9eed3", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        _recReverts = recReverts;\n        _batRetval = batRetval;", "highlightLines": [24]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC1155ReceiverMock.sol", "line": 24, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "57474838ba9e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        _batRetval = batRetval;\n        _batReverts = batReverts;", "highlightLines": [25]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC1155ReceiverMock.sol", "line": 25, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "477c5eba8662", "fix": {"template": null, "available": false}, "title": "Token callback function without reentrancy protection - ERC777/721/1155 callbacks can reenter", "ruleId": "rules.sol-callback-without-reentrancy-guard", "snippet": {"code": "    function onERC1155Received(\n        address operator,\n        address from,\n        uint256 id,\n        uint256 value,\n        bytes calldata data\n    ) external override returns (bytes4) {", "highlightLines": [29]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC1155ReceiverMock.sol", "line": 29, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "e96c19df6088", "fix": {"template": null, "available": false}, "title": "Token callback function without reentrancy protection - ERC777/721/1155 callbacks can reenter", "ruleId": "rules.sol-callback-without-reentrancy-guard", "snippet": {"code": "    function onERC1155BatchReceived(\n        address operator,\n        address from,\n        uint256[] calldata ids,\n        uint256[] calldata values,\n        bytes calldata data\n    ) external override returns (bytes4) {", "highlightLines": [41]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC1155ReceiverMock.sol", "line": 41, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "38b68884f482", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC1155SupplyMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "cb9b70c6c037", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(string memory uri) ERC1155Mock(uri) {}", "highlightLines": [9]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC1155SupplyMock.sol", "line": 9, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "292458426a93", "fix": {"template": null, "available": false}, "title": "Storage array passed by value to internal function - changes won't persist", "ruleId": "rules.sol-array-by-reference", "snippet": {"code": "    function _beforeTokenTransfer(\n        address operator,\n        address from,\n        address to,\n        uint256[] memory ids,\n        uint256[] memory amounts,\n        bytes memory data\n    ) internal virtual override(ERC1155, ERC1155Supply) {", "highlightLines": [11]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC1155SupplyMock.sol", "line": 11, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#modifying-storage-array-by-value"], "description": ""}, {"id": "b96e209f6734", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "    ) internal virtual override(ERC1155, ERC1155Supply) {", "highlightLines": [18]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC1155SupplyMock.sol", "line": 18, "column": 33}, "severity": "info", "references": [], "description": ""}, {"id": "77d3edf32e42", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC1155URIStorageMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "baffe5259c72", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "contract ERC1155URIStorageMock is ERC1155Mock, ERC1155URIStorage {", "highlightLines": [8]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC1155URIStorageMock.sol", "line": 8, "column": 1}, "severity": "medium", "references": [], "description": ""}, {"id": "6be2069de93d", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(string memory _uri) ERC1155Mock(_uri) {}", "highlightLines": [9]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC1155URIStorageMock.sol", "line": 9, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "219e5cebedda", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function uri(uint256 tokenId) public view virtual override(ERC1155, ERC1155URIStorage) returns (string memory) {", "highlightLines": [11]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC1155URIStorageMock.sol", "line": 11, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "5383a3e0d0f8", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "    function uri(uint256 tokenId) public view virtual override(ERC1155, ERC1155URIStorage) returns (string memory) {", "highlightLines": [11]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC1155URIStorageMock.sol", "line": 11, "column": 64}, "severity": "info", "references": [], "description": ""}, {"id": "807a91c8697e", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function setURI(uint256 tokenId, string memory _tokenURI) public {", "highlightLines": [15]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC1155URIStorageMock.sol", "line": 15, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "82f9e37b4824", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC1271WalletMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "1dcd6e0129c6", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "contract ERC1271WalletMock is Ownable, IERC1271 {", "highlightLines": [9]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC1271WalletMock.sol", "line": 9, "column": 1}, "severity": "medium", "references": [], "description": ""}, {"id": "094fd0b32abe", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(address originalOwner) {\n        transferOwnership(originalOwner);\n    }", "highlightLines": [10]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC1271WalletMock.sol", "line": 10, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "5b06e0111cc0", "fix": {"template": null, "available": false}, "title": "ecrecover result not checked for zero address - invalid signatures return address(0)", "ruleId": "rules.sol-ethernaut-ecrecover-no-zero-check", "snippet": {"code": "        return ECDSA.recover(hash, signature) == owner() ? this.isValidSignature.selector : bytes4(0);", "highlightLines": [15]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC1271WalletMock.sol", "line": 15, "column": 16}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-117", "https://swcregistry.io/docs/SWC-122"], "description": ""}, {"id": "5531d71edd19", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "contract ERC1271MaliciousMock is IERC1271 {", "highlightLines": [19]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC1271WalletMock.sol", "line": 19, "column": 1}, "severity": "medium", "references": [], "description": ""}, {"id": "cf70ae3ae922", "fix": {"template": null, "available": false}, "title": "View/pure function uses assembly - may modify state unexpectedly", "ruleId": "rules.sol-constant-function-assembly", "snippet": {"code": "    function isValidSignature(bytes32, bytes memory) public pure override returns (bytes4) {\n        assembly {", "highlightLines": [20]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC1271WalletMock.sol", "line": 20, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-using-assembly-code"], "description": ""}, {"id": "096880c20869", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [21]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC1271WalletMock.sol", "line": 21, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "281d60259dc8", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "            mstore(0, 0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff)", "highlightLines": [22]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC1271WalletMock.sol", "line": 22, "column": 23}, "severity": "high", "references": [], "description": ""}, {"id": "078c520a7c93", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC165/ERC165InterfacesSupported.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "6e61a3913526", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "contract SupportsInterfaceWithLookupMock is IERC165 {", "highlightLines": [17]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC165/ERC165InterfacesSupported.sol", "line": 17, "column": 1}, "severity": "medium", "references": [], "description": ""}, {"id": "9aa1e09ad7e5", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor() {\n        _registerInterface(INTERFACE_ID_ERC165);\n    }", "highlightLines": [32]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC165/ERC165InterfacesSupported.sol", "line": 32, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "28f41fc18230", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract ERC165InterfacesSupported is SupportsInterfaceWithLookupMock {\n    constructor(bytes4[] memory interfaceIds) {\n        for (uint256 i = 0; i < interfaceIds.length; i++) {", "highlightLines": [52]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC165/ERC165InterfacesSupported.sol", "line": 52, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "b83210bd6c92", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(bytes4[] memory interfaceIds) {\n        for (uint256 i = 0; i < interfaceIds.length; i++) {\n            _registerInterface(interfaceIds[i]);\n        }\n    }", "highlightLines": [53]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC165/ERC165InterfacesSupported.sol", "line": 53, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "ea1319c9ecca", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC165/ERC165MaliciousData.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "84abec4675d7", "fix": {"template": null, "available": false}, "title": "View/pure function uses assembly - may modify state unexpectedly", "ruleId": "rules.sol-constant-function-assembly", "snippet": {"code": "    function supportsInterface(bytes4) public view returns (bool) {\n        assembly {", "highlightLines": [6]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC165/ERC165MaliciousData.sol", "line": 6, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-using-assembly-code"], "description": ""}, {"id": "f9926530709c", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [7]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC165/ERC165MaliciousData.sol", "line": 7, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "348500edce8d", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "            mstore(0, 0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff)", "highlightLines": [8]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC165/ERC165MaliciousData.sol", "line": 8, "column": 23}, "severity": "high", "references": [], "description": ""}, {"id": "add0a7297704", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC165/ERC165MissingData.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "448b2064669a", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC165/ERC165NotSupported.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "4e6bcdfff10e", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC165CheckerMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "08462b37cfe6", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC165Mock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "4024c0f6c5a9", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC165StorageMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "5c7631153dfb", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC1820ImplementerMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "ace9d6c821e7", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20BurnableMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "0db596bfecf0", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(\n        string memory name,\n        string memory symbol,\n        address initialAccount,\n        uint256 initialBalance\n    ) ERC20(name, symbol) {\n        _mint(initialAccount, initialBalance);\n    }", "highlightLines": [8]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20BurnableMock.sol", "line": 8, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "0e7c886a4f00", "fix": {"template": null, "available": false}, "title": "NFT mint without supply check - potential overflow in tokenId", "ruleId": "rules.sol-nft-overflow-mint", "snippet": {"code": "        _mint(initialAccount, initialBalance);", "highlightLines": [14]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20BurnableMock.sol", "line": 14, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "029794cea5dc", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20CappedMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "b763ba66b1ed", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(\n        string memory name,\n        string memory symbol,\n        uint256 cap\n    ) ERC20(name, symbol) ERC20Capped(cap) {}", "highlightLines": [8]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20CappedMock.sol", "line": 8, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "9cc524b7b67c", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function mint(address to, uint256 tokenId) public {", "highlightLines": [14]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20CappedMock.sol", "line": 14, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "ac6edfbb361c", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function mint(address to, uint256 tokenId) public {", "highlightLines": [14]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20CappedMock.sol", "line": 14, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "92ed38af85dd", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function mint(address to, uint256 tokenId) public {", "highlightLines": [14]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20CappedMock.sol", "line": 14, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "dfef36a42ff8", "fix": {"template": null, "available": false}, "title": "NFT mint without supply check - potential overflow in tokenId", "ruleId": "rules.sol-nft-overflow-mint", "snippet": {"code": "        _mint(to, tokenId);", "highlightLines": [15]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20CappedMock.sol", "line": 15, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e7499b1e2ee8", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20DecimalsMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "8fad1823ca95", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(\n        string memory name_,\n        string memory symbol_,\n        uint8 decimals_\n    ) ERC20(name_, symbol_) {\n        _decimals = decimals_;\n    }", "highlightLines": [10]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20DecimalsMock.sol", "line": 10, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "cc363f0d6715", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function mint(address account, uint256 amount) public {", "highlightLines": [22]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20DecimalsMock.sol", "line": 22, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "d9f9dac7d1c1", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function mint(address account, uint256 amount) public {", "highlightLines": [22]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20DecimalsMock.sol", "line": 22, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "99f673cebd56", "fix": {"template": null, "available": false}, "title": "NFT mint without supply check - potential overflow in tokenId", "ruleId": "rules.sol-nft-overflow-mint", "snippet": {"code": "        _mint(account, amount);", "highlightLines": [23]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20DecimalsMock.sol", "line": 23, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "eb1dd5baf6a1", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function burn(address account, uint256 amount) public {", "highlightLines": [26]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20DecimalsMock.sol", "line": 26, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "3b8fe628d4db", "fix": {"template": null, "available": false}, "title": "Public burn function without access control - anyone can burn tokens", "ruleId": "rules.sol-erc20-public-burn", "snippet": {"code": "    function burn(address account, uint256 amount) public {", "highlightLines": [26]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20DecimalsMock.sol", "line": 26, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "0dbff043882c", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function burn(address account, uint256 amount) public {", "highlightLines": [26]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20DecimalsMock.sol", "line": 26, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "b101f43f0ea2", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20FlashMintMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "a0b6d19b5696", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract ERC20FlashMintMock is ERC20FlashMint {\n    uint256 _flashFeeAmount;\n    address _flashFeeReceiverAddress;", "highlightLines": [7]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20FlashMintMock.sol", "line": 7, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "8f2233e3db02", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 _flashFeeAmount;", "highlightLines": [8]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20FlashMintMock.sol", "line": 8, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "2f26a60c5ae9", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address _flashFeeReceiverAddress;", "highlightLines": [9]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20FlashMintMock.sol", "line": 9, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "fd11739d99ba", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(\n        string memory name,\n        string memory symbol,\n        address initialAccount,\n        uint256 initialBalance\n    ) ERC20(name, symbol) {\n        _mint(initialAccount, initialBalance);\n    }", "highlightLines": [11]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20FlashMintMock.sol", "line": 11, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "e424732e567a", "fix": {"template": null, "available": false}, "title": "NFT mint without supply check - potential overflow in tokenId", "ruleId": "rules.sol-nft-overflow-mint", "snippet": {"code": "        _mint(initialAccount, initialBalance);", "highlightLines": [17]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20FlashMintMock.sol", "line": 17, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "0eb57b5555f1", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function mint(address account, uint256 amount) public {", "highlightLines": [20]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20FlashMintMock.sol", "line": 20, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "539eb9af4093", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function mint(address account, uint256 amount) public {", "highlightLines": [20]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20FlashMintMock.sol", "line": 20, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "4c9d3488db51", "fix": {"template": null, "available": false}, "title": "NFT mint without supply check - potential overflow in tokenId", "ruleId": "rules.sol-nft-overflow-mint", "snippet": {"code": "        _mint(account, amount);", "highlightLines": [21]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20FlashMintMock.sol", "line": 21, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "ccd4e28a5205", "fix": {"template": null, "available": false}, "title": "Flash loan amount not validated against available liquidity", "ruleId": "rules.sol-flash-loan-amount-validation", "snippet": {"code": "    function flashFee(address token, uint256 amount) public view virtual override returns (uint256) {", "highlightLines": [28]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20FlashMintMock.sol", "line": 28, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "1a9af44627e4", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20Mock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "22782eaf438b", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(\n        string memory name,\n        string memory symbol,\n        address initialAccount,\n        uint256 initialBalance\n    ) payable ERC20(name, symbol) {\n        _mint(initialAccount, initialBalance);\n    }", "highlightLines": [9]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20Mock.sol", "line": 9, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "5ba97d7fe529", "fix": {"template": null, "available": false}, "title": "NFT mint without supply check - potential overflow in tokenId", "ruleId": "rules.sol-nft-overflow-mint", "snippet": {"code": "        _mint(initialAccount, initialBalance);", "highlightLines": [15]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20Mock.sol", "line": 15, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "295ca6bc5a15", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function mint(address account, uint256 amount) public {", "highlightLines": [18]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20Mock.sol", "line": 18, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "c5d22592052e", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function mint(address account, uint256 amount) public {", "highlightLines": [18]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20Mock.sol", "line": 18, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "943dc22c3b5c", "fix": {"template": null, "available": false}, "title": "NFT mint without supply check - potential overflow in tokenId", "ruleId": "rules.sol-nft-overflow-mint", "snippet": {"code": "        _mint(account, amount);", "highlightLines": [19]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20Mock.sol", "line": 19, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "ae4375ff43bc", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function burn(address account, uint256 amount) public {", "highlightLines": [22]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20Mock.sol", "line": 22, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "f2d8d4707b4d", "fix": {"template": null, "available": false}, "title": "Public burn function without access control - anyone can burn tokens", "ruleId": "rules.sol-erc20-public-burn", "snippet": {"code": "    function burn(address account, uint256 amount) public {", "highlightLines": [22]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20Mock.sol", "line": 22, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "5ff0c33e351a", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function burn(address account, uint256 amount) public {", "highlightLines": [22]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20Mock.sol", "line": 22, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "dda31914a719", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20PausableMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "9c3b4f242448", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(\n        string memory name,\n        string memory symbol,\n        address initialAccount,\n        uint256 initialBalance\n    ) ERC20(name, symbol) {\n        _mint(initialAccount, initialBalance);\n    }", "highlightLines": [9]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20PausableMock.sol", "line": 9, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "9df8dc4cc4ee", "fix": {"template": null, "available": false}, "title": "NFT mint without supply check - potential overflow in tokenId", "ruleId": "rules.sol-nft-overflow-mint", "snippet": {"code": "        _mint(initialAccount, initialBalance);", "highlightLines": [15]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20PausableMock.sol", "line": 15, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "7fa8278cc13d", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function pause() external {", "highlightLines": [18]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20PausableMock.sol", "line": 18, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "25fda3684720", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function unpause() external {", "highlightLines": [22]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20PausableMock.sol", "line": 22, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "c19abe834e2c", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function mint(address to, uint256 amount) public {", "highlightLines": [26]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20PausableMock.sol", "line": 26, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "7f5e35b6f1a3", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function mint(address to, uint256 amount) public {", "highlightLines": [26]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20PausableMock.sol", "line": 26, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "5e6dffb569e2", "fix": {"template": null, "available": false}, "title": "NFT mint without supply check - potential overflow in tokenId", "ruleId": "rules.sol-nft-overflow-mint", "snippet": {"code": "        _mint(to, amount);", "highlightLines": [27]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20PausableMock.sol", "line": 27, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "8521a24e817f", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function burn(address from, uint256 amount) public {", "highlightLines": [30]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20PausableMock.sol", "line": 30, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "a96d77798e04", "fix": {"template": null, "available": false}, "title": "Public burn function without access control - anyone can burn tokens", "ruleId": "rules.sol-erc20-public-burn", "snippet": {"code": "    function burn(address from, uint256 amount) public {", "highlightLines": [30]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20PausableMock.sol", "line": 30, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "56ed2ffad72d", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function burn(address from, uint256 amount) public {", "highlightLines": [30]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20PausableMock.sol", "line": 30, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "599c2831dc53", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20PermitMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "c274d097f36e", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(\n        string memory name,\n        string memory symbol,\n        address initialAccount,\n        uint256 initialBalance\n    ) payable ERC20(name, symbol) ERC20Permit(name) {\n        _mint(initialAccount, initialBalance);\n    }", "highlightLines": [8]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20PermitMock.sol", "line": 8, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "d88efba2816f", "fix": {"template": null, "available": false}, "title": "NFT mint without supply check - potential overflow in tokenId", "ruleId": "rules.sol-nft-overflow-mint", "snippet": {"code": "        _mint(initialAccount, initialBalance);", "highlightLines": [14]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20PermitMock.sol", "line": 14, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "21be41e82bb2", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20SnapshotMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "e7b56c6478fe", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(\n        string memory name,\n        string memory symbol,\n        address initialAccount,\n        uint256 initialBalance\n    ) ERC20(name, symbol) {\n        _mint(initialAccount, initialBalance);\n    }", "highlightLines": [8]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20SnapshotMock.sol", "line": 8, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "9c34480f68ac", "fix": {"template": null, "available": false}, "title": "NFT mint without supply check - potential overflow in tokenId", "ruleId": "rules.sol-nft-overflow-mint", "snippet": {"code": "        _mint(initialAccount, initialBalance);", "highlightLines": [14]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20SnapshotMock.sol", "line": 14, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "8d375563dba4", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function mint(address account, uint256 amount) public {", "highlightLines": [21]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20SnapshotMock.sol", "line": 21, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "0c5a7f13d244", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function mint(address account, uint256 amount) public {", "highlightLines": [21]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20SnapshotMock.sol", "line": 21, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "1678ffc48f28", "fix": {"template": null, "available": false}, "title": "NFT mint without supply check - potential overflow in tokenId", "ruleId": "rules.sol-nft-overflow-mint", "snippet": {"code": "        _mint(account, amount);", "highlightLines": [22]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20SnapshotMock.sol", "line": 22, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "625396d8397a", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function burn(address account, uint256 amount) public {", "highlightLines": [25]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20SnapshotMock.sol", "line": 25, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "f68cde2fac9f", "fix": {"template": null, "available": false}, "title": "Public burn function without access control - anyone can burn tokens", "ruleId": "rules.sol-erc20-public-burn", "snippet": {"code": "    function burn(address account, uint256 amount) public {", "highlightLines": [25]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20SnapshotMock.sol", "line": 25, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "914c138be650", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function burn(address account, uint256 amount) public {", "highlightLines": [25]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20SnapshotMock.sol", "line": 25, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "97fc95c0f596", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20VotesCompMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "4f7f5f64ffdb", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(string memory name, string memory symbol) ERC20(name, symbol) ERC20Permit(name) {}", "highlightLines": [8]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20VotesCompMock.sol", "line": 8, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "abe90c32c42c", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function mint(address account, uint256 amount) public {", "highlightLines": [10]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20VotesCompMock.sol", "line": 10, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "824ce92f3a1a", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function mint(address account, uint256 amount) public {", "highlightLines": [10]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20VotesCompMock.sol", "line": 10, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "72ea4fd95fa9", "fix": {"template": null, "available": false}, "title": "NFT mint without supply check - potential overflow in tokenId", "ruleId": "rules.sol-nft-overflow-mint", "snippet": {"code": "        _mint(account, amount);", "highlightLines": [11]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20VotesCompMock.sol", "line": 11, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "7378e0762020", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function burn(address account, uint256 amount) public {", "highlightLines": [14]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20VotesCompMock.sol", "line": 14, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "5e45cb12206f", "fix": {"template": null, "available": false}, "title": "Public burn function without access control - anyone can burn tokens", "ruleId": "rules.sol-erc20-public-burn", "snippet": {"code": "    function burn(address account, uint256 amount) public {", "highlightLines": [14]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20VotesCompMock.sol", "line": 14, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "71c6fb06611a", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function burn(address account, uint256 amount) public {", "highlightLines": [14]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20VotesCompMock.sol", "line": 14, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "49ac71dd10af", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20VotesMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "33a54ba82d73", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(string memory name, string memory symbol) ERC20(name, symbol) ERC20Permit(name) {}", "highlightLines": [8]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20VotesMock.sol", "line": 8, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "883d1bd2c04d", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function mint(address account, uint256 amount) public {", "highlightLines": [10]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20VotesMock.sol", "line": 10, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "2b6b30152ba9", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function mint(address account, uint256 amount) public {", "highlightLines": [10]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20VotesMock.sol", "line": 10, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "2bf51924ab0f", "fix": {"template": null, "available": false}, "title": "NFT mint without supply check - potential overflow in tokenId", "ruleId": "rules.sol-nft-overflow-mint", "snippet": {"code": "        _mint(account, amount);", "highlightLines": [11]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20VotesMock.sol", "line": 11, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "ee68d5263a96", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function burn(address account, uint256 amount) public {", "highlightLines": [14]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20VotesMock.sol", "line": 14, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "8276438abd11", "fix": {"template": null, "available": false}, "title": "Public burn function without access control - anyone can burn tokens", "ruleId": "rules.sol-erc20-public-burn", "snippet": {"code": "    function burn(address account, uint256 amount) public {", "highlightLines": [14]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20VotesMock.sol", "line": 14, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "36c741a7cd99", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function burn(address account, uint256 amount) public {", "highlightLines": [14]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20VotesMock.sol", "line": 14, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "293733df732c", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20WrapperMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "320d48c4b041", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(\n        IERC20 _underlyingToken,\n        string memory name,\n        string memory symbol\n    ) ERC20(name, symbol) ERC20Wrapper(_underlyingToken) {}", "highlightLines": [8]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC20WrapperMock.sol", "line": 8, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "0ab8181e09d5", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.9;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC2771ContextMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "8bb7bbd8c330", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(address trustedForwarder) ERC2771Context(trustedForwarder) {\n        emit Sender(_msgSender()); // _msgSender() should be accessible during construction\n    }", "highlightLines": [11]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC2771ContextMock.sol", "line": 11, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "a8c9e970943e", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC3156FlashBorrowerMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "df620ef13e1f", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "contract ERC3156FlashBorrowerMock is IERC3156FlashBorrower {", "highlightLines": [16]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC3156FlashBorrowerMock.sol", "line": 16, "column": 1}, "severity": "medium", "references": [], "description": ""}, {"id": "7b3afb5f6ef5", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event BalanceOf(address token, address account, uint256 value);", "highlightLines": [22]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC3156FlashBorrowerMock.sol", "line": 22, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "6808e5d17165", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event BalanceOf(address token, address account, uint256 value);", "highlightLines": [22]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC3156FlashBorrowerMock.sol", "line": 22, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "279b0ad0812f", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event TotalSupply(address token, uint256 value);", "highlightLines": [23]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC3156FlashBorrowerMock.sol", "line": 23, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "0c31abf34120", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event TotalSupply(address token, uint256 value);", "highlightLines": [23]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC3156FlashBorrowerMock.sol", "line": 23, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "0a408e5f556b", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(bool enableReturn, bool enableApprove) {\n        _enableApprove = enableApprove;\n        _enableReturn = enableReturn;\n    }", "highlightLines": [25]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC3156FlashBorrowerMock.sol", "line": 25, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "f3b63c064e58", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        _enableApprove = enableApprove;\n        _enableReturn = enableReturn;", "highlightLines": [26]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC3156FlashBorrowerMock.sol", "line": 26, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "18b0097c34ef", "fix": {"template": null, "available": false}, "title": "Callback function without caller validation - external contracts can trigger unexpected behavior", "ruleId": "rules.sol-unprotected-callback", "snippet": {"code": "    function onFlashLoan(\n        address, /*initiator*/\n        address token,\n        uint256 amount,\n        uint256 fee,\n        bytes calldata data\n    ) public override returns (bytes32) {", "highlightLines": [30]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC3156FlashBorrowerMock.sol", "line": 30, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "c9bb283251d3", "fix": {"template": null, "available": false}, "title": "Flash loan callback without loan verification - attacker can call directly without actual flash loan", "ruleId": "rules.sol-flash-loan-callback-unprotected", "snippet": {"code": "    function onFlashLoan(\n        address, /*initiator*/\n        address token,\n        uint256 amount,\n        uint256 fee,\n        bytes calldata data\n    ) public override returns (bytes32) {", "highlightLines": [30]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC3156FlashBorrowerMock.sol", "line": 30, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "799e7d9e5372", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender == token);", "highlightLines": [37]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC3156FlashBorrowerMock.sol", "line": 37, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "7380988337d3", "fix": {"template": null, "available": false}, "title": "address(this) emitted in event - may emit wrong address (handler vs token confusion)", "ruleId": "rules.sol-address-this-in-event", "snippet": {"code": "        emit BalanceOf(token, address(this), IERC20(token).balanceOf(address(this)));", "highlightLines": [39]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC3156FlashBorrowerMock.sol", "line": 39, "column": 9}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "68708fa25049", "fix": {"template": null, "available": false}, "title": "address(this) directly in emit - likely wrong address (should use token/handler variable)", "ruleId": "rules.sol-emit-address-this", "snippet": {"code": "        emit BalanceOf(token, address(this), IERC20(token).balanceOf(address(this)));", "highlightLines": [39]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC3156FlashBorrowerMock.sol", "line": 39, "column": 9}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "e315be17e7f8", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "        emit BalanceOf(token, address(this), IERC20(token).balanceOf(address(this)));", "highlightLines": [39]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC3156FlashBorrowerMock.sol", "line": 39, "column": 46}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "26131b21a6d6", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "        emit TotalSupply(token, IERC20(token).totalSupply());", "highlightLines": [40]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC3156FlashBorrowerMock.sol", "line": 40, "column": 33}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "05a3acf8db8a", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "            IERC20(token).approve(token, amount + fee);", "highlightLines": [48]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC3156FlashBorrowerMock.sol", "line": 48, "column": 13}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "0961004f11ae", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without SafeERC20 - some tokens dont return bool", "ruleId": "rules.sol-unsafe-erc20-transfer", "snippet": {"code": "            IERC20(token).approve(token, amount + fee);", "highlightLines": [48]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC3156FlashBorrowerMock.sol", "line": 48, "column": 13}, "severity": "medium", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/token/ERC20/utils/SafeERC20.sol"], "description": ""}, {"id": "a8cc6a68dcb3", "fix": {"template": null, "available": false}, "title": "ERC20 approve without setting to 0 first - frontrunning double-spend possible", "ruleId": "rules.sol-frontrunnable-approval", "snippet": {"code": "            IERC20(token).approve(token, amount + fee);", "highlightLines": [48]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC3156FlashBorrowerMock.sol", "line": 48, "column": 26}, "severity": "medium", "references": ["https://github.com/ethereum/EIPs/issues/20#issuecomment-263524729"], "description": ""}, {"id": "867bd36f3edd", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC4626Mock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "953fbdf574fa", "fix": {"template": null, "available": false}, "title": "ERC4626 vault missing _decimalsOffset() - vulnerable to precision loss attacks", "ruleId": "rules.sol-erc4626-missing-decimal-offset", "snippet": {"code": "contract ERC4626Mock is ERC4626 {", "highlightLines": [8]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC4626Mock.sol", "line": 8, "column": 1}, "severity": "medium", "references": [], "description": ""}, {"id": "35b5adc9ff05", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(\n        IERC20Metadata asset,\n        string memory name,\n        string memory symbol\n    ) ERC20(name, symbol) ERC4626(asset) {}", "highlightLines": [9]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC4626Mock.sol", "line": 9, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "b8fd4be172f8", "fix": {"template": null, "available": false}, "title": "NFT mint without supply check - potential overflow in tokenId", "ruleId": "rules.sol-nft-overflow-mint", "snippet": {"code": "        _mint(account, amount);", "highlightLines": [16]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC4626Mock.sol", "line": 16, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "0a184fc039ae", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721BurnableMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "6b7a6904b778", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(string memory name, string memory symbol) ERC721(name, symbol) {}", "highlightLines": [8]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721BurnableMock.sol", "line": 8, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "8010c065a343", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function exists(uint256 tokenId) public view returns (bool) {", "highlightLines": [10]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721BurnableMock.sol", "line": 10, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "8524f1ddcdf0", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function mint(address to, uint256 tokenId) public {", "highlightLines": [14]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721BurnableMock.sol", "line": 14, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "e12a1dcca306", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function mint(address to, uint256 tokenId) public {", "highlightLines": [14]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721BurnableMock.sol", "line": 14, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "5b5017ec0cc9", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function mint(address to, uint256 tokenId) public {", "highlightLines": [14]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721BurnableMock.sol", "line": 14, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "7537dd83a974", "fix": {"template": null, "available": false}, "title": "NFT mint without supply check - potential overflow in tokenId", "ruleId": "rules.sol-nft-overflow-mint", "snippet": {"code": "        _mint(to, tokenId);", "highlightLines": [15]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721BurnableMock.sol", "line": 15, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "677630e21482", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function safeMint(address to, uint256 tokenId) public {", "highlightLines": [18]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721BurnableMock.sol", "line": 18, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "42b1aa9af4ad", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function safeMint(\n        address to,\n        uint256 tokenId,\n        bytes memory _data\n    ) public {", "highlightLines": [22]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721BurnableMock.sol", "line": 22, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "3611c7d104df", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721EnumerableMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "d274e93193c3", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract ERC721EnumerableMock is ERC721Enumerable {\n    string private _baseTokenURI;", "highlightLines": [11]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721EnumerableMock.sol", "line": 11, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "5211bf399fc1", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(string memory name, string memory symbol) ERC721(name, symbol) {}", "highlightLines": [14]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721EnumerableMock.sol", "line": 14, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "154d7b17cc38", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function exists(uint256 tokenId) public view returns (bool) {", "highlightLines": [28]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721EnumerableMock.sol", "line": 28, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "a3aa529749b0", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function mint(address to, uint256 tokenId) public {", "highlightLines": [32]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721EnumerableMock.sol", "line": 32, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "9a594d2c56e7", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function mint(address to, uint256 tokenId) public {", "highlightLines": [32]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721EnumerableMock.sol", "line": 32, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "6b64188e8420", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function mint(address to, uint256 tokenId) public {", "highlightLines": [32]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721EnumerableMock.sol", "line": 32, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "8e865c3226e2", "fix": {"template": null, "available": false}, "title": "NFT mint without supply check - potential overflow in tokenId", "ruleId": "rules.sol-nft-overflow-mint", "snippet": {"code": "        _mint(to, tokenId);", "highlightLines": [33]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721EnumerableMock.sol", "line": 33, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "b4b2b66e6a55", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function safeMint(address to, uint256 tokenId) public {", "highlightLines": [36]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721EnumerableMock.sol", "line": 36, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "5df85a9b1354", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function safeMint(\n        address to,\n        uint256 tokenId,\n        bytes memory _data\n    ) public {", "highlightLines": [40]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721EnumerableMock.sol", "line": 40, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "4a8c0321e4f7", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function burn(uint256 tokenId) public {", "highlightLines": [48]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721EnumerableMock.sol", "line": 48, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "76df2c137d28", "fix": {"template": null, "available": false}, "title": "Public burn function without access control - anyone can burn tokens", "ruleId": "rules.sol-erc20-public-burn", "snippet": {"code": "    function burn(uint256 tokenId) public {", "highlightLines": [48]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721EnumerableMock.sol", "line": 48, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "9133ed4bdf94", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function burn(uint256 tokenId) public {", "highlightLines": [48]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721EnumerableMock.sol", "line": 48, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "e04d18402cf5", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function burn(uint256 tokenId) public {", "highlightLines": [48]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721EnumerableMock.sol", "line": 48, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "08b954db7d34", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721Mock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "a53ca001ae59", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(string memory name, string memory symbol) ERC721(name, symbol) {}", "highlightLines": [12]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721Mock.sol", "line": 12, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "8fb94f763ab9", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function exists(uint256 tokenId) public view returns (bool) {", "highlightLines": [18]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721Mock.sol", "line": 18, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "5ea1e5fd7653", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function mint(address to, uint256 tokenId) public {", "highlightLines": [22]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721Mock.sol", "line": 22, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "799d098e7ff5", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function mint(address to, uint256 tokenId) public {", "highlightLines": [22]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721Mock.sol", "line": 22, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "65000bd72ab9", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function mint(address to, uint256 tokenId) public {", "highlightLines": [22]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721Mock.sol", "line": 22, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "4dd9b2849e55", "fix": {"template": null, "available": false}, "title": "NFT mint without supply check - potential overflow in tokenId", "ruleId": "rules.sol-nft-overflow-mint", "snippet": {"code": "        _mint(to, tokenId);", "highlightLines": [23]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721Mock.sol", "line": 23, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "50c4d7aa9b86", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function safeMint(address to, uint256 tokenId) public {", "highlightLines": [26]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721Mock.sol", "line": 26, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "79bb0176b22f", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function safeMint(\n        address to,\n        uint256 tokenId,\n        bytes memory _data\n    ) public {", "highlightLines": [30]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721Mock.sol", "line": 30, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "8469810574af", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function burn(uint256 tokenId) public {", "highlightLines": [38]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721Mock.sol", "line": 38, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "ecff0d522df2", "fix": {"template": null, "available": false}, "title": "Public burn function without access control - anyone can burn tokens", "ruleId": "rules.sol-erc20-public-burn", "snippet": {"code": "    function burn(uint256 tokenId) public {", "highlightLines": [38]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721Mock.sol", "line": 38, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "2ed3906f4d8d", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function burn(uint256 tokenId) public {", "highlightLines": [38]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721Mock.sol", "line": 38, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "fc5a28e7881a", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function burn(uint256 tokenId) public {", "highlightLines": [38]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721Mock.sol", "line": 38, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "9d7ea0766a28", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721PausableMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "a6ab44f78b59", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(string memory name, string memory symbol) ERC721(name, symbol) {}", "highlightLines": [12]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721PausableMock.sol", "line": 12, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "8522ed7b82fd", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function pause() external {", "highlightLines": [14]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721PausableMock.sol", "line": 14, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "153f696e01d1", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function unpause() external {", "highlightLines": [18]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721PausableMock.sol", "line": 18, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "6bdfbadae428", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function exists(uint256 tokenId) public view returns (bool) {", "highlightLines": [22]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721PausableMock.sol", "line": 22, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "851374c08ea0", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function mint(address to, uint256 tokenId) public {", "highlightLines": [26]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721PausableMock.sol", "line": 26, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "b4e7e15e056c", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function mint(address to, uint256 tokenId) public {", "highlightLines": [26]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721PausableMock.sol", "line": 26, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "ac12cf8d2420", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function mint(address to, uint256 tokenId) public {", "highlightLines": [26]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721PausableMock.sol", "line": 26, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "910dd5eaf039", "fix": {"template": null, "available": false}, "title": "NFT mint without supply check - potential overflow in tokenId", "ruleId": "rules.sol-nft-overflow-mint", "snippet": {"code": "        _mint(to, tokenId);", "highlightLines": [27]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721PausableMock.sol", "line": 27, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "07746026e9ff", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function safeMint(address to, uint256 tokenId) public {", "highlightLines": [30]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721PausableMock.sol", "line": 30, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "6411715fc470", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function safeMint(\n        address to,\n        uint256 tokenId,\n        bytes memory _data\n    ) public {", "highlightLines": [34]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721PausableMock.sol", "line": 34, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "b713a777fc2b", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function burn(uint256 tokenId) public {", "highlightLines": [42]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721PausableMock.sol", "line": 42, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "c6ed097a7c7b", "fix": {"template": null, "available": false}, "title": "Public burn function without access control - anyone can burn tokens", "ruleId": "rules.sol-erc20-public-burn", "snippet": {"code": "    function burn(uint256 tokenId) public {", "highlightLines": [42]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721PausableMock.sol", "line": 42, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "536a225b8b5b", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function burn(uint256 tokenId) public {", "highlightLines": [42]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721PausableMock.sol", "line": 42, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "7f6b6c909a58", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function burn(uint256 tokenId) public {", "highlightLines": [42]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721PausableMock.sol", "line": 42, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "6ca951e3674c", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721ReceiverMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "95d5bf8ad02a", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "contract ERC721ReceiverMock is IERC721Receiver {", "highlightLines": [7]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721ReceiverMock.sol", "line": 7, "column": 1}, "severity": "medium", "references": [], "description": ""}, {"id": "d9b66ed20653", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event Received(address operator, address from, uint256 tokenId, bytes data, uint256 gas);", "highlightLines": [18]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721ReceiverMock.sol", "line": 18, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "c0c9007a01ac", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Received(address operator, address from, uint256 tokenId, bytes data, uint256 gas);", "highlightLines": [18]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721ReceiverMock.sol", "line": 18, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "d9f36639b81d", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(bytes4 retval, Error error) {\n        _retval = retval;\n        _error = error;\n    }", "highlightLines": [20]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721ReceiverMock.sol", "line": 20, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "9eb4d66e5f21", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        _retval = retval;\n        _error = error;", "highlightLines": [21]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721ReceiverMock.sol", "line": 21, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "526aed1814ab", "fix": {"template": null, "available": false}, "title": "Token callback function without reentrancy protection - ERC777/721/1155 callbacks can reenter", "ruleId": "rules.sol-callback-without-reentrancy-guard", "snippet": {"code": "    function onERC721Received(\n        address operator,\n        address from,\n        uint256 tokenId,\n        bytes memory data\n    ) public override returns (bytes4) {", "highlightLines": [25]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721ReceiverMock.sol", "line": 25, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "b71a04895c47", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function onERC721Received(\n        address operator,\n        address from,\n        uint256 tokenId,\n        bytes memory data\n    ) public override returns (bytes4) {", "highlightLines": [25]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721ReceiverMock.sol", "line": 25, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "f4f1b84e453d", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "        if (_error == Error.RevertWithMessage) {\n            revert(\"ERC721ReceiverMock: reverting\");\n        } else if (_error == Error.RevertWithoutMessage) {\n            revert();\n        } else if (_error == Error.Panic) {\n            uint256 a = uint256(0) / uint256(0);\n            a;\n        }", "highlightLines": [31]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721ReceiverMock.sol", "line": 31, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "3e56fb37fc00", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "        } else if (_error == Error.RevertWithoutMessage) {\n            revert();\n        } else if (_error == Error.Panic) {\n            uint256 a = uint256(0) / uint256(0);\n            a;\n        }", "highlightLines": [33]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721ReceiverMock.sol", "line": 33, "column": 16}, "severity": "medium", "references": [], "description": ""}, {"id": "a47f16ce275b", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint256 a = uint256(0) / uint256(0);", "highlightLines": [36]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721ReceiverMock.sol", "line": 36, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8f2431857dd2", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "            a;", "highlightLines": [37]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721ReceiverMock.sol", "line": 37, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "730477e3741f", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721RoyaltyMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "f3217d3a2553", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(string memory name, string memory symbol) ERC721(name, symbol) {}", "highlightLines": [8]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721RoyaltyMock.sol", "line": 8, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "91e3de7d45e1", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function setTokenRoyalty(\n        uint256 tokenId,\n        address recipient,\n        uint96 fraction\n    ) public {", "highlightLines": [10]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721RoyaltyMock.sol", "line": 10, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "5e277c1bc918", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function mint(address to, uint256 tokenId) public {", "highlightLines": [22]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721RoyaltyMock.sol", "line": 22, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "485bfbcdd976", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function mint(address to, uint256 tokenId) public {", "highlightLines": [22]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721RoyaltyMock.sol", "line": 22, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "61aaea9c27a9", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function mint(address to, uint256 tokenId) public {", "highlightLines": [22]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721RoyaltyMock.sol", "line": 22, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "c8c8e529918b", "fix": {"template": null, "available": false}, "title": "NFT mint without supply check - potential overflow in tokenId", "ruleId": "rules.sol-nft-overflow-mint", "snippet": {"code": "        _mint(to, tokenId);", "highlightLines": [23]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721RoyaltyMock.sol", "line": 23, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e682bcceebd7", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function burn(uint256 tokenId) public {", "highlightLines": [26]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721RoyaltyMock.sol", "line": 26, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "0538693f658f", "fix": {"template": null, "available": false}, "title": "Public burn function without access control - anyone can burn tokens", "ruleId": "rules.sol-erc20-public-burn", "snippet": {"code": "    function burn(uint256 tokenId) public {", "highlightLines": [26]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721RoyaltyMock.sol", "line": 26, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "faac9126f0e0", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function burn(uint256 tokenId) public {", "highlightLines": [26]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721RoyaltyMock.sol", "line": 26, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "18e9a0212ce9", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function burn(uint256 tokenId) public {", "highlightLines": [26]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721RoyaltyMock.sol", "line": 26, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "7398c97b1437", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721URIStorageMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "769fc9f73031", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "contract ERC721URIStorageMock is ERC721URIStorage {", "highlightLines": [11]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721URIStorageMock.sol", "line": 11, "column": 1}, "severity": "medium", "references": [], "description": ""}, {"id": "79a4467a3278", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract ERC721URIStorageMock is ERC721URIStorage {\n    string private _baseTokenURI;", "highlightLines": [11]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721URIStorageMock.sol", "line": 11, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "7716ddc18e29", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(string memory name, string memory symbol) ERC721(name, symbol) {}", "highlightLines": [14]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721URIStorageMock.sol", "line": 14, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "cff8a6483bbb", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function setTokenURI(uint256 tokenId, string memory _tokenURI) public {", "highlightLines": [28]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721URIStorageMock.sol", "line": 28, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "22b62311e771", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function exists(uint256 tokenId) public view returns (bool) {", "highlightLines": [32]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721URIStorageMock.sol", "line": 32, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "4ee5bbe116fa", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function mint(address to, uint256 tokenId) public {", "highlightLines": [36]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721URIStorageMock.sol", "line": 36, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "0b8b43680270", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function mint(address to, uint256 tokenId) public {", "highlightLines": [36]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721URIStorageMock.sol", "line": 36, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "067c0ad28671", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function mint(address to, uint256 tokenId) public {", "highlightLines": [36]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721URIStorageMock.sol", "line": 36, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "63f082df0658", "fix": {"template": null, "available": false}, "title": "NFT mint without supply check - potential overflow in tokenId", "ruleId": "rules.sol-nft-overflow-mint", "snippet": {"code": "        _mint(to, tokenId);", "highlightLines": [37]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721URIStorageMock.sol", "line": 37, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "40f4cc92a7b7", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function safeMint(address to, uint256 tokenId) public {", "highlightLines": [40]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721URIStorageMock.sol", "line": 40, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "64bbc020b85e", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function safeMint(\n        address to,\n        uint256 tokenId,\n        bytes memory _data\n    ) public {", "highlightLines": [44]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721URIStorageMock.sol", "line": 44, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "cec59e816aa7", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function burn(uint256 tokenId) public {", "highlightLines": [52]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721URIStorageMock.sol", "line": 52, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "5896bba98ecd", "fix": {"template": null, "available": false}, "title": "Public burn function without access control - anyone can burn tokens", "ruleId": "rules.sol-erc20-public-burn", "snippet": {"code": "    function burn(uint256 tokenId) public {", "highlightLines": [52]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721URIStorageMock.sol", "line": 52, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "8dede1fb020c", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function burn(uint256 tokenId) public {", "highlightLines": [52]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721URIStorageMock.sol", "line": 52, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "7be25856c070", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function burn(uint256 tokenId) public {", "highlightLines": [52]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721URIStorageMock.sol", "line": 52, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "fe323d49a072", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721VotesMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "ea7fd9e7592a", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(string memory name, string memory symbol) ERC721(name, symbol) EIP712(name, \"1\") {}", "highlightLines": [8]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721VotesMock.sol", "line": 8, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "0582879df928", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function mint(address account, uint256 tokenId) public {", "highlightLines": [14]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721VotesMock.sol", "line": 14, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "67a576c84d88", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function mint(address account, uint256 tokenId) public {", "highlightLines": [14]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721VotesMock.sol", "line": 14, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "6b42d6bfdd1f", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function mint(address account, uint256 tokenId) public {", "highlightLines": [14]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721VotesMock.sol", "line": 14, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "d88466479ef7", "fix": {"template": null, "available": false}, "title": "NFT mint without supply check - potential overflow in tokenId", "ruleId": "rules.sol-nft-overflow-mint", "snippet": {"code": "        _mint(account, tokenId);", "highlightLines": [15]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721VotesMock.sol", "line": 15, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "deb90fed5a94", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function burn(uint256 tokenId) public {", "highlightLines": [18]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721VotesMock.sol", "line": 18, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "1cf3edf34fa4", "fix": {"template": null, "available": false}, "title": "Public burn function without access control - anyone can burn tokens", "ruleId": "rules.sol-erc20-public-burn", "snippet": {"code": "    function burn(uint256 tokenId) public {", "highlightLines": [18]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721VotesMock.sol", "line": 18, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "0bfa5cd145aa", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function burn(uint256 tokenId) public {", "highlightLines": [18]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721VotesMock.sol", "line": 18, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "ff16ba08eba0", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function burn(uint256 tokenId) public {", "highlightLines": [18]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC721VotesMock.sol", "line": 18, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "ca5615d391af", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC777Mock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "3b96f44c70ee", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(\n        address initialHolder,\n        uint256 initialBalance,\n        string memory name,\n        string memory symbol,\n        address[] memory defaultOperators\n    ) ERC777(name, symbol, defaultOperators) {\n        _mint(initialHolder, initialBalance, \"\", \"\");\n    }", "highlightLines": [11]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC777Mock.sol", "line": 11, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "5ae6d4068d9b", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC777SenderRecipientMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "253aca335c18", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "contract ERC777SenderRecipientMock is Context, IERC777Sender, IERC777Recipient, ERC1820Implementer {", "highlightLines": [12]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC777SenderRecipientMock.sol", "line": 12, "column": 1}, "severity": "medium", "references": [], "description": ""}, {"id": "93fa4b1a7cd7", "fix": {"template": null, "available": false}, "title": "Base constructor called multiple times through diamond inheritance - may initialize twice", "ruleId": "rules.sol-reused-constructor", "snippet": {"code": "contract ERC777SenderRecipientMock is Context, IERC777Sender, IERC777Recipient, ERC1820Implementer {", "highlightLines": [12]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC777SenderRecipientMock.sol", "line": 12, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#reused-base-constructor"], "description": ""}, {"id": "e0accecc0b78", "fix": {"template": null, "available": false}, "title": "SWC-125: Multiple inheritance may cause incorrect function resolution - check C3 linearization", "ruleId": "rules.sol-swc-125-inheritance-order", "snippet": {"code": "contract ERC777SenderRecipientMock is Context, IERC777Sender, IERC777Recipient, ERC1820Implementer {", "highlightLines": [12]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC777SenderRecipientMock.sol", "line": 12, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-125"], "description": ""}, {"id": "92ed43188f2a", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract ERC777SenderRecipientMock is Context, IERC777Sender, IERC777Recipient, ERC1820Implementer {\n    event TokensToSendCalled(\n        address operator,\n        address from,\n        address to,\n        uint256 amount,\n        bytes data,\n        bytes operatorData,\n        address token,\n        uint256 fromBalance,\n        uint256 toBalance\n    );\n\n    event TokensReceivedCalled(\n        address operator,\n        address from,\n        address to,\n        uint256 amount,\n        bytes data,\n        bytes operatorData,\n        address token,\n        uint256 fromBalance,\n        uint256 toBalance\n    );\n\n    // Emitted in ERC777Mock. Here for easier decoding\n    event BeforeTokenTransfer();\n\n    bool private _shouldRevertSend;\n    bool private _shouldRevertReceive;", "highlightLines": [12]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC777SenderRecipientMock.sol", "line": 12, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "e864f61d34a7", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event TokensToSendCalled(\n        address operator,\n        address from,\n        address to,\n        uint256 amount,\n        bytes data,\n        bytes operatorData,\n        address token,\n        uint256 fromBalance,\n        uint256 toBalance\n    );", "highlightLines": [13]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC777SenderRecipientMock.sol", "line": 13, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "970e169b3fc6", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event TokensToSendCalled(\n        address operator,\n        address from,\n        address to,\n        uint256 amount,\n        bytes data,\n        bytes operatorData,\n        address token,\n        uint256 fromBalance,\n        uint256 toBalance\n    );", "highlightLines": [13]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC777SenderRecipientMock.sol", "line": 13, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "225c692538a5", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event TokensReceivedCalled(\n        address operator,\n        address from,\n        address to,\n        uint256 amount,\n        bytes data,\n        bytes operatorData,\n        address token,\n        uint256 fromBalance,\n        uint256 toBalance\n    );", "highlightLines": [25]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC777SenderRecipientMock.sol", "line": 25, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "402fe613416e", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event TokensReceivedCalled(\n        address operator,\n        address from,\n        address to,\n        uint256 amount,\n        bytes data,\n        bytes operatorData,\n        address token,\n        uint256 fromBalance,\n        uint256 toBalance\n    );", "highlightLines": [25]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC777SenderRecipientMock.sol", "line": 25, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "3e7a0be2aabf", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        IERC777 token = IERC777(_msgSender());\n\n        uint256 fromBalance = token.balanceOf(from);", "highlightLines": [60]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC777SenderRecipientMock.sol", "line": 60, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "8c4937dd1515", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 fromBalance = token.balanceOf(from);", "highlightLines": [61]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC777SenderRecipientMock.sol", "line": 61, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "474542e4cf06", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "        uint256 fromBalance = token.balanceOf(from);\n        // when called due to burn, to will be the zero address, which will have a balance of 0\n        uint256 toBalance = token.balanceOf(to);", "highlightLines": [62]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC777SenderRecipientMock.sol", "line": 62, "column": 9}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "46a6c5434c73", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 fromBalance = token.balanceOf(from);\n        // when called due to burn, to will be the zero address, which will have a balance of 0\n        uint256 toBalance = token.balanceOf(to);", "highlightLines": [62]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC777SenderRecipientMock.sol", "line": 62, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "07b655ee4883", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 toBalance = token.balanceOf(to);", "highlightLines": [64]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC777SenderRecipientMock.sol", "line": 64, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b42d85b692b2", "fix": {"template": null, "available": false}, "title": "Token callback function without reentrancy protection - ERC777/721/1155 callbacks can reenter", "ruleId": "rules.sol-callback-without-reentrancy-guard", "snippet": {"code": "    function tokensReceived(\n        address operator,\n        address from,\n        address to,\n        uint256 amount,\n        bytes calldata userData,\n        bytes calldata operatorData\n    ) external override {", "highlightLines": [79]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC777SenderRecipientMock.sol", "line": 79, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "216d2ae582c5", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        IERC777 token = IERC777(_msgSender());\n\n        uint256 fromBalance = token.balanceOf(from);", "highlightLines": [91]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC777SenderRecipientMock.sol", "line": 91, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "00a80d2e3703", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 fromBalance = token.balanceOf(from);", "highlightLines": [92]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC777SenderRecipientMock.sol", "line": 92, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "83dddd75fc54", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "        uint256 fromBalance = token.balanceOf(from);\n        // when called due to burn, to will be the zero address, which will have a balance of 0\n        uint256 toBalance = token.balanceOf(to);", "highlightLines": [93]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC777SenderRecipientMock.sol", "line": 93, "column": 9}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "480e27d61fc7", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 fromBalance = token.balanceOf(from);\n        // when called due to burn, to will be the zero address, which will have a balance of 0\n        uint256 toBalance = token.balanceOf(to);", "highlightLines": [93]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC777SenderRecipientMock.sol", "line": 93, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "c589592b4351", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 toBalance = token.balanceOf(to);", "highlightLines": [95]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC777SenderRecipientMock.sol", "line": 95, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d29c014e001f", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function senderFor(address account) public {\n        _registerInterfaceForAddress(_TOKENS_SENDER_INTERFACE_HASH, account);\n\n        address self = address(this);\n        if (account == self) {", "highlightLines": [110]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC777SenderRecipientMock.sol", "line": 110, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "15f4c54b419e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        address self = address(this);", "highlightLines": [112]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC777SenderRecipientMock.sol", "line": 112, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3846f85e8f2a", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "        if (account == self) {\n            registerSender(self);\n        }", "highlightLines": [114]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC777SenderRecipientMock.sol", "line": 114, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "8d7abd9007b0", "fix": {"template": null, "available": false}, "title": "ERC1820 registry hook registration - can enable reentrancy via token hooks", "ruleId": "rules.sol-erc1820-registry-hook", "snippet": {"code": "        _erc1820.setInterfaceImplementer(address(this), _TOKENS_SENDER_INTERFACE_HASH, sender);", "highlightLines": [120]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC777SenderRecipientMock.sol", "line": 120, "column": 18}, "severity": "medium", "references": [], "description": ""}, {"id": "8b2d383846be", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function recipientFor(address account) public {\n        _registerInterfaceForAddress(_TOKENS_RECIPIENT_INTERFACE_HASH, account);\n\n        address self = address(this);\n        if (account == self) {", "highlightLines": [123]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC777SenderRecipientMock.sol", "line": 123, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "eaae9e937dde", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        address self = address(this);", "highlightLines": [125]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC777SenderRecipientMock.sol", "line": 125, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a10d58f146a1", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "        if (account == self) {\n            registerRecipient(self);\n        }", "highlightLines": [127]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC777SenderRecipientMock.sol", "line": 127, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "adf6196b8a74", "fix": {"template": null, "available": false}, "title": "ERC1820 registry hook registration - can enable reentrancy via token hooks", "ruleId": "rules.sol-erc1820-registry-hook", "snippet": {"code": "        _erc1820.setInterfaceImplementer(address(this), _TOKENS_RECIPIENT_INTERFACE_HASH, recipient);", "highlightLines": [133]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC777SenderRecipientMock.sol", "line": 133, "column": 18}, "severity": "medium", "references": [], "description": ""}, {"id": "e7423f43bdbf", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function burn(\n        IERC777 token,\n        uint256 amount,\n        bytes memory data\n    ) public {", "highlightLines": [154]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC777SenderRecipientMock.sol", "line": 154, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "b74d83224f3e", "fix": {"template": null, "available": false}, "title": "Public burn function without access control - anyone can burn tokens", "ruleId": "rules.sol-erc20-public-burn", "snippet": {"code": "    function burn(\n        IERC777 token,\n        uint256 amount,\n        bytes memory data\n    ) public {", "highlightLines": [154]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC777SenderRecipientMock.sol", "line": 154, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "95750313307a", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function burn(\n        IERC777 token,\n        uint256 amount,\n        bytes memory data\n    ) public {", "highlightLines": [154]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC777SenderRecipientMock.sol", "line": 154, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "30c82cb7b887", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/EnumerableMapMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "bcd46197def3", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event OperationResult(bool result);", "highlightLines": [11]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/EnumerableMapMock.sol", "line": 11, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "0370a213fa82", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool result = _map.set(key, value);", "highlightLines": [20]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/EnumerableMapMock.sol", "line": 20, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "71aa10ed106a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool result = _map.remove(key);", "highlightLines": [25]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/EnumerableMapMock.sol", "line": 25, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "67f95105ae5a", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event OperationResult(bool result);", "highlightLines": [54]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/EnumerableMapMock.sol", "line": 54, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "8d6d89c07344", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool result = _map.set(key, value);", "highlightLines": [63]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/EnumerableMapMock.sol", "line": 63, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "1daf096db0b8", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool result = _map.remove(key);", "highlightLines": [68]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/EnumerableMapMock.sol", "line": 68, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "2c219a6a9773", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event OperationResult(bool result);", "highlightLines": [96]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/EnumerableMapMock.sol", "line": 96, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "a0ace96f4873", "fix": {"template": null, "available": false}, "title": "Storage write without access control - arbitrary data manipulation", "ruleId": "rules.sol-unprotected-storage-write", "snippet": {"code": "    function set(bytes32 key, bytes32 value) public {", "highlightLines": [104]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/EnumerableMapMock.sol", "line": 104, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "fe2062a795a1", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool result = _map.set(key, value);", "highlightLines": [105]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/EnumerableMapMock.sol", "line": 105, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b50554d26ebf", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool result = _map.remove(key);", "highlightLines": [110]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/EnumerableMapMock.sol", "line": 110, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8a8ef3cea583", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event OperationResult(bool result);", "highlightLines": [139]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/EnumerableMapMock.sol", "line": 139, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "8de2ac61435d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool result = _map.set(key, value);", "highlightLines": [148]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/EnumerableMapMock.sol", "line": 148, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "af63a799db50", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool result = _map.remove(key);", "highlightLines": [153]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/EnumerableMapMock.sol", "line": 153, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "555db05853e0", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event OperationResult(bool result);", "highlightLines": [182]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/EnumerableMapMock.sol", "line": 182, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "cacb28324b53", "fix": {"template": null, "available": false}, "title": "Storage write without access control - arbitrary data manipulation", "ruleId": "rules.sol-unprotected-storage-write", "snippet": {"code": "    function set(bytes32 key, uint256 value) public {", "highlightLines": [190]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/EnumerableMapMock.sol", "line": 190, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "5a2df8b5a291", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool result = _map.set(key, value);", "highlightLines": [191]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/EnumerableMapMock.sol", "line": 191, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8ac4bf99db40", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool result = _map.remove(key);", "highlightLines": [196]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/EnumerableMapMock.sol", "line": 196, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "43367686fbb2", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/EnumerableSetMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "9db9c51206be", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event OperationResult(bool result);", "highlightLines": [11]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/EnumerableSetMock.sol", "line": 11, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "af189322699c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool result = _set.add(value);", "highlightLines": [20]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/EnumerableSetMock.sol", "line": 20, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "bb3aa73cd623", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool result = _set.remove(value);", "highlightLines": [25]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/EnumerableSetMock.sol", "line": 25, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "389efd724914", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event OperationResult(bool result);", "highlightLines": [46]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/EnumerableSetMock.sol", "line": 46, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "e2fc0118015e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool result = _set.add(value);", "highlightLines": [55]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/EnumerableSetMock.sol", "line": 55, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "334e0a3dcbee", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool result = _set.remove(value);", "highlightLines": [60]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/EnumerableSetMock.sol", "line": 60, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "31e0ee51a934", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event OperationResult(bool result);", "highlightLines": [81]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/EnumerableSetMock.sol", "line": 81, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "3cc616cc8ae6", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool result = _set.add(value);", "highlightLines": [90]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/EnumerableSetMock.sol", "line": 90, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b7ab277c4597", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool result = _set.remove(value);", "highlightLines": [95]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/EnumerableSetMock.sol", "line": 95, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "afa69ba992e8", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/EtherReceiverMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "74411bf2783b", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    receive() external payable {", "highlightLines": [12]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/EtherReceiverMock.sol", "line": 12, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "db15f599e517", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorCompMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "5d21dc411906", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(string memory name_, ERC20VotesComp token_) Governor(name_) GovernorVotesComp(token_) {}", "highlightLines": [9]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorCompMock.sol", "line": 9, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "9a4b1dbfa8d6", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorCompatibilityBravoMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "b7806b15f3ca", "fix": {"template": null, "available": false}, "title": "Base constructor called multiple times through diamond inheritance - may initialize twice", "ruleId": "rules.sol-reused-constructor", "snippet": {"code": "contract GovernorCompatibilityBravoMock is\n    GovernorCompatibilityBravo,\n    GovernorSettings,\n    GovernorTimelockCompound,", "highlightLines": [10]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorCompatibilityBravoMock.sol", "line": 10, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#reused-base-constructor"], "description": ""}, {"id": "c91dc4f72998", "fix": {"template": null, "available": false}, "title": "SWC-125: Multiple inheritance may cause incorrect function resolution - check C3 linearization", "ruleId": "rules.sol-swc-125-inheritance-order", "snippet": {"code": "contract GovernorCompatibilityBravoMock is\n    GovernorCompatibilityBravo,\n    GovernorSettings,\n    GovernorTimelockCompound,", "highlightLines": [10]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorCompatibilityBravoMock.sol", "line": 10, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-125"], "description": ""}, {"id": "7343445d561d", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(\n        string memory name_,\n        ERC20VotesComp token_,\n        uint256 votingDelay_,\n        uint256 votingPeriod_,\n        uint256 proposalThreshold_,\n        ICompoundTimelock timelock_\n    )\n        Governor(name_)\n        GovernorTimelockCompound(timelock_)\n        GovernorSettings(votingDelay_, votingPeriod_, proposalThreshold_)\n        GovernorVotesComp(token_)\n    {}", "highlightLines": [16]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorCompatibilityBravoMock.sol", "line": 16, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "395ada7cc465", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "        override(IERC165, Governor, GovernorTimelockCompound)", "highlightLines": [34]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorCompatibilityBravoMock.sol", "line": 34, "column": 27}, "severity": "info", "references": [], "description": ""}, {"id": "d1594ab7bcbe", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "        override(IGovernor, Governor, GovernorTimelockCompound)", "highlightLines": [48]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorCompatibilityBravoMock.sol", "line": 48, "column": 29}, "severity": "info", "references": [], "description": ""}, {"id": "d09f5d5202f8", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "        override(IGovernorTimelock, GovernorTimelockCompound)", "highlightLines": [58]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorCompatibilityBravoMock.sol", "line": 58, "column": 19}, "severity": "info", "references": [], "description": ""}, {"id": "c6e16b1ed250", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "    function proposalThreshold() public view override(Governor, GovernorSettings) returns (uint256) {", "highlightLines": [64]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorCompatibilityBravoMock.sol", "line": 64, "column": 55}, "severity": "info", "references": [], "description": ""}, {"id": "131cbb32d412", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "    ) public virtual override(IGovernor, Governor, GovernorCompatibilityBravo) returns (uint256) {", "highlightLines": [73]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorCompatibilityBravoMock.sol", "line": 73, "column": 42}, "severity": "info", "references": [], "description": ""}, {"id": "c8233d0a4363", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "    ) public virtual override(IGovernorTimelock, GovernorTimelockCompound) returns (uint256) {", "highlightLines": [82]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorCompatibilityBravoMock.sol", "line": 82, "column": 32}, "severity": "info", "references": [], "description": ""}, {"id": "cee2d59d6b34", "fix": {"template": null, "available": false}, "title": "Governance proposal execution without quorum validation", "ruleId": "rules.sol-governance-no-quorum-check", "snippet": {"code": "        return super.execute(targets, values, calldatas, salt);", "highlightLines": [92]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorCompatibilityBravoMock.sol", "line": 92, "column": 16}, "severity": "medium", "references": [], "description": ""}, {"id": "c463e9768335", "fix": {"template": null, "available": false}, "title": "Storage array passed by value to internal function - changes won't persist", "ruleId": "rules.sol-array-by-reference", "snippet": {"code": "    function _execute(\n        uint256 proposalId,\n        address[] memory targets,\n        uint256[] memory values,\n        bytes[] memory calldatas,\n        bytes32 descriptionHash\n    ) internal virtual override(Governor, GovernorTimelockCompound) {", "highlightLines": [95]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorCompatibilityBravoMock.sol", "line": 95, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#modifying-storage-array-by-value"], "description": ""}, {"id": "f82f9f1719e2", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "    ) internal virtual override(Governor, GovernorTimelockCompound) {", "highlightLines": [101]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorCompatibilityBravoMock.sol", "line": 101, "column": 33}, "severity": "info", "references": [], "description": ""}, {"id": "01fdf97a91f6", "fix": {"template": null, "available": false}, "title": "Storage array passed by value to internal function - changes won't persist", "ruleId": "rules.sol-array-by-reference", "snippet": {"code": "    function _cancel(\n        address[] memory targets,\n        uint256[] memory values,\n        bytes[] memory calldatas,\n        bytes32 salt\n    ) internal virtual override(Governor, GovernorTimelockCompound) returns (uint256 proposalId) {", "highlightLines": [118]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorCompatibilityBravoMock.sol", "line": 118, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#modifying-storage-array-by-value"], "description": ""}, {"id": "4063de6c554f", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "    ) internal virtual override(Governor, GovernorTimelockCompound) returns (uint256 proposalId) {", "highlightLines": [123]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorCompatibilityBravoMock.sol", "line": 123, "column": 33}, "severity": "info", "references": [], "description": ""}, {"id": "a83ee11eee35", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "    function _executor() internal view virtual override(Governor, GovernorTimelockCompound) returns (address) {", "highlightLines": [127]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorCompatibilityBravoMock.sol", "line": 127, "column": 57}, "severity": "info", "references": [], "description": ""}, {"id": "17db210ff692", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "033566eab450", "fix": {"template": null, "available": false}, "title": "Base constructor called multiple times through diamond inheritance - may initialize twice", "ruleId": "rules.sol-reused-constructor", "snippet": {"code": "contract GovernorMock is\n    GovernorProposalThreshold,\n    GovernorSettings,\n    GovernorVotesQuorumFraction,", "highlightLines": [10]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorMock.sol", "line": 10, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#reused-base-constructor"], "description": ""}, {"id": "b98cba3506a3", "fix": {"template": null, "available": false}, "title": "SWC-125: Multiple inheritance may cause incorrect function resolution - check C3 linearization", "ruleId": "rules.sol-swc-125-inheritance-order", "snippet": {"code": "contract GovernorMock is\n    GovernorProposalThreshold,\n    GovernorSettings,\n    GovernorVotesQuorumFraction,", "highlightLines": [10]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorMock.sol", "line": 10, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-125"], "description": ""}, {"id": "5ae40b159a1c", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(\n        string memory name_,\n        IVotes token_,\n        uint256 votingDelay_,\n        uint256 votingPeriod_,\n        uint256 quorumNumerator_\n    )\n        Governor(name_)\n        GovernorSettings(votingDelay_, votingPeriod_, 0)\n        GovernorVotes(token_)\n        GovernorVotesQuorumFraction(quorumNumerator_)\n    {}", "highlightLines": [16]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorMock.sol", "line": 16, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "2aadce93a879", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "    function proposalThreshold() public view override(Governor, GovernorSettings) returns (uint256) {", "highlightLines": [38]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorMock.sol", "line": 38, "column": 55}, "severity": "info", "references": [], "description": ""}, {"id": "e88733ee6871", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "    ) public virtual override(Governor, GovernorProposalThreshold) returns (uint256) {", "highlightLines": [47]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorMock.sol", "line": 47, "column": 31}, "severity": "info", "references": [], "description": ""}, {"id": "d8a5e3f44bd2", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorPreventLateQuorumMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "a1c4af5463a8", "fix": {"template": null, "available": false}, "title": "Base constructor called multiple times through diamond inheritance - may initialize twice", "ruleId": "rules.sol-reused-constructor", "snippet": {"code": "contract GovernorPreventLateQuorumMock is\n    GovernorSettings,\n    GovernorVotes,\n    GovernorCountingSimple,", "highlightLines": [10]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorPreventLateQuorumMock.sol", "line": 10, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#reused-base-constructor"], "description": ""}, {"id": "11d7b70610a9", "fix": {"template": null, "available": false}, "title": "SWC-125: Multiple inheritance may cause incorrect function resolution - check C3 linearization", "ruleId": "rules.sol-swc-125-inheritance-order", "snippet": {"code": "contract GovernorPreventLateQuorumMock is\n    GovernorSettings,\n    GovernorVotes,\n    GovernorCountingSimple,", "highlightLines": [10]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorPreventLateQuorumMock.sol", "line": 10, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-125"], "description": ""}, {"id": "1b0e673caf53", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract GovernorPreventLateQuorumMock is\n    GovernorSettings,\n    GovernorVotes,\n    GovernorCountingSimple,\n    GovernorPreventLateQuorum\n{\n    uint256 private _quorum;", "highlightLines": [10]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorPreventLateQuorumMock.sol", "line": 10, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "29b9a7949c56", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(\n        string memory name_,\n        IVotes token_,\n        uint256 votingDelay_,\n        uint256 votingPeriod_,\n        uint256 quorum_,\n        uint64 voteExtension_\n    )\n        Governor(name_)\n        GovernorSettings(votingDelay_, votingPeriod_, 0)\n        GovernorVotes(token_)\n        GovernorPreventLateQuorum(voteExtension_)\n    {\n        _quorum = quorum_;\n    }", "highlightLines": [18]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorPreventLateQuorumMock.sol", "line": 18, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "caf4efdf98de", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "        override(Governor, GovernorPreventLateQuorum)", "highlightLines": [42]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorPreventLateQuorumMock.sol", "line": 42, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "f86666778dd8", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "    function proposalThreshold() public view virtual override(Governor, GovernorSettings) returns (uint256) {", "highlightLines": [48]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorPreventLateQuorumMock.sol", "line": 48, "column": 63}, "severity": "info", "references": [], "description": ""}, {"id": "988c5ab40762", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "    ) internal virtual override(Governor, GovernorPreventLateQuorum) returns (uint256) {", "highlightLines": [58]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorPreventLateQuorumMock.sol", "line": 58, "column": 33}, "severity": "info", "references": [], "description": ""}, {"id": "372815017de1", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorTimelockCompoundMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "1dc72b2bd3a4", "fix": {"template": null, "available": false}, "title": "Base constructor called multiple times through diamond inheritance - may initialize twice", "ruleId": "rules.sol-reused-constructor", "snippet": {"code": "contract GovernorTimelockCompoundMock is\n    GovernorSettings,\n    GovernorTimelockCompound,\n    GovernorVotesQuorumFraction,", "highlightLines": [10]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorTimelockCompoundMock.sol", "line": 10, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#reused-base-constructor"], "description": ""}, {"id": "de2ed6239fc0", "fix": {"template": null, "available": false}, "title": "SWC-125: Multiple inheritance may cause incorrect function resolution - check C3 linearization", "ruleId": "rules.sol-swc-125-inheritance-order", "snippet": {"code": "contract GovernorTimelockCompoundMock is\n    GovernorSettings,\n    GovernorTimelockCompound,\n    GovernorVotesQuorumFraction,", "highlightLines": [10]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorTimelockCompoundMock.sol", "line": 10, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-125"], "description": ""}, {"id": "caffea1810e6", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(\n        string memory name_,\n        IVotes token_,\n        uint256 votingDelay_,\n        uint256 votingPeriod_,\n        ICompoundTimelock timelock_,\n        uint256 quorumNumerator_\n    )\n        Governor(name_)\n        GovernorTimelockCompound(timelock_)\n        GovernorSettings(votingDelay_, votingPeriod_, 0)\n        GovernorVotes(token_)\n        GovernorVotesQuorumFraction(quorumNumerator_)\n    {}", "highlightLines": [16]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorTimelockCompoundMock.sol", "line": 16, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "de8043ae2544", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "        override(Governor, GovernorTimelockCompound)", "highlightLines": [35]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorTimelockCompoundMock.sol", "line": 35, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "be5e251d653d", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "        override(IGovernor, GovernorVotesQuorumFraction)", "highlightLines": [44]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorTimelockCompoundMock.sol", "line": 44, "column": 19}, "severity": "info", "references": [], "description": ""}, {"id": "b95994ce1e1d", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "        override(Governor, GovernorTimelockCompound)", "highlightLines": [66]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorTimelockCompoundMock.sol", "line": 66, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "6dd14256ae72", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "    function proposalThreshold() public view override(Governor, GovernorSettings) returns (uint256) {", "highlightLines": [72]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorTimelockCompoundMock.sol", "line": 72, "column": 55}, "severity": "info", "references": [], "description": ""}, {"id": "5220b42139f1", "fix": {"template": null, "available": false}, "title": "Storage array passed by value to internal function - changes won't persist", "ruleId": "rules.sol-array-by-reference", "snippet": {"code": "    function _execute(\n        uint256 proposalId,\n        address[] memory targets,\n        uint256[] memory values,\n        bytes[] memory calldatas,\n        bytes32 descriptionHash\n    ) internal virtual override(Governor, GovernorTimelockCompound) {", "highlightLines": [76]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorTimelockCompoundMock.sol", "line": 76, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#modifying-storage-array-by-value"], "description": ""}, {"id": "3e02fe8e05d2", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "    ) internal virtual override(Governor, GovernorTimelockCompound) {", "highlightLines": [82]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorTimelockCompoundMock.sol", "line": 82, "column": 33}, "severity": "info", "references": [], "description": ""}, {"id": "5759a9e4a266", "fix": {"template": null, "available": false}, "title": "Storage array passed by value to internal function - changes won't persist", "ruleId": "rules.sol-array-by-reference", "snippet": {"code": "    function _cancel(\n        address[] memory targets,\n        uint256[] memory values,\n        bytes[] memory calldatas,\n        bytes32 salt\n    ) internal virtual override(Governor, GovernorTimelockCompound) returns (uint256 proposalId) {", "highlightLines": [86]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorTimelockCompoundMock.sol", "line": 86, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#modifying-storage-array-by-value"], "description": ""}, {"id": "2588c6a155d8", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "    ) internal virtual override(Governor, GovernorTimelockCompound) returns (uint256 proposalId) {", "highlightLines": [91]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorTimelockCompoundMock.sol", "line": 91, "column": 33}, "severity": "info", "references": [], "description": ""}, {"id": "ba89b2eca914", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "    function _executor() internal view virtual override(Governor, GovernorTimelockCompound) returns (address) {", "highlightLines": [95]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorTimelockCompoundMock.sol", "line": 95, "column": 57}, "severity": "info", "references": [], "description": ""}, {"id": "2be6abb95efe", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorTimelockControlMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "043f703bb3bd", "fix": {"template": null, "available": false}, "title": "Base constructor called multiple times through diamond inheritance - may initialize twice", "ruleId": "rules.sol-reused-constructor", "snippet": {"code": "contract GovernorTimelockControlMock is\n    GovernorSettings,\n    GovernorTimelockControl,\n    GovernorVotesQuorumFraction,", "highlightLines": [10]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorTimelockControlMock.sol", "line": 10, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#reused-base-constructor"], "description": ""}, {"id": "7602bb02ab1c", "fix": {"template": null, "available": false}, "title": "SWC-125: Multiple inheritance may cause incorrect function resolution - check C3 linearization", "ruleId": "rules.sol-swc-125-inheritance-order", "snippet": {"code": "contract GovernorTimelockControlMock is\n    GovernorSettings,\n    GovernorTimelockControl,\n    GovernorVotesQuorumFraction,", "highlightLines": [10]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorTimelockControlMock.sol", "line": 10, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-125"], "description": ""}, {"id": "97ecd454eeb8", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(\n        string memory name_,\n        IVotes token_,\n        uint256 votingDelay_,\n        uint256 votingPeriod_,\n        TimelockController timelock_,\n        uint256 quorumNumerator_\n    )\n        Governor(name_)\n        GovernorTimelockControl(timelock_)\n        GovernorSettings(votingDelay_, votingPeriod_, 0)\n        GovernorVotes(token_)\n        GovernorVotesQuorumFraction(quorumNumerator_)\n    {}", "highlightLines": [16]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorTimelockControlMock.sol", "line": 16, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "d69132e39c01", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "        override(Governor, GovernorTimelockControl)", "highlightLines": [35]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorTimelockControlMock.sol", "line": 35, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "e32515553b9a", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "        override(IGovernor, GovernorVotesQuorumFraction)", "highlightLines": [44]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorTimelockControlMock.sol", "line": 44, "column": 19}, "severity": "info", "references": [], "description": ""}, {"id": "43405e4c002e", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "        override(Governor, GovernorTimelockControl)", "highlightLines": [66]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorTimelockControlMock.sol", "line": 66, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "b8a44488dfcb", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "    function proposalThreshold() public view override(Governor, GovernorSettings) returns (uint256) {", "highlightLines": [72]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorTimelockControlMock.sol", "line": 72, "column": 55}, "severity": "info", "references": [], "description": ""}, {"id": "9cdb366f2910", "fix": {"template": null, "available": false}, "title": "Storage array passed by value to internal function - changes won't persist", "ruleId": "rules.sol-array-by-reference", "snippet": {"code": "    function _execute(\n        uint256 proposalId,\n        address[] memory targets,\n        uint256[] memory values,\n        bytes[] memory calldatas,\n        bytes32 descriptionHash\n    ) internal virtual override(Governor, GovernorTimelockControl) {", "highlightLines": [76]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorTimelockControlMock.sol", "line": 76, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#modifying-storage-array-by-value"], "description": ""}, {"id": "bc49c4c000e1", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "    ) internal virtual override(Governor, GovernorTimelockControl) {", "highlightLines": [82]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorTimelockControlMock.sol", "line": 82, "column": 33}, "severity": "info", "references": [], "description": ""}, {"id": "a80f0b1e7700", "fix": {"template": null, "available": false}, "title": "Storage array passed by value to internal function - changes won't persist", "ruleId": "rules.sol-array-by-reference", "snippet": {"code": "    function _cancel(\n        address[] memory targets,\n        uint256[] memory values,\n        bytes[] memory calldatas,\n        bytes32 descriptionHash\n    ) internal virtual override(Governor, GovernorTimelockControl) returns (uint256 proposalId) {", "highlightLines": [86]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorTimelockControlMock.sol", "line": 86, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#modifying-storage-array-by-value"], "description": ""}, {"id": "2d0a80eafdb4", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "    ) internal virtual override(Governor, GovernorTimelockControl) returns (uint256 proposalId) {", "highlightLines": [91]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorTimelockControlMock.sol", "line": 91, "column": 33}, "severity": "info", "references": [], "description": ""}, {"id": "e0bbc88a2a82", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "    function _executor() internal view virtual override(Governor, GovernorTimelockControl) returns (address) {", "highlightLines": [95]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorTimelockControlMock.sol", "line": 95, "column": 57}, "severity": "info", "references": [], "description": ""}, {"id": "f3ee5e8ac980", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorVoteMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "de8d47ea27d7", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(string memory name_, IVotes token_) Governor(name_) GovernorVotes(token_) {}", "highlightLines": [9]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorVoteMock.sol", "line": 9, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "f082eb630fa7", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorWithParamsMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "9a1e4bc21b40", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event CountParams(uint256 uintParam, string strParam);", "highlightLines": [9]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorWithParamsMock.sol", "line": 9, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "2b2ea2209384", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(string memory name_, IVotes token_) Governor(name_) GovernorVotes(token_) {}", "highlightLines": [11]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorWithParamsMock.sol", "line": 11, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "cd611b4669f3", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function _getVotes(\n        address account,\n        uint256 blockNumber,\n        bytes memory params\n    ) internal view virtual override(Governor, GovernorVotes) returns (uint256) {\n        uint256 reduction = 0;", "highlightLines": [25]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorWithParamsMock.sol", "line": 25, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "baa72ebf12ad", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "    ) internal view virtual override(Governor, GovernorVotes) returns (uint256) {", "highlightLines": [29]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorWithParamsMock.sol", "line": 29, "column": 38}, "severity": "info", "references": [], "description": ""}, {"id": "945529a8bd55", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 reduction = 0;", "highlightLines": [30]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorWithParamsMock.sol", "line": 30, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "9d42202a08de", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 reduction = 0;\n        // If the user provides parameters, we reduce the voting weight by the amount of the integer param\n        if (params.length > 0) {\n            (reduction, ) = abi.decode(params, (uint256, string));\n        }", "highlightLines": [30]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorWithParamsMock.sol", "line": 30, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "803a3dd6bde3", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "    ) internal virtual override(Governor, GovernorCountingSimple) {", "highlightLines": [45]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/GovernorWithParamsMock.sol", "line": 45, "column": 33}, "severity": "info", "references": [], "description": ""}, {"id": "178129b52ba6", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/InitializableMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "5590ff27cf3a", "fix": {"template": null, "available": false}, "title": "Upgradeable contract without storage gap - future upgrade collision risk", "ruleId": "rules.sol-no-gap-storage", "snippet": {"code": "contract InitializableMock is Initializable {", "highlightLines": [11]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/InitializableMock.sol", "line": 11, "column": 1}, "severity": "info", "references": ["https://docs.openzeppelin.com/contracts/4.x/upgradeable#storage_gaps"], "description": ""}, {"id": "1a090dbe4f22", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract InitializableMock is Initializable {\n    bool public initializerRan;\n    bool public onlyInitializingRan;\n    uint256 public x;", "highlightLines": [11]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/InitializableMock.sol", "line": 11, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "20b805618e20", "fix": {"template": null, "available": false}, "title": "Initializer function not protected - can be called multiple times", "ruleId": "rules.sol-initializer-not-protected", "snippet": {"code": "    function initialize() public initializer {", "highlightLines": [16]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/InitializableMock.sol", "line": 16, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "dc6bcc47ee97", "fix": {"template": null, "available": false}, "title": "Initializer function not protected - can be called multiple times", "ruleId": "rules.sol-initializer-not-protected", "snippet": {"code": "    function initializeOnlyInitializing() public onlyInitializing {", "highlightLines": [20]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/InitializableMock.sol", "line": 20, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "c57b446502d4", "fix": {"template": null, "available": false}, "title": "Initializer function not protected - can be called multiple times", "ruleId": "rules.sol-initializer-not-protected", "snippet": {"code": "    function initializerNested() public initializer {", "highlightLines": [24]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/InitializableMock.sol", "line": 24, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "ddaa007b3529", "fix": {"template": null, "available": false}, "title": "Initializer function not protected - can be called multiple times", "ruleId": "rules.sol-initializer-not-protected", "snippet": {"code": "    function initializeWithX(uint256 _x) public payable initializer {", "highlightLines": [32]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/InitializableMock.sol", "line": 32, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "bd5eb05dec16", "fix": {"template": null, "available": false}, "title": "Upgradeable contract without storage gap - future upgrade collision risk", "ruleId": "rules.sol-no-gap-storage", "snippet": {"code": "contract ConstructorInitializableMock is Initializable {", "highlightLines": [45]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/InitializableMock.sol", "line": 45, "column": 1}, "severity": "info", "references": ["https://docs.openzeppelin.com/contracts/4.x/upgradeable#storage_gaps"], "description": ""}, {"id": "21918940b02f", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract ConstructorInitializableMock is Initializable {\n    bool public initializerRan;\n    bool public onlyInitializingRan;", "highlightLines": [45]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/InitializableMock.sol", "line": 45, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "b8a1f492cf15", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor() initializer {\n        initialize();\n        initializeOnlyInitializing();\n    }", "highlightLines": [49]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/InitializableMock.sol", "line": 49, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "634288cfe99a", "fix": {"template": null, "available": false}, "title": "Initializer function not protected - can be called multiple times", "ruleId": "rules.sol-initializer-not-protected", "snippet": {"code": "    function initialize() public initializer {", "highlightLines": [54]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/InitializableMock.sol", "line": 54, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "53fb31214fab", "fix": {"template": null, "available": false}, "title": "Initializer function not protected - can be called multiple times", "ruleId": "rules.sol-initializer-not-protected", "snippet": {"code": "    function initializeOnlyInitializing() public onlyInitializing {", "highlightLines": [58]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/InitializableMock.sol", "line": 58, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "9781379ebd4c", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract ChildConstructorInitializableMock is ConstructorInitializableMock {\n    bool public childInitializerRan;", "highlightLines": [63]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/InitializableMock.sol", "line": 63, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "b19f1218f3ba", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor() initializer {\n        childInitialize();\n    }", "highlightLines": [66]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/InitializableMock.sol", "line": 66, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "8cb34f6dc89d", "fix": {"template": null, "available": false}, "title": "Upgradeable contract without storage gap - future upgrade collision risk", "ruleId": "rules.sol-no-gap-storage", "snippet": {"code": "contract ReinitializerMock is Initializable {", "highlightLines": [75]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/InitializableMock.sol", "line": 75, "column": 1}, "severity": "info", "references": ["https://docs.openzeppelin.com/contracts/4.x/upgradeable#storage_gaps"], "description": ""}, {"id": "79ab1e1a2ef9", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract ReinitializerMock is Initializable {\n    uint256 public counter;", "highlightLines": [75]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/InitializableMock.sol", "line": 75, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "d5b1421c38f0", "fix": {"template": null, "available": false}, "title": "Initializer function not protected - can be called multiple times", "ruleId": "rules.sol-initializer-not-protected", "snippet": {"code": "    function initialize() public initializer {", "highlightLines": [78]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/InitializableMock.sol", "line": 78, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "0e30a6406d88", "fix": {"template": null, "available": false}, "title": "Upgradeable contract without storage gap - future upgrade collision risk", "ruleId": "rules.sol-no-gap-storage", "snippet": {"code": "contract DisableNew is Initializable {", "highlightLines": [104]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/InitializableMock.sol", "line": 104, "column": 1}, "severity": "info", "references": ["https://docs.openzeppelin.com/contracts/4.x/upgradeable#storage_gaps"], "description": ""}, {"id": "0f7e26618a95", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor() {\n        _disableInitializers();\n    }", "highlightLines": [105]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/InitializableMock.sol", "line": 105, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "dd436e483950", "fix": {"template": null, "available": false}, "title": "Upgradeable contract without storage gap - future upgrade collision risk", "ruleId": "rules.sol-no-gap-storage", "snippet": {"code": "contract DisableOld is Initializable {", "highlightLines": [110]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/InitializableMock.sol", "line": 110, "column": 1}, "severity": "info", "references": ["https://docs.openzeppelin.com/contracts/4.x/upgradeable#storage_gaps"], "description": ""}, {"id": "aeacedb2a0f4", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor() initializer {}", "highlightLines": [111]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/InitializableMock.sol", "line": 111, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "9532b25363ae", "fix": {"template": null, "available": false}, "title": "Empty constructor or constructor with no effect - may indicate incomplete implementation", "ruleId": "rules.sol-void-constructor", "snippet": {"code": "    constructor() initializer {}", "highlightLines": [111]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/InitializableMock.sol", "line": 111, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "15ae446db99b", "fix": {"template": null, "available": false}, "title": "Upgradeable contract without storage gap - future upgrade collision risk", "ruleId": "rules.sol-no-gap-storage", "snippet": {"code": "contract DisableBad2 is Initializable {", "highlightLines": [116]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/InitializableMock.sol", "line": 116, "column": 1}, "severity": "info", "references": ["https://docs.openzeppelin.com/contracts/4.x/upgradeable#storage_gaps"], "description": ""}, {"id": "0faabb4810db", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor() initializer {\n        _disableInitializers();\n    }", "highlightLines": [117]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/InitializableMock.sol", "line": 117, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "cb33fb8fb1d9", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/MathMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "ef4994858baf", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/MerkleProofWrapper.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "50db54aebce6", "fix": {"template": null, "available": false}, "title": "Merkle proof verification without double-hashing leaf - vulnerable to second preimage attack", "ruleId": "rules.sol-ethernaut-merkle-proof-without-leaf-hash", "snippet": {"code": "        return MerkleProof.verify(proof, root, leaf);", "highlightLines": [13]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/MerkleProofWrapper.sol", "line": 13, "column": 16}, "severity": "high", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/utils/cryptography/MerkleProof.sol"], "description": ""}, {"id": "eaf08b04c261", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/MulticallTest.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "67e0d98bc2b7", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes[] memory calls = new bytes[](recipients.length);\n        for (uint256 i = 0; i < recipients.length; i++) {\n            calls[i] = abi.encodeWithSignature(\"transfer(address,uint256)\", recipients[i], amounts[i]);\n        }", "highlightLines": [13]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/MulticallTest.sol", "line": 13, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "a71ae1c6ddfa", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        bytes[] memory calls = new bytes[](recipients.length);", "highlightLines": [13]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/MulticallTest.sol", "line": 13, "column": 32}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "460092194c1f", "fix": {"template": null, "available": false}, "title": "Storage variable modified in loop - should cache in memory for gas savings", "ruleId": "rules.sol-memory-vs-storage-loop", "snippet": {"code": "        for (uint256 i = 0; i < recipients.length; i++) {\n            calls[i] = abi.encodeWithSignature(\"transfer(address,uint256)\", recipients[i], amounts[i]);", "highlightLines": [14]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/MulticallTest.sol", "line": 14, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "d149e4937cf8", "fix": {"template": null, "available": false}, "title": "Unbounded loop iterating over dynamic array - can cause out-of-gas DoS", "ruleId": "rules.sol-unbounded-loop-dos", "snippet": {"code": "        for (uint256 i = 0; i < recipients.length; i++) {\n            calls[i] = abi.encodeWithSignature(\"transfer(address,uint256)\", recipients[i], amounts[i]);", "highlightLines": [14]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/MulticallTest.sol", "line": 14, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "50a87a859960", "fix": {"template": null, "available": false}, "title": "Unbounded loop over dynamic array - can cause DoS if array grows large", "ruleId": "rules.sol-unbounded-protocol-loop", "snippet": {"code": "        for (uint256 i = 0; i < recipients.length; i++) {\n            calls[i] = abi.encodeWithSignature(\"transfer(address,uint256)\", recipients[i], amounts[i]);", "highlightLines": [14]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/MulticallTest.sol", "line": 14, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d5eedcc857e4", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "            require(abi.decode(results[i], (bool)));", "highlightLines": [20]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/MulticallTest.sol", "line": 20, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "dbf590354597", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/MulticallTokenMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "7aba8c9aadeb", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(uint256 initialBalance) ERC20Mock(\"MulticallToken\", \"BCT\", msg.sender, initialBalance) {}", "highlightLines": [9]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/MulticallTokenMock.sol", "line": 9, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "796236e75445", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/MultipleInheritanceInitializableMocks.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "b520e9d7801a", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": " * Sample base intializable contract that is a human\n */\ncontract SampleHuman is Initializable {\n    bool public isHuman;", "highlightLines": [19]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/MultipleInheritanceInitializableMocks.sol", "line": 19, "column": 29}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "c4837444babe", "fix": {"template": null, "available": false}, "title": "Upgradeable contract without storage gap - future upgrade collision risk", "ruleId": "rules.sol-no-gap-storage", "snippet": {"code": "contract SampleHuman is Initializable {", "highlightLines": [21]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/MultipleInheritanceInitializableMocks.sol", "line": 21, "column": 1}, "severity": "info", "references": ["https://docs.openzeppelin.com/contracts/4.x/upgradeable#storage_gaps"], "description": ""}, {"id": "9e6b314e72d0", "fix": {"template": null, "available": false}, "title": "Initializer function not protected - can be called multiple times", "ruleId": "rules.sol-initializer-not-protected", "snippet": {"code": "    function initialize() public initializer {", "highlightLines": [24]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/MultipleInheritanceInitializableMocks.sol", "line": 24, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "42217fe7e62c", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract SampleMother is Initializable, SampleHuman {\n    uint256 public mother;", "highlightLines": [42]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/MultipleInheritanceInitializableMocks.sol", "line": 42, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "2166323785fb", "fix": {"template": null, "available": false}, "title": "Initializer function not protected - can be called multiple times", "ruleId": "rules.sol-initializer-not-protected", "snippet": {"code": "    function initialize(uint256 value) public virtual initializer {", "highlightLines": [45]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/MultipleInheritanceInitializableMocks.sol", "line": 45, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "e2702553e9fc", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract SampleGramps is Initializable, SampleHuman {\n    string public gramps;", "highlightLines": [64]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/MultipleInheritanceInitializableMocks.sol", "line": 64, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "64cddbe3fd03", "fix": {"template": null, "available": false}, "title": "Initializer function not protected - can be called multiple times", "ruleId": "rules.sol-initializer-not-protected", "snippet": {"code": "    function initialize(string memory value) public virtual initializer {", "highlightLines": [67]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/MultipleInheritanceInitializableMocks.sol", "line": 67, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "72a3fc127afe", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract SampleFather is Initializable, SampleGramps {\n    uint256 public father;", "highlightLines": [86]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/MultipleInheritanceInitializableMocks.sol", "line": 86, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "47ba38c47e30", "fix": {"template": null, "available": false}, "title": "Initializer function not protected - can be called multiple times", "ruleId": "rules.sol-initializer-not-protected", "snippet": {"code": "    function initialize(string memory _gramps, uint256 _father) public initializer {", "highlightLines": [89]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/MultipleInheritanceInitializableMocks.sol", "line": 89, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "2950ffe3bfec", "fix": {"template": null, "available": false}, "title": "Base constructor called multiple times through diamond inheritance - may initialize twice", "ruleId": "rules.sol-reused-constructor", "snippet": {"code": "contract SampleChild is Initializable, SampleMother, SampleFather {", "highlightLines": [108]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/MultipleInheritanceInitializableMocks.sol", "line": 108, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#reused-base-constructor"], "description": ""}, {"id": "5710803f2049", "fix": {"template": null, "available": false}, "title": "SWC-125: Multiple inheritance may cause incorrect function resolution - check C3 linearization", "ruleId": "rules.sol-swc-125-inheritance-order", "snippet": {"code": "contract SampleChild is Initializable, SampleMother, SampleFather {", "highlightLines": [108]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/MultipleInheritanceInitializableMocks.sol", "line": 108, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-125"], "description": ""}, {"id": "8931e38ee817", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract SampleChild is Initializable, SampleMother, SampleFather {\n    uint256 public child;", "highlightLines": [108]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/MultipleInheritanceInitializableMocks.sol", "line": 108, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "5ceab064bbc5", "fix": {"template": null, "available": false}, "title": "Initializer function not protected - can be called multiple times", "ruleId": "rules.sol-initializer-not-protected", "snippet": {"code": "    function initialize(\n        uint256 _mother,\n        string memory _gramps,\n        uint256 _father,\n        uint256 _child\n    ) public initializer {", "highlightLines": [111]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/MultipleInheritanceInitializableMocks.sol", "line": 111, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "db46bef76c46", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/OwnableMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "a43a467ff3f2", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/PausableMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "1ff70166fefc", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract PausableMock is Pausable {\n    bool public drasticMeasureTaken;\n    uint256 public count;", "highlightLines": [7]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/PausableMock.sol", "line": 7, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "19a755fd01f7", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor() {\n        drasticMeasureTaken = false;\n        count = 0;\n    }", "highlightLines": [11]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/PausableMock.sol", "line": 11, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "3f6133a3b48a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        drasticMeasureTaken = false;\n        count = 0;", "highlightLines": [12]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/PausableMock.sol", "line": 12, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "def3731e2b97", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function pause() external {", "highlightLines": [24]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/PausableMock.sol", "line": 24, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "f03689dc675e", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function unpause() external {", "highlightLines": [28]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/PausableMock.sol", "line": 28, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "00ff93a7c83a", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/PullPaymentMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "e861b3925cd9", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor() payable {}", "highlightLines": [9]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/PullPaymentMock.sol", "line": 9, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "afb89b057845", "fix": {"template": null, "available": false}, "title": "Empty constructor or constructor with no effect - may indicate incomplete implementation", "ruleId": "rules.sol-void-constructor", "snippet": {"code": "    constructor() payable {}", "highlightLines": [9]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/PullPaymentMock.sol", "line": 9, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "88ca031358c8", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ReentrancyAttack.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "f0b189770bcb", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ReentrancyMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "9063927d4849", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract ReentrancyMock is ReentrancyGuard {\n    uint256 public counter;", "highlightLines": [8]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ReentrancyMock.sol", "line": 8, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "94490fdd3383", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor() {\n        counter = 0;\n    }", "highlightLines": [11]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ReentrancyMock.sol", "line": 11, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "e9368bbfb345", "fix": {"template": null, "available": false}, "title": "Callback handler doesn't update status - repeated callbacks possible", "ruleId": "rules.sol-callback-no-status-update", "snippet": {"code": "    function callback() external nonReentrant {", "highlightLines": [15]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ReentrancyMock.sol", "line": 15, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "42b7673bb6b0", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes4 func = bytes4(keccak256(\"callback()\"));", "highlightLines": [36]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ReentrancyMock.sol", "line": 36, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "73597cf1917a", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/RegressionImplementation.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "0ee8ed364e95", "fix": {"template": null, "available": false}, "title": "Upgradeable contract without storage gap - future upgrade collision risk", "ruleId": "rules.sol-no-gap-storage", "snippet": {"code": "contract Implementation1 is Initializable {", "highlightLines": [7]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/RegressionImplementation.sol", "line": 7, "column": 1}, "severity": "info", "references": ["https://docs.openzeppelin.com/contracts/4.x/upgradeable#storage_gaps"], "description": ""}, {"id": "dea42921f317", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract Implementation1 is Initializable {\n    uint256 internal _value;", "highlightLines": [7]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/RegressionImplementation.sol", "line": 7, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "78978305c998", "fix": {"template": null, "available": false}, "title": "Initializer function not protected - can be called multiple times", "ruleId": "rules.sol-initializer-not-protected", "snippet": {"code": "    function initialize() public initializer {}", "highlightLines": [10]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/RegressionImplementation.sol", "line": 10, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "e4f18a07de75", "fix": {"template": null, "available": false}, "title": "Upgradeable contract without storage gap - future upgrade collision risk", "ruleId": "rules.sol-no-gap-storage", "snippet": {"code": "contract Implementation2 is Initializable {", "highlightLines": [17]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/RegressionImplementation.sol", "line": 17, "column": 1}, "severity": "info", "references": ["https://docs.openzeppelin.com/contracts/4.x/upgradeable#storage_gaps"], "description": ""}, {"id": "bf9c4ed13147", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract Implementation2 is Initializable {\n    uint256 internal _value;", "highlightLines": [17]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/RegressionImplementation.sol", "line": 17, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "3be5d8ea67b8", "fix": {"template": null, "available": false}, "title": "Initializer function not protected - can be called multiple times", "ruleId": "rules.sol-initializer-not-protected", "snippet": {"code": "    function initialize() public initializer {}", "highlightLines": [20]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/RegressionImplementation.sol", "line": 20, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "8ab9ba97a167", "fix": {"template": null, "available": false}, "title": "Upgradeable contract without storage gap - future upgrade collision risk", "ruleId": "rules.sol-no-gap-storage", "snippet": {"code": "contract Implementation3 is Initializable {", "highlightLines": [31]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/RegressionImplementation.sol", "line": 31, "column": 1}, "severity": "info", "references": ["https://docs.openzeppelin.com/contracts/4.x/upgradeable#storage_gaps"], "description": ""}, {"id": "a9c534ffa0f3", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract Implementation3 is Initializable {\n    uint256 internal _value;", "highlightLines": [31]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/RegressionImplementation.sol", "line": 31, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "1bceda847b90", "fix": {"template": null, "available": false}, "title": "Initializer function not protected - can be called multiple times", "ruleId": "rules.sol-initializer-not-protected", "snippet": {"code": "    function initialize() public initializer {}", "highlightLines": [34]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/RegressionImplementation.sol", "line": 34, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "8884041f9e80", "fix": {"template": null, "available": false}, "title": "Upgradeable contract without storage gap - future upgrade collision risk", "ruleId": "rules.sol-no-gap-storage", "snippet": {"code": "contract Implementation4 is Initializable {", "highlightLines": [45]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/RegressionImplementation.sol", "line": 45, "column": 1}, "severity": "info", "references": ["https://docs.openzeppelin.com/contracts/4.x/upgradeable#storage_gaps"], "description": ""}, {"id": "91081af27cd4", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract Implementation4 is Initializable {\n    uint256 internal _value;", "highlightLines": [45]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/RegressionImplementation.sol", "line": 45, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "77bb6ffada69", "fix": {"template": null, "available": false}, "title": "Initializer function not protected - can be called multiple times", "ruleId": "rules.sol-initializer-not-protected", "snippet": {"code": "    function initialize() public initializer {}", "highlightLines": [48]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/RegressionImplementation.sol", "line": 48, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "c1a984737878", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeCastMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "e5802abb94a5", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "    function toUint128(uint256 a) public pure returns (uint128) {", "highlightLines": [75]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeCastMock.sol", "line": 75, "column": 17}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "27b253f65294", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "    function toUint64(uint256 a) public pure returns (uint64) {", "highlightLines": [107]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeCastMock.sol", "line": 107, "column": 17}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "7b691107f56f", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "    function toUint32(uint256 a) public pure returns (uint32) {", "highlightLines": [123]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeCastMock.sol", "line": 123, "column": 17}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "3d0bc4cfcc32", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "    function toUint16(uint256 a) public pure returns (uint16) {", "highlightLines": [131]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeCastMock.sol", "line": 131, "column": 17}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "790322b93d5c", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "    function toUint8(uint256 a) public pure returns (uint8) {", "highlightLines": [135]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeCastMock.sol", "line": 135, "column": 17}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "05da920e299e", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeERC20Helper.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "4cb9a975c8cc", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract ERC20ReturnFalseMock is Context {\n    uint256 private _allowance;\n\n    // IERC20's functions are not pure, but these mock implementations are: to prevent Solidity from issuing warnings,\n    // we write to a dummy state variable.\n    uint256 private _dummy;", "highlightLines": [10]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeERC20Helper.sol", "line": 10, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "32490143ec51", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function transfer(address, uint256) public returns (bool) {", "highlightLines": [17]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeERC20Helper.sol", "line": 17, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "cf948ddcd26a", "fix": {"template": null, "available": false}, "title": "ERC20 returns false on failure instead of reverting - use SafeERC20", "ruleId": "rules.sol-erc20-return-false-pattern", "snippet": {"code": "    function transfer(address, uint256) public returns (bool) {\n        _dummy = 0;\n        return false;", "highlightLines": [17]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeERC20Helper.sol", "line": 17, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/Returnfalse.sol"], "description": ""}, {"id": "fec0f4fc3080", "fix": {"template": null, "available": false}, "title": "ERC20 transferFrom without payload size validation - consider adding onlyPayloadSize modifier", "ruleId": "rules.sol-erc20-missing-payload-modifier", "snippet": {"code": "    function transferFrom(\n        address,\n        address,\n        uint256\n    ) public returns (bool) {", "highlightLines": [22]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeERC20Helper.sol", "line": 22, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address"], "description": ""}, {"id": "b77982fa23ba", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function transferFrom(\n        address,\n        address,\n        uint256\n    ) public returns (bool) {", "highlightLines": [22]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeERC20Helper.sol", "line": 22, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "de488ddef0be", "fix": {"template": null, "available": false}, "title": "NFT transfer without approval/ownership check - add _isApprovedOrOwner validation", "ruleId": "rules.sol-nft-transfer-no-approval-check", "snippet": {"code": "    function transferFrom(\n        address,\n        address,\n        uint256\n    ) public returns (bool) {", "highlightLines": [22]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeERC20Helper.sol", "line": 22, "column": 5}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/NFT-transfer.sol"], "description": ""}, {"id": "a023470e77b8", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function approve(address, uint256) public returns (bool) {", "highlightLines": [31]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeERC20Helper.sol", "line": 31, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "a46eebb89c25", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_dummy == 0); // Dummy read from a state variable so that the function is view", "highlightLines": [37]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeERC20Helper.sol", "line": 37, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "90cd8f20907d", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract ERC20ReturnTrueMock is Context {\n    mapping(address => uint256) private _allowances;\n\n    // IERC20's functions are not pure, but these mock implementations are: to prevent Solidity from issuing warnings,\n    // we write to a dummy state variable.\n    uint256 private _dummy;", "highlightLines": [42]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeERC20Helper.sol", "line": 42, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "03ddff08bda6", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function transfer(address, uint256) public returns (bool) {", "highlightLines": [49]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeERC20Helper.sol", "line": 49, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "0364689ede50", "fix": {"template": null, "available": false}, "title": "ERC20 transferFrom without payload size validation - consider adding onlyPayloadSize modifier", "ruleId": "rules.sol-erc20-missing-payload-modifier", "snippet": {"code": "    function transferFrom(\n        address,\n        address,\n        uint256\n    ) public returns (bool) {", "highlightLines": [54]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeERC20Helper.sol", "line": 54, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address"], "description": ""}, {"id": "82087983150a", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function transferFrom(\n        address,\n        address,\n        uint256\n    ) public returns (bool) {", "highlightLines": [54]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeERC20Helper.sol", "line": 54, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "00f7a214ead4", "fix": {"template": null, "available": false}, "title": "NFT transfer without approval/ownership check - add _isApprovedOrOwner validation", "ruleId": "rules.sol-nft-transfer-no-approval-check", "snippet": {"code": "    function transferFrom(\n        address,\n        address,\n        uint256\n    ) public returns (bool) {", "highlightLines": [54]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeERC20Helper.sol", "line": 54, "column": 5}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/NFT-transfer.sol"], "description": ""}, {"id": "8b2f1f53fd0c", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function approve(address, uint256) public returns (bool) {", "highlightLines": [63]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeERC20Helper.sol", "line": 63, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "81dc50263751", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract ERC20NoReturnMock is Context {\n    mapping(address => uint256) private _allowances;\n\n    // IERC20's functions are not pure, but these mock implementations are: to prevent Solidity from issuing warnings,\n    // we write to a dummy state variable.\n    uint256 private _dummy;", "highlightLines": [77]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeERC20Helper.sol", "line": 77, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "7f20d576a324", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function transfer(address, uint256) public {", "highlightLines": [84]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeERC20Helper.sol", "line": 84, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "92a821dc5011", "fix": {"template": null, "available": false}, "title": "ERC20 transferFrom without payload size validation - consider adding onlyPayloadSize modifier", "ruleId": "rules.sol-erc20-missing-payload-modifier", "snippet": {"code": "    function transferFrom(\n        address,\n        address,\n        uint256\n    ) public {", "highlightLines": [88]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeERC20Helper.sol", "line": 88, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address"], "description": ""}, {"id": "ea1c9db1e4c5", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function transferFrom(\n        address,\n        address,\n        uint256\n    ) public {", "highlightLines": [88]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeERC20Helper.sol", "line": 88, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "f3d56ee6385b", "fix": {"template": null, "available": false}, "title": "NFT transfer without approval/ownership check - add _isApprovedOrOwner validation", "ruleId": "rules.sol-nft-transfer-no-approval-check", "snippet": {"code": "    function transferFrom(\n        address,\n        address,\n        uint256\n    ) public {", "highlightLines": [88]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeERC20Helper.sol", "line": 88, "column": 5}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/NFT-transfer.sol"], "description": ""}, {"id": "cf73457fa981", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function approve(address, uint256) public {", "highlightLines": [96]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeERC20Helper.sol", "line": 96, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "804e81faedd4", "fix": {"template": null, "available": false}, "title": "ERC20 permit without deadline validation - permits can be replayed", "ruleId": "rules.sol-permit-no-deadline-check", "snippet": {"code": "        super.permit(owner, spender, value, deadline, v, r, s);", "highlightLines": [126]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeERC20Helper.sol", "line": 126, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d80eb555b8d3", "fix": {"template": null, "available": false}, "title": "External call in try-catch without reentrancy guard - state can be corrupted", "ruleId": "rules.sol-reentrancy-try-catch", "snippet": {"code": "        try this.permitThatMayRevert(owner, spender, value, deadline, v, r, s) {\n            // do nothing\n        } catch {", "highlightLines": [138]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeERC20Helper.sol", "line": 138, "column": 9}, "severity": "high", "references": [], "description": ""}, {"id": "9480eb8015ea", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(IERC20 token) {\n        _token = token;\n    }", "highlightLines": [151]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeERC20Helper.sol", "line": 151, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "ce391801bc01", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function transfer() public {", "highlightLines": [155]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeERC20Helper.sol", "line": 155, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "dd465c24bd75", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function transferFrom() public {", "highlightLines": [159]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeERC20Helper.sol", "line": 159, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "e7f6f215bf36", "fix": {"template": null, "available": false}, "title": "NFT transfer without approval/ownership check - add _isApprovedOrOwner validation", "ruleId": "rules.sol-nft-transfer-no-approval-check", "snippet": {"code": "    function transferFrom() public {", "highlightLines": [159]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeERC20Helper.sol", "line": 159, "column": 5}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/NFT-transfer.sol"], "description": ""}, {"id": "e9325294860d", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function approve(uint256 amount) public {", "highlightLines": [163]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeERC20Helper.sol", "line": 163, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "6499de397aa8", "fix": {"template": null, "available": false}, "title": "safeApprove fails if current approval non-zero - use forceApprove or reset first", "ruleId": "rules.sol-safe-approve-nonzero", "snippet": {"code": "        _token.safeApprove(address(0), amount);", "highlightLines": [164]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeERC20Helper.sol", "line": 164, "column": 16}, "severity": "medium", "references": [], "description": ""}, {"id": "e563f7863cbc", "fix": {"template": null, "available": false}, "title": "Using safeApprove incorrectly - must set allowance to 0 first for tokens that require it", "ruleId": "rules.sol-safeapprove-usage", "snippet": {"code": "        _token.safeApprove(address(0), amount);", "highlightLines": [164]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeERC20Helper.sol", "line": 164, "column": 16}, "severity": "medium", "references": [], "description": ""}, {"id": "fb6b50fadeae", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeMathMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "54935c417f98", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function addMemoryCheck() public pure returns (uint256 mem) {\n        uint256 length = 32;", "highlightLines": [74]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeMathMock.sol", "line": 74, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "74985dda0978", "fix": {"template": null, "available": false}, "title": "View/pure function uses assembly - may modify state unexpectedly", "ruleId": "rules.sol-constant-function-assembly", "snippet": {"code": "    function addMemoryCheck() public pure returns (uint256 mem) {\n        uint256 length = 32;\n        assembly {", "highlightLines": [74]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeMathMock.sol", "line": 74, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-using-assembly-code"], "description": ""}, {"id": "59f761e4262e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 length = 32;", "highlightLines": [75]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeMathMock.sol", "line": 75, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7560196c7c5c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 length = 32;\n        assembly {\n            mem := mload(0x40)\n        }", "highlightLines": [75]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeMathMock.sol", "line": 75, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "525df352f3e8", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [76]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeMathMock.sol", "line": 76, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "9676e09cef52", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [82]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeMathMock.sol", "line": 82, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "033937f3026c", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function subMemoryCheck() public pure returns (uint256 mem) {\n        uint256 length = 32;", "highlightLines": [87]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeMathMock.sol", "line": 87, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "6f940b321c8b", "fix": {"template": null, "available": false}, "title": "View/pure function uses assembly - may modify state unexpectedly", "ruleId": "rules.sol-constant-function-assembly", "snippet": {"code": "    function subMemoryCheck() public pure returns (uint256 mem) {\n        uint256 length = 32;\n        assembly {", "highlightLines": [87]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeMathMock.sol", "line": 87, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-using-assembly-code"], "description": ""}, {"id": "10e1c15d2a78", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 length = 32;", "highlightLines": [88]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeMathMock.sol", "line": 88, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "67e634e6f0be", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 length = 32;\n        assembly {\n            mem := mload(0x40)\n        }", "highlightLines": [88]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeMathMock.sol", "line": 88, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "4d9496a1611d", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [89]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeMathMock.sol", "line": 89, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "bcaed2232eb8", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [95]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeMathMock.sol", "line": 95, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "900ed535377f", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function mulMemoryCheck() public pure returns (uint256 mem) {\n        uint256 length = 32;", "highlightLines": [100]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeMathMock.sol", "line": 100, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "1732134b2ff6", "fix": {"template": null, "available": false}, "title": "View/pure function uses assembly - may modify state unexpectedly", "ruleId": "rules.sol-constant-function-assembly", "snippet": {"code": "    function mulMemoryCheck() public pure returns (uint256 mem) {\n        uint256 length = 32;\n        assembly {", "highlightLines": [100]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeMathMock.sol", "line": 100, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-using-assembly-code"], "description": ""}, {"id": "8aa97fe077f7", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 length = 32;", "highlightLines": [101]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeMathMock.sol", "line": 101, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "594ac3407e85", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 length = 32;\n        assembly {\n            mem := mload(0x40)\n        }", "highlightLines": [101]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeMathMock.sol", "line": 101, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "88c417db3cf4", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [102]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeMathMock.sol", "line": 102, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "9be68eedd450", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [108]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeMathMock.sol", "line": 108, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "289fa894683f", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function divMemoryCheck() public pure returns (uint256 mem) {\n        uint256 length = 32;", "highlightLines": [113]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeMathMock.sol", "line": 113, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "4b45ba25dce0", "fix": {"template": null, "available": false}, "title": "View/pure function uses assembly - may modify state unexpectedly", "ruleId": "rules.sol-constant-function-assembly", "snippet": {"code": "    function divMemoryCheck() public pure returns (uint256 mem) {\n        uint256 length = 32;\n        assembly {", "highlightLines": [113]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeMathMock.sol", "line": 113, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-using-assembly-code"], "description": ""}, {"id": "15a400007e78", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 length = 32;", "highlightLines": [114]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeMathMock.sol", "line": 114, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4b066f46cefa", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 length = 32;\n        assembly {\n            mem := mload(0x40)\n        }", "highlightLines": [114]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeMathMock.sol", "line": 114, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "57034e12a21f", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [115]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeMathMock.sol", "line": 115, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "8a73ce9943e7", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [121]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeMathMock.sol", "line": 121, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "4489c7822b6a", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function modMemoryCheck() public pure returns (uint256 mem) {\n        uint256 length = 32;", "highlightLines": [126]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeMathMock.sol", "line": 126, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "f24e87a1e627", "fix": {"template": null, "available": false}, "title": "View/pure function uses assembly - may modify state unexpectedly", "ruleId": "rules.sol-constant-function-assembly", "snippet": {"code": "    function modMemoryCheck() public pure returns (uint256 mem) {\n        uint256 length = 32;\n        assembly {", "highlightLines": [126]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeMathMock.sol", "line": 126, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-using-assembly-code"], "description": ""}, {"id": "376731739b05", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 length = 32;", "highlightLines": [127]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeMathMock.sol", "line": 127, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a10db0bfee3a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 length = 32;\n        assembly {\n            mem := mload(0x40)\n        }", "highlightLines": [127]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeMathMock.sol", "line": 127, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "05eede5f8f70", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [128]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeMathMock.sol", "line": 128, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "ffb31b6bec00", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [134]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SafeMathMock.sol", "line": 134, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "710eb975f8d0", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SignatureCheckerMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "371867392de0", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SignedMathMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "a7d092ef6832", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SignedSafeMathMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "109254e22cba", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SingleInheritanceInitializableMocks.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "6bd8429a5d58", "fix": {"template": null, "available": false}, "title": "Upgradeable contract without storage gap - future upgrade collision risk", "ruleId": "rules.sol-no-gap-storage", "snippet": {"code": "contract MigratableMockV1 is Initializable {", "highlightLines": [11]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SingleInheritanceInitializableMocks.sol", "line": 11, "column": 1}, "severity": "info", "references": ["https://docs.openzeppelin.com/contracts/4.x/upgradeable#storage_gaps"], "description": ""}, {"id": "fc8a24c577fe", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract MigratableMockV1 is Initializable {\n    uint256 public x;", "highlightLines": [11]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SingleInheritanceInitializableMocks.sol", "line": 11, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "ad5bf9797b06", "fix": {"template": null, "available": false}, "title": "Initializer function not protected - can be called multiple times", "ruleId": "rules.sol-initializer-not-protected", "snippet": {"code": "    function initialize(uint256 value) public payable initializer {", "highlightLines": [14]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SingleInheritanceInitializableMocks.sol", "line": 14, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "06e31ebdaed1", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract MigratableMockV2 is MigratableMockV1 {\n    bool internal _migratedV2;\n    uint256 public y;", "highlightLines": [23]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SingleInheritanceInitializableMocks.sol", "line": 23, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "c046f8da6b32", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(!_migratedV2);", "highlightLines": [28]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SingleInheritanceInitializableMocks.sol", "line": 28, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "1627f238b7ab", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        x = value;\n        y = anotherValue;", "highlightLines": [29]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SingleInheritanceInitializableMocks.sol", "line": 29, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "ea1d82757696", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        y = anotherValue;\n        _migratedV2 = true;", "highlightLines": [30]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SingleInheritanceInitializableMocks.sol", "line": 30, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "3718123f0adb", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract MigratableMockV3 is MigratableMockV2 {\n    bool internal _migratedV3;\n\n    function migrate() public payable {\n        require(!_migratedV3);\n        uint256 oldX = x;", "highlightLines": [39]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SingleInheritanceInitializableMocks.sol", "line": 39, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "3354f22aa5ca", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(!_migratedV3);", "highlightLines": [43]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SingleInheritanceInitializableMocks.sol", "line": 43, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "abfd7d7b00d2", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 oldX = x;", "highlightLines": [44]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SingleInheritanceInitializableMocks.sol", "line": 44, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "1624a1ac41ff", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 oldX = x;\n        x = y;", "highlightLines": [44]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SingleInheritanceInitializableMocks.sol", "line": 44, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "ccf7258e6923", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        x = y;\n        y = oldX;", "highlightLines": [45]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SingleInheritanceInitializableMocks.sol", "line": 45, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "f2b7ac9bbee8", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        y = oldX;\n        _migratedV3 = true;", "highlightLines": [46]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/SingleInheritanceInitializableMocks.sol", "line": 46, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "f8e78a82121a", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/StorageSlotMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "9875012d745e", "fix": {"template": null, "available": false}, "title": "Storage write without access control - arbitrary data manipulation", "ruleId": "rules.sol-unprotected-storage-write", "snippet": {"code": "    function setBoolean(bytes32 slot, bool value) public {", "highlightLines": [10]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/StorageSlotMock.sol", "line": 10, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "332d8500e231", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function setBoolean(bytes32 slot, bool value) public {\n        slot.getBooleanSlot().value = value;", "highlightLines": [10]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/StorageSlotMock.sol", "line": 10, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "674288ead213", "fix": {"template": null, "available": false}, "title": "Storage write without access control - arbitrary data manipulation", "ruleId": "rules.sol-unprotected-storage-write", "snippet": {"code": "    function setAddress(bytes32 slot, address value) public {", "highlightLines": [14]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/StorageSlotMock.sol", "line": 14, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "71bbc0818ac0", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function setAddress(bytes32 slot, address value) public {\n        slot.getAddressSlot().value = value;", "highlightLines": [14]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/StorageSlotMock.sol", "line": 14, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "1c142662e267", "fix": {"template": null, "available": false}, "title": "Storage write without access control - arbitrary data manipulation", "ruleId": "rules.sol-unprotected-storage-write", "snippet": {"code": "    function setBytes32(bytes32 slot, bytes32 value) public {", "highlightLines": [18]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/StorageSlotMock.sol", "line": 18, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "7a3d7f3e0b94", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function setBytes32(bytes32 slot, bytes32 value) public {\n        slot.getBytes32Slot().value = value;", "highlightLines": [18]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/StorageSlotMock.sol", "line": 18, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "5a4c7ce46125", "fix": {"template": null, "available": false}, "title": "Storage write without access control - arbitrary data manipulation", "ruleId": "rules.sol-unprotected-storage-write", "snippet": {"code": "    function setUint256(bytes32 slot, uint256 value) public {", "highlightLines": [22]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/StorageSlotMock.sol", "line": 22, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "00e521859ec5", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function setUint256(bytes32 slot, uint256 value) public {\n        slot.getUint256Slot().value = value;", "highlightLines": [22]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/StorageSlotMock.sol", "line": 22, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "e4669929f9ac", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/StringsMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "474405b8a7bc", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/TimersBlockNumberImpl.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "0d68cc666f19", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/TimersTimestampImpl.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "ffaeddb0adf6", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/UUPS/UUPSLegacy.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "d2e251de99e1", "fix": {"template": null, "available": false}, "title": "Upgradeable contract without storage gap - adding variables in parent will corrupt child storage", "ruleId": "rules.sol-missing-storage-gap", "snippet": {"code": "contract UUPSUpgradeableLegacyMock is UUPSUpgradeableMock {", "highlightLines": [9]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/UUPS/UUPSLegacy.sol", "line": 9, "column": 1}, "severity": "medium", "references": ["https://docs.openzeppelin.com/upgrades-plugins/writing-upgradeable"], "description": ""}, {"id": "82d2b4178944", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "    bytes32 private constant _ROLLBACK_SLOT = 0x4910fdfa16fed3260ed0e7147f7cc6da11a60208b5b9406d12a635614ffd9143;", "highlightLines": [11]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/UUPS/UUPSLegacy.sol", "line": 11, "column": 47}, "severity": "high", "references": [], "description": ""}, {"id": "d35f02442bac", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address oldImplementation = _getImplementation();", "highlightLines": [25]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/UUPS/UUPSLegacy.sol", "line": 25, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8de6d417f7c6", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address oldImplementation = _getImplementation();\n\n        // Initial upgrade and setup call\n        __setImplementation(newImplementation);\n        if (data.length > 0 || forceCall) {\n            Address.functionDelegateCall(newImplementation, data);\n        }\n\n        // Perform rollback test if not already in progress\n        StorageSlot.BooleanSlot storage rollbackTesting = StorageSlot.getBooleanSlot(_ROLLBACK_SLOT);", "highlightLines": [25]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/UUPS/UUPSLegacy.sol", "line": 25, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "066fde63d3fb", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        StorageSlot.BooleanSlot storage rollbackTesting = StorageSlot.getBooleanSlot(_ROLLBACK_SLOT);\n        if (!rollbackTesting.value) {\n            // Trigger rollback using upgradeTo from the new implementation\n            rollbackTesting.value = true;\n            Address.functionDelegateCall(\n                newImplementation,\n                abi.encodeWithSignature(\"upgradeTo(address)\", oldImplementation)\n            );\n            rollbackTesting.value = false;\n            // Check rollback was effective\n            require(oldImplementation == _getImplementation(), \"ERC1967Upgrade: upgrade breaks further upgrades\");\n            // Finally reset to the new implementation and log the upgrade\n            _upgradeTo(newImplementation);\n        }", "highlightLines": [34]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/UUPS/UUPSLegacy.sol", "line": 34, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "524c96728bd5", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            rollbackTesting.value = true;\n            Address.functionDelegateCall(\n                newImplementation,\n                abi.encodeWithSignature(\"upgradeTo(address)\", oldImplementation)\n            );\n            rollbackTesting.value = false;", "highlightLines": [37]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/UUPS/UUPSLegacy.sol", "line": 37, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "96b48ee3d0e0", "fix": {"template": null, "available": false}, "title": "Diamond upgrade function without timelock - instant rug pull possible", "ruleId": "rules.sol-diamond-upgrade-no-timelock", "snippet": {"code": "    function upgradeTo(address newImplementation) external virtual override {", "highlightLines": [51]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/UUPS/UUPSLegacy.sol", "line": 51, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "5f8a876190fb", "fix": {"template": null, "available": false}, "title": "Proxy upgrade executable immediately - malicious upgrade can drain funds before users react", "ruleId": "rules.sol-proxy-upgrade-no-delay", "snippet": {"code": "    function upgradeTo(address newImplementation) external virtual override {", "highlightLines": [51]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/UUPS/UUPSLegacy.sol", "line": 51, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "8322f37de953", "fix": {"template": null, "available": false}, "title": "Proxy upgrade executable immediately - malicious upgrade can drain funds before users react", "ruleId": "rules.sol-proxy-upgrade-no-delay", "snippet": {"code": "    function upgradeToAndCall(address newImplementation, bytes memory data) external payable virtual override {", "highlightLines": [55]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/UUPS/UUPSLegacy.sol", "line": 55, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "b926f7aaf03d", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/UUPS/UUPSUpgradeableMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "5b85ee802ade", "fix": {"template": null, "available": false}, "title": "Upgradeable contract without storage gap - adding variables in parent will corrupt child storage", "ruleId": "rules.sol-missing-storage-gap", "snippet": {"code": "contract UUPSUpgradeableMock is CountersImpl, UUPSUpgradeable {", "highlightLines": [8]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/UUPS/UUPSUpgradeableMock.sol", "line": 8, "column": 1}, "severity": "medium", "references": ["https://docs.openzeppelin.com/upgrades-plugins/writing-upgradeable"], "description": ""}, {"id": "581649a648c2", "fix": {"template": null, "available": false}, "title": "Upgradeable contract without storage gap - adding variables in parent will corrupt child storage", "ruleId": "rules.sol-missing-storage-gap", "snippet": {"code": "contract UUPSUpgradeableUnsafeMock is UUPSUpgradeableMock {", "highlightLines": [13]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/UUPS/UUPSUpgradeableMock.sol", "line": 13, "column": 1}, "severity": "medium", "references": ["https://docs.openzeppelin.com/upgrades-plugins/writing-upgradeable"], "description": ""}, {"id": "f2d10b59d756", "fix": {"template": null, "available": false}, "title": "Diamond upgrade function without timelock - instant rug pull possible", "ruleId": "rules.sol-diamond-upgrade-no-timelock", "snippet": {"code": "    function upgradeTo(address newImplementation) external virtual override {", "highlightLines": [14]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/UUPS/UUPSUpgradeableMock.sol", "line": 14, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "052763d058a5", "fix": {"template": null, "available": false}, "title": "Proxy upgrade executable immediately - malicious upgrade can drain funds before users react", "ruleId": "rules.sol-proxy-upgrade-no-delay", "snippet": {"code": "    function upgradeTo(address newImplementation) external virtual override {", "highlightLines": [14]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/UUPS/UUPSUpgradeableMock.sol", "line": 14, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "63ace17a2147", "fix": {"template": null, "available": false}, "title": "Proxy upgrade executable immediately - malicious upgrade can drain funds before users react", "ruleId": "rules.sol-proxy-upgrade-no-delay", "snippet": {"code": "    function upgradeToAndCall(address newImplementation, bytes memory data) external payable virtual override {", "highlightLines": [18]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/UUPS/UUPSUpgradeableMock.sol", "line": 18, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "078f726853df", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/VotesMock.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "2d3efd161e44", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(string memory name) EIP712(name, \"1\") {}", "highlightLines": [11]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/VotesMock.sol", "line": 11, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "f6a6e489d3e6", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function mint(address account, uint256 voteId) external {", "highlightLines": [25]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/VotesMock.sol", "line": 25, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "b157b9b964be", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function mint(address account, uint256 voteId) external {", "highlightLines": [25]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/VotesMock.sol", "line": 25, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "a763245c4f0a", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function burn(uint256 voteId) external {", "highlightLines": [31]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/VotesMock.sol", "line": 31, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "f9aaabac4583", "fix": {"template": null, "available": false}, "title": "Public burn function without access control - anyone can burn tokens", "ruleId": "rules.sol-erc20-public-burn", "snippet": {"code": "    function burn(uint256 voteId) external {", "highlightLines": [31]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/VotesMock.sol", "line": 31, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "0c376ff37c8b", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function burn(uint256 voteId) external {", "highlightLines": [31]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/VotesMock.sol", "line": 31, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "1714834dbdba", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address owner = _owners[voteId];", "highlightLines": [32]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/VotesMock.sol", "line": 32, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f9794e5b0fe0", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "        address owner = _owners[voteId];", "highlightLines": [32]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/VotesMock.sol", "line": 32, "column": 9}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "3a05b2be84a8", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        address owner = _owners[voteId];", "highlightLines": [32]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/VotesMock.sol", "line": 32, "column": 17}, "severity": "info", "references": [], "description": ""}, {"id": "f602fecfa80b", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": " * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.", "highlightLines": [24]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/compound/CompTimelock.sol", "line": 24, "column": 19}, "severity": "info", "references": [], "description": ""}, {"id": "491b1c91352b", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [27]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/compound/CompTimelock.sol", "line": 27, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "81c55a780677", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event NewAdmin(address indexed newAdmin);", "highlightLines": [30]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/compound/CompTimelock.sol", "line": 30, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "2a720c04f288", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event NewPendingAdmin(address indexed newPendingAdmin);", "highlightLines": [31]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/compound/CompTimelock.sol", "line": 31, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "77714c08c544", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event CancelTransaction(\n        bytes32 indexed txHash,\n        address indexed target,\n        uint256 value,\n        string signature,\n        bytes data,\n        uint256 eta\n    );", "highlightLines": [33]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/compound/CompTimelock.sol", "line": 33, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "fa3364c04b83", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event ExecuteTransaction(\n        bytes32 indexed txHash,\n        address indexed target,\n        uint256 value,\n        string signature,\n        bytes data,\n        uint256 eta\n    );", "highlightLines": [41]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/compound/CompTimelock.sol", "line": 41, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "32754ff4f395", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event QueueTransaction(\n        bytes32 indexed txHash,\n        address indexed target,\n        uint256 value,\n        string signature,\n        bytes data,\n        uint256 eta\n    );", "highlightLines": [49]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/compound/CompTimelock.sol", "line": 49, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "acf2b004ec56", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(address admin_, uint256 delay_) {\n        require(delay_ >= MINIMUM_DELAY, \"Timelock::constructor: Delay must exceed minimum delay.\");\n        require(delay_ <= MAXIMUM_DELAY, \"Timelock::setDelay: Delay must not exceed maximum delay.\");\n\n        admin = admin_;\n        delay = delay_;\n    }", "highlightLines": [68]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/compound/CompTimelock.sol", "line": 68, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "3e8b00f8712e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        admin = admin_;\n        delay = delay_;", "highlightLines": [72]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/compound/CompTimelock.sol", "line": 72, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "359666254525", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    receive() external payable {}", "highlightLines": [76]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/compound/CompTimelock.sol", "line": 76, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "44185dc90676", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "    receive() external payable {}", "highlightLines": [76]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/compound/CompTimelock.sol", "line": 76, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "b27cda7f9cba", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        admin = msg.sender;\n        pendingAdmin = address(0);", "highlightLines": [89]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/compound/CompTimelock.sol", "line": 89, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "049d035bbfea", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        bytes32 txHash = keccak256(abi.encode(target, value, signature, data, eta));", "highlightLines": [114]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/compound/CompTimelock.sol", "line": 114, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c9f004f21b6e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes32 txHash = keccak256(abi.encode(target, value, signature, data, eta));\n        queuedTransactions[txHash] = true;", "highlightLines": [115]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/compound/CompTimelock.sol", "line": 115, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "6e9e48be35a4", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        bytes32 txHash = keccak256(abi.encode(target, value, signature, data, eta));", "highlightLines": [115]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/compound/CompTimelock.sol", "line": 115, "column": 26}, "severity": "high", "references": [], "description": ""}, {"id": "395d4117b8ca", "fix": {"template": null, "available": false}, "title": "Signature verification without EIP-712 domain separator - vulnerable to cross-chain/cross-contract replay", "ruleId": "rules.sol-ethernaut-missing-eip712-domain", "snippet": {"code": "        bytes32 txHash = keccak256(abi.encode(target, value, signature, data, eta));", "highlightLines": [115]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/compound/CompTimelock.sol", "line": 115, "column": 26}, "severity": "high", "references": ["https://eips.ethereum.org/EIPS/eip-712", "https://ethernaut.openzeppelin.com/"], "description": ""}, {"id": "8414d674e5c9", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        bytes32 txHash = keccak256(abi.encode(target, value, signature, data, eta));", "highlightLines": [130]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/compound/CompTimelock.sol", "line": 130, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "467fa3ddf23c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes32 txHash = keccak256(abi.encode(target, value, signature, data, eta));\n        queuedTransactions[txHash] = false;", "highlightLines": [131]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/compound/CompTimelock.sol", "line": 131, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "25b2ac9831f8", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        bytes32 txHash = keccak256(abi.encode(target, value, signature, data, eta));", "highlightLines": [131]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/compound/CompTimelock.sol", "line": 131, "column": 26}, "severity": "high", "references": [], "description": ""}, {"id": "b32622ecd237", "fix": {"template": null, "available": false}, "title": "Signature verification without EIP-712 domain separator - vulnerable to cross-chain/cross-contract replay", "ruleId": "rules.sol-ethernaut-missing-eip712-domain", "snippet": {"code": "        bytes32 txHash = keccak256(abi.encode(target, value, signature, data, eta));", "highlightLines": [131]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/compound/CompTimelock.sol", "line": 131, "column": 26}, "severity": "high", "references": ["https://eips.ethereum.org/EIPS/eip-712", "https://ethernaut.openzeppelin.com/"], "description": ""}, {"id": "c21412d3870d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        bytes32 txHash = keccak256(abi.encode(target, value, signature, data, eta));", "highlightLines": [145]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/compound/CompTimelock.sol", "line": 145, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "be07ad78a0f7", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes32 txHash = keccak256(abi.encode(target, value, signature, data, eta));\n        require(queuedTransactions[txHash], \"Timelock::executeTransaction: Transaction hasn't been queued.\");\n        require(getBlockTimestamp() >= eta, \"Timelock::executeTransaction: Transaction hasn't surpassed time lock.\");\n        require(getBlockTimestamp() <= eta + GRACE_PERIOD, \"Timelock::executeTransaction: Transaction is stale.\");\n\n        queuedTransactions[txHash] = false;", "highlightLines": [146]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/compound/CompTimelock.sol", "line": 146, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "3cbd9fc7c421", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        bytes32 txHash = keccak256(abi.encode(target, value, signature, data, eta));", "highlightLines": [146]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/compound/CompTimelock.sol", "line": 146, "column": 26}, "severity": "high", "references": [], "description": ""}, {"id": "d6a3818c0b73", "fix": {"template": null, "available": false}, "title": "Signature verification without EIP-712 domain separator - vulnerable to cross-chain/cross-contract replay", "ruleId": "rules.sol-ethernaut-missing-eip712-domain", "snippet": {"code": "        bytes32 txHash = keccak256(abi.encode(target, value, signature, data, eta));", "highlightLines": [146]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/compound/CompTimelock.sol", "line": 146, "column": 26}, "severity": "high", "references": ["https://eips.ethereum.org/EIPS/eip-712", "https://ethernaut.openzeppelin.com/"], "description": ""}, {"id": "6858b4084698", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        queuedTransactions[txHash] = false;\n\n        bytes memory callData;\n\n        if (bytes(signature).length == 0) {\n            callData = data;\n        } else {\n            callData = abi.encodePacked(bytes4(keccak256(bytes(signature))), data);\n        }", "highlightLines": [151]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/compound/CompTimelock.sol", "line": 151, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "edcd9ff7b6aa", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "            callData = abi.encodePacked(bytes4(keccak256(bytes(signature))), data);", "highlightLines": [158]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/compound/CompTimelock.sol", "line": 158, "column": 24}, "severity": "medium", "references": [], "description": ""}, {"id": "e0af90f68b41", "fix": {"template": null, "available": false}, "title": "External call result copied to memory - malicious contract can return huge data (return bomb)", "ruleId": "rules.sol-return-bomb", "snippet": {"code": "        (bool success, bytes memory returnData) = target.call{value: value}(callData);", "highlightLines": [162]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/compound/CompTimelock.sol", "line": 162, "column": 9}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#return-bomb"], "description": ""}, {"id": "c8c79cc7475e", "fix": {"template": null, "available": false}, "title": "Low-level call without checking return value - silent failure possible", "ruleId": "rules.sol-unchecked-call-return", "snippet": {"code": "        (bool success, bytes memory returnData) = target.call{value: value}(callData);", "highlightLines": [162]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/compound/CompTimelock.sol", "line": 162, "column": 57}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-104/", "https://blocksecteam.medium.com/li-fi-attack"], "description": ""}, {"id": "99716933fde4", "fix": {"template": null, "available": false}, "title": "Event emitted after external call - reentrancy can cause events to be logged out of order", "ruleId": "rules.sol-event-after-external-call", "snippet": {"code": "        (bool success, bytes memory returnData) = target.call{value: value}(callData);\n        require(success, \"Timelock::executeTransaction: Transaction execution reverted.\");\n\n        emit ExecuteTransaction(txHash, target, value, signature, data, eta);", "highlightLines": [162]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/compound/CompTimelock.sol", "line": 162, "column": 57}, "severity": "info", "references": [], "description": ""}, {"id": "eb8a39356b0f", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        return block.timestamp;", "highlightLines": [172]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/compound/CompTimelock.sol", "line": 172, "column": 16}, "severity": "medium", "references": [], "description": ""}, {"id": "f0bd7f7b5dea", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/crosschain/bridges.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "589c0ee491a6", "fix": {"template": null, "available": false}, "title": "External call with shared state variable - reentrancy between functions possible", "ruleId": "rules.sol-shared-state-external-call", "snippet": {"code": "    address internal _currentSender;\n\n    function relayAs(\n        address target,\n        bytes calldata data,\n        address sender\n    ) external virtual {\n        address previousSender = _currentSender;\n\n        _currentSender = sender;\n\n        (bool success, bytes memory returndata) = target.call(data);\n        Address.verifyCallResultFromTarget(target, success, returndata, \"low-level call reverted\");\n\n        _currentSender = previousSender;", "highlightLines": [13]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/crosschain/bridges.sol", "line": 13, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "88f79c870c81", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address previousSender = _currentSender;", "highlightLines": [20]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/crosschain/bridges.sol", "line": 20, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "fb17a041e154", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address previousSender = _currentSender;\n\n        _currentSender = sender;", "highlightLines": [20]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/crosschain/bridges.sol", "line": 20, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "a74215bfe560", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        _currentSender = sender;\n\n        (bool success, bytes memory returndata) = target.call(data);", "highlightLines": [22]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/crosschain/bridges.sol", "line": 22, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "f60a2f4761ae", "fix": {"template": null, "available": false}, "title": "External call result copied to memory - malicious contract can return huge data (return bomb)", "ruleId": "rules.sol-return-bomb", "snippet": {"code": "        (bool success, bytes memory returndata) = target.call(data);", "highlightLines": [24]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/crosschain/bridges.sol", "line": 24, "column": 9}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#return-bomb"], "description": ""}, {"id": "c5fb1197c56f", "fix": {"template": null, "available": false}, "title": "Call success variable declared but never checked - funds may be lost", "ruleId": "rules.sol-call-success-not-required", "snippet": {"code": "        (bool success, bytes memory returndata) = target.call(data);", "highlightLines": [24]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/crosschain/bridges.sol", "line": 24, "column": 9}, "severity": "high", "references": [], "description": ""}, {"id": "62b2fb971c38", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        (bool success, bytes memory returndata) = target.call(data);\n        Address.verifyCallResultFromTarget(target, success, returndata, \"low-level call reverted\");\n\n        _currentSender = previousSender;", "highlightLines": [24]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/crosschain/bridges.sol", "line": 24, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "f6dd5340a5e8", "fix": {"template": null, "available": false}, "title": "Arbitrary address with controlled calldata in low-level call - potential code injection", "ruleId": "rules.sol-arbitrary-low-level-call", "snippet": {"code": "        (bool success, bytes memory returndata) = target.call(data);", "highlightLines": [24]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/crosschain/bridges.sol", "line": 24, "column": 51}, "severity": "high", "references": ["https://blocksecteam.medium.com/li-fi-attack-a-cross-chain-bridge-vulnerability-no-its-due-to-unchecked-external-call-c31e7dadf60f"], "description": ""}, {"id": "2b18fc17b4f5", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "        (bool success, bytes memory returndata) = target.call(data);", "highlightLines": [24]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/crosschain/bridges.sol", "line": 24, "column": 51}, "severity": "medium", "references": [], "description": ""}, {"id": "0978be554a86", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    address public immutable inbox = address(new BridgeArbitrumL1Inbox());", "highlightLines": [45]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/crosschain/bridges.sol", "line": 45, "column": 46}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "61991952d359", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    address public immutable outbox = address(new BridgeArbitrumL1Outbox());", "highlightLines": [47]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/crosschain/bridges.sol", "line": 47, "column": 47}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "929687c4855d", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "        IFxMessageProcessor(target).processMessageFromRoot(0, sender, data);", "highlightLines": [104]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/crosschain/bridges.sol", "line": 104, "column": 9}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "7287a8e7ac1c", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.4;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/crosschain/receivers.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "d30e93a2bf50", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "    address public immutable owner = msg.sender;", "highlightLines": [15]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/crosschain/receivers.sol", "line": 15, "column": 30}, "severity": "info", "references": [], "description": ""}, {"id": "58aff981e80a", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(address bridge) CrossChainEnabledAMB(bridge) {}", "highlightLines": [27]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/crosschain/receivers.sol", "line": 27, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "c717bd8959e9", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(address bridge) CrossChainEnabledArbitrumL1(bridge) {}", "highlightLines": [35]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/crosschain/receivers.sol", "line": 35, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "3dfa8ef19790", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(address bridge) CrossChainEnabledOptimism(bridge) {}", "highlightLines": [45]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/crosschain/receivers.sol", "line": 45, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "b538613f1d72", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(address bridge) CrossChainEnabledPolygonChild(bridge) {}", "highlightLines": [53]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/crosschain/receivers.sol", "line": 53, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "413fed5ef624", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.2;", "highlightLines": [2]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/wizard/MyGovernor1.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "3a37e926d082", "fix": {"template": null, "available": false}, "title": "Base constructor called multiple times through diamond inheritance - may initialize twice", "ruleId": "rules.sol-reused-constructor", "snippet": {"code": "contract MyGovernor1 is\n    Governor,\n    GovernorTimelockControl,\n    GovernorVotes,", "highlightLines": [10]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/wizard/MyGovernor1.sol", "line": 10, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#reused-base-constructor"], "description": ""}, {"id": "2db03e762fae", "fix": {"template": null, "available": false}, "title": "SWC-125: Multiple inheritance may cause incorrect function resolution - check C3 linearization", "ruleId": "rules.sol-swc-125-inheritance-order", "snippet": {"code": "contract MyGovernor1 is\n    Governor,\n    GovernorTimelockControl,\n    GovernorVotes,", "highlightLines": [10]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/wizard/MyGovernor1.sol", "line": 10, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-125"], "description": ""}, {"id": "6ca386f448cd", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "    Governor,\n    GovernorTimelockControl,", "highlightLines": [11]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/wizard/MyGovernor1.sol", "line": 11, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "dd8abb89c9b5", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "    GovernorVotes,\n    GovernorVotesQuorumFraction,", "highlightLines": [13]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/wizard/MyGovernor1.sol", "line": 13, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "dd72b72df01b", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(IVotes _token, TimelockController _timelock)\n        Governor(\"MyGovernor\")\n        GovernorVotes(_token)\n        GovernorVotesQuorumFraction(4)\n        GovernorTimelockControl(_timelock)\n    {}", "highlightLines": [17]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/wizard/MyGovernor1.sol", "line": 17, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "1ea815215be3", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "        override(IGovernor, GovernorVotesQuorumFraction)", "highlightLines": [37]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/wizard/MyGovernor1.sol", "line": 37, "column": 19}, "severity": "info", "references": [], "description": ""}, {"id": "09603d3f426a", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "    function state(uint256 proposalId) public view override(Governor, GovernorTimelockControl) returns (ProposalState) {", "highlightLines": [43]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/wizard/MyGovernor1.sol", "line": 43, "column": 61}, "severity": "info", "references": [], "description": ""}, {"id": "50a1469b6ad3", "fix": {"template": null, "available": false}, "title": "Storage array passed by value to internal function - changes won't persist", "ruleId": "rules.sol-array-by-reference", "snippet": {"code": "    function _execute(\n        uint256 proposalId,\n        address[] memory targets,\n        uint256[] memory values,\n        bytes[] memory calldatas,\n        bytes32 descriptionHash\n    ) internal override(Governor, GovernorTimelockControl) {", "highlightLines": [56]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/wizard/MyGovernor1.sol", "line": 56, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#modifying-storage-array-by-value"], "description": ""}, {"id": "0ee29a3f4806", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "    ) internal override(Governor, GovernorTimelockControl) {", "highlightLines": [62]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/wizard/MyGovernor1.sol", "line": 62, "column": 25}, "severity": "info", "references": [], "description": ""}, {"id": "e363fe597ed6", "fix": {"template": null, "available": false}, "title": "Storage array passed by value to internal function - changes won't persist", "ruleId": "rules.sol-array-by-reference", "snippet": {"code": "    function _cancel(\n        address[] memory targets,\n        uint256[] memory values,\n        bytes[] memory calldatas,\n        bytes32 descriptionHash\n    ) internal override(Governor, GovernorTimelockControl) returns (uint256) {", "highlightLines": [66]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/wizard/MyGovernor1.sol", "line": 66, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#modifying-storage-array-by-value"], "description": ""}, {"id": "1f82a0b0def3", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "    ) internal override(Governor, GovernorTimelockControl) returns (uint256) {", "highlightLines": [71]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/wizard/MyGovernor1.sol", "line": 71, "column": 25}, "severity": "info", "references": [], "description": ""}, {"id": "566731838b09", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "    function _executor() internal view override(Governor, GovernorTimelockControl) returns (address) {", "highlightLines": [75]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/wizard/MyGovernor1.sol", "line": 75, "column": 49}, "severity": "info", "references": [], "description": ""}, {"id": "9fbc468f91f3", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "        override(Governor, GovernorTimelockControl)", "highlightLines": [82]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/wizard/MyGovernor1.sol", "line": 82, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "1692dc6dc85a", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.2;", "highlightLines": [2]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/wizard/MyGovernor2.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "7b047f773bbf", "fix": {"template": null, "available": false}, "title": "Base constructor called multiple times through diamond inheritance - may initialize twice", "ruleId": "rules.sol-reused-constructor", "snippet": {"code": "contract MyGovernor2 is\n    Governor,\n    GovernorTimelockControl,\n    GovernorProposalThreshold,", "highlightLines": [11]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/wizard/MyGovernor2.sol", "line": 11, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#reused-base-constructor"], "description": ""}, {"id": "5a3f174fdcc7", "fix": {"template": null, "available": false}, "title": "SWC-125: Multiple inheritance may cause incorrect function resolution - check C3 linearization", "ruleId": "rules.sol-swc-125-inheritance-order", "snippet": {"code": "contract MyGovernor2 is\n    Governor,\n    GovernorTimelockControl,\n    GovernorProposalThreshold,", "highlightLines": [11]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/wizard/MyGovernor2.sol", "line": 11, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-125"], "description": ""}, {"id": "7848167dbba0", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "    Governor,\n    GovernorTimelockControl,", "highlightLines": [12]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/wizard/MyGovernor2.sol", "line": 12, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "2307c6a24343", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "    GovernorVotes,\n    GovernorVotesQuorumFraction,", "highlightLines": [15]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/wizard/MyGovernor2.sol", "line": 15, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "302d0354004e", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(IVotes _token, TimelockController _timelock)\n        Governor(\"MyGovernor\")\n        GovernorVotes(_token)\n        GovernorVotesQuorumFraction(4)\n        GovernorTimelockControl(_timelock)\n    {}", "highlightLines": [19]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/wizard/MyGovernor2.sol", "line": 19, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "6f9560001c7b", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "        override(IGovernor, GovernorVotesQuorumFraction)", "highlightLines": [43]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/wizard/MyGovernor2.sol", "line": 43, "column": 19}, "severity": "info", "references": [], "description": ""}, {"id": "dc69ae320aa4", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "    function state(uint256 proposalId) public view override(Governor, GovernorTimelockControl) returns (ProposalState) {", "highlightLines": [49]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/wizard/MyGovernor2.sol", "line": 49, "column": 61}, "severity": "info", "references": [], "description": ""}, {"id": "eb8db7f40c9b", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "    ) public override(Governor, GovernorProposalThreshold, IGovernor) returns (uint256) {", "highlightLines": [58]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/wizard/MyGovernor2.sol", "line": 58, "column": 23}, "severity": "info", "references": [], "description": ""}, {"id": "25643a7f842c", "fix": {"template": null, "available": false}, "title": "Storage array passed by value to internal function - changes won't persist", "ruleId": "rules.sol-array-by-reference", "snippet": {"code": "    function _execute(\n        uint256 proposalId,\n        address[] memory targets,\n        uint256[] memory values,\n        bytes[] memory calldatas,\n        bytes32 descriptionHash\n    ) internal override(Governor, GovernorTimelockControl) {", "highlightLines": [62]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/wizard/MyGovernor2.sol", "line": 62, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#modifying-storage-array-by-value"], "description": ""}, {"id": "eb7b2b394245", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "    ) internal override(Governor, GovernorTimelockControl) {", "highlightLines": [68]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/wizard/MyGovernor2.sol", "line": 68, "column": 25}, "severity": "info", "references": [], "description": ""}, {"id": "5cc4cdd7aa8b", "fix": {"template": null, "available": false}, "title": "Storage array passed by value to internal function - changes won't persist", "ruleId": "rules.sol-array-by-reference", "snippet": {"code": "    function _cancel(\n        address[] memory targets,\n        uint256[] memory values,\n        bytes[] memory calldatas,\n        bytes32 descriptionHash\n    ) internal override(Governor, GovernorTimelockControl) returns (uint256) {", "highlightLines": [72]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/wizard/MyGovernor2.sol", "line": 72, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#modifying-storage-array-by-value"], "description": ""}, {"id": "24ebec38ff1f", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "    ) internal override(Governor, GovernorTimelockControl) returns (uint256) {", "highlightLines": [77]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/wizard/MyGovernor2.sol", "line": 77, "column": 25}, "severity": "info", "references": [], "description": ""}, {"id": "991eef4abb82", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "    function _executor() internal view override(Governor, GovernorTimelockControl) returns (address) {", "highlightLines": [81]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/wizard/MyGovernor2.sol", "line": 81, "column": 49}, "severity": "info", "references": [], "description": ""}, {"id": "63ed110d7471", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "        override(Governor, GovernorTimelockControl)", "highlightLines": [88]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/wizard/MyGovernor2.sol", "line": 88, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "2f9873311d58", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.2;", "highlightLines": [2]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/wizard/MyGovernor3.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "f4386d2a9a64", "fix": {"template": null, "available": false}, "title": "Base constructor called multiple times through diamond inheritance - may initialize twice", "ruleId": "rules.sol-reused-constructor", "snippet": {"code": "contract MyGovernor is\n    Governor,\n    GovernorTimelockControl,\n    GovernorCompatibilityBravo,", "highlightLines": [10]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/wizard/MyGovernor3.sol", "line": 10, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#reused-base-constructor"], "description": ""}, {"id": "df3d601a74d0", "fix": {"template": null, "available": false}, "title": "SWC-125: Multiple inheritance may cause incorrect function resolution - check C3 linearization", "ruleId": "rules.sol-swc-125-inheritance-order", "snippet": {"code": "contract MyGovernor is\n    Governor,\n    GovernorTimelockControl,\n    GovernorCompatibilityBravo,", "highlightLines": [10]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/wizard/MyGovernor3.sol", "line": 10, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-125"], "description": ""}, {"id": "b55b7ff3fa84", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "    Governor,\n    GovernorTimelockControl,", "highlightLines": [11]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/wizard/MyGovernor3.sol", "line": 11, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "b4d795aa1bdd", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "    GovernorVotes,\n    GovernorVotesQuorumFraction", "highlightLines": [14]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/wizard/MyGovernor3.sol", "line": 14, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "e58cbe82bb83", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(IVotes _token, TimelockController _timelock)\n        Governor(\"MyGovernor\")\n        GovernorVotes(_token)\n        GovernorVotesQuorumFraction(4)\n        GovernorTimelockControl(_timelock)\n    {}", "highlightLines": [17]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/wizard/MyGovernor3.sol", "line": 17, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "dd5f32c039c8", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "        override(IGovernor, GovernorVotesQuorumFraction)", "highlightLines": [41]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/wizard/MyGovernor3.sol", "line": 41, "column": 19}, "severity": "info", "references": [], "description": ""}, {"id": "9e033d82a4cc", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "        override(Governor, IGovernor, GovernorTimelockControl)", "highlightLines": [50]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/wizard/MyGovernor3.sol", "line": 50, "column": 29}, "severity": "info", "references": [], "description": ""}, {"id": "3367b9fcbbf2", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "    ) public override(Governor, GovernorCompatibilityBravo, IGovernor) returns (uint256) {", "highlightLines": [61]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/wizard/MyGovernor3.sol", "line": 61, "column": 23}, "severity": "info", "references": [], "description": ""}, {"id": "092eabd6c277", "fix": {"template": null, "available": false}, "title": "Storage array passed by value to internal function - changes won't persist", "ruleId": "rules.sol-array-by-reference", "snippet": {"code": "    function _execute(\n        uint256 proposalId,\n        address[] memory targets,\n        uint256[] memory values,\n        bytes[] memory calldatas,\n        bytes32 descriptionHash\n    ) internal override(Governor, GovernorTimelockControl) {", "highlightLines": [65]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/wizard/MyGovernor3.sol", "line": 65, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#modifying-storage-array-by-value"], "description": ""}, {"id": "ad90bf196926", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "    ) internal override(Governor, GovernorTimelockControl) {", "highlightLines": [71]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/wizard/MyGovernor3.sol", "line": 71, "column": 25}, "severity": "info", "references": [], "description": ""}, {"id": "da9e1dd5406b", "fix": {"template": null, "available": false}, "title": "Storage array passed by value to internal function - changes won't persist", "ruleId": "rules.sol-array-by-reference", "snippet": {"code": "    function _cancel(\n        address[] memory targets,\n        uint256[] memory values,\n        bytes[] memory calldatas,\n        bytes32 descriptionHash\n    ) internal override(Governor, GovernorTimelockControl) returns (uint256) {", "highlightLines": [75]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/wizard/MyGovernor3.sol", "line": 75, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#modifying-storage-array-by-value"], "description": ""}, {"id": "43404e01dfdc", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "    ) internal override(Governor, GovernorTimelockControl) returns (uint256) {", "highlightLines": [80]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/wizard/MyGovernor3.sol", "line": 80, "column": 25}, "severity": "info", "references": [], "description": ""}, {"id": "51b33b1963a0", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "    function _executor() internal view override(Governor, GovernorTimelockControl) returns (address) {", "highlightLines": [84]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/wizard/MyGovernor3.sol", "line": 84, "column": 49}, "severity": "info", "references": [], "description": ""}, {"id": "db7292dd4fcd", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/Clones.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "72937901cc82", "fix": {"template": null, "available": false}, "title": "Clone factory without initialization check - front-running possible", "ruleId": "rules.sol-clone-uninitialized", "snippet": {"code": "    function clone(address implementation) internal returns (address instance) {\n        /// @solidity memory-safe-assembly\n        assembly {\n            let ptr := mload(0x40)\n            mstore(ptr, 0x3d602d80600a3d3981f3363d3d373d3d3d363d73000000000000000000000000)\n            mstore(add(ptr, 0x14), shl(0x60, implementation))\n            mstore(add(ptr, 0x28), 0x5af43d82803e903d91602b57fd5bf30000000000000000000000000000000000)\n            instance := create(0, ptr, 0x37)", "highlightLines": [25]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/Clones.sol", "line": 25, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "ab090a3b0e3c", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [27]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/Clones.sol", "line": 27, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "50e88271d1cb", "fix": {"template": null, "available": false}, "title": "Incorrect shift in assembly - parameters may be reversed (value, shift vs shift, value)", "ruleId": "rules.sol-incorrect-shift-assembly", "snippet": {"code": "        assembly {\n            let ptr := mload(0x40)\n            mstore(ptr, 0x3d602d80600a3d3981f3363d3d373d3d3d363d73000000000000000000000000)\n            mstore(add(ptr, 0x14), shl(0x60, implementation))\n            mstore(add(ptr, 0x28), 0x5af43d82803e903d91602b57fd5bf30000000000000000000000000000000000)\n            instance := create(0, ptr, 0x37)\n        }", "highlightLines": [27]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/Clones.sol", "line": 27, "column": 9}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-shift-in-assembly"], "description": ""}, {"id": "36989dfe53e5", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            let ptr := mload(0x40)\n            mstore(ptr, 0x3d602d80600a3d3981f3363d3d373d3d3d363d73000000000000000000000000)\n            mstore(add(ptr, 0x14), shl(0x60, implementation))\n            mstore(add(ptr, 0x28), 0x5af43d82803e903d91602b57fd5bf30000000000000000000000000000000000)\n            instance := create(0, ptr, 0x37)", "highlightLines": [28]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/Clones.sol", "line": 28, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "cc7477467318", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "            mstore(ptr, 0x3d602d80600a3d3981f3363d3d373d3d3d363d73000000000000000000000000)", "highlightLines": [29]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/Clones.sol", "line": 29, "column": 25}, "severity": "high", "references": [], "description": ""}, {"id": "a4ba2aa57064", "fix": {"template": null, "available": false}, "title": "EIP1167 minimal proxy clone - ensure initialization is protected", "ruleId": "rules.sol-eip1167-clone", "snippet": {"code": "            mstore(ptr, 0x3d602d80600a3d3981f3363d3d373d3d3d363d73000000000000000000000000)", "highlightLines": [29]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/Clones.sol", "line": 29, "column": 27}, "severity": "info", "references": [], "description": ""}, {"id": "b6aab12b25a2", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "            mstore(add(ptr, 0x28), 0x5af43d82803e903d91602b57fd5bf30000000000000000000000000000000000)", "highlightLines": [31]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/Clones.sol", "line": 31, "column": 36}, "severity": "high", "references": [], "description": ""}, {"id": "f44732e18852", "fix": {"template": null, "available": false}, "title": "Raw bytecode deployment via create/create2 - verify bytecode source and intent (MagicNumber pattern)", "ruleId": "rules.sol-raw-bytecode-create", "snippet": {"code": "            instance := create(0, ptr, 0x37)", "highlightLines": [32]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/Clones.sol", "line": 32, "column": 25}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/18"], "description": ""}, {"id": "118bf61e34ad", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [46]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/Clones.sol", "line": 46, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "fb64104ee1c7", "fix": {"template": null, "available": false}, "title": "Incorrect shift in assembly - parameters may be reversed (value, shift vs shift, value)", "ruleId": "rules.sol-incorrect-shift-assembly", "snippet": {"code": "        assembly {\n            let ptr := mload(0x40)\n            mstore(ptr, 0x3d602d80600a3d3981f3363d3d373d3d3d363d73000000000000000000000000)\n            mstore(add(ptr, 0x14), shl(0x60, implementation))\n            mstore(add(ptr, 0x28), 0x5af43d82803e903d91602b57fd5bf30000000000000000000000000000000000)\n            instance := create2(0, ptr, 0x37, salt)\n        }", "highlightLines": [46]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/Clones.sol", "line": 46, "column": 9}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-shift-in-assembly"], "description": ""}, {"id": "6d1e1553249d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            let ptr := mload(0x40)\n            mstore(ptr, 0x3d602d80600a3d3981f3363d3d373d3d3d363d73000000000000000000000000)\n            mstore(add(ptr, 0x14), shl(0x60, implementation))\n            mstore(add(ptr, 0x28), 0x5af43d82803e903d91602b57fd5bf30000000000000000000000000000000000)\n            instance := create2(0, ptr, 0x37, salt)", "highlightLines": [47]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/Clones.sol", "line": 47, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "a0c873340597", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "            mstore(ptr, 0x3d602d80600a3d3981f3363d3d373d3d3d363d73000000000000000000000000)", "highlightLines": [48]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/Clones.sol", "line": 48, "column": 25}, "severity": "high", "references": [], "description": ""}, {"id": "0355cb236c88", "fix": {"template": null, "available": false}, "title": "EIP1167 minimal proxy clone - ensure initialization is protected", "ruleId": "rules.sol-eip1167-clone", "snippet": {"code": "            mstore(ptr, 0x3d602d80600a3d3981f3363d3d373d3d3d363d73000000000000000000000000)", "highlightLines": [48]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/Clones.sol", "line": 48, "column": 27}, "severity": "info", "references": [], "description": ""}, {"id": "04c8338aabf8", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "            mstore(add(ptr, 0x28), 0x5af43d82803e903d91602b57fd5bf30000000000000000000000000000000000)", "highlightLines": [50]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/Clones.sol", "line": 50, "column": 36}, "severity": "high", "references": [], "description": ""}, {"id": "191a3da0eb73", "fix": {"template": null, "available": false}, "title": "Contract deployment without chain ID - cross-chain replay attack possible (Wallet Mining pattern)", "ruleId": "rules.sol-cross-chain-deploy-no-chainid", "snippet": {"code": "            instance := create2(0, ptr, 0x37, salt)", "highlightLines": [51]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/Clones.sol", "line": 51, "column": 25}, "severity": "medium", "references": ["https://www.damnvulnerabledefi.xyz/challenges/wallet-mining/"], "description": ""}, {"id": "823183705fce", "fix": {"template": null, "available": false}, "title": "Raw bytecode deployment via create/create2 - verify bytecode source and intent (MagicNumber pattern)", "ruleId": "rules.sol-raw-bytecode-create", "snippet": {"code": "            instance := create2(0, ptr, 0x37, salt)", "highlightLines": [51]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/Clones.sol", "line": 51, "column": 25}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/18"], "description": ""}, {"id": "dc796c6cdea8", "fix": {"template": null, "available": false}, "title": "View/pure function uses assembly - may modify state unexpectedly", "ruleId": "rules.sol-constant-function-assembly", "snippet": {"code": "    function predictDeterministicAddress(\n        address implementation,\n        bytes32 salt,\n        address deployer\n    ) internal pure returns (address predicted) {\n        /// @solidity memory-safe-assembly\n        assembly {", "highlightLines": [59]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/Clones.sol", "line": 59, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-using-assembly-code"], "description": ""}, {"id": "9326c8e611b1", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [65]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/Clones.sol", "line": 65, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "4e5f3cdc8cfa", "fix": {"template": null, "available": false}, "title": "Incorrect shift in assembly - parameters may be reversed (value, shift vs shift, value)", "ruleId": "rules.sol-incorrect-shift-assembly", "snippet": {"code": "        assembly {\n            let ptr := mload(0x40)\n            mstore(ptr, 0x3d602d80600a3d3981f3363d3d373d3d3d363d73000000000000000000000000)\n            mstore(add(ptr, 0x14), shl(0x60, implementation))\n            mstore(add(ptr, 0x28), 0x5af43d82803e903d91602b57fd5bf3ff00000000000000000000000000000000)\n            mstore(add(ptr, 0x38), shl(0x60, deployer))\n            mstore(add(ptr, 0x4c), salt)\n            mstore(add(ptr, 0x6c), keccak256(ptr, 0x37))\n            predicted := keccak256(add(ptr, 0x37), 0x55)\n        }", "highlightLines": [65]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/Clones.sol", "line": 65, "column": 9}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-shift-in-assembly"], "description": ""}, {"id": "c4adcef19a94", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            let ptr := mload(0x40)\n            mstore(ptr, 0x3d602d80600a3d3981f3363d3d373d3d3d363d73000000000000000000000000)\n            mstore(add(ptr, 0x14), shl(0x60, implementation))\n            mstore(add(ptr, 0x28), 0x5af43d82803e903d91602b57fd5bf3ff00000000000000000000000000000000)\n            mstore(add(ptr, 0x38), shl(0x60, deployer))\n            mstore(add(ptr, 0x4c), salt)\n            mstore(add(ptr, 0x6c), keccak256(ptr, 0x37))\n            predicted := keccak256(add(ptr, 0x37), 0x55)", "highlightLines": [66]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/Clones.sol", "line": 66, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "c7893a9d5a23", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "            mstore(ptr, 0x3d602d80600a3d3981f3363d3d373d3d3d363d73000000000000000000000000)", "highlightLines": [67]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/Clones.sol", "line": 67, "column": 25}, "severity": "high", "references": [], "description": ""}, {"id": "91ad0040ff4a", "fix": {"template": null, "available": false}, "title": "EIP1167 minimal proxy clone - ensure initialization is protected", "ruleId": "rules.sol-eip1167-clone", "snippet": {"code": "            mstore(ptr, 0x3d602d80600a3d3981f3363d3d373d3d3d363d73000000000000000000000000)", "highlightLines": [67]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/Clones.sol", "line": 67, "column": 27}, "severity": "info", "references": [], "description": ""}, {"id": "18cdac52fda1", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "            mstore(add(ptr, 0x28), 0x5af43d82803e903d91602b57fd5bf3ff00000000000000000000000000000000)", "highlightLines": [69]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/Clones.sol", "line": 69, "column": 36}, "severity": "high", "references": [], "description": ""}, {"id": "8cf266092ec1", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/ERC1967/ERC1967Proxy.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "56cb8ca167ae", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(address _logic, bytes memory _data) payable {\n        _upgradeToAndCall(_logic, _data, false);\n    }", "highlightLines": [22]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/ERC1967/ERC1967Proxy.sol", "line": 22, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "a3df2922d552", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.2;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/ERC1967/ERC1967Upgrade.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "5b6c0939c7f4", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "    bytes32 private constant _ROLLBACK_SLOT = 0x4910fdfa16fed3260ed0e7147f7cc6da11a60208b5b9406d12a635614ffd9143;", "highlightLines": [21]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/ERC1967/ERC1967Upgrade.sol", "line": 21, "column": 47}, "severity": "high", "references": [], "description": ""}, {"id": "f19cf3454233", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "    bytes32 internal constant _IMPLEMENTATION_SLOT = 0x360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc;", "highlightLines": [28]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/ERC1967/ERC1967Upgrade.sol", "line": 28, "column": 54}, "severity": "high", "references": [], "description": ""}, {"id": "ff7c80084629", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Upgraded(address indexed implementation);", "highlightLines": [33]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/ERC1967/ERC1967Upgrade.sol", "line": 33, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "6964e6f659dc", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "            try IERC1822Proxiable(newImplementation).proxiableUUID() returns (bytes32 slot) {", "highlightLines": [92]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/ERC1967/ERC1967Upgrade.sol", "line": 92, "column": 17}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "68f0e5b22a82", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "    bytes32 internal constant _ADMIN_SLOT = 0xb53127684a568b3173ae13b9f8a6016e243e63b6e8ee1178d6a717850b5d6103;", "highlightLines": [106]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/ERC1967/ERC1967Upgrade.sol", "line": 106, "column": 45}, "severity": "high", "references": [], "description": ""}, {"id": "342310ba15c7", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event AdminChanged(address previousAdmin, address newAdmin);", "highlightLines": [111]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/ERC1967/ERC1967Upgrade.sol", "line": 111, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "c5048b05cc7b", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event AdminChanged(address previousAdmin, address newAdmin);", "highlightLines": [111]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/ERC1967/ERC1967Upgrade.sol", "line": 111, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "a1befead3c17", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "    bytes32 internal constant _BEACON_SLOT = 0xa3f0ad74e5423aebfd80d3ef4346578335a9a72aeaee59ff6cb3582b35133d50;", "highlightLines": [142]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/ERC1967/ERC1967Upgrade.sol", "line": 142, "column": 46}, "severity": "high", "references": [], "description": ""}, {"id": "62b09e3f0755", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event BeaconUpgraded(address indexed beacon);", "highlightLines": [147]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/ERC1967/ERC1967Upgrade.sol", "line": 147, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "62dc2df721da", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "            Address.isContract(IBeacon(newBeacon).implementation()),", "highlightLines": [162]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/ERC1967/ERC1967Upgrade.sol", "line": 162, "column": 32}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "00c3037c5f38", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "            Address.functionDelegateCall(IBeacon(newBeacon).implementation(), data);", "highlightLines": [182]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/ERC1967/ERC1967Upgrade.sol", "line": 182, "column": 42}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "74fe980bc3ad", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/Proxy.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "6e7c09bdec0a", "fix": {"template": null, "available": false}, "title": "Potential mnemonic seed phrase detected - CRITICAL if real", "ruleId": "rules._shared.shared-mnemonic-phrase", "snippet": {"code": " * @dev This abstract contract provides a fallback function that delegates all calls to another contract using the EVM", "highlightLines": [7]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/Proxy.sol", "line": 7, "column": 14}, "severity": "high", "references": [], "description": ""}, {"id": "35aed3574f15", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [23]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/Proxy.sol", "line": 23, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "90cbb231a7ca", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "     * This function does not return to its internal call site, it will return directly to the external caller.\n     */\n    function _fallback() internal virtual {\n        _beforeFallback();\n        _delegate(_implementation());", "highlightLines": [56]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/Proxy.sol", "line": 56, "column": 31}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "e4eb75074664", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/beacon/BeaconProxy.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "a1a968777b37", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(address beacon, bytes memory data) payable {\n        _upgradeBeaconToAndCall(beacon, data, false);\n    }", "highlightLines": [30]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/beacon/BeaconProxy.sol", "line": 30, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "dfeb433434e3", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/beacon/IBeacon.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "c155bb01f908", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/beacon/UpgradeableBeacon.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "03bea4478161", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "contract UpgradeableBeacon is IBeacon, Ownable {", "highlightLines": [16]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/beacon/UpgradeableBeacon.sol", "line": 16, "column": 1}, "severity": "medium", "references": [], "description": ""}, {"id": "5665b3972219", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract UpgradeableBeacon is IBeacon, Ownable {\n    address private _implementation;", "highlightLines": [16]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/beacon/UpgradeableBeacon.sol", "line": 16, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "56c4814eab49", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Upgraded(address indexed implementation);", "highlightLines": [22]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/beacon/UpgradeableBeacon.sol", "line": 22, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "7a09beac92e6", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(address implementation_) {\n        _setImplementation(implementation_);\n    }", "highlightLines": [28]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/beacon/UpgradeableBeacon.sol", "line": 28, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "d8dfc449a718", "fix": {"template": null, "available": false}, "title": "Diamond upgrade function without timelock - instant rug pull possible", "ruleId": "rules.sol-diamond-upgrade-no-timelock", "snippet": {"code": "    function upgradeTo(address newImplementation) public virtual onlyOwner {", "highlightLines": [49]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/beacon/UpgradeableBeacon.sol", "line": 49, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "87befc92efc2", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function upgradeTo(address newImplementation) public virtual onlyOwner {", "highlightLines": [49]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/beacon/UpgradeableBeacon.sol", "line": 49, "column": 66}, "severity": "info", "references": [], "description": ""}, {"id": "4da23b4a2767", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/transparent/ProxyAdmin.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "979f9d4d713d", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(success);", "highlightLines": [25]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/transparent/ProxyAdmin.sol", "line": 25, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "e4123f15d430", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(success);", "highlightLines": [40]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/transparent/ProxyAdmin.sol", "line": 40, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "31ecbdefb374", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function changeProxyAdmin(TransparentUpgradeableProxy proxy, address newAdmin) public virtual onlyOwner {", "highlightLines": [51]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/transparent/ProxyAdmin.sol", "line": 51, "column": 99}, "severity": "info", "references": [], "description": ""}, {"id": "38b6652a9c35", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function upgrade(TransparentUpgradeableProxy proxy, address implementation) public virtual onlyOwner {", "highlightLines": [62]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/transparent/ProxyAdmin.sol", "line": 62, "column": 96}, "severity": "info", "references": [], "description": ""}, {"id": "025035166800", "fix": {"template": null, "available": false}, "title": "Owner has excessive privileges - single account controls critical functions without checks", "ruleId": "rules.sol-owner-privilege-escalation", "snippet": {"code": "    function upgrade(TransparentUpgradeableProxy proxy, address implementation) public virtual onlyOwner {\n        proxy.upgradeTo(implementation);", "highlightLines": [62]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/transparent/ProxyAdmin.sol", "line": 62, "column": 96}, "severity": "medium", "references": [], "description": ""}, {"id": "1910220de232", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    ) public payable virtual onlyOwner {", "highlightLines": [78]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/transparent/ProxyAdmin.sol", "line": 78, "column": 30}, "severity": "info", "references": [], "description": ""}, {"id": "865899eaca5f", "fix": {"template": null, "available": false}, "title": "Owner has excessive privileges - single account controls critical functions without checks", "ruleId": "rules.sol-owner-privilege-escalation", "snippet": {"code": "    ) public payable virtual onlyOwner {\n        proxy.upgradeToAndCall{value: msg.value}(implementation, data);", "highlightLines": [78]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/transparent/ProxyAdmin.sol", "line": 78, "column": 30}, "severity": "medium", "references": [], "description": ""}, {"id": "aedc1912c1a4", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/transparent/TransparentUpgradeableProxy.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "d0ffc57211e4", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(\n        address _logic,\n        address admin_,\n        bytes memory _data\n    ) payable ERC1967Proxy(_logic, _data) {\n        _changeAdmin(admin_);\n    }", "highlightLines": [34]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/transparent/TransparentUpgradeableProxy.sol", "line": 34, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "60c559eef9c5", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "    modifier ifAdmin() {\n        if (msg.sender == _getAdmin()) {\n            _;\n        } else {", "highlightLines": [45]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/transparent/TransparentUpgradeableProxy.sol", "line": 45, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "7648d87758c3", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier ifAdmin() {\n        if (msg.sender == _getAdmin()) {\n            _;\n        } else {\n            _fallback();\n        }\n    }", "highlightLines": [45]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/transparent/TransparentUpgradeableProxy.sol", "line": 45, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "68bafe14b677", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "            _;", "highlightLines": [47]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/transparent/TransparentUpgradeableProxy.sol", "line": 47, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "0e814000244e", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "     * `0xb53127684a568b3173ae13b9f8a6016e243e63b6e8ee1178d6a717850b5d6103`", "highlightLines": [60]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/transparent/TransparentUpgradeableProxy.sol", "line": 60, "column": 9}, "severity": "high", "references": [], "description": ""}, {"id": "deba7b46e431", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "     * `0x360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc`", "highlightLines": [73]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/transparent/TransparentUpgradeableProxy.sol", "line": 73, "column": 9}, "severity": "high", "references": [], "description": ""}, {"id": "4b89adddd3a5", "fix": {"template": null, "available": false}, "title": "Diamond upgrade function without timelock - instant rug pull possible", "ruleId": "rules.sol-diamond-upgrade-no-timelock", "snippet": {"code": "    function upgradeTo(address newImplementation) external ifAdmin {", "highlightLines": [95]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/transparent/TransparentUpgradeableProxy.sol", "line": 95, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "9821d1c14ee3", "fix": {"template": null, "available": false}, "title": "Proxy upgrade executable immediately - malicious upgrade can drain funds before users react", "ruleId": "rules.sol-proxy-upgrade-no-delay", "snippet": {"code": "    function upgradeTo(address newImplementation) external ifAdmin {", "highlightLines": [95]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/transparent/TransparentUpgradeableProxy.sol", "line": 95, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "e1df65ae7124", "fix": {"template": null, "available": false}, "title": "Proxy upgrade executable immediately - malicious upgrade can drain funds before users react", "ruleId": "rules.sol-proxy-upgrade-no-delay", "snippet": {"code": "    function upgradeToAndCall(address newImplementation, bytes calldata data) external payable ifAdmin {", "highlightLines": [106]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/transparent/TransparentUpgradeableProxy.sol", "line": 106, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "cd629d358088", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.2;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/utils/Initializable.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "36f3918e5dca", "fix": {"template": null, "available": false}, "title": "Upgradeable contract without storage gap - adding variables in parent will corrupt child storage", "ruleId": "rules.sol-missing-storage-gap", "snippet": {"code": " * contract MyToken is ERC20Upgradeable {", "highlightLines": [22]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/utils/Initializable.sol", "line": 22, "column": 4}, "severity": "medium", "references": ["https://docs.openzeppelin.com/upgrades-plugins/writing-upgradeable"], "description": ""}, {"id": "412f79aad4ee", "fix": {"template": null, "available": false}, "title": "Initializer function not protected - can be called multiple times", "ruleId": "rules.sol-initializer-not-protected", "snippet": {"code": " *     function initialize() initializer public {", "highlightLines": [23]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/utils/Initializable.sol", "line": 23, "column": 8}, "severity": "high", "references": [], "description": ""}, {"id": "5a5996961530", "fix": {"template": null, "available": false}, "title": "Upgradeable contract without storage gap - adding variables in parent will corrupt child storage", "ruleId": "rules.sol-missing-storage-gap", "snippet": {"code": " * contract MyTokenV2 is MyToken, ERC20PermitUpgradeable {", "highlightLines": [27]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/utils/Initializable.sol", "line": 27, "column": 4}, "severity": "medium", "references": ["https://docs.openzeppelin.com/upgrades-plugins/writing-upgradeable"], "description": ""}, {"id": "17ae3d39db74", "fix": {"template": null, "available": false}, "title": "Initializer function not protected - can be called multiple times", "ruleId": "rules.sol-initializer-not-protected", "snippet": {"code": " *     function initializeV2() reinitializer(2) public {", "highlightLines": [28]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/utils/Initializable.sol", "line": 28, "column": 8}, "severity": "high", "references": [], "description": ""}, {"id": "90b2ebb8cecd", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event Initialized(uint8 version);", "highlightLines": [72]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/utils/Initializable.sol", "line": 72, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "06465e82c180", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier initializer() {\n        bool isTopLevelCall = !_initializing;\n        require(\n            (isTopLevelCall && _initialized < 1) || (!Address.isContract(address(this)) && _initialized == 1),\n            \"Initializable: contract is already initialized\"\n        );\n        _initialized = 1;\n        if (isTopLevelCall) {\n            _initializing = true;\n        }\n        _;\n        if (isTopLevelCall) {\n            _initializing = false;\n            emit Initialized(1);\n        }\n    }", "highlightLines": [78]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/utils/Initializable.sol", "line": 78, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "f072580c7578", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool isTopLevelCall = !_initializing;", "highlightLines": [79]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/utils/Initializable.sol", "line": 79, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "1d45dc8e0dd4", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bool isTopLevelCall = !_initializing;\n        require(\n            (isTopLevelCall && _initialized < 1) || (!Address.isContract(address(this)) && _initialized == 1),\n            \"Initializable: contract is already initialized\"\n        );\n        _initialized = 1;", "highlightLines": [79]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/utils/Initializable.sol", "line": 79, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "03ef831a8eea", "fix": {"template": null, "available": false}, "title": "Variable written twice without being read between - first write is dead store", "ruleId": "rules.sol-write-after-write", "snippet": {"code": "            (isTopLevelCall && _initialized < 1) || (!Address.isContract(address(this)) && _initialized == 1),\n            \"Initializable: contract is already initialized\"\n        );\n        _initialized = 1;", "highlightLines": [81]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/utils/Initializable.sol", "line": 81, "column": 92}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#write-after-write"], "description": ""}, {"id": "0c0cedce66a2", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        _initialized = 1;\n        if (isTopLevelCall) {\n            _initializing = true;\n        }", "highlightLines": [84]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/utils/Initializable.sol", "line": 84, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "c08dd4f1afb6", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [88]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/utils/Initializable.sol", "line": 88, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "51d476b93c85", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier reinitializer(uint8 version) {\n        require(!_initializing && _initialized < version, \"Initializable: contract is already initialized\");\n        _initialized = version;\n        _initializing = true;\n        _;\n        _initializing = false;\n        emit Initialized(version);\n    }", "highlightLines": [107]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/utils/Initializable.sol", "line": 107, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "dc4ce6e37ffb", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "    modifier reinitializer(uint8 version) {\n        require(!_initializing && _initialized < version, \"Initializable: contract is already initialized\");\n        _initialized = version;\n        _initializing = true;\n        _;\n        _initializing = false;\n        emit Initialized(version);\n    }", "highlightLines": [107]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/utils/Initializable.sol", "line": 107, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "c1e49168d6ca", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        _initialized = version;\n        _initializing = true;", "highlightLines": [109]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/utils/Initializable.sol", "line": 109, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "fb9cf5dce294", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        _initializing = true;\n        _;\n        _initializing = false;", "highlightLines": [110]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/utils/Initializable.sol", "line": 110, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "b5d434a1dc99", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [111]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/utils/Initializable.sol", "line": 111, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "2c74eaa11b83", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyInitializing() {\n        require(_initializing, \"Initializable: contract is not initializing\");\n        _;\n    }", "highlightLines": [120]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/utils/Initializable.sol", "line": 120, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "9735590cb041", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "    modifier onlyInitializing() {\n        require(_initializing, \"Initializable: contract is not initializing\");\n        _;\n    }", "highlightLines": [120]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/utils/Initializable.sol", "line": 120, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "dc2514cf7fd5", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [122]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/utils/Initializable.sol", "line": 122, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "9d9a6b021481", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/utils/UUPSUpgradeable.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "cd59ed546ace", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "abstract contract UUPSUpgradeable is IERC1822Proxiable, ERC1967Upgrade {", "highlightLines": [21]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/utils/UUPSUpgradeable.sol", "line": 21, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "ffa1a3c65f4a", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyProxy() {\n        require(address(this) != __self, \"Function must be called through delegatecall\");\n        require(_getImplementation() == __self, \"Function must be called through active proxy\");\n        _;\n    }", "highlightLines": [32]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/utils/UUPSUpgradeable.sol", "line": 32, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "1723a1e79007", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [35]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/utils/UUPSUpgradeable.sol", "line": 35, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "a400093ca883", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier notDelegated() {\n        require(address(this) == __self, \"UUPSUpgradeable: must not be called through delegatecall\");\n        _;\n    }", "highlightLines": [42]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/utils/UUPSUpgradeable.sol", "line": 42, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "ea4e5226869b", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "    modifier notDelegated() {\n        require(address(this) == __self, \"UUPSUpgradeable: must not be called through delegatecall\");\n        _;\n    }", "highlightLines": [42]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/utils/UUPSUpgradeable.sol", "line": 42, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "eca15e9e1391", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [44]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/utils/UUPSUpgradeable.sol", "line": 44, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "08a21a357c78", "fix": {"template": null, "available": false}, "title": "Diamond upgrade function without timelock - instant rug pull possible", "ruleId": "rules.sol-diamond-upgrade-no-timelock", "snippet": {"code": "    function upgradeTo(address newImplementation) external virtual onlyProxy {", "highlightLines": [66]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/utils/UUPSUpgradeable.sol", "line": 66, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "5c3173c80cf7", "fix": {"template": null, "available": false}, "title": "Proxy upgrade executable immediately - malicious upgrade can drain funds before users react", "ruleId": "rules.sol-proxy-upgrade-no-delay", "snippet": {"code": "    function upgradeTo(address newImplementation) external virtual onlyProxy {", "highlightLines": [66]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/utils/UUPSUpgradeable.sol", "line": 66, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "4e4adb7a845a", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        _upgradeToAndCallUUPS(newImplementation, new bytes(0), false);", "highlightLines": [68]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/utils/UUPSUpgradeable.sol", "line": 68, "column": 50}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "a6c25c4d4301", "fix": {"template": null, "available": false}, "title": "Proxy upgrade executable immediately - malicious upgrade can drain funds before users react", "ruleId": "rules.sol-proxy-upgrade-no-delay", "snippet": {"code": "    function upgradeToAndCall(address newImplementation, bytes memory data) external payable virtual onlyProxy {", "highlightLines": [79]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/utils/UUPSUpgradeable.sol", "line": 79, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "26a9ced48f36", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function _authorizeUpgrade(address newImplementation) internal virtual;", "highlightLines": [94]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/proxy/utils/UUPSUpgradeable.sol", "line": 94, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "9505caba6d38", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/security/Pausable.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "daaaee030cec", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "abstract contract Pausable is Context {\n    /**\n     * @dev Emitted when the pause is triggered by `account`.\n     */\n    event Paused(address account);\n\n    /**\n     * @dev Emitted when the pause is lifted by `account`.\n     */\n    event Unpaused(address account);\n\n    bool private _paused;", "highlightLines": [17]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/security/Pausable.sol", "line": 17, "column": 10}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "1c41234ae87f", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event Paused(address account);", "highlightLines": [21]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/security/Pausable.sol", "line": 21, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "a687e0e7b1b1", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Paused(address account);", "highlightLines": [21]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/security/Pausable.sol", "line": 21, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "d87081653f81", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event Unpaused(address account);", "highlightLines": [26]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/security/Pausable.sol", "line": 26, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "c63a42108f76", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Unpaused(address account);", "highlightLines": [26]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/security/Pausable.sol", "line": 26, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "a555052ca465", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor() {\n        _paused = false;\n    }", "highlightLines": [33]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/security/Pausable.sol", "line": 33, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "ab2cb1b832f6", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier whenNotPaused() {\n        _requireNotPaused();\n        _;\n    }", "highlightLines": [44]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/security/Pausable.sol", "line": 44, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "33b8680c9723", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [46]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/security/Pausable.sol", "line": 46, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "f4f53714834f", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier whenPaused() {\n        _requirePaused();\n        _;\n    }", "highlightLines": [56]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/security/Pausable.sol", "line": 56, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "df160a31e3c1", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "    modifier whenPaused() {\n        _requirePaused();\n        _;\n    }", "highlightLines": [56]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/security/Pausable.sol", "line": 56, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "437ac1646ea4", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [58]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/security/Pausable.sol", "line": 58, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "8cd70a9a31ff", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/security/PullPayment.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "512a366c88d8", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor() {\n        _escrow = new Escrow();\n    }", "highlightLines": [29]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/security/PullPayment.sol", "line": 29, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "b6ca13a33059", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        _escrow = new Escrow();", "highlightLines": [30]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/security/PullPayment.sol", "line": 30, "column": 19}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "02b79f84cac9", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/security/ReentrancyGuard.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "ab504c288530", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor() {\n        _status = _NOT_ENTERED;\n    }", "highlightLines": [39]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/security/ReentrancyGuard.sol", "line": 39, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "f3539df1e108", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier nonReentrant() {\n        _nonReentrantBefore();\n        _;\n        _nonReentrantAfter();\n    }", "highlightLines": [50]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/security/ReentrancyGuard.sol", "line": 50, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "6fb542ce80a0", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "    modifier nonReentrant() {\n        _nonReentrantBefore();\n        _;\n        _nonReentrantAfter();\n    }", "highlightLines": [50]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/security/ReentrancyGuard.sol", "line": 50, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "4266fb8e5027", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [52]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/security/ReentrancyGuard.sol", "line": 52, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "9168bf073dcc", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "7497fccfacbf", "fix": {"template": null, "available": false}, "title": "Base constructor called multiple times through diamond inheritance - may initialize twice", "ruleId": "rules.sol-reused-constructor", "snippet": {"code": "contract ERC1155 is Context, ERC165, IERC1155, IERC1155MetadataURI {", "highlightLines": [20]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 20, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#reused-base-constructor"], "description": ""}, {"id": "9405d204a04c", "fix": {"template": null, "available": false}, "title": "SWC-125: Multiple inheritance may cause incorrect function resolution - check C3 linearization", "ruleId": "rules.sol-swc-125-inheritance-order", "snippet": {"code": "contract ERC1155 is Context, ERC165, IERC1155, IERC1155MetadataURI {", "highlightLines": [20]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 20, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-125"], "description": ""}, {"id": "51324092551c", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "contract ERC1155 is Context, ERC165, IERC1155, IERC1155MetadataURI {", "highlightLines": [20]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 20, "column": 1}, "severity": "medium", "references": [], "description": ""}, {"id": "bf60ceb0da45", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "contract ERC1155 is Context, ERC165, IERC1155, IERC1155MetadataURI {", "highlightLines": [20]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 20, "column": 38}, "severity": "info", "references": [], "description": ""}, {"id": "510d55f4a6b3", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(string memory uri_) {\n        _setURI(uri_);\n    }", "highlightLines": [35]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 35, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "c31e954725aa", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function supportsInterface(bytes4 interfaceId) public view virtual override(ERC165, IERC165) returns (bool) {\n        return\n            interfaceId == type(IERC1155).interfaceId ||\n            interfaceId == type(IERC1155MetadataURI).interfaceId ||", "highlightLines": [42]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 42, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "3f1d01b8a37d", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function balanceOfBatch(address[] memory accounts, uint256[] memory ids)\n        public\n        view\n        virtual\n        override\n        returns (uint256[] memory)\n    {\n        require(accounts.length == ids.length, \"ERC1155: accounts and ids length mismatch\");\n\n        uint256[] memory batchBalances = new uint256[](accounts.length);\n\n        for (uint256 i = 0; i < accounts.length; ++i) {", "highlightLines": [82]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 82, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "cda3a1718e4c", "fix": {"template": null, "available": false}, "title": "View function reads state that may be stale during callback - read-only reentrancy risk", "ruleId": "rules.sol-read-only-reentrancy", "snippet": {"code": "    function balanceOfBatch(address[] memory accounts, uint256[] memory ids)\n        public\n        view\n        virtual\n        override\n        returns (uint256[] memory)\n    {\n        require(accounts.length == ids.length, \"ERC1155: accounts and ids length mismatch\");\n\n        uint256[] memory batchBalances = new uint256[](accounts.length);\n\n        for (uint256 i = 0; i < accounts.length; ++i) {\n            batchBalances[i] = balanceOf(accounts[i], ids[i]);", "highlightLines": [82]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 82, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs", "https://chainsecurity.com/curve-lp-oracle-manipulation-post-mortem/"], "description": ""}, {"id": "c5c7d517816d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256[] memory batchBalances = new uint256[](accounts.length);\n\n        for (uint256 i = 0; i < accounts.length; ++i) {\n            batchBalances[i] = balanceOf(accounts[i], ids[i]);\n        }", "highlightLines": [91]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 91, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "f70b0cf03cb0", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        uint256[] memory batchBalances = new uint256[](accounts.length);", "highlightLines": [91]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 91, "column": 42}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "2881ff8abfec", "fix": {"template": null, "available": false}, "title": "Loop iterates over all protocols/users - one failure blocks entire operation", "ruleId": "rules.sol-iterate-all-protocols", "snippet": {"code": "        for (uint256 i = 0; i < accounts.length; ++i) {", "highlightLines": [93]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 93, "column": 9}, "severity": "high", "references": [], "description": ""}, {"id": "e2dd2bccd32e", "fix": {"template": null, "available": false}, "title": "Storage variable modified in loop - should cache in memory for gas savings", "ruleId": "rules.sol-memory-vs-storage-loop", "snippet": {"code": "        for (uint256 i = 0; i < accounts.length; ++i) {\n            batchBalances[i] = balanceOf(accounts[i], ids[i]);", "highlightLines": [93]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 93, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "ae3260381440", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function safeTransferFrom(\n        address from,\n        address to,\n        uint256 id,\n        uint256 amount,\n        bytes memory data\n    ) public virtual override {\n        require(\n            from == _msgSender() || isApprovedForAll(from, _msgSender()),", "highlightLines": [117]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 117, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "b00ea8d8fd65", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function safeBatchTransferFrom(\n        address from,\n        address to,\n        uint256[] memory ids,\n        uint256[] memory amounts,\n        bytes memory data\n    ) public virtual override {\n        require(\n            from == _msgSender() || isApprovedForAll(from, _msgSender()),", "highlightLines": [134]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 134, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "4420681f507f", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "     * - If `to` refers to a smart contract, it must implement {IERC1155Receiver-onERC1155Received} and return the\n     * acceptance magic value.\n     */\n    function _safeTransferFrom(\n        address from,\n        address to,\n        uint256 id,\n        uint256 amount,\n        bytes memory data\n    ) internal virtual {\n        require(to != address(0), \"ERC1155: transfer to the zero address\");\n\n        address operator = _msgSender();", "highlightLines": [157]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 157, "column": 105}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "eff02c4e7315", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        address operator = _msgSender();", "highlightLines": [168]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 168, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "1d1f0b7e21fb", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address operator = _msgSender();\n        uint256[] memory ids = _asSingletonArray(id);", "highlightLines": [169]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 169, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "06c3a31d45ef", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256[] memory ids = _asSingletonArray(id);\n        uint256[] memory amounts = _asSingletonArray(amount);", "highlightLines": [170]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 170, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "7353dbb1e8c2", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256[] memory amounts = _asSingletonArray(amount);\n\n        _beforeTokenTransfer(operator, from, to, ids, amounts, data);\n\n        uint256 fromBalance = _balances[id][from];", "highlightLines": [171]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 171, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e4ee5a7b33de", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 fromBalance = _balances[id][from];", "highlightLines": [174]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 174, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e6f81f70d1cd", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 fromBalance = _balances[id][from];\n        require(fromBalance >= amount, \"ERC1155: insufficient balance for transfer\");\n        unchecked {\n            _balances[id][from] = fromBalance - amount;\n        }", "highlightLines": [175]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 175, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "b443bb318a12", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "            _balances[id][from] = fromBalance - amount;", "highlightLines": [178]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 178, "column": 35}, "severity": "medium", "references": [], "description": ""}, {"id": "55058a4189e0", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "     * - If `to` refers to a smart contract, it must implement {IERC1155Receiver-onERC1155BatchReceived} and return the\n     * acceptance magic value.\n     */\n    function _safeBatchTransferFrom(\n        address from,\n        address to,\n        uint256[] memory ids,\n        uint256[] memory amounts,\n        bytes memory data\n    ) internal virtual {\n        require(ids.length == amounts.length, \"ERC1155: ids and amounts length mismatch\");\n        require(to != address(0), \"ERC1155: transfer to the zero address\");", "highlightLines": [196]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 196, "column": 110}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "f62337d963db", "fix": {"template": null, "available": false}, "title": "Storage array passed by value to internal function - changes won't persist", "ruleId": "rules.sol-array-by-reference", "snippet": {"code": "    function _safeBatchTransferFrom(\n        address from,\n        address to,\n        uint256[] memory ids,\n        uint256[] memory amounts,\n        bytes memory data\n    ) internal virtual {", "highlightLines": [199]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 199, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#modifying-storage-array-by-value"], "description": ""}, {"id": "5b8667585465", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        address operator = _msgSender();", "highlightLines": [208]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 208, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "08aecf79bcf2", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address operator = _msgSender();\n\n        _beforeTokenTransfer(operator, from, to, ids, amounts, data);\n\n        for (uint256 i = 0; i < ids.length; ++i) {\n            uint256 id = ids[i];\n            uint256 amount = amounts[i];\n\n            uint256 fromBalance = _balances[id][from];\n            require(fromBalance >= amount, \"ERC1155: insufficient balance for transfer\");\n            unchecked {\n                _balances[id][from] = fromBalance - amount;\n            }\n            _balances[id][to] += amount;\n        }", "highlightLines": [209]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 209, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "4d6d636cef1c", "fix": {"template": null, "available": false}, "title": "Unbounded loop iterating over dynamic array - can cause out-of-gas DoS", "ruleId": "rules.sol-unbounded-loop-dos", "snippet": {"code": "        for (uint256 i = 0; i < ids.length; ++i) {\n            uint256 id = ids[i];\n            uint256 amount = amounts[i];\n\n            uint256 fromBalance = _balances[id][from];\n            require(fromBalance >= amount, \"ERC1155: insufficient balance for transfer\");", "highlightLines": [213]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 213, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "4d15e76b185d", "fix": {"template": null, "available": false}, "title": "Unbounded loop over dynamic array - can cause DoS if array grows large", "ruleId": "rules.sol-unbounded-protocol-loop", "snippet": {"code": "        for (uint256 i = 0; i < ids.length; ++i) {\n            uint256 id = ids[i];\n            uint256 amount = amounts[i];\n\n            uint256 fromBalance = _balances[id][from];\n            require(fromBalance >= amount, \"ERC1155: insufficient balance for transfer\");", "highlightLines": [213]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 213, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "2df5cbc8a54f", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint256 id = ids[i];", "highlightLines": [214]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 214, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e278f117713b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            uint256 id = ids[i];\n            uint256 amount = amounts[i];", "highlightLines": [214]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 214, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "f51b4987bba0", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint256 amount = amounts[i];", "highlightLines": [215]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 215, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "33bc9ce4f586", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            uint256 amount = amounts[i];\n\n            uint256 fromBalance = _balances[id][from];", "highlightLines": [215]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 215, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "5ce911d818c6", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n            uint256 fromBalance = _balances[id][from];", "highlightLines": [216]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 216, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "9d98c5ba7a92", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            uint256 fromBalance = _balances[id][from];\n            require(fromBalance >= amount, \"ERC1155: insufficient balance for transfer\");\n            unchecked {\n                _balances[id][from] = fromBalance - amount;\n            }", "highlightLines": [217]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 217, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "6027e35a4afa", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "                _balances[id][from] = fromBalance - amount;", "highlightLines": [220]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 220, "column": 39}, "severity": "medium", "references": [], "description": ""}, {"id": "9fb7d243317a", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "     * - If `to` refers to a smart contract, it must implement {IERC1155Receiver-onERC1155Received} and return the\n     * acceptance magic value.\n     */\n    function _mint(\n        address to,\n        uint256 id,\n        uint256 amount,\n        bytes memory data\n    ) internal virtual {\n        require(to != address(0), \"ERC1155: mint to the zero address\");\n\n        address operator = _msgSender();", "highlightLines": [263]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 263, "column": 105}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "3d6952b139b5", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        address operator = _msgSender();", "highlightLines": [273]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 273, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3d89a6119a85", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address operator = _msgSender();\n        uint256[] memory ids = _asSingletonArray(id);", "highlightLines": [274]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 274, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "2090ce49a682", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256[] memory ids = _asSingletonArray(id);\n        uint256[] memory amounts = _asSingletonArray(amount);", "highlightLines": [275]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 275, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d9852cab0e9e", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "     * - If `to` refers to a smart contract, it must implement {IERC1155Receiver-onERC1155BatchReceived} and return the\n     * acceptance magic value.\n     */\n    function _mintBatch(\n        address to,\n        uint256[] memory ids,\n        uint256[] memory amounts,\n        bytes memory data\n    ) internal virtual {\n        require(to != address(0), \"ERC1155: mint to the zero address\");\n        require(ids.length == amounts.length, \"ERC1155: ids and amounts length mismatch\");", "highlightLines": [296]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 296, "column": 110}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "8be1dac6d8b5", "fix": {"template": null, "available": false}, "title": "Storage array passed by value to internal function - changes won't persist", "ruleId": "rules.sol-array-by-reference", "snippet": {"code": "    function _mintBatch(\n        address to,\n        uint256[] memory ids,\n        uint256[] memory amounts,\n        bytes memory data\n    ) internal virtual {", "highlightLines": [299]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 299, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#modifying-storage-array-by-value"], "description": ""}, {"id": "eb8c730bd41b", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        address operator = _msgSender();", "highlightLines": [307]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 307, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "356ca84624ed", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        address operator = _msgSender();", "highlightLines": [339]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 339, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b4190bef5735", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address operator = _msgSender();\n        uint256[] memory ids = _asSingletonArray(id);", "highlightLines": [340]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 340, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "517bb56ce404", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256[] memory ids = _asSingletonArray(id);\n        uint256[] memory amounts = _asSingletonArray(amount);", "highlightLines": [341]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 341, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d6839c833063", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256[] memory amounts = _asSingletonArray(amount);\n\n        _beforeTokenTransfer(operator, from, address(0), ids, amounts, \"\");\n\n        uint256 fromBalance = _balances[id][from];", "highlightLines": [342]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 342, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "c8a05204cdfb", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 fromBalance = _balances[id][from];", "highlightLines": [345]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 345, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "1fd73dddd54c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 fromBalance = _balances[id][from];\n        require(fromBalance >= amount, \"ERC1155: burn amount exceeds balance\");\n        unchecked {\n            _balances[id][from] = fromBalance - amount;\n        }", "highlightLines": [346]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 346, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "bcc72c8f2ec4", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "            _balances[id][from] = fromBalance - amount;", "highlightLines": [349]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 349, "column": 35}, "severity": "medium", "references": [], "description": ""}, {"id": "6236bea9897f", "fix": {"template": null, "available": false}, "title": "Storage array passed by value to internal function - changes won't persist", "ruleId": "rules.sol-array-by-reference", "snippet": {"code": "    function _burnBatch(\n        address from,\n        uint256[] memory ids,\n        uint256[] memory amounts\n    ) internal virtual {", "highlightLines": [366]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 366, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#modifying-storage-array-by-value"], "description": ""}, {"id": "b0ff504a6fb2", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        address operator = _msgSender();", "highlightLines": [373]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 373, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7ac6a8d5842d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address operator = _msgSender();\n\n        _beforeTokenTransfer(operator, from, address(0), ids, amounts, \"\");\n\n        for (uint256 i = 0; i < ids.length; i++) {\n            uint256 id = ids[i];\n            uint256 amount = amounts[i];\n\n            uint256 fromBalance = _balances[id][from];\n            require(fromBalance >= amount, \"ERC1155: burn amount exceeds balance\");\n            unchecked {\n                _balances[id][from] = fromBalance - amount;\n            }\n        }", "highlightLines": [374]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 374, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "db39f938a751", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint256 id = ids[i];", "highlightLines": [379]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 379, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "9572d7d11afa", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            uint256 id = ids[i];\n            uint256 amount = amounts[i];", "highlightLines": [379]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 379, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "fd2066b69d21", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint256 amount = amounts[i];", "highlightLines": [380]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 380, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "2f67d301bb16", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            uint256 amount = amounts[i];\n\n            uint256 fromBalance = _balances[id][from];", "highlightLines": [380]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 380, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "21a7066467ce", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n            uint256 fromBalance = _balances[id][from];", "highlightLines": [381]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 381, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "9794e49cafae", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            uint256 fromBalance = _balances[id][from];\n            require(fromBalance >= amount, \"ERC1155: burn amount exceeds balance\");\n            unchecked {\n                _balances[id][from] = fromBalance - amount;\n            }", "highlightLines": [382]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 382, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "377abd52fb19", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "                _balances[id][from] = fromBalance - amount;", "highlightLines": [385]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 385, "column": 39}, "severity": "medium", "references": [], "description": ""}, {"id": "a6a65fc4e0bf", "fix": {"template": null, "available": false}, "title": "Storage array passed by value to internal function - changes won't persist", "ruleId": "rules.sol-array-by-reference", "snippet": {"code": "    function _beforeTokenTransfer(\n        address operator,\n        address from,\n        address to,\n        uint256[] memory ids,\n        uint256[] memory amounts,\n        bytes memory data\n    ) internal virtual {}", "highlightLines": [429]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 429, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#modifying-storage-array-by-value"], "description": ""}, {"id": "099379180d37", "fix": {"template": null, "available": false}, "title": "Storage array passed by value to internal function - changes won't persist", "ruleId": "rules.sol-array-by-reference", "snippet": {"code": "    function _afterTokenTransfer(\n        address operator,\n        address from,\n        address to,\n        uint256[] memory ids,\n        uint256[] memory amounts,\n        bytes memory data\n    ) internal virtual {}", "highlightLines": [458]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 458, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#modifying-storage-array-by-value"], "description": ""}, {"id": "dbd683fba43a", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "            try IERC1155Receiver(to).onERC1155Received(operator, from, id, amount, data) returns (bytes4 response) {", "highlightLines": [476]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 476, "column": 17}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "888980fa03da", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "            try IERC1155Receiver(to).onERC1155BatchReceived(operator, from, ids, amounts, data) returns (", "highlightLines": [497]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 497, "column": 17}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "1d4b0cc2a110", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function _asSingletonArray(uint256 element) private pure returns (uint256[] memory) {\n        uint256[] memory array = new uint256[](1);", "highlightLines": [511]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 511, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "d26561a204b3", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256[] memory array = new uint256[](1);\n        array[0] = element;", "highlightLines": [512]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 512, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "50365da62c63", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        uint256[] memory array = new uint256[](1);", "highlightLines": [512]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol", "line": 512, "column": 34}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "178af94312ee", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/IERC1155.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "b82668d978c4", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event TransferSingle(address indexed operator, address indexed from, address indexed to, uint256 id, uint256 value);", "highlightLines": [18]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/IERC1155.sol", "line": 18, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "c150a952c6cc", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event TransferBatch(\n        address indexed operator,\n        address indexed from,\n        address indexed to,\n        uint256[] ids,\n        uint256[] values\n    );", "highlightLines": [24]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/IERC1155.sol", "line": 24, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "15a475836772", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event TransferBatch(\n        address indexed operator,\n        address indexed from,\n        address indexed to,\n        uint256[] ids,\n        uint256[] values\n    );", "highlightLines": [24]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/IERC1155.sol", "line": 24, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "719375823249", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event ApprovalForAll(address indexed account, address indexed operator, bool approved);", "highlightLines": [36]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/IERC1155.sol", "line": 36, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "72a119a160c1", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function balanceOf(address account, uint256 id) external view returns (uint256);", "highlightLines": [54]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/IERC1155.sol", "line": 54, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "c619788a4038", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function setApprovalForAll(address operator, bool approved) external;", "highlightLines": [77]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/IERC1155.sol", "line": 77, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "63acdb284a7b", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function isApprovedForAll(address account, address operator) external view returns (bool);", "highlightLines": [84]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/IERC1155.sol", "line": 84, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "a5e3b5b9d97b", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function safeTransferFrom(\n        address from,\n        address to,\n        uint256 id,\n        uint256 amount,\n        bytes calldata data\n    ) external;", "highlightLines": [99]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/IERC1155.sol", "line": 99, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "6a6d499d3d66", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function safeBatchTransferFrom(\n        address from,\n        address to,\n        uint256[] calldata ids,\n        uint256[] calldata amounts,\n        bytes calldata data\n    ) external;", "highlightLines": [118]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/IERC1155.sol", "line": 118, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "6939e70cd5c1", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/IERC1155Receiver.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "9ca6c396dc36", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function onERC1155Received(\n        address operator,\n        address from,\n        uint256 id,\n        uint256 value,\n        bytes calldata data\n    ) external returns (bytes4);", "highlightLines": [27]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/IERC1155Receiver.sol", "line": 27, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "2946884a91f5", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function onERC1155BatchReceived(\n        address operator,\n        address from,\n        uint256[] calldata ids,\n        uint256[] calldata values,\n        bytes calldata data\n    ) external returns (bytes4);", "highlightLines": [51]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/IERC1155Receiver.sol", "line": 51, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "df3847821456", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/extensions/ERC1155Burnable.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "85d1de9d2fd9", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function burn(\n        address account,\n        uint256 id,\n        uint256 value\n    ) public virtual {", "highlightLines": [15]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/extensions/ERC1155Burnable.sol", "line": 15, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "ab93b4815bee", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function burn(\n        address account,\n        uint256 id,\n        uint256 value\n    ) public virtual {", "highlightLines": [15]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/extensions/ERC1155Burnable.sol", "line": 15, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "0cdc4546920f", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function burn(\n        address account,\n        uint256 id,\n        uint256 value\n    ) public virtual {\n        require(\n            account == _msgSender() || isApprovedForAll(account, _msgSender()),", "highlightLines": [15]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/extensions/ERC1155Burnable.sol", "line": 15, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "d329bcc41b51", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function burnBatch(\n        address account,\n        uint256[] memory ids,\n        uint256[] memory values\n    ) public virtual {\n        require(\n            account == _msgSender() || isApprovedForAll(account, _msgSender()),", "highlightLines": [28]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/extensions/ERC1155Burnable.sol", "line": 28, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "ee30fa8fce4c", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/extensions/ERC1155Pausable.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "1ef5c4826770", "fix": {"template": null, "available": false}, "title": "Storage array passed by value to internal function - changes won't persist", "ruleId": "rules.sol-array-by-reference", "snippet": {"code": "    function _beforeTokenTransfer(\n        address operator,\n        address from,\n        address to,\n        uint256[] memory ids,\n        uint256[] memory amounts,\n        bytes memory data\n    ) internal virtual override {", "highlightLines": [26]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/extensions/ERC1155Pausable.sol", "line": 26, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#modifying-storage-array-by-value"], "description": ""}, {"id": "492b1c8c4c6d", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/extensions/ERC1155Supply.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "f39682c47a7d", "fix": {"template": null, "available": false}, "title": "View function reads state that may be stale during callback - read-only reentrancy risk", "ruleId": "rules.sol-read-only-reentrancy", "snippet": {"code": "    function exists(uint256 id) public view virtual returns (bool) {\n        return ERC1155Supply.totalSupply(id) > 0;", "highlightLines": [29]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/extensions/ERC1155Supply.sol", "line": 29, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs", "https://chainsecurity.com/curve-lp-oracle-manipulation-post-mortem/"], "description": ""}, {"id": "5bb6f016a118", "fix": {"template": null, "available": false}, "title": "Storage array passed by value to internal function - changes won't persist", "ruleId": "rules.sol-array-by-reference", "snippet": {"code": "    function _beforeTokenTransfer(\n        address operator,\n        address from,\n        address to,\n        uint256[] memory ids,\n        uint256[] memory amounts,\n        bytes memory data\n    ) internal virtual override {", "highlightLines": [36]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/extensions/ERC1155Supply.sol", "line": 36, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#modifying-storage-array-by-value"], "description": ""}, {"id": "33a9abaeaba1", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function _beforeTokenTransfer(\n        address operator,\n        address from,\n        address to,\n        uint256[] memory ids,\n        uint256[] memory amounts,\n        bytes memory data\n    ) internal virtual override {\n        super._beforeTokenTransfer(operator, from, to, ids, amounts, data);\n\n        if (from == address(0)) {", "highlightLines": [36]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/extensions/ERC1155Supply.sol", "line": 36, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "1102976eaf6f", "fix": {"template": null, "available": false}, "title": "Storage variable modified in loop - should cache in memory for gas savings", "ruleId": "rules.sol-memory-vs-storage-loop", "snippet": {"code": "            for (uint256 i = 0; i < ids.length; ++i) {\n                uint256 id = ids[i];\n                uint256 amount = amounts[i];\n                uint256 supply = _totalSupply[id];\n                require(supply >= amount, \"ERC1155: burn amount exceeds totalSupply\");\n                unchecked {\n                    _totalSupply[id] = supply - amount;", "highlightLines": [53]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/extensions/ERC1155Supply.sol", "line": 53, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "cb7829b0e339", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "                uint256 id = ids[i];", "highlightLines": [54]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/extensions/ERC1155Supply.sol", "line": 54, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "61466df63e5e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "                uint256 id = ids[i];\n                uint256 amount = amounts[i];", "highlightLines": [54]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/extensions/ERC1155Supply.sol", "line": 54, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "ca91ac00a9b9", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "                uint256 amount = amounts[i];", "highlightLines": [55]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/extensions/ERC1155Supply.sol", "line": 55, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "29e0f0f48b97", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "                uint256 amount = amounts[i];\n                uint256 supply = _totalSupply[id];", "highlightLines": [55]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/extensions/ERC1155Supply.sol", "line": 55, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "557ebfe88539", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "                uint256 supply = _totalSupply[id];", "highlightLines": [56]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/extensions/ERC1155Supply.sol", "line": 56, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c3b7925801d4", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "                uint256 supply = _totalSupply[id];\n                require(supply >= amount, \"ERC1155: burn amount exceeds totalSupply\");\n                unchecked {\n                    _totalSupply[id] = supply - amount;\n                }", "highlightLines": [56]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/extensions/ERC1155Supply.sol", "line": 56, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "bc83377c3bcc", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "                    _totalSupply[id] = supply - amount;", "highlightLines": [59]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/extensions/ERC1155Supply.sol", "line": 59, "column": 40}, "severity": "medium", "references": [], "description": ""}, {"id": "37fc8a6b6b6a", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/extensions/ERC1155URIStorage.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "64f03524a70a", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "abstract contract ERC1155URIStorage is ERC1155 {\n    using Strings for uint256;\n\n    // Optional base URI\n    string private _baseURI = \"\";", "highlightLines": [15]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/extensions/ERC1155URIStorage.sol", "line": 15, "column": 10}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "fbf6b7f94a95", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function uri(uint256 tokenId) public view virtual override returns (string memory) {", "highlightLines": [42]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/extensions/ERC1155URIStorage.sol", "line": 42, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "f7a21ced9cb8", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function uri(uint256 tokenId) public view virtual override returns (string memory) {\n        string memory tokenURI = _tokenURIs[tokenId];", "highlightLines": [42]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/extensions/ERC1155URIStorage.sol", "line": 42, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "69e642901789", "fix": {"template": null, "available": false}, "title": "Struct copied to memory from mapping - modifications won't persist to storage", "ruleId": "rules.sol-memory-struct-from-mapping", "snippet": {"code": "        string memory tokenURI = _tokenURIs[tokenId];", "highlightLines": [43]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/extensions/ERC1155URIStorage.sol", "line": 43, "column": 9}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/DataLocation.sol"], "description": ""}, {"id": "0362b926d9ad", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "        return bytes(tokenURI).length > 0 ? string(abi.encodePacked(_baseURI, tokenURI)) : super.uri(tokenId);", "highlightLines": [46]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/extensions/ERC1155URIStorage.sol", "line": 46, "column": 52}, "severity": "medium", "references": [], "description": ""}, {"id": "8185068a6a29", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function _setURI(uint256 tokenId, string memory tokenURI) internal virtual {", "highlightLines": [52]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/extensions/ERC1155URIStorage.sol", "line": 52, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "1f5c6d85ca2e", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/extensions/IERC1155MetadataURI.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "871f4ee8c4ab", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/presets/ERC1155PresetMinterPauser.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "bc4ecea70c31", "fix": {"template": null, "available": false}, "title": "Base constructor called multiple times through diamond inheritance - may initialize twice", "ruleId": "rules.sol-reused-constructor", "snippet": {"code": "contract ERC1155PresetMinterPauser is Context, AccessControlEnumerable, ERC1155Burnable, ERC1155Pausable {", "highlightLines": [28]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/presets/ERC1155PresetMinterPauser.sol", "line": 28, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#reused-base-constructor"], "description": ""}, {"id": "c5b1b2319225", "fix": {"template": null, "available": false}, "title": "SWC-125: Multiple inheritance may cause incorrect function resolution - check C3 linearization", "ruleId": "rules.sol-swc-125-inheritance-order", "snippet": {"code": "contract ERC1155PresetMinterPauser is Context, AccessControlEnumerable, ERC1155Burnable, ERC1155Pausable {", "highlightLines": [28]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/presets/ERC1155PresetMinterPauser.sol", "line": 28, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-125"], "description": ""}, {"id": "5873c2bac357", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(string memory uri) ERC1155(uri) {\n        _setupRole(DEFAULT_ADMIN_ROLE, _msgSender());\n\n        _setupRole(MINTER_ROLE, _msgSender());\n        _setupRole(PAUSER_ROLE, _msgSender());\n    }", "highlightLines": [36]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/presets/ERC1155PresetMinterPauser.sol", "line": 36, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "e894be385b19", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function mint(\n        address to,\n        uint256 id,\n        uint256 amount,\n        bytes memory data\n    ) public virtual {", "highlightLines": [52]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/presets/ERC1155PresetMinterPauser.sol", "line": 52, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "2286b6daea7c", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function mint(\n        address to,\n        uint256 id,\n        uint256 amount,\n        bytes memory data\n    ) public virtual {", "highlightLines": [52]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/presets/ERC1155PresetMinterPauser.sol", "line": 52, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "68d2cdb9eed4", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function pause() public virtual {", "highlightLines": [86]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/presets/ERC1155PresetMinterPauser.sol", "line": 86, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "757bd5de5252", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function unpause() public virtual {", "highlightLines": [100]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/presets/ERC1155PresetMinterPauser.sol", "line": 100, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "a8d94fbb33a8", "fix": {"template": null, "available": false}, "title": "Storage array passed by value to internal function - changes won't persist", "ruleId": "rules.sol-array-by-reference", "snippet": {"code": "    function _beforeTokenTransfer(\n        address operator,\n        address from,\n        address to,\n        uint256[] memory ids,\n        uint256[] memory amounts,\n        bytes memory data\n    ) internal virtual override(ERC1155, ERC1155Pausable) {", "highlightLines": [118]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/presets/ERC1155PresetMinterPauser.sol", "line": 118, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#modifying-storage-array-by-value"], "description": ""}, {"id": "754be560c32b", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "    ) internal virtual override(ERC1155, ERC1155Pausable) {", "highlightLines": [125]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/presets/ERC1155PresetMinterPauser.sol", "line": 125, "column": 33}, "severity": "info", "references": [], "description": ""}, {"id": "d4cce8e56ebb", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/utils/ERC1155Holder.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "c92fb660ef6e", "fix": {"template": null, "available": false}, "title": "Token callback function without reentrancy protection - ERC777/721/1155 callbacks can reenter", "ruleId": "rules.sol-callback-without-reentrancy-guard", "snippet": {"code": "    function onERC1155Received(\n        address,\n        address,\n        uint256,\n        uint256,\n        bytes memory\n    ) public virtual override returns (bytes4) {", "highlightLines": [17]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/utils/ERC1155Holder.sol", "line": 17, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "08c639b602f2", "fix": {"template": null, "available": false}, "title": "Token callback function without reentrancy protection - ERC777/721/1155 callbacks can reenter", "ruleId": "rules.sol-callback-without-reentrancy-guard", "snippet": {"code": "    function onERC1155BatchReceived(\n        address,\n        address,\n        uint256[] memory,\n        uint256[] memory,\n        bytes memory\n    ) public virtual override returns (bytes4) {", "highlightLines": [27]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/utils/ERC1155Holder.sol", "line": 27, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "5cc345fdb205", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/utils/ERC1155Receiver.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "54f0874fae6d", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "abstract contract ERC1155Receiver is ERC165, IERC1155Receiver {", "highlightLines": [12]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/utils/ERC1155Receiver.sol", "line": 12, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "5f00fcf7a098", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function supportsInterface(bytes4 interfaceId) public view virtual override(ERC165, IERC165) returns (bool) {\n        return interfaceId == type(IERC1155Receiver).interfaceId || super.supportsInterface(interfaceId);", "highlightLines": [16]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC1155/utils/ERC1155Receiver.sol", "line": 16, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "7e87e5ad1416", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/ERC20.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "8c4946ca9d35", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "contract ERC20 is Context, IERC20, IERC20Metadata {", "highlightLines": [35]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/ERC20.sol", "line": 35, "column": 1}, "severity": "medium", "references": [], "description": ""}, {"id": "f9c98aa97e3f", "fix": {"template": null, "available": false}, "title": "Base constructor called multiple times through diamond inheritance - may initialize twice", "ruleId": "rules.sol-reused-constructor", "snippet": {"code": "contract ERC20 is Context, IERC20, IERC20Metadata {", "highlightLines": [35]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/ERC20.sol", "line": 35, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#reused-base-constructor"], "description": ""}, {"id": "de23afeb9df3", "fix": {"template": null, "available": false}, "title": "SWC-125: Multiple inheritance may cause incorrect function resolution - check C3 linearization", "ruleId": "rules.sol-swc-125-inheritance-order", "snippet": {"code": "contract ERC20 is Context, IERC20, IERC20Metadata {", "highlightLines": [35]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/ERC20.sol", "line": 35, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-125"], "description": ""}, {"id": "9540d262f5ba", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract ERC20 is Context, IERC20, IERC20Metadata {\n    mapping(address => uint256) private _balances;\n\n    mapping(address => mapping(address => uint256)) private _allowances;\n\n    uint256 private _totalSupply;\n\n    string private _name;\n    string private _symbol;", "highlightLines": [35]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/ERC20.sol", "line": 35, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "5702028e2d6d", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "contract ERC20 is Context, IERC20, IERC20Metadata {", "highlightLines": [35]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/ERC20.sol", "line": 35, "column": 28}, "severity": "info", "references": [], "description": ""}, {"id": "b0beb750eae2", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(string memory name_, string memory symbol_) {\n        _name = name_;\n        _symbol = symbol_;\n    }", "highlightLines": [54]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/ERC20.sol", "line": 54, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "7ce629eeec5d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        _name = name_;\n        _symbol = symbol_;", "highlightLines": [55]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/ERC20.sol", "line": 55, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "a0bb0f0d90bc", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function transfer(address to, uint256 amount) public virtual override returns (bool) {", "highlightLines": [113]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/ERC20.sol", "line": 113, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "bb4319781679", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without msg.data.length validation - vulnerable to short address attack padding", "ruleId": "rules.sol-short-address-no-payload-check", "snippet": {"code": "    function transfer(address to, uint256 amount) public virtual override returns (bool) {", "highlightLines": [113]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/ERC20.sol", "line": 113, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address", "https://vessenes.com/the-erc20-short-address-attack-explained/"], "description": ""}, {"id": "021cab91013e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address owner = _msgSender();", "highlightLines": [114]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/ERC20.sol", "line": 114, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "714f39ac398d", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "        address owner = _msgSender();", "highlightLines": [114]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/ERC20.sol", "line": 114, "column": 9}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "4271f8f88232", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        address owner = _msgSender();", "highlightLines": [114]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/ERC20.sol", "line": 114, "column": 17}, "severity": "info", "references": [], "description": ""}, {"id": "20d0aee80fbf", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function approve(address spender, uint256 amount) public virtual override returns (bool) {", "highlightLines": [136]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/ERC20.sol", "line": 136, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "c86a79f6db85", "fix": {"template": null, "available": false}, "title": "Using approve() without increaseAllowance/decreaseAllowance - vulnerable to front-running race condition", "ruleId": "rules.sol-erc20-approve-frontrun", "snippet": {"code": "    function approve(address spender, uint256 amount) public virtual override returns (bool) {\n        address owner = _msgSender();\n        _approve(owner, spender, amount);\n        return true;\n    }", "highlightLines": [136]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/ERC20.sol", "line": 136, "column": 5}, "severity": "info", "references": ["https://docs.google.com/document/d/1YLPtQxZu1UAvO9cZ1O2RPXBbT0mooh4DYKjA_jp-RLM"], "description": ""}, {"id": "6c25fd112039", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address owner = _msgSender();", "highlightLines": [137]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/ERC20.sol", "line": 137, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "165922e4dc4d", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "        address owner = _msgSender();", "highlightLines": [137]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/ERC20.sol", "line": 137, "column": 9}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "b60e44710ceb", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        address owner = _msgSender();", "highlightLines": [137]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/ERC20.sol", "line": 137, "column": 17}, "severity": "info", "references": [], "description": ""}, {"id": "3f4a2463f71e", "fix": {"template": null, "available": false}, "title": "ERC20 transferFrom without payload size validation - consider adding onlyPayloadSize modifier", "ruleId": "rules.sol-erc20-missing-payload-modifier", "snippet": {"code": "    function transferFrom(\n        address from,\n        address to,\n        uint256 amount\n    ) public virtual override returns (bool) {", "highlightLines": [158]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/ERC20.sol", "line": 158, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address"], "description": ""}, {"id": "35d9074a4974", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function transferFrom(\n        address from,\n        address to,\n        uint256 amount\n    ) public virtual override returns (bool) {", "highlightLines": [158]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/ERC20.sol", "line": 158, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "65fb999ea0d6", "fix": {"template": null, "available": false}, "title": "NFT transfer without approval/ownership check - add _isApprovedOrOwner validation", "ruleId": "rules.sol-nft-transfer-no-approval-check", "snippet": {"code": "    function transferFrom(\n        address from,\n        address to,\n        uint256 amount\n    ) public virtual override returns (bool) {", "highlightLines": [158]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/ERC20.sol", "line": 158, "column": 5}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/NFT-transfer.sol"], "description": ""}, {"id": "64750b2678d7", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address spender = _msgSender();", "highlightLines": [163]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/ERC20.sol", "line": 163, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "edfe31c395c3", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address owner = _msgSender();", "highlightLines": [182]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/ERC20.sol", "line": 182, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b18bbc78bb19", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "        address owner = _msgSender();", "highlightLines": [182]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/ERC20.sol", "line": 182, "column": 9}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "79c4f11a5dfd", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        address owner = _msgSender();", "highlightLines": [182]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/ERC20.sol", "line": 182, "column": 17}, "severity": "info", "references": [], "description": ""}, {"id": "8b14f1e2d191", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "    function decreaseAllowance(address spender, uint256 subtractedValue) public virtual returns (bool) {\n        address owner = _msgSender();\n        uint256 currentAllowance = allowance(owner, spender);\n        require(currentAllowance >= subtractedValue, \"ERC20: decreased allowance below zero\");", "highlightLines": [201]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/ERC20.sol", "line": 201, "column": 5}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "ca0e0eae4d40", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address owner = _msgSender();", "highlightLines": [202]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/ERC20.sol", "line": 202, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "40748f4133a6", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "        address owner = _msgSender();", "highlightLines": [202]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/ERC20.sol", "line": 202, "column": 9}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "2af989cfb0c4", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address owner = _msgSender();\n        uint256 currentAllowance = allowance(owner, spender);", "highlightLines": [202]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/ERC20.sol", "line": 202, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "c4ee0dab0c06", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        address owner = _msgSender();", "highlightLines": [202]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/ERC20.sol", "line": 202, "column": 17}, "severity": "info", "references": [], "description": ""}, {"id": "8cf0e80910ec", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 currentAllowance = allowance(owner, spender);", "highlightLines": [203]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/ERC20.sol", "line": 203, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7c7fbed0cfb0", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "            _approve(owner, spender, currentAllowance - subtractedValue);", "highlightLines": [206]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/ERC20.sol", "line": 206, "column": 38}, "severity": "medium", "references": [], "description": ""}, {"id": "e525047e280a", "fix": {"template": null, "available": false}, "title": "Self transfer not checked - can cause balance corruption with from == to", "ruleId": "rules.sol-self-transfer-unchecked", "snippet": {"code": "    function _transfer(\n        address from,\n        address to,\n        uint256 amount\n    ) internal virtual {", "highlightLines": [226]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/ERC20.sol", "line": 226, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/self-transfer.sol"], "description": ""}, {"id": "40885ce0c231", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 fromBalance = _balances[from];", "highlightLines": [235]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/ERC20.sol", "line": 235, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e73775f40997", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 fromBalance = _balances[from];\n        require(fromBalance >= amount, \"ERC20: transfer amount exceeds balance\");\n        unchecked {\n            _balances[from] = fromBalance - amount;\n            // Overflow not possible: the sum of all balances is capped by totalSupply, and the sum is preserved by\n            // decrementing then incrementing.\n            _balances[to] += amount;\n        }", "highlightLines": [236]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/ERC20.sol", "line": 236, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "082047597eb0", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "            _balances[from] = fromBalance - amount;", "highlightLines": [239]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/ERC20.sol", "line": 239, "column": 31}, "severity": "medium", "references": [], "description": ""}, {"id": "5efd3ec5ced9", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 accountBalance = _balances[account];", "highlightLines": [289]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/ERC20.sol", "line": 289, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "6f9a5794f3f9", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 accountBalance = _balances[account];\n        require(accountBalance >= amount, \"ERC20: burn amount exceeds balance\");\n        unchecked {\n            _balances[account] = accountBalance - amount;\n            // Overflow not possible: amount <= accountBalance <= totalSupply.\n            _totalSupply -= amount;\n        }", "highlightLines": [290]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/ERC20.sol", "line": 290, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "7e001eb1afb4", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "            _balances[account] = accountBalance - amount;", "highlightLines": [293]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/ERC20.sol", "line": 293, "column": 34}, "severity": "medium", "references": [], "description": ""}, {"id": "ab8bd41171b2", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 currentAllowance = allowance(owner, spender);", "highlightLines": [341]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/ERC20.sol", "line": 341, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "016a56b75ac0", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "                _approve(owner, spender, currentAllowance - amount);", "highlightLines": [345]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/ERC20.sol", "line": 345, "column": 42}, "severity": "medium", "references": [], "description": ""}, {"id": "559179ed74ce", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/IERC20.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "a537836d0456", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Transfer(address indexed from, address indexed to, uint256 value);", "highlightLines": [16]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/IERC20.sol", "line": 16, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "9bea712361a2", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Approval(address indexed owner, address indexed spender, uint256 value);", "highlightLines": [22]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/IERC20.sol", "line": 22, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "d6eedd4ef837", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function balanceOf(address account) external view returns (uint256);", "highlightLines": [32]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/IERC20.sol", "line": 32, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "422acb66431a", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function transfer(address to, uint256 amount) external returns (bool);", "highlightLines": [41]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/IERC20.sol", "line": 41, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "b6a0627fcac5", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function transfer(address to, uint256 amount) external returns (bool);\n\n    /**\n     * @dev Returns the remaining number of tokens that `spender` will be\n     * allowed to spend on behalf of `owner` through {transferFrom}. This is", "highlightLines": [41]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/IERC20.sol", "line": 41, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "c6febb5f396f", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without msg.data.length validation - vulnerable to short address attack padding", "ruleId": "rules.sol-short-address-no-payload-check", "snippet": {"code": "    function transfer(address to, uint256 amount) external returns (bool);\n\n    /**\n     * @dev Returns the remaining number of tokens that `spender` will be\n     * allowed to spend on behalf of `owner` through {transferFrom}. This is", "highlightLines": [41]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/IERC20.sol", "line": 41, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address", "https://vessenes.com/the-erc20-short-address-attack-explained/"], "description": ""}, {"id": "cfcc236d7467", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function allowance(address owner, address spender) external view returns (uint256);", "highlightLines": [50]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/IERC20.sol", "line": 50, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "bc04a31cb7ed", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function approve(address spender, uint256 amount) external returns (bool);", "highlightLines": [66]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/IERC20.sol", "line": 66, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "da3ce0a5263d", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function approve(address spender, uint256 amount) external returns (bool);\n\n    /**\n     * @dev Moves `amount` tokens from `from` to `to` using the\n     * allowance mechanism. `amount` is then deducted from the caller's\n     * allowance.\n     *\n     * Returns a boolean value indicating whether the operation succeeded.\n     *\n     * Emits a {Transfer} event.", "highlightLines": [66]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/IERC20.sol", "line": 66, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "56f6c548eb50", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function transferFrom(\n        address from,\n        address to,\n        uint256 amount\n    ) external returns (bool);", "highlightLines": [77]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/IERC20.sol", "line": 77, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "a69c5607f00f", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Burnable.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "1c175f411079", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function burn(uint256 amount) public virtual {", "highlightLines": [20]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Burnable.sol", "line": 20, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "7b6cecb90b8d", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function burn(uint256 amount) public virtual {", "highlightLines": [20]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Burnable.sol", "line": 20, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "d6b8b73ee146", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Capped.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "406f03f8ef11", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(uint256 cap_) {\n        require(cap_ > 0, \"ERC20Capped: cap is 0\");\n        _cap = cap_;\n    }", "highlightLines": [18]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Capped.sol", "line": 18, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "c47eb45b2cb6", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20FlashMint.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "e9fb5d28c7f2", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "abstract contract ERC20FlashMint is ERC20, IERC3156FlashLender {", "highlightLines": [19]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20FlashMint.sol", "line": 19, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "4f6ddeb2063d", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function maxFlashLoan(address token) public view virtual override returns (uint256) {\n        return token == address(this) ? type(uint256).max - ERC20.totalSupply() : 0;", "highlightLines": [27]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20FlashMint.sol", "line": 27, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "ee6ed3bcffc1", "fix": {"template": null, "available": false}, "title": "View function reads state that may be stale during callback - read-only reentrancy risk", "ruleId": "rules.sol-read-only-reentrancy", "snippet": {"code": "    function maxFlashLoan(address token) public view virtual override returns (uint256) {\n        return token == address(this) ? type(uint256).max - ERC20.totalSupply() : 0;", "highlightLines": [27]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20FlashMint.sol", "line": 27, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs", "https://chainsecurity.com/curve-lp-oracle-manipulation-post-mortem/"], "description": ""}, {"id": "4ec1386b1969", "fix": {"template": null, "available": false}, "title": "Flash loan amount not validated against available liquidity", "ruleId": "rules.sol-flash-loan-amount-validation", "snippet": {"code": "    function flashFee(address token, uint256 amount) public view virtual override returns (uint256) {", "highlightLines": [39]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20FlashMint.sol", "line": 39, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "1d675fe40983", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function flashFee(address token, uint256 amount) public view virtual override returns (uint256) {\n        require(token == address(this), \"ERC20FlashMint: wrong token\");", "highlightLines": [39]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20FlashMint.sol", "line": 39, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "beb04cd83db7", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        amount;", "highlightLines": [42]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20FlashMint.sol", "line": 42, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "d02802ef2c16", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "     * @return `true` if the flash loan was successful.\n     */\n    // This function can reenter, but it doesn't pose a risk because it always preserves the property that the amount\n    // minted at the beginning is always recovered and burned at the end, or else the entire function will revert.\n    // slither-disable-next-line reentrancy-no-eth\n    function flashLoan(\n        IERC3156FlashBorrower receiver,\n        address token,\n        uint256 amount,\n        bytes calldata data\n    ) public virtual override returns (bool) {\n        require(amount <= maxFlashLoan(token), \"ERC20FlashMint: amount exceeds maxFlashLoan\");\n        uint256 fee = flashFee(token, amount);", "highlightLines": [68]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20FlashMint.sol", "line": 68, "column": 9}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "4dfc6593b740", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "    // This function can reenter, but it doesn't pose a risk because it always preserves the property that the amount\n    // minted at the beginning is always recovered and burned at the end, or else the entire function will revert.\n    // slither-disable-next-line reentrancy-no-eth\n    function flashLoan(\n        IERC3156FlashBorrower receiver,\n        address token,\n        uint256 amount,\n        bytes calldata data\n    ) public virtual override returns (bool) {\n        require(amount <= maxFlashLoan(token), \"ERC20FlashMint: amount exceeds maxFlashLoan\");\n        uint256 fee = flashFee(token, amount);\n        _mint(address(receiver), amount);\n        require(", "highlightLines": [70]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20FlashMint.sol", "line": 70, "column": 13}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "8372aeb1f6d5", "fix": {"template": null, "available": false}, "title": "Flash loan fee not included in liquidity calculation - share value manipulation possible", "ruleId": "rules.sol-flash-loan-fee-not-accounted", "snippet": {"code": "    function flashLoan(\n        IERC3156FlashBorrower receiver,\n        address token,\n        uint256 amount,\n        bytes calldata data\n    ) public virtual override returns (bool) {\n        require(amount <= maxFlashLoan(token), \"ERC20FlashMint: amount exceeds maxFlashLoan\");\n        uint256 fee = flashFee(token, amount);\n        _mint(address(receiver), amount);\n        require(\n            receiver.onFlashLoan(msg.sender, token, amount, fee, data) == _RETURN_VALUE,\n            \"ERC20FlashMint: invalid return value\"\n        );\n        address flashFeeReceiver = _flashFeeReceiver();\n        _spendAllowance(address(receiver), address(this), amount + fee);\n        if (fee == 0 || flashFeeReceiver == address(0)) {\n            _burn(address(receiver), amount + fee);\n        } else {", "highlightLines": [73]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20FlashMint.sol", "line": 73, "column": 5}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-07-loopfi-findings"], "description": ""}, {"id": "9ce88df7a3e3", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 fee = flashFee(token, amount);", "highlightLines": [80]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20FlashMint.sol", "line": 80, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "87a1f482bac0", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 fee = flashFee(token, amount);\n        _mint(address(receiver), amount);\n        require(\n            receiver.onFlashLoan(msg.sender, token, amount, fee, data) == _RETURN_VALUE,\n            \"ERC20FlashMint: invalid return value\"\n        );\n        address flashFeeReceiver = _flashFeeReceiver();", "highlightLines": [80]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20FlashMint.sol", "line": 80, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "215b2b76b93c", "fix": {"template": null, "available": false}, "title": "NFT mint without supply check - potential overflow in tokenId", "ruleId": "rules.sol-nft-overflow-mint", "snippet": {"code": "        _mint(address(receiver), amount);", "highlightLines": [81]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20FlashMint.sol", "line": 81, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "9da3651a54fd", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "            \"ERC20FlashMint: invalid return value\"\n        );\n        address flashFeeReceiver = _flashFeeReceiver();", "highlightLines": [84]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20FlashMint.sol", "line": 84, "column": 38}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "0986d1851827", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address flashFeeReceiver = _flashFeeReceiver();", "highlightLines": [86]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20FlashMint.sol", "line": 86, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "2a1a6e0f86f1", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Pausable.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "e9c08c341068", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Snapshot.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "d9ec9d4fc8e9", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": " * Snapshots are created by the internal {_snapshot} function, which will emit the {Snapshot} event and return a\n * snapshot id. To get the total supply at the time of a snapshot, call the function {totalSupplyAt} with the snapshot\n * id. To get the balance of an account at the time of a snapshot, call the {balanceOfAt} function with the snapshot id\n * and the account address.\n *\n * NOTE: Snapshot policy can be customized by overriding the {_getCurrentSnapshotId} method. For example, having it\n * return `block.number` will trigger the creation of snapshot at the beginning of each new block. When overriding this\n * function, be careful about the monotonicity of its result. Non-monotonic snapshot ids will break the contract.\n *\n * Implementing snapshots for every block using this method will incur significant gas costs. For a gas-efficient\n * alternative consider {ERC20Votes}.\n *\n * ==== Gas Costs\n *\n * Snapshots are efficient. Snapshot creation is _O(1)_. Retrieval of balances or total supply from a snapshot is _O(log\n * n)_ in the number of snapshots that have been created, although _n_ for a specific account will generally be much\n * smaller since identical balances in subsequent snapshots are stored as a single entry.\n *\n * There is a constant overhead for normal ERC20 transfers due to the additional snapshot bookkeeping. This overhead is\n * only significant for the first transfer that immediately follows a snapshot for a particular account. Subsequent\n * transfers will have normal cost until the next snapshot, and so on.\n */\n\nabstract contract ERC20Snapshot is ERC20 {\n    // Inspired by Jordi Baylina's MiniMeToken to record historical balances:\n    // https://github.com/Giveth/minime/blob/ea04d950eea153a04c51fa510b068b9dded390cb/contracts/MiniMeToken.sol\n\n    using Arrays for uint256[];\n    using Counters for Counters.Counter;", "highlightLines": [19]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Snapshot.sol", "line": 19, "column": 105}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "76f8495d049a", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event Snapshot(uint256 id);", "highlightLines": [65]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Snapshot.sol", "line": 65, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "14ac8160d6f8", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 currentId = _getCurrentSnapshotId();", "highlightLines": [90]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Snapshot.sol", "line": 90, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "6a625e27ee81", "fix": {"template": null, "available": false}, "title": "View function reads state that may be stale during callback - read-only reentrancy risk", "ruleId": "rules.sol-read-only-reentrancy", "snippet": {"code": "    function balanceOfAt(address account, uint256 snapshotId) public view virtual returns (uint256) {\n        (bool snapshotted, uint256 value) = _valueAt(snapshotId, _accountBalanceSnapshots[account]);\n\n        return snapshotted ? value : balanceOf(account);", "highlightLines": [106]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Snapshot.sol", "line": 106, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs", "https://chainsecurity.com/curve-lp-oracle-manipulation-post-mortem/"], "description": ""}, {"id": "a8c4113bd091", "fix": {"template": null, "available": false}, "title": "View function reads state that may be stale during callback - read-only reentrancy risk", "ruleId": "rules.sol-read-only-reentrancy", "snippet": {"code": "    function totalSupplyAt(uint256 snapshotId) public view virtual returns (uint256) {\n        (bool snapshotted, uint256 value) = _valueAt(snapshotId, _totalSupplySnapshots);\n\n        return snapshotted ? value : totalSupply();", "highlightLines": [115]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Snapshot.sol", "line": 115, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs", "https://chainsecurity.com/curve-lp-oracle-manipulation-post-mortem/"], "description": ""}, {"id": "15aa22522f6b", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function _beforeTokenTransfer(\n        address from,\n        address to,\n        uint256 amount\n    ) internal virtual override {\n        super._beforeTokenTransfer(from, to, amount);\n\n        if (from == address(0)) {", "highlightLines": [123]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Snapshot.sol", "line": 123, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "372e2891da28", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "    function _valueAt(uint256 snapshotId, Snapshots storage snapshots) private view returns (bool, uint256) {\n        require(snapshotId > 0, \"ERC20Snapshot: id is 0\");\n        require(snapshotId <= _getCurrentSnapshotId(), \"ERC20Snapshot: nonexistent id\");", "highlightLines": [145]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Snapshot.sol", "line": 145, "column": 5}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "6cfb3dc073a7", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function _valueAt(uint256 snapshotId, Snapshots storage snapshots) private view returns (bool, uint256) {\n        require(snapshotId > 0, \"ERC20Snapshot: id is 0\");\n        require(snapshotId <= _getCurrentSnapshotId(), \"ERC20Snapshot: nonexistent id\");\n\n        // When a valid snapshot is queried, there are three possibilities:\n        //  a) The queried value was not modified after the snapshot was taken. Therefore, a snapshot entry was never\n        //  created for this id, and all stored snapshot ids are smaller than the requested one. The value that corresponds\n        //  to this id is the current one.\n        //  b) The queried value was modified after the snapshot was taken. Therefore, there will be an entry with the\n        //  requested id, and its value is the one to return.\n        //  c) More snapshots were created after the requested one, and the queried value was later modified. There will be\n        //  no entry for the requested id: the value that corresponds to it is that of the smallest snapshot id that is\n        //  larger than the requested one.\n        //\n        // In summary, we need to find an element in an array, returning the index of the smallest value that is larger if\n        // it is not found, unless said value doesn't exist (e.g. when all values are smaller). Arrays.findUpperBound does\n        // exactly this.\n\n        uint256 index = snapshots.ids.findUpperBound(snapshotId);", "highlightLines": [145]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Snapshot.sol", "line": 145, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "83c57fddf7a5", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 index = snapshots.ids.findUpperBound(snapshotId);", "highlightLines": [162]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Snapshot.sol", "line": 162, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "21d0f0fc1774", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 currentId = _getCurrentSnapshotId();", "highlightLines": [181]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Snapshot.sol", "line": 181, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "979731752f2d", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Votes.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "f09194bd7696", "fix": {"template": null, "available": false}, "title": "Possible incorrect exponentiation - ^ is XOR in Solidity, use ** for power", "ruleId": "rules.sol-incorrect-exponentiation", "snippet": {"code": " * and supports token supply up to 2^224^ - 1, while COMP is limited to 2^96^ - 1.", "highlightLines": [14]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Votes.sol", "line": 14, "column": 36}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-exponentiation"], "description": ""}, {"id": "1284a3789891", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "abstract contract ERC20Votes is IVotes, ERC20Permit {", "highlightLines": [27]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Votes.sol", "line": 27, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "ae002278a568", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "abstract contract ERC20Votes is IVotes, ERC20Permit {\n    struct Checkpoint {\n        uint32 fromBlock;\n        uint224 votes;", "highlightLines": [27]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Votes.sol", "line": 27, "column": 10}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "d4eb8e77ab12", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint32 fromBlock;", "highlightLines": [29]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Votes.sol", "line": 29, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "22612cd03420", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint224 votes;", "highlightLines": [30]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Votes.sol", "line": 30, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "9e106dcf5850", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        return SafeCast.toUint32(_checkpoints[account].length);", "highlightLines": [51]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Votes.sol", "line": 51, "column": 28}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "506c705ce5b2", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function getVotes(address account) public view virtual override returns (uint256) {\n        uint256 pos = _checkpoints[account].length;", "highlightLines": [64]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Votes.sol", "line": 64, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "a4b22ecc90d7", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 pos = _checkpoints[account].length;", "highlightLines": [65]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Votes.sol", "line": 65, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "6611a9e751c8", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function _checkpointsLookup(Checkpoint[] storage ckpts, uint256 blockNumber) private view returns (uint256) {\n        // We run a binary search to look for the earliest checkpoint taken after `blockNumber`.\n        //\n        // During the loop, the index of the wanted checkpoint remains in the range [low-1, high).\n        // With each iteration, either `low` or `high` is moved towards the middle of the range to maintain the invariant.\n        // - If the middle checkpoint is after `blockNumber`, we look in [low, mid)\n        // - If the middle checkpoint is before or equal to `blockNumber`, we look in [mid+1, high)\n        // Once we reach a single value (when low == high), we've found the right checkpoint at the index high-1, if not\n        // out of bounds (in which case we're looking too far in the past and the result is 0).\n        // Note that if the latest checkpoint available is exactly for `blockNumber`, we end up with an index that is\n        // past the end of the array, so we technically don't find a checkpoint after `blockNumber`, but it works out\n        // the same.\n        uint256 high = ckpts.length;\n        uint256 low = 0;\n        while (low < high) {\n            uint256 mid = Math.average(low, high);\n            if (ckpts[mid].fromBlock > blockNumber) {\n                high = mid;", "highlightLines": [97]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Votes.sol", "line": 97, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "b10bfec6669a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 high = ckpts.length;", "highlightLines": [109]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Votes.sol", "line": 109, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "db5028d0ebca", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 high = ckpts.length;\n        uint256 low = 0;", "highlightLines": [109]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Votes.sol", "line": 109, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "2de1aa6a6d77", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 low = 0;", "highlightLines": [110]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Votes.sol", "line": 110, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "9836ffa45099", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 low = 0;\n        while (low < high) {\n            uint256 mid = Math.average(low, high);\n            if (ckpts[mid].fromBlock > blockNumber) {\n                high = mid;\n            } else {\n                low = mid + 1;\n            }\n        }", "highlightLines": [110]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Votes.sol", "line": 110, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "3184e4892a85", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint256 mid = Math.average(low, high);", "highlightLines": [112]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Votes.sol", "line": 112, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f18fae034f86", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            uint256 mid = Math.average(low, high);\n            if (ckpts[mid].fromBlock > blockNumber) {\n                high = mid;\n            } else {\n                low = mid + 1;\n            }", "highlightLines": [112]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Votes.sol", "line": 112, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "697f57bfb3c2", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function delegateBySig(\n        address delegatee,\n        uint256 nonce,\n        uint256 expiry,\n        uint8 v,\n        bytes32 r,\n        bytes32 s\n    ) public virtual override {\n        require(block.timestamp <= expiry, \"ERC20Votes: signature expired\");\n        address signer = ECDSA.recover(\n            _hashTypedDataV4(keccak256(abi.encode(_DELEGATION_TYPEHASH, delegatee, nonce, expiry))),\n            v,\n            r,\n            s\n        );\n        require(nonce == _useNonce(signer), \"ERC20Votes: invalid nonce\");", "highlightLines": [133]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Votes.sol", "line": 133, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "29bc716ddc5c", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        require(block.timestamp <= expiry, \"ERC20Votes: signature expired\");", "highlightLines": [141]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Votes.sol", "line": 141, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "e8433a6b045a", "fix": {"template": null, "available": false}, "title": "Block timestamp used for critical logic - miners can manipulate within ~15 second window", "ruleId": "rules.sol-block-timestamp-manipulation", "snippet": {"code": "        require(block.timestamp <= expiry, \"ERC20Votes: signature expired\");", "highlightLines": [141]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Votes.sol", "line": 141, "column": 17}, "severity": "medium", "references": ["https://consensys.github.io/smart-contract-best-practices/development-recommendations/solidity-specific/timestamp-dependence/"], "description": ""}, {"id": "b97f1a474469", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address signer = ECDSA.recover(", "highlightLines": [142]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Votes.sol", "line": 142, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "03ca4173dac2", "fix": {"template": null, "available": false}, "title": "ecrecover result not checked for zero address - invalid signatures return address(0)", "ruleId": "rules.sol-ethernaut-ecrecover-no-zero-check", "snippet": {"code": "        address signer = ECDSA.recover(\n            _hashTypedDataV4(keccak256(abi.encode(_DELEGATION_TYPEHASH, delegatee, nonce, expiry))),\n            v,\n            r,\n            s\n        );", "highlightLines": [142]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Votes.sol", "line": 142, "column": 26}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-117", "https://swcregistry.io/docs/SWC-122"], "description": ""}, {"id": "781ef5b93e19", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "            _hashTypedDataV4(keccak256(abi.encode(_DELEGATION_TYPEHASH, delegatee, nonce, expiry))),", "highlightLines": [143]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Votes.sol", "line": 143, "column": 30}, "severity": "high", "references": [], "description": ""}, {"id": "d7f55f27c6c9", "fix": {"template": null, "available": false}, "title": "Possible incorrect exponentiation - ^ is XOR in Solidity, use ** for power", "ruleId": "rules.sol-incorrect-exponentiation", "snippet": {"code": "     * @dev Maximum token supply. Defaults to `type(uint224).max` (2^224^ - 1).", "highlightLines": [153]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Votes.sol", "line": 153, "column": 68}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-exponentiation"], "description": ""}, {"id": "2eaf46741557", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address currentDelegate = delegates(delegator);", "highlightLines": [199]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Votes.sol", "line": 199, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a4588f7aa719", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address currentDelegate = delegates(delegator);\n        uint256 delegatorBalance = balanceOf(delegator);", "highlightLines": [199]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Votes.sol", "line": 199, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e3b586b79365", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 delegatorBalance = balanceOf(delegator);", "highlightLines": [200]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Votes.sol", "line": 200, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4f19188e5e08", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 delegatorBalance = balanceOf(delegator);\n        _delegates[delegator] = delegatee;", "highlightLines": [200]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Votes.sol", "line": 200, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "5dce48113bf6", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function _writeCheckpoint(\n        Checkpoint[] storage ckpts,\n        function(uint256, uint256) view returns (uint256) op,\n        uint256 delta\n    ) private returns (uint256 oldWeight, uint256 newWeight) {\n        uint256 pos = ckpts.length;\n        oldWeight = pos == 0 ? 0 : ckpts[pos - 1].votes;\n        newWeight = op(oldWeight, delta);\n\n        if (pos > 0 && ckpts[pos - 1].fromBlock == block.number) {\n            ckpts[pos - 1].votes = SafeCast.toUint224(newWeight);", "highlightLines": [226]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Votes.sol", "line": 226, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "26942963fd02", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 pos = ckpts.length;", "highlightLines": [231]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Votes.sol", "line": 231, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7f0dcf315b1f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 pos = ckpts.length;\n        oldWeight = pos == 0 ? 0 : ckpts[pos - 1].votes;", "highlightLines": [231]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Votes.sol", "line": 231, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "84d573018e91", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        oldWeight = pos == 0 ? 0 : ckpts[pos - 1].votes;\n        newWeight = op(oldWeight, delta);", "highlightLines": [232]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Votes.sol", "line": 232, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "7d950326649d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        newWeight = op(oldWeight, delta);\n\n        if (pos > 0 && ckpts[pos - 1].fromBlock == block.number) {\n            ckpts[pos - 1].votes = SafeCast.toUint224(newWeight);\n        } else {\n            ckpts.push(Checkpoint({fromBlock: SafeCast.toUint32(block.number), votes: SafeCast.toUint224(newWeight)}));\n        }", "highlightLines": [233]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Votes.sol", "line": 233, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "72c45550e288", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "        if (pos > 0 && ckpts[pos - 1].fromBlock == block.number) {\n            ckpts[pos - 1].votes = SafeCast.toUint224(newWeight);\n        } else {\n            ckpts.push(Checkpoint({fromBlock: SafeCast.toUint32(block.number), votes: SafeCast.toUint224(newWeight)}));\n        }", "highlightLines": [235]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Votes.sol", "line": 235, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "80c5173818ad", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "            ckpts.push(Checkpoint({fromBlock: SafeCast.toUint32(block.number), votes: SafeCast.toUint224(newWeight)}));", "highlightLines": [238]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Votes.sol", "line": 238, "column": 59}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "356edd5520a7", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20VotesComp.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "e7fe4e4b8edd", "fix": {"template": null, "available": false}, "title": "Possible incorrect exponentiation - ^ is XOR in Solidity, use ** for power", "ruleId": "rules.sol-incorrect-exponentiation", "snippet": {"code": " * interface, with the drawback of only supporting supply up to (2^96^ - 1).", "highlightLines": [10]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20VotesComp.sol", "line": 10, "column": 66}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-exponentiation"], "description": ""}, {"id": "8c6f12b5b919", "fix": {"template": null, "available": false}, "title": "Possible incorrect exponentiation - ^ is XOR in Solidity, use ** for power", "ruleId": "rules.sol-incorrect-exponentiation", "snippet": {"code": " * with Governor Alpha or Bravo) and if you are sure the supply cap of 2^96^ is enough for you. Otherwise, use the", "highlightLines": [13]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20VotesComp.sol", "line": 13, "column": 72}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-exponentiation"], "description": ""}, {"id": "7e73dc5a2c12", "fix": {"template": null, "available": false}, "title": "Possible incorrect exponentiation - ^ is XOR in Solidity, use ** for power", "ruleId": "rules.sol-incorrect-exponentiation", "snippet": {"code": "     * @dev Maximum token supply. Reduced to `type(uint96).max` (2^96^ - 1) to fit COMP interface.", "highlightLines": [41]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20VotesComp.sol", "line": 41, "column": 66}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-exponentiation"], "description": ""}, {"id": "46f2d0fe2bfa", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Wrapper.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "075878ced82e", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(IERC20 underlyingToken) {\n        underlying = underlyingToken;\n    }", "highlightLines": [21]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Wrapper.sol", "line": 21, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "d3089edae43c", "fix": {"template": null, "available": false}, "title": "NFT mint without supply check - potential overflow in tokenId", "ruleId": "rules.sol-nft-overflow-mint", "snippet": {"code": "        _mint(account, amount);", "highlightLines": [41]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Wrapper.sol", "line": 41, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "2533828c90c5", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 value = underlying.balanceOf(address(this)) - totalSupply();", "highlightLines": [59]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Wrapper.sol", "line": 59, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "bb445d663fd3", "fix": {"template": null, "available": false}, "title": "NFT mint without supply check - potential overflow in tokenId", "ruleId": "rules.sol-nft-overflow-mint", "snippet": {"code": "        _mint(account, value);", "highlightLines": [60]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Wrapper.sol", "line": 60, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "5f4899e242a0", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC4626.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "0d8e7fab32fe", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "abstract contract ERC4626 is ERC20, IERC4626 {", "highlightLines": [26]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC4626.sol", "line": 26, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "e57088a7e981", "fix": {"template": null, "available": false}, "title": "ERC4626 vault missing _decimalsOffset() - vulnerable to precision loss attacks", "ruleId": "rules.sol-erc4626-missing-decimal-offset", "snippet": {"code": "abstract contract ERC4626 is ERC20, IERC4626 {", "highlightLines": [26]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC4626.sol", "line": 26, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "f87532489e4a", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(IERC20Metadata asset_) {\n        _asset = asset_;\n    }", "highlightLines": [34]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC4626.sol", "line": 34, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "60f1991c3d97", "fix": {"template": null, "available": false}, "title": "View function reads state that may be stale during callback - read-only reentrancy risk", "ruleId": "rules.sol-read-only-reentrancy", "snippet": {"code": "    function totalAssets() public view virtual override returns (uint256) {\n        return _asset.balanceOf(address(this));", "highlightLines": [44]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC4626.sol", "line": 44, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs", "https://chainsecurity.com/curve-lp-oracle-manipulation-post-mortem/"], "description": ""}, {"id": "a1abc88536ce", "fix": {"template": null, "available": false}, "title": "View function reads state that may be stale during callback - read-only reentrancy risk", "ruleId": "rules.sol-read-only-reentrancy", "snippet": {"code": "    function maxWithdraw(address owner) public view virtual override returns (uint256) {\n        return _convertToAssets(balanceOf(owner), Math.Rounding.Down);", "highlightLines": [69]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC4626.sol", "line": 69, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs", "https://chainsecurity.com/curve-lp-oracle-manipulation-post-mortem/"], "description": ""}, {"id": "e7dbcb43928b", "fix": {"template": null, "available": false}, "title": "View function reads state that may be stale during callback - read-only reentrancy risk", "ruleId": "rules.sol-read-only-reentrancy", "snippet": {"code": "    function maxRedeem(address owner) public view virtual override returns (uint256) {\n        return balanceOf(owner);", "highlightLines": [74]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC4626.sol", "line": 74, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs", "https://chainsecurity.com/curve-lp-oracle-manipulation-post-mortem/"], "description": ""}, {"id": "cafe58c531ae", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function deposit(uint256 assets, address receiver) public virtual override returns (uint256) {", "highlightLines": [99]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC4626.sol", "line": 99, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "d9f326337342", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 shares = previewDeposit(assets);", "highlightLines": [101]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC4626.sol", "line": 101, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "37105242f87d", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function mint(uint256 shares, address receiver) public virtual override returns (uint256) {", "highlightLines": [109]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC4626.sol", "line": 109, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "faf944943d6e", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function mint(uint256 shares, address receiver) public virtual override returns (uint256) {", "highlightLines": [109]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC4626.sol", "line": 109, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "8f0c08518d60", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 assets = previewMint(shares);", "highlightLines": [111]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC4626.sol", "line": 111, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f96eb62e2586", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function withdraw(\n        uint256 assets,\n        address receiver,\n        address owner\n    ) public virtual override returns (uint256) {", "highlightLines": [119]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC4626.sol", "line": 119, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "54eea6d64a59", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 shares = previewWithdraw(assets);", "highlightLines": [125]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC4626.sol", "line": 125, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b8795eeafe31", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 assets = previewRedeem(shares);", "highlightLines": [139]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC4626.sol", "line": 139, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d93b6accb9ba", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function _convertToShares(uint256 assets, Math.Rounding rounding) internal view virtual returns (uint256 shares) {\n        uint256 supply = totalSupply();", "highlightLines": [152]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC4626.sol", "line": 152, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "1b9397bbf85c", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function _convertToShares(uint256 assets, Math.Rounding rounding) internal view virtual returns (uint256 shares) {\n        uint256 supply = totalSupply();\n        return\n            (assets == 0 || supply == 0)", "highlightLines": [152]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC4626.sol", "line": 152, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "8ed8a2619721", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 supply = totalSupply();", "highlightLines": [153]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC4626.sol", "line": 153, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "39068baa8844", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function _convertToAssets(uint256 shares, Math.Rounding rounding) internal view virtual returns (uint256 assets) {\n        uint256 supply = totalSupply();", "highlightLines": [163]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC4626.sol", "line": 163, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "1144c8fbda3d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 supply = totalSupply();", "highlightLines": [164]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC4626.sol", "line": 164, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7f2d28dfbed3", "fix": {"template": null, "available": false}, "title": "NFT mint without supply check - potential overflow in tokenId", "ruleId": "rules.sol-nft-overflow-mint", "snippet": {"code": "        _mint(receiver, shares);", "highlightLines": [188]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC4626.sol", "line": 188, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "b53660d6a29b", "fix": {"template": null, "available": false}, "title": "Share calculation vulnerable to first depositor attack - attacker can inflate share price", "ruleId": "rules.sol-first-depositor-attack", "snippet": {"code": "        return totalAssets() > 0 || totalSupply() == 0;", "highlightLines": [220]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC4626.sol", "line": 220, "column": 37}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs", "https://blog.openzeppelin.com/compound-comprehensive-security-assessment"], "description": ""}, {"id": "614f8b12a837", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/IERC20Metadata.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "a87f5d77ee9e", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/draft-ERC20Permit.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "07953477673b", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "abstract contract ERC20Permit is ERC20, IERC20Permit, EIP712 {", "highlightLines": [22]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/draft-ERC20Permit.sol", "line": 22, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "2231939d3fbb", "fix": {"template": null, "available": false}, "title": "Base constructor called multiple times through diamond inheritance - may initialize twice", "ruleId": "rules.sol-reused-constructor", "snippet": {"code": "abstract contract ERC20Permit is ERC20, IERC20Permit, EIP712 {", "highlightLines": [22]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/draft-ERC20Permit.sol", "line": 22, "column": 10}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#reused-base-constructor"], "description": ""}, {"id": "04066b052225", "fix": {"template": null, "available": false}, "title": "SWC-125: Multiple inheritance may cause incorrect function resolution - check C3 linearization", "ruleId": "rules.sol-swc-125-inheritance-order", "snippet": {"code": "abstract contract ERC20Permit is ERC20, IERC20Permit, EIP712 {", "highlightLines": [22]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/draft-ERC20Permit.sol", "line": 22, "column": 10}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-125"], "description": ""}, {"id": "1035ebfe4644", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "abstract contract ERC20Permit is ERC20, IERC20Permit, EIP712 {\n    using Counters for Counters.Counter;\n\n    mapping(address => Counters.Counter) private _nonces;\n\n    // solhint-disable-next-line var-name-mixedcase\n    bytes32 private constant _PERMIT_TYPEHASH =\n        keccak256(\"Permit(address owner,address spender,uint256 value,uint256 nonce,uint256 deadline)\");\n    /**\n     * @dev In previous versions `_PERMIT_TYPEHASH` was declared as `immutable`.\n     * However, to ensure consistency with the upgradeable transpiler, we will continue\n     * to reserve a slot.\n     * @custom:oz-renamed-from _PERMIT_TYPEHASH\n     */\n    // solhint-disable-next-line var-name-mixedcase\n    bytes32 private _PERMIT_TYPEHASH_DEPRECATED_SLOT;", "highlightLines": [22]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/draft-ERC20Permit.sol", "line": 22, "column": 10}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "dcd92a7ab1ca", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(string memory name) EIP712(name, \"1\") {}", "highlightLines": [44]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/draft-ERC20Permit.sol", "line": 44, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "a19ecc9b7470", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        require(block.timestamp <= deadline, \"ERC20Permit: expired deadline\");", "highlightLines": [58]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/draft-ERC20Permit.sol", "line": 58, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "4474b42a9a7d", "fix": {"template": null, "available": false}, "title": "Block timestamp used for critical logic - miners can manipulate within ~15 second window", "ruleId": "rules.sol-block-timestamp-manipulation", "snippet": {"code": "        require(block.timestamp <= deadline, \"ERC20Permit: expired deadline\");", "highlightLines": [58]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/draft-ERC20Permit.sol", "line": 58, "column": 17}, "severity": "medium", "references": ["https://consensys.github.io/smart-contract-best-practices/development-recommendations/solidity-specific/timestamp-dependence/"], "description": ""}, {"id": "1e2db3059996", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        bytes32 structHash = keccak256(abi.encode(_PERMIT_TYPEHASH, owner, spender, value, _useNonce(owner), deadline));", "highlightLines": [59]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/draft-ERC20Permit.sol", "line": 59, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "5a45593fc332", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes32 structHash = keccak256(abi.encode(_PERMIT_TYPEHASH, owner, spender, value, _useNonce(owner), deadline));\n\n        bytes32 hash = _hashTypedDataV4(structHash);", "highlightLines": [60]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/draft-ERC20Permit.sol", "line": 60, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "54712c99a749", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        bytes32 structHash = keccak256(abi.encode(_PERMIT_TYPEHASH, owner, spender, value, _useNonce(owner), deadline));", "highlightLines": [60]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/draft-ERC20Permit.sol", "line": 60, "column": 30}, "severity": "high", "references": [], "description": ""}, {"id": "5f090af8ccaa", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        bytes32 hash = _hashTypedDataV4(structHash);", "highlightLines": [61]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/draft-ERC20Permit.sol", "line": 61, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ac91717db435", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes32 hash = _hashTypedDataV4(structHash);\n\n        address signer = ECDSA.recover(hash, v, r, s);", "highlightLines": [62]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/draft-ERC20Permit.sol", "line": 62, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "8499cc082316", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        address signer = ECDSA.recover(hash, v, r, s);", "highlightLines": [63]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/draft-ERC20Permit.sol", "line": 63, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d39eef4492c0", "fix": {"template": null, "available": false}, "title": "ecrecover result not checked for zero address - invalid signatures return address(0)", "ruleId": "rules.sol-ethernaut-ecrecover-no-zero-check", "snippet": {"code": "        address signer = ECDSA.recover(hash, v, r, s);", "highlightLines": [64]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/draft-ERC20Permit.sol", "line": 64, "column": 26}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-117", "https://swcregistry.io/docs/SWC-122"], "description": ""}, {"id": "964bffc5f39d", "fix": {"template": null, "available": false}, "title": "Custom function named DOMAIN_SEPARATOR may collide with EIP-712 implementation", "ruleId": "rules.sol-domain-separator-collision", "snippet": {"code": "    function DOMAIN_SEPARATOR() external view override returns (bytes32) {", "highlightLines": [81]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/draft-ERC20Permit.sol", "line": 81, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#domain-separator-collision"], "description": ""}, {"id": "080ab588e22c", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "     * @dev \"Consume a nonce\": return the current value and increment.\n     *\n     * _Available since v4.1._\n     */\n    function _useNonce(address owner) internal virtual returns (uint256 current) {\n        Counters.Counter storage nonce = _nonces[owner];\n        current = nonce.current();", "highlightLines": [86]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/draft-ERC20Permit.sol", "line": 86, "column": 32}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "b19e7d7603f1", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        Counters.Counter storage nonce = _nonces[owner];\n        current = nonce.current();", "highlightLines": [91]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/draft-ERC20Permit.sol", "line": 91, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "0ef7e8edd506", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/draft-IERC20Permit.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "a96ebe124a09", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function permit(\n        address owner,\n        address spender,\n        uint256 value,\n        uint256 deadline,\n        uint8 v,\n        bytes32 r,\n        bytes32 s\n    ) external;", "highlightLines": [36]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/draft-IERC20Permit.sol", "line": 36, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "5d7fe14f63c2", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function nonces(address owner) external view returns (uint256);", "highlightLines": [53]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/draft-IERC20Permit.sol", "line": 53, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "dc9c45968570", "fix": {"template": null, "available": false}, "title": "Custom function named DOMAIN_SEPARATOR may collide with EIP-712 implementation", "ruleId": "rules.sol-domain-separator-collision", "snippet": {"code": "    function DOMAIN_SEPARATOR() external view returns (bytes32);", "highlightLines": [59]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/draft-IERC20Permit.sol", "line": 59, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#domain-separator-collision"], "description": ""}, {"id": "2679633629da", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/presets/ERC20PresetFixedSupply.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "00ef495a4c60", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(\n        string memory name,\n        string memory symbol,\n        uint256 initialSupply,\n        address owner\n    ) ERC20(name, symbol) {\n        _mint(owner, initialSupply);\n    }", "highlightLines": [27]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/presets/ERC20PresetFixedSupply.sol", "line": 27, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "e5ef713b47b5", "fix": {"template": null, "available": false}, "title": "NFT mint without supply check - potential overflow in tokenId", "ruleId": "rules.sol-nft-overflow-mint", "snippet": {"code": "        _mint(owner, initialSupply);", "highlightLines": [33]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/presets/ERC20PresetFixedSupply.sol", "line": 33, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "31266b2e4637", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/presets/ERC20PresetMinterPauser.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "6a3361d05fee", "fix": {"template": null, "available": false}, "title": "Base constructor called multiple times through diamond inheritance - may initialize twice", "ruleId": "rules.sol-reused-constructor", "snippet": {"code": "contract ERC20PresetMinterPauser is Context, AccessControlEnumerable, ERC20Burnable, ERC20Pausable {", "highlightLines": [28]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/presets/ERC20PresetMinterPauser.sol", "line": 28, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#reused-base-constructor"], "description": ""}, {"id": "03e02125b77d", "fix": {"template": null, "available": false}, "title": "SWC-125: Multiple inheritance may cause incorrect function resolution - check C3 linearization", "ruleId": "rules.sol-swc-125-inheritance-order", "snippet": {"code": "contract ERC20PresetMinterPauser is Context, AccessControlEnumerable, ERC20Burnable, ERC20Pausable {", "highlightLines": [28]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/presets/ERC20PresetMinterPauser.sol", "line": 28, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-125"], "description": ""}, {"id": "462967159e27", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(string memory name, string memory symbol) ERC20(name, symbol) {\n        _setupRole(DEFAULT_ADMIN_ROLE, _msgSender());\n\n        _setupRole(MINTER_ROLE, _msgSender());\n        _setupRole(PAUSER_ROLE, _msgSender());\n    }", "highlightLines": [38]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/presets/ERC20PresetMinterPauser.sol", "line": 38, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "833e030e4d24", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function mint(address to, uint256 amount) public virtual {", "highlightLines": [54]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/presets/ERC20PresetMinterPauser.sol", "line": 54, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "77119dbf2bc5", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function mint(address to, uint256 amount) public virtual {", "highlightLines": [54]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/presets/ERC20PresetMinterPauser.sol", "line": 54, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "5d59e28c6ed5", "fix": {"template": null, "available": false}, "title": "NFT mint without supply check - potential overflow in tokenId", "ruleId": "rules.sol-nft-overflow-mint", "snippet": {"code": "        _mint(to, amount);", "highlightLines": [56]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/presets/ERC20PresetMinterPauser.sol", "line": 56, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "6e0f3ccf3f18", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function pause() public virtual {", "highlightLines": [68]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/presets/ERC20PresetMinterPauser.sol", "line": 68, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "4bef176278d8", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function unpause() public virtual {", "highlightLines": [82]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/presets/ERC20PresetMinterPauser.sol", "line": 82, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "08cfea17a5f0", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "    ) internal virtual override(ERC20, ERC20Pausable) {", "highlightLines": [91]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/presets/ERC20PresetMinterPauser.sol", "line": 91, "column": 33}, "severity": "info", "references": [], "description": ""}, {"id": "81de7b56ad47", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/utils/SafeERC20.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "d06f221cb2ec", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function safeApprove(\n        IERC20 token,\n        address spender,\n        uint256 value\n    ) internal {\n        // safeApprove should only be called when setting an initial allowance,\n        // or when resetting it to zero. To increase and decrease it, use\n        // 'safeIncreaseAllowance' and 'safeDecreaseAllowance'\n        require(\n            (value == 0) || (token.allowance(address(this), spender) == 0),", "highlightLines": [46]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/utils/SafeERC20.sol", "line": 46, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "480f71270822", "fix": {"template": null, "available": false}, "title": "safeApprove fails if current approval non-zero - use forceApprove or reset first", "ruleId": "rules.sol-safe-approve-nonzero", "snippet": {"code": "    function safeApprove(\n        IERC20 token,\n        address spender,\n        uint256 value\n    ) internal {", "highlightLines": [46]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/utils/SafeERC20.sol", "line": 46, "column": 14}, "severity": "medium", "references": [], "description": ""}, {"id": "7aff4d5f47e2", "fix": {"template": null, "available": false}, "title": "Using safeApprove incorrectly - must set allowance to 0 first for tokens that require it", "ruleId": "rules.sol-safeapprove-usage", "snippet": {"code": "    function safeApprove(\n        IERC20 token,\n        address spender,\n        uint256 value\n    ) internal {", "highlightLines": [46]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/utils/SafeERC20.sol", "line": 46, "column": 14}, "severity": "medium", "references": [], "description": ""}, {"id": "4b72dad24f13", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 newAllowance = token.allowance(address(this), spender) + value;", "highlightLines": [66]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/utils/SafeERC20.sol", "line": 66, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "9e18b307ce19", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint256 oldAllowance = token.allowance(address(this), spender);", "highlightLines": [76]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/utils/SafeERC20.sol", "line": 76, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b0051dedd2d7", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            uint256 oldAllowance = token.allowance(address(this), spender);\n            require(oldAllowance >= value, \"SafeERC20: decreased allowance below zero\");\n            uint256 newAllowance = oldAllowance - value;", "highlightLines": [76]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/utils/SafeERC20.sol", "line": 76, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "dfb3d93d4dbb", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint256 newAllowance = oldAllowance - value;", "highlightLines": [78]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/utils/SafeERC20.sol", "line": 78, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e4538ae62ff7", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "            uint256 newAllowance = oldAllowance - value;", "highlightLines": [78]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/utils/SafeERC20.sol", "line": 78, "column": 36}, "severity": "medium", "references": [], "description": ""}, {"id": "23981bfc2607", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 nonceBefore = token.nonces(owner);", "highlightLines": [93]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/utils/SafeERC20.sol", "line": 93, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "1d4f40312ff6", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "        uint256 nonceBefore = token.nonces(owner);\n        token.permit(owner, spender, value, deadline, v, r, s);\n        uint256 nonceAfter = token.nonces(owner);", "highlightLines": [93]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/utils/SafeERC20.sol", "line": 93, "column": 9}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "487c4f6a23b2", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 nonceBefore = token.nonces(owner);\n        token.permit(owner, spender, value, deadline, v, r, s);\n        uint256 nonceAfter = token.nonces(owner);", "highlightLines": [93]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/utils/SafeERC20.sol", "line": 93, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "1b0ea90a206e", "fix": {"template": null, "available": false}, "title": "ERC20 permit without deadline validation - permits can be replayed", "ruleId": "rules.sol-permit-no-deadline-check", "snippet": {"code": "        token.permit(owner, spender, value, deadline, v, r, s);", "highlightLines": [94]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/utils/SafeERC20.sol", "line": 94, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "cc4209a74c0d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 nonceAfter = token.nonces(owner);", "highlightLines": [95]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/utils/SafeERC20.sol", "line": 95, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "466e08c2355c", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "     * on the return value: the return value is optional (but if data is returned, it must not be false).\n     * @param token The token targeted by the call.\n     * @param data The call data (encoded using abi.encode or one of its variants).\n     */\n    function _callOptionalReturn(IERC20 token, bytes memory data) private {\n        // We need to perform a low level call here, to bypass Solidity's return data size checking mechanism, since\n        // we're implementing it ourselves. We use {Address.functionCall} to perform this call, which verifies that\n        // the target address contains contract code and also asserts for success in the low-level call.\n\n        bytes memory returndata = address(token).functionCall(data, \"SafeERC20: low-level call failed\");\n        if (returndata.length > 0) {", "highlightLines": [101]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/utils/SafeERC20.sol", "line": 101, "column": 15}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "ffe35587253e", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/utils/TokenTimelock.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "cef24f7d084a", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(\n        IERC20 token_,\n        address beneficiary_,\n        uint256 releaseTime_\n    ) {\n        require(releaseTime_ > block.timestamp, \"TokenTimelock: release time is before current time\");\n        _token = token_;\n        _beneficiary = beneficiary_;\n        _releaseTime = releaseTime_;\n    }", "highlightLines": [32]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/utils/TokenTimelock.sol", "line": 32, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "9345b147515d", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        require(releaseTime_ > block.timestamp, \"TokenTimelock: release time is before current time\");", "highlightLines": [37]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/utils/TokenTimelock.sol", "line": 37, "column": 32}, "severity": "medium", "references": [], "description": ""}, {"id": "f533a83de79e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        _token = token_;\n        _beneficiary = beneficiary_;", "highlightLines": [38]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/utils/TokenTimelock.sol", "line": 38, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "7f6dcbc5633b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        _beneficiary = beneficiary_;\n        _releaseTime = releaseTime_;", "highlightLines": [39]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/utils/TokenTimelock.sol", "line": 39, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "0ac016b4dc62", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        require(block.timestamp >= releaseTime(), \"TokenTimelock: current time is before release time\");", "highlightLines": [69]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/utils/TokenTimelock.sol", "line": 69, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "3af70a2488b2", "fix": {"template": null, "available": false}, "title": "Block timestamp used for critical logic - miners can manipulate within ~15 second window", "ruleId": "rules.sol-block-timestamp-manipulation", "snippet": {"code": "        require(block.timestamp >= releaseTime(), \"TokenTimelock: current time is before release time\");", "highlightLines": [69]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/utils/TokenTimelock.sol", "line": 69, "column": 17}, "severity": "medium", "references": ["https://consensys.github.io/smart-contract-best-practices/development-recommendations/solidity-specific/timestamp-dependence/"], "description": ""}, {"id": "013422178711", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 amount = token().balanceOf(address(this));", "highlightLines": [70]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC20/utils/TokenTimelock.sol", "line": 70, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "1ad60ee4098b", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "3f297c474cee", "fix": {"template": null, "available": false}, "title": "Base constructor called multiple times through diamond inheritance - may initialize twice", "ruleId": "rules.sol-reused-constructor", "snippet": {"code": "contract ERC721 is Context, ERC165, IERC721, IERC721Metadata {", "highlightLines": [19]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 19, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#reused-base-constructor"], "description": ""}, {"id": "33f3c0158e09", "fix": {"template": null, "available": false}, "title": "SWC-125: Multiple inheritance may cause incorrect function resolution - check C3 linearization", "ruleId": "rules.sol-swc-125-inheritance-order", "snippet": {"code": "contract ERC721 is Context, ERC165, IERC721, IERC721Metadata {", "highlightLines": [19]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 19, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-125"], "description": ""}, {"id": "cee85c2fc941", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "contract ERC721 is Context, ERC165, IERC721, IERC721Metadata {", "highlightLines": [19]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 19, "column": 1}, "severity": "medium", "references": [], "description": ""}, {"id": "3bddcdfff1c6", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract ERC721 is Context, ERC165, IERC721, IERC721Metadata {\n    using Address for address;\n    using Strings for uint256;\n\n    // Token name\n    string private _name;\n\n    // Token symbol\n    string private _symbol;", "highlightLines": [19]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 19, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "dbed0647f621", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "contract ERC721 is Context, ERC165, IERC721, IERC721Metadata {", "highlightLines": [19]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 19, "column": 37}, "severity": "info", "references": [], "description": ""}, {"id": "8f2538185aae", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(string memory name_, string memory symbol_) {\n        _name = name_;\n        _symbol = symbol_;\n    }", "highlightLines": [44]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 44, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "5cd91c90d5f5", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        _name = name_;\n        _symbol = symbol_;", "highlightLines": [45]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 45, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "909861b8a4d7", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function supportsInterface(bytes4 interfaceId) public view virtual override(ERC165, IERC165) returns (bool) {\n        return\n            interfaceId == type(IERC721).interfaceId ||\n            interfaceId == type(IERC721Metadata).interfaceId ||", "highlightLines": [52]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 52, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "d9a469f9f94b", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function ownerOf(uint256 tokenId) public view virtual override returns (address) {", "highlightLines": [70]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 70, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "341dea06d12c", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function ownerOf(uint256 tokenId) public view virtual override returns (address) {\n        address owner = _owners[tokenId];", "highlightLines": [70]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 70, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "1be60c2c479d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address owner = _owners[tokenId];", "highlightLines": [71]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 71, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "010e0e742b2a", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "        address owner = _owners[tokenId];", "highlightLines": [71]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 71, "column": 9}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "66303f0becca", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        address owner = _owners[tokenId];", "highlightLines": [71]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 71, "column": 17}, "severity": "info", "references": [], "description": ""}, {"id": "86de25217950", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function tokenURI(uint256 tokenId) public view virtual override returns (string memory) {", "highlightLines": [93]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 93, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "008b44089d0e", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function tokenURI(uint256 tokenId) public view virtual override returns (string memory) {\n        _requireMinted(tokenId);\n\n        string memory baseURI = _baseURI();", "highlightLines": [93]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 93, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "74400d85a48d", "fix": {"template": null, "available": false}, "title": "tokenURI returns predictable path with tokenId - metadata visible before mint", "ruleId": "rules.sol-tokenuri-predictable", "snippet": {"code": "    function tokenURI(uint256 tokenId) public view virtual override returns (string memory) {\n        _requireMinted(tokenId);\n\n        string memory baseURI = _baseURI();\n        return bytes(baseURI).length > 0 ? string(abi.encodePacked(baseURI, tokenId.toString())) : \"\";", "highlightLines": [93]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 93, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/NFTMint_exposedMetadata.sol"], "description": ""}, {"id": "81d62d43a02b", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "        return bytes(baseURI).length > 0 ? string(abi.encodePacked(baseURI, tokenId.toString())) : \"\";", "highlightLines": [97]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 97, "column": 51}, "severity": "medium", "references": [], "description": ""}, {"id": "8908a19b9d9b", "fix": {"template": null, "available": false}, "title": "String concatenation for signature message - potential collision if components have variable length", "ruleId": "rules.sol-ethernaut-string-signature-collision", "snippet": {"code": "        return bytes(baseURI).length > 0 ? string(abi.encodePacked(baseURI, tokenId.toString())) : \"\";", "highlightLines": [97]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 97, "column": 51}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/"], "description": ""}, {"id": "c5d8e3fc1da7", "fix": {"template": null, "available": false}, "title": "Nonce converted to string for signature - verify no collision with other string components", "ruleId": "rules.sol-ethernaut-nonce-string-conversion", "snippet": {"code": "        return bytes(baseURI).length > 0 ? string(abi.encodePacked(baseURI, tokenId.toString())) : \"\";", "highlightLines": [97]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 97, "column": 77}, "severity": "medium", "references": [], "description": ""}, {"id": "3d9de01dcb21", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function approve(address to, uint256 tokenId) public virtual override {", "highlightLines": [112]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 112, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "a429f14429a6", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function approve(address to, uint256 tokenId) public virtual override {", "highlightLines": [112]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 112, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "cda4d86e907b", "fix": {"template": null, "available": false}, "title": "Using approve() without increaseAllowance/decreaseAllowance - vulnerable to front-running race condition", "ruleId": "rules.sol-erc20-approve-frontrun", "snippet": {"code": "    function approve(address to, uint256 tokenId) public virtual override {\n        address owner = ERC721.ownerOf(tokenId);\n        require(to != owner, \"ERC721: approval to current owner\");\n\n        require(\n            _msgSender() == owner || isApprovedForAll(owner, _msgSender()),\n            \"ERC721: approve caller is not token owner nor approved for all\"\n        );\n\n        _approve(to, tokenId);\n    }", "highlightLines": [112]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 112, "column": 5}, "severity": "info", "references": ["https://docs.google.com/document/d/1YLPtQxZu1UAvO9cZ1O2RPXBbT0mooh4DYKjA_jp-RLM"], "description": ""}, {"id": "b6e4c60e8624", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address owner = ERC721.ownerOf(tokenId);", "highlightLines": [113]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 113, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "5216c9acce93", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "        address owner = ERC721.ownerOf(tokenId);", "highlightLines": [113]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 113, "column": 9}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "9bd634deb8e0", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        address owner = ERC721.ownerOf(tokenId);", "highlightLines": [113]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 113, "column": 17}, "severity": "info", "references": [], "description": ""}, {"id": "dc396bafcccd", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function getApproved(uint256 tokenId) public view virtual override returns (address) {", "highlightLines": [127]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 127, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "4d55cc66a099", "fix": {"template": null, "available": false}, "title": "ERC20 transferFrom without payload size validation - consider adding onlyPayloadSize modifier", "ruleId": "rules.sol-erc20-missing-payload-modifier", "snippet": {"code": "    function transferFrom(\n        address from,\n        address to,\n        uint256 tokenId\n    ) public virtual override {", "highlightLines": [150]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 150, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address"], "description": ""}, {"id": "5c14e5790525", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function transferFrom(\n        address from,\n        address to,\n        uint256 tokenId\n    ) public virtual override {", "highlightLines": [150]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 150, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "6ed7dc8324eb", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function transferFrom(\n        address from,\n        address to,\n        uint256 tokenId\n    ) public virtual override {", "highlightLines": [150]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 150, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "bc84e68b1951", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function safeTransferFrom(\n        address from,\n        address to,\n        uint256 tokenId\n    ) public virtual override {", "highlightLines": [164]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 164, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "935d1a476a0e", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function safeTransferFrom(\n        address from,\n        address to,\n        uint256 tokenId,\n        bytes memory data\n    ) public virtual override {", "highlightLines": [175]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 175, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "a33a1dec04ac", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function _safeTransfer(\n        address from,\n        address to,\n        uint256 tokenId,\n        bytes memory data\n    ) internal virtual {", "highlightLines": [203]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 203, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "76e4ed434045", "fix": {"template": null, "available": false}, "title": "ERC721 safeTransferFrom/safeMint can trigger reentrancy via onERC721Received callback", "ruleId": "rules.sol-erc721-reentrancy", "snippet": {"code": "        require(_checkOnERC721Received(from, to, tokenId, data), \"ERC721: transfer to non ERC721Receiver implementer\");", "highlightLines": [210]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 210, "column": 17}, "severity": "medium", "references": ["https://blocksecteam.medium.com/when-safemint-becomes-unsafe-lessons-from-the-hypebears-security-incident-2965209bda2a"], "description": ""}, {"id": "05c05afff39f", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function _exists(uint256 tokenId) internal view virtual returns (bool) {", "highlightLines": [221]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 221, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "7490a772dc7f", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function _isApprovedOrOwner(address spender, uint256 tokenId) internal view virtual returns (bool) {", "highlightLines": [232]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 232, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "850e92800efc", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function _isApprovedOrOwner(address spender, uint256 tokenId) internal view virtual returns (bool) {\n        address owner = ERC721.ownerOf(tokenId);", "highlightLines": [232]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 232, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "552a1996f080", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function _isApprovedOrOwner(address spender, uint256 tokenId) internal view virtual returns (bool) {\n        address owner = ERC721.ownerOf(tokenId);\n        return (spender == owner || isApprovedForAll(owner, spender) || getApproved(tokenId) == spender);", "highlightLines": [232]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 232, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "47289b43aac6", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address owner = ERC721.ownerOf(tokenId);", "highlightLines": [233]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 233, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "eba53c48fd09", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "        address owner = ERC721.ownerOf(tokenId);", "highlightLines": [233]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 233, "column": 9}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "9c0ce4ab6a6e", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        address owner = ERC721.ownerOf(tokenId);", "highlightLines": [233]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 233, "column": 17}, "severity": "info", "references": [], "description": ""}, {"id": "2e7951587c0c", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function _safeMint(address to, uint256 tokenId) internal virtual {", "highlightLines": [247]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 247, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "8dfd15b45c52", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function _safeMint(\n        address to,\n        uint256 tokenId,\n        bytes memory data\n    ) internal virtual {", "highlightLines": [255]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 255, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "b0885dc17fe2", "fix": {"template": null, "available": false}, "title": "NFT mint without supply check - potential overflow in tokenId", "ruleId": "rules.sol-nft-overflow-mint", "snippet": {"code": "        _mint(to, tokenId);", "highlightLines": [260]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 260, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "93c9a38aa20a", "fix": {"template": null, "available": false}, "title": "ERC721 safeTransferFrom/safeMint can trigger reentrancy via onERC721Received callback", "ruleId": "rules.sol-erc721-reentrancy", "snippet": {"code": "            _checkOnERC721Received(address(0), to, tokenId, data),", "highlightLines": [262]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 262, "column": 13}, "severity": "medium", "references": ["https://blocksecteam.medium.com/when-safemint-becomes-unsafe-lessons-from-the-hypebears-security-incident-2965209bda2a"], "description": ""}, {"id": "ec7e7fa9f6bf", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function _burn(uint256 tokenId) internal virtual {", "highlightLines": [303]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 303, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "b022fb2eed50", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address owner = ERC721.ownerOf(tokenId);", "highlightLines": [304]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 304, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "174de63d2b66", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "        address owner = ERC721.ownerOf(tokenId);", "highlightLines": [304]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 304, "column": 9}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "a4ede358d433", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        address owner = ERC721.ownerOf(tokenId);", "highlightLines": [304]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 304, "column": 17}, "severity": "info", "references": [], "description": ""}, {"id": "7ce199465420", "fix": {"template": null, "available": false}, "title": "Deleting mapping inside struct leaves nested data - use separate mapping deletion", "ruleId": "rules.sol-mapping-deletion", "snippet": {"code": "        delete _tokenApprovals[tokenId];", "highlightLines": [309]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 309, "column": 9}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#deletion-on-mapping-containing-a-structure"], "description": ""}, {"id": "a4673d0d64c5", "fix": {"template": null, "available": false}, "title": "delete array[i] leaves gap with zero value - use swap-and-pop pattern instead", "ruleId": "rules.sol-array-element-delete", "snippet": {"code": "        delete _tokenApprovals[tokenId];", "highlightLines": [309]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 309, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/Array-deletion.sol"], "description": ""}, {"id": "92ced7c25c86", "fix": {"template": null, "available": false}, "title": "Deleting mapping inside struct leaves nested data - use separate mapping deletion", "ruleId": "rules.sol-mapping-deletion", "snippet": {"code": "        delete _owners[tokenId];", "highlightLines": [312]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 312, "column": 9}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#deletion-on-mapping-containing-a-structure"], "description": ""}, {"id": "5b6e7fe7a308", "fix": {"template": null, "available": false}, "title": "delete array[i] leaves gap with zero value - use swap-and-pop pattern instead", "ruleId": "rules.sol-array-element-delete", "snippet": {"code": "        delete _owners[tokenId];", "highlightLines": [312]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 312, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/Array-deletion.sol"], "description": ""}, {"id": "4b26c4e1e5ef", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function _transfer(\n        address from,\n        address to,\n        uint256 tokenId\n    ) internal virtual {", "highlightLines": [330]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 330, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "c5a282cc208e", "fix": {"template": null, "available": false}, "title": "Self transfer not checked - can cause balance corruption with from == to", "ruleId": "rules.sol-self-transfer-unchecked", "snippet": {"code": "    function _transfer(\n        address from,\n        address to,\n        uint256 tokenId\n    ) internal virtual {", "highlightLines": [330]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 330, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/self-transfer.sol"], "description": ""}, {"id": "a2d70db23132", "fix": {"template": null, "available": false}, "title": "Deleting mapping inside struct leaves nested data - use separate mapping deletion", "ruleId": "rules.sol-mapping-deletion", "snippet": {"code": "        delete _tokenApprovals[tokenId];", "highlightLines": [341]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 341, "column": 9}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#deletion-on-mapping-containing-a-structure"], "description": ""}, {"id": "eb8cadd0cde9", "fix": {"template": null, "available": false}, "title": "delete array[i] leaves gap with zero value - use swap-and-pop pattern instead", "ruleId": "rules.sol-array-element-delete", "snippet": {"code": "        delete _tokenApprovals[tokenId];", "highlightLines": [341]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 341, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/Array-deletion.sol"], "description": ""}, {"id": "82028b2ab101", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function _approve(address to, uint256 tokenId) internal virtual {", "highlightLines": [357]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 357, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "6c89036bc04e", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function _checkOnERC721Received(\n        address from,\n        address to,\n        uint256 tokenId,\n        bytes memory data\n    ) private returns (bool) {", "highlightLines": [394]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 394, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "3f5b1a9f5ade", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "            try IERC721Receiver(to).onERC721Received(_msgSender(), from, tokenId, data) returns (bytes4 retval) {", "highlightLines": [401]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 401, "column": 17}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "4ea59d6b4bd9", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "                if (reason.length == 0) {\n                    revert(\"ERC721: transfer to non ERC721Receiver implementer\");\n                } else {\n                    /// @solidity memory-safe-assembly\n                    assembly {\n                        revert(add(32, reason), mload(reason))\n                    }\n                }", "highlightLines": [404]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 404, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "23e05a7f2223", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "                    assembly {", "highlightLines": [408]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 408, "column": 21}, "severity": "info", "references": [], "description": ""}, {"id": "9f645e1b034b", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function _beforeTokenTransfer(\n        address from,\n        address to,\n        uint256 tokenId\n    ) internal virtual {}", "highlightLines": [432]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 432, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "435c8ddfd90b", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function _afterTokenTransfer(\n        address from,\n        address to,\n        uint256 tokenId\n    ) internal virtual {}", "highlightLines": [449]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol", "line": 449, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "2ac8ee5cdc80", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/IERC721.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "4e56f7ca16d5", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Transfer(address indexed from, address indexed to, uint256 indexed tokenId);", "highlightLines": [15]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/IERC721.sol", "line": 15, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "3020df0769e5", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Approval(address indexed owner, address indexed approved, uint256 indexed tokenId);", "highlightLines": [20]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/IERC721.sol", "line": 20, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "99ddbf176862", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event ApprovalForAll(address indexed owner, address indexed operator, bool approved);", "highlightLines": [25]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/IERC721.sol", "line": 25, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "6cfc56a4a71a", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function balanceOf(address owner) external view returns (uint256 balance);", "highlightLines": [30]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/IERC721.sol", "line": 30, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "8ff03bba41d4", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function ownerOf(uint256 tokenId) external view returns (address owner);\n\n    /**\n     * @dev Safely transfers `tokenId` token from `from` to `to`.\n     *\n     * Requirements:\n     *\n     * - `from` cannot be the zero address.\n     * - `to` cannot be the zero address.\n     * - `tokenId` token must exist and be owned by `from`.\n     * - If the caller is not `from`, it must be approved to move this token by either {approve} or {setApprovalForAll}.", "highlightLines": [39]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/IERC721.sol", "line": 39, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "1897dee40cf8", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function safeTransferFrom(\n        address from,\n        address to,\n        uint256 tokenId,\n        bytes calldata data\n    ) external;", "highlightLines": [54]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/IERC721.sol", "line": 54, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "dacaa1d0ef33", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function safeTransferFrom(\n        address from,\n        address to,\n        uint256 tokenId,\n        bytes calldata data\n    ) external;\n\n    /**\n     * @dev Safely transfers `tokenId` token from `from` to `to`, checking first that contract recipients\n     * are aware of the ERC721 protocol to prevent tokens from being forever locked.\n     *\n     * Requirements:\n     *\n     * - `from` cannot be the zero address.\n     * - `to` cannot be the zero address.\n     * - `tokenId` token must exist and be owned by `from`.\n     * - If the caller is not `from`, it must have been allowed to move this token by either {approve} or {setApprovalForAll}.", "highlightLines": [54]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/IERC721.sol", "line": 54, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "9ef0c5d4b9ac", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function safeTransferFrom(\n        address from,\n        address to,\n        uint256 tokenId\n    ) external;", "highlightLines": [75]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/IERC721.sol", "line": 75, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "f6f453b8ab41", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function safeTransferFrom(\n        address from,\n        address to,\n        uint256 tokenId\n    ) external;\n\n    /**\n     * @dev Transfers `tokenId` token from `from` to `to`.\n     *\n     * WARNING: Usage of this method is discouraged, use {safeTransferFrom} whenever possible.", "highlightLines": [75]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/IERC721.sol", "line": 75, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "640ac3fb4f04", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function transferFrom(\n        address from,\n        address to,\n        uint256 tokenId\n    ) external;", "highlightLines": [95]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/IERC721.sol", "line": 95, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "fafcd20819ba", "fix": {"template": null, "available": false}, "title": "ERC20 transferFrom without payload size validation - consider adding onlyPayloadSize modifier", "ruleId": "rules.sol-erc20-missing-payload-modifier", "snippet": {"code": "    function transferFrom(\n        address from,\n        address to,\n        uint256 tokenId\n    ) external;\n\n    /**\n     * @dev Gives permission to `to` to transfer `tokenId` token to another account.\n     * The approval is cleared when the token is transferred.\n     *\n     * Only a single account can be approved at a time, so approving the zero address clears previous approvals.\n     *\n     * Requirements:\n     *\n     * - The caller must own the token or be an approved operator.\n     * - `tokenId` must exist.\n     *\n     * Emits an {Approval} event.", "highlightLines": [95]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/IERC721.sol", "line": 95, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address"], "description": ""}, {"id": "d5b80f7c6179", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function transferFrom(\n        address from,\n        address to,\n        uint256 tokenId\n    ) external;\n\n    /**\n     * @dev Gives permission to `to` to transfer `tokenId` token to another account.\n     * The approval is cleared when the token is transferred.\n     *\n     * Only a single account can be approved at a time, so approving the zero address clears previous approvals.\n     *\n     * Requirements:\n     *\n     * - The caller must own the token or be an approved operator.\n     * - `tokenId` must exist.\n     *\n     * Emits an {Approval} event.", "highlightLines": [95]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/IERC721.sol", "line": 95, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "f184a7eaa4a4", "fix": {"template": null, "available": false}, "title": "NFT transfer without approval/ownership check - add _isApprovedOrOwner validation", "ruleId": "rules.sol-nft-transfer-no-approval-check", "snippet": {"code": "    function transferFrom(\n        address from,\n        address to,\n        uint256 tokenId\n    ) external;\n\n    /**\n     * @dev Gives permission to `to` to transfer `tokenId` token to another account.\n     * The approval is cleared when the token is transferred.\n     *\n     * Only a single account can be approved at a time, so approving the zero address clears previous approvals.\n     *\n     * Requirements:\n     *\n     * - The caller must own the token or be an approved operator.\n     * - `tokenId` must exist.\n     *\n     * Emits an {Approval} event.", "highlightLines": [95]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/IERC721.sol", "line": 95, "column": 5}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/NFT-transfer.sol"], "description": ""}, {"id": "d03f0b081dc3", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function transferFrom(\n        address from,\n        address to,\n        uint256 tokenId\n    ) external;\n\n    /**\n     * @dev Gives permission to `to` to transfer `tokenId` token to another account.\n     * The approval is cleared when the token is transferred.\n     *\n     * Only a single account can be approved at a time, so approving the zero address clears previous approvals.\n     *\n     * Requirements:\n     *\n     * - The caller must own the token or be an approved operator.\n     * - `tokenId` must exist.\n     *\n     * Emits an {Approval} event.", "highlightLines": [95]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/IERC721.sol", "line": 95, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "aba507d6e47d", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function approve(address to, uint256 tokenId) external;", "highlightLines": [114]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/IERC721.sol", "line": 114, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "589c3b27be5e", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function approve(address to, uint256 tokenId) external;\n\n    /**\n     * @dev Approve or remove `operator` as an operator for the caller.\n     * Operators can call {transferFrom} or {safeTransferFrom} for any token owned by the caller.", "highlightLines": [114]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/IERC721.sol", "line": 114, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "ae80443e5846", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function approve(address to, uint256 tokenId) external;\n\n    /**\n     * @dev Approve or remove `operator` as an operator for the caller.\n     * Operators can call {transferFrom} or {safeTransferFrom} for any token owned by the caller.", "highlightLines": [114]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/IERC721.sol", "line": 114, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "158802338466", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function setApprovalForAll(address operator, bool _approved) external;", "highlightLines": [126]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/IERC721.sol", "line": 126, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "b3648d9c4dc7", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function getApproved(uint256 tokenId) external view returns (address operator);\n\n    /**\n     * @dev Returns if the `operator` is allowed to manage all of the assets of `owner`.\n     *\n     * See {setApprovalForAll}", "highlightLines": [135]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/IERC721.sol", "line": 135, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "4d7f7d27bbdd", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function isApprovedForAll(address owner, address operator) external view returns (bool);", "highlightLines": [142]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/IERC721.sol", "line": 142, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "87d096e8f3c4", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/IERC721Receiver.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "781b23bb06df", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function onERC721Received(\n        address operator,\n        address from,\n        uint256 tokenId,\n        bytes calldata data\n    ) external returns (bytes4);", "highlightLines": [21]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/IERC721Receiver.sol", "line": 21, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "fc4425c8e6ab", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721Burnable.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "07acd4652e2b", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function burn(uint256 tokenId) public virtual {", "highlightLines": [21]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721Burnable.sol", "line": 21, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "1f43d6bf5d13", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function burn(uint256 tokenId) public virtual {", "highlightLines": [21]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721Burnable.sol", "line": 21, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "45ea020ed089", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function burn(uint256 tokenId) public virtual {", "highlightLines": [21]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721Burnable.sol", "line": 21, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "5e5ccc663f1b", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721Enumerable.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "f63c72566148", "fix": {"template": null, "available": false}, "title": "Potential mnemonic seed phrase detected - CRITICAL if real", "ruleId": "rules._shared.shared-mnemonic-phrase", "snippet": {"code": " * enumerability of all the token ids in the contract as well as all token ids owned by each", "highlightLines": [11]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721Enumerable.sol", "line": 11, "column": 10}, "severity": "high", "references": [], "description": ""}, {"id": "15e6ba36f799", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "abstract contract ERC721Enumerable is ERC721, IERC721Enumerable {", "highlightLines": [14]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721Enumerable.sol", "line": 14, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "fbbce2a23b98", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function supportsInterface(bytes4 interfaceId) public view virtual override(IERC165, ERC721) returns (bool) {\n        return interfaceId == type(IERC721Enumerable).interfaceId || super.supportsInterface(interfaceId);", "highlightLines": [30]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721Enumerable.sol", "line": 30, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "15b7eb77a491", "fix": {"template": null, "available": false}, "title": "View function reads state that may be stale during callback - read-only reentrancy risk", "ruleId": "rules.sol-read-only-reentrancy", "snippet": {"code": "    function tokenOfOwnerByIndex(address owner, uint256 index) public view virtual override returns (uint256) {\n        require(index < ERC721.balanceOf(owner), \"ERC721Enumerable: owner index out of bounds\");", "highlightLines": [37]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721Enumerable.sol", "line": 37, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs", "https://chainsecurity.com/curve-lp-oracle-manipulation-post-mortem/"], "description": ""}, {"id": "ec00e629fffd", "fix": {"template": null, "available": false}, "title": "View function reads state that may be stale during callback - read-only reentrancy risk", "ruleId": "rules.sol-read-only-reentrancy", "snippet": {"code": "    function tokenByIndex(uint256 index) public view virtual override returns (uint256) {\n        require(index < ERC721Enumerable.totalSupply(), \"ERC721Enumerable: global index out of bounds\");", "highlightLines": [52]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721Enumerable.sol", "line": 52, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs", "https://chainsecurity.com/curve-lp-oracle-manipulation-post-mortem/"], "description": ""}, {"id": "3a9bba3e1557", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function _beforeTokenTransfer(\n        address from,\n        address to,\n        uint256 tokenId\n    ) internal virtual override {", "highlightLines": [72]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721Enumerable.sol", "line": 72, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "e94506616039", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function _beforeTokenTransfer(\n        address from,\n        address to,\n        uint256 tokenId\n    ) internal virtual override {\n        super._beforeTokenTransfer(from, to, tokenId);\n\n        if (from == address(0)) {", "highlightLines": [72]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721Enumerable.sol", "line": 72, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "09f13bf5ccf3", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "        if (from == address(0)) {\n            _addTokenToAllTokensEnumeration(tokenId);\n        } else if (from != to) {\n            _removeTokenFromOwnerEnumeration(from, tokenId);\n        }", "highlightLines": [79]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721Enumerable.sol", "line": 79, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "ca89266da24e", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "        if (to == address(0)) {\n            _removeTokenFromAllTokensEnumeration(tokenId);\n        } else if (to != from) {\n            _addTokenToOwnerEnumeration(to, tokenId);\n        }", "highlightLines": [84]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721Enumerable.sol", "line": 84, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "6559b0e55e2c", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function _addTokenToOwnerEnumeration(address to, uint256 tokenId) private {", "highlightLines": [96]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721Enumerable.sol", "line": 96, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "7d0860ae2597", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 length = ERC721.balanceOf(to);", "highlightLines": [97]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721Enumerable.sol", "line": 97, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d311dea74eea", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 length = ERC721.balanceOf(to);\n        _ownedTokens[to][length] = tokenId;", "highlightLines": [97]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721Enumerable.sol", "line": 97, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "2eefc719d4e3", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        _ownedTokens[to][length] = tokenId;\n        _ownedTokensIndex[tokenId] = length;", "highlightLines": [98]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721Enumerable.sol", "line": 98, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "b09a1449ace5", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function _addTokenToAllTokensEnumeration(uint256 tokenId) private {", "highlightLines": [106]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721Enumerable.sol", "line": 106, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "edb4e5795fff", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function _removeTokenFromOwnerEnumeration(address from, uint256 tokenId) private {", "highlightLines": [119]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721Enumerable.sol", "line": 119, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "f47256d2f68d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 lastTokenIndex = ERC721.balanceOf(from) - 1;", "highlightLines": [122]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721Enumerable.sol", "line": 122, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "bd8ed5e68439", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 lastTokenIndex = ERC721.balanceOf(from) - 1;\n        uint256 tokenIndex = _ownedTokensIndex[tokenId];", "highlightLines": [123]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721Enumerable.sol", "line": 123, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "500cff92eb00", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 tokenIndex = _ownedTokensIndex[tokenId];", "highlightLines": [124]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721Enumerable.sol", "line": 124, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "1e944fea88c0", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 tokenIndex = _ownedTokensIndex[tokenId];\n\n        // When the token to delete is the last token, the swap operation is unnecessary\n        if (tokenIndex != lastTokenIndex) {\n            uint256 lastTokenId = _ownedTokens[from][lastTokenIndex];\n\n            _ownedTokens[from][tokenIndex] = lastTokenId; // Move the last token to the slot of the to-delete token\n            _ownedTokensIndex[lastTokenId] = tokenIndex; // Update the moved token's index\n        }", "highlightLines": [124]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721Enumerable.sol", "line": 124, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "6e0467e93293", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint256 lastTokenId = _ownedTokens[from][lastTokenIndex];", "highlightLines": [128]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721Enumerable.sol", "line": 128, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f720d3242f9a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            uint256 lastTokenId = _ownedTokens[from][lastTokenIndex];\n\n            _ownedTokens[from][tokenIndex] = lastTokenId; // Move the last token to the slot of the to-delete token", "highlightLines": [128]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721Enumerable.sol", "line": 128, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "5fcb41fceb94", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            _ownedTokens[from][tokenIndex] = lastTokenId; // Move the last token to the slot of the to-delete token\n            _ownedTokensIndex[lastTokenId] = tokenIndex; // Update the moved token's index", "highlightLines": [130]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721Enumerable.sol", "line": 130, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "d3f4705b8a43", "fix": {"template": null, "available": false}, "title": "Deleting mapping inside struct leaves nested data - use separate mapping deletion", "ruleId": "rules.sol-mapping-deletion", "snippet": {"code": "        delete _ownedTokensIndex[tokenId];", "highlightLines": [135]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721Enumerable.sol", "line": 135, "column": 9}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#deletion-on-mapping-containing-a-structure"], "description": ""}, {"id": "ab6b35e15491", "fix": {"template": null, "available": false}, "title": "delete array[i] leaves gap with zero value - use swap-and-pop pattern instead", "ruleId": "rules.sol-array-element-delete", "snippet": {"code": "        delete _ownedTokensIndex[tokenId];", "highlightLines": [135]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721Enumerable.sol", "line": 135, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/Array-deletion.sol"], "description": ""}, {"id": "b671f9567800", "fix": {"template": null, "available": false}, "title": "Deleting mapping inside struct leaves nested data - use separate mapping deletion", "ruleId": "rules.sol-mapping-deletion", "snippet": {"code": "        delete _ownedTokens[from][lastTokenIndex];", "highlightLines": [136]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721Enumerable.sol", "line": 136, "column": 9}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#deletion-on-mapping-containing-a-structure"], "description": ""}, {"id": "a423d5426e34", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function _removeTokenFromAllTokensEnumeration(uint256 tokenId) private {", "highlightLines": [144]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721Enumerable.sol", "line": 144, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "4baa89bbc773", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 lastTokenIndex = _allTokens.length - 1;", "highlightLines": [147]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721Enumerable.sol", "line": 147, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0b3059cb2fd9", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 lastTokenIndex = _allTokens.length - 1;\n        uint256 tokenIndex = _allTokensIndex[tokenId];", "highlightLines": [148]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721Enumerable.sol", "line": 148, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "a10695d08bc5", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 tokenIndex = _allTokensIndex[tokenId];", "highlightLines": [149]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721Enumerable.sol", "line": 149, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "1c5dc7a58868", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 tokenIndex = _allTokensIndex[tokenId];\n\n        // When the token to delete is the last token, the swap operation is unnecessary. However, since this occurs so\n        // rarely (when the last minted token is burnt) that we still do the swap here to avoid the gas cost of adding\n        // an 'if' statement (like in _removeTokenFromOwnerEnumeration)\n        uint256 lastTokenId = _allTokens[lastTokenIndex];", "highlightLines": [149]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721Enumerable.sol", "line": 149, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "2393f19c6c03", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 lastTokenId = _allTokens[lastTokenIndex];", "highlightLines": [154]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721Enumerable.sol", "line": 154, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "04144813a143", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 lastTokenId = _allTokens[lastTokenIndex];\n\n        _allTokens[tokenIndex] = lastTokenId; // Move the last token to the slot of the to-delete token", "highlightLines": [154]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721Enumerable.sol", "line": 154, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "2e842ea67893", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        _allTokens[tokenIndex] = lastTokenId; // Move the last token to the slot of the to-delete token\n        _allTokensIndex[lastTokenId] = tokenIndex; // Update the moved token's index", "highlightLines": [156]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721Enumerable.sol", "line": 156, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "79e7ae7d8487", "fix": {"template": null, "available": false}, "title": "Deleting mapping inside struct leaves nested data - use separate mapping deletion", "ruleId": "rules.sol-mapping-deletion", "snippet": {"code": "        delete _allTokensIndex[tokenId];", "highlightLines": [160]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721Enumerable.sol", "line": 160, "column": 9}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#deletion-on-mapping-containing-a-structure"], "description": ""}, {"id": "e1e076ba274a", "fix": {"template": null, "available": false}, "title": "delete array[i] leaves gap with zero value - use swap-and-pop pattern instead", "ruleId": "rules.sol-array-element-delete", "snippet": {"code": "        delete _allTokensIndex[tokenId];", "highlightLines": [160]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721Enumerable.sol", "line": 160, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/Array-deletion.sol"], "description": ""}, {"id": "5666bf3e329d", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721Pausable.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "dbcea36126b8", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function _beforeTokenTransfer(\n        address from,\n        address to,\n        uint256 tokenId\n    ) internal virtual override {", "highlightLines": [24]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721Pausable.sol", "line": 24, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "7740379dcbbf", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721Royalty.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "6315bdb91fef", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function _burn(uint256 tokenId) internal virtual override {", "highlightLines": [34]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721Royalty.sol", "line": 34, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "562e1fed87d1", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721URIStorage.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "a90791adb954", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function tokenURI(uint256 tokenId) public view virtual override returns (string memory) {", "highlightLines": [20]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721URIStorage.sol", "line": 20, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "c95c304dfc77", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function tokenURI(uint256 tokenId) public view virtual override returns (string memory) {\n        _requireMinted(tokenId);\n\n        string memory _tokenURI = _tokenURIs[tokenId];\n        string memory base = _baseURI();", "highlightLines": [20]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721URIStorage.sol", "line": 20, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "f68299912f58", "fix": {"template": null, "available": false}, "title": "Struct copied to memory from mapping - modifications won't persist to storage", "ruleId": "rules.sol-memory-struct-from-mapping", "snippet": {"code": "        string memory _tokenURI = _tokenURIs[tokenId];", "highlightLines": [23]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721URIStorage.sol", "line": 23, "column": 9}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/DataLocation.sol"], "description": ""}, {"id": "708304244fb6", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        string memory _tokenURI = _tokenURIs[tokenId];\n        string memory base = _baseURI();", "highlightLines": [23]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721URIStorage.sol", "line": 23, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d5ededf2f282", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "            return string(abi.encodePacked(base, _tokenURI));", "highlightLines": [32]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721URIStorage.sol", "line": 32, "column": 27}, "severity": "medium", "references": [], "description": ""}, {"id": "968ae01c1559", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function _burn(uint256 tokenId) internal virtual override {", "highlightLines": [55]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721URIStorage.sol", "line": 55, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "a964e952c633", "fix": {"template": null, "available": false}, "title": "Deleting mapping inside struct leaves nested data - use separate mapping deletion", "ruleId": "rules.sol-mapping-deletion", "snippet": {"code": "            delete _tokenURIs[tokenId];", "highlightLines": [59]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721URIStorage.sol", "line": 59, "column": 13}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#deletion-on-mapping-containing-a-structure"], "description": ""}, {"id": "d751b4458b9b", "fix": {"template": null, "available": false}, "title": "delete array[i] leaves gap with zero value - use swap-and-pop pattern instead", "ruleId": "rules.sol-array-element-delete", "snippet": {"code": "            delete _tokenURIs[tokenId];", "highlightLines": [59]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721URIStorage.sol", "line": 59, "column": 13}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/Array-deletion.sol"], "description": ""}, {"id": "717c76aa791f", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/IERC721Enumerable.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "41962d57cbbc", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function tokenOfOwnerByIndex(address owner, uint256 index) external view returns (uint256);", "highlightLines": [22]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/IERC721Enumerable.sol", "line": 22, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "61840519d47a", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/IERC721Metadata.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "6baf94ae9953", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/draft-ERC721Votes.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "f9c42bc815d3", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function _afterTokenTransfer(\n        address from,\n        address to,\n        uint256 tokenId\n    ) internal virtual override {", "highlightLines": [25]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/extensions/draft-ERC721Votes.sol", "line": 25, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "75933697f040", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/presets/ERC721PresetMinterPauserAutoId.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "62cd07195efa", "fix": {"template": null, "available": false}, "title": "Base constructor called multiple times through diamond inheritance - may initialize twice", "ruleId": "rules.sol-reused-constructor", "snippet": {"code": "contract ERC721PresetMinterPauserAutoId is\n    Context,\n    AccessControlEnumerable,\n    ERC721Enumerable,", "highlightLines": [31]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/presets/ERC721PresetMinterPauserAutoId.sol", "line": 31, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#reused-base-constructor"], "description": ""}, {"id": "23077ed26c23", "fix": {"template": null, "available": false}, "title": "SWC-125: Multiple inheritance may cause incorrect function resolution - check C3 linearization", "ruleId": "rules.sol-swc-125-inheritance-order", "snippet": {"code": "contract ERC721PresetMinterPauserAutoId is\n    Context,\n    AccessControlEnumerable,\n    ERC721Enumerable,", "highlightLines": [31]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/presets/ERC721PresetMinterPauserAutoId.sol", "line": 31, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-125"], "description": ""}, {"id": "992a155f2736", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract ERC721PresetMinterPauserAutoId is\n    Context,\n    AccessControlEnumerable,\n    ERC721Enumerable,\n    ERC721Burnable,\n    ERC721Pausable\n{\n    using Counters for Counters.Counter;\n\n    bytes32 public constant MINTER_ROLE = keccak256(\"MINTER_ROLE\");\n    bytes32 public constant PAUSER_ROLE = keccak256(\"PAUSER_ROLE\");\n\n    Counters.Counter private _tokenIdTracker;\n\n    string private _baseTokenURI;", "highlightLines": [31]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/presets/ERC721PresetMinterPauserAutoId.sol", "line": 31, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "df649bdc241b", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(\n        string memory name,\n        string memory symbol,\n        string memory baseTokenURI\n    ) ERC721(name, symbol) {\n        _baseTokenURI = baseTokenURI;\n\n        _setupRole(DEFAULT_ADMIN_ROLE, _msgSender());\n\n        _setupRole(MINTER_ROLE, _msgSender());\n        _setupRole(PAUSER_ROLE, _msgSender());\n    }", "highlightLines": [54]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/presets/ERC721PresetMinterPauserAutoId.sol", "line": 54, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "7068143a5841", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function mint(address to) public virtual {", "highlightLines": [82]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/presets/ERC721PresetMinterPauserAutoId.sol", "line": 82, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "54ebd98473ca", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function mint(address to) public virtual {", "highlightLines": [82]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/presets/ERC721PresetMinterPauserAutoId.sol", "line": 82, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "ad8a47b2293e", "fix": {"template": null, "available": false}, "title": "NFT mint without supply check - potential overflow in tokenId", "ruleId": "rules.sol-nft-overflow-mint", "snippet": {"code": "        _mint(to, _tokenIdTracker.current());", "highlightLines": [87]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/presets/ERC721PresetMinterPauserAutoId.sol", "line": 87, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "bd3c8996bc6b", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function pause() public virtual {", "highlightLines": [100]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/presets/ERC721PresetMinterPauserAutoId.sol", "line": 100, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "7fa3d822a70e", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function unpause() public virtual {", "highlightLines": [114]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/presets/ERC721PresetMinterPauserAutoId.sol", "line": 114, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "7a5d0b525373", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function _beforeTokenTransfer(\n        address from,\n        address to,\n        uint256 tokenId\n    ) internal virtual override(ERC721, ERC721Enumerable, ERC721Pausable) {", "highlightLines": [119]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/presets/ERC721PresetMinterPauserAutoId.sol", "line": 119, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "929dfb9289d6", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "    ) internal virtual override(ERC721, ERC721Enumerable, ERC721Pausable) {", "highlightLines": [123]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/presets/ERC721PresetMinterPauserAutoId.sol", "line": 123, "column": 33}, "severity": "info", "references": [], "description": ""}, {"id": "3c08a2c96cdc", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "        override(AccessControlEnumerable, ERC721, ERC721Enumerable)", "highlightLines": [134]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/presets/ERC721PresetMinterPauserAutoId.sol", "line": 134, "column": 43}, "severity": "info", "references": [], "description": ""}, {"id": "6564d7696709", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/utils/ERC721Holder.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "9daf4bc39773", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "contract ERC721Holder is IERC721Receiver {", "highlightLines": [14]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/utils/ERC721Holder.sol", "line": 14, "column": 1}, "severity": "medium", "references": [], "description": ""}, {"id": "ac4845d0353e", "fix": {"template": null, "available": false}, "title": "Token callback function without reentrancy protection - ERC777/721/1155 callbacks can reenter", "ruleId": "rules.sol-callback-without-reentrancy-guard", "snippet": {"code": "    function onERC721Received(\n        address,\n        address,\n        uint256,\n        bytes memory\n    ) public virtual override returns (bytes4) {", "highlightLines": [20]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC721/utils/ERC721Holder.sol", "line": 20, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "c8543ff3dce1", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/ERC777.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "2ff2c26f102a", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "contract ERC777 is Context, IERC777, IERC20 {", "highlightLines": [29]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/ERC777.sol", "line": 29, "column": 1}, "severity": "medium", "references": [], "description": ""}, {"id": "427e7159d723", "fix": {"template": null, "available": false}, "title": "Base constructor called multiple times through diamond inheritance - may initialize twice", "ruleId": "rules.sol-reused-constructor", "snippet": {"code": "contract ERC777 is Context, IERC777, IERC20 {", "highlightLines": [29]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/ERC777.sol", "line": 29, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#reused-base-constructor"], "description": ""}, {"id": "7acab1ddebe3", "fix": {"template": null, "available": false}, "title": "SWC-125: Multiple inheritance may cause incorrect function resolution - check C3 linearization", "ruleId": "rules.sol-swc-125-inheritance-order", "snippet": {"code": "contract ERC777 is Context, IERC777, IERC20 {", "highlightLines": [29]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/ERC777.sol", "line": 29, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-125"], "description": ""}, {"id": "759737c2d735", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract ERC777 is Context, IERC777, IERC20 {\n    using Address for address;\n\n    IERC1820Registry internal constant _ERC1820_REGISTRY = IERC1820Registry(0x1820a4B7618BdE71Dce8cdc73aAB6C95905faD24);\n\n    mapping(address => uint256) private _balances;\n\n    uint256 private _totalSupply;\n\n    string private _name;\n    string private _symbol;\n\n    bytes32 private constant _TOKENS_SENDER_INTERFACE_HASH = keccak256(\"ERC777TokensSender\");\n    bytes32 private constant _TOKENS_RECIPIENT_INTERFACE_HASH = keccak256(\"ERC777TokensRecipient\");\n\n    // This isn't ever read from - it's only used to respond to the defaultOperators query.\n    address[] private _defaultOperatorsArray;\n\n    // Immutable, but accounts may revoke them (tracked in __revokedDefaultOperators).\n    mapping(address => bool) private _defaultOperators;\n\n    // For each account, a mapping of its operators and revoked default operators.\n    mapping(address => mapping(address => bool)) private _operators;\n    mapping(address => mapping(address => bool)) private _revokedDefaultOperators;\n\n    // ERC20-allowances\n    mapping(address => mapping(address => uint256)) private _allowances;\n\n    /**\n     * @dev `defaultOperators` may be an empty array.\n     */\n    constructor(\n        string memory name_,\n        string memory symbol_,\n        address[] memory defaultOperators_\n    ) {\n        _name = name_;\n        _symbol = symbol_;\n\n        _defaultOperatorsArray = defaultOperators_;\n        for (uint256 i = 0; i < defaultOperators_.length; i++) {", "highlightLines": [29]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/ERC777.sol", "line": 29, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "cf3e5430cd4e", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(\n        string memory name_,\n        string memory symbol_,\n        address[] memory defaultOperators_\n    ) {\n        _name = name_;\n        _symbol = symbol_;\n\n        _defaultOperatorsArray = defaultOperators_;\n        for (uint256 i = 0; i < defaultOperators_.length; i++) {\n            _defaultOperators[defaultOperators_[i]] = true;\n        }\n\n        // register interfaces\n        _ERC1820_REGISTRY.setInterfaceImplementer(address(this), keccak256(\"ERC777Token\"), address(this));\n        _ERC1820_REGISTRY.setInterfaceImplementer(address(this), keccak256(\"ERC20Token\"), address(this));\n    }", "highlightLines": [60]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/ERC777.sol", "line": 60, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "93b308583d2a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        _name = name_;\n        _symbol = symbol_;", "highlightLines": [65]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/ERC777.sol", "line": 65, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d38cfd47684f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        _symbol = symbol_;\n\n        _defaultOperatorsArray = defaultOperators_;", "highlightLines": [66]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/ERC777.sol", "line": 66, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "241d401035a8", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        _defaultOperatorsArray = defaultOperators_;\n        for (uint256 i = 0; i < defaultOperators_.length; i++) {\n            _defaultOperators[defaultOperators_[i]] = true;\n        }", "highlightLines": [68]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/ERC777.sol", "line": 68, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d885237406d9", "fix": {"template": null, "available": false}, "title": "ERC1820 registry hook registration - can enable reentrancy via token hooks", "ruleId": "rules.sol-erc1820-registry-hook", "snippet": {"code": "        _ERC1820_REGISTRY.setInterfaceImplementer(address(this), keccak256(\"ERC777Token\"), address(this));", "highlightLines": [74]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/ERC777.sol", "line": 74, "column": 27}, "severity": "medium", "references": [], "description": ""}, {"id": "32f0d188d170", "fix": {"template": null, "available": false}, "title": "ERC1820 registry hook registration - can enable reentrancy via token hooks", "ruleId": "rules.sol-erc1820-registry-hook", "snippet": {"code": "        _ERC1820_REGISTRY.setInterfaceImplementer(address(this), keccak256(\"ERC20Token\"), address(this));", "highlightLines": [75]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/ERC777.sol", "line": 75, "column": 27}, "severity": "medium", "references": [], "description": ""}, {"id": "e4a09bfbf164", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function transfer(address recipient, uint256 amount) public virtual override returns (bool) {", "highlightLines": [146]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/ERC777.sol", "line": 146, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "2f4eefd700c4", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without msg.data.length validation - vulnerable to short address attack padding", "ruleId": "rules.sol-short-address-no-payload-check", "snippet": {"code": "    function transfer(address recipient, uint256 amount) public virtual override returns (bool) {", "highlightLines": [146]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/ERC777.sol", "line": 146, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address", "https://vessenes.com/the-erc20-short-address-attack-explained/"], "description": ""}, {"id": "bcf3969f44c3", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function burn(uint256 amount, bytes memory data) public virtual override {", "highlightLines": [156]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/ERC777.sol", "line": 156, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "e9feb6bb9464", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function burn(uint256 amount, bytes memory data) public virtual override {", "highlightLines": [156]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/ERC777.sol", "line": 156, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "24f1c60bd21a", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function isOperatorFor(address operator, address tokenHolder) public view virtual override returns (bool) {\n        return\n            operator == tokenHolder ||", "highlightLines": [163]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/ERC777.sol", "line": 163, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "cb0b4c9df227", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function approve(address spender, uint256 value) public virtual override returns (bool) {", "highlightLines": [257]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/ERC777.sol", "line": 257, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "133de8013e31", "fix": {"template": null, "available": false}, "title": "Using approve() without increaseAllowance/decreaseAllowance - vulnerable to front-running race condition", "ruleId": "rules.sol-erc20-approve-frontrun", "snippet": {"code": "    function approve(address spender, uint256 value) public virtual override returns (bool) {\n        address holder = _msgSender();\n        _approve(holder, spender, value);\n        return true;\n    }", "highlightLines": [257]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/ERC777.sol", "line": 257, "column": 5}, "severity": "info", "references": ["https://docs.google.com/document/d/1YLPtQxZu1UAvO9cZ1O2RPXBbT0mooh4DYKjA_jp-RLM"], "description": ""}, {"id": "0410a2c26e07", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address holder = _msgSender();", "highlightLines": [258]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/ERC777.sol", "line": 258, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "9c1dd0e1e924", "fix": {"template": null, "available": false}, "title": "ERC20 transferFrom without payload size validation - consider adding onlyPayloadSize modifier", "ruleId": "rules.sol-erc20-missing-payload-modifier", "snippet": {"code": "    function transferFrom(\n        address holder,\n        address recipient,\n        uint256 amount\n    ) public virtual override returns (bool) {", "highlightLines": [275]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/ERC777.sol", "line": 275, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address"], "description": ""}, {"id": "fc9eab21a8eb", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function transferFrom(\n        address holder,\n        address recipient,\n        uint256 amount\n    ) public virtual override returns (bool) {", "highlightLines": [275]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/ERC777.sol", "line": 275, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "3186b9d65516", "fix": {"template": null, "available": false}, "title": "NFT transfer without approval/ownership check - add _isApprovedOrOwner validation", "ruleId": "rules.sol-nft-transfer-no-approval-check", "snippet": {"code": "    function transferFrom(\n        address holder,\n        address recipient,\n        uint256 amount\n    ) public virtual override returns (bool) {", "highlightLines": [275]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/ERC777.sol", "line": 275, "column": 5}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/NFT-transfer.sol"], "description": ""}, {"id": "e222fd8f865d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address spender = _msgSender();", "highlightLines": [280]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/ERC777.sol", "line": 280, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c9b86e39537a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        address operator = _msgSender();", "highlightLines": [339]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/ERC777.sol", "line": 339, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "1745e37d6d75", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        address operator = _msgSender();", "highlightLines": [373]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/ERC777.sol", "line": 373, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "db334fd0bce4", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        address operator = _msgSender();", "highlightLines": [397]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/ERC777.sol", "line": 397, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "03d37287d8c1", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address operator = _msgSender();\n\n        _callTokensToSend(operator, from, address(0), amount, data, operatorData);\n\n        _beforeTokenTransfer(operator, from, address(0), amount);\n\n        // Update state variables\n        uint256 fromBalance = _balances[from];", "highlightLines": [398]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/ERC777.sol", "line": 398, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "9f75d0215eb4", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 fromBalance = _balances[from];", "highlightLines": [405]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/ERC777.sol", "line": 405, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b6aad0869eb4", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 fromBalance = _balances[from];\n        require(fromBalance >= amount, \"ERC777: burn amount exceeds balance\");\n        unchecked {\n            _balances[from] = fromBalance - amount;\n        }", "highlightLines": [405]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/ERC777.sol", "line": 405, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e9a3902a34f1", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "            _balances[from] = fromBalance - amount;", "highlightLines": [408]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/ERC777.sol", "line": 408, "column": 31}, "severity": "medium", "references": [], "description": ""}, {"id": "30dc05f7b58e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 fromBalance = _balances[from];", "highlightLines": [425]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/ERC777.sol", "line": 425, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ad4bb999bd7b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 fromBalance = _balances[from];\n        require(fromBalance >= amount, \"ERC777: transfer amount exceeds balance\");\n        unchecked {\n            _balances[from] = fromBalance - amount;\n        }", "highlightLines": [426]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/ERC777.sol", "line": 426, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "bd97db1e4306", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "            _balances[from] = fromBalance - amount;", "highlightLines": [429]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/ERC777.sol", "line": 429, "column": 31}, "severity": "medium", "references": [], "description": ""}, {"id": "e22b760e46fb", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address implementer = _ERC1820_REGISTRY.getInterfaceImplementer(from, _TOKENS_SENDER_INTERFACE_HASH);", "highlightLines": [471]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/ERC777.sol", "line": 471, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "07e3c508dcef", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address implementer = _ERC1820_REGISTRY.getInterfaceImplementer(to, _TOKENS_RECIPIENT_INTERFACE_HASH);", "highlightLines": [497]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/ERC777.sol", "line": 497, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "552c741fabe0", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 currentAllowance = allowance(owner, spender);", "highlightLines": [518]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/ERC777.sol", "line": 518, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b01fc33fdba2", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "                _approve(owner, spender, currentAllowance - amount);", "highlightLines": [522]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/ERC777.sol", "line": 522, "column": 42}, "severity": "medium", "references": [], "description": ""}, {"id": "a5a1d303c46f", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/IERC777.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "7a036092a932", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Minted(address indexed operator, address indexed to, uint256 amount, bytes data, bytes operatorData);", "highlightLines": [21]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/IERC777.sol", "line": 21, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "e38388ae5d3c", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Burned(address indexed operator, address indexed from, uint256 amount, bytes data, bytes operatorData);", "highlightLines": [28]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/IERC777.sol", "line": 28, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "8ca326be8253", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event AuthorizedOperator(address indexed operator, address indexed tokenHolder);", "highlightLines": [33]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/IERC777.sol", "line": 33, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "16788c9722bc", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event RevokedOperator(address indexed operator, address indexed tokenHolder);", "highlightLines": [38]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/IERC777.sol", "line": 38, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "cbb1e17ebef6", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function balanceOf(address owner) external view returns (uint256);", "highlightLines": [68]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/IERC777.sol", "line": 68, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "2e8283414923", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function send(\n        address recipient,\n        uint256 amount,\n        bytes calldata data\n    ) external;", "highlightLines": [86]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/IERC777.sol", "line": 86, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "38ff91a67723", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function burn(uint256 amount, bytes calldata data) external;", "highlightLines": [105]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/IERC777.sol", "line": 105, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "b0c84fb8c83c", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function burn(uint256 amount, bytes calldata data) external;\n\n    /**\n     * @dev Returns true if an account is an operator of `tokenHolder`.\n     * Operators can send and burn tokens on behalf of their owners. All\n     * accounts are their own operator.\n     *\n     * See {operatorSend} and {operatorBurn}.", "highlightLines": [105]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/IERC777.sol", "line": 105, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "b47a7c57a2e0", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function isOperatorFor(address operator, address tokenHolder) external view returns (bool);", "highlightLines": [114]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/IERC777.sol", "line": 114, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "d984a2204713", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function authorizeOperator(address operator) external;", "highlightLines": [127]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/IERC777.sol", "line": 127, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "89fe4d3ab420", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function revokeOperator(address operator) external;", "highlightLines": [140]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/IERC777.sol", "line": 140, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "5497807f639d", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function operatorSend(\n        address sender,\n        address recipient,\n        uint256 amount,\n        bytes calldata data,\n        bytes calldata operatorData\n    ) external;", "highlightLines": [171]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/IERC777.sol", "line": 171, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "176aa3a5f1e5", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function operatorBurn(\n        address account,\n        uint256 amount,\n        bytes calldata data,\n        bytes calldata operatorData\n    ) external;", "highlightLines": [194]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/IERC777.sol", "line": 194, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "d2d16260808a", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event Sent(\n        address indexed operator,\n        address indexed from,\n        address indexed to,\n        uint256 amount,\n        bytes data,\n        bytes operatorData\n    );", "highlightLines": [201]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/IERC777.sol", "line": 201, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "1504ffc4454d", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Sent(\n        address indexed operator,\n        address indexed from,\n        address indexed to,\n        uint256 amount,\n        bytes data,\n        bytes operatorData\n    );", "highlightLines": [201]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/IERC777.sol", "line": 201, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "59d7965d49b1", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/IERC777Recipient.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "7f8da1ed831e", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function tokensReceived(\n        address operator,\n        address from,\n        address to,\n        uint256 amount,\n        bytes calldata userData,\n        bytes calldata operatorData\n    ) external;", "highlightLines": [27]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/IERC777Recipient.sol", "line": 27, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "c469cca6a5a8", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/IERC777Sender.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "7e24cc0c29c2", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function tokensToSend(\n        address operator,\n        address from,\n        address to,\n        uint256 amount,\n        bytes calldata userData,\n        bytes calldata operatorData\n    ) external;", "highlightLines": [27]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/IERC777Sender.sol", "line": 27, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "1503200f456e", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/presets/ERC777PresetFixedSupply.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "5d4509e4db63", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(\n        string memory name,\n        string memory symbol,\n        address[] memory defaultOperators,\n        uint256 initialSupply,\n        address owner\n    ) ERC777(name, symbol, defaultOperators) {\n        _mint(owner, initialSupply, \"\", \"\");\n    }", "highlightLines": [21]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/ERC777/presets/ERC777PresetFixedSupply.sol", "line": 21, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "b32e8ba12919", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/common/ERC2981.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "642a8f53979d", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "abstract contract ERC2981 is IERC2981, ERC165 {", "highlightLines": [24]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/common/ERC2981.sol", "line": 24, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "74067909bfc5", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "abstract contract ERC2981 is IERC2981, ERC165 {\n    struct RoyaltyInfo {\n        address receiver;\n        uint96 royaltyFraction;", "highlightLines": [24]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/common/ERC2981.sol", "line": 24, "column": 10}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "9cc2e834722e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address receiver;", "highlightLines": [26]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/common/ERC2981.sol", "line": 26, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "1cef3a0ac516", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint96 royaltyFraction;", "highlightLines": [27]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/common/ERC2981.sol", "line": 27, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a469700cd8f1", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function supportsInterface(bytes4 interfaceId) public view virtual override(IERC165, ERC165) returns (bool) {\n        return interfaceId == type(IERC2981).interfaceId || super.supportsInterface(interfaceId);", "highlightLines": [36]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/common/ERC2981.sol", "line": 36, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "d758382070f5", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function royaltyInfo(uint256 _tokenId, uint256 _salePrice) public view virtual override returns (address, uint256) {", "highlightLines": [43]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/common/ERC2981.sol", "line": 43, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "03a749b955cc", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function royaltyInfo(uint256 _tokenId, uint256 _salePrice) public view virtual override returns (address, uint256) {\n        RoyaltyInfo memory royalty = _tokenRoyaltyInfo[_tokenId];\n\n        if (royalty.receiver == address(0)) {\n            royalty = _defaultRoyaltyInfo;", "highlightLines": [43]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/common/ERC2981.sol", "line": 43, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "ae08c6094808", "fix": {"template": null, "available": false}, "title": "Struct copied to memory from mapping - modifications won't persist to storage", "ruleId": "rules.sol-memory-struct-from-mapping", "snippet": {"code": "        RoyaltyInfo memory royalty = _tokenRoyaltyInfo[_tokenId];", "highlightLines": [44]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/common/ERC2981.sol", "line": 44, "column": 9}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/DataLocation.sol"], "description": ""}, {"id": "019cc1e71218", "fix": {"template": null, "available": false}, "title": "Struct copied to memory then modified - changes lost, use storage reference", "ruleId": "rules.sol-data-location-memory-update", "snippet": {"code": "        RoyaltyInfo memory royalty = _tokenRoyaltyInfo[_tokenId];\n\n        if (royalty.receiver == address(0)) {", "highlightLines": [44]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/common/ERC2981.sol", "line": 44, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/DataLocation.sol"], "description": ""}, {"id": "223ac5259ce2", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        RoyaltyInfo memory royalty = _tokenRoyaltyInfo[_tokenId];\n\n        if (royalty.receiver == address(0)) {\n            royalty = _defaultRoyaltyInfo;\n        }", "highlightLines": [44]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/common/ERC2981.sol", "line": 44, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "382c53e292fe", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 royaltyAmount = (_salePrice * royalty.royaltyFraction) / _feeDenominator();", "highlightLines": [49]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/common/ERC2981.sol", "line": 49, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e1eefb6df924", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function _setTokenRoyalty(\n        uint256 tokenId,\n        address receiver,\n        uint96 feeNumerator\n    ) internal virtual {", "highlightLines": [94]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/common/ERC2981.sol", "line": 94, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "a1c45650e83e", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function _resetTokenRoyalty(uint256 tokenId) internal virtual {", "highlightLines": [108]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/common/ERC2981.sol", "line": 108, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "d28fbfff7e8d", "fix": {"template": null, "available": false}, "title": "Deleting mapping inside struct leaves nested data - use separate mapping deletion", "ruleId": "rules.sol-mapping-deletion", "snippet": {"code": "        delete _tokenRoyaltyInfo[tokenId];", "highlightLines": [109]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/common/ERC2981.sol", "line": 109, "column": 9}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#deletion-on-mapping-containing-a-structure"], "description": ""}, {"id": "3a56126d1dec", "fix": {"template": null, "available": false}, "title": "delete array[i] leaves gap with zero value - use swap-and-pop pattern instead", "ruleId": "rules.sol-array-element-delete", "snippet": {"code": "        delete _tokenRoyaltyInfo[tokenId];", "highlightLines": [109]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/token/common/ERC2981.sol", "line": 109, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/Array-deletion.sol"], "description": ""}, {"id": "19b43ed22df2", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.1;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Address.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "ede67a21fcd3", "fix": {"template": null, "available": false}, "title": "isContract check can be bypassed by calling from constructor - extcodesize is 0 during construction", "ruleId": "rules.sol-ethernaut-iscontract-bypass", "snippet": {"code": "        return account.code.length > 0;", "highlightLines": [41]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Address.sol", "line": 41, "column": 16}, "severity": "high", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2943"], "description": ""}, {"id": "268cc4e8cbf3", "fix": {"template": null, "available": false}, "title": "ETH balance check without accounting for selfdestruct donations - can be manipulated", "ruleId": "rules.sol-eth-balance-accounting", "snippet": {"code": "        require(address(this).balance >= amount, \"Address: insufficient balance\");", "highlightLines": [61]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Address.sol", "line": 61, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "65fe630ab8c8", "fix": {"template": null, "available": false}, "title": "Low-level call without checking return value - silent failure possible", "ruleId": "rules.sol-unchecked-call-return", "snippet": {"code": "        (bool success, ) = recipient.call{value: amount}(\"\");", "highlightLines": [63]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Address.sol", "line": 63, "column": 37}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-104/", "https://blocksecteam.medium.com/li-fi-attack"], "description": ""}, {"id": "1e4a1225d0ae", "fix": {"template": null, "available": false}, "title": "State change after external call - potential reentrancy vulnerability", "ruleId": "rules.sol-external-call-state-change", "snippet": {"code": "        (bool success, ) = recipient.call{value: amount}(\"\");\n        require(success, \"Address: unable to send value, recipient may have reverted\");\n    }\n\n    /**\n     * @dev Performs a Solidity function call using a low level `call`. A\n     * plain `call` is an unsafe replacement for a function call: use this\n     * function instead.\n     *\n     * If `target` reverts with a revert reason, it is bubbled up by this\n     * function (like regular Solidity function calls).\n     *\n     * Returns the raw returned data. To convert to the expected return value,\n     * use https://solidity.readthedocs.io/en/latest/units-and-global-variables.html?highlight=abi.decode#abi-encoding-and-decoding-functions[`abi.decode`].", "highlightLines": [63]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Address.sol", "line": 63, "column": 37}, "severity": "high", "references": ["https://consensys.github.io/smart-contract-best-practices/attacks/reentrancy/"], "description": ""}, {"id": "ef985eee9099", "fix": {"template": null, "available": false}, "title": "ETH balance check without accounting for selfdestruct donations - can be manipulated", "ruleId": "rules.sol-eth-balance-accounting", "snippet": {"code": "        require(address(this).balance >= value, \"Address: insufficient balance for call\");", "highlightLines": [134]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Address.sol", "line": 134, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "36367f4f0f8a", "fix": {"template": null, "available": false}, "title": "External call result copied to memory - malicious contract can return huge data (return bomb)", "ruleId": "rules.sol-return-bomb", "snippet": {"code": "        (bool success, bytes memory returndata) = target.call{value: value}(data);", "highlightLines": [135]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Address.sol", "line": 135, "column": 9}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#return-bomb"], "description": ""}, {"id": "0213a098f24b", "fix": {"template": null, "available": false}, "title": "Call success variable declared but never checked - funds may be lost", "ruleId": "rules.sol-call-success-not-required", "snippet": {"code": "        (bool success, bytes memory returndata) = target.call{value: value}(data);", "highlightLines": [135]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Address.sol", "line": 135, "column": 9}, "severity": "high", "references": [], "description": ""}, {"id": "b7c407940cf4", "fix": {"template": null, "available": false}, "title": "Low-level call without checking return value - silent failure possible", "ruleId": "rules.sol-unchecked-call-return", "snippet": {"code": "        (bool success, bytes memory returndata) = target.call{value: value}(data);", "highlightLines": [135]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Address.sol", "line": 135, "column": 57}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-104/", "https://blocksecteam.medium.com/li-fi-attack"], "description": ""}, {"id": "47c1be13d85a", "fix": {"template": null, "available": false}, "title": "State change after external call - potential reentrancy vulnerability", "ruleId": "rules.sol-external-call-state-change", "snippet": {"code": "        (bool success, bytes memory returndata) = target.call{value: value}(data);\n        return verifyCallResultFromTarget(target, success, returndata, errorMessage);\n    }\n\n    /**\n     * @dev Same as {xref-Address-functionCall-address-bytes-}[`functionCall`],\n     * but performing a static call.\n     *\n     * _Available since v3.3._\n     */\n    function functionStaticCall(address target, bytes memory data) internal view returns (bytes memory) {\n        return functionStaticCall(target, data, \"Address: low-level static call failed\");\n    }\n\n    /**\n     * @dev Same as {xref-Address-functionCall-address-bytes-string-}[`functionCall`],\n     * but performing a static call.\n     *\n     * _Available since v3.3._\n     */\n    function functionStaticCall(\n        address target,\n        bytes memory data,\n        string memory errorMessage\n    ) internal view returns (bytes memory) {\n        (bool success, bytes memory returndata) = target.staticcall(data);\n        return verifyCallResultFromTarget(target, success, returndata, errorMessage);\n    }\n\n    /**\n     * @dev Same as {xref-Address-functionCall-address-bytes-}[`functionCall`],\n     * but performing a delegate call.\n     *\n     * _Available since v3.4._\n     */\n    function functionDelegateCall(address target, bytes memory data) internal returns (bytes memory) {\n        return functionDelegateCall(target, data, \"Address: low-level delegate call failed\");\n    }\n\n    /**\n     * @dev Same as {xref-Address-functionCall-address-bytes-string-}[`functionCall`],\n     * but performing a delegate call.\n     *\n     * _Available since v3.4._\n     */\n    function functionDelegateCall(\n        address target,\n        bytes memory data,\n        string memory errorMessage\n    ) internal returns (bytes memory) {\n        (bool success, bytes memory returndata) = target.delegatecall(data);\n        return verifyCallResultFromTarget(target, success, returndata, errorMessage);\n    }\n\n    /**\n     * @dev Tool to verify that a low level call to smart-contract was successful, and revert (either by bubbling\n     * the revert reason or using the provided one) in case of unsuccessful call or if target was not a contract.\n     *\n     * _Available since v4.8._\n     */\n    function verifyCallResultFromTarget(\n        address target,\n        bool success,\n        bytes memory returndata,\n        string memory errorMessage\n    ) internal view returns (bytes memory) {\n        if (success) {\n            if (returndata.length == 0) {", "highlightLines": [135]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Address.sol", "line": 135, "column": 57}, "severity": "high", "references": ["https://consensys.github.io/smart-contract-best-practices/attacks/reentrancy/"], "description": ""}, {"id": "319a624ab54f", "fix": {"template": null, "available": false}, "title": "External call result copied to memory - malicious contract can return huge data (return bomb)", "ruleId": "rules.sol-return-bomb", "snippet": {"code": "        (bool success, bytes memory returndata) = target.staticcall(data);", "highlightLines": [160]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Address.sol", "line": 160, "column": 9}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#return-bomb"], "description": ""}, {"id": "9905c8d23d11", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "        (bool success, bytes memory returndata) = target.staticcall(data);", "highlightLines": [160]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Address.sol", "line": 160, "column": 51}, "severity": "medium", "references": [], "description": ""}, {"id": "f52d138162ef", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "        (bool success, bytes memory returndata) = target.delegatecall(data);", "highlightLines": [185]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Address.sol", "line": 185, "column": 51}, "severity": "medium", "references": [], "description": ""}, {"id": "b181bafeae6c", "fix": {"template": null, "available": false}, "title": "Delegatecall with user-controlled data - storage slot collision possible", "ruleId": "rules.sol-arbitrary-delegatecall-data", "snippet": {"code": "        (bool success, bytes memory returndata) = target.delegatecall(data);", "highlightLines": [185]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Address.sol", "line": 185, "column": 57}, "severity": "high", "references": [], "description": ""}, {"id": "55eaa39bd77c", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "            if (returndata.length == 0) {\n                // only check isContract if the call was successful and the return data is empty\n                // otherwise we already know that it was a contract\n                require(isContract(target), \"Address: call to non-contract\");\n            }", "highlightLines": [202]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Address.sol", "line": 202, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "51601246fcec", "fix": {"template": null, "available": false}, "title": "View/pure function uses assembly - may modify state unexpectedly", "ruleId": "rules.sol-constant-function-assembly", "snippet": {"code": "    function _revert(bytes memory returndata, string memory errorMessage) private pure {\n        // Look for revert reason and bubble it up if present\n        if (returndata.length > 0) {\n            // The easiest way to bubble the revert reason is using memory via assembly\n            /// @solidity memory-safe-assembly\n            assembly {", "highlightLines": [231]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Address.sol", "line": 231, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-using-assembly-code"], "description": ""}, {"id": "39d2630020d6", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "            assembly {", "highlightLines": [236]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Address.sol", "line": 236, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "f0d368920425", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Arrays.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "3023155652a7", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 low = 0;", "highlightLines": [25]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Arrays.sol", "line": 25, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7f842aa2a394", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 low = 0;\n        uint256 high = array.length;", "highlightLines": [26]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Arrays.sol", "line": 26, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "0ee72bab76ab", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 high = array.length;", "highlightLines": [27]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Arrays.sol", "line": 27, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e18cb9855462", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 high = array.length;\n\n        while (low < high) {\n            uint256 mid = Math.average(low, high);\n\n            // Note that mid will always be strictly less than high (i.e. it will be a valid array index)\n            // because Math.average rounds down (it does integer division with truncation).\n            if (array[mid] > element) {\n                high = mid;\n            } else {\n                low = mid + 1;\n            }\n        }", "highlightLines": [27]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Arrays.sol", "line": 27, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "30a94207beac", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint256 mid = Math.average(low, high);", "highlightLines": [30]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Arrays.sol", "line": 30, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0d5d83d112fc", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            uint256 mid = Math.average(low, high);\n\n            // Note that mid will always be strictly less than high (i.e. it will be a valid array index)\n            // because Math.average rounds down (it does integer division with truncation).\n            if (array[mid] > element) {\n                high = mid;\n            } else {\n                low = mid + 1;\n            }", "highlightLines": [30]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Arrays.sol", "line": 30, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "c1d5d66a3a41", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Base64.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "98848be491a0", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function encode(bytes memory data) internal pure returns (string memory) {\n        /**\n         * Inspired by Brecht Devos (Brechtpd) implementation - MIT licence\n         * https://github.com/Brechtpd/base64/blob/e78d9fd951e7b0977ddca77d92dc85183770daf4/base64.sol\n         */\n        if (data.length == 0) return \"\";\n\n        // Loads the table into memory\n        string memory table = _TABLE;\n\n        // Encoding takes 3 bytes chunks of binary data from `bytes` data parameter\n        // and split into 4 numbers of 6 bits.\n        // The final Base64 length should be `bytes` data length multiplied by 4/3 rounded up\n        // - `data.length + 2`  -> Round up\n        // - `/ 3`              -> Number of 3-bytes chunks\n        // - `4 *`              -> 4 characters for each chunk\n        string memory result = new string(4 * ((data.length + 2) / 3));", "highlightLines": [20]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Base64.sol", "line": 20, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "b8304316a48d", "fix": {"template": null, "available": false}, "title": "View/pure function uses assembly - may modify state unexpectedly", "ruleId": "rules.sol-constant-function-assembly", "snippet": {"code": "    function encode(bytes memory data) internal pure returns (string memory) {\n        /**\n         * Inspired by Brecht Devos (Brechtpd) implementation - MIT licence\n         * https://github.com/Brechtpd/base64/blob/e78d9fd951e7b0977ddca77d92dc85183770daf4/base64.sol\n         */\n        if (data.length == 0) return \"\";\n\n        // Loads the table into memory\n        string memory table = _TABLE;\n\n        // Encoding takes 3 bytes chunks of binary data from `bytes` data parameter\n        // and split into 4 numbers of 6 bits.\n        // The final Base64 length should be `bytes` data length multiplied by 4/3 rounded up\n        // - `data.length + 2`  -> Round up\n        // - `/ 3`              -> Number of 3-bytes chunks\n        // - `4 *`              -> 4 characters for each chunk\n        string memory result = new string(4 * ((data.length + 2) / 3));\n\n        /// @solidity memory-safe-assembly\n        assembly {", "highlightLines": [20]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Base64.sol", "line": 20, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-using-assembly-code"], "description": ""}, {"id": "606187b8ec5d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        string memory table = _TABLE;\n\n        // Encoding takes 3 bytes chunks of binary data from `bytes` data parameter\n        // and split into 4 numbers of 6 bits.\n        // The final Base64 length should be `bytes` data length multiplied by 4/3 rounded up\n        // - `data.length + 2`  -> Round up\n        // - `/ 3`              -> Number of 3-bytes chunks\n        // - `4 *`              -> 4 characters for each chunk\n        string memory result = new string(4 * ((data.length + 2) / 3));", "highlightLines": [28]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Base64.sol", "line": 28, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "32a5b44bce8b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        string memory result = new string(4 * ((data.length + 2) / 3));\n\n        /// @solidity memory-safe-assembly\n        assembly {\n            // Prepare the lookup table (skip the first \"length\" byte)\n            let tablePtr := add(table, 1)\n\n            // Prepare result pointer, jump over length\n            let resultPtr := add(result, 32)\n\n            // Run over the input, 3 bytes at a time\n            for {\n                let dataPtr := data\n                let endPtr := add(data, mload(data))\n            } lt(dataPtr, endPtr) {\n\n            } {\n                // Advance 3 bytes\n                dataPtr := add(dataPtr, 3)\n                let input := mload(dataPtr)\n\n                // To write each character, shift the 3 bytes (18 bits) chunk\n                // 4 times in blocks of 6 bits for each character (18, 12, 6, 0)\n                // and apply logical AND with 0x3F which is the number of\n                // the previous character in the ASCII table prior to the Base64 Table\n                // The result is then added to the table to get the character to write,\n                // and finally write it in the result pointer but with a left shift\n                // of 256 (1 byte) - 8 (1 ASCII char) = 248 bits\n\n                mstore8(resultPtr, mload(add(tablePtr, and(shr(18, input), 0x3F))))\n                resultPtr := add(resultPtr, 1) // Advance\n\n                mstore8(resultPtr, mload(add(tablePtr, and(shr(12, input), 0x3F))))\n                resultPtr := add(resultPtr, 1) // Advance\n\n                mstore8(resultPtr, mload(add(tablePtr, and(shr(6, input), 0x3F))))\n                resultPtr := add(resultPtr, 1) // Advance\n\n                mstore8(resultPtr, mload(add(tablePtr, and(input, 0x3F))))\n                resultPtr := add(resultPtr, 1) // Advance\n            }\n\n            // When data `bytes` is not exactly 3 bytes long\n            // it is padded with `=` characters at the end\n            switch mod(mload(data), 3)\n            case 1 {\n                mstore8(sub(resultPtr, 1), 0x3d)\n                mstore8(sub(resultPtr, 2), 0x3d)\n            }\n            case 2 {\n                mstore8(sub(resultPtr, 1), 0x3d)\n            }\n        }", "highlightLines": [36]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Base64.sol", "line": 36, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "84ad0be52a5f", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        string memory result = new string(4 * ((data.length + 2) / 3));", "highlightLines": [36]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Base64.sol", "line": 36, "column": 32}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "ab6d03df8a18", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [39]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Base64.sol", "line": 39, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "c80bc708e350", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            let tablePtr := add(table, 1)\n\n            // Prepare result pointer, jump over length\n            let resultPtr := add(result, 32)", "highlightLines": [41]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Base64.sol", "line": 41, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "df94bc7c37ec", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            let resultPtr := add(result, 32)\n\n            // Run over the input, 3 bytes at a time\n            for {\n                let dataPtr := data\n                let endPtr := add(data, mload(data))\n            } lt(dataPtr, endPtr) {\n\n            } {\n                // Advance 3 bytes\n                dataPtr := add(dataPtr, 3)\n                let input := mload(dataPtr)\n\n                // To write each character, shift the 3 bytes (18 bits) chunk\n                // 4 times in blocks of 6 bits for each character (18, 12, 6, 0)\n                // and apply logical AND with 0x3F which is the number of\n                // the previous character in the ASCII table prior to the Base64 Table\n                // The result is then added to the table to get the character to write,\n                // and finally write it in the result pointer but with a left shift\n                // of 256 (1 byte) - 8 (1 ASCII char) = 248 bits\n\n                mstore8(resultPtr, mload(add(tablePtr, and(shr(18, input), 0x3F))))\n                resultPtr := add(resultPtr, 1) // Advance\n\n                mstore8(resultPtr, mload(add(tablePtr, and(shr(12, input), 0x3F))))\n                resultPtr := add(resultPtr, 1) // Advance\n\n                mstore8(resultPtr, mload(add(tablePtr, and(shr(6, input), 0x3F))))\n                resultPtr := add(resultPtr, 1) // Advance\n\n                mstore8(resultPtr, mload(add(tablePtr, and(input, 0x3F))))\n                resultPtr := add(resultPtr, 1) // Advance\n            }", "highlightLines": [44]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Base64.sol", "line": 44, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "d809a8f59151", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "                let dataPtr := data\n                let endPtr := add(data, mload(data))", "highlightLines": [48]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Base64.sol", "line": 48, "column": 21}, "severity": "medium", "references": [], "description": ""}, {"id": "11013d89c996", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "                dataPtr := add(dataPtr, 3)\n                let input := mload(dataPtr)", "highlightLines": [54]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Base64.sol", "line": 54, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "97b29ec4c862", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "                let input := mload(dataPtr)\n\n                // To write each character, shift the 3 bytes (18 bits) chunk\n                // 4 times in blocks of 6 bits for each character (18, 12, 6, 0)\n                // and apply logical AND with 0x3F which is the number of\n                // the previous character in the ASCII table prior to the Base64 Table\n                // The result is then added to the table to get the character to write,\n                // and finally write it in the result pointer but with a left shift\n                // of 256 (1 byte) - 8 (1 ASCII char) = 248 bits\n\n                mstore8(resultPtr, mload(add(tablePtr, and(shr(18, input), 0x3F))))\n                resultPtr := add(resultPtr, 1) // Advance", "highlightLines": [55]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Base64.sol", "line": 55, "column": 21}, "severity": "medium", "references": [], "description": ""}, {"id": "6626e70eabf7", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "                resultPtr := add(resultPtr, 1) // Advance\n\n                mstore8(resultPtr, mload(add(tablePtr, and(shr(12, input), 0x3F))))\n                resultPtr := add(resultPtr, 1) // Advance", "highlightLines": [66]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Base64.sol", "line": 66, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "81706b5fc524", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "                resultPtr := add(resultPtr, 1) // Advance\n\n                mstore8(resultPtr, mload(add(tablePtr, and(shr(6, input), 0x3F))))\n                resultPtr := add(resultPtr, 1) // Advance", "highlightLines": [69]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Base64.sol", "line": 69, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "f71bcb9c37c4", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "                resultPtr := add(resultPtr, 1) // Advance\n\n                mstore8(resultPtr, mload(add(tablePtr, and(input, 0x3F))))\n                resultPtr := add(resultPtr, 1) // Advance", "highlightLines": [72]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Base64.sol", "line": 72, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "66998d0d0d33", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Checkpoints.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "8b05047e7fde", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint32 _blockNumber;", "highlightLines": [19]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Checkpoints.sol", "line": 19, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "6ebf33dada71", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint224 _value;", "highlightLines": [20]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Checkpoints.sol", "line": 20, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f5ab161b2f51", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function latest(History storage self) internal view returns (uint256) {\n        uint256 pos = self._checkpoints.length;", "highlightLines": [30]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Checkpoints.sol", "line": 30, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "b80d2ab50922", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 pos = self._checkpoints.length;", "highlightLines": [31]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Checkpoints.sol", "line": 31, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ab40a4aaf5dd", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function getAtBlock(History storage self, uint256 blockNumber) internal view returns (uint256) {\n        require(blockNumber < block.number, \"Checkpoints: block not yet mined\");\n\n        uint256 high = self._checkpoints.length;\n        uint256 low = 0;\n        while (low < high) {\n            uint256 mid = Math.average(low, high);\n            if (self._checkpoints[mid]._blockNumber > blockNumber) {\n                high = mid;", "highlightLines": [39]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Checkpoints.sol", "line": 39, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "c76fbef2457a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 high = self._checkpoints.length;", "highlightLines": [41]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Checkpoints.sol", "line": 41, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "9ad116a81695", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 high = self._checkpoints.length;\n        uint256 low = 0;", "highlightLines": [42]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Checkpoints.sol", "line": 42, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "aa7fc2843500", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 low = 0;", "highlightLines": [43]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Checkpoints.sol", "line": 43, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "bf9aba7174c5", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 low = 0;\n        while (low < high) {\n            uint256 mid = Math.average(low, high);\n            if (self._checkpoints[mid]._blockNumber > blockNumber) {\n                high = mid;\n            } else {\n                low = mid + 1;\n            }\n        }", "highlightLines": [43]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Checkpoints.sol", "line": 43, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "c47461871a04", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint256 mid = Math.average(low, high);", "highlightLines": [45]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Checkpoints.sol", "line": 45, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ab89dbbcd791", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            uint256 mid = Math.average(low, high);\n            if (self._checkpoints[mid]._blockNumber > blockNumber) {\n                high = mid;\n            } else {\n                low = mid + 1;\n            }", "highlightLines": [45]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Checkpoints.sol", "line": 45, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "06e4f7511eb3", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 pos = self._checkpoints.length;", "highlightLines": [61]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Checkpoints.sol", "line": 61, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "22dc0579f0be", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 pos = self._checkpoints.length;\n        uint256 old = latest(self);", "highlightLines": [61]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Checkpoints.sol", "line": 61, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "a690a5c7c263", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 old = latest(self);", "highlightLines": [62]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Checkpoints.sol", "line": 62, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "98eae7f698a6", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 old = latest(self);\n        if (pos > 0 && self._checkpoints[pos - 1]._blockNumber == block.number) {\n            self._checkpoints[pos - 1]._value = SafeCast.toUint224(value);\n        } else {\n            self._checkpoints.push(\n                Checkpoint({_blockNumber: SafeCast.toUint32(block.number), _value: SafeCast.toUint224(value)})\n            );\n        }", "highlightLines": [62]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Checkpoints.sol", "line": 62, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "795c0081bf16", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "        if (pos > 0 && self._checkpoints[pos - 1]._blockNumber == block.number) {\n            self._checkpoints[pos - 1]._value = SafeCast.toUint224(value);\n        } else {\n            self._checkpoints.push(\n                Checkpoint({_blockNumber: SafeCast.toUint32(block.number), _value: SafeCast.toUint224(value)})\n            );\n        }", "highlightLines": [63]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Checkpoints.sol", "line": 63, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "21b8ce3f9bcb", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "                Checkpoint({_blockNumber: SafeCast.toUint32(block.number), _value: SafeCast.toUint224(value)})", "highlightLines": [67]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Checkpoints.sol", "line": 67, "column": 55}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "6723925941c8", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Context.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "740bb1895692", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Counters.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "babcec22a944", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 _value; // default: 0", "highlightLines": [19]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Counters.sol", "line": 19, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "bd7a2cbda5e5", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 value = counter._value;", "highlightLines": [33]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Counters.sol", "line": 33, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0cbca325a194", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 value = counter._value;\n        require(value > 0, \"Counter: decrement overflow\");\n        unchecked {\n            counter._value = value - 1;\n        }", "highlightLines": [33]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Counters.sol", "line": 33, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "8a54727deee4", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "            counter._value = value - 1;", "highlightLines": [36]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Counters.sol", "line": 36, "column": 30}, "severity": "medium", "references": [], "description": ""}, {"id": "0ae3704f7c4a", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Create2.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "b11bc9e5e33a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address addr;", "highlightLines": [35]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Create2.sol", "line": 35, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "957fa5a385a9", "fix": {"template": null, "available": false}, "title": "ETH balance check without accounting for selfdestruct donations - can be manipulated", "ruleId": "rules.sol-eth-balance-accounting", "snippet": {"code": "        require(address(this).balance >= amount, \"Create2: insufficient balance\");", "highlightLines": [36]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Create2.sol", "line": 36, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "88e8e658178e", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [39]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Create2.sol", "line": 39, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "6e6810ee19cb", "fix": {"template": null, "available": false}, "title": "Contract deployment without chain ID - cross-chain replay attack possible (Wallet Mining pattern)", "ruleId": "rules.sol-cross-chain-deploy-no-chainid", "snippet": {"code": "            addr := create2(amount, add(bytecode, 0x20), mload(bytecode), salt)", "highlightLines": [40]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Create2.sol", "line": 40, "column": 21}, "severity": "medium", "references": ["https://www.damnvulnerabledefi.xyz/challenges/wallet-mining/"], "description": ""}, {"id": "a8d5625b269d", "fix": {"template": null, "available": false}, "title": "Raw bytecode deployment via create/create2 - verify bytecode source and intent (MagicNumber pattern)", "ruleId": "rules.sol-raw-bytecode-create", "snippet": {"code": "            addr := create2(amount, add(bytecode, 0x20), mload(bytecode), salt)", "highlightLines": [40]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Create2.sol", "line": 40, "column": 21}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/18"], "description": ""}, {"id": "cd1f89ac309a", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function computeAddress(\n        bytes32 salt,\n        bytes32 bytecodeHash,\n        address deployer\n    ) internal pure returns (address) {\n        bytes32 _data = keccak256(abi.encodePacked(bytes1(0xff), deployer, salt, bytecodeHash));", "highlightLines": [58]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Create2.sol", "line": 58, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "5e31615b6ca1", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 _data = keccak256(abi.encodePacked(bytes1(0xff), deployer, salt, bytecodeHash));", "highlightLines": [63]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Create2.sol", "line": 63, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "586e73df22ea", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        bytes32 _data = keccak256(abi.encodePacked(bytes1(0xff), deployer, salt, bytecodeHash));", "highlightLines": [63]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Create2.sol", "line": 63, "column": 25}, "severity": "high", "references": [], "description": ""}, {"id": "ac010c7c37c7", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "        bytes32 _data = keccak256(abi.encodePacked(bytes1(0xff), deployer, salt, bytecodeHash));", "highlightLines": [63]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Create2.sol", "line": 63, "column": 35}, "severity": "medium", "references": [], "description": ""}, {"id": "6f1ba27f1e94", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Multicall.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "3e7a32ae6ebd", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        results = new bytes[](data.length);\n        for (uint256 i = 0; i < data.length; i++) {\n            results[i] = Address.functionDelegateCall(address(this), data[i]);\n        }", "highlightLines": [18]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Multicall.sol", "line": 18, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "11ba44aaab38", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        results = new bytes[](data.length);", "highlightLines": [18]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Multicall.sol", "line": 18, "column": 19}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "6de70e261d25", "fix": {"template": null, "available": false}, "title": "Storage variable modified in loop - should cache in memory for gas savings", "ruleId": "rules.sol-memory-vs-storage-loop", "snippet": {"code": "        for (uint256 i = 0; i < data.length; i++) {\n            results[i] = Address.functionDelegateCall(address(this), data[i]);", "highlightLines": [19]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Multicall.sol", "line": 19, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "01f743f44fca", "fix": {"template": null, "available": false}, "title": "address(this) stored in mapping - contracts often confuse handler address with token address", "ruleId": "rules.sol-address-this-in-mapping-storage", "snippet": {"code": "            results[i] = Address.functionDelegateCall(address(this), data[i]);", "highlightLines": [20]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Multicall.sol", "line": 20, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "18a88bb9e3b2", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/StorageSlot.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "b2ad5f59fb16", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": " *     bytes32 internal constant _IMPLEMENTATION_SLOT = 0x360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc;", "highlightLines": [17]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/StorageSlot.sol", "line": 17, "column": 57}, "severity": "high", "references": [], "description": ""}, {"id": "a92cb04adcc1", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address value;", "highlightLines": [34]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/StorageSlot.sol", "line": 34, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ab48b555fa11", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool value;", "highlightLines": [38]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/StorageSlot.sol", "line": 38, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "49b1957855fb", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 value;", "highlightLines": [42]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/StorageSlot.sol", "line": 42, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7361a5c9d3a2", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 value;", "highlightLines": [46]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/StorageSlot.sol", "line": 46, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "2724d4577cb9", "fix": {"template": null, "available": false}, "title": "View/pure function uses assembly - may modify state unexpectedly", "ruleId": "rules.sol-constant-function-assembly", "snippet": {"code": "    function getAddressSlot(bytes32 slot) internal pure returns (AddressSlot storage r) {\n        /// @solidity memory-safe-assembly\n        assembly {", "highlightLines": [52]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/StorageSlot.sol", "line": 52, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-using-assembly-code"], "description": ""}, {"id": "df5916ee0f94", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [54]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/StorageSlot.sol", "line": 54, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "2e3cc72f8e40", "fix": {"template": null, "available": false}, "title": "View/pure function uses assembly - may modify state unexpectedly", "ruleId": "rules.sol-constant-function-assembly", "snippet": {"code": "    function getBooleanSlot(bytes32 slot) internal pure returns (BooleanSlot storage r) {\n        /// @solidity memory-safe-assembly\n        assembly {", "highlightLines": [62]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/StorageSlot.sol", "line": 62, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-using-assembly-code"], "description": ""}, {"id": "b9616f30b53a", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [64]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/StorageSlot.sol", "line": 64, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "c4b09894fbcf", "fix": {"template": null, "available": false}, "title": "View/pure function uses assembly - may modify state unexpectedly", "ruleId": "rules.sol-constant-function-assembly", "snippet": {"code": "    function getBytes32Slot(bytes32 slot) internal pure returns (Bytes32Slot storage r) {\n        /// @solidity memory-safe-assembly\n        assembly {", "highlightLines": [72]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/StorageSlot.sol", "line": 72, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-using-assembly-code"], "description": ""}, {"id": "09b977bbabe5", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [74]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/StorageSlot.sol", "line": 74, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "30cb22d6797f", "fix": {"template": null, "available": false}, "title": "View/pure function uses assembly - may modify state unexpectedly", "ruleId": "rules.sol-constant-function-assembly", "snippet": {"code": "    function getUint256Slot(bytes32 slot) internal pure returns (Uint256Slot storage r) {\n        /// @solidity memory-safe-assembly\n        assembly {", "highlightLines": [82]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/StorageSlot.sol", "line": 82, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-using-assembly-code"], "description": ""}, {"id": "74325e8115cd", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [84]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/StorageSlot.sol", "line": 84, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "17bf632c6fe4", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Strings.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "b8dfd1194204", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function toString(uint256 value) internal pure returns (string memory) {\n        // Inspired by OraclizeAPI's implementation - MIT licence\n        // https://github.com/oraclize/ethereum-api/blob/b42146b063c7d6ee1358846c198246239e9360e8/oraclizeAPI_0.4.25.sol\n\n        if (value == 0) {", "highlightLines": [16]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Strings.sol", "line": 16, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "867f19cba254", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 temp = value;", "highlightLines": [23]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Strings.sol", "line": 23, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "26aa014c6467", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 temp = value;\n        uint256 digits;\n        while (temp != 0) {\n            digits++;\n            temp /= 10;\n        }\n        bytes memory buffer = new bytes(digits);", "highlightLines": [23]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Strings.sol", "line": 23, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "74272fcfbf2c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 digits;", "highlightLines": [24]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Strings.sol", "line": 24, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f9ae84f0cc0a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes memory buffer = new bytes(digits);\n        while (value != 0) {\n            digits -= 1;\n            buffer[digits] = bytes1(uint8(48 + uint256(value % 10)));\n            value /= 10;\n        }", "highlightLines": [29]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Strings.sol", "line": 29, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e3daae1ec934", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        bytes memory buffer = new bytes(digits);", "highlightLines": [29]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Strings.sol", "line": 29, "column": 31}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "4ecec50e0005", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "            buffer[digits] = bytes1(uint8(48 + uint256(value % 10)));", "highlightLines": [32]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Strings.sol", "line": 32, "column": 37}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "3655a2526d13", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function toHexString(uint256 value) internal pure returns (string memory) {\n        if (value == 0) {", "highlightLines": [41]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Strings.sol", "line": 41, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "7915930a37f2", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 temp = value;", "highlightLines": [45]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Strings.sol", "line": 45, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "04a2d37435e9", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 temp = value;\n        uint256 length = 0;", "highlightLines": [45]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Strings.sol", "line": 45, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "c631bd469224", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 length = 0;", "highlightLines": [46]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Strings.sol", "line": 46, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c7b008c621e8", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function toHexString(uint256 value, uint256 length) internal pure returns (string memory) {\n        bytes memory buffer = new bytes(2 * length + 2);\n        buffer[0] = \"0\";\n        buffer[1] = \"x\";\n        for (uint256 i = 2 * length + 1; i > 1; --i) {", "highlightLines": [57]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Strings.sol", "line": 57, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "8482d5ed62eb", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes memory buffer = new bytes(2 * length + 2);\n        buffer[0] = \"0\";", "highlightLines": [58]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Strings.sol", "line": 58, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "6ff5ec78e516", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        bytes memory buffer = new bytes(2 * length + 2);", "highlightLines": [58]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Strings.sol", "line": 58, "column": 31}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "4af107acb4a9", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        buffer[0] = \"0\";\n        buffer[1] = \"x\";", "highlightLines": [59]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Strings.sol", "line": 59, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "0bb2003fa8ef", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        buffer[1] = \"x\";\n        for (uint256 i = 2 * length + 1; i > 1; --i) {\n            buffer[i] = _HEX_SYMBOLS[value & 0xf];\n            value >>= 4;\n        }", "highlightLines": [60]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Strings.sol", "line": 60, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "6981d7fddfcb", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "            buffer[i] = _HEX_SYMBOLS[value & 0xf];", "highlightLines": [62]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Strings.sol", "line": 62, "column": 38}, "severity": "medium", "references": [], "description": ""}, {"id": "2a97ebe0f7d7", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Timers.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "958ed379a538", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint64 _deadline;", "highlightLines": [11]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Timers.sol", "line": 11, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e2e77fe4418b", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        return timer._deadline > block.timestamp;", "highlightLines": [35]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Timers.sol", "line": 35, "column": 34}, "severity": "medium", "references": [], "description": ""}, {"id": "d3fc199745bf", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        return isStarted(timer) && timer._deadline <= block.timestamp;", "highlightLines": [39]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Timers.sol", "line": 39, "column": 55}, "severity": "medium", "references": [], "description": ""}, {"id": "f04a5fc1d84d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint64 _deadline;", "highlightLines": [43]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/Timers.sol", "line": 43, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "23be1cb7dcd2", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/ECDSA.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "7021c88db173", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "        InvalidSignature,\n        InvalidSignatureLength,", "highlightLines": [17]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/ECDSA.sol", "line": 17, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "fb4cf0fab4d0", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function _throwError(RecoverError error) private pure {\n        if (error == RecoverError.NoError) {", "highlightLines": [23]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/ECDSA.sol", "line": 23, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "b03d80e37e7e", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "        } else if (error == RecoverError.InvalidSignature) {\n            revert(\"ECDSA: invalid signature\");\n        } else if (error == RecoverError.InvalidSignatureLength) {\n            revert(\"ECDSA: invalid signature length\");\n        } else if (error == RecoverError.InvalidSignatureS) {\n            revert(\"ECDSA: invalid signature 's' value\");\n        } else if (error == RecoverError.InvalidSignatureV) {\n            revert(\"ECDSA: invalid signature 'v' value\");\n        }", "highlightLines": [26]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/ECDSA.sol", "line": 26, "column": 16}, "severity": "medium", "references": [], "description": ""}, {"id": "746cd42a8ded", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "        } else if (error == RecoverError.InvalidSignatureLength) {\n            revert(\"ECDSA: invalid signature length\");\n        } else if (error == RecoverError.InvalidSignatureS) {\n            revert(\"ECDSA: invalid signature 's' value\");\n        } else if (error == RecoverError.InvalidSignatureV) {\n            revert(\"ECDSA: invalid signature 'v' value\");\n        }", "highlightLines": [28]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/ECDSA.sol", "line": 28, "column": 16}, "severity": "medium", "references": [], "description": ""}, {"id": "b62cfd50acaa", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "        } else if (error == RecoverError.InvalidSignatureS) {\n            revert(\"ECDSA: invalid signature 's' value\");\n        } else if (error == RecoverError.InvalidSignatureV) {\n            revert(\"ECDSA: invalid signature 'v' value\");\n        }", "highlightLines": [30]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/ECDSA.sol", "line": 30, "column": 16}, "severity": "medium", "references": [], "description": ""}, {"id": "0ba971c79c82", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "        } else if (error == RecoverError.InvalidSignatureV) {\n            revert(\"ECDSA: invalid signature 'v' value\");\n        }", "highlightLines": [32]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/ECDSA.sol", "line": 32, "column": 16}, "severity": "medium", "references": [], "description": ""}, {"id": "765126644696", "fix": {"template": null, "available": false}, "title": "View/pure function uses assembly - may modify state unexpectedly", "ruleId": "rules.sol-constant-function-assembly", "snippet": {"code": "    function tryRecover(bytes32 hash, bytes memory signature) internal pure returns (address, RecoverError) {\n        // Check the signature length\n        // - case 65: r,s,v signature (standard)\n        // - case 64: r,vs signature (cf https://eips.ethereum.org/EIPS/eip-2098) _Available since v4.1._\n        if (signature.length == 65) {\n            bytes32 r;\n            bytes32 s;\n            uint8 v;\n            // ecrecover takes the signature parameters, and the only way to get them\n            // currently is to use assembly.\n            /// @solidity memory-safe-assembly\n            assembly {", "highlightLines": [57]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/ECDSA.sol", "line": 57, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-using-assembly-code"], "description": ""}, {"id": "d9bf5e202c6f", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            bytes32 r;", "highlightLines": [62]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/ECDSA.sol", "line": 62, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4d3a3717fb0d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            bytes32 s;", "highlightLines": [63]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/ECDSA.sol", "line": 63, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8aa81f4e0215", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint8 v;", "highlightLines": [64]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/ECDSA.sol", "line": 64, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b88e92079ac1", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "            assembly {", "highlightLines": [68]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/ECDSA.sol", "line": 68, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "ffa67900658f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "                r := mload(add(signature, 0x20))\n                s := mload(add(signature, 0x40))", "highlightLines": [69]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/ECDSA.sol", "line": 69, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "8d897894ade2", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "                s := mload(add(signature, 0x40))\n                v := byte(0, mload(add(signature, 0x60)))", "highlightLines": [70]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/ECDSA.sol", "line": 70, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "df0529483df9", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            bytes32 r;", "highlightLines": [75]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/ECDSA.sol", "line": 75, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c9f214b46ba1", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            bytes32 vs;", "highlightLines": [76]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/ECDSA.sol", "line": 76, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4d4da19fd2a3", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "            assembly {", "highlightLines": [80]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/ECDSA.sol", "line": 80, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "c4ebd50f26d2", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "                r := mload(add(signature, 0x20))\n                vs := mload(add(signature, 0x40))", "highlightLines": [81]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/ECDSA.sol", "line": 81, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "c5525504505a", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function tryRecover(\n        bytes32 hash,\n        bytes32 r,\n        bytes32 vs\n    ) internal pure returns (address, RecoverError) {\n        bytes32 s = vs & bytes32(0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff);\n        uint8 v = uint8((uint256(vs) >> 255) + 27);", "highlightLines": [117]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/ECDSA.sol", "line": 117, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "13a29160b79d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 s = vs & bytes32(0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff);", "highlightLines": [122]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/ECDSA.sol", "line": 122, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7ca4115fcf16", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes32 s = vs & bytes32(0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff);\n        uint8 v = uint8((uint256(vs) >> 255) + 27);", "highlightLines": [122]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/ECDSA.sol", "line": 122, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d551d09a132d", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "        bytes32 s = vs & bytes32(0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff);", "highlightLines": [122]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/ECDSA.sol", "line": 122, "column": 21}, "severity": "medium", "references": [], "description": ""}, {"id": "e74291bd2ed6", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "        bytes32 s = vs & bytes32(0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff);", "highlightLines": [122]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/ECDSA.sol", "line": 122, "column": 34}, "severity": "high", "references": [], "description": ""}, {"id": "4edcb95bb9d0", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint8 v = uint8((uint256(vs) >> 255) + 27);", "highlightLines": [123]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/ECDSA.sol", "line": 123, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f02c7183eb51", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "        uint8 v = uint8((uint256(vs) >> 255) + 27);", "highlightLines": [123]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/ECDSA.sol", "line": 123, "column": 26}, "severity": "medium", "references": [], "description": ""}, {"id": "65a268769003", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "        // with 0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141 - s1 and flip v from 27 to 28 or", "highlightLines": [160]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/ECDSA.sol", "line": 160, "column": 17}, "severity": "high", "references": [], "description": ""}, {"id": "29369f11c540", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "        if (uint256(s) > 0x7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF5D576E7357A4501DDFE92F46681B20A0) {", "highlightLines": [163]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/ECDSA.sol", "line": 163, "column": 26}, "severity": "high", "references": [], "description": ""}, {"id": "4b13aee6a71c", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "        // If the signature is valid (and not malleable), return the signer address\n        address signer = ecrecover(hash, v, r, s);\n        if (signer == address(0)) {", "highlightLines": [170]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/ECDSA.sol", "line": 170, "column": 59}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "821a704891ea", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address signer = ecrecover(hash, v, r, s);", "highlightLines": [171]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/ECDSA.sol", "line": 171, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7557b86903d4", "fix": {"template": null, "available": false}, "title": "ecrecover is vulnerable to signature malleability - use OpenZeppelin ECDSA", "ruleId": "rules.sol-ecrecover-malleable", "snippet": {"code": "        address signer = ecrecover(hash, v, r, s);", "highlightLines": [171]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/ECDSA.sol", "line": 171, "column": 26}, "severity": "medium", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/utils/cryptography/ECDSA.sol"], "description": ""}, {"id": "e16891cc819b", "fix": {"template": null, "available": false}, "title": "ecrecover result not checked for zero address - invalid signatures return address(0)", "ruleId": "rules.sol-ethernaut-ecrecover-no-zero-check", "snippet": {"code": "        address signer = ecrecover(hash, v, r, s);", "highlightLines": [171]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/ECDSA.sol", "line": 171, "column": 26}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-117", "https://swcregistry.io/docs/SWC-122"], "description": ""}, {"id": "65b1765247da", "fix": {"template": null, "available": false}, "title": "Signature verification without s-value malleability check - signatures can be replayed with modified s", "ruleId": "rules.sol-ethernaut-signature-malleability", "snippet": {"code": "        address signer = ecrecover(hash, v, r, s);", "highlightLines": [171]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/ECDSA.sol", "line": 171, "column": 26}, "severity": "medium", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/utils/cryptography/ECDSA.sol"], "description": ""}, {"id": "b98a20e07631", "fix": {"template": null, "available": false}, "title": "ECDSA signature without s-value check - signature malleability possible", "ruleId": "rules.sol-signature-malleability", "snippet": {"code": "        address signer = ecrecover(hash, v, r, s);", "highlightLines": [171]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/ECDSA.sol", "line": 171, "column": 26}, "severity": "medium", "references": [], "description": ""}, {"id": "62f5dcfb9cb4", "fix": {"template": null, "available": false}, "title": "Signature verification without domain separator - cross-contract replay possible", "ruleId": "rules.sol-signature-no-domain-separator", "snippet": {"code": "        address signer = ecrecover(hash, v, r, s);", "highlightLines": [171]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/ECDSA.sol", "line": 171, "column": 26}, "severity": "medium", "references": [], "description": ""}, {"id": "1fa6cb200ad9", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        return keccak256(abi.encodePacked(\"\\x19Ethereum Signed Message:\\n32\", hash));", "highlightLines": [205]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/ECDSA.sol", "line": 205, "column": 16}, "severity": "high", "references": [], "description": ""}, {"id": "e205ae0bbefc", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "        return keccak256(abi.encodePacked(\"\\x19Ethereum Signed Message:\\n32\", hash));", "highlightLines": [205]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/ECDSA.sol", "line": 205, "column": 26}, "severity": "medium", "references": [], "description": ""}, {"id": "45af09018a2d", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        return keccak256(abi.encodePacked(\"\\x19Ethereum Signed Message:\\n\", Strings.toString(s.length), s));", "highlightLines": [217]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/ECDSA.sol", "line": 217, "column": 16}, "severity": "high", "references": [], "description": ""}, {"id": "fcb98fc1c13e", "fix": {"template": null, "available": false}, "title": "Signature verification without EIP-712 domain separator - vulnerable to cross-chain/cross-contract replay", "ruleId": "rules.sol-ethernaut-missing-eip712-domain", "snippet": {"code": "        return keccak256(abi.encodePacked(\"\\x19Ethereum Signed Message:\\n\", Strings.toString(s.length), s));", "highlightLines": [217]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/ECDSA.sol", "line": 217, "column": 16}, "severity": "high", "references": ["https://eips.ethereum.org/EIPS/eip-712", "https://ethernaut.openzeppelin.com/"], "description": ""}, {"id": "41ab1112bc86", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "        return keccak256(abi.encodePacked(\"\\x19Ethereum Signed Message:\\n\", Strings.toString(s.length), s));", "highlightLines": [217]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/ECDSA.sol", "line": 217, "column": 26}, "severity": "medium", "references": [], "description": ""}, {"id": "ec83df4d709c", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        return keccak256(abi.encodePacked(\"\\x19\\x01\", domainSeparator, structHash));", "highlightLines": [230]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/ECDSA.sol", "line": 230, "column": 16}, "severity": "high", "references": [], "description": ""}, {"id": "d7838305ad90", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "        return keccak256(abi.encodePacked(\"\\x19\\x01\", domainSeparator, structHash));", "highlightLines": [230]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/ECDSA.sol", "line": 230, "column": 26}, "severity": "medium", "references": [], "description": ""}, {"id": "322adb4832bd", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "ecd9a84923c2", "fix": {"template": null, "available": false}, "title": "Storage array passed by value to internal function - changes won't persist", "ruleId": "rules.sol-array-by-reference", "snippet": {"code": "    function verify(\n        bytes32[] memory proof,\n        bytes32 root,\n        bytes32 leaf\n    ) internal pure returns (bool) {", "highlightLines": [27]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 27, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#modifying-storage-array-by-value"], "description": ""}, {"id": "ebaf398e882c", "fix": {"template": null, "available": false}, "title": "Storage array passed by value to internal function - changes won't persist", "ruleId": "rules.sol-array-by-reference", "snippet": {"code": "    function processProof(bytes32[] memory proof, bytes32 leaf) internal pure returns (bytes32) {", "highlightLines": [56]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 56, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#modifying-storage-array-by-value"], "description": ""}, {"id": "dbe96d8ca666", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function processProof(bytes32[] memory proof, bytes32 leaf) internal pure returns (bytes32) {\n        bytes32 computedHash = leaf;\n        for (uint256 i = 0; i < proof.length; i++) {\n            computedHash = _hashPair(computedHash, proof[i]);", "highlightLines": [56]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 56, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "8141094eca8f", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 computedHash = leaf;", "highlightLines": [57]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 57, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4f3616e834f6", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes32 computedHash = leaf;\n        for (uint256 i = 0; i < proof.length; i++) {\n            computedHash = _hashPair(computedHash, proof[i]);\n        }", "highlightLines": [57]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 57, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "32f7d403cb4f", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function processProofCalldata(bytes32[] calldata proof, bytes32 leaf) internal pure returns (bytes32) {\n        bytes32 computedHash = leaf;\n        for (uint256 i = 0; i < proof.length; i++) {\n            computedHash = _hashPair(computedHash, proof[i]);", "highlightLines": [69]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 69, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "723d14dbc590", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 computedHash = leaf;", "highlightLines": [70]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 70, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "33b8956fca14", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes32 computedHash = leaf;\n        for (uint256 i = 0; i < proof.length; i++) {\n            computedHash = _hashPair(computedHash, proof[i]);\n        }", "highlightLines": [70]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 70, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "ed3a054fa011", "fix": {"template": null, "available": false}, "title": "Storage array passed by value to internal function - changes won't persist", "ruleId": "rules.sol-array-by-reference", "snippet": {"code": "    function multiProofVerify(\n        bytes32[] memory proof,\n        bool[] memory proofFlags,\n        bytes32 root,\n        bytes32[] memory leaves\n    ) internal pure returns (bool) {", "highlightLines": [83]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 83, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#modifying-storage-array-by-value"], "description": ""}, {"id": "0f105589f3b7", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "        return processMultiProof(proof, proofFlags, leaves) == root;", "highlightLines": [89]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 89, "column": 34}, "severity": "info", "references": [], "description": ""}, {"id": "36f4c5bb6b33", "fix": {"template": null, "available": false}, "title": "Storage array passed by value to internal function - changes won't persist", "ruleId": "rules.sol-array-by-reference", "snippet": {"code": "    function multiProofVerifyCalldata(\n        bytes32[] calldata proof,\n        bool[] calldata proofFlags,\n        bytes32 root,\n        bytes32[] memory leaves\n    ) internal pure returns (bool) {", "highlightLines": [97]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 97, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#modifying-storage-array-by-value"], "description": ""}, {"id": "45a5e95d7f51", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "        return processMultiProofCalldata(proof, proofFlags, leaves) == root;", "highlightLines": [103]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 103, "column": 42}, "severity": "info", "references": [], "description": ""}, {"id": "c28ddccb0097", "fix": {"template": null, "available": false}, "title": "Storage array passed by value to internal function - changes won't persist", "ruleId": "rules.sol-array-by-reference", "snippet": {"code": "    function processMultiProof(\n        bytes32[] memory proof,\n        bool[] memory proofFlags,\n        bytes32[] memory leaves\n    ) internal pure returns (bytes32 merkleRoot) {", "highlightLines": [113]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 113, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#modifying-storage-array-by-value"], "description": ""}, {"id": "159faac07c14", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function processMultiProof(\n        bytes32[] memory proof,\n        bool[] memory proofFlags,\n        bytes32[] memory leaves\n    ) internal pure returns (bytes32 merkleRoot) {\n        // This function rebuild the root hash by traversing the tree up from the leaves. The root is rebuilt by\n        // consuming and producing values on a queue. The queue starts with the `leaves` array, then goes onto the\n        // `hashes` array. At the end of the process, the last hash in the `hashes` array should contain the root of\n        // the merkle tree.\n        uint256 leavesLen = leaves.length;\n        uint256 totalHashes = proofFlags.length;\n\n        // Check proof validity.\n        require(leavesLen + proof.length - 1 == totalHashes, \"MerkleProof: invalid multiproof\");\n\n        // The xxxPos values are \"pointers\" to the next value to consume in each array. All accesses are done using\n        // `xxx[xxxPos++]`, which return the current value and increment the pointer, thus mimicking a queue's \"pop\".\n        bytes32[] memory hashes = new bytes32[](totalHashes);\n        uint256 leafPos = 0;\n        uint256 hashPos = 0;\n        uint256 proofPos = 0;\n        // At each step, we compute the next hash using two values:\n        // - a value from the \"main queue\". If not all leaves have been consumed, we get the next leaf, otherwise we\n        //   get the next hash.\n        // - depending on the flag, either another value for the \"main queue\" (merging branches) or an element from the\n        //   `proof` array.\n        for (uint256 i = 0; i < totalHashes; i++) {\n            bytes32 a = leafPos < leavesLen ? leaves[leafPos++] : hashes[hashPos++];\n            bytes32 b = proofFlags[i] ? leafPos < leavesLen ? leaves[leafPos++] : hashes[hashPos++] : proof[proofPos++];", "highlightLines": [113]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 113, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "6622b1a9e683", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 leavesLen = leaves.length;", "highlightLines": [122]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 122, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f8593253f4e7", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 leavesLen = leaves.length;\n        uint256 totalHashes = proofFlags.length;", "highlightLines": [122]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 122, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "bc32afdc767b", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 totalHashes = proofFlags.length;", "highlightLines": [123]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 123, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "523beea7b007", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "        uint256 totalHashes = proofFlags.length;", "highlightLines": [123]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 123, "column": 9}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "525bc46148b6", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 totalHashes = proofFlags.length;\n\n        // Check proof validity.\n        require(leavesLen + proof.length - 1 == totalHashes, \"MerkleProof: invalid multiproof\");\n\n        // The xxxPos values are \"pointers\" to the next value to consume in each array. All accesses are done using\n        // `xxx[xxxPos++]`, which return the current value and increment the pointer, thus mimicking a queue's \"pop\".\n        bytes32[] memory hashes = new bytes32[](totalHashes);", "highlightLines": [123]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 123, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "6e1b950c242d", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "        // `xxx[xxxPos++]`, which return the current value and increment the pointer, thus mimicking a queue's \"pop\".\n        bytes32[] memory hashes = new bytes32[](totalHashes);\n        uint256 leafPos = 0;", "highlightLines": [129]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 129, "column": 35}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "1ded61feab00", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes32[] memory hashes = new bytes32[](totalHashes);\n        uint256 leafPos = 0;", "highlightLines": [130]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 130, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d40c39d10bd8", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        bytes32[] memory hashes = new bytes32[](totalHashes);", "highlightLines": [130]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 130, "column": 35}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "7088bdf2d637", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 leafPos = 0;", "highlightLines": [131]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 131, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "878c70e326dc", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 leafPos = 0;\n        uint256 hashPos = 0;", "highlightLines": [131]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 131, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "5ae96dab6ae1", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 hashPos = 0;", "highlightLines": [132]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 132, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f3d9692dd80b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 hashPos = 0;\n        uint256 proofPos = 0;", "highlightLines": [132]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 132, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "7e48465cb5c5", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 proofPos = 0;", "highlightLines": [133]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 133, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a2cabe4148e8", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 proofPos = 0;\n        // At each step, we compute the next hash using two values:\n        // - a value from the \"main queue\". If not all leaves have been consumed, we get the next leaf, otherwise we\n        //   get the next hash.\n        // - depending on the flag, either another value for the \"main queue\" (merging branches) or an element from the\n        //   `proof` array.\n        for (uint256 i = 0; i < totalHashes; i++) {\n            bytes32 a = leafPos < leavesLen ? leaves[leafPos++] : hashes[hashPos++];\n            bytes32 b = proofFlags[i] ? leafPos < leavesLen ? leaves[leafPos++] : hashes[hashPos++] : proof[proofPos++];\n            hashes[i] = _hashPair(a, b);\n        }", "highlightLines": [133]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 133, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "67b2880e9de9", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            bytes32 a = leafPos < leavesLen ? leaves[leafPos++] : hashes[hashPos++];", "highlightLines": [140]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 140, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8e5a4e590a4f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            bytes32 a = leafPos < leavesLen ? leaves[leafPos++] : hashes[hashPos++];\n            bytes32 b = proofFlags[i] ? leafPos < leavesLen ? leaves[leafPos++] : hashes[hashPos++] : proof[proofPos++];", "highlightLines": [140]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 140, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "840936eb8d85", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            bytes32 b = proofFlags[i] ? leafPos < leavesLen ? leaves[leafPos++] : hashes[hashPos++] : proof[proofPos++];", "highlightLines": [141]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 141, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "48dc2432a50e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            bytes32 b = proofFlags[i] ? leafPos < leavesLen ? leaves[leafPos++] : hashes[hashPos++] : proof[proofPos++];\n            hashes[i] = _hashPair(a, b);", "highlightLines": [141]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 141, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "06b4454014dc", "fix": {"template": null, "available": false}, "title": "Storage array passed by value to internal function - changes won't persist", "ruleId": "rules.sol-array-by-reference", "snippet": {"code": "    function processMultiProofCalldata(\n        bytes32[] calldata proof,\n        bool[] calldata proofFlags,\n        bytes32[] memory leaves\n    ) internal pure returns (bytes32 merkleRoot) {", "highlightLines": [159]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 159, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#modifying-storage-array-by-value"], "description": ""}, {"id": "a5094b2b503d", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function processMultiProofCalldata(\n        bytes32[] calldata proof,\n        bool[] calldata proofFlags,\n        bytes32[] memory leaves\n    ) internal pure returns (bytes32 merkleRoot) {\n        // This function rebuild the root hash by traversing the tree up from the leaves. The root is rebuilt by\n        // consuming and producing values on a queue. The queue starts with the `leaves` array, then goes onto the\n        // `hashes` array. At the end of the process, the last hash in the `hashes` array should contain the root of\n        // the merkle tree.\n        uint256 leavesLen = leaves.length;\n        uint256 totalHashes = proofFlags.length;\n\n        // Check proof validity.\n        require(leavesLen + proof.length - 1 == totalHashes, \"MerkleProof: invalid multiproof\");\n\n        // The xxxPos values are \"pointers\" to the next value to consume in each array. All accesses are done using\n        // `xxx[xxxPos++]`, which return the current value and increment the pointer, thus mimicking a queue's \"pop\".\n        bytes32[] memory hashes = new bytes32[](totalHashes);\n        uint256 leafPos = 0;\n        uint256 hashPos = 0;\n        uint256 proofPos = 0;\n        // At each step, we compute the next hash using two values:\n        // - a value from the \"main queue\". If not all leaves have been consumed, we get the next leaf, otherwise we\n        //   get the next hash.\n        // - depending on the flag, either another value for the \"main queue\" (merging branches) or an element from the\n        //   `proof` array.\n        for (uint256 i = 0; i < totalHashes; i++) {\n            bytes32 a = leafPos < leavesLen ? leaves[leafPos++] : hashes[hashPos++];\n            bytes32 b = proofFlags[i] ? leafPos < leavesLen ? leaves[leafPos++] : hashes[hashPos++] : proof[proofPos++];", "highlightLines": [159]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 159, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "f94bbe3211f9", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 leavesLen = leaves.length;", "highlightLines": [168]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 168, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b4b2b506a543", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 leavesLen = leaves.length;\n        uint256 totalHashes = proofFlags.length;", "highlightLines": [168]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 168, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "02fff4a2423b", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 totalHashes = proofFlags.length;", "highlightLines": [169]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 169, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8034ec5a20d9", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "        uint256 totalHashes = proofFlags.length;", "highlightLines": [169]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 169, "column": 9}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "c718392f3e87", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 totalHashes = proofFlags.length;\n\n        // Check proof validity.\n        require(leavesLen + proof.length - 1 == totalHashes, \"MerkleProof: invalid multiproof\");\n\n        // The xxxPos values are \"pointers\" to the next value to consume in each array. All accesses are done using\n        // `xxx[xxxPos++]`, which return the current value and increment the pointer, thus mimicking a queue's \"pop\".\n        bytes32[] memory hashes = new bytes32[](totalHashes);", "highlightLines": [169]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 169, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "c0d857ae4de5", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "        // `xxx[xxxPos++]`, which return the current value and increment the pointer, thus mimicking a queue's \"pop\".\n        bytes32[] memory hashes = new bytes32[](totalHashes);\n        uint256 leafPos = 0;", "highlightLines": [175]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 175, "column": 35}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "3474ee31e319", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes32[] memory hashes = new bytes32[](totalHashes);\n        uint256 leafPos = 0;", "highlightLines": [176]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 176, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "c499d20ad07d", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        bytes32[] memory hashes = new bytes32[](totalHashes);", "highlightLines": [176]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 176, "column": 35}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "013512244cce", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 leafPos = 0;", "highlightLines": [177]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 177, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "2d7e5271a826", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 leafPos = 0;\n        uint256 hashPos = 0;", "highlightLines": [177]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 177, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "2d7cba605823", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 hashPos = 0;", "highlightLines": [178]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 178, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e4e66b03cc75", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 hashPos = 0;\n        uint256 proofPos = 0;", "highlightLines": [178]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 178, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "7c09dbe863c7", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 proofPos = 0;", "highlightLines": [179]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 179, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "24a82929e297", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 proofPos = 0;\n        // At each step, we compute the next hash using two values:\n        // - a value from the \"main queue\". If not all leaves have been consumed, we get the next leaf, otherwise we\n        //   get the next hash.\n        // - depending on the flag, either another value for the \"main queue\" (merging branches) or an element from the\n        //   `proof` array.\n        for (uint256 i = 0; i < totalHashes; i++) {\n            bytes32 a = leafPos < leavesLen ? leaves[leafPos++] : hashes[hashPos++];\n            bytes32 b = proofFlags[i] ? leafPos < leavesLen ? leaves[leafPos++] : hashes[hashPos++] : proof[proofPos++];\n            hashes[i] = _hashPair(a, b);\n        }", "highlightLines": [179]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 179, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "27a048d68bc5", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            bytes32 a = leafPos < leavesLen ? leaves[leafPos++] : hashes[hashPos++];", "highlightLines": [186]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 186, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f22691a7a565", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            bytes32 a = leafPos < leavesLen ? leaves[leafPos++] : hashes[hashPos++];\n            bytes32 b = proofFlags[i] ? leafPos < leavesLen ? leaves[leafPos++] : hashes[hashPos++] : proof[proofPos++];", "highlightLines": [186]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 186, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "b7c65f636076", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            bytes32 b = proofFlags[i] ? leafPos < leavesLen ? leaves[leafPos++] : hashes[hashPos++] : proof[proofPos++];", "highlightLines": [187]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 187, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3b250ae22aa7", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            bytes32 b = proofFlags[i] ? leafPos < leavesLen ? leaves[leafPos++] : hashes[hashPos++] : proof[proofPos++];\n            hashes[i] = _hashPair(a, b);", "highlightLines": [187]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 187, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "dacc1030f44d", "fix": {"template": null, "available": false}, "title": "View/pure function uses assembly - may modify state unexpectedly", "ruleId": "rules.sol-constant-function-assembly", "snippet": {"code": "    function _efficientHash(bytes32 a, bytes32 b) private pure returns (bytes32 value) {\n        /// @solidity memory-safe-assembly\n        assembly {", "highlightLines": [204]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 204, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-using-assembly-code"], "description": ""}, {"id": "719489c637db", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [206]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/MerkleProof.sol", "line": 206, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "9c84e608d532", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/SignatureChecker.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "e5e01ba91c95", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "     * change through time. It could return true at block N and false at block N+1 (or the opposite).\n     */\n    function isValidSignatureNow(\n        address signer,\n        bytes32 hash,\n        bytes memory signature\n    ) internal view returns (bool) {\n        (address recovered, ECDSA.RecoverError error) = ECDSA.tryRecover(hash, signature);\n        if (error == ECDSA.RecoverError.NoError && recovered == signer) {", "highlightLines": [23]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/SignatureChecker.sol", "line": 23, "column": 38}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "52262016ef19", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        (address recovered, ECDSA.RecoverError error) = ECDSA.tryRecover(hash, signature);\n        if (error == ECDSA.RecoverError.NoError && recovered == signer) {\n            return true;\n        }\n\n        (bool success, bytes memory result) = signer.staticcall(\n            abi.encodeWithSelector(IERC1271.isValidSignature.selector, hash, signature)\n        );", "highlightLines": [30]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/SignatureChecker.sol", "line": 30, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "eb6048313846", "fix": {"template": null, "available": false}, "title": "External call result copied to memory - malicious contract can return huge data (return bomb)", "ruleId": "rules.sol-return-bomb", "snippet": {"code": "        (bool success, bytes memory result) = signer.staticcall(", "highlightLines": [35]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/SignatureChecker.sol", "line": 35, "column": 9}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#return-bomb"], "description": ""}, {"id": "af7c703ab0ff", "fix": {"template": null, "available": false}, "title": "ERC1271 signature check on arbitrary address - precompile contracts can return valid signatures", "ruleId": "rules.sol-erc1271-arbitrary-signer", "snippet": {"code": "        (bool success, bytes memory result) = signer.staticcall(\n            abi.encodeWithSelector(IERC1271.isValidSignature.selector, hash, signature)", "highlightLines": [35]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/SignatureChecker.sol", "line": 35, "column": 47}, "severity": "high", "references": [], "description": ""}, {"id": "e0337dc5a592", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "        (bool success, bytes memory result) = signer.staticcall(\n            abi.encodeWithSelector(IERC1271.isValidSignature.selector, hash, signature)", "highlightLines": [35]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/SignatureChecker.sol", "line": 35, "column": 47}, "severity": "medium", "references": [], "description": ""}, {"id": "7416c751ef32", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/draft-EIP712.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "fb0ea85eb660", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(string memory name, string memory version) {\n        bytes32 hashedName = keccak256(bytes(name));\n        bytes32 hashedVersion = keccak256(bytes(version));\n        bytes32 typeHash = keccak256(\n            \"EIP712Domain(string name,string version,uint256 chainId,address verifyingContract)\"\n        );\n        _HASHED_NAME = hashedName;\n        _HASHED_VERSION = hashedVersion;\n        _CACHED_CHAIN_ID = block.chainid;\n        _CACHED_DOMAIN_SEPARATOR = _buildDomainSeparator(typeHash, hashedName, hashedVersion);\n        _CACHED_THIS = address(this);\n        _TYPE_HASH = typeHash;\n    }", "highlightLines": [53]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/draft-EIP712.sol", "line": 53, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "8a72c7cf99a5", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 hashedName = keccak256(bytes(name));", "highlightLines": [54]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/draft-EIP712.sol", "line": 54, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7725591d97a4", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes32 hashedName = keccak256(bytes(name));\n        bytes32 hashedVersion = keccak256(bytes(version));", "highlightLines": [54]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/draft-EIP712.sol", "line": 54, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "fb27ed086b86", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 hashedVersion = keccak256(bytes(version));", "highlightLines": [55]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/draft-EIP712.sol", "line": 55, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "fcddda6a5209", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes32 hashedVersion = keccak256(bytes(version));\n        bytes32 typeHash = keccak256(\n            \"EIP712Domain(string name,string version,uint256 chainId,address verifyingContract)\"\n        );", "highlightLines": [55]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/draft-EIP712.sol", "line": 55, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "cf3c26fa6737", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 typeHash = keccak256(", "highlightLines": [56]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/draft-EIP712.sol", "line": 56, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b0feeda4b51a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes32 typeHash = keccak256(\n            \"EIP712Domain(string name,string version,uint256 chainId,address verifyingContract)\"\n        );\n        _HASHED_NAME = hashedName;", "highlightLines": [56]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/draft-EIP712.sol", "line": 56, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "86a8e0c29849", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        _HASHED_NAME = hashedName;\n        _HASHED_VERSION = hashedVersion;", "highlightLines": [59]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/draft-EIP712.sol", "line": 59, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "7ccd906c6441", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        _HASHED_VERSION = hashedVersion;\n        _CACHED_CHAIN_ID = block.chainid;", "highlightLines": [60]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/draft-EIP712.sol", "line": 60, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "41fcdc3fb59a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        _CACHED_CHAIN_ID = block.chainid;\n        _CACHED_DOMAIN_SEPARATOR = _buildDomainSeparator(typeHash, hashedName, hashedVersion);", "highlightLines": [61]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/draft-EIP712.sol", "line": 61, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "db7b63e898d4", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        _CACHED_DOMAIN_SEPARATOR = _buildDomainSeparator(typeHash, hashedName, hashedVersion);\n        _CACHED_THIS = address(this);", "highlightLines": [62]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/draft-EIP712.sol", "line": 62, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "a2b707887204", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        _CACHED_THIS = address(this);\n        _TYPE_HASH = typeHash;", "highlightLines": [63]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/draft-EIP712.sol", "line": 63, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "c2d83f0d8855", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "            return _buildDomainSeparator(_TYPE_HASH, _HASHED_NAME, _HASHED_VERSION);", "highlightLines": [74]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/cryptography/draft-EIP712.sol", "line": 74, "column": 47}, "severity": "info", "references": [], "description": ""}, {"id": "64b2075d8af5", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/escrow/ConditionalEscrow.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "e1aaf346a337", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function withdrawalAllowed(address payee) public view virtual returns (bool);", "highlightLines": [19]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/escrow/ConditionalEscrow.sol", "line": 19, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "2d306efb3c95", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function withdraw(address payable payee) public virtual override {", "highlightLines": [21]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/escrow/ConditionalEscrow.sol", "line": 21, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "130cf7608dc4", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/escrow/Escrow.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "0600bce21774", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract Escrow is Ownable {\n    using Address for address payable;", "highlightLines": [22]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/escrow/Escrow.sol", "line": 22, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "b14e88e296b1", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Deposited(address indexed payee, uint256 weiAmount);", "highlightLines": [25]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/escrow/Escrow.sol", "line": 25, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "1e3c85c804df", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Withdrawn(address indexed payee, uint256 weiAmount);", "highlightLines": [26]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/escrow/Escrow.sol", "line": 26, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "e01e82a4f4a7", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function deposit(address payee) public payable virtual onlyOwner {", "highlightLines": [40]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/escrow/Escrow.sol", "line": 40, "column": 60}, "severity": "info", "references": [], "description": ""}, {"id": "d63fa8c297b4", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 amount = msg.value;", "highlightLines": [41]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/escrow/Escrow.sol", "line": 41, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b91eb008e38a", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function withdraw(address payable payee) public virtual onlyOwner {", "highlightLines": [58]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/escrow/Escrow.sol", "line": 58, "column": 61}, "severity": "info", "references": [], "description": ""}, {"id": "eaef21371ac3", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 payment = _deposits[payee];", "highlightLines": [59]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/escrow/Escrow.sol", "line": 59, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "5b34d3b68d6b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 payment = _deposits[payee];\n\n        _deposits[payee] = 0;", "highlightLines": [59]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/escrow/Escrow.sol", "line": 59, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "2ecef8afa491", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/escrow/RefundEscrow.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "50dcd55203e0", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract RefundEscrow is ConditionalEscrow {\n    using Address for address payable;", "highlightLines": [18]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/escrow/RefundEscrow.sol", "line": 18, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "e8f25917ffa8", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(address payable beneficiary_) {\n        require(beneficiary_ != address(0), \"RefundEscrow: beneficiary is the zero address\");\n        _beneficiary = beneficiary_;\n        _state = State.Active;\n    }", "highlightLines": [37]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/escrow/RefundEscrow.sol", "line": 37, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "e45273fecb34", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        _beneficiary = beneficiary_;\n        _state = State.Active;", "highlightLines": [39]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/escrow/RefundEscrow.sol", "line": 39, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "c01b20605727", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function deposit(address refundee) public payable virtual override {", "highlightLines": [61]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/escrow/RefundEscrow.sol", "line": 61, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "2c55d660673f", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function close() public virtual onlyOwner {", "highlightLines": [70]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/escrow/RefundEscrow.sol", "line": 70, "column": 37}, "severity": "info", "references": [], "description": ""}, {"id": "0059bba9ba31", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function enableRefunds() public virtual onlyOwner {", "highlightLines": [79]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/escrow/RefundEscrow.sol", "line": 79, "column": 45}, "severity": "info", "references": [], "description": ""}, {"id": "734f7a90ba85", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/introspection/ERC165.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "a65b859da8d1", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": " * function supportsInterface(bytes4 interfaceId) public view virtual override returns (bool) {\n *     return interfaceId == type(MyInterface).interfaceId || super.supportsInterface(interfaceId);", "highlightLines": [15]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/introspection/ERC165.sol", "line": 15, "column": 4}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "bd8d40b56052", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "abstract contract ERC165 is IERC165 {", "highlightLines": [22]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/introspection/ERC165.sol", "line": 22, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "ae44a26606d5", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function supportsInterface(bytes4 interfaceId) public view virtual override returns (bool) {\n        return interfaceId == type(IERC165).interfaceId;", "highlightLines": [26]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/introspection/ERC165.sol", "line": 26, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "3cea17211117", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/introspection/ERC165Checker.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "a719de671952", "fix": {"template": null, "available": false}, "title": "Storage array passed by value to internal function - changes won't persist", "ruleId": "rules.sol-array-by-reference", "snippet": {"code": "    function getSupportedInterfaces(address account, bytes4[] memory interfaceIds)\n        internal", "highlightLines": [51]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/introspection/ERC165Checker.sol", "line": 51, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#modifying-storage-array-by-value"], "description": ""}, {"id": "72d09b57eb7f", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function getSupportedInterfaces(address account, bytes4[] memory interfaceIds)\n        internal\n        view\n        returns (bool[] memory)\n    {\n        // an array of booleans corresponding to interfaceIds and whether they're supported or not\n        bool[] memory interfaceIdsSupported = new bool[](interfaceIds.length);\n\n        // query support of ERC165 itself\n        if (supportsERC165(account)) {\n            // query support of each interface in interfaceIds\n            for (uint256 i = 0; i < interfaceIds.length; i++) {", "highlightLines": [51]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/introspection/ERC165Checker.sol", "line": 51, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "4d482833b7c0", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bool[] memory interfaceIdsSupported = new bool[](interfaceIds.length);\n\n        // query support of ERC165 itself\n        if (supportsERC165(account)) {\n            // query support of each interface in interfaceIds\n            for (uint256 i = 0; i < interfaceIds.length; i++) {\n                interfaceIdsSupported[i] = supportsERC165InterfaceUnchecked(account, interfaceIds[i]);\n            }\n        }", "highlightLines": [57]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/introspection/ERC165Checker.sol", "line": 57, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "bab25c4538c7", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        bool[] memory interfaceIdsSupported = new bool[](interfaceIds.length);", "highlightLines": [57]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/introspection/ERC165Checker.sol", "line": 57, "column": 47}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "448b5d2366d5", "fix": {"template": null, "available": false}, "title": "Storage variable modified in loop - should cache in memory for gas savings", "ruleId": "rules.sol-memory-vs-storage-loop", "snippet": {"code": "            for (uint256 i = 0; i < interfaceIds.length; i++) {\n                interfaceIdsSupported[i] = supportsERC165InterfaceUnchecked(account, interfaceIds[i]);", "highlightLines": [62]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/introspection/ERC165Checker.sol", "line": 62, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "bd7d9056e053", "fix": {"template": null, "available": false}, "title": "Storage array passed by value to internal function - changes won't persist", "ruleId": "rules.sol-array-by-reference", "snippet": {"code": "    function supportsAllInterfaces(address account, bytes4[] memory interfaceIds) internal view returns (bool) {", "highlightLines": [79]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/introspection/ERC165Checker.sol", "line": 79, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#modifying-storage-array-by-value"], "description": ""}, {"id": "730a6cb7198e", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function supportsERC165InterfaceUnchecked(address account, bytes4 interfaceId) internal view returns (bool) {\n        bytes memory encodedParams = abi.encodeWithSelector(IERC165.supportsInterface.selector, interfaceId);", "highlightLines": [107]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/introspection/ERC165Checker.sol", "line": 107, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "eed2f5141b9b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes memory encodedParams = abi.encodeWithSelector(IERC165.supportsInterface.selector, interfaceId);\n        (bool success, bytes memory result) = account.staticcall{gas: 30000}(encodedParams);", "highlightLines": [108]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/introspection/ERC165Checker.sol", "line": 108, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "cc42ec61f6ca", "fix": {"template": null, "available": false}, "title": "External call result copied to memory - malicious contract can return huge data (return bomb)", "ruleId": "rules.sol-return-bomb", "snippet": {"code": "        (bool success, bytes memory result) = account.staticcall{gas: 30000}(encodedParams);", "highlightLines": [109]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/introspection/ERC165Checker.sol", "line": 109, "column": 9}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#return-bomb"], "description": ""}, {"id": "7a7ad721bd9f", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "        if (result.length < 32) return false;\n        return success && abi.decode(result, (uint256)) > 0;", "highlightLines": [110]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/introspection/ERC165Checker.sol", "line": 110, "column": 33}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "192b95a28ba5", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/introspection/ERC165Storage.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "149eed26ef15", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/introspection/ERC1820Implementer.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "55a77ca1f17e", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "contract ERC1820Implementer is IERC1820Implementer {", "highlightLines": [16]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/introspection/ERC1820Implementer.sol", "line": 16, "column": 1}, "severity": "medium", "references": [], "description": ""}, {"id": "51d56802487b", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/introspection/IERC165.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "578acac5b06e", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/introspection/IERC1820Implementer.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "2b90211e4392", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/introspection/IERC1820Registry.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "266b7cc21730", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event InterfaceImplementerSet(address indexed account, bytes32 indexed interfaceHash, address indexed implementer);", "highlightLines": [21]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/introspection/IERC1820Registry.sol", "line": 21, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "6cc29da50f47", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event ManagerChanged(address indexed account, address indexed newManager);", "highlightLines": [23]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/introspection/IERC1820Registry.sol", "line": 23, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "ef0e9f0074c8", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function setManager(address account, address newManager) external;", "highlightLines": [38]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/introspection/IERC1820Registry.sol", "line": 38, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "4b84df60719e", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function getManager(address account) external view returns (address);", "highlightLines": [45]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/introspection/IERC1820Registry.sol", "line": 45, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "aa0d7d733d97", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function setInterfaceImplementer(\n        address account,\n        bytes32 _interfaceHash,\n        address implementer\n    ) external;", "highlightLines": [67]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/introspection/IERC1820Registry.sol", "line": 67, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "9f56fee8d901", "fix": {"template": null, "available": false}, "title": "Storage write without access control - arbitrary data manipulation", "ruleId": "rules.sol-unprotected-storage-write", "snippet": {"code": "    function setInterfaceImplementer(\n        address account,\n        bytes32 _interfaceHash,\n        address implementer\n    ) external;\n\n    /**\n     * @dev Returns the implementer of `interfaceHash` for `account`. If no such\n     * implementer is registered, returns the zero address.\n     *\n     * If `interfaceHash` is an {IERC165} interface id (i.e. it ends with 28", "highlightLines": [67]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/introspection/IERC1820Registry.sol", "line": 67, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "130cfad218de", "fix": {"template": null, "available": false}, "title": "ERC1820 registry hook registration - can enable reentrancy via token hooks", "ruleId": "rules.sol-erc1820-registry-hook", "snippet": {"code": "    function setInterfaceImplementer(", "highlightLines": [67]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/introspection/IERC1820Registry.sol", "line": 67, "column": 14}, "severity": "medium", "references": [], "description": ""}, {"id": "e48449469fa9", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function getInterfaceImplementer(address account, bytes32 _interfaceHash) external view returns (address);", "highlightLines": [82]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/introspection/IERC1820Registry.sol", "line": 82, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "d7bf221f4b06", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function updateERC165Cache(address account, bytes4 interfaceId) external;", "highlightLines": [96]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/introspection/IERC1820Registry.sol", "line": 96, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "7add617a673d", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function implementsERC165Interface(address account, bytes4 interfaceId) external view returns (bool);", "highlightLines": [107]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/introspection/IERC1820Registry.sol", "line": 107, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "32fd3e2805d6", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function implementsERC165InterfaceNoCache(address account, bytes4 interfaceId) external view returns (bool);", "highlightLines": [115]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/introspection/IERC1820Registry.sol", "line": 115, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "64fb3402ea35", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "0302b7868e87", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "        return (a & b) + (a ^ b) / 2;", "highlightLines": [36]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 36, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "78db22d8bdbe", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function ceilDiv(uint256 a, uint256 b) internal pure returns (uint256) {\n        // (a + b - 1) / b can overflow on addition, so we distribute.\n        return a == 0 ? 0 : (a - 1) / b + 1;", "highlightLines": [45]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 45, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "ccd01387bafe", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function mulDiv(\n        uint256 x,\n        uint256 y,\n        uint256 denominator\n    ) internal pure returns (uint256 result) {\n        unchecked {\n            // 512-bit multiply [prod1 prod0] = x * y. Compute the product mod 2^256 and mod 2^256 - 1, then use\n            // use the Chinese Remainder Theorem to reconstruct the 512 bit result. The result is stored in two 256\n            // variables such that product = prod1 * 2^256 + prod0.", "highlightLines": [55]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 55, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "1de73d2a88f3", "fix": {"template": null, "available": false}, "title": "View/pure function uses assembly - may modify state unexpectedly", "ruleId": "rules.sol-constant-function-assembly", "snippet": {"code": "    function mulDiv(\n        uint256 x,\n        uint256 y,\n        uint256 denominator\n    ) internal pure returns (uint256 result) {\n        unchecked {\n            // 512-bit multiply [prod1 prod0] = x * y. Compute the product mod 2^256 and mod 2^256 - 1, then use\n            // use the Chinese Remainder Theorem to reconstruct the 512 bit result. The result is stored in two 256\n            // variables such that product = prod1 * 2^256 + prod0.\n            uint256 prod0; // Least significant 256 bits of the product\n            uint256 prod1; // Most significant 256 bits of the product\n            assembly {", "highlightLines": [55]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 55, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-using-assembly-code"], "description": ""}, {"id": "ffef2b47ddf0", "fix": {"template": null, "available": false}, "title": "Possible incorrect exponentiation - ^ is XOR in Solidity, use ** for power", "ruleId": "rules.sol-incorrect-exponentiation", "snippet": {"code": "            // 512-bit multiply [prod1 prod0] = x * y. Compute the product mod 2^256 and mod 2^256 - 1, then use", "highlightLines": [61]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 61, "column": 80}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-exponentiation"], "description": ""}, {"id": "7c9cca6cf8a1", "fix": {"template": null, "available": false}, "title": "Possible incorrect exponentiation - ^ is XOR in Solidity, use ** for power", "ruleId": "rules.sol-incorrect-exponentiation", "snippet": {"code": "            // variables such that product = prod1 * 2^256 + prod0.", "highlightLines": [63]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 63, "column": 54}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-exponentiation"], "description": ""}, {"id": "efc2a461a09d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint256 prod0; // Least significant 256 bits of the product", "highlightLines": [64]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 64, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d4da8cd3eb15", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint256 prod1; // Most significant 256 bits of the product", "highlightLines": [65]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 65, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "9c07b4218acc", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "            assembly {", "highlightLines": [66]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 66, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "ad7ba9c22c98", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "                let mm := mulmod(x, y, not(0))\n                prod0 := mul(x, y)", "highlightLines": [67]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 67, "column": 21}, "severity": "medium", "references": [], "description": ""}, {"id": "5564bf81024d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "                prod0 := mul(x, y)\n                prod1 := sub(sub(mm, prod0), lt(mm, prod0))", "highlightLines": [68]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 68, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "3c2bcf2f6da4", "fix": {"template": null, "available": false}, "title": "Possible incorrect exponentiation - ^ is XOR in Solidity, use ** for power", "ruleId": "rules.sol-incorrect-exponentiation", "snippet": {"code": "            // Make sure the result is less than 2^256. Also prevents denominator == 0.", "highlightLines": [77]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 77, "column": 50}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-exponentiation"], "description": ""}, {"id": "c552c2a35c8e", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "            require(denominator > prod1);", "highlightLines": [78]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 78, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "470b2ef17bfe", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint256 remainder;", "highlightLines": [85]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 85, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "14cfadb50a20", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "            assembly {", "highlightLines": [86]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 86, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "5c3ad47aaf37", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "                remainder := mulmod(x, y, denominator)\n\n                // Subtract 256 bit number from 512 bit number.\n                prod1 := sub(prod1, gt(remainder, prod0))", "highlightLines": [88]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 88, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "6bd6b298f55e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "                prod1 := sub(prod1, gt(remainder, prod0))\n                prod0 := sub(prod0, remainder)", "highlightLines": [91]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 91, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "5a02c109f10e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint256 twos = denominator & (~denominator + 1);", "highlightLines": [99]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 99, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "9434c4736920", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            uint256 twos = denominator & (~denominator + 1);\n            assembly {\n                // Divide denominator by twos.\n                denominator := div(denominator, twos)\n\n                // Divide [prod1 prod0] by twos.\n                prod0 := div(prod0, twos)\n\n                // Flip twos such that it is 2^256 / twos. If twos is zero, then it becomes one.\n                twos := add(div(sub(0, twos), twos), 1)\n            }", "highlightLines": [99]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 99, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "7d8e469e3728", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "            uint256 twos = denominator & (~denominator + 1);", "highlightLines": [99]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 99, "column": 28}, "severity": "medium", "references": [], "description": ""}, {"id": "2b04a36ae6a6", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "            uint256 twos = denominator & (~denominator + 1);", "highlightLines": [99]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 99, "column": 43}, "severity": "medium", "references": [], "description": ""}, {"id": "48f3d235f960", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "            assembly {", "highlightLines": [100]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 100, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "7c5f01fc6ca2", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "                denominator := div(denominator, twos)\n\n                // Divide [prod1 prod0] by twos.\n                prod0 := div(prod0, twos)", "highlightLines": [102]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 102, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "2a605621d613", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "                prod0 := div(prod0, twos)\n\n                // Flip twos such that it is 2^256 / twos. If twos is zero, then it becomes one.\n                twos := add(div(sub(0, twos), twos), 1)", "highlightLines": [105]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 105, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "a10706f830fa", "fix": {"template": null, "available": false}, "title": "Possible incorrect exponentiation - ^ is XOR in Solidity, use ** for power", "ruleId": "rules.sol-incorrect-exponentiation", "snippet": {"code": "                // Flip twos such that it is 2^256 / twos. If twos is zero, then it becomes one.", "highlightLines": [107]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 107, "column": 46}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-exponentiation"], "description": ""}, {"id": "1dfac0dd7806", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "            prod0 |= prod1 * twos;", "highlightLines": [112]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 112, "column": 22}, "severity": "medium", "references": [], "description": ""}, {"id": "f00f7055c453", "fix": {"template": null, "available": false}, "title": "Possible incorrect exponentiation - ^ is XOR in Solidity, use ** for power", "ruleId": "rules.sol-incorrect-exponentiation", "snippet": {"code": "            // Invert denominator mod 2^256. Now that denominator is an odd number, it has an inverse modulo 2^256 such", "highlightLines": [114]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 114, "column": 39}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-exponentiation"], "description": ""}, {"id": "7f6ff38dc4c4", "fix": {"template": null, "available": false}, "title": "Possible incorrect exponentiation - ^ is XOR in Solidity, use ** for power", "ruleId": "rules.sol-incorrect-exponentiation", "snippet": {"code": "            // that denominator * inv = 1 mod 2^256. Compute the inverse by starting with a seed that is correct for", "highlightLines": [115]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 115, "column": 47}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-exponentiation"], "description": ""}, {"id": "eb665249f753", "fix": {"template": null, "available": false}, "title": "Possible incorrect exponentiation - ^ is XOR in Solidity, use ** for power", "ruleId": "rules.sol-incorrect-exponentiation", "snippet": {"code": "            // four bits. That is, denominator * inv = 1 mod 2^4.", "highlightLines": [116]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 116, "column": 62}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-exponentiation"], "description": ""}, {"id": "f9efbc7ebe95", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint256 inverse = (3 * denominator) ^ 2;", "highlightLines": [117]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 117, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "71c2304b8b5e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            uint256 inverse = (3 * denominator) ^ 2;\n\n            // Use the Newton-Raphson iteration to improve the precision. Thanks to Hensel's lifting lemma, this also works\n            // in modular arithmetic, doubling the correct bits in each step.\n            inverse *= 2 - denominator * inverse; // inverse mod 2^8\n            inverse *= 2 - denominator * inverse; // inverse mod 2^16\n            inverse *= 2 - denominator * inverse; // inverse mod 2^32\n            inverse *= 2 - denominator * inverse; // inverse mod 2^64\n            inverse *= 2 - denominator * inverse; // inverse mod 2^128\n            inverse *= 2 - denominator * inverse; // inverse mod 2^256\n\n            // Because the division is now exact we can divide by multiplying with the modular inverse of denominator.\n            // This will give us the correct result modulo 2^256. Since the preconditions guarantee that the outcome is\n            // less than 2^256, this is the final result. We don't need to compute the high bits of the result and prod1\n            // is no longer required.\n            result = prod0 * inverse;", "highlightLines": [117]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 117, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "d6074a6e1c13", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "            uint256 inverse = (3 * denominator) ^ 2;", "highlightLines": [117]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 117, "column": 32}, "severity": "medium", "references": [], "description": ""}, {"id": "7032f2fd16c9", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "            inverse *= 2 - denominator * inverse; // inverse mod 2^8", "highlightLines": [121]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 121, "column": 24}, "severity": "medium", "references": [], "description": ""}, {"id": "383dacc6824f", "fix": {"template": null, "available": false}, "title": "Possible incorrect exponentiation - ^ is XOR in Solidity, use ** for power", "ruleId": "rules.sol-incorrect-exponentiation", "snippet": {"code": "            inverse *= 2 - denominator * inverse; // inverse mod 2^8", "highlightLines": [121]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 121, "column": 66}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-exponentiation"], "description": ""}, {"id": "ac5fb6aae0c4", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "            inverse *= 2 - denominator * inverse; // inverse mod 2^16", "highlightLines": [122]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 122, "column": 24}, "severity": "medium", "references": [], "description": ""}, {"id": "652c5e8cf485", "fix": {"template": null, "available": false}, "title": "Possible incorrect exponentiation - ^ is XOR in Solidity, use ** for power", "ruleId": "rules.sol-incorrect-exponentiation", "snippet": {"code": "            inverse *= 2 - denominator * inverse; // inverse mod 2^16", "highlightLines": [122]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 122, "column": 66}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-exponentiation"], "description": ""}, {"id": "e08caf1b078f", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "            inverse *= 2 - denominator * inverse; // inverse mod 2^32", "highlightLines": [123]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 123, "column": 24}, "severity": "medium", "references": [], "description": ""}, {"id": "17b1fa381100", "fix": {"template": null, "available": false}, "title": "Possible incorrect exponentiation - ^ is XOR in Solidity, use ** for power", "ruleId": "rules.sol-incorrect-exponentiation", "snippet": {"code": "            inverse *= 2 - denominator * inverse; // inverse mod 2^32", "highlightLines": [123]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 123, "column": 66}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-exponentiation"], "description": ""}, {"id": "4046784e2fa6", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "            inverse *= 2 - denominator * inverse; // inverse mod 2^64", "highlightLines": [124]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 124, "column": 24}, "severity": "medium", "references": [], "description": ""}, {"id": "e9d7ebc55d3a", "fix": {"template": null, "available": false}, "title": "Possible incorrect exponentiation - ^ is XOR in Solidity, use ** for power", "ruleId": "rules.sol-incorrect-exponentiation", "snippet": {"code": "            inverse *= 2 - denominator * inverse; // inverse mod 2^64", "highlightLines": [124]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 124, "column": 66}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-exponentiation"], "description": ""}, {"id": "0879735162fa", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "            inverse *= 2 - denominator * inverse; // inverse mod 2^128", "highlightLines": [125]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 125, "column": 24}, "severity": "medium", "references": [], "description": ""}, {"id": "bddf2cc26c58", "fix": {"template": null, "available": false}, "title": "Possible incorrect exponentiation - ^ is XOR in Solidity, use ** for power", "ruleId": "rules.sol-incorrect-exponentiation", "snippet": {"code": "            inverse *= 2 - denominator * inverse; // inverse mod 2^128", "highlightLines": [125]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 125, "column": 66}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-exponentiation"], "description": ""}, {"id": "a57d9e200b76", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "            inverse *= 2 - denominator * inverse; // inverse mod 2^256", "highlightLines": [126]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 126, "column": 24}, "severity": "medium", "references": [], "description": ""}, {"id": "219b1e2714ff", "fix": {"template": null, "available": false}, "title": "Possible incorrect exponentiation - ^ is XOR in Solidity, use ** for power", "ruleId": "rules.sol-incorrect-exponentiation", "snippet": {"code": "            inverse *= 2 - denominator * inverse; // inverse mod 2^256", "highlightLines": [126]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 126, "column": 66}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-exponentiation"], "description": ""}, {"id": "42a0276d5e49", "fix": {"template": null, "available": false}, "title": "Possible incorrect exponentiation - ^ is XOR in Solidity, use ** for power", "ruleId": "rules.sol-incorrect-exponentiation", "snippet": {"code": "            // This will give us the correct result modulo 2^256. Since the preconditions guarantee that the outcome is", "highlightLines": [129]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 129, "column": 60}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-exponentiation"], "description": ""}, {"id": "f74677451d45", "fix": {"template": null, "available": false}, "title": "Possible incorrect exponentiation - ^ is XOR in Solidity, use ** for power", "ruleId": "rules.sol-incorrect-exponentiation", "snippet": {"code": "            // less than 2^256, this is the final result. We don't need to compute the high bits of the result and prod1", "highlightLines": [130]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 130, "column": 26}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-exponentiation"], "description": ""}, {"id": "3067c112cb2a", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "            result = prod0 * inverse;", "highlightLines": [132]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 132, "column": 22}, "severity": "medium", "references": [], "description": ""}, {"id": "ba1f7c8ebae1", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function mulDiv(\n        uint256 x,\n        uint256 y,\n        uint256 denominator,\n        Rounding rounding\n    ) internal pure returns (uint256) {\n        uint256 result = mulDiv(x, y, denominator);", "highlightLines": [140]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 140, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "312f1f67a514", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function mulDiv(\n        uint256 x,\n        uint256 y,\n        uint256 denominator,\n        Rounding rounding\n    ) internal pure returns (uint256) {\n        uint256 result = mulDiv(x, y, denominator);\n        if (rounding == Rounding.Up && mulmod(x, y, denominator) > 0) {", "highlightLines": [140]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 140, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "0a9f332b126a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 result = mulDiv(x, y, denominator);", "highlightLines": [146]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 146, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d3625a3f7536", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function sqrt(uint256 a) internal pure returns (uint256) {\n        if (a == 0) {", "highlightLines": [158]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 158, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "dc84e9d9142f", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 result = 1;", "highlightLines": [170]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 170, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "116d7a1d8209", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 result = 1;\n        uint256 x = a;", "highlightLines": [170]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 170, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "ae9e5ef39c52", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 x = a;", "highlightLines": [171]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 171, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0754bc76c60e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 x = a;\n        if (x >> 128 > 0) {\n            x >>= 128;\n            result <<= 64;\n        }\n        if (x >> 64 > 0) {\n            x >>= 64;\n            result <<= 32;\n        }\n        if (x >> 32 > 0) {\n            x >>= 32;\n            result <<= 16;\n        }\n        if (x >> 16 > 0) {\n            x >>= 16;\n            result <<= 8;\n        }\n        if (x >> 8 > 0) {\n            x >>= 8;\n            result <<= 4;\n        }\n        if (x >> 4 > 0) {\n            x >>= 4;\n            result <<= 2;\n        }\n        if (x >> 2 > 0) {\n            result <<= 1;\n        }\n\n        // At this point `result` is an estimation with one bit of precision. We know the true value is a uint128,\n        // since it is the square root of a uint256. Newton's method converges quadratically (precision doubles at\n        // every iteration). We thus need at most 7 iteration to turn our partial result with one bit of precision\n        // into the expected uint128 result.\n        unchecked {\n            result = (result + a / result) >> 1;\n            result = (result + a / result) >> 1;\n            result = (result + a / result) >> 1;\n            result = (result + a / result) >> 1;\n            result = (result + a / result) >> 1;\n            result = (result + a / result) >> 1;\n            result = (result + a / result) >> 1;\n            return min(result, a / result);\n        }", "highlightLines": [171]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 171, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "5d1b8aff36e4", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "        if (x >> 128 > 0) {", "highlightLines": [172]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 172, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "787ca230918d", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "        if (x >> 64 > 0) {", "highlightLines": [176]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 176, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "f3854b3a525d", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "        if (x >> 32 > 0) {", "highlightLines": [180]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 180, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "84deeb7b53ae", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "        if (x >> 16 > 0) {", "highlightLines": [184]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 184, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "aff156df30ae", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "        if (x >> 8 > 0) {", "highlightLines": [188]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 188, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "c562792cc0b9", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "        if (x >> 4 > 0) {", "highlightLines": [192]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 192, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "c6fd471aae2a", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "        if (x >> 2 > 0) {", "highlightLines": [196]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 196, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "3c69071dd8d8", "fix": {"template": null, "available": false}, "title": "Variable written twice without being read between - first write is dead store", "ruleId": "rules.sol-write-after-write", "snippet": {"code": "            result = (result + a / result) >> 1;\n            result = (result + a / result) >> 1;", "highlightLines": [205]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 205, "column": 13}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#write-after-write"], "description": ""}, {"id": "2ded2046bc36", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            result = (result + a / result) >> 1;\n            result = (result + a / result) >> 1;", "highlightLines": [205]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 205, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "1711b01a758f", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "            result = (result + a / result) >> 1;", "highlightLines": [205]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 205, "column": 23}, "severity": "medium", "references": [], "description": ""}, {"id": "b8c0758355e0", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "            result = (result + a / result) >> 1;", "highlightLines": [205]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 205, "column": 23}, "severity": "medium", "references": [], "description": ""}, {"id": "2e68b2187bfe", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            result = (result + a / result) >> 1;\n            result = (result + a / result) >> 1;", "highlightLines": [206]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 206, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "7a36aec3067f", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "            result = (result + a / result) >> 1;", "highlightLines": [206]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 206, "column": 23}, "severity": "medium", "references": [], "description": ""}, {"id": "eed5267162c3", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "            result = (result + a / result) >> 1;", "highlightLines": [206]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 206, "column": 23}, "severity": "medium", "references": [], "description": ""}, {"id": "af6fa6795907", "fix": {"template": null, "available": false}, "title": "Variable written twice without being read between - first write is dead store", "ruleId": "rules.sol-write-after-write", "snippet": {"code": "            result = (result + a / result) >> 1;\n            result = (result + a / result) >> 1;", "highlightLines": [207]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 207, "column": 13}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#write-after-write"], "description": ""}, {"id": "9cf4123f2496", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            result = (result + a / result) >> 1;\n            result = (result + a / result) >> 1;", "highlightLines": [207]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 207, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "92d7806663ef", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "            result = (result + a / result) >> 1;", "highlightLines": [207]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 207, "column": 23}, "severity": "medium", "references": [], "description": ""}, {"id": "658ac8de3559", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "            result = (result + a / result) >> 1;", "highlightLines": [207]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 207, "column": 23}, "severity": "medium", "references": [], "description": ""}, {"id": "1e6eba7faa64", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            result = (result + a / result) >> 1;\n            result = (result + a / result) >> 1;", "highlightLines": [208]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 208, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "2e1861593c8e", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "            result = (result + a / result) >> 1;", "highlightLines": [208]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 208, "column": 23}, "severity": "medium", "references": [], "description": ""}, {"id": "c7279fc7df99", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "            result = (result + a / result) >> 1;", "highlightLines": [208]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 208, "column": 23}, "severity": "medium", "references": [], "description": ""}, {"id": "3811010106d0", "fix": {"template": null, "available": false}, "title": "Variable written twice without being read between - first write is dead store", "ruleId": "rules.sol-write-after-write", "snippet": {"code": "            result = (result + a / result) >> 1;\n            result = (result + a / result) >> 1;", "highlightLines": [209]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 209, "column": 13}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#write-after-write"], "description": ""}, {"id": "b4ecfc896f1f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            result = (result + a / result) >> 1;\n            result = (result + a / result) >> 1;", "highlightLines": [209]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 209, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "27b135fc4a94", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "            result = (result + a / result) >> 1;", "highlightLines": [209]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 209, "column": 23}, "severity": "medium", "references": [], "description": ""}, {"id": "176c2c201f00", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "            result = (result + a / result) >> 1;", "highlightLines": [209]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 209, "column": 23}, "severity": "medium", "references": [], "description": ""}, {"id": "fc4426f06c74", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            result = (result + a / result) >> 1;\n            result = (result + a / result) >> 1;", "highlightLines": [210]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 210, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "5df532d26d00", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "            result = (result + a / result) >> 1;", "highlightLines": [210]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 210, "column": 23}, "severity": "medium", "references": [], "description": ""}, {"id": "c0354802f415", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "            result = (result + a / result) >> 1;", "highlightLines": [210]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 210, "column": 23}, "severity": "medium", "references": [], "description": ""}, {"id": "5b3af5549cb0", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "            result = (result + a / result) >> 1;", "highlightLines": [211]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 211, "column": 23}, "severity": "medium", "references": [], "description": ""}, {"id": "1e52b520daa5", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "            result = (result + a / result) >> 1;", "highlightLines": [211]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 211, "column": 23}, "severity": "medium", "references": [], "description": ""}, {"id": "877b008ca288", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function sqrt(uint256 a, Rounding rounding) internal pure returns (uint256) {\n        uint256 result = sqrt(a);", "highlightLines": [219]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 219, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "bd0bdf24ca65", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function sqrt(uint256 a, Rounding rounding) internal pure returns (uint256) {\n        uint256 result = sqrt(a);\n        if (rounding == Rounding.Up && result * result < a) {", "highlightLines": [219]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 219, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "83068eeed367", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 result = sqrt(a);", "highlightLines": [220]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/Math.sol", "line": 220, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "44e3e87f8275", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/SafeCast.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "e6dfa429df71", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "    function toUint128(uint256 value) internal pure returns (uint128) {", "highlightLines": [289]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/SafeCast.sol", "line": 289, "column": 17}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "3d825ac2d14d", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        return uint128(value);", "highlightLines": [291]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/SafeCast.sol", "line": 291, "column": 16}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "fc9e6a849e7c", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        return uint96(value);", "highlightLines": [359]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/SafeCast.sol", "line": 359, "column": 16}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "22370130376b", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "    function toUint64(uint256 value) internal pure returns (uint64) {", "highlightLines": [425]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/SafeCast.sol", "line": 425, "column": 17}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "6de98436b853", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        return uint64(value);", "highlightLines": [427]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/SafeCast.sol", "line": 427, "column": 16}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "95ecc3b229c2", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "    function toUint32(uint256 value) internal pure returns (uint32) {", "highlightLines": [493]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/SafeCast.sol", "line": 493, "column": 17}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "2973ae70b421", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        return uint32(value);", "highlightLines": [495]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/SafeCast.sol", "line": 495, "column": 16}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "153cc4345dbe", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "    function toUint16(uint256 value) internal pure returns (uint16) {", "highlightLines": [527]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/SafeCast.sol", "line": 527, "column": 17}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "59836affbd16", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        return uint16(value);", "highlightLines": [529]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/SafeCast.sol", "line": 529, "column": 16}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "3e2473fb501c", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "    function toUint8(uint256 value) internal pure returns (uint8) {", "highlightLines": [544]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/SafeCast.sol", "line": 544, "column": 17}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "9c6addd43dbc", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        return uint8(value);", "highlightLines": [546]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/SafeCast.sol", "line": 546, "column": 16}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "4d7ec6d250f9", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        return int128(value);", "highlightLines": [848]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/SafeCast.sol", "line": 848, "column": 16}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "847ed00f8a6d", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        return int64(value);", "highlightLines": [992]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/SafeCast.sol", "line": 992, "column": 16}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "4554d41f32f9", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        return int32(value);", "highlightLines": [1064]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/SafeCast.sol", "line": 1064, "column": 16}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "0a0a5b6cb3e3", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        return int16(value);", "highlightLines": [1100]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/SafeCast.sol", "line": 1100, "column": 16}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "b2723369566f", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        return int8(value);", "highlightLines": [1118]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/SafeCast.sol", "line": 1118, "column": 16}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "d18fbfc4c595", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/SafeMath.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "38c15ba6b524", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function tryAdd(uint256 a, uint256 b) internal pure returns (bool, uint256) {\n        unchecked {\n            uint256 c = a + b;", "highlightLines": [22]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/SafeMath.sol", "line": 22, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "64fbc4a25fac", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint256 c = a + b;", "highlightLines": [24]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/SafeMath.sol", "line": 24, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b20935eda578", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "            uint256 c = a + b;", "highlightLines": [24]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/SafeMath.sol", "line": 24, "column": 25}, "severity": "medium", "references": [], "description": ""}, {"id": "dcf894862d5b", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "            if (c < a) return (false, 0);\n            return (true, c);", "highlightLines": [25]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/SafeMath.sol", "line": 25, "column": 24}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "0bc433861bc4", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "            if (b > a) return (false, 0);\n            return (true, a - b);", "highlightLines": [37]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/SafeMath.sol", "line": 37, "column": 24}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "29daf3ec6bb1", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "            return (true, a - b);", "highlightLines": [38]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/SafeMath.sol", "line": 38, "column": 27}, "severity": "medium", "references": [], "description": ""}, {"id": "46079084927c", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function tryMul(uint256 a, uint256 b) internal pure returns (bool, uint256) {\n        unchecked {\n            // Gas optimization: this is cheaper than requiring 'a' not being zero, but the\n            // benefit is lost if 'b' is also tested.\n            // See: https://github.com/OpenZeppelin/openzeppelin-contracts/pull/522\n            if (a == 0) return (true, 0);", "highlightLines": [47]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/SafeMath.sol", "line": 47, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "ddf9ea12bace", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function tryMul(uint256 a, uint256 b) internal pure returns (bool, uint256) {\n        unchecked {\n            // Gas optimization: this is cheaper than requiring 'a' not being zero, but the\n            // benefit is lost if 'b' is also tested.\n            // See: https://github.com/OpenZeppelin/openzeppelin-contracts/pull/522\n            if (a == 0) return (true, 0);\n            uint256 c = a * b;", "highlightLines": [47]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/SafeMath.sol", "line": 47, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "a90794bc3cdf", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "            if (a == 0) return (true, 0);\n            uint256 c = a * b;", "highlightLines": [52]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/SafeMath.sol", "line": 52, "column": 25}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "6f9d9d6a0316", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint256 c = a * b;", "highlightLines": [53]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/SafeMath.sol", "line": 53, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "48cd66f33000", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "            uint256 c = a * b;", "highlightLines": [53]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/SafeMath.sol", "line": 53, "column": 25}, "severity": "medium", "references": [], "description": ""}, {"id": "ceb99218342f", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "            if (c / a != b) return (false, 0);\n            return (true, c);", "highlightLines": [54]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/SafeMath.sol", "line": 54, "column": 29}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "6de6b5b04414", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function tryDiv(uint256 a, uint256 b) internal pure returns (bool, uint256) {\n        unchecked {\n            if (b == 0) return (false, 0);", "highlightLines": [64]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/SafeMath.sol", "line": 64, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "6aafd0cf7ef0", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "            if (b == 0) return (false, 0);\n            return (true, a / b);", "highlightLines": [66]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/SafeMath.sol", "line": 66, "column": 25}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "e61d05f9b9e1", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function tryMod(uint256 a, uint256 b) internal pure returns (bool, uint256) {\n        unchecked {\n            if (b == 0) return (false, 0);", "highlightLines": [76]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/SafeMath.sol", "line": 76, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "5603b9dab404", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "            if (b == 0) return (false, 0);\n            return (true, a % b);", "highlightLines": [78]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/SafeMath.sol", "line": 78, "column": 25}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "d105e5af0174", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "            return a - b;", "highlightLines": [175]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/SafeMath.sol", "line": 175, "column": 20}, "severity": "medium", "references": [], "description": ""}, {"id": "171791470517", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/SignedMath.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "fb87dc4b0e1a", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function average(int256 a, int256 b) internal pure returns (int256) {\n        // Formula from the book \"Hacker's Delight\"\n        int256 x = (a & b) + ((a ^ b) >> 1);", "highlightLines": [28]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/SignedMath.sol", "line": 28, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "1209b1eb7359", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        int256 x = (a & b) + ((a ^ b) >> 1);", "highlightLines": [30]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/SignedMath.sol", "line": 30, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "6a1da84b28bc", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "        int256 x = (a & b) + ((a ^ b) >> 1);", "highlightLines": [30]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/SignedMath.sol", "line": 30, "column": 21}, "severity": "medium", "references": [], "description": ""}, {"id": "29d018424ec6", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "        return x + (int256(uint256(x) >> 255) & (a ^ b));", "highlightLines": [31]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/SignedMath.sol", "line": 31, "column": 21}, "severity": "medium", "references": [], "description": ""}, {"id": "fad31854cebc", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function abs(int256 n) internal pure returns (uint256) {\n        unchecked {\n            // must be unchecked in order to support `n = type(int256).min`", "highlightLines": [37]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/SignedMath.sol", "line": 37, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "6ce9952fdfed", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function abs(int256 n) internal pure returns (uint256) {\n        unchecked {\n            // must be unchecked in order to support `n = type(int256).min`", "highlightLines": [37]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/SignedMath.sol", "line": 37, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "dc526ceef8ab", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/math/SignedSafeMath.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "c6528fd5c680", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/BitMaps.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "da3acd1caf75", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function get(BitMap storage bitmap, uint256 index) internal view returns (bool) {\n        uint256 bucket = index >> 8;\n        uint256 mask = 1 << (index & 0xff);", "highlightLines": [17]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/BitMaps.sol", "line": 17, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "3caa2d48080d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 bucket = index >> 8;", "highlightLines": [18]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/BitMaps.sol", "line": 18, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "32071dff0aed", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 bucket = index >> 8;\n        uint256 mask = 1 << (index & 0xff);", "highlightLines": [18]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/BitMaps.sol", "line": 18, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "f56f072a24e4", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "        uint256 bucket = index >> 8;", "highlightLines": [18]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/BitMaps.sol", "line": 18, "column": 26}, "severity": "medium", "references": [], "description": ""}, {"id": "29f1162ed096", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 mask = 1 << (index & 0xff);", "highlightLines": [19]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/BitMaps.sol", "line": 19, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "53dd07b7793d", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "        uint256 mask = 1 << (index & 0xff);", "highlightLines": [19]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/BitMaps.sol", "line": 19, "column": 24}, "severity": "medium", "references": [], "description": ""}, {"id": "c097fe9aa3f4", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "        return bitmap._data[bucket] & mask != 0;", "highlightLines": [20]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/BitMaps.sol", "line": 20, "column": 16}, "severity": "medium", "references": [], "description": ""}, {"id": "d6e5e66bcace", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 bucket = index >> 8;", "highlightLines": [42]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/BitMaps.sol", "line": 42, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "9b205b768541", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 bucket = index >> 8;\n        uint256 mask = 1 << (index & 0xff);", "highlightLines": [42]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/BitMaps.sol", "line": 42, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "98b37e54f2b0", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "        uint256 bucket = index >> 8;", "highlightLines": [42]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/BitMaps.sol", "line": 42, "column": 26}, "severity": "medium", "references": [], "description": ""}, {"id": "7f6913d34016", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 mask = 1 << (index & 0xff);", "highlightLines": [43]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/BitMaps.sol", "line": 43, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c5fa82a673c0", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "        uint256 mask = 1 << (index & 0xff);", "highlightLines": [43]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/BitMaps.sol", "line": 43, "column": 24}, "severity": "medium", "references": [], "description": ""}, {"id": "8183944b0ec2", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 bucket = index >> 8;", "highlightLines": [51]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/BitMaps.sol", "line": 51, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "27f92b536a7b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 bucket = index >> 8;\n        uint256 mask = 1 << (index & 0xff);", "highlightLines": [51]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/BitMaps.sol", "line": 51, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "2e34f96c3ccc", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "        uint256 bucket = index >> 8;", "highlightLines": [51]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/BitMaps.sol", "line": 51, "column": 26}, "severity": "medium", "references": [], "description": ""}, {"id": "bd98786cf81b", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 mask = 1 << (index & 0xff);", "highlightLines": [52]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/BitMaps.sol", "line": 52, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "6131c855f95f", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "        uint256 mask = 1 << (index & 0xff);", "highlightLines": [52]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/BitMaps.sol", "line": 52, "column": 24}, "severity": "medium", "references": [], "description": ""}, {"id": "834ff58cc7dc", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.4;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/DoubleEndedQueue.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "0c7198eeb6fd", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        int128 _begin;", "highlightLines": [45]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/DoubleEndedQueue.sol", "line": 45, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "9f7b4e81e957", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        int128 _end;", "highlightLines": [46]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/DoubleEndedQueue.sol", "line": 46, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "13932607116a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        int128 backIndex = deque._end;", "highlightLines": [54]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/DoubleEndedQueue.sol", "line": 54, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d70cae90d5d2", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        int128 backIndex = deque._end;\n        deque._data[backIndex] = value;", "highlightLines": [54]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/DoubleEndedQueue.sol", "line": 54, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "9ebd9254e1c7", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        deque._data[backIndex] = value;\n        unchecked {\n            deque._end = backIndex + 1;\n        }", "highlightLines": [55]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/DoubleEndedQueue.sol", "line": 55, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d2dd995d6654", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "            deque._end = backIndex + 1;", "highlightLines": [57]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/DoubleEndedQueue.sol", "line": 57, "column": 26}, "severity": "medium", "references": [], "description": ""}, {"id": "d76ca5645004", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        int128 backIndex;", "highlightLines": [68]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/DoubleEndedQueue.sol", "line": 68, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a0dd1fbbbd0a", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "            backIndex = deque._end - 1;", "highlightLines": [70]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/DoubleEndedQueue.sol", "line": 70, "column": 25}, "severity": "medium", "references": [], "description": ""}, {"id": "e1f5c355f876", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        value = deque._data[backIndex];\n        delete deque._data[backIndex];\n        deque._end = backIndex;", "highlightLines": [72]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/DoubleEndedQueue.sol", "line": 72, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e62d5ca99400", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        int128 frontIndex;", "highlightLines": [81]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/DoubleEndedQueue.sol", "line": 81, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "21e2549e544a", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "            frontIndex = deque._begin - 1;", "highlightLines": [83]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/DoubleEndedQueue.sol", "line": 83, "column": 26}, "severity": "medium", "references": [], "description": ""}, {"id": "c0aefd9362fb", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        deque._data[frontIndex] = value;\n        deque._begin = frontIndex;", "highlightLines": [85]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/DoubleEndedQueue.sol", "line": 85, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "ef8b2941d58d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        int128 frontIndex = deque._begin;", "highlightLines": [96]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/DoubleEndedQueue.sol", "line": 96, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c1e7a804c5b2", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        int128 frontIndex = deque._begin;\n        value = deque._data[frontIndex];", "highlightLines": [96]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/DoubleEndedQueue.sol", "line": 96, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "7ad680879c0c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        value = deque._data[frontIndex];\n        delete deque._data[frontIndex];\n        unchecked {\n            deque._begin = frontIndex + 1;\n        }", "highlightLines": [97]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/DoubleEndedQueue.sol", "line": 97, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "5e0b7e186cb4", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "            deque._begin = frontIndex + 1;", "highlightLines": [100]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/DoubleEndedQueue.sol", "line": 100, "column": 28}, "severity": "medium", "references": [], "description": ""}, {"id": "56502e5d651b", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function front(Bytes32Deque storage deque) internal view returns (bytes32 value) {\n        if (empty(deque)) revert Empty();\n        int128 frontIndex = deque._begin;", "highlightLines": [109]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/DoubleEndedQueue.sol", "line": 109, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "d5a7d832298e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        int128 frontIndex = deque._begin;", "highlightLines": [111]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/DoubleEndedQueue.sol", "line": 111, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c821de52f73a", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function back(Bytes32Deque storage deque) internal view returns (bytes32 value) {\n        if (empty(deque)) revert Empty();\n        int128 backIndex;\n        unchecked {\n            backIndex = deque._end - 1;", "highlightLines": [120]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/DoubleEndedQueue.sol", "line": 120, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "9299d5f03f30", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        int128 backIndex;", "highlightLines": [122]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/DoubleEndedQueue.sol", "line": 122, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "5a7530db0368", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "            backIndex = deque._end - 1;", "highlightLines": [124]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/DoubleEndedQueue.sol", "line": 124, "column": 25}, "severity": "medium", "references": [], "description": ""}, {"id": "395c0f88b616", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function at(Bytes32Deque storage deque, uint256 index) internal view returns (bytes32 value) {\n        // int256(deque._begin) is a safe upcast\n        int128 idx = SafeCast.toInt128(int256(deque._begin) + SafeCast.toInt256(index));", "highlightLines": [135]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/DoubleEndedQueue.sol", "line": 135, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "32064cfdb394", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        int128 idx = SafeCast.toInt128(int256(deque._begin) + SafeCast.toInt256(index));", "highlightLines": [137]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/DoubleEndedQueue.sol", "line": 137, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b4947f5019a7", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        deque._begin = 0;\n        deque._end = 0;", "highlightLines": [149]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/DoubleEndedQueue.sol", "line": 149, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "38d256ac5c15", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "            return uint256(int256(deque._end) - int256(deque._begin));", "highlightLines": [160]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/DoubleEndedQueue.sol", "line": 160, "column": 28}, "severity": "medium", "references": [], "description": ""}, {"id": "cd081aa98728", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/EnumerableMap.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "e87508ea2392", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function at(Bytes32ToBytes32Map storage map, uint256 index) internal view returns (bytes32, bytes32) {\n        bytes32 key = map._keys.at(index);", "highlightLines": [113]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/EnumerableMap.sol", "line": 113, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "6bbd44318ce1", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 key = map._keys.at(index);", "highlightLines": [114]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/EnumerableMap.sol", "line": 114, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "98ed999443f3", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function tryGet(Bytes32ToBytes32Map storage map, bytes32 key) internal view returns (bool, bytes32) {\n        bytes32 value = map._values[key];", "highlightLines": [122]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/EnumerableMap.sol", "line": 122, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "6a2aa5a3a274", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 value = map._values[key];", "highlightLines": [123]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/EnumerableMap.sol", "line": 123, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "85715a72ddb5", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "        if (value == bytes32(0)) {\n            return (contains(map, key), bytes32(0));\n        } else {\n            return (true, value);\n        }", "highlightLines": [124]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/EnumerableMap.sol", "line": 124, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "ea23a5271e7c", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function get(Bytes32ToBytes32Map storage map, bytes32 key) internal view returns (bytes32) {\n        bytes32 value = map._values[key];", "highlightLines": [138]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/EnumerableMap.sol", "line": 138, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "bd82e1cd6786", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 value = map._values[key];", "highlightLines": [139]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/EnumerableMap.sol", "line": 139, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f5eeb0292d24", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function get(\n        Bytes32ToBytes32Map storage map,\n        bytes32 key,\n        string memory errorMessage\n    ) internal view returns (bytes32) {\n        bytes32 value = map._values[key];", "highlightLines": [150]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/EnumerableMap.sol", "line": 150, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "05446e42d7d2", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 value = map._values[key];", "highlightLines": [155]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/EnumerableMap.sol", "line": 155, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "79f1e232480a", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/EnumerableSet.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "a1ba69eddfbe", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 valueIndex = set._indexes[value];", "highlightLines": [82]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/EnumerableSet.sol", "line": 82, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "2100238ab514", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 valueIndex = set._indexes[value];\n\n        if (valueIndex != 0) {\n            // Equivalent to contains(set, value)\n            // To delete an element from the _values array in O(1), we swap the element to delete with the last one in\n            // the array, and then remove the last element (sometimes called as 'swap and pop').\n            // This modifies the order of the array, as noted in {at}.\n\n            uint256 toDeleteIndex = valueIndex - 1;\n            uint256 lastIndex = set._values.length - 1;\n\n            if (lastIndex != toDeleteIndex) {\n                bytes32 lastValue = set._values[lastIndex];\n\n                // Move the last value to the index where the value to delete is\n                set._values[toDeleteIndex] = lastValue;\n                // Update the index for the moved value\n                set._indexes[lastValue] = valueIndex; // Replace lastValue's index to valueIndex\n            }\n\n            // Delete the slot where the moved value was stored\n            set._values.pop();\n\n            // Delete the index for the deleted slot\n            delete set._indexes[value];\n\n            return true;\n        } else {\n            return false;\n        }", "highlightLines": [82]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/EnumerableSet.sol", "line": 82, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "f7749f24c4d7", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n            uint256 toDeleteIndex = valueIndex - 1;", "highlightLines": [89]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/EnumerableSet.sol", "line": 89, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c34e39b1ee0c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            uint256 toDeleteIndex = valueIndex - 1;\n            uint256 lastIndex = set._values.length - 1;", "highlightLines": [90]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/EnumerableSet.sol", "line": 90, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "cf855ea15113", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint256 lastIndex = set._values.length - 1;", "highlightLines": [91]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/EnumerableSet.sol", "line": 91, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "16ebbc74f3aa", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            uint256 lastIndex = set._values.length - 1;\n\n            if (lastIndex != toDeleteIndex) {\n                bytes32 lastValue = set._values[lastIndex];\n\n                // Move the last value to the index where the value to delete is\n                set._values[toDeleteIndex] = lastValue;\n                // Update the index for the moved value\n                set._indexes[lastValue] = valueIndex; // Replace lastValue's index to valueIndex\n            }", "highlightLines": [91]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/EnumerableSet.sol", "line": 91, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "e90790909e65", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "                bytes32 lastValue = set._values[lastIndex];", "highlightLines": [94]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/EnumerableSet.sol", "line": 94, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ea0ac51f6ca7", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "                bytes32 lastValue = set._values[lastIndex];\n\n                // Move the last value to the index where the value to delete is\n                set._values[toDeleteIndex] = lastValue;", "highlightLines": [94]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/EnumerableSet.sol", "line": 94, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "7af4f10e8a7e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "                set._values[toDeleteIndex] = lastValue;\n                // Update the index for the moved value\n                set._indexes[lastValue] = valueIndex; // Replace lastValue's index to valueIndex", "highlightLines": [97]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/EnumerableSet.sol", "line": 97, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "118b82ccffbf", "fix": {"template": null, "available": false}, "title": "Potential mnemonic seed phrase detected - CRITICAL if real", "ruleId": "rules._shared.shared-mnemonic-phrase", "snippet": {"code": "     * uncallable if the set grows to a point where copying to memory consumes too much gas to fit in a block.", "highlightLines": [148]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/EnumerableSet.sol", "line": 148, "column": 14}, "severity": "high", "references": [], "description": ""}, {"id": "555eaf31dc71", "fix": {"template": null, "available": false}, "title": "Potential mnemonic seed phrase detected - CRITICAL if real", "ruleId": "rules._shared.shared-mnemonic-phrase", "snippet": {"code": "     * uncallable if the set grows to a point where copying to memory consumes too much gas to fit in a block.", "highlightLines": [214]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/EnumerableSet.sol", "line": 214, "column": 14}, "severity": "high", "references": [], "description": ""}, {"id": "340f64164237", "fix": {"template": null, "available": false}, "title": "Potential mnemonic seed phrase detected - CRITICAL if real", "ruleId": "rules._shared.shared-mnemonic-phrase", "snippet": {"code": "     * uncallable if the set grows to a point where copying to memory consumes too much gas to fit in a block.", "highlightLines": [280]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/EnumerableSet.sol", "line": 280, "column": 14}, "severity": "high", "references": [], "description": ""}, {"id": "11d74437e38c", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function values(AddressSet storage set) internal view returns (address[] memory) {\n        bytes32[] memory store = _values(set._inner);", "highlightLines": [282]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/EnumerableSet.sol", "line": 282, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "9dbbeed95bbc", "fix": {"template": null, "available": false}, "title": "View/pure function uses assembly - may modify state unexpectedly", "ruleId": "rules.sol-constant-function-assembly", "snippet": {"code": "    function values(AddressSet storage set) internal view returns (address[] memory) {\n        bytes32[] memory store = _values(set._inner);\n        address[] memory result;\n\n        /// @solidity memory-safe-assembly\n        assembly {", "highlightLines": [282]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/EnumerableSet.sol", "line": 282, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-using-assembly-code"], "description": ""}, {"id": "7331fed819e6", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes32[] memory store = _values(set._inner);\n        address[] memory result;\n\n        /// @solidity memory-safe-assembly\n        assembly {\n            result := store\n        }", "highlightLines": [283]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/EnumerableSet.sol", "line": 283, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "fbd6a2424750", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [287]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/EnumerableSet.sol", "line": 287, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "64589c446c92", "fix": {"template": null, "available": false}, "title": "Potential mnemonic seed phrase detected - CRITICAL if real", "ruleId": "rules._shared.shared-mnemonic-phrase", "snippet": {"code": "     * uncallable if the set grows to a point where copying to memory consumes too much gas to fit in a block.", "highlightLines": [354]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/EnumerableSet.sol", "line": 354, "column": 14}, "severity": "high", "references": [], "description": ""}, {"id": "45876859ea7e", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function values(UintSet storage set) internal view returns (uint256[] memory) {\n        bytes32[] memory store = _values(set._inner);", "highlightLines": [356]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/EnumerableSet.sol", "line": 356, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "2ea86f371fc9", "fix": {"template": null, "available": false}, "title": "View/pure function uses assembly - may modify state unexpectedly", "ruleId": "rules.sol-constant-function-assembly", "snippet": {"code": "    function values(UintSet storage set) internal view returns (uint256[] memory) {\n        bytes32[] memory store = _values(set._inner);\n        uint256[] memory result;\n\n        /// @solidity memory-safe-assembly\n        assembly {", "highlightLines": [356]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/EnumerableSet.sol", "line": 356, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-using-assembly-code"], "description": ""}, {"id": "d84cd5eecd34", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes32[] memory store = _values(set._inner);\n        uint256[] memory result;\n\n        /// @solidity memory-safe-assembly\n        assembly {\n            result := store\n        }", "highlightLines": [357]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/EnumerableSet.sol", "line": 357, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "5392c5b026ef", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [361]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/utils/structs/EnumerableSet.sol", "line": 361, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "46206b0b7f18", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/vendor/amb/IAMB.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "160846967d0f", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event AffirmationCompleted(\n        address indexed sender,\n        address indexed executor,\n        bytes32 indexed messageId,\n        bool status\n    );", "highlightLines": [8]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/vendor/amb/IAMB.sol", "line": 8, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "a01486f32fb4", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event AffirmationCompleted(\n        address indexed sender,\n        address indexed executor,\n        bytes32 indexed messageId,\n        bool status\n    );", "highlightLines": [8]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/vendor/amb/IAMB.sol", "line": 8, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "3685a747ba55", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event RelayedMessage(address indexed sender, address indexed executor, bytes32 indexed messageId, bool status);", "highlightLines": [14]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/vendor/amb/IAMB.sol", "line": 14, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "44ab8eede19b", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function requireToPassMessage(\n        address _contract,\n        bytes calldata _data,\n        uint256 _gas\n    ) external returns (bytes32);", "highlightLines": [34]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/vendor/amb/IAMB.sol", "line": 34, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "553ce0cb8cfd", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function requireToConfirmMessage(\n        address _contract,\n        bytes calldata _data,\n        uint256 _gas\n    ) external returns (bytes32);", "highlightLines": [40]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/vendor/amb/IAMB.sol", "line": 40, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "5296ba5a3454", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "     * @return version number as int\n     */\n    function arbOSVersion() external pure returns (uint256);\n\n    function arbChainID() external view returns (uint256);", "highlightLines": [11]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/vendor/arbitrum/IArbSys.sol", "line": 11, "column": 9}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "5176bb1eb069", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function withdrawEth(address destination) external payable returns (uint256);", "highlightLines": [29]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/vendor/arbitrum/IArbSys.sol", "line": 29, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "0bd12416f280", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function sendTxToL1(address destination, bytes calldata calldataForL1) external payable returns (uint256);", "highlightLines": [37]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/vendor/arbitrum/IArbSys.sol", "line": 37, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "7fd5d78e04b7", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function getTransactionCount(address account) external view returns (uint256);", "highlightLines": [44]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/vendor/arbitrum/IArbSys.sol", "line": 44, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "9fb1a039ef1c", "fix": {"template": null, "available": false}, "title": "Potential mnemonic seed phrase detected - CRITICAL if real", "ruleId": "rules._shared.shared-mnemonic-phrase", "snippet": {"code": "     * This function is only callable from address 0 to prevent contracts from being able to call it", "highlightLines": [48]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/vendor/arbitrum/IArbSys.sol", "line": 48, "column": 34}, "severity": "high", "references": [], "description": ""}, {"id": "a43e4be89a0d", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function getStorageAt(address account, uint256 index) external view returns (uint256);", "highlightLines": [53]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/vendor/arbitrum/IArbSys.sol", "line": 53, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "7133efd345d0", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function mapL1SenderContractAddressToL2Alias(address sender, address dest) external pure returns (address);", "highlightLines": [79]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/vendor/arbitrum/IArbSys.sol", "line": 79, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "4e430385b4d7", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "     * @return amount of storage gas available to the caller\n     */\n    function getStorageGasAvailable() external view returns (uint256);\n\n    event L2ToL1Transaction(", "highlightLines": [83]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/vendor/arbitrum/IArbSys.sol", "line": 83, "column": 9}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "fadcf9b4be9b", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event L2ToL1Transaction(\n        address caller,\n        address indexed destination,\n        uint256 indexed uniqueId,\n        uint256 indexed batchNumber,\n        uint256 indexInBatch,\n        uint256 arbBlockNum,\n        uint256 ethBlockNum,\n        uint256 timestamp,\n        uint256 callvalue,\n        bytes data\n    );", "highlightLines": [87]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/vendor/arbitrum/IArbSys.sol", "line": 87, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "80702d1af621", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event L2ToL1Transaction(\n        address caller,\n        address indexed destination,\n        uint256 indexed uniqueId,\n        uint256 indexed batchNumber,\n        uint256 indexInBatch,\n        uint256 arbBlockNum,\n        uint256 ethBlockNum,\n        uint256 timestamp,\n        uint256 callvalue,\n        bytes data\n    );", "highlightLines": [87]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/vendor/arbitrum/IArbSys.sol", "line": 87, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "7dd63a939c9a", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [20]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/vendor/arbitrum/IBridge.sol", "line": 20, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "1b7bf1a7e0a1", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event MessageDelivered(\n        uint256 indexed messageIndex,\n        bytes32 indexed beforeInboxAcc,\n        address inbox,\n        uint8 kind,\n        address sender,\n        bytes32 messageDataHash\n    );", "highlightLines": [23]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/vendor/arbitrum/IBridge.sol", "line": 23, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "27a9396d77f5", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event BridgeCallTriggered(address indexed outbox, address indexed destAddr, uint256 amount, bytes data);", "highlightLines": [32]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/vendor/arbitrum/IBridge.sol", "line": 32, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "4b049e1c99e8", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event InboxToggle(address indexed inbox, bool enabled);", "highlightLines": [34]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/vendor/arbitrum/IBridge.sol", "line": 34, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "ffefb9c26667", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event OutboxToggle(address indexed outbox, bool enabled);", "highlightLines": [36]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/vendor/arbitrum/IBridge.sol", "line": 36, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "2b4cc2da5a7b", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function executeCall(\n        address destAddr,\n        uint256 amount,\n        bytes calldata data\n    ) external returns (bool success, bytes memory returnData);", "highlightLines": [44]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/vendor/arbitrum/IBridge.sol", "line": 44, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "991ec1035c0f", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function setInbox(address inbox, bool enabled) external;", "highlightLines": [51]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/vendor/arbitrum/IBridge.sol", "line": 51, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "30ed85e14060", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function setOutbox(address inbox, bool enabled) external;", "highlightLines": [53]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/vendor/arbitrum/IBridge.sol", "line": 53, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "56c8be7fc71d", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function allowedInboxes(address inbox) external view returns (bool);", "highlightLines": [59]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/vendor/arbitrum/IBridge.sol", "line": 59, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "a79bef569a7b", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function allowedOutboxes(address outbox) external view returns (bool);", "highlightLines": [61]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/vendor/arbitrum/IBridge.sol", "line": 61, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "c62c5fc1d5be", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [20]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/vendor/arbitrum/IInbox.sol", "line": 20, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "2e8763718314", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function createRetryableTicket(\n        address destAddr,\n        uint256 arbTxCallValue,\n        uint256 maxSubmissionCost,\n        address submissionRefundAddress,\n        address valueRefundAddress,\n        uint256 maxGas,\n        uint256 gasPriceBid,\n        bytes calldata data\n    ) external payable returns (uint256);", "highlightLines": [59]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/vendor/arbitrum/IInbox.sol", "line": 59, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "1c2f807a450c", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function createRetryableTicketNoRefundAliasRewrite(\n        address destAddr,\n        uint256 arbTxCallValue,\n        uint256 maxSubmissionCost,\n        address submissionRefundAddress,\n        address valueRefundAddress,\n        uint256 maxGas,\n        uint256 gasPriceBid,\n        bytes calldata data\n    ) external payable returns (uint256);", "highlightLines": [70]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/vendor/arbitrum/IInbox.sol", "line": 70, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "23c99f67e056", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [20]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/vendor/arbitrum/IMessageProvider.sol", "line": 20, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "4068f6675add", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [20]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/vendor/arbitrum/IOutbox.sol", "line": 20, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "bee45db66ea8", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event OutboxEntryCreated(\n        uint256 indexed batchNum,\n        uint256 outboxEntryIndex,\n        bytes32 outputRoot,\n        uint256 numInBatch\n    );", "highlightLines": [23]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/vendor/arbitrum/IOutbox.sol", "line": 23, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "b4479d27f245", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event OutBoxTransactionExecuted(\n        address indexed destAddr,\n        address indexed l2Sender,\n        uint256 indexed outboxEntryIndex,\n        uint256 transactionIndex\n    );", "highlightLines": [29]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/vendor/arbitrum/IOutbox.sol", "line": 29, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "ede4abbb1c64", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event OutBoxTransactionExecuted(\n        address indexed destAddr,\n        address indexed l2Sender,\n        uint256 indexed outboxEntryIndex,\n        uint256 transactionIndex\n    );", "highlightLines": [29]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/vendor/arbitrum/IOutbox.sol", "line": 29, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "613557eca456", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/vendor/compound/ICompoundTimelock.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "1abe6edb0564", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event NewAdmin(address indexed newAdmin);", "highlightLines": [10]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/vendor/compound/ICompoundTimelock.sol", "line": 10, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "92d0760765bb", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event NewPendingAdmin(address indexed newPendingAdmin);", "highlightLines": [11]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/vendor/compound/ICompoundTimelock.sol", "line": 11, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "97da1cae91c2", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event CancelTransaction(\n        bytes32 indexed txHash,\n        address indexed target,\n        uint256 value,\n        string signature,\n        bytes data,\n        uint256 eta\n    );", "highlightLines": [13]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/vendor/compound/ICompoundTimelock.sol", "line": 13, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "696552f05ab2", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event ExecuteTransaction(\n        bytes32 indexed txHash,\n        address indexed target,\n        uint256 value,\n        string signature,\n        bytes data,\n        uint256 eta\n    );", "highlightLines": [21]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/vendor/compound/ICompoundTimelock.sol", "line": 21, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "245c9fadb58b", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event QueueTransaction(\n        bytes32 indexed txHash,\n        address indexed target,\n        uint256 value,\n        string signature,\n        bytes data,\n        uint256 eta\n    );", "highlightLines": [29]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/vendor/compound/ICompoundTimelock.sol", "line": 29, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "3a62d6194604", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function queueTransaction(\n        address target,\n        uint256 value,\n        string memory signature,\n        bytes memory data,\n        uint256 eta\n    ) external returns (bytes32);", "highlightLines": [63]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/vendor/compound/ICompoundTimelock.sol", "line": 63, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "d4e04355f117", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function cancelTransaction(\n        address target,\n        uint256 value,\n        string memory signature,\n        bytes memory data,\n        uint256 eta\n    ) external;", "highlightLines": [71]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/vendor/compound/ICompoundTimelock.sol", "line": 71, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "cd13335571a3", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function executeTransaction(\n        address target,\n        uint256 value,\n        string memory signature,\n        bytes memory data,\n        uint256 eta\n    ) external payable returns (bytes memory);", "highlightLines": [79]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/vendor/compound/ICompoundTimelock.sol", "line": 79, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "d5270d0477d8", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event SentMessage(address indexed target, address sender, bytes message, uint256 messageNonce, uint256 gasLimit);", "highlightLines": [13]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/vendor/optimism/ICrossDomainMessenger.sol", "line": 13, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "fb4e0bccac24", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function sendMessage(\n        address _target,\n        bytes calldata _message,\n        uint32 _gasLimit\n    ) external;", "highlightLines": [33]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/vendor/optimism/ICrossDomainMessenger.sol", "line": 33, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "88d2cca6c288", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/contracts/vendor/polygon/IFxMessageProcessor.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "8d9ea5ac5b5c", "fix": {"template": null, "available": false}, "title": "Password reset endpoint - add rate limiting to prevent abuse", "ruleId": "rules.express-password-reset-no-rate-limit", "snippet": {"code": "  const format = chalk[cell.delta > 0 ? 'red' : cell.delta < 0 ? 'green' : 'reset'];", "highlightLines": [73]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/scripts/checks/compareGasReports.js", "line": 73, "column": 77}, "severity": "info", "references": [], "description": ""}, {"id": "be824796c3d2", "fix": {"template": null, "available": false}, "title": "SQL ILIKE with string concatenation - SQL injection vulnerability", "ruleId": "rules.sql-ilike-injection", "snippet": {"code": "    format((isNaN(cell.prcnt) ? '-' : plusSign(cell.prcnt) + cell.prcnt.toFixed(2) + '%').padStart(8)),", "highlightLines": [77]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/scripts/checks/compareGasReports.js", "line": 77, "column": 84}, "severity": "high", "references": [], "description": ""}, {"id": "d787b7317bec", "fix": {"template": null, "available": false}, "title": "SQL ILIKE with string concatenation - SQL injection vulnerability", "ruleId": "rules.sql-ilike-injection", "snippet": {"code": "    (isNaN(cell.prcnt) ? '-' : plusSign(cell.prcnt) + cell.prcnt.toFixed(2) + '%') + trend(cell.delta),", "highlightLines": [137]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/scripts/checks/compareGasReports.js", "line": 137, "column": 77}, "severity": "high", "references": [], "description": ""}, {"id": "dee5dbe07814", "fix": {"template": null, "available": false}, "title": "Dynamic property assignment - prototype pollution if key is user-controlled", "ruleId": "rules.bracket-notation-user-input", "snippet": {"code": "      names[contractDef.id] = contractDef.name;", "highlightLines": [21]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/scripts/checks/inheritance-ordering.js", "line": 21, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "82b645575ae0", "fix": {"template": null, "available": false}, "title": "parseInt without radix parameter - specify base to avoid unexpected behavior", "ruleId": "rules.parseint-radix-missing", "snippet": {"code": "        .filter(chain => chain.includes(parseInt(x)) && chain.includes(parseInt(y)))", "highlightLines": [38]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/scripts/checks/inheritance-ordering.js", "line": 38, "column": 41}, "severity": "info", "references": [], "description": ""}, {"id": "793000f7c797", "fix": {"template": null, "available": false}, "title": "parseInt without radix parameter - specify base to avoid unexpected behavior", "ruleId": "rules.parseint-radix-missing", "snippet": {"code": "          const comp = chain.indexOf(parseInt(x)) < chain.indexOf(parseInt(y)) ? '>' : '<';", "highlightLines": [40]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/scripts/checks/inheritance-ordering.js", "line": 40, "column": 38}, "severity": "info", "references": [], "description": ""}, {"id": "f50aa0e91131", "fix": {"template": null, "available": false}, "title": "Security/linting suppression comment - verify this is justified", "ruleId": "rules._shared.shared-comment-disable-security", "snippet": {"code": "/* eslint-disable max-len */", "highlightLines": [102]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/scripts/generate/templates/SafeCast.js", "line": 102, "column": 1}, "severity": "medium", "references": [], "description": ""}, {"id": "b4e814339ee9", "fix": {"template": null, "available": false}, "title": "Password reset endpoint - add rate limiting to prevent abuse", "ruleId": "rules.express-password-reset-no-rate-limit", "snippet": {"code": "  'presets/ERC1155PresetMinterPauser.sol': 'token/ERC1155/presets/ERC1155PresetMinterPauser.sol',", "highlightLines": [36]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/scripts/migrate-imports.js", "line": 36, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "cac4285c8bbe", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "  'presets/ERC1155PresetMinterPauser.sol': 'token/ERC1155/presets/ERC1155PresetMinterPauser.sol',", "highlightLines": [36]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/scripts/migrate-imports.js", "line": 36, "column": 45}, "severity": "medium", "references": [], "description": ""}, {"id": "78961484e24e", "fix": {"template": null, "available": false}, "title": "Password reset endpoint - add rate limiting to prevent abuse", "ruleId": "rules.express-password-reset-no-rate-limit", "snippet": {"code": "  'presets/ERC20PresetFixedSupply.sol': 'token/ERC20/presets/ERC20PresetFixedSupply.sol',", "highlightLines": [37]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/scripts/migrate-imports.js", "line": 37, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "5a435cac71bf", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "  'presets/ERC20PresetFixedSupply.sol': 'token/ERC20/presets/ERC20PresetFixedSupply.sol',", "highlightLines": [37]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/scripts/migrate-imports.js", "line": 37, "column": 42}, "severity": "medium", "references": [], "description": ""}, {"id": "fd299c7fbc03", "fix": {"template": null, "available": false}, "title": "Password reset endpoint - add rate limiting to prevent abuse", "ruleId": "rules.express-password-reset-no-rate-limit", "snippet": {"code": "  'presets/ERC20PresetMinterPauser.sol': 'token/ERC20/presets/ERC20PresetMinterPauser.sol',", "highlightLines": [38]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/scripts/migrate-imports.js", "line": 38, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "e3a00fdcda34", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "  'presets/ERC20PresetMinterPauser.sol': 'token/ERC20/presets/ERC20PresetMinterPauser.sol',", "highlightLines": [38]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/scripts/migrate-imports.js", "line": 38, "column": 43}, "severity": "medium", "references": [], "description": ""}, {"id": "bc94d8a4e553", "fix": {"template": null, "available": false}, "title": "Password reset endpoint - add rate limiting to prevent abuse", "ruleId": "rules.express-password-reset-no-rate-limit", "snippet": {"code": "  'presets/ERC721PresetMinterPauserAutoId.sol': 'token/ERC721/presets/ERC721PresetMinterPauserAutoId.sol',", "highlightLines": [39]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/scripts/migrate-imports.js", "line": 39, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "d72eb0a16fa9", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "  'presets/ERC721PresetMinterPauserAutoId.sol': 'token/ERC721/presets/ERC721PresetMinterPauserAutoId.sol',", "highlightLines": [39]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/scripts/migrate-imports.js", "line": 39, "column": 50}, "severity": "medium", "references": [], "description": ""}, {"id": "b25554f5d6b4", "fix": {"template": null, "available": false}, "title": "Password reset endpoint - add rate limiting to prevent abuse", "ruleId": "rules.express-password-reset-no-rate-limit", "snippet": {"code": "  'presets/ERC777PresetFixedSupply.sol': 'token/ERC777/presets/ERC777PresetFixedSupply.sol',", "highlightLines": [40]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/scripts/migrate-imports.js", "line": 40, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "6367520522e8", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "  'presets/ERC777PresetFixedSupply.sol': 'token/ERC777/presets/ERC777PresetFixedSupply.sol',", "highlightLines": [40]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/scripts/migrate-imports.js", "line": 40, "column": 43}, "severity": "medium", "references": [], "description": ""}, {"id": "1268bed6050d", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "  'proxy/TransparentUpgradeableProxy.sol': 'proxy/transparent/TransparentUpgradeableProxy.sol',", "highlightLines": [48]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/scripts/migrate-imports.js", "line": 48, "column": 45}, "severity": "medium", "references": [], "description": ""}, {"id": "eefdede06a76", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "  'token/ERC1155/ERC1155Burnable.sol': 'token/ERC1155/extensions/ERC1155Burnable.sol',", "highlightLines": [51]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/scripts/migrate-imports.js", "line": 51, "column": 41}, "severity": "medium", "references": [], "description": ""}, {"id": "390e2478d4bb", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "  'token/ERC1155/ERC1155Pausable.sol': 'token/ERC1155/extensions/ERC1155Pausable.sol',", "highlightLines": [53]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/scripts/migrate-imports.js", "line": 53, "column": 41}, "severity": "medium", "references": [], "description": ""}, {"id": "bf5957c606c1", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "  'token/ERC1155/IERC1155MetadataURI.sol': 'token/ERC1155/extensions/IERC1155MetadataURI.sol',", "highlightLines": [56]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/scripts/migrate-imports.js", "line": 56, "column": 45}, "severity": "medium", "references": [], "description": ""}, {"id": "0c876f8a51e1", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "  'token/ERC721/IERC721Enumerable.sol': 'token/ERC721/extensions/IERC721Enumerable.sol',", "highlightLines": [71]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/scripts/migrate-imports.js", "line": 71, "column": 42}, "severity": "medium", "references": [], "description": ""}, {"id": "420cd67978c7", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "const { CompilerDownloader } = require('hardhat/internal/solidity/compiler/downloader');", "highlightLines": [4]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/scripts/prepare-docs-solc.js", "line": 4, "column": 41}, "severity": "medium", "references": [], "description": ""}, {"id": "b297088dba55", "fix": {"template": null, "available": false}, "title": "Object.assign with user input - prototype pollution risk (CWE-1321)", "ruleId": "rules.prototype-pollution-object-assign", "snippet": {"code": "module.exports = Object.assign(getSolc(), { __esModule: true });", "highlightLines": [16]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/scripts/prepare-docs-solc.js", "line": 16, "column": 18}, "severity": "medium", "references": [], "description": ""}, {"id": "3184c13c06c9", "fix": {"template": null, "available": false}, "title": "Regex with nested quantifiers - potential ReDoS (CWE-1333)", "ruleId": "rules.js-redos-nested-quantifiers", "snippet": {"code": "const version = pkg.version.replace(new RegExp('-' + suffix + '\\\\..*'), '');", "highlightLines": [19]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/scripts/release/update-changelog-release-date.js", "line": 19, "column": 37}, "severity": "medium", "references": [], "description": ""}, {"id": "16c98917ed5c", "fix": {"template": null, "available": false}, "title": "Dynamic regex with user input - potential ReDoS vulnerability", "ruleId": "rules.js-dynamic-regex", "snippet": {"code": "const version = pkg.version.replace(new RegExp('-' + suffix + '\\\\..*'), '');", "highlightLines": [19]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/scripts/release/update-changelog-release-date.js", "line": 19, "column": 37}, "severity": "medium", "references": [], "description": ""}, {"id": "ed17a3399ffa", "fix": {"template": null, "available": false}, "title": "Password reset endpoint - add rate limiting to prevent abuse", "ruleId": "rules.express-password-reset-no-rate-limit", "snippet": {"code": "  run(`git reset --soft ${publishedRef}`);", "highlightLines": [48]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/scripts/update-docs-branch.js", "line": 48, "column": 12}, "severity": "info", "references": [], "description": ""}, {"id": "e89ae8058a9f", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "const DEFAULT_ADMIN_ROLE = '0x0000000000000000000000000000000000000000000000000000000000000000';", "highlightLines": [6]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/access/AccessControl.behavior.js", "line": 6, "column": 29}, "severity": "medium", "references": [], "description": ""}, {"id": "df7bf6d9d557", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "const DEFAULT_ADMIN_ROLE = '0x0000000000000000000000000000000000000000000000000000000000000000';", "highlightLines": [6]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/access/AccessControl.behavior.js", "line": 6, "column": 29}, "severity": "high", "references": [], "description": ""}, {"id": "cc323a3a9fab", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "const salt = '0x025e7b0be353a74631ad648c667493c0e1cd31caa4cc2d3520fdc171ea0cc726'; // a random value", "highlightLines": [18]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/governance/TimelockController.test.js", "line": 18, "column": 15}, "severity": "medium", "references": [], "description": ""}, {"id": "301dcb73cc2a", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "const salt = '0x025e7b0be353a74631ad648c667493c0e1cd31caa4cc2d3520fdc171ea0cc726'; // a random value", "highlightLines": [18]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/governance/TimelockController.test.js", "line": 18, "column": 15}, "severity": "high", "references": [], "description": ""}, {"id": "dfba48231483", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "          '0x29cebefe301c6ce1bb36b58654fea275e1cacc83',", "highlightLines": [109]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/governance/TimelockController.test.js", "line": 109, "column": 12}, "severity": "medium", "references": [], "description": ""}, {"id": "58f6caf3f2eb", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "          '0xba41db3be0a9929145cfe480bd0f1f003689104d275ae912099f925df424ef94',", "highlightLines": [112]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/governance/TimelockController.test.js", "line": 112, "column": 12}, "severity": "medium", "references": [], "description": ""}, {"id": "03d97f480261", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "          '0xba41db3be0a9929145cfe480bd0f1f003689104d275ae912099f925df424ef94',", "highlightLines": [112]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/governance/TimelockController.test.js", "line": 112, "column": 12}, "severity": "high", "references": [], "description": ""}, {"id": "09ac85b4b750", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "          '0x60d9109846ab510ed75c15f979ae366a8a2ace11d34ba9788c13ac296db50e6e',", "highlightLines": [113]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/governance/TimelockController.test.js", "line": 113, "column": 12}, "severity": "medium", "references": [], "description": ""}, {"id": "ad6a246cdd89", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "          '0x60d9109846ab510ed75c15f979ae366a8a2ace11d34ba9788c13ac296db50e6e',", "highlightLines": [113]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/governance/TimelockController.test.js", "line": 113, "column": 12}, "severity": "high", "references": [], "description": ""}, {"id": "2f2341bacb16", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "          Array(8).fill('0x2d5f21620e56531c1d59c2df9b8e95d129571f71'),", "highlightLines": [126]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/governance/TimelockController.test.js", "line": 126, "column": 26}, "severity": "medium", "references": [], "description": ""}, {"id": "03008d3eff1d", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "          '0xce8f45069cc71d25f71ba05062de1a3974f9849b004de64a70998bca9d29c2e7',", "highlightLines": [129]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/governance/TimelockController.test.js", "line": 129, "column": 12}, "severity": "medium", "references": [], "description": ""}, {"id": "c599f5305087", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "          '0xce8f45069cc71d25f71ba05062de1a3974f9849b004de64a70998bca9d29c2e7',", "highlightLines": [129]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/governance/TimelockController.test.js", "line": 129, "column": 12}, "severity": "high", "references": [], "description": ""}, {"id": "4373884504fc", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "          '0x8952d74c110f72bfe5accdf828c74d53a7dfb71235dfa8a1e8c75d8576b372ff',", "highlightLines": [130]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/governance/TimelockController.test.js", "line": 130, "column": 12}, "severity": "medium", "references": [], "description": ""}, {"id": "8ec34c49a7a8", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "          '0x8952d74c110f72bfe5accdf828c74d53a7dfb71235dfa8a1e8c75d8576b372ff',", "highlightLines": [130]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/governance/TimelockController.test.js", "line": 130, "column": 12}, "severity": "high", "references": [], "description": ""}, {"id": "76243bd870ce", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "            '0x31754f590B97fD975Eb86938f18Cc304E264D2F2',", "highlightLines": [145]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/governance/TimelockController.test.js", "line": 145, "column": 14}, "severity": "medium", "references": [], "description": ""}, {"id": "2a6cda229e21", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "            '0xAe22104DCD970750610E6FE15E623468A98b15f7',", "highlightLines": [238]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/governance/TimelockController.test.js", "line": 238, "column": 14}, "severity": "medium", "references": [], "description": ""}, {"id": "769e10b9102e", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "            '0xc1059ed2dc130227aa1d1d539ac94c641306905c020436c636e19e3fab56fc7f',", "highlightLines": [242]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/governance/TimelockController.test.js", "line": 242, "column": 14}, "severity": "medium", "references": [], "description": ""}, {"id": "85dfc1f58a52", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "            '0xc1059ed2dc130227aa1d1d539ac94c641306905c020436c636e19e3fab56fc7f',", "highlightLines": [242]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/governance/TimelockController.test.js", "line": 242, "column": 14}, "severity": "high", "references": [], "description": ""}, {"id": "ddbfe21cfeed", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "            Array(8).fill('0xEd912250835c812D4516BBD80BdaEA1bB63a293C'),", "highlightLines": [350]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/governance/TimelockController.test.js", "line": 350, "column": 28}, "severity": "medium", "references": [], "description": ""}, {"id": "e5b2361a9b83", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "            '0x6cf9d042ade5de78bed9ffd075eb4b2a4f6b1736932c2dc8af517d6e066f51f5',", "highlightLines": [354]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/governance/TimelockController.test.js", "line": 354, "column": 14}, "severity": "medium", "references": [], "description": ""}, {"id": "404841aa4037", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "            '0x6cf9d042ade5de78bed9ffd075eb4b2a4f6b1736932c2dc8af517d6e066f51f5',", "highlightLines": [354]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/governance/TimelockController.test.js", "line": 354, "column": 14}, "severity": "high", "references": [], "description": ""}, {"id": "828d6c23c0e0", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "            Array(8).fill('0x76E53CcEb05131Ef5248553bEBDb8F70536830b1'),", "highlightLines": [475]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/governance/TimelockController.test.js", "line": 475, "column": 28}, "severity": "medium", "references": [], "description": ""}, {"id": "3b7a4b9d4764", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "            '0x9545eeabc7a7586689191f78a5532443698538e54211b5bd4d7dc0fc0102b5c7',", "highlightLines": [479]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/governance/TimelockController.test.js", "line": 479, "column": 14}, "severity": "medium", "references": [], "description": ""}, {"id": "625a4709b86a", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "            '0x9545eeabc7a7586689191f78a5532443698538e54211b5bd4d7dc0fc0102b5c7',", "highlightLines": [479]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/governance/TimelockController.test.js", "line": 479, "column": 14}, "severity": "high", "references": [], "description": ""}, {"id": "47a91a66545e", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "            '0x8ac04aa0d6d66b8812fb41d39638d37af0a9ab11da507afd65c509f8ed079d3e',", "highlightLines": [643]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/governance/TimelockController.test.js", "line": 643, "column": 14}, "severity": "medium", "references": [], "description": ""}, {"id": "884834127a39", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "            '0x8ac04aa0d6d66b8812fb41d39638d37af0a9ab11da507afd65c509f8ed079d3e',", "highlightLines": [643]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/governance/TimelockController.test.js", "line": 643, "column": 14}, "severity": "high", "references": [], "description": ""}, {"id": "52490deeec3d", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "          '0xC6837c44AA376dbe1d2709F13879E040CAb653ca',", "highlightLines": [674]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/governance/TimelockController.test.js", "line": 674, "column": 12}, "severity": "medium", "references": [], "description": ""}, {"id": "59629e342617", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "          '0xa2485763600634800df9fc9646fb2c112cf98649c55f63dd1d9c7d13a64399d9',", "highlightLines": [678]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/governance/TimelockController.test.js", "line": 678, "column": 12}, "severity": "medium", "references": [], "description": ""}, {"id": "59daefd2f52b", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "          '0xa2485763600634800df9fc9646fb2c112cf98649c55f63dd1d9c7d13a64399d9',", "highlightLines": [678]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/governance/TimelockController.test.js", "line": 678, "column": 12}, "severity": "high", "references": [], "description": ""}, {"id": "164a37b98cc7", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "        '0xf8e775b2c5f4d66fb5c7fa800f35ef518c262b6014b3c0aee6ea21bff157f108',", "highlightLines": [727]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/governance/TimelockController.test.js", "line": 727, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "9a340f96b4e4", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "        '0xf8e775b2c5f4d66fb5c7fa800f35ef518c262b6014b3c0aee6ea21bff157f108',", "highlightLines": [727]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/governance/TimelockController.test.js", "line": 727, "column": 10}, "severity": "high", "references": [], "description": ""}, {"id": "cc146a9d5476", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "        '0xdE66bD4c97304200A95aE0AadA32d6d01A867E39',", "highlightLines": [757]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/governance/TimelockController.test.js", "line": 757, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "0694b3c85d05", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "        '0x64e932133c7677402ead2926f86205e2ca4686aebecf5a8077627092b9bb2feb',", "highlightLines": [761]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/governance/TimelockController.test.js", "line": 761, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "be65ab69bc31", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "        '0x64e932133c7677402ead2926f86205e2ca4686aebecf5a8077627092b9bb2feb',", "highlightLines": [761]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/governance/TimelockController.test.js", "line": 761, "column": 10}, "severity": "high", "references": [], "description": ""}, {"id": "cb85db14bd18", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "        '0x3c7944a3F1ee7fc8c5A5134ba7c79D11c3A1FCa3',", "highlightLines": [764]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/governance/TimelockController.test.js", "line": 764, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "15475189f4c3", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "        '0x036e1311cac523f9548e6461e29fb1f8f9196b91910a41711ea22f5de48df07d',", "highlightLines": [768]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/governance/TimelockController.test.js", "line": 768, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "c51217c81c9b", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "        '0x036e1311cac523f9548e6461e29fb1f8f9196b91910a41711ea22f5de48df07d',", "highlightLines": [768]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/governance/TimelockController.test.js", "line": 768, "column": 10}, "severity": "high", "references": [], "description": ""}, {"id": "964e15088f08", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "        '0x8043596363daefc89977b25f9d9b4d06c3910959ef0c4d213557a903e1b555e2',", "highlightLines": [834]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/governance/TimelockController.test.js", "line": 834, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "0123d77204ce", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "        '0x8043596363daefc89977b25f9d9b4d06c3910959ef0c4d213557a903e1b555e2',", "highlightLines": [834]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/governance/TimelockController.test.js", "line": 834, "column": 10}, "severity": "high", "references": [], "description": ""}, {"id": "eb40e471d48b", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "        '0xb1b1b276fdf1a28d1e00537ea73b04d56639128b08063c1a2f70a52e38cba693',", "highlightLines": [865]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/governance/TimelockController.test.js", "line": 865, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "3b75e8f4baaf", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "        '0xb1b1b276fdf1a28d1e00537ea73b04d56639128b08063c1a2f70a52e38cba693',", "highlightLines": [865]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/governance/TimelockController.test.js", "line": 865, "column": 10}, "severity": "high", "references": [], "description": ""}, {"id": "6e5e49d22723", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "        '0xe5ca79f295fc8327ee8a765fe19afb58f4a0cbc5053642bfdd7e73bc68e0fc67',", "highlightLines": [897]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/governance/TimelockController.test.js", "line": 897, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "3cbabd72701e", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "        '0xe5ca79f295fc8327ee8a765fe19afb58f4a0cbc5053642bfdd7e73bc68e0fc67',", "highlightLines": [897]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/governance/TimelockController.test.js", "line": 897, "column": 10}, "severity": "high", "references": [], "description": ""}, {"id": "3c0dc2398d4b", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "        '0xf3274ce7c394c5b629d5215723563a744b817e1730cca5587c567099a14578fd',", "highlightLines": [929]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/governance/TimelockController.test.js", "line": 929, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "f14166059c22", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "        '0xf3274ce7c394c5b629d5215723563a744b817e1730cca5587c567099a14578fd',", "highlightLines": [929]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/governance/TimelockController.test.js", "line": 929, "column": 10}, "severity": "high", "references": [], "description": ""}, {"id": "8d78fd71e554", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "        '0x5ab73cd33477dcd36c1e05e28362719d0ed59a7b9ff14939de63a43073dc1f44',", "highlightLines": [961]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/governance/TimelockController.test.js", "line": 961, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "f010982fee02", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "        '0x5ab73cd33477dcd36c1e05e28362719d0ed59a7b9ff14939de63a43073dc1f44',", "highlightLines": [961]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/governance/TimelockController.test.js", "line": 961, "column": 10}, "severity": "high", "references": [], "description": ""}, {"id": "0b6d7ea3ca30", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "        '0xb78edbd920c7867f187e5aa6294ae5a656cfbf0dea1ccdca3751b740d0f2bdf8',", "highlightLines": [997]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/governance/TimelockController.test.js", "line": 997, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "9029a032959f", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "        '0xb78edbd920c7867f187e5aa6294ae5a656cfbf0dea1ccdca3751b740d0f2bdf8',", "highlightLines": [997]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/governance/TimelockController.test.js", "line": 997, "column": 10}, "severity": "high", "references": [], "description": ""}, {"id": "1f9e0b545e13", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "        '0xdedb4563ef0095db01d81d3f2decf57cf83e4a72aa792af14c43a792b56f4de6',", "highlightLines": [1036]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/governance/TimelockController.test.js", "line": 1036, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "b8983e618c44", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "        '0xdedb4563ef0095db01d81d3f2decf57cf83e4a72aa792af14c43a792b56f4de6',", "highlightLines": [1036]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/governance/TimelockController.test.js", "line": 1036, "column": 10}, "severity": "high", "references": [], "description": ""}, {"id": "fed9a5022bb9", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "    // https://github.com/compound-finance/compound-protocol/blob/master/tests/Governance/CompTest.js.", "highlightLines": [298]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/governance/utils/Votes.behavior.js", "line": 298, "column": 53}, "severity": "medium", "references": [], "description": ""}, {"id": "00f86c143a57", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "      params: [ '0x0000000000000000000000000000000000000064', code ],", "highlightLines": [44]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/helpers/crosschain.js", "line": 44, "column": 18}, "severity": "medium", "references": [], "description": ""}, {"id": "5db61c506eb6", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "    return BridgeArbitrumL2Mock.at('0x0000000000000000000000000000000000000064');", "highlightLines": [47]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/helpers/crosschain.js", "line": 47, "column": 37}, "severity": "medium", "references": [], "description": ""}, {"id": "391403a73878", "fix": {"template": null, "available": false}, "title": "parseInt without radix parameter - specify base to avoid unexpected behavior", "ruleId": "rules.parseint-radix-missing", "snippet": {"code": "  return parseInt(\n    await network.provider.send('eth_getBlockTransactionCountByNumber', ['pending']),\n  );", "highlightLines": [7]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/helpers/txpool.js", "line": 7, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "ccf01febbf81", "fix": {"template": null, "available": false}, "title": "Dynamic property assignment - prototype pollution if key is user-controlled", "ruleId": "rules.bracket-notation-user-input", "snippet": {"code": "          tamperedsign[42] ^= 0xff;", "highlightLines": [101]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/metatx/MinimalForwarder.test.js", "line": 101, "column": 11}, "severity": "medium", "references": [], "description": ""}, {"id": "dc75939ac7c7", "fix": {"template": null, "available": false}, "title": "Dynamic property assignment - prototype pollution if key is user-controlled", "ruleId": "rules.bracket-notation-user-input", "snippet": {"code": "          tamperedsign[42] ^= 0xff;", "highlightLines": [158]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/metatx/MinimalForwarder.test.js", "line": 158, "column": 11}, "severity": "medium", "references": [], "description": ""}, {"id": "5711f70eb269", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "        '0x3d602d80600a3d3981f3363d3d373d3d3d363d73',", "highlightLines": [51]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/proxy/Clones.test.js", "line": 51, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "1000c2567f8d", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "module.exports = function shouldBehaveLikeTransparentUpgradeableProxy (createProxy, accounts) {", "highlightLines": [19]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/proxy/transparent/TransparentUpgradeableProxy.behaviour.js", "line": 19, "column": 27}, "severity": "medium", "references": [], "description": ""}, {"id": "0ab2f2cc3b60", "fix": {"template": null, "available": false}, "title": "parseInt without radix parameter - specify base to avoid unexpected behavior", "ruleId": "rules.parseint-radix-missing", "snippet": {"code": "            expect(parseInt(storedValue)).to.eq(42);", "highlightLines": [137]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/proxy/transparent/TransparentUpgradeableProxy.behaviour.js", "line": 137, "column": 20}, "severity": "info", "references": [], "description": ""}, {"id": "5e7beff5d4ec", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "        expect(value).to.be.equal('0x0000000000000000000000000000000011111142');", "highlightLines": [344]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/proxy/transparent/TransparentUpgradeableProxy.behaviour.js", "line": 344, "column": 36}, "severity": "medium", "references": [], "description": ""}, {"id": "3fcadeae8111", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "const shouldBehaveLikeTransparentUpgradeableProxy = require('./TransparentUpgradeableProxy.behaviour');", "highlightLines": [2]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/proxy/transparent/TransparentUpgradeableProxy.test.js", "line": 2, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "6c95bd0c684e", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "  shouldBehaveLikeTransparentUpgradeableProxy(createProxy, accounts);", "highlightLines": [14]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/proxy/transparent/TransparentUpgradeableProxy.test.js", "line": 14, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "9e8dfa0225a5", "fix": {"template": null, "available": false}, "title": "Password reset endpoint - add rate limiting to prevent abuse", "ruleId": "rules.express-password-reset-no-rate-limit", "snippet": {"code": "const ERC1155PresetMinterPauser = artifacts.require('ERC1155PresetMinterPauser');", "highlightLines": [7]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC1155/presets/ERC1155PresetMinterPauser.test.js", "line": 7, "column": 15}, "severity": "info", "references": [], "description": ""}, {"id": "42f341b5731b", "fix": {"template": null, "available": false}, "title": "Password reset endpoint - add rate limiting to prevent abuse", "ruleId": "rules.express-password-reset-no-rate-limit", "snippet": {"code": "contract('ERC1155PresetMinterPauser', function (accounts) {", "highlightLines": [9]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC1155/presets/ERC1155PresetMinterPauser.test.js", "line": 9, "column": 19}, "severity": "info", "references": [], "description": ""}, {"id": "7740edec5fa1", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "  const DEFAULT_ADMIN_ROLE = '0x0000000000000000000000000000000000000000000000000000000000000000';", "highlightLines": [18]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC1155/presets/ERC1155PresetMinterPauser.test.js", "line": 18, "column": 31}, "severity": "medium", "references": [], "description": ""}, {"id": "8dd4b7d80657", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "  const DEFAULT_ADMIN_ROLE = '0x0000000000000000000000000000000000000000000000000000000000000000';", "highlightLines": [18]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC1155/presets/ERC1155PresetMinterPauser.test.js", "line": 18, "column": 31}, "severity": "high", "references": [], "description": ""}, {"id": "041a0adb21c8", "fix": {"template": null, "available": false}, "title": "Password reset endpoint - add rate limiting to prevent abuse", "ruleId": "rules.express-password-reset-no-rate-limit", "snippet": {"code": "    this.token = await ERC1155PresetMinterPauser.new(uri, { from: deployer });", "highlightLines": [25]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC1155/presets/ERC1155PresetMinterPauser.test.js", "line": 25, "column": 32}, "severity": "info", "references": [], "description": ""}, {"id": "088942417077", "fix": {"template": null, "available": false}, "title": "Password reset endpoint - add rate limiting to prevent abuse", "ruleId": "rules.express-password-reset-no-rate-limit", "snippet": {"code": "        'ERC1155PresetMinterPauser: must have minter role to mint',", "highlightLines": [63]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC1155/presets/ERC1155PresetMinterPauser.test.js", "line": 63, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "721194fdd2e2", "fix": {"template": null, "available": false}, "title": "Password reset endpoint - add rate limiting to prevent abuse", "ruleId": "rules.express-password-reset-no-rate-limit", "snippet": {"code": "        'ERC1155PresetMinterPauser: must have minter role to mint',", "highlightLines": [86]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC1155/presets/ERC1155PresetMinterPauser.test.js", "line": 86, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "34a3056364a2", "fix": {"template": null, "available": false}, "title": "Password reset endpoint - add rate limiting to prevent abuse", "ruleId": "rules.express-password-reset-no-rate-limit", "snippet": {"code": "        'ERC1155PresetMinterPauser: must have pauser role to pause',", "highlightLines": [120]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC1155/presets/ERC1155PresetMinterPauser.test.js", "line": 120, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "80be93b0bc2c", "fix": {"template": null, "available": false}, "title": "Password reset endpoint - add rate limiting to prevent abuse", "ruleId": "rules.express-password-reset-no-rate-limit", "snippet": {"code": "        'ERC1155PresetMinterPauser: must have pauser role to unpause',", "highlightLines": [129]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC1155/presets/ERC1155PresetMinterPauser.test.js", "line": 129, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "37dc5134ba38", "fix": {"template": null, "available": false}, "title": "Security/linting suppression comment - verify this is justified", "ruleId": "rules._shared.shared-comment-disable-security", "snippet": {"code": "/* eslint-disable */", "highlightLines": [1]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC20/extensions/ERC20FlashMint.test.js", "line": 1, "column": 1}, "severity": "medium", "references": [], "description": ""}, {"id": "82eb844a68af", "fix": {"template": null, "available": false}, "title": "Security/linting suppression comment - verify this is justified", "ruleId": "rules._shared.shared-comment-disable-security", "snippet": {"code": "/* eslint-disable */", "highlightLines": [1]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC20/extensions/ERC20Votes.test.js", "line": 1, "column": 1}, "severity": "medium", "references": [], "description": ""}, {"id": "af1732939947", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "  // The following tests are a adaptation of https://github.com/compound-finance/compound-protocol/blob/master/tests/Governance/CompTest.js.", "highlightLines": [325]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC20/extensions/ERC20Votes.test.js", "line": 325, "column": 91}, "severity": "medium", "references": [], "description": ""}, {"id": "4f5626b73afd", "fix": {"template": null, "available": false}, "title": "Security/linting suppression comment - verify this is justified", "ruleId": "rules._shared.shared-comment-disable-security", "snippet": {"code": "/* eslint-disable */", "highlightLines": [1]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC20/extensions/ERC20VotesComp.test.js", "line": 1, "column": 1}, "severity": "medium", "references": [], "description": ""}, {"id": "d27da41fa7a2", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "  // The following tests are a adaptation of https://github.com/compound-finance/compound-protocol/blob/master/tests/Governance/CompTest.js.", "highlightLines": [316]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC20/extensions/ERC20VotesComp.test.js", "line": 316, "column": 91}, "severity": "medium", "references": [], "description": ""}, {"id": "2216c75d43b7", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "  /// https://github.com/Rari-Capital/solmate/blob/main/src/test/ERC4626.t.sol", "highlightLines": [399]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC20/extensions/ERC4626.test.js", "line": 399, "column": 31}, "severity": "medium", "references": [], "description": ""}, {"id": "d16144585c3b", "fix": {"template": null, "available": false}, "title": "Security/linting suppression comment - verify this is justified", "ruleId": "rules._shared.shared-comment-disable-security", "snippet": {"code": "/* eslint-disable */", "highlightLines": [1]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC20/extensions/draft-ERC20Permit.test.js", "line": 1, "column": 1}, "severity": "medium", "references": [], "description": ""}, {"id": "c8d05deb1508", "fix": {"template": null, "available": false}, "title": "Password reset endpoint - add rate limiting to prevent abuse", "ruleId": "rules.express-password-reset-no-rate-limit", "snippet": {"code": "const ERC20PresetFixedSupply = artifacts.require('ERC20PresetFixedSupply');", "highlightLines": [6]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC20/presets/ERC20PresetFixedSupply.test.js", "line": 6, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "4468fc7bf1f1", "fix": {"template": null, "available": false}, "title": "Password reset endpoint - add rate limiting to prevent abuse", "ruleId": "rules.express-password-reset-no-rate-limit", "snippet": {"code": "contract('ERC20PresetFixedSupply', function (accounts) {", "highlightLines": [8]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC20/presets/ERC20PresetFixedSupply.test.js", "line": 8, "column": 17}, "severity": "info", "references": [], "description": ""}, {"id": "81d36acab83b", "fix": {"template": null, "available": false}, "title": "Password reset endpoint - add rate limiting to prevent abuse", "ruleId": "rules.express-password-reset-no-rate-limit", "snippet": {"code": "  const name = 'PresetFixedSupply';", "highlightLines": [11]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC20/presets/ERC20PresetFixedSupply.test.js", "line": 11, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "8bd6a5dfc38d", "fix": {"template": null, "available": false}, "title": "Password reset endpoint - add rate limiting to prevent abuse", "ruleId": "rules.express-password-reset-no-rate-limit", "snippet": {"code": "    this.token = await ERC20PresetFixedSupply.new(name, symbol, initialSupply, owner, { from: deployer });", "highlightLines": [18]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC20/presets/ERC20PresetFixedSupply.test.js", "line": 18, "column": 30}, "severity": "info", "references": [], "description": ""}, {"id": "008214865fe2", "fix": {"template": null, "available": false}, "title": "Password reset endpoint - add rate limiting to prevent abuse", "ruleId": "rules.express-password-reset-no-rate-limit", "snippet": {"code": "const ERC20PresetMinterPauser = artifacts.require('ERC20PresetMinterPauser');", "highlightLines": [6]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC20/presets/ERC20PresetMinterPauser.test.js", "line": 6, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "cb806632fe70", "fix": {"template": null, "available": false}, "title": "Password reset endpoint - add rate limiting to prevent abuse", "ruleId": "rules.express-password-reset-no-rate-limit", "snippet": {"code": "contract('ERC20PresetMinterPauser', function (accounts) {", "highlightLines": [8]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC20/presets/ERC20PresetMinterPauser.test.js", "line": 8, "column": 17}, "severity": "info", "references": [], "description": ""}, {"id": "f6be1fdcaadd", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "  const DEFAULT_ADMIN_ROLE = '0x0000000000000000000000000000000000000000000000000000000000000000';", "highlightLines": [16]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC20/presets/ERC20PresetMinterPauser.test.js", "line": 16, "column": 31}, "severity": "medium", "references": [], "description": ""}, {"id": "ba9aed091059", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "  const DEFAULT_ADMIN_ROLE = '0x0000000000000000000000000000000000000000000000000000000000000000';", "highlightLines": [16]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC20/presets/ERC20PresetMinterPauser.test.js", "line": 16, "column": 31}, "severity": "high", "references": [], "description": ""}, {"id": "6a61ca86e0b8", "fix": {"template": null, "available": false}, "title": "Password reset endpoint - add rate limiting to prevent abuse", "ruleId": "rules.express-password-reset-no-rate-limit", "snippet": {"code": "    this.token = await ERC20PresetMinterPauser.new(name, symbol, { from: deployer });", "highlightLines": [21]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC20/presets/ERC20PresetMinterPauser.test.js", "line": 21, "column": 30}, "severity": "info", "references": [], "description": ""}, {"id": "c0d1923f34dc", "fix": {"template": null, "available": false}, "title": "Password reset endpoint - add rate limiting to prevent abuse", "ruleId": "rules.express-password-reset-no-rate-limit", "snippet": {"code": "        'ERC20PresetMinterPauser: must have minter role to mint',", "highlightLines": [55]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC20/presets/ERC20PresetMinterPauser.test.js", "line": 55, "column": 16}, "severity": "info", "references": [], "description": ""}, {"id": "a297082ad7c7", "fix": {"template": null, "available": false}, "title": "Password reset endpoint - add rate limiting to prevent abuse", "ruleId": "rules.express-password-reset-no-rate-limit", "snippet": {"code": "        'ERC20PresetMinterPauser: must have pauser role to pause',", "highlightLines": [89]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC20/presets/ERC20PresetMinterPauser.test.js", "line": 89, "column": 16}, "severity": "info", "references": [], "description": ""}, {"id": "fd0d0d88cd3c", "fix": {"template": null, "available": false}, "title": "Password reset endpoint - add rate limiting to prevent abuse", "ruleId": "rules.express-password-reset-no-rate-limit", "snippet": {"code": "        'ERC20PresetMinterPauser: must have pauser role to unpause',", "highlightLines": [98]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC20/presets/ERC20PresetMinterPauser.test.js", "line": 98, "column": 16}, "severity": "info", "references": [], "description": ""}, {"id": "9330fa6905ec", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "        r: '0x71753dc5ecb5b4bfc0e3bc530d79ce5988760ed3f3a234c86a5546491f540775',", "highlightLines": [132]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC20/utils/SafeERC20.test.js", "line": 132, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "185a52752ec2", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "        r: '0x71753dc5ecb5b4bfc0e3bc530d79ce5988760ed3f3a234c86a5546491f540775',", "highlightLines": [132]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC20/utils/SafeERC20.test.js", "line": 132, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "fe475c088dc4", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "        s: '0x0049cedee5aed990aabed5ad6a9f6e3c565b63379894b5fa8b512eb2b79e485d',", "highlightLines": [133]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC20/utils/SafeERC20.test.js", "line": 133, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "a1dcd5bf776b", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "        s: '0x0049cedee5aed990aabed5ad6a9f6e3c565b63379894b5fa8b512eb2b79e485d',", "highlightLines": [133]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC20/utils/SafeERC20.test.js", "line": 133, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "13a04c1dd3d1", "fix": {"template": null, "available": false}, "title": "Object.assign with user input - prototype pollution risk (CWE-1321)", "ruleId": "rules.prototype-pollution-object-assign", "snippet": {"code": "  .reduce((acc, entry, idx) => Object.assign({ [entry]: idx }, acc), {});", "highlightLines": [10]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC721/ERC721.behavior.js", "line": 10, "column": 32}, "severity": "medium", "references": [], "description": ""}, {"id": "b2f7fc12fb66", "fix": {"template": null, "available": false}, "title": "Specific error for missing user enables username enumeration (CWE-204)", "ruleId": "rules.auth-username-enumeration", "snippet": {"code": "      describe('after transferring all tokens to another user', function () {", "highlightLines": [754]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC721/ERC721.behavior.js", "line": 754, "column": 51}, "severity": "medium", "references": [], "description": ""}, {"id": "bfdff50f5c34", "fix": {"template": null, "available": false}, "title": "Use === instead of == for comparison to avoid type coercion issues", "ruleId": "rules.double-equals-undefined", "snippet": {"code": "          if (this.token.setBaseURI === undefined) {", "highlightLines": [907]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC721/ERC721.behavior.js", "line": 907, "column": 38}, "severity": "info", "references": [], "description": ""}, {"id": "06529b115cd1", "fix": {"template": null, "available": false}, "title": "Security/linting suppression comment - verify this is justified", "ruleId": "rules._shared.shared-comment-disable-security", "snippet": {"code": "/* eslint-disable */", "highlightLines": [1]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC721/extensions/ERC721Votes.test.js", "line": 1, "column": 1}, "severity": "medium", "references": [], "description": ""}, {"id": "a9c38b4ec5e6", "fix": {"template": null, "available": false}, "title": "Password reset endpoint - add rate limiting to prevent abuse", "ruleId": "rules.express-password-reset-no-rate-limit", "snippet": {"code": "const ERC721PresetMinterPauserAutoId = artifacts.require('ERC721PresetMinterPauserAutoId');", "highlightLines": [7]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC721/presets/ERC721PresetMinterPauserAutoId.test.js", "line": 7, "column": 14}, "severity": "info", "references": [], "description": ""}, {"id": "c145e50a5efa", "fix": {"template": null, "available": false}, "title": "Password reset endpoint - add rate limiting to prevent abuse", "ruleId": "rules.express-password-reset-no-rate-limit", "snippet": {"code": "contract('ERC721PresetMinterPauserAutoId', function (accounts) {", "highlightLines": [9]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC721/presets/ERC721PresetMinterPauserAutoId.test.js", "line": 9, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "2cf9e1b3f919", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "  const DEFAULT_ADMIN_ROLE = '0x0000000000000000000000000000000000000000000000000000000000000000';", "highlightLines": [16]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC721/presets/ERC721PresetMinterPauserAutoId.test.js", "line": 16, "column": 31}, "severity": "medium", "references": [], "description": ""}, {"id": "f3a004d0f1e2", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "  const DEFAULT_ADMIN_ROLE = '0x0000000000000000000000000000000000000000000000000000000000000000';", "highlightLines": [16]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC721/presets/ERC721PresetMinterPauserAutoId.test.js", "line": 16, "column": 31}, "severity": "high", "references": [], "description": ""}, {"id": "bc9a3d9c968b", "fix": {"template": null, "available": false}, "title": "Password reset endpoint - add rate limiting to prevent abuse", "ruleId": "rules.express-password-reset-no-rate-limit", "snippet": {"code": "    this.token = await ERC721PresetMinterPauserAutoId.new(name, symbol, baseURI, { from: deployer });", "highlightLines": [20]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC721/presets/ERC721PresetMinterPauserAutoId.test.js", "line": 20, "column": 31}, "severity": "info", "references": [], "description": ""}, {"id": "1ce834f7627a", "fix": {"template": null, "available": false}, "title": "Password reset endpoint - add rate limiting to prevent abuse", "ruleId": "rules.express-password-reset-no-rate-limit", "snippet": {"code": "        'ERC721PresetMinterPauserAutoId: must have minter role to mint',", "highlightLines": [63]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC721/presets/ERC721PresetMinterPauserAutoId.test.js", "line": 63, "column": 17}, "severity": "info", "references": [], "description": ""}, {"id": "dcbfae1aa0bb", "fix": {"template": null, "available": false}, "title": "Password reset endpoint - add rate limiting to prevent abuse", "ruleId": "rules.express-password-reset-no-rate-limit", "snippet": {"code": "        'ERC721PresetMinterPauserAutoId: must have pauser role to pause',", "highlightLines": [97]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC721/presets/ERC721PresetMinterPauserAutoId.test.js", "line": 97, "column": 17}, "severity": "info", "references": [], "description": ""}, {"id": "875f4caa0740", "fix": {"template": null, "available": false}, "title": "Password reset endpoint - add rate limiting to prevent abuse", "ruleId": "rules.express-password-reset-no-rate-limit", "snippet": {"code": "        'ERC721PresetMinterPauserAutoId: must have pauser role to unpause',", "highlightLines": [106]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC721/presets/ERC721PresetMinterPauserAutoId.test.js", "line": 106, "column": 17}, "severity": "info", "references": [], "description": ""}, {"id": "768b02bfc3b5", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "function shouldBehaveLikeERC777UnauthorizedOperatorSendBurn (holder, recipient, operator, data, operatorData) {", "highlightLines": [18]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC777/ERC777.behavior.js", "line": 18, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "5e608f905013", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "  shouldBehaveLikeERC777UnauthorizedOperatorSend(holder, recipient, operator, data, operatorData);", "highlightLines": [19]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC777/ERC777.behavior.js", "line": 19, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "b30fcc4b0a7a", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "  shouldBehaveLikeERC777UnauthorizedOperatorBurn(holder, operator, data, operatorData);", "highlightLines": [20]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC777/ERC777.behavior.js", "line": 20, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "9a02768f4ccc", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "function shouldBehaveLikeERC777UnauthorizedOperatorSend (holder, recipient, operator, data, operatorData) {", "highlightLines": [96]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC777/ERC777.behavior.js", "line": 96, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "90c09e22db77", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "function shouldBehaveLikeERC777UnauthorizedOperatorBurn (holder, operator, data, operatorData) {", "highlightLines": [165]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC777/ERC777.behavior.js", "line": 165, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "0ec86f0a5b6f", "fix": {"template": null, "available": false}, "title": "Use === instead of == for comparison to avoid type coercion issues", "ruleId": "rules.double-equals-undefined", "snippet": {"code": "  const operatorCall = operator !== null;", "highlightLines": [182]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC777/ERC777.behavior.js", "line": 182, "column": 34}, "severity": "info", "references": [], "description": ""}, {"id": "59006afe840e", "fix": {"template": null, "available": false}, "title": "Use === instead of == for comparison to avoid type coercion issues", "ruleId": "rules.double-equals-undefined", "snippet": {"code": "  const operatorCall = operator !== null;", "highlightLines": [237]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC777/ERC777.behavior.js", "line": 237, "column": 34}, "severity": "info", "references": [], "description": ""}, {"id": "e619e9e2cc5d", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "function shouldBehaveLikeERC777SendBurnMintInternalWithReceiveHook (operator, amount, data, operatorData) {", "highlightLines": [318]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC777/ERC777.behavior.js", "line": 318, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "14fb4431ca0b", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "function shouldBehaveLikeERC777SendBurnWithSendHook (operator, amount, data, operatorData) {", "highlightLines": [412]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC777/ERC777.behavior.js", "line": 412, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "7e948c5d35e4", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "  shouldBehaveLikeERC777UnauthorizedOperatorSendBurn,", "highlightLines": [551]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC777/ERC777.behavior.js", "line": 551, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "86c4879fbafc", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "  shouldBehaveLikeERC777SendBurnMintInternalWithReceiveHook,", "highlightLines": [553]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC777/ERC777.behavior.js", "line": 553, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "89251148f266", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "  shouldBehaveLikeERC777SendBurnWithSendHook,", "highlightLines": [554]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC777/ERC777.behavior.js", "line": 554, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "c4c67b6c8d56", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "  shouldBehaveLikeERC777UnauthorizedOperatorSendBurn,", "highlightLines": [9]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC777/ERC777.test.js", "line": 9, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "972ebe7294f5", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "  shouldBehaveLikeERC777SendBurnMintInternalWithReceiveHook,", "highlightLines": [11]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC777/ERC777.test.js", "line": 11, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "1367e0f5fc7f", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "  shouldBehaveLikeERC777SendBurnWithSendHook,", "highlightLines": [12]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC777/ERC777.test.js", "line": 12, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "218786de5b43", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "          shouldBehaveLikeERC777UnauthorizedOperatorSendBurn(holder, anyone, newOperator, data, operatorData);", "highlightLines": [138]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC777/ERC777.test.js", "line": 138, "column": 11}, "severity": "medium", "references": [], "description": ""}, {"id": "74db0ef654fb", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "            shouldBehaveLikeERC777UnauthorizedOperatorSendBurn(holder, anyone, newOperator, data, operatorData);", "highlightLines": [153]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC777/ERC777.test.js", "line": 153, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "add2745ad873", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "            shouldBehaveLikeERC777SendBurnMintInternalWithReceiveHook(operator, amount, data, operatorData);", "highlightLines": [478]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC777/ERC777.test.js", "line": 478, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "911cb12cda45", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "            shouldBehaveLikeERC777SendBurnMintInternalWithReceiveHook(operator, amount, data, operatorData);", "highlightLines": [491]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC777/ERC777.test.js", "line": 491, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "a6bfebe13632", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "            shouldBehaveLikeERC777SendBurnMintInternalWithReceiveHook(operator, amount, data, operatorData);", "highlightLines": [502]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC777/ERC777.test.js", "line": 502, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "bb7225681cd9", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "          shouldBehaveLikeERC777SendBurnWithSendHook(operator, amount, data, operatorData);", "highlightLines": [526]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC777/ERC777.test.js", "line": 526, "column": 11}, "severity": "medium", "references": [], "description": ""}, {"id": "8798fc4c879c", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "          shouldBehaveLikeERC777SendBurnWithSendHook(operator, amount, data, operatorData);", "highlightLines": [545]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC777/ERC777.test.js", "line": 545, "column": 11}, "severity": "medium", "references": [], "description": ""}, {"id": "d5098499f938", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "          shouldBehaveLikeERC777SendBurnWithSendHook(operator, amount, data, operatorData);", "highlightLines": [562]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC777/ERC777.test.js", "line": 562, "column": 11}, "severity": "medium", "references": [], "description": ""}, {"id": "53c3b54a116f", "fix": {"template": null, "available": false}, "title": "Password reset endpoint - add rate limiting to prevent abuse", "ruleId": "rules.express-password-reset-no-rate-limit", "snippet": {"code": "const ERC777PresetFixedSupply = artifacts.require('ERC777PresetFixedSupply');", "highlightLines": [5]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC777/presets/ERC777PresetFixedSupply.test.js", "line": 5, "column": 14}, "severity": "info", "references": [], "description": ""}, {"id": "a95dc74c3ad6", "fix": {"template": null, "available": false}, "title": "Password reset endpoint - add rate limiting to prevent abuse", "ruleId": "rules.express-password-reset-no-rate-limit", "snippet": {"code": "contract('ERC777PresetFixedSupply', function (accounts) {", "highlightLines": [7]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC777/presets/ERC777PresetFixedSupply.test.js", "line": 7, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "db43da3fa843", "fix": {"template": null, "available": false}, "title": "Password reset endpoint - add rate limiting to prevent abuse", "ruleId": "rules.express-password-reset-no-rate-limit", "snippet": {"code": "  const name = 'ERC777Preset';", "highlightLines": [11]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC777/presets/ERC777PresetFixedSupply.test.js", "line": 11, "column": 24}, "severity": "info", "references": [], "description": ""}, {"id": "3d91e5a4ae09", "fix": {"template": null, "available": false}, "title": "Password reset endpoint - add rate limiting to prevent abuse", "ruleId": "rules.express-password-reset-no-rate-limit", "snippet": {"code": "    this.token = await ERC777PresetFixedSupply.new(name, symbol, defaultOperators, initialSupply, owner);", "highlightLines": [21]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC777/presets/ERC777PresetFixedSupply.test.js", "line": 21, "column": 31}, "severity": "info", "references": [], "description": ""}, {"id": "5029ed17f4dd", "fix": {"template": null, "available": false}, "title": "Password reset endpoint - add rate limiting to prevent abuse", "ruleId": "rules.express-password-reset-no-rate-limit", "snippet": {"code": "    it('can reset token after setting royalty', async function () {", "highlightLines": [121]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/token/common/ERC2981.behavior.js", "line": 121, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "cb129ee7791e", "fix": {"template": null, "available": false}, "title": "Password reset endpoint - add rate limiting to prevent abuse", "ruleId": "rules.express-password-reset-no-rate-limit", "snippet": {"code": "  describe('reset', function () {", "highlightLines": [65]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/utils/Counters.test.js", "line": 65, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "295401d962f9", "fix": {"template": null, "available": false}, "title": "Password reset endpoint - add rate limiting to prevent abuse", "ruleId": "rules.express-password-reset-no-rate-limit", "snippet": {"code": "        await this.counter.reset();", "highlightLines": [68]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/utils/Counters.test.js", "line": 68, "column": 28}, "severity": "info", "references": [], "description": ""}, {"id": "75b0fc313e1c", "fix": {"template": null, "available": false}, "title": "Password reset endpoint - add rate limiting to prevent abuse", "ruleId": "rules.express-password-reset-no-rate-limit", "snippet": {"code": "      it('reset to 0', async function () {", "highlightLines": [78]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/utils/Counters.test.js", "line": 78, "column": 11}, "severity": "info", "references": [], "description": ""}, {"id": "a1f759a80258", "fix": {"template": null, "available": false}, "title": "Password reset endpoint - add rate limiting to prevent abuse", "ruleId": "rules.express-password-reset-no-rate-limit", "snippet": {"code": "        await this.counter.reset();", "highlightLines": [79]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/utils/Counters.test.js", "line": 79, "column": 28}, "severity": "info", "references": [], "description": ""}, {"id": "d784aa5fe9d1", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "        .to.equal('0x0000000000000000000000000000000000000000000000000000000000004132');", "highlightLines": [44]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/utils/Strings.test.js", "line": 44, "column": 20}, "severity": "medium", "references": [], "description": ""}, {"id": "0f1659febf0b", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "        .to.equal('0x0000000000000000000000000000000000000000000000000000000000004132');", "highlightLines": [44]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/utils/Strings.test.js", "line": 44, "column": 20}, "severity": "high", "references": [], "description": ""}, {"id": "6ba5dfe13c98", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "      const addr = '0xa9036907dccae6a1e0033479b12e837e5cf5a02f';", "highlightLines": [62]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/utils/Strings.test.js", "line": 62, "column": 21}, "severity": "medium", "references": [], "description": ""}, {"id": "282cc4369ae1", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "      const addr = '0x0000e0ca771e21bd00057f54a68c30d400000000';", "highlightLines": [67]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/utils/Strings.test.js", "line": 67, "column": 21}, "severity": "medium", "references": [], "description": ""}, {"id": "96621d441cdd", "fix": {"template": null, "available": false}, "title": "Password reset endpoint - add rate limiting to prevent abuse", "ruleId": "rules.express-password-reset-no-rate-limit", "snippet": {"code": "  it('reset', async function () {", "highlightLines": [38]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/utils/TimersBlockNumberImpl.test.js", "line": 38, "column": 7}, "severity": "info", "references": [], "description": ""}, {"id": "e5b13a2c5871", "fix": {"template": null, "available": false}, "title": "Password reset endpoint - add rate limiting to prevent abuse", "ruleId": "rules.express-password-reset-no-rate-limit", "snippet": {"code": "    await this.instance.reset();", "highlightLines": [39]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/utils/TimersBlockNumberImpl.test.js", "line": 39, "column": 25}, "severity": "info", "references": [], "description": ""}, {"id": "c87533c334e6", "fix": {"template": null, "available": false}, "title": "Password reset endpoint - add rate limiting to prevent abuse", "ruleId": "rules.express-password-reset-no-rate-limit", "snippet": {"code": "  it('reset', async function () {", "highlightLines": [38]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/utils/TimersTimestamp.test.js", "line": 38, "column": 7}, "severity": "info", "references": [], "description": ""}, {"id": "d0ce5f8a538e", "fix": {"template": null, "available": false}, "title": "Password reset endpoint - add rate limiting to prevent abuse", "ruleId": "rules.express-password-reset-no-rate-limit", "snippet": {"code": "    await this.instance.reset();", "highlightLines": [39]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/utils/TimersTimestamp.test.js", "line": 39, "column": 25}, "severity": "info", "references": [], "description": ""}, {"id": "e9cee48eb82c", "fix": {"template": null, "available": false}, "title": "Dynamic property assignment - prototype pollution if key is user-controlled", "ruleId": "rules.bracket-notation-user-input", "snippet": {"code": "  short[32] |= (long[64] % 27) << 7; // set the first bit of the 32nd byte to the v parity bit", "highlightLines": [21]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/utils/cryptography/ECDSA.test.js", "line": 21, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "e1b7a8539af5", "fix": {"template": null, "available": false}, "title": "Dynamic property assignment - prototype pollution if key is user-controlled", "ruleId": "rules.bracket-notation-user-input", "snippet": {"code": "  short[32] &= (1 << 7) - 1; // zero out the first bit of 1 the 32nd byte", "highlightLines": [31]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/utils/cryptography/ECDSA.test.js", "line": 31, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "fa2bec8b18d6", "fix": {"template": null, "available": false}, "title": "Security/linting suppression comment - verify this is justified", "ruleId": "rules._shared.shared-comment-disable-security", "snippet": {"code": "        // eslint-disable-next-line max-len", "highlightLines": [68]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/utils/cryptography/ECDSA.test.js", "line": 68, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "626949bbf72c", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "        this.ecdsa.recover(TEST_MESSAGE, '0x01234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789'),", "highlightLines": [69]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/utils/cryptography/ECDSA.test.js", "line": 69, "column": 43}, "severity": "medium", "references": [], "description": ""}, {"id": "804f00411051", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "        this.ecdsa.recover(TEST_MESSAGE, '0x01234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789'),", "highlightLines": [69]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/utils/cryptography/ECDSA.test.js", "line": 69, "column": 43}, "severity": "high", "references": [], "description": ""}, {"id": "08b4f40c04ea", "fix": {"template": null, "available": false}, "title": "Potential American Express card number detected - PCI DSS violation if real", "ruleId": "rules._shared.shared-credit-card-amex", "snippet": {"code": "        this.ecdsa.recover(TEST_MESSAGE, '0x01234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789'),", "highlightLines": [69]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/utils/cryptography/ECDSA.test.js", "line": 69, "column": 48}, "severity": "high", "references": [], "description": ""}, {"id": "6debbd0f3aae", "fix": {"template": null, "available": false}, "title": "Potential Visa card number detected - PCI DSS violation if real", "ruleId": "rules._shared.shared-credit-card-visa", "snippet": {"code": "        this.ecdsa.recover(TEST_MESSAGE, '0x01234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789'),", "highlightLines": [69]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/utils/cryptography/ECDSA.test.js", "line": 69, "column": 49}, "severity": "high", "references": [], "description": ""}, {"id": "31161e99866f", "fix": {"template": null, "available": false}, "title": "Security/linting suppression comment - verify this is justified", "ruleId": "rules._shared.shared-comment-disable-security", "snippet": {"code": "        // eslint-disable-next-line max-len", "highlightLines": [105]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/utils/cryptography/ECDSA.test.js", "line": 105, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "7f8cb2e98aa2", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "        const signature = '0x332ce75a821c982f9127538858900d87d3ec1f9f737338ad67cad133fa48feff48e6fa0c18abc62e42820f05943e47af3e9fbe306ce74d64094bdf1691ee53e01c';", "highlightLines": [106]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/utils/cryptography/ECDSA.test.js", "line": 106, "column": 28}, "severity": "medium", "references": [], "description": ""}, {"id": "67791b92c60b", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "        const signature = '0x332ce75a821c982f9127538858900d87d3ec1f9f737338ad67cad133fa48feff48e6fa0c18abc62e42820f05943e47af3e9fbe306ce74d64094bdf1691ee53e01c';", "highlightLines": [106]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/utils/cryptography/ECDSA.test.js", "line": 106, "column": 28}, "severity": "high", "references": [], "description": ""}, {"id": "289b7d9f9132", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "      const signer = '0x2cc1166f6212628A0deEf2B33BEFB2187D35b86c';", "highlightLines": [113]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/utils/cryptography/ECDSA.test.js", "line": 113, "column": 23}, "severity": "medium", "references": [], "description": ""}, {"id": "1d07877cc592", "fix": {"template": null, "available": false}, "title": "Security/linting suppression comment - verify this is justified", "ruleId": "rules._shared.shared-comment-disable-security", "snippet": {"code": "      // eslint-disable-next-line max-len", "highlightLines": [114]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/utils/cryptography/ECDSA.test.js", "line": 114, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "c6d82cb001e3", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "      const signatureWithoutVersion = '0x5d99b6f7f6d1f73d1a26497f2b1c89b24c0993913f86e9a2d02cd69887d9c94f3c880358579d811b21dd1b7fd9bb01c1d81d10e69f0384e675c32b39643be892';", "highlightLines": [115]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/utils/cryptography/ECDSA.test.js", "line": 115, "column": 40}, "severity": "medium", "references": [], "description": ""}, {"id": "2a7d4032c3e3", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "      const signatureWithoutVersion = '0x5d99b6f7f6d1f73d1a26497f2b1c89b24c0993913f86e9a2d02cd69887d9c94f3c880358579d811b21dd1b7fd9bb01c1d81d10e69f0384e675c32b39643be892';", "highlightLines": [115]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/utils/cryptography/ECDSA.test.js", "line": 115, "column": 40}, "severity": "high", "references": [], "description": ""}, {"id": "a473e18e0326", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "      const signer = '0x1E318623aB09Fe6de3C9b8672098464Aeda9100E';", "highlightLines": [156]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/utils/cryptography/ECDSA.test.js", "line": 156, "column": 23}, "severity": "medium", "references": [], "description": ""}, {"id": "c7a90cf28f22", "fix": {"template": null, "available": false}, "title": "Security/linting suppression comment - verify this is justified", "ruleId": "rules._shared.shared-comment-disable-security", "snippet": {"code": "      // eslint-disable-next-line max-len", "highlightLines": [157]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/utils/cryptography/ECDSA.test.js", "line": 157, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "d32d5441d10b", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "      const signatureWithoutVersion = '0x331fe75a821c982f9127538858900d87d3ec1f9f737338ad67cad133fa48feff48e6fa0c18abc62e42820f05943e47af3e9fbe306ce74d64094bdf1691ee53e0';", "highlightLines": [158]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/utils/cryptography/ECDSA.test.js", "line": 158, "column": 40}, "severity": "medium", "references": [], "description": ""}, {"id": "e0524a03349f", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "      const signatureWithoutVersion = '0x331fe75a821c982f9127538858900d87d3ec1f9f737338ad67cad133fa48feff48e6fa0c18abc62e42820f05943e47af3e9fbe306ce74d64094bdf1691ee53e0';", "highlightLines": [158]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/utils/cryptography/ECDSA.test.js", "line": 158, "column": 40}, "severity": "high", "references": [], "description": ""}, {"id": "551e101a9a40", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "      const message = '0xb94d27b9934d3e08a52e52d7da7dabfac484efe37a5380ee9088f7ace2efcde9';", "highlightLines": [199]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/utils/cryptography/ECDSA.test.js", "line": 199, "column": 24}, "severity": "medium", "references": [], "description": ""}, {"id": "7d0e611942d9", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "      const message = '0xb94d27b9934d3e08a52e52d7da7dabfac484efe37a5380ee9088f7ace2efcde9';", "highlightLines": [199]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/utils/cryptography/ECDSA.test.js", "line": 199, "column": 24}, "severity": "high", "references": [], "description": ""}, {"id": "f123eb196038", "fix": {"template": null, "available": false}, "title": "Security/linting suppression comment - verify this is justified", "ruleId": "rules._shared.shared-comment-disable-security", "snippet": {"code": "      // eslint-disable-next-line max-len", "highlightLines": [200]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/utils/cryptography/ECDSA.test.js", "line": 200, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "0fd333324632", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "      const highSSignature = '0xe742ff452d41413616a5bf43fe15dd88294e983d3d36206c2712f39083d638bde0a0fc89be718fbc1033e1d30d78be1c68081562ed2e97af876f286f3453231d1b';", "highlightLines": [201]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/utils/cryptography/ECDSA.test.js", "line": 201, "column": 31}, "severity": "medium", "references": [], "description": ""}, {"id": "c50e78e7074e", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "      const highSSignature = '0xe742ff452d41413616a5bf43fe15dd88294e983d3d36206c2712f39083d638bde0a0fc89be718fbc1033e1d30d78be1c68081562ed2e97af876f286f3453231d1b';", "highlightLines": [201]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/utils/cryptography/ECDSA.test.js", "line": 201, "column": 31}, "severity": "high", "references": [], "description": ""}, {"id": "29e19a1b03e6", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "      const elements = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/='.split('');", "highlightLines": [18]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/utils/cryptography/MerkleProof.test.js", "line": 18, "column": 25}, "severity": "medium", "references": [], "description": ""}, {"id": "cbee174dc886", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "const DUMMY_ACCOUNT = '0x1111111111111111111111111111111111111111';", "highlightLines": [16]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/utils/introspection/ERC165Checker.test.js", "line": 16, "column": 24}, "severity": "medium", "references": [], "description": ""}, {"id": "540e9b7b7393", "fix": {"template": null, "available": false}, "title": "Dynamic property assignment - prototype pollution if key is user-controlled", "ruleId": "rules.bracket-notation-user-input", "snippet": {"code": "  INTERFACE_IDS[k] = makeInterfaceId.ERC165(INTERFACES[k]);", "highlightLines": [107]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/utils/introspection/SupportsInterface.behavior.js", "line": 107, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "dceada166636", "fix": {"template": null, "available": false}, "title": "Dynamic property assignment - prototype pollution if key is user-controlled", "ruleId": "rules.bracket-notation-user-input", "snippet": {"code": "    FN_SIGNATURES[fnName] = makeInterfaceId.ERC165([fnName]);", "highlightLines": [110]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/utils/introspection/SupportsInterface.behavior.js", "line": 110, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "600bb2ae1a80", "fix": {"template": null, "available": false}, "title": "Potential American Express card number detected - PCI DSS violation if real", "ruleId": "rules._shared.shared-credit-card-amex", "snippet": {"code": "        .to.be.bignumber.equal('340282366920938463463374607431768211455');", "highlightLines": [200]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/utils/math/Math.test.js", "line": 200, "column": 33}, "severity": "high", "references": [], "description": ""}, {"id": "3d530cc9fe09", "fix": {"template": null, "available": false}, "title": "Potential Visa card number detected - PCI DSS violation if real", "ruleId": "rules._shared.shared-credit-card-visa", "snippet": {"code": "        .to.be.bignumber.equal('340282366920938463463374607431768211455');", "highlightLines": [200]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/utils/math/Math.test.js", "line": 200, "column": 34}, "severity": "high", "references": [], "description": ""}, {"id": "4212e657b459", "fix": {"template": null, "available": false}, "title": "Potential American Express card number detected - PCI DSS violation if real", "ruleId": "rules._shared.shared-credit-card-amex", "snippet": {"code": "        .to.be.bignumber.equal('340282366920938463463374607431768211456');", "highlightLines": [216]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/utils/math/Math.test.js", "line": 216, "column": 33}, "severity": "high", "references": [], "description": ""}, {"id": "4ffe8d9951d1", "fix": {"template": null, "available": false}, "title": "Potential Visa card number detected - PCI DSS violation if real", "ruleId": "rules._shared.shared-credit-card-visa", "snippet": {"code": "        .to.be.bignumber.equal('340282366920938463463374607431768211456');", "highlightLines": [216]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/utils/math/Math.test.js", "line": 216, "column": 34}, "severity": "high", "references": [], "description": ""}, {"id": "d45442f27622", "fix": {"template": null, "available": false}, "title": "Use === instead of == for comparison to avoid type coercion issues", "ruleId": "rules.double-equals-undefined", "snippet": {"code": "    if (reason === undefined) {", "highlightLines": [29]}, "category": "code", "location": {"file": "lib/openzeppelin-contracts/test/utils/math/SafeMath.test.js", "line": 29, "column": 17}, "severity": "info", "references": [], "description": ""}, {"id": "11bf71cac551", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.18;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/ApproveScam.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "9f03fb3a4474", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract ContractTest is Test {\n    ERC20 ERC20Contract;\n    address alice = vm.addr(1);\n    address eve = vm.addr(2);", "highlightLines": [20]}, "category": "code", "location": {"file": "src/test/ApproveScam.sol", "line": 20, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "5cfcf20b5c18", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address alice = vm.addr(1);", "highlightLines": [22]}, "category": "code", "location": {"file": "src/test/ApproveScam.sol", "line": 22, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ce9613b58e98", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address eve = vm.addr(2);", "highlightLines": [23]}, "category": "code", "location": {"file": "src/test/ApproveScam.sol", "line": 23, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "013311d12ad6", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        ERC20Contract = new ERC20();", "highlightLines": [26]}, "category": "code", "location": {"file": "src/test/ApproveScam.sol", "line": 26, "column": 25}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "8392d6b2ed5c", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        ERC20Contract.transfer(address(alice), 1000);", "highlightLines": [28]}, "category": "code", "location": {"file": "src/test/ApproveScam.sol", "line": 28, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "71056fd44781", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "        ERC20Contract.transfer(address(alice), 1000);", "highlightLines": [28]}, "category": "code", "location": {"file": "src/test/ApproveScam.sol", "line": 28, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "ac544de646b5", "fix": {"template": null, "available": false}, "title": "ERC20 transfer() return value not checked - tokens like USDT don't return bool", "ruleId": "rules.sol-erc20-transfer-no-return-check", "snippet": {"code": "        ERC20Contract.transfer(address(alice), 1000);", "highlightLines": [28]}, "category": "code", "location": {"file": "src/test/ApproveScam.sol", "line": 28, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "f2fafed7442d", "fix": {"template": null, "available": false}, "title": "Unlimited token approval - use exact amount needed", "ruleId": "rules.sol-approve-max", "snippet": {"code": "        ERC20Contract.approve(address(eve), type(uint256).max);", "highlightLines": [34]}, "category": "code", "location": {"file": "src/test/ApproveScam.sol", "line": 34, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "e8f0eb4b5e43", "fix": {"template": null, "available": false}, "title": "Unlimited token approval (type(uint256).max) - user loses control of all tokens", "ruleId": "rules.sol-approval-scam-max-uint", "snippet": {"code": "        ERC20Contract.approve(address(eve), type(uint256).max);", "highlightLines": [34]}, "category": "code", "location": {"file": "src/test/ApproveScam.sol", "line": 34, "column": 22}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/ApproveScam.sol"], "description": ""}, {"id": "f85b4e12f814", "fix": {"template": null, "available": false}, "title": "Unlimited token approval using type(uint256).max - consider limited approvals", "ruleId": "rules.sol-unlimited-approval-type-max", "snippet": {"code": "        ERC20Contract.approve(address(eve), type(uint256).max);", "highlightLines": [34]}, "category": "code", "location": {"file": "src/test/ApproveScam.sol", "line": 34, "column": 22}, "severity": "medium", "references": [], "description": ""}, {"id": "c7bb6369b7c2", "fix": {"template": null, "available": false}, "title": "Token transfer without checking actual received amount - deflationary tokens may transfer less", "ruleId": "rules.sol-deflationary-token-transfer", "snippet": {"code": "        ERC20Contract.transferFrom(address(alice), address(eve), 1000);", "highlightLines": [45]}, "category": "code", "location": {"file": "src/test/ApproveScam.sol", "line": 45, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "08d2baa082da", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        ERC20Contract.transferFrom(address(alice), address(eve), 1000);", "highlightLines": [45]}, "category": "code", "location": {"file": "src/test/ApproveScam.sol", "line": 45, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "f15e4653907b", "fix": {"template": null, "available": false}, "title": "Token amount after transfer may differ - check actual received amount", "ruleId": "rules.sol-fee-on-transfer-token", "snippet": {"code": "        ERC20Contract.transferFrom(address(alice), address(eve), 1000);", "highlightLines": [45]}, "category": "code", "location": {"file": "src/test/ApproveScam.sol", "line": 45, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "a4fa9b28226b", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    receive() external payable {}", "highlightLines": [53]}, "category": "code", "location": {"file": "src/test/ApproveScam.sol", "line": 53, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "f203ef25621f", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "    receive() external payable {}", "highlightLines": [53]}, "category": "code", "location": {"file": "src/test/ApproveScam.sol", "line": 53, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "0ab6d494529b", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function totalSupply() external view returns (uint);\n\n    function balanceOf(address account) external view returns (uint);\n\n    function transfer(address recipient, uint amount) external returns (bool);\n\n    function allowance(\n        address owner,\n        address spender\n    ) external view returns (uint);\n\n    function approve(address spender, uint amount) external returns (bool);\n\n    function transferFrom(\n        address sender,\n        address recipient,\n        uint amount\n    ) external returns (bool);\n\n    event Transfer(address indexed from, address indexed to, uint value);\n    event Approval(address indexed owner, address indexed spender, uint value);\n}\n\ncontract ERC20 is IERC20 {\n    uint public totalSupply;\n    mapping(address => uint) public balanceOf;\n    mapping(address => mapping(address => uint)) public allowance;\n    string public name = \"Test example\";\n    string public symbol = \"Test\";\n    uint8 public decimals = 18;", "highlightLines": [57]}, "category": "code", "location": {"file": "src/test/ApproveScam.sol", "line": 57, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "0bf8785c5c06", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function balanceOf(address account) external view returns (uint);", "highlightLines": [59]}, "category": "code", "location": {"file": "src/test/ApproveScam.sol", "line": 59, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "214f53b61c8e", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function balanceOf(address account) external view returns (uint);\n\n    function transfer(address recipient, uint amount) external returns (bool);\n\n    function allowance(\n        address owner,\n        address spender\n    ) external view returns (uint);\n\n    function approve(address spender, uint amount) external returns (bool);\n\n    function transferFrom(\n        address sender,\n        address recipient,\n        uint amount\n    ) external returns (bool);\n\n    event Transfer(address indexed from, address indexed to, uint value);\n    event Approval(address indexed owner, address indexed spender, uint value);\n}\n\ncontract ERC20 is IERC20 {\n    uint public totalSupply;\n    mapping(address => uint) public balanceOf;\n    mapping(address => mapping(address => uint)) public allowance;", "highlightLines": [59]}, "category": "code", "location": {"file": "src/test/ApproveScam.sol", "line": 59, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "0bc679cbca6a", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function transfer(address recipient, uint amount) external returns (bool);", "highlightLines": [61]}, "category": "code", "location": {"file": "src/test/ApproveScam.sol", "line": 61, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "a1e4f78a728f", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without msg.data.length validation - vulnerable to short address attack padding", "ruleId": "rules.sol-short-address-no-payload-check", "snippet": {"code": "    function transfer(address recipient, uint amount) external returns (bool);\n\n    function allowance(\n        address owner,\n        address spender\n    ) external view returns (uint);\n\n    function approve(address spender, uint amount) external returns (bool);\n\n    function transferFrom(\n        address sender,\n        address recipient,\n        uint amount\n    ) external returns (bool);\n\n    event Transfer(address indexed from, address indexed to, uint value);\n    event Approval(address indexed owner, address indexed spender, uint value);\n}\n\ncontract ERC20 is IERC20 {", "highlightLines": [61]}, "category": "code", "location": {"file": "src/test/ApproveScam.sol", "line": 61, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address", "https://vessenes.com/the-erc20-short-address-attack-explained/"], "description": ""}, {"id": "fb64003156eb", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function allowance(\n        address owner,\n        address spender\n    ) external view returns (uint);", "highlightLines": [63]}, "category": "code", "location": {"file": "src/test/ApproveScam.sol", "line": 63, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "ac7717f7e7c9", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function approve(address spender, uint amount) external returns (bool);", "highlightLines": [68]}, "category": "code", "location": {"file": "src/test/ApproveScam.sol", "line": 68, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "af8ed6123be5", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function transferFrom(\n        address sender,\n        address recipient,\n        uint amount\n    ) external returns (bool);", "highlightLines": [70]}, "category": "code", "location": {"file": "src/test/ApproveScam.sol", "line": 70, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "f6ad0451ce17", "fix": {"template": null, "available": false}, "title": "ERC20 transferFrom without payload size validation - consider adding onlyPayloadSize modifier", "ruleId": "rules.sol-erc20-missing-payload-modifier", "snippet": {"code": "    function transferFrom(\n        address sender,\n        address recipient,\n        uint amount\n    ) external returns (bool);\n\n    event Transfer(address indexed from, address indexed to, uint value);\n    event Approval(address indexed owner, address indexed spender, uint value);\n}\n\ncontract ERC20 is IERC20 {", "highlightLines": [70]}, "category": "code", "location": {"file": "src/test/ApproveScam.sol", "line": 70, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address"], "description": ""}, {"id": "ba86cbbc2499", "fix": {"template": null, "available": false}, "title": "NFT transfer without approval/ownership check - add _isApprovedOrOwner validation", "ruleId": "rules.sol-nft-transfer-no-approval-check", "snippet": {"code": "    function transferFrom(\n        address sender,\n        address recipient,\n        uint amount\n    ) external returns (bool);\n\n    event Transfer(address indexed from, address indexed to, uint value);\n    event Approval(address indexed owner, address indexed spender, uint value);\n}\n\ncontract ERC20 is IERC20 {", "highlightLines": [70]}, "category": "code", "location": {"file": "src/test/ApproveScam.sol", "line": 70, "column": 5}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/NFT-transfer.sol"], "description": ""}, {"id": "7b1cdaf5338c", "fix": {"template": null, "available": false}, "title": "transferFrom deducts from msg.sender instead of from parameter - allows unauthorized transfers (TokenWhale pattern)", "ruleId": "rules.sol-transferfrom-msg-sender-balance", "snippet": {"code": "    function transferFrom(\n        address sender,\n        address recipient,\n        uint amount\n    ) external returns (bool);\n\n    event Transfer(address indexed from, address indexed to, uint value);\n    event Approval(address indexed owner, address indexed spender, uint value);\n}\n\ncontract ERC20 is IERC20 {\n    uint public totalSupply;\n    mapping(address => uint) public balanceOf;\n    mapping(address => mapping(address => uint)) public allowance;\n    string public name = \"Test example\";\n    string public symbol = \"Test\";\n    uint8 public decimals = 18;\n\n    function transfer(address recipient, uint amount) external returns (bool) {\n        balanceOf[msg.sender] -= amount;", "highlightLines": [70]}, "category": "code", "location": {"file": "src/test/ApproveScam.sol", "line": 70, "column": 5}, "severity": "high", "references": ["https://capturetheether.com/challenges/math/token-whale/"], "description": ""}, {"id": "9784809947bc", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Transfer(address indexed from, address indexed to, uint value);", "highlightLines": [76]}, "category": "code", "location": {"file": "src/test/ApproveScam.sol", "line": 76, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "1ae2615bbc3d", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Approval(address indexed owner, address indexed spender, uint value);", "highlightLines": [77]}, "category": "code", "location": {"file": "src/test/ApproveScam.sol", "line": 77, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "f685b69f196f", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "contract ERC20 is IERC20 {", "highlightLines": [80]}, "category": "code", "location": {"file": "src/test/ApproveScam.sol", "line": 80, "column": 1}, "severity": "medium", "references": [], "description": ""}, {"id": "508e69119e30", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract ERC20 is IERC20 {\n    uint public totalSupply;\n    mapping(address => uint) public balanceOf;\n    mapping(address => mapping(address => uint)) public allowance;\n    string public name = \"Test example\";\n    string public symbol = \"Test\";\n    uint8 public decimals = 18;", "highlightLines": [80]}, "category": "code", "location": {"file": "src/test/ApproveScam.sol", "line": 80, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "be15a6e22032", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function transfer(address recipient, uint amount) external returns (bool) {", "highlightLines": [88]}, "category": "code", "location": {"file": "src/test/ApproveScam.sol", "line": 88, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "5bbe5ab28706", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without msg.data.length validation - vulnerable to short address attack padding", "ruleId": "rules.sol-short-address-no-payload-check", "snippet": {"code": "    function transfer(address recipient, uint amount) external returns (bool) {", "highlightLines": [88]}, "category": "code", "location": {"file": "src/test/ApproveScam.sol", "line": 88, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address", "https://vessenes.com/the-erc20-short-address-attack-explained/"], "description": ""}, {"id": "f0da0a83ceaf", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function approve(address spender, uint amount) external returns (bool) {", "highlightLines": [95]}, "category": "code", "location": {"file": "src/test/ApproveScam.sol", "line": 95, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "17401383c3ce", "fix": {"template": null, "available": false}, "title": "ERC20 transferFrom without payload size validation - consider adding onlyPayloadSize modifier", "ruleId": "rules.sol-erc20-missing-payload-modifier", "snippet": {"code": "    function transferFrom(\n        address sender,\n        address recipient,\n        uint amount\n    ) external returns (bool) {", "highlightLines": [101]}, "category": "code", "location": {"file": "src/test/ApproveScam.sol", "line": 101, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address"], "description": ""}, {"id": "ddce65dfa3c4", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function transferFrom(\n        address sender,\n        address recipient,\n        uint amount\n    ) external returns (bool) {", "highlightLines": [101]}, "category": "code", "location": {"file": "src/test/ApproveScam.sol", "line": 101, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "f2f1644e704f", "fix": {"template": null, "available": false}, "title": "NFT transfer without approval/ownership check - add _isApprovedOrOwner validation", "ruleId": "rules.sol-nft-transfer-no-approval-check", "snippet": {"code": "    function transferFrom(\n        address sender,\n        address recipient,\n        uint amount\n    ) external returns (bool) {", "highlightLines": [101]}, "category": "code", "location": {"file": "src/test/ApproveScam.sol", "line": 101, "column": 5}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/NFT-transfer.sol"], "description": ""}, {"id": "4445e1d44928", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function mint(uint amount) external {", "highlightLines": [113]}, "category": "code", "location": {"file": "src/test/ApproveScam.sol", "line": 113, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "8ad915b5053a", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function burn(uint amount) external {", "highlightLines": [119]}, "category": "code", "location": {"file": "src/test/ApproveScam.sol", "line": 119, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "b2781ce13c18", "fix": {"template": null, "available": false}, "title": "Public burn function without access control - anyone can burn tokens", "ruleId": "rules.sol-erc20-public-burn", "snippet": {"code": "    function burn(uint amount) external {", "highlightLines": [119]}, "category": "code", "location": {"file": "src/test/ApproveScam.sol", "line": 119, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "d24385156da5", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.18;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/Array-deletion.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "e88484eb7633", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        ArrayDeletionBugContract = new ArrayDeletionBug();\n        FixedArrayDeletionContract = new FixedArrayDeletion();", "highlightLines": [30]}, "category": "code", "location": {"file": "src/test/Array-deletion.sol", "line": 30, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "8d236d75732e", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        ArrayDeletionBugContract = new ArrayDeletionBug();", "highlightLines": [30]}, "category": "code", "location": {"file": "src/test/Array-deletion.sol", "line": 30, "column": 36}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "113c42af0c46", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        FixedArrayDeletionContract = new FixedArrayDeletion();", "highlightLines": [31]}, "category": "code", "location": {"file": "src/test/Array-deletion.sol", "line": 31, "column": 38}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "12e416adfb64", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    receive() external payable {}", "highlightLines": [50]}, "category": "code", "location": {"file": "src/test/Array-deletion.sol", "line": 50, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "cc2bbc7b5d61", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "    receive() external payable {}", "highlightLines": [50]}, "category": "code", "location": {"file": "src/test/Array-deletion.sol", "line": 50, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "316200b16acd", "fix": {"template": null, "available": false}, "title": "Deleting mapping inside struct leaves nested data - use separate mapping deletion", "ruleId": "rules.sol-mapping-deletion", "snippet": {"code": "        delete myArray[index];", "highlightLines": [58]}, "category": "code", "location": {"file": "src/test/Array-deletion.sol", "line": 58, "column": 9}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#deletion-on-mapping-containing-a-structure"], "description": ""}, {"id": "17e2f05b9109", "fix": {"template": null, "available": false}, "title": "delete array[i] leaves gap with zero value - use swap-and-pop pattern instead", "ruleId": "rules.sol-array-element-delete", "snippet": {"code": "        delete myArray[index];", "highlightLines": [58]}, "category": "code", "location": {"file": "src/test/Array-deletion.sol", "line": 58, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/Array-deletion.sol"], "description": ""}, {"id": "deea9deded47", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.18;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/Backdoor-assembly.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "9f37f516008c", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract ContractTest is Test {\n    LotteryGame LotteryGameContract;\n\n    function testBackdoorCall() public {\n        address alice = vm.addr(1);\n        address bob = vm.addr(2);", "highlightLines": [28]}, "category": "code", "location": {"file": "src/test/Backdoor-assembly.sol", "line": 28, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "520294610951", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address alice = vm.addr(1);", "highlightLines": [32]}, "category": "code", "location": {"file": "src/test/Backdoor-assembly.sol", "line": 32, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "83d91a26ea09", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "        address alice = vm.addr(1);\n        address bob = vm.addr(2);", "highlightLines": [32]}, "category": "code", "location": {"file": "src/test/Backdoor-assembly.sol", "line": 32, "column": 9}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "44966d9ffe48", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address alice = vm.addr(1);\n        address bob = vm.addr(2);", "highlightLines": [32]}, "category": "code", "location": {"file": "src/test/Backdoor-assembly.sol", "line": 32, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "9b52e237c149", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address bob = vm.addr(2);", "highlightLines": [33]}, "category": "code", "location": {"file": "src/test/Backdoor-assembly.sol", "line": 33, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "cc77ef5d659a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address bob = vm.addr(2);\n        LotteryGameContract = new LotteryGame();", "highlightLines": [33]}, "category": "code", "location": {"file": "src/test/Backdoor-assembly.sol", "line": 33, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "804fb3770c66", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        LotteryGameContract = new LotteryGame();", "highlightLines": [34]}, "category": "code", "location": {"file": "src/test/Backdoor-assembly.sol", "line": 34, "column": 31}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "eb973effac71", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    receive() external payable {}", "highlightLines": [48]}, "category": "code", "location": {"file": "src/test/Backdoor-assembly.sol", "line": 48, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "cf5655230890", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "    receive() external payable {}", "highlightLines": [48]}, "category": "code", "location": {"file": "src/test/Backdoor-assembly.sol", "line": 48, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "4f62172c8470", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "    modifier safeCheck() {\n        if (msg.sender == referee()) {\n            _;\n        } else {", "highlightLines": [56]}, "category": "code", "location": {"file": "src/test/Backdoor-assembly.sol", "line": 56, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "17925701d398", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier safeCheck() {\n        if (msg.sender == referee()) {\n            _;\n        } else {\n            getkWinner();\n        }\n    }", "highlightLines": [56]}, "category": "code", "location": {"file": "src/test/Backdoor-assembly.sol", "line": 56, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "815bf639ce4c", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "            _;", "highlightLines": [58]}, "category": "code", "location": {"file": "src/test/Backdoor-assembly.sol", "line": 58, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "df28df464fe0", "fix": {"template": null, "available": false}, "title": "View/pure function uses assembly - may modify state unexpectedly", "ruleId": "rules.sol-constant-function-assembly", "snippet": {"code": "    function referee() internal view returns (address user) {\n        assembly {", "highlightLines": [64]}, "category": "code", "location": {"file": "src/test/Backdoor-assembly.sol", "line": 64, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-using-assembly-code"], "description": ""}, {"id": "89673419cfe5", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [65]}, "category": "code", "location": {"file": "src/test/Backdoor-assembly.sol", "line": 65, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "10b4ab1982f4", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [72]}, "category": "code", "location": {"file": "src/test/Backdoor-assembly.sol", "line": 72, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "dd4f3305be6e", "fix": {"template": null, "available": false}, "title": "Direct sstore in assembly can modify arbitrary storage slots - potential backdoor", "ruleId": "rules.sol-assembly-sstore-backdoor", "snippet": {"code": "        assembly {\n            // admin backddoor which can set winner address\n            sstore(1, random)", "highlightLines": [72]}, "category": "code", "location": {"file": "src/test/Backdoor-assembly.sol", "line": 72, "column": 9}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/Backdoor-assembly.sol"], "description": ""}, {"id": "91abd69e8b22", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.18;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/Bypasscontract.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "cfab3b745f83", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor() {\n        TargetContract = new Target();\n        FailedAttackContract = new FailedAttack();\n        TargetRemediatedContract = new TargetRemediated();\n    }", "highlightLines": [23]}, "category": "code", "location": {"file": "src/test/Bypasscontract.sol", "line": 23, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "2e8e2c56925c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        TargetContract = new Target();\n        FailedAttackContract = new FailedAttack();", "highlightLines": [24]}, "category": "code", "location": {"file": "src/test/Bypasscontract.sol", "line": 24, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e9b57620e6e1", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        TargetContract = new Target();", "highlightLines": [24]}, "category": "code", "location": {"file": "src/test/Bypasscontract.sol", "line": 24, "column": 26}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "b25b25e71f0c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        FailedAttackContract = new FailedAttack();\n        TargetRemediatedContract = new TargetRemediated();", "highlightLines": [25]}, "category": "code", "location": {"file": "src/test/Bypasscontract.sol", "line": 25, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "149378df9a6f", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        FailedAttackContract = new FailedAttack();", "highlightLines": [25]}, "category": "code", "location": {"file": "src/test/Bypasscontract.sol", "line": 25, "column": 32}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "15e1c797b6b9", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        TargetRemediatedContract = new TargetRemediated();", "highlightLines": [26]}, "category": "code", "location": {"file": "src/test/Bypasscontract.sol", "line": 26, "column": 36}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "3c837885e850", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        AttackerContract = new Attack(address(TargetContract));", "highlightLines": [43]}, "category": "code", "location": {"file": "src/test/Bypasscontract.sol", "line": 43, "column": 28}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "881eda3cead0", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    receive() external payable {}", "highlightLines": [51]}, "category": "code", "location": {"file": "src/test/Bypasscontract.sol", "line": 51, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "cd9e8d200f06", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "    receive() external payable {}", "highlightLines": [51]}, "category": "code", "location": {"file": "src/test/Bypasscontract.sol", "line": 51, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "09f90d17af96", "fix": {"template": null, "available": false}, "title": "View/pure function uses assembly - may modify state unexpectedly", "ruleId": "rules.sol-constant-function-assembly", "snippet": {"code": "    function isContract(address account) public view returns (bool) {\n        // This method relies on extcodesize, which returns 0 for contracts in\n        // construction, since the code is only stored at the end of the\n        // constructor execution.\n        uint size;\n        assembly {", "highlightLines": [55]}, "category": "code", "location": {"file": "src/test/Bypasscontract.sol", "line": 55, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-using-assembly-code"], "description": ""}, {"id": "631a60139b29", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint size;", "highlightLines": [59]}, "category": "code", "location": {"file": "src/test/Bypasscontract.sol", "line": 59, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "6fb336df7b76", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [60]}, "category": "code", "location": {"file": "src/test/Bypasscontract.sol", "line": 60, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "75c17bd0a169", "fix": {"template": null, "available": false}, "title": "isContract check can be bypassed by calling from constructor - extcodesize is 0 during construction", "ruleId": "rules.sol-ethernaut-iscontract-bypass", "snippet": {"code": "        assembly {\n            size := extcodesize(account)\n        }", "highlightLines": [60]}, "category": "code", "location": {"file": "src/test/Bypasscontract.sol", "line": 60, "column": 9}, "severity": "high", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2943"], "description": ""}, {"id": "0d03c8fc28fb", "fix": {"template": null, "available": false}, "title": "extcodesize check can be bypassed during constructor - contracts have size 0 while being created", "ruleId": "rules.sol-extcodesize-check", "snippet": {"code": "            size := extcodesize(account)", "highlightLines": [61]}, "category": "code", "location": {"file": "src/test/Bypasscontract.sol", "line": 61, "column": 21}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/18"], "description": ""}, {"id": "f0effcc8264c", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "        Target(_target).protected();", "highlightLines": [80]}, "category": "code", "location": {"file": "src/test/Bypasscontract.sol", "line": 80, "column": 9}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "d5ea3dde14b0", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(address _target) {\n        isContract = Target(_target).isContract(address(this));\n        addr = address(this);\n        // This will work\n        Target(_target).protected();\n    }", "highlightLines": [90]}, "category": "code", "location": {"file": "src/test/Bypasscontract.sol", "line": 90, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "e24ab4860c2e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        isContract = Target(_target).isContract(address(this));\n        addr = address(this);", "highlightLines": [91]}, "category": "code", "location": {"file": "src/test/Bypasscontract.sol", "line": 91, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "7a92ffcddf8a", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "        isContract = Target(_target).isContract(address(this));", "highlightLines": [91]}, "category": "code", "location": {"file": "src/test/Bypasscontract.sol", "line": 91, "column": 22}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "a5686d1e956f", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "        Target(_target).protected();", "highlightLines": [94]}, "category": "code", "location": {"file": "src/test/Bypasscontract.sol", "line": 94, "column": 9}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "e9291b0c9c1f", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "    function isContract(address account) public view returns (bool) {\n        require(tx.origin == msg.sender);", "highlightLines": [99]}, "category": "code", "location": {"file": "src/test/Bypasscontract.sol", "line": 99, "column": 5}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "3f87c154a48a", "fix": {"template": null, "available": false}, "title": "tx.origin == msg.sender check can be bypassed during contract construction", "ruleId": "rules.sol-ethernaut-txorigin-msgsender-eoa-check", "snippet": {"code": "        require(tx.origin == msg.sender);", "highlightLines": [100]}, "category": "code", "location": {"file": "src/test/Bypasscontract.sol", "line": 100, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://consensys.github.io/smart-contract-best-practices/development-recommendations/solidity-specific/tx-origin/"], "description": ""}, {"id": "d99abaa4f1e8", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(tx.origin == msg.sender);", "highlightLines": [100]}, "category": "code", "location": {"file": "src/test/Bypasscontract.sol", "line": 100, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "a78d237f31ce", "fix": {"template": null, "available": false}, "title": "tx.origin used for authorization - vulnerable to phishing attacks", "ruleId": "rules.sol-tx-origin-auth", "snippet": {"code": "        require(tx.origin == msg.sender);", "highlightLines": [100]}, "category": "code", "location": {"file": "src/test/Bypasscontract.sol", "line": 100, "column": 9}, "severity": "high", "references": [], "description": ""}, {"id": "83ca5ce42385", "fix": {"template": null, "available": false}, "title": "isContract check can be bypassed by calling from constructor - extcodesize is 0 during construction", "ruleId": "rules.sol-ethernaut-iscontract-bypass", "snippet": {"code": "        return account.code.length > 0;", "highlightLines": [101]}, "category": "code", "location": {"file": "src/test/Bypasscontract.sol", "line": 101, "column": 16}, "severity": "high", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2943"], "description": ""}, {"id": "a2d54d5d729c", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.18;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/DOS.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "a4579ac46257", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "The contract attempts to return the previous balance to the last \"king\" when a new user sends more Ether. However,\nthis mechanism can be exploited. An attacker's contract (here, the Attack contract) can become the king \nand then make the fallback function revert or consume more than the stipulated gas limit, \ncausing the claimThrone function to fail whenever the KingOfEther contract tries to return Ether to the last king. \n\nMitigation:\nUse a Pull payment pattern, A way to prevent this is to enable users to withdraw their Ether, instead of sending it to them.\n\nREF:\nhttps://slowmist.medium.com/intro-to-smart-contract-security-audit-dos-e23e9e901e26\n*/\n\ncontract ContractTest is Test {\n    KingOfEther KingOfEtherContract;\n    Attack AttackerContract;", "highlightLines": [11]}, "category": "code", "location": {"file": "src/test/DOS.sol", "line": 11, "column": 26}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "ea34165d5847", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        KingOfEtherContract = new KingOfEther();\n        AttackerContract = new Attack(KingOfEtherContract);", "highlightLines": [28]}, "category": "code", "location": {"file": "src/test/DOS.sol", "line": 28, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "43a77a4cd04c", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        KingOfEtherContract = new KingOfEther();", "highlightLines": [28]}, "category": "code", "location": {"file": "src/test/DOS.sol", "line": 28, "column": 31}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "54977b07d6c8", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        AttackerContract = new Attack(KingOfEtherContract);", "highlightLines": [29]}, "category": "code", "location": {"file": "src/test/DOS.sol", "line": 29, "column": 28}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "84a5009538f2", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address alice = vm.addr(1);", "highlightLines": [33]}, "category": "code", "location": {"file": "src/test/DOS.sol", "line": 33, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "6d1a6e265bc7", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "        address alice = vm.addr(1);\n        address bob = vm.addr(2);", "highlightLines": [33]}, "category": "code", "location": {"file": "src/test/DOS.sol", "line": 33, "column": 9}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "b96dbb353899", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address alice = vm.addr(1);\n        address bob = vm.addr(2);", "highlightLines": [33]}, "category": "code", "location": {"file": "src/test/DOS.sol", "line": 33, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "649768772e67", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address bob = vm.addr(2);", "highlightLines": [34]}, "category": "code", "location": {"file": "src/test/DOS.sol", "line": 34, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c44bc544e671", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    receive() external payable {}", "highlightLines": [57]}, "category": "code", "location": {"file": "src/test/DOS.sol", "line": 57, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "5a079ef52301", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "    receive() external payable {}", "highlightLines": [57]}, "category": "code", "location": {"file": "src/test/DOS.sol", "line": 57, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "6d23bcb89116", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        (bool sent, ) = king.call{value: balance}(\"\");\n        require(sent, \"Failed to send Ether\");\n\n        balance = msg.value;", "highlightLines": [67]}, "category": "code", "location": {"file": "src/test/DOS.sol", "line": 67, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "0ed37e81eeab", "fix": {"template": null, "available": false}, "title": "Low-level call without checking return value - silent failure possible", "ruleId": "rules.sol-unchecked-call-return", "snippet": {"code": "        (bool sent, ) = king.call{value: balance}(\"\");", "highlightLines": [67]}, "category": "code", "location": {"file": "src/test/DOS.sol", "line": 67, "column": 29}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-104/", "https://blocksecteam.medium.com/li-fi-attack"], "description": ""}, {"id": "663a3d458ea1", "fix": {"template": null, "available": false}, "title": "State change after external call - potential reentrancy vulnerability", "ruleId": "rules.sol-external-call-state-change", "snippet": {"code": "        (bool sent, ) = king.call{value: balance}(\"\");\n        require(sent, \"Failed to send Ether\");\n\n        balance = msg.value;", "highlightLines": [67]}, "category": "code", "location": {"file": "src/test/DOS.sol", "line": 67, "column": 29}, "severity": "high", "references": ["https://consensys.github.io/smart-contract-best-practices/attacks/reentrancy/"], "description": ""}, {"id": "3fb2c87491a3", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        balance = msg.value;\n        king = msg.sender;", "highlightLines": [70]}, "category": "code", "location": {"file": "src/test/DOS.sol", "line": 70, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e135d543e13e", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(KingOfEther _kingOfEther) {\n        kingOfEther = KingOfEther(_kingOfEther);\n    }", "highlightLines": [78]}, "category": "code", "location": {"file": "src/test/DOS.sol", "line": 78, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "1f4e5a1201d6", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.18;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/DataLocation.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "6129bc1a1ddc", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract ContractTest is Test {\n    Array ArrayContract;\n\n    function testDataLocation() public {\n        address alice = vm.addr(1);\n        address bob = vm.addr(2);", "highlightLines": [25]}, "category": "code", "location": {"file": "src/test/DataLocation.sol", "line": 25, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "2b1501aa3c23", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address alice = vm.addr(1);", "highlightLines": [29]}, "category": "code", "location": {"file": "src/test/DataLocation.sol", "line": 29, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "9bef35010f49", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "        address alice = vm.addr(1);\n        address bob = vm.addr(2);", "highlightLines": [29]}, "category": "code", "location": {"file": "src/test/DataLocation.sol", "line": 29, "column": 9}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "c8cbb1f6631a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address alice = vm.addr(1);\n        address bob = vm.addr(2);", "highlightLines": [29]}, "category": "code", "location": {"file": "src/test/DataLocation.sol", "line": 29, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "4ad1a17f2a88", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address bob = vm.addr(2);", "highlightLines": [30]}, "category": "code", "location": {"file": "src/test/DataLocation.sol", "line": 30, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "07e4b1c0f999", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address bob = vm.addr(2);\n        vm.deal(address(alice), 1 ether);\n        vm.deal(address(bob), 1 ether);\n        //vm.startPrank(alice);\n        ArrayContract = new Array();", "highlightLines": [30]}, "category": "code", "location": {"file": "src/test/DataLocation.sol", "line": 30, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "540695831171", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        ArrayContract = new Array();\n        ArrayContract.updaterewardDebt(100); // update rewardDebt to 100\n        (uint amount, uint rewardDebt) = ArrayContract.userInfo(address(this));", "highlightLines": [34]}, "category": "code", "location": {"file": "src/test/DataLocation.sol", "line": 34, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "eab8b6badc9d", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        ArrayContract = new Array();", "highlightLines": [34]}, "category": "code", "location": {"file": "src/test/DataLocation.sol", "line": 34, "column": 25}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "14f2de99c241", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "        (uint amount, uint rewardDebt) = ArrayContract.userInfo(address(this));\n        console.log(\"Non-updated rewardDebt\", rewardDebt);\n\n        console.log(\"Update rewardDebt with storage\");\n        ArrayContract.fixedupdaterewardDebt(100);\n        (uint newamount, uint newrewardDebt) = ArrayContract.userInfo(\n            address(this)\n        );", "highlightLines": [36]}, "category": "code", "location": {"file": "src/test/DataLocation.sol", "line": 36, "column": 9}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "07147e587a9b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        (uint amount, uint rewardDebt) = ArrayContract.userInfo(address(this));\n        console.log(\"Non-updated rewardDebt\", rewardDebt);\n\n        console.log(\"Update rewardDebt with storage\");\n        ArrayContract.fixedupdaterewardDebt(100);\n        (uint newamount, uint newrewardDebt) = ArrayContract.userInfo(\n            address(this)\n        );", "highlightLines": [36]}, "category": "code", "location": {"file": "src/test/DataLocation.sol", "line": 36, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "aadd920ec371", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    receive() external payable {}", "highlightLines": [47]}, "category": "code", "location": {"file": "src/test/DataLocation.sol", "line": 47, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "9c5d18983b90", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "    receive() external payable {}", "highlightLines": [47]}, "category": "code", "location": {"file": "src/test/DataLocation.sol", "line": 47, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "ee0848591d22", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract Array is Test {\n    mapping(address => UserInfo) public userInfo; // storage\n\n    struct UserInfo {\n        uint256 amount; // How many tokens got staked by user.\n        uint256 rewardDebt; // Reward debt. See Explanation below.", "highlightLines": [50]}, "category": "code", "location": {"file": "src/test/DataLocation.sol", "line": 50, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "109058492272", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 amount; // How many tokens got staked by user.", "highlightLines": [54]}, "category": "code", "location": {"file": "src/test/DataLocation.sol", "line": 54, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "adae96468a95", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 rewardDebt; // Reward debt. See Explanation below.", "highlightLines": [55]}, "category": "code", "location": {"file": "src/test/DataLocation.sol", "line": 55, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "eb17a8bbcc86", "fix": {"template": null, "available": false}, "title": "Struct copied to memory from mapping - modifications won't persist to storage", "ruleId": "rules.sol-memory-struct-from-mapping", "snippet": {"code": "        UserInfo memory user = userInfo[msg.sender]; // memory, vulnerable point", "highlightLines": [59]}, "category": "code", "location": {"file": "src/test/DataLocation.sol", "line": 59, "column": 9}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/DataLocation.sol"], "description": ""}, {"id": "2e57213d5b37", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        UserInfo memory user = userInfo[msg.sender]; // memory, vulnerable point\n        user.rewardDebt = amount;", "highlightLines": [59]}, "category": "code", "location": {"file": "src/test/DataLocation.sol", "line": 59, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "a63a1acb2b7c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        UserInfo storage user = userInfo[msg.sender]; // storage\n        user.rewardDebt = amount;", "highlightLines": [64]}, "category": "code", "location": {"file": "src/test/DataLocation.sol", "line": 64, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "1666e0cf6936", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.18;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/Delegatecall.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "4c548f464d2a", "fix": {"template": null, "available": false}, "title": "Potential mnemonic seed phrase detected - CRITICAL if real", "ruleId": "rules._shared.shared-mnemonic-phrase", "snippet": {"code": "The Proxy Contract Owner Manipulation Vulnerability is a flaw in the smart contract design that\nallows an attacker to manipulate the owner of the Proxy contract, which is hardcoded as 0xdeadbeef.", "highlightLines": [10]}, "category": "code", "location": {"file": "src/test/Delegatecall.sol", "line": 10, "column": 45}, "severity": "high", "references": [], "description": ""}, {"id": "f01ef55da788", "fix": {"template": null, "available": false}, "title": "Potential mnemonic seed phrase detected - CRITICAL if real", "ruleId": "rules._shared.shared-mnemonic-phrase", "snippet": {"code": "The vulnerability arises due to the use of delegatecall in the fallback function of the Proxy contract.", "highlightLines": [12]}, "category": "code", "location": {"file": "src/test/Delegatecall.sol", "line": 12, "column": 11}, "severity": "high", "references": [], "description": ""}, {"id": "3484a02e5aa1", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "    address public owner = address(0xdeadbeef); // slot0", "highlightLines": [30]}, "category": "code", "location": {"file": "src/test/Delegatecall.sol", "line": 30, "column": 20}, "severity": "info", "references": [], "description": ""}, {"id": "4db9c1771c98", "fix": {"template": null, "available": false}, "title": "Delegatecall in fallback executes external code in caller's context - storage/owner can be hijacked (Delegation pattern)", "ruleId": "rules.sol-delegatecall-preserves-context", "snippet": {"code": "    fallback() external {\n        (bool suc, ) = address(delegate).delegatecall(msg.data); // vulnerable", "highlightLines": [37]}, "category": "code", "location": {"file": "src/test/Delegatecall.sol", "line": 37, "column": 5}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/level/6"], "description": ""}, {"id": "967630fc6569", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract ContractTest is Test {\n    Proxy proxy;\n    Delegate DelegateContract;\n    address alice;", "highlightLines": [43]}, "category": "code", "location": {"file": "src/test/Delegatecall.sol", "line": 43, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "15cb081b4314", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address alice;", "highlightLines": [46]}, "category": "code", "location": {"file": "src/test/Delegatecall.sol", "line": 46, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "79b0e1d2e199", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        DelegateContract = new Delegate(); // logic contract\n        proxy = new Proxy(address(DelegateContract)); // proxy contract", "highlightLines": [53]}, "category": "code", "location": {"file": "src/test/Delegatecall.sol", "line": 53, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "8a032123823f", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        DelegateContract = new Delegate(); // logic contract", "highlightLines": [53]}, "category": "code", "location": {"file": "src/test/Delegatecall.sol", "line": 53, "column": 28}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "dd667ccff534", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        proxy = new Proxy(address(DelegateContract)); // proxy contract", "highlightLines": [54]}, "category": "code", "location": {"file": "src/test/Delegatecall.sol", "line": 54, "column": 17}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "6102c03a4883", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        owner = msg.sender;", "highlightLines": [76]}, "category": "code", "location": {"file": "src/test/Delegatecall.sol", "line": 76, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "d5b3fb23c385", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract ContractTest is Test {\n    Dirtybytes Dirtybytesontract;", "highlightLines": [20]}, "category": "code", "location": {"file": "src/test/Dirtybytes.sol", "line": 20, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "35a88a8717d4", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        Dirtybytesontract = new Dirtybytes();", "highlightLines": [24]}, "category": "code", "location": {"file": "src/test/Dirtybytes.sol", "line": 24, "column": 29}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "9d9aca44e008", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event ev(uint[], uint);", "highlightLines": [36]}, "category": "code", "location": {"file": "src/test/Dirtybytes.sol", "line": 36, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "303a29ba6f1c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    bytes s;", "highlightLines": [37]}, "category": "code", "location": {"file": "src/test/Dirtybytes.sol", "line": 37, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "9ee79d499696", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor() {\n        // The following event emission involves writing to temporary memory at the current location\n        // of the free memory pointer. Several other operations (e.g. certain keccak256 calls) will\n        // use temporary memory in a similar manner.\n        // In this particular case, the length of the passed array will be written to temporary memory\n        // exactly such that the byte after the 63 bytes allocated below will be 0x02. This dirty byte\n        // will then be written to storage during the assignment and become visible with the push in ``h``.\n        emit ev(new uint[](2), 0);\n        bytes memory m = new bytes(63);\n        s = m;\n    }", "highlightLines": [39]}, "category": "code", "location": {"file": "src/test/Dirtybytes.sol", "line": 39, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "94a0f2934ea0", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        emit ev(new uint[](2), 0);", "highlightLines": [46]}, "category": "code", "location": {"file": "src/test/Dirtybytes.sol", "line": 46, "column": 17}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "a4a1f9e53582", "fix": {"template": null, "available": false}, "title": "Bytes array copied to storage with non-32-aligned length - dirty bytes vulnerability (fixed in 0.8.15)", "ruleId": "rules.sol-dirty-bytes-storage-copy", "snippet": {"code": "        bytes memory m = new bytes(63);\n        s = m;", "highlightLines": [47]}, "category": "code", "location": {"file": "src/test/Dirtybytes.sol", "line": 47, "column": 9}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/Dirtybytes.sol", "https://blog.soliditylang.org/2022/06/15/dirty-bytes-array-to-storage-bug/"], "description": ""}, {"id": "d92aa0c046bc", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes memory m = new bytes(63);\n        s = m;", "highlightLines": [47]}, "category": "code", "location": {"file": "src/test/Dirtybytes.sol", "line": 47, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "1a62bd493ca7", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        bytes memory m = new bytes(63);", "highlightLines": [47]}, "category": "code", "location": {"file": "src/test/Dirtybytes.sol", "line": 47, "column": 26}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "e0b6b9ead3eb", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.18;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/Divmultiply.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "81a3498758ec", "fix": {"template": null, "available": false}, "title": "Division before multiplication causes precision loss - multiply first then divide", "ruleId": "rules.sol-divide-before-multiply", "snippet": {"code": "multiplication (price / 100) * discount. Due to the fact that Solidity truncates integers", "highlightLines": [14]}, "category": "code", "location": {"file": "src/test/Divmultiply.sol", "line": 14, "column": 16}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/Divmultiply.sol"], "description": ""}, {"id": "170408ef9b1f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        MiscalculationContract = new Miscalculation();\n        console.log(\"Perform Miscalculation Contract\");\n        console.log(\n            \"Scenario: DeFi store 10% off now, Then we buy 1 item price: $80.\"\n        );\n        console.log(\n            \"Subtract the discount, get the sale price:\",\n            MiscalculationContract.price(80, 90)\n        );\n        console.log(\n            \"Solidity doesn't do decimals, so dividing before multiplying will round to zero. 0.8*90=0\"\n        );\n        console.log(\n            \"---------------------------------------------------------\"\n        );\n        CalculationContract = new Calculation();", "highlightLines": [34]}, "category": "code", "location": {"file": "src/test/Divmultiply.sol", "line": 34, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "c16c80c27be4", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        MiscalculationContract = new Miscalculation();", "highlightLines": [34]}, "category": "code", "location": {"file": "src/test/Divmultiply.sol", "line": 34, "column": 34}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "9162b4b97c66", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        CalculationContract = new Calculation();", "highlightLines": [49]}, "category": "code", "location": {"file": "src/test/Divmultiply.sol", "line": 49, "column": 31}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "0d572476d8ef", "fix": {"template": null, "available": false}, "title": "Division before multiplication causes precision loss - multiply first then divide", "ruleId": "rules.sol-divide-before-multiply", "snippet": {"code": "        return (price / 100) * discount; // wrong calculation", "highlightLines": [67]}, "category": "code", "location": {"file": "src/test/Divmultiply.sol", "line": 67, "column": 16}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/Divmultiply.sol"], "description": ""}, {"id": "de47c382b418", "fix": {"template": null, "available": false}, "title": "Division before multiplication causes precision loss", "ruleId": "rules.sol-division-before-multiplication", "snippet": {"code": "        return (price / 100) * discount; // wrong calculation", "highlightLines": [67]}, "category": "code", "location": {"file": "src/test/Divmultiply.sol", "line": 67, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "71d1babbd15c", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.18;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/ERC777-reentrancy.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "9d4648e5d4d2", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract ContractTest is Test {\n    MyERC777 MyERC777TokenContract;\n    SimpleBank SimpleBankContract;\n    address alice = vm.addr(1);\n    address eve = vm.addr(2);", "highlightLines": [25]}, "category": "code", "location": {"file": "src/test/ERC777-reentrancy.sol", "line": 25, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "4bc14fecf93a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address alice = vm.addr(1);", "highlightLines": [28]}, "category": "code", "location": {"file": "src/test/ERC777-reentrancy.sol", "line": 28, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "291465d6267c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address eve = vm.addr(2);", "highlightLines": [29]}, "category": "code", "location": {"file": "src/test/ERC777-reentrancy.sol", "line": 29, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7502f872f514", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "                hex\"608060405234801561001057600080fd5b50600436106100a5576000357c010000000000000000000000000000000000000000000000000000000090048063a41e7d5111610078578063a41e7d51146101d4578063aabbb8ca1461020a578063b705676514610236578063f712f3e814610280576100a5565b806329965a1d146100aa5780633d584063146100e25780635df8122f1461012457806365ba36c114610152575b600080fd5b6100e0600480360360608110156100c057600080fd5b50600160a060020a038135811691602081013591604090910135166102b6565b005b610108600480360360208110156100f857600080fd5b5035600160a060020a0316610570565b60408051600160a060020a039092168252519081900360200190f35b6100e06004803603604081101561013a57600080fd5b50600160a060020a03813581169160200135166105bc565b6101c26004803603602081101561016857600080fd5b81019060208101813564010000000081111561018357600080fd5b82018360208201111561019557600080fd5b803590602001918460018302840111640100000000831117156101b757600080fd5b5090925090506106b3565b60408051918252519081900360200190f35b6100e0600480360360408110156101ea57600080fd5b508035600160a060020a03169060200135600160e060020a0319166106ee565b6101086004803603604081101561022057600080fd5b50600160a060020a038135169060200135610778565b61026c6004803603604081101561024c57600080fd5b508035600160a060020a03169060200135600160e060020a0319166107ef565b604080519115158252519081900360200190f35b61026c6004803603604081101561029657600080fd5b508035600160a060020a03169060200135600160e060020a0319166108aa565b6000600160a060020a038416156102cd57836102cf565b335b9050336102db82610570565b600160a060020a031614610339576040805160e560020a62461bcd02815260206004820152600f60248201527f4e6f7420746865206d616e616765720000000000000000000000000000000000604482015290519081900360640190fd5b6103428361092a565b15610397576040805160e560020a62461bcd02815260206004820152601a60248201527f4d757374206e6f7420626520616e204552433136352068617368000000000000604482015290519081900360640190fd5b600160a060020a038216158015906103b85750600160a060020a0382163314155b156104ff5760405160200180807f455243313832305f4143434550545f4d4147494300000000000000000000000081525060140190506040516020818303038152906040528051906020012082600160a060020a031663249cb3fa85846040518363ffffffff167c01000000000000000000000000000000000000000000000000000000000281526004018083815260200182600160a060020a0316600160a060020a031681526020019250505060206040518083038186803b15801561047e57600080fd5b505afa158015610492573d6000803e3d6000fd5b505050506040513d60208110156104a857600080fd5b5051146104ff576040805160e560020a62461bcd02815260206004820181905260248201527f446f6573206e6f7420696d706c656d656e742074686520696e74657266616365604482015290519081900360640190fd5b600160a060020a03818116600081815260208181526040808320888452909152808220805473ffffffffffffffffffffffffffffffffffffffff19169487169485179055518692917f93baa6efbd2244243bfee6ce4cfdd1d04fc4c0e9a786abd3a41313bd352db15391a450505050565b600160a060020a03818116600090815260016020526040812054909116151561059a5750806105b7565b50600160a060020a03808216600090815260016020526040902054165b919050565b336105c683610570565b600160a060020a031614610624576040805160e560020a62461bcd02815260206004820152600f60248201527f4e6f7420746865206d616e616765720000000000000000000000000000000000604482015290519081900360640190fd5b81600160a060020a031681600160a060020a0316146106435780610646565b60005b600160a060020a03838116600081815260016020526040808220805473ffffffffffffffffffffffffffffffffffffffff19169585169590951790945592519184169290917f605c2dbf762e5f7d60a546d42e7205dcb1b011ebc62a61736a57c9089d3a43509190a35050565b600082826040516020018083838082843780830192505050925050506040516020818303038152906040528051906020012090505b92915050565b6106f882826107ef565b610703576000610705565b815b600160a060020a03928316600081815260208181526040808320600160e060020a031996909616808452958252808320805473ffffffffffffffffffffffffffffffffffffffff19169590971694909417909555908152600284528181209281529190925220805460ff19166001179055565b600080600160a060020a038416156107905783610792565b335b905061079d8361092a565b156107c357826107ad82826108aa565b6107b85760006107ba565b815b925050506106e8565b600160a060020a0390811660009081526020818152604080832086845290915290205416905092915050565b6000808061081d857f01ffc9a70000000000000000000000000000000000000000000000000000000061094c565b909250905081158061082d575080155b1561083d576000925050506106e8565b61084f85600160e060020a031961094c565b909250905081158061086057508015155b15610870576000925050506106e8565b61087a858561094c565b909250905060018214801561088f5750806001145b1561089f576001925050506106e8565b506000949350505050565b600160a060020a0382166000908152600260209081526040808320600160e060020a03198516845290915281205460ff1615156108f2576108eb83836107ef565b90506106e8565b50600160a060020a03808316600081815260208181526040808320600160e060020a0319871684529091529020549091161492915050565b7bffffffffffffffffffffffffffffffffffffffffffffffffffffffff161590565b6040517f01ffc9a7000000000000000000000000000000000000000000000000000000008082526004820183905260009182919060208160248189617530fa90519096909550935050505056fea165627a7a72305820377f4a2d4301ede9949f163f319021a6e9c687c292a5e2b2c4734c126b524e6c0029\"", "highlightLines": [40]}, "category": "code", "location": {"file": "src/test/ERC777-reentrancy.sol", "line": 40, "column": 82}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "3857c6e4132a", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        MyERC777TokenContract = new MyERC777(0);", "highlightLines": [43]}, "category": "code", "location": {"file": "src/test/ERC777-reentrancy.sol", "line": 43, "column": 33}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "ac9172cfe5ec", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        IERC1820Registry registry = IERC1820Registry(\n            address(0x1820a4B7618BdE71Dce8cdc73aAB6C95905faD24)\n        );\n        // tokensReceived Hook\n        // The token contract MUST call the tokensReceived hook of the recipient if the recipient registers an ERC777TokensRecipient implementation via ERC-1820.\n        registry.setInterfaceImplementer(\n            address(this),\n            _TOKENS_RECIPIENT_INTERFACE_HASH,\n            address(this)\n        );\n        //set up env\n        SimpleBankContract = new SimpleBank(address(MyERC777TokenContract));", "highlightLines": [48]}, "category": "code", "location": {"file": "src/test/ERC777-reentrancy.sol", "line": 48, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "9ee2a8839b4b", "fix": {"template": null, "available": false}, "title": "ERC1820 registry hook registration - can enable reentrancy via token hooks", "ruleId": "rules.sol-erc1820-registry-hook", "snippet": {"code": "        registry.setInterfaceImplementer(", "highlightLines": [53]}, "category": "code", "location": {"file": "src/test/ERC777-reentrancy.sol", "line": 53, "column": 18}, "severity": "medium", "references": [], "description": ""}, {"id": "bfe138c5629e", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        SimpleBankContract = new SimpleBank(address(MyERC777TokenContract));", "highlightLines": [59]}, "category": "code", "location": {"file": "src/test/ERC777-reentrancy.sol", "line": 59, "column": 30}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "5ff65fe53e1b", "fix": {"template": null, "available": false}, "title": "Token callback function without reentrancy protection - ERC777/721/1155 callbacks can reenter", "ruleId": "rules.sol-callback-without-reentrancy-guard", "snippet": {"code": "    function tokensReceived(\n        address payable operator,\n        address from,\n        address to,\n        uint256 amount,\n        bytes calldata data,\n        bytes calldata operatorData\n    ) external {", "highlightLines": [77]}, "category": "code", "location": {"file": "src/test/ERC777-reentrancy.sol", "line": 77, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "05592d6dea31", "fix": {"template": null, "available": false}, "title": "Balance threshold check using balanceOf(this) - vulnerable to flash loan manipulation", "ruleId": "rules.sol-balance-threshold-check", "snippet": {"code": "        if (MyERC777TokenContract.balanceOf(address(this)) <= 1000) {", "highlightLines": [85]}, "category": "code", "location": {"file": "src/test/ERC777-reentrancy.sol", "line": 85, "column": 35}, "severity": "medium", "references": [], "description": ""}, {"id": "07a36aef87be", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    receive() external payable {}", "highlightLines": [92]}, "category": "code", "location": {"file": "src/test/ERC777-reentrancy.sol", "line": 92, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "75d050acd2a1", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "    receive() external payable {}", "highlightLines": [92]}, "category": "code", "location": {"file": "src/test/ERC777-reentrancy.sol", "line": 92, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "77916f36ab40", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(\n        uint256 initialSupply\n    ) ERC777(\"Gold\", \"GLD\", new address[](0)) {}", "highlightLines": [96]}, "category": "code", "location": {"file": "src/test/ERC777-reentrancy.sol", "line": 96, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "9785b46197c0", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    ) ERC777(\"Gold\", \"GLD\", new address[](0)) {}", "highlightLines": [98]}, "category": "code", "location": {"file": "src/test/ERC777-reentrancy.sol", "line": 98, "column": 29}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "7a594aeccbd9", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function mint(\n        address account,\n        uint256 amount,\n        bytes memory userData,\n        bytes memory operatorData\n    ) public returns (bool) {", "highlightLines": [99]}, "category": "code", "location": {"file": "src/test/ERC777-reentrancy.sol", "line": 99, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "d9d7f0d935da", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function mint(\n        address account,\n        uint256 amount,\n        bytes memory userData,\n        bytes memory operatorData\n    ) public returns (bool) {", "highlightLines": [99]}, "category": "code", "location": {"file": "src/test/ERC777-reentrancy.sol", "line": 99, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "80f9871d3a77", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract SimpleBank is Test {\n    ERC777 private token;\n    uint maxMintsPerAddress = 1000;", "highlightLines": [110]}, "category": "code", "location": {"file": "src/test/ERC777-reentrancy.sol", "line": 110, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "a7d31e20480c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint maxMintsPerAddress = 1000;", "highlightLines": [112]}, "category": "code", "location": {"file": "src/test/ERC777-reentrancy.sol", "line": 112, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "05d6f4ce2831", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "                hex\"608060405234801561001057600080fd5b50600436106100a5576000357c010000000000000000000000000000000000000000000000000000000090048063a41e7d5111610078578063a41e7d51146101d4578063aabbb8ca1461020a578063b705676514610236578063f712f3e814610280576100a5565b806329965a1d146100aa5780633d584063146100e25780635df8122f1461012457806365ba36c114610152575b600080fd5b6100e0600480360360608110156100c057600080fd5b50600160a060020a038135811691602081013591604090910135166102b6565b005b610108600480360360208110156100f857600080fd5b5035600160a060020a0316610570565b60408051600160a060020a039092168252519081900360200190f35b6100e06004803603604081101561013a57600080fd5b50600160a060020a03813581169160200135166105bc565b6101c26004803603602081101561016857600080fd5b81019060208101813564010000000081111561018357600080fd5b82018360208201111561019557600080fd5b803590602001918460018302840111640100000000831117156101b757600080fd5b5090925090506106b3565b60408051918252519081900360200190f35b6100e0600480360360408110156101ea57600080fd5b508035600160a060020a03169060200135600160e060020a0319166106ee565b6101086004803603604081101561022057600080fd5b50600160a060020a038135169060200135610778565b61026c6004803603604081101561024c57600080fd5b508035600160a060020a03169060200135600160e060020a0319166107ef565b604080519115158252519081900360200190f35b61026c6004803603604081101561029657600080fd5b508035600160a060020a03169060200135600160e060020a0319166108aa565b6000600160a060020a038416156102cd57836102cf565b335b9050336102db82610570565b600160a060020a031614610339576040805160e560020a62461bcd02815260206004820152600f60248201527f4e6f7420746865206d616e616765720000000000000000000000000000000000604482015290519081900360640190fd5b6103428361092a565b15610397576040805160e560020a62461bcd02815260206004820152601a60248201527f4d757374206e6f7420626520616e204552433136352068617368000000000000604482015290519081900360640190fd5b600160a060020a038216158015906103b85750600160a060020a0382163314155b156104ff5760405160200180807f455243313832305f4143434550545f4d4147494300000000000000000000000081525060140190506040516020818303038152906040528051906020012082600160a060020a031663249cb3fa85846040518363ffffffff167c01000000000000000000000000000000000000000000000000000000000281526004018083815260200182600160a060020a0316600160a060020a031681526020019250505060206040518083038186803b15801561047e57600080fd5b505afa158015610492573d6000803e3d6000fd5b505050506040513d60208110156104a857600080fd5b5051146104ff576040805160e560020a62461bcd02815260206004820181905260248201527f446f6573206e6f7420696d706c656d656e742074686520696e74657266616365604482015290519081900360640190fd5b600160a060020a03818116600081815260208181526040808320888452909152808220805473ffffffffffffffffffffffffffffffffffffffff19169487169485179055518692917f93baa6efbd2244243bfee6ce4cfdd1d04fc4c0e9a786abd3a41313bd352db15391a450505050565b600160a060020a03818116600090815260016020526040812054909116151561059a5750806105b7565b50600160a060020a03808216600090815260016020526040902054165b919050565b336105c683610570565b600160a060020a031614610624576040805160e560020a62461bcd02815260206004820152600f60248201527f4e6f7420746865206d616e616765720000000000000000000000000000000000604482015290519081900360640190fd5b81600160a060020a031681600160a060020a0316146106435780610646565b60005b600160a060020a03838116600081815260016020526040808220805473ffffffffffffffffffffffffffffffffffffffff19169585169590951790945592519184169290917f605c2dbf762e5f7d60a546d42e7205dcb1b011ebc62a61736a57c9089d3a43509190a35050565b600082826040516020018083838082843780830192505050925050506040516020818303038152906040528051906020012090505b92915050565b6106f882826107ef565b610703576000610705565b815b600160a060020a03928316600081815260208181526040808320600160e060020a031996909616808452958252808320805473ffffffffffffffffffffffffffffffffffffffff19169590971694909417909555908152600284528181209281529190925220805460ff19166001179055565b600080600160a060020a038416156107905783610792565b335b905061079d8361092a565b156107c357826107ad82826108aa565b6107b85760006107ba565b815b925050506106e8565b600160a060020a0390811660009081526020818152604080832086845290915290205416905092915050565b6000808061081d857f01ffc9a70000000000000000000000000000000000000000000000000000000061094c565b909250905081158061082d575080155b1561083d576000925050506106e8565b61084f85600160e060020a031961094c565b909250905081158061086057508015155b15610870576000925050506106e8565b61087a858561094c565b909250905060018214801561088f5750806001145b1561089f576001925050506106e8565b506000949350505050565b600160a060020a0382166000908152600260209081526040808320600160e060020a03198516845290915281205460ff1615156108f2576108eb83836107ef565b90506106e8565b50600160a060020a03808316600081815260208181526040808320600160e060020a0319871684529091529020549091161492915050565b7bffffffffffffffffffffffffffffffffffffffffffffffffffffffff161590565b6040517f01ffc9a7000000000000000000000000000000000000000000000000000000008082526004820183905260009182919060208160248189617530fa90519096909550935050505056fea165627a7a72305820377f4a2d4301ede9949f163f319021a6e9c687c292a5e2b2c4734c126b524e6c0029\"", "highlightLines": [122]}, "category": "code", "location": {"file": "src/test/ERC777-reentrancy.sol", "line": 122, "column": 82}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "dd0e93333530", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(address nftAddress) {\n        token = ERC777(nftAddress);\n\n        // Register IERC1820Registry\n        IERC1820Registry registry = IERC1820Registry(\n            address(0x1820a4B7618BdE71Dce8cdc73aAB6C95905faD24)\n        );\n        registry.setInterfaceImplementer(\n            address(this),\n            _TOKENS_RECIPIENT_INTERFACE_HASH,\n            address(this)\n        );\n    }", "highlightLines": [126]}, "category": "code", "location": {"file": "src/test/ERC777-reentrancy.sol", "line": 126, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "319c1d3d557d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        token = ERC777(nftAddress);\n\n        // Register IERC1820Registry\n        IERC1820Registry registry = IERC1820Registry(\n            address(0x1820a4B7618BdE71Dce8cdc73aAB6C95905faD24)\n        );", "highlightLines": [127]}, "category": "code", "location": {"file": "src/test/ERC777-reentrancy.sol", "line": 127, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "7a31a36eb0ad", "fix": {"template": null, "available": false}, "title": "ERC1820 registry hook registration - can enable reentrancy via token hooks", "ruleId": "rules.sol-erc1820-registry-hook", "snippet": {"code": "        registry.setInterfaceImplementer(", "highlightLines": [133]}, "category": "code", "location": {"file": "src/test/ERC777-reentrancy.sol", "line": 133, "column": 18}, "severity": "medium", "references": [], "description": ""}, {"id": "015918e73cf5", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "    function claim(address account, uint256 amount) public returns (bool) {\n        // Check if total claims for the address would exceed max mints per address.\n        require(", "highlightLines": [140]}, "category": "code", "location": {"file": "src/test/ERC777-reentrancy.sol", "line": 140, "column": 5}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "958c11058bae", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - will never return false, only revert", "ruleId": "rules.sol-return-bool-always-reverts", "snippet": {"code": "    function claim(address account, uint256 amount) public returns (bool) {\n        // Check if total claims for the address would exceed max mints per address.\n        require(\n            _mints[account] + amount <= maxMintsPerAddress,\n            \"Exceeds max mints per address\"\n        );\n\n        token.transfer(account, amount);\n        _mints[account] += amount; // Do not follow check-effect-interaction\n\n        return true;\n    }", "highlightLines": [140]}, "category": "code", "location": {"file": "src/test/ERC777-reentrancy.sol", "line": 140, "column": 5}, "severity": "info", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "c81e36da1366", "fix": {"template": null, "available": false}, "title": "Using a + b < a for overflow check - use SafeMath or Solidity 0.8+ instead", "ruleId": "rules.sol-overflow-addition-check", "snippet": {"code": "        require(\n            _mints[account] + amount <= maxMintsPerAddress,", "highlightLines": [142]}, "category": "code", "location": {"file": "src/test/ERC777-reentrancy.sol", "line": 142, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "dcd58fa9e6af", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        token.transfer(account, amount);", "highlightLines": [147]}, "category": "code", "location": {"file": "src/test/ERC777-reentrancy.sol", "line": 147, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "15db951d65be", "fix": {"template": null, "available": false}, "title": "Missing zero address validation - tokens/ETH could be lost", "ruleId": "rules.sol-missing-zero-address-check", "snippet": {"code": "        token.transfer(account, amount);", "highlightLines": [147]}, "category": "code", "location": {"file": "src/test/ERC777-reentrancy.sol", "line": 147, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "170ded900614", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "        token.transfer(account, amount);", "highlightLines": [147]}, "category": "code", "location": {"file": "src/test/ERC777-reentrancy.sol", "line": 147, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "ac88fbfb0143", "fix": {"template": null, "available": false}, "title": "ERC20 transfer() return value not checked - tokens like USDT don't return bool", "ruleId": "rules.sol-erc20-transfer-no-return-check", "snippet": {"code": "        token.transfer(account, amount);", "highlightLines": [147]}, "category": "code", "location": {"file": "src/test/ERC777-reentrancy.sol", "line": 147, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "742b0c67e11a", "fix": {"template": null, "available": false}, "title": "Token callback function without reentrancy protection - ERC777/721/1155 callbacks can reenter", "ruleId": "rules.sol-callback-without-reentrancy-guard", "snippet": {"code": "    function tokensReceived(\n        address operator,\n        address from,\n        address to,\n        uint256 amount,\n        bytes calldata data,\n        bytes calldata operatorData\n    ) external {}", "highlightLines": [153]}, "category": "code", "location": {"file": "src/test/ERC777-reentrancy.sol", "line": 153, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "42f596844fb3", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    receive() external payable {}", "highlightLines": [161]}, "category": "code", "location": {"file": "src/test/ERC777-reentrancy.sol", "line": 161, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "1924f8cfd8d0", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "    receive() external payable {}", "highlightLines": [161]}, "category": "code", "location": {"file": "src/test/ERC777-reentrancy.sol", "line": 161, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "3b28079bcbb2", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.18;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/Flashloan-flaw.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "0f4a41fbfe04", "fix": {"template": null, "available": false}, "title": "Consider using Ownable2Step instead of Ownable for safer ownership transfers", "ruleId": "rules.sol-use-ownable2step", "snippet": {"code": "import \"@openzeppelin/contracts/access/Ownable.sol\";", "highlightLines": [6]}, "category": "code", "location": {"file": "src/test/Flashloan-flaw.sol", "line": 6, "column": 1}, "severity": "info", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/access/Ownable2Step.sol"], "description": ""}, {"id": "7380d0121f6c", "fix": {"template": null, "available": false}, "title": "Potential mnemonic seed phrase detected - CRITICAL if real", "ruleId": "rules._shared.shared-mnemonic-phrase", "snippet": {"code": "Missing flash loan initiator check refers to a potential security vulnerability in a flash loan implementation \nwhere the initiator of the flash loan is not properly verified or checked, anyone could exploit the flash loan", "highlightLines": [13]}, "category": "code", "location": {"file": "src/test/Flashloan-flaw.sol", "line": 13, "column": 73}, "severity": "high", "references": [], "description": ""}, {"id": "809248ca6a2a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        USDaContract = new USDa();\n        LendingPoolContract = new LendingPool(address(USDaContract));", "highlightLines": [36]}, "category": "code", "location": {"file": "src/test/Flashloan-flaw.sol", "line": 36, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "c64b92b96789", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        USDaContract = new USDa();", "highlightLines": [36]}, "category": "code", "location": {"file": "src/test/Flashloan-flaw.sol", "line": 36, "column": 24}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "f6ab14457bb4", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LendingPoolContract = new LendingPool(address(USDaContract));\n        SimpleBankBugContract = new SimpleBankBug(\n            address(LendingPoolContract),\n            address(USDaContract)\n        );", "highlightLines": [37]}, "category": "code", "location": {"file": "src/test/Flashloan-flaw.sol", "line": 37, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "6abb675d8bc1", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        LendingPoolContract = new LendingPool(address(USDaContract));", "highlightLines": [37]}, "category": "code", "location": {"file": "src/test/Flashloan-flaw.sol", "line": 37, "column": 31}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "5185b4be0ead", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        SimpleBankBugContract = new SimpleBankBug(\n            address(LendingPoolContract),\n            address(USDaContract)\n        );\n        USDaContract.transfer(address(LendingPoolContract), 10000 ether);\n        FixedSimpleBankContract = new FixedSimpleBank(\n            address(LendingPoolContract),\n            address(USDaContract)\n        );", "highlightLines": [38]}, "category": "code", "location": {"file": "src/test/Flashloan-flaw.sol", "line": 38, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "3afc4b12d889", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        SimpleBankBugContract = new SimpleBankBug(\n            address(LendingPoolContract),\n            address(USDaContract)\n        );", "highlightLines": [38]}, "category": "code", "location": {"file": "src/test/Flashloan-flaw.sol", "line": 38, "column": 33}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "235ab2e2b7e1", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        USDaContract.transfer(address(LendingPoolContract), 10000 ether);", "highlightLines": [42]}, "category": "code", "location": {"file": "src/test/Flashloan-flaw.sol", "line": 42, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "002a77789dc7", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "        USDaContract.transfer(address(LendingPoolContract), 10000 ether);", "highlightLines": [42]}, "category": "code", "location": {"file": "src/test/Flashloan-flaw.sol", "line": 42, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "f097807a26f5", "fix": {"template": null, "available": false}, "title": "ERC20 transfer() return value not checked - tokens like USDT don't return bool", "ruleId": "rules.sol-erc20-transfer-no-return-check", "snippet": {"code": "        USDaContract.transfer(address(LendingPoolContract), 10000 ether);", "highlightLines": [42]}, "category": "code", "location": {"file": "src/test/Flashloan-flaw.sol", "line": 42, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "a44eac4b2230", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        FixedSimpleBankContract = new FixedSimpleBank(\n            address(LendingPoolContract),\n            address(USDaContract)\n        );", "highlightLines": [43]}, "category": "code", "location": {"file": "src/test/Flashloan-flaw.sol", "line": 43, "column": 35}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "ea91d9757786", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    receive() external payable {}", "highlightLines": [66]}, "category": "code", "location": {"file": "src/test/Flashloan-flaw.sol", "line": 66, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "4a2cae50ced6", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "    receive() external payable {}", "highlightLines": [66]}, "category": "code", "location": {"file": "src/test/Flashloan-flaw.sol", "line": 66, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "fa03261a5641", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(address _lendingPoolAddress, address _asset) {\n        lendingPool = LendingPool(_lendingPoolAddress);\n        USDa = IERC20(_asset);\n    }", "highlightLines": [74]}, "category": "code", "location": {"file": "src/test/Flashloan-flaw.sol", "line": 74, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "12e1e8855516", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        lendingPool = LendingPool(_lendingPoolAddress);\n        USDa = IERC20(_asset);", "highlightLines": [75]}, "category": "code", "location": {"file": "src/test/Flashloan-flaw.sol", "line": 75, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "c5ae069781ac", "fix": {"template": null, "available": false}, "title": "Flash loan amount not validated against available liquidity", "ruleId": "rules.sol-flash-loan-amount-validation", "snippet": {"code": "    function flashLoan(\n        uint256 amounts,\n        address receiverAddress,\n        bytes calldata data\n    ) external {", "highlightLines": [79]}, "category": "code", "location": {"file": "src/test/Flashloan-flaw.sol", "line": 79, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "b94c1dad00f5", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function flashLoan(\n        uint256 amounts,\n        address receiverAddress,\n        bytes calldata data\n    ) external {\n        receiverAddress = address(this);", "highlightLines": [79]}, "category": "code", "location": {"file": "src/test/Flashloan-flaw.sol", "line": 79, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "bacdb48279b5", "fix": {"template": null, "available": false}, "title": "Flash loan allows arbitrary receiver address - can drain third-party contracts (Naive Receiver pattern)", "ruleId": "rules.sol-flash-loan-arbitrary-receiver", "snippet": {"code": "    function flashLoan(\n        uint256 amounts,\n        address receiverAddress,\n        bytes calldata data\n    ) external {\n        receiverAddress = address(this);\n\n        lendingPool.flashLoan(amounts, receiverAddress, data);\n    }", "highlightLines": [79]}, "category": "code", "location": {"file": "src/test/Flashloan-flaw.sol", "line": 79, "column": 5}, "severity": "high", "references": ["https://www.damnvulnerabledefi.xyz/challenges/naive-receiver/"], "description": ""}, {"id": "9a0b3d8938b9", "fix": {"template": null, "available": false}, "title": "Flash loan callback without loan verification - attacker can call directly without actual flash loan", "ruleId": "rules.sol-flash-loan-callback-unprotected", "snippet": {"code": "    function executeOperation(\n        uint256 amounts,\n        address receiverAddress,\n        address _initiator,\n        bytes calldata data\n    ) external {", "highlightLines": [89]}, "category": "code", "location": {"file": "src/test/Flashloan-flaw.sol", "line": 89, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "2a476b48c954", "fix": {"template": null, "available": false}, "title": "Flash loan callback doesn't verify initiator - add require(initiator == address(this))", "ruleId": "rules.sol-flash-loan-no-initiator-check", "snippet": {"code": "    function executeOperation(\n        uint256 amounts,\n        address receiverAddress,\n        address _initiator,\n        bytes calldata data\n    ) external {", "highlightLines": [89]}, "category": "code", "location": {"file": "src/test/Flashloan-flaw.sol", "line": 89, "column": 5}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/Flashloan-flaw.sol"], "description": ""}, {"id": "39b07700620e", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(address _lendingPoolAddress, address _asset) {\n        lendingPool = LendingPool(_lendingPoolAddress);\n        USDa = IERC20(_asset);\n    }", "highlightLines": [110]}, "category": "code", "location": {"file": "src/test/Flashloan-flaw.sol", "line": 110, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "e508810b84a5", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        lendingPool = LendingPool(_lendingPoolAddress);\n        USDa = IERC20(_asset);", "highlightLines": [111]}, "category": "code", "location": {"file": "src/test/Flashloan-flaw.sol", "line": 111, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "4c42b28b9525", "fix": {"template": null, "available": false}, "title": "Flash loan amount not validated against available liquidity", "ruleId": "rules.sol-flash-loan-amount-validation", "snippet": {"code": "    function flashLoan(\n        uint256 amounts,\n        address receiverAddress,\n        bytes calldata data\n    ) external {", "highlightLines": [115]}, "category": "code", "location": {"file": "src/test/Flashloan-flaw.sol", "line": 115, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "d14cdec74c03", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function flashLoan(\n        uint256 amounts,\n        address receiverAddress,\n        bytes calldata data\n    ) external {\n        address receiverAddress = address(this);", "highlightLines": [115]}, "category": "code", "location": {"file": "src/test/Flashloan-flaw.sol", "line": 115, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "f229e1cdad18", "fix": {"template": null, "available": false}, "title": "Flash loan allows arbitrary receiver address - can drain third-party contracts (Naive Receiver pattern)", "ruleId": "rules.sol-flash-loan-arbitrary-receiver", "snippet": {"code": "    function flashLoan(\n        uint256 amounts,\n        address receiverAddress,\n        bytes calldata data\n    ) external {\n        address receiverAddress = address(this);\n\n        lendingPool.flashLoan(amounts, receiverAddress, data);\n    }", "highlightLines": [115]}, "category": "code", "location": {"file": "src/test/Flashloan-flaw.sol", "line": 115, "column": 5}, "severity": "high", "references": ["https://www.damnvulnerabledefi.xyz/challenges/naive-receiver/"], "description": ""}, {"id": "825eba7ce03d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address receiverAddress = address(this);", "highlightLines": [120]}, "category": "code", "location": {"file": "src/test/Flashloan-flaw.sol", "line": 120, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d86e7e7ebf42", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function executeOperation(\n        uint256 amounts,\n        address receiverAddress,\n        address _initiator,\n        bytes calldata data\n    ) external {\n        // Mitigation: make sure to check the initiator\n        require(_initiator == address(this), \"Unauthorized\");", "highlightLines": [125]}, "category": "code", "location": {"file": "src/test/Flashloan-flaw.sol", "line": 125, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "344345ed8ad8", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor() ERC20(\"USDA\", \"USDA\") {\n        _mint(msg.sender, 10000 * 10 ** decimals());\n    }", "highlightLines": [140]}, "category": "code", "location": {"file": "src/test/Flashloan-flaw.sol", "line": 140, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "155c44ca8413", "fix": {"template": null, "available": false}, "title": "NFT mint without supply check - potential overflow in tokenId", "ruleId": "rules.sol-nft-overflow-mint", "snippet": {"code": "        _mint(msg.sender, 10000 * 10 ** decimals());", "highlightLines": [141]}, "category": "code", "location": {"file": "src/test/Flashloan-flaw.sol", "line": 141, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "b6dbf49f6a9b", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function mint(address to, uint256 amount) public onlyOwner {", "highlightLines": [144]}, "category": "code", "location": {"file": "src/test/Flashloan-flaw.sol", "line": 144, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "b7894f7aa3d9", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function mint(address to, uint256 amount) public onlyOwner {", "highlightLines": [144]}, "category": "code", "location": {"file": "src/test/Flashloan-flaw.sol", "line": 144, "column": 54}, "severity": "info", "references": [], "description": ""}, {"id": "6a28b41ec698", "fix": {"template": null, "available": false}, "title": "Owner has excessive privileges - single account controls critical functions without checks", "ruleId": "rules.sol-owner-privilege-escalation", "snippet": {"code": "    function mint(address to, uint256 amount) public onlyOwner {\n        _mint(to, amount);", "highlightLines": [144]}, "category": "code", "location": {"file": "src/test/Flashloan-flaw.sol", "line": 144, "column": 54}, "severity": "medium", "references": [], "description": ""}, {"id": "2fbd194cb6ea", "fix": {"template": null, "available": false}, "title": "NFT mint without supply check - potential overflow in tokenId", "ruleId": "rules.sol-nft-overflow-mint", "snippet": {"code": "        _mint(to, amount);", "highlightLines": [145]}, "category": "code", "location": {"file": "src/test/Flashloan-flaw.sol", "line": 145, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "f290c04f28a2", "fix": {"template": null, "available": false}, "title": "Flash loan callback without loan verification - attacker can call directly without actual flash loan", "ruleId": "rules.sol-flash-loan-callback-unprotected", "snippet": {"code": "    function executeOperation(\n        uint256 amounts,\n        address receiverAddress,\n        address _initiator,\n        bytes calldata data\n    ) external;\n}\n\ncontract LendingPool {", "highlightLines": [150]}, "category": "code", "location": {"file": "src/test/Flashloan-flaw.sol", "line": 150, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "715a72ea8229", "fix": {"template": null, "available": false}, "title": "Flash loan callback doesn't verify initiator - add require(initiator == address(this))", "ruleId": "rules.sol-flash-loan-no-initiator-check", "snippet": {"code": "    function executeOperation(\n        uint256 amounts,\n        address receiverAddress,\n        address _initiator,\n        bytes calldata data\n    ) external;\n}\n\ncontract LendingPool {", "highlightLines": [150]}, "category": "code", "location": {"file": "src/test/Flashloan-flaw.sol", "line": 150, "column": 5}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/Flashloan-flaw.sol"], "description": ""}, {"id": "49adadf2dfcc", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(address _USDA) {\n        USDa = IERC20(_USDA);\n    }", "highlightLines": [161]}, "category": "code", "location": {"file": "src/test/Flashloan-flaw.sol", "line": 161, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "42587cd0bda8", "fix": {"template": null, "available": false}, "title": "Flash loan amount not validated against available liquidity", "ruleId": "rules.sol-flash-loan-amount-validation", "snippet": {"code": "    function flashLoan(\n        uint256 amount,\n        address borrower,\n        bytes calldata data\n    ) public {", "highlightLines": [165]}, "category": "code", "location": {"file": "src/test/Flashloan-flaw.sol", "line": 165, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "e15a7af1c70f", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 balanceBefore = USDa.balanceOf(address(this));", "highlightLines": [170]}, "category": "code", "location": {"file": "src/test/Flashloan-flaw.sol", "line": 170, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "5509ee232dc6", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "        uint256 balanceBefore = USDa.balanceOf(address(this));\n        require(balanceBefore >= amount, \"Not enough liquidity\");\n        require(USDa.transfer(borrower, amount), \"Flashloan transfer failed\");\n        IFlashLoanReceiver(borrower).executeOperation(\n            amount,\n            borrower,\n            msg.sender,\n            data\n        );\n\n        uint256 balanceAfter = USDa.balanceOf(address(this));", "highlightLines": [170]}, "category": "code", "location": {"file": "src/test/Flashloan-flaw.sol", "line": 170, "column": 9}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "3d62726e4fa8", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 balanceBefore = USDa.balanceOf(address(this));\n        require(balanceBefore >= amount, \"Not enough liquidity\");\n        require(USDa.transfer(borrower, amount), \"Flashloan transfer failed\");\n        IFlashLoanReceiver(borrower).executeOperation(\n            amount,\n            borrower,\n            msg.sender,\n            data\n        );\n\n        uint256 balanceAfter = USDa.balanceOf(address(this));", "highlightLines": [170]}, "category": "code", "location": {"file": "src/test/Flashloan-flaw.sol", "line": 170, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "17e740bab641", "fix": {"template": null, "available": false}, "title": "Missing zero address validation - tokens/ETH could be lost", "ruleId": "rules.sol-missing-zero-address-check", "snippet": {"code": "        require(USDa.transfer(borrower, amount), \"Flashloan transfer failed\");", "highlightLines": [172]}, "category": "code", "location": {"file": "src/test/Flashloan-flaw.sol", "line": 172, "column": 17}, "severity": "info", "references": [], "description": ""}, {"id": "f86d5a45c9cc", "fix": {"template": null, "available": false}, "title": "Flash loan transfers assets before validating callback result - assets may not be returned", "ruleId": "rules.sol-flashloan-callback-before-check", "snippet": {"code": "        require(USDa.transfer(borrower, amount), \"Flashloan transfer failed\");\n        IFlashLoanReceiver(borrower).executeOperation(", "highlightLines": [172]}, "category": "code", "location": {"file": "src/test/Flashloan-flaw.sol", "line": 172, "column": 21}, "severity": "high", "references": [], "description": ""}, {"id": "ca482333e2dd", "fix": {"template": null, "available": false}, "title": "Flash loan without proper balance check - ensure atomic execution", "ruleId": "rules.sol-flash-loan-no-check", "snippet": {"code": "        IFlashLoanReceiver(borrower).executeOperation(\n            amount,\n            borrower,\n            msg.sender,\n            data\n        );", "highlightLines": [173]}, "category": "code", "location": {"file": "src/test/Flashloan-flaw.sol", "line": 173, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "aaaa23be95d8", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "        IFlashLoanReceiver(borrower).executeOperation(\n            amount,\n            borrower,\n            msg.sender,\n            data\n        );", "highlightLines": [173]}, "category": "code", "location": {"file": "src/test/Flashloan-flaw.sol", "line": 173, "column": 9}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "4bd2a293285d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 balanceAfter = USDa.balanceOf(address(this));", "highlightLines": [179]}, "category": "code", "location": {"file": "src/test/Flashloan-flaw.sol", "line": 179, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ee8b9c7a86ea", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.15;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/Hash-collisions.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "6f9cf058c2cc", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        HashCollisionBugContract = new HashCollisionBug();", "highlightLines": [38]}, "category": "code", "location": {"file": "src/test/Hash-collisions.sol", "line": 38, "column": 36}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "21ed692e2669", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "            \"(AA,ABBB) Hash\",", "highlightLines": [49]}, "category": "code", "location": {"file": "src/test/Hash-collisions.sol", "line": 49, "column": 16}, "severity": "info", "references": [], "description": ""}, {"id": "699d43dbfe73", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    receive() external payable {}", "highlightLines": [56]}, "category": "code", "location": {"file": "src/test/Hash-collisions.sol", "line": 56, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "567f78877b41", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "    receive() external payable {}", "highlightLines": [56]}, "category": "code", "location": {"file": "src/test/Hash-collisions.sol", "line": 56, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "3133ef5c0120", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        return keccak256(abi.encodePacked(_string1, _string2));", "highlightLines": [66]}, "category": "code", "location": {"file": "src/test/Hash-collisions.sol", "line": 66, "column": 16}, "severity": "high", "references": [], "description": ""}, {"id": "f171b0926aaa", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "        return keccak256(abi.encodePacked(_string1, _string2));", "highlightLines": [66]}, "category": "code", "location": {"file": "src/test/Hash-collisions.sol", "line": 66, "column": 26}, "severity": "medium", "references": [], "description": ""}, {"id": "007138baad28", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function deposit(\n        string memory _string1,\n        string memory _string2\n    ) external payable {", "highlightLines": [69]}, "category": "code", "location": {"file": "src/test/Hash-collisions.sol", "line": 69, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "338d3d5e1126", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        bytes32 hash = createHash(_string1, _string2);", "highlightLines": [74]}, "category": "code", "location": {"file": "src/test/Hash-collisions.sol", "line": 74, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4d9cb73c1cb6", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes32 hash = createHash(_string1, _string2);\n        // createHash(AAA, BBB) -> AAABBB\n        // createHash(AA, ABBB) -> AAABBB\n        // Check if the hash already exists in the balances mapping\n        require(balances[hash] == 0, \"Hash collision detected\");\n\n        balances[hash] = msg.value;", "highlightLines": [75]}, "category": "code", "location": {"file": "src/test/Hash-collisions.sol", "line": 75, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "0dcdef9131a9", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "        // createHash(AA, ABBB) -> AAABBB", "highlightLines": [77]}, "category": "code", "location": {"file": "src/test/Hash-collisions.sol", "line": 77, "column": 24}, "severity": "info", "references": [], "description": ""}, {"id": "53d7d80e967a", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.18;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/Immunefi_ch1.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "f21422d06492", "fix": {"template": null, "available": false}, "title": "Consider using Ownable2Step instead of Ownable for safer ownership transfers", "ruleId": "rules.sol-use-ownable2step", "snippet": {"code": "import \"@openzeppelin/contracts/access/Ownable.sol\";", "highlightLines": [6]}, "category": "code", "location": {"file": "src/test/Immunefi_ch1.sol", "line": 6, "column": 1}, "severity": "info", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/access/Ownable2Step.sol"], "description": ""}, {"id": "a649d780ed76", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        HerTokenContract = new HerToken();", "highlightLines": [16]}, "category": "code", "location": {"file": "src/test/Immunefi_ch1.sol", "line": 16, "column": 28}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "64d455c21c16", "fix": {"template": null, "available": false}, "title": "Token callback function without reentrancy protection - ERC777/721/1155 callbacks can reenter", "ruleId": "rules.sol-callback-without-reentrancy-guard", "snippet": {"code": "    function onERC721Received(\n        address,\n        address,\n        uint256,\n        bytes memory\n    ) public returns (bytes4) {", "highlightLines": [25]}, "category": "code", "location": {"file": "src/test/Immunefi_ch1.sol", "line": 25, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "b82f008f0fa7", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    receive() external payable {}", "highlightLines": [35]}, "category": "code", "location": {"file": "src/test/Immunefi_ch1.sol", "line": 35, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "51c329fb757f", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "    receive() external payable {}", "highlightLines": [35]}, "category": "code", "location": {"file": "src/test/Immunefi_ch1.sol", "line": 35, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "b87aa4b704ac", "fix": {"template": null, "available": false}, "title": "Base constructor called multiple times through diamond inheritance - may initialize twice", "ruleId": "rules.sol-reused-constructor", "snippet": {"code": "contract HerToken is ERC721, Ownable, Test {", "highlightLines": [38]}, "category": "code", "location": {"file": "src/test/Immunefi_ch1.sol", "line": 38, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#reused-base-constructor"], "description": ""}, {"id": "0935ccb7fd31", "fix": {"template": null, "available": false}, "title": "SWC-125: Multiple inheritance may cause incorrect function resolution - check C3 linearization", "ruleId": "rules.sol-swc-125-inheritance-order", "snippet": {"code": "contract HerToken is ERC721, Ownable, Test {", "highlightLines": [38]}, "category": "code", "location": {"file": "src/test/Immunefi_ch1.sol", "line": 38, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-125"], "description": ""}, {"id": "2bb8a7cd669a", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract HerToken is ERC721, Ownable, Test {\n    uint128 constant MINT_PRICE = 1 ether;\n    uint128 constant MAX_SUPPLY = 10000;\n    uint mintIndex;", "highlightLines": [38]}, "category": "code", "location": {"file": "src/test/Immunefi_ch1.sol", "line": 38, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "c4737191ac79", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint mintIndex;", "highlightLines": [41]}, "category": "code", "location": {"file": "src/test/Immunefi_ch1.sol", "line": 41, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "fef04e146933", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor() payable ERC721(\"HarToken\", \"HRT\") {}", "highlightLines": [45]}, "category": "code", "location": {"file": "src/test/Immunefi_ch1.sol", "line": 45, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "a3fa52ef75fd", "fix": {"template": null, "available": false}, "title": "msg.value used in loop - payment can be reused for multiple iterations (Free Rider pattern)", "ruleId": "rules.sol-msg-value-loop-reuse", "snippet": {"code": "            require(msg.value >= MINT_PRICE, \"Insufficient Ether.\");", "highlightLines": [56]}, "category": "code", "location": {"file": "src/test/Immunefi_ch1.sol", "line": 56, "column": 21}, "severity": "high", "references": ["https://www.damnvulnerabledefi.xyz/challenges/free-rider/"], "description": ""}, {"id": "2972f2f8d872", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.18;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/Immunefi_ch2.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "f1641e978bda", "fix": {"template": null, "available": false}, "title": "Consider using Ownable2Step instead of Ownable for safer ownership transfers", "ruleId": "rules.sol-use-ownable2step", "snippet": {"code": "import \"@openzeppelin/contracts/access/Ownable.sol\";", "highlightLines": [7]}, "category": "code", "location": {"file": "src/test/Immunefi_ch2.sol", "line": 7, "column": 1}, "severity": "info", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/access/Ownable2Step.sol"], "description": ""}, {"id": "8dfc9be1eee3", "fix": {"template": null, "available": false}, "title": "Initialization function can be front-run - use initializer modifier or constructor", "ruleId": "rules.sol-initialization-frontrun", "snippet": {"code": "    function initialize(address) external;", "highlightLines": [13]}, "category": "code", "location": {"file": "src/test/Immunefi_ch2.sol", "line": 13, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "a2ddf86fbc5e", "fix": {"template": null, "available": false}, "title": "Clone/minimal proxy initializer without protection - can be front-run and hijacked", "ruleId": "rules.sol-unprotected-clone-initializer", "snippet": {"code": "    function initialize(address) external;", "highlightLines": [13]}, "category": "code", "location": {"file": "src/test/Immunefi_ch2.sol", "line": 13, "column": 5}, "severity": "high", "references": ["https://blog.openzeppelin.com/security-advisory-initialize-uups-implementation-contracts"], "description": ""}, {"id": "2591fcaf06da", "fix": {"template": null, "available": false}, "title": "Initializer function not protected - can be called multiple times", "ruleId": "rules.sol-initializer-not-protected", "snippet": {"code": "    function initialize(address) external;\n}\n\ncontract ContractTest is Test {", "highlightLines": [13]}, "category": "code", "location": {"file": "src/test/Immunefi_ch2.sol", "line": 13, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "496eefef1198", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        ImplementationContract = new Implementation();\n        console.log(\n            \"ImplementationContract addr\",\n            address(ImplementationContract)\n        );\n        ProxyContract = new Proxy(address(ImplementationContract));", "highlightLines": [21]}, "category": "code", "location": {"file": "src/test/Immunefi_ch2.sol", "line": 21, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "6b4ff70a7a60", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        ImplementationContract = new Implementation();", "highlightLines": [21]}, "category": "code", "location": {"file": "src/test/Immunefi_ch2.sol", "line": 21, "column": 34}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "b3f3fc81db86", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        ProxyContract = new Proxy(address(ImplementationContract));", "highlightLines": [26]}, "category": "code", "location": {"file": "src/test/Immunefi_ch2.sol", "line": 26, "column": 25}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "aebee74cf9e4", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(address implementation) {\n        _setImplementation(address(0));\n        Address.functionDelegateCall(\n            implementation,\n            abi.encodeWithSignature(\"initialize(address)\", msg.sender)\n        );\n    }", "highlightLines": [39]}, "category": "code", "location": {"file": "src/test/Immunefi_ch2.sol", "line": 39, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "f9bc9d16f6fb", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    fallback() external payable {", "highlightLines": [47]}, "category": "code", "location": {"file": "src/test/Immunefi_ch2.sol", "line": 47, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "08de893eb3d9", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address implementation = _getImplementation();", "highlightLines": [48]}, "category": "code", "location": {"file": "src/test/Immunefi_ch2.sol", "line": 48, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "bda3397af8bb", "fix": {"template": null, "available": false}, "title": "Initialization function can be front-run - use initializer modifier or constructor", "ruleId": "rules.sol-initialization-frontrun", "snippet": {"code": "    // function initialize(address owner) external {    //test purpose", "highlightLines": [65]}, "category": "code", "location": {"file": "src/test/Immunefi_ch2.sol", "line": 65, "column": 8}, "severity": "high", "references": [], "description": ""}, {"id": "2efa04d6cc3e", "fix": {"template": null, "available": false}, "title": "Clone/minimal proxy initializer without protection - can be front-run and hijacked", "ruleId": "rules.sol-unprotected-clone-initializer", "snippet": {"code": "    // function initialize(address owner) external {    //test purpose", "highlightLines": [65]}, "category": "code", "location": {"file": "src/test/Immunefi_ch2.sol", "line": 65, "column": 8}, "severity": "high", "references": ["https://blog.openzeppelin.com/security-advisory-initialize-uups-implementation-contracts"], "description": ""}, {"id": "02616d576031", "fix": {"template": null, "available": false}, "title": "Initializer function not protected - can be called multiple times", "ruleId": "rules.sol-initializer-not-protected", "snippet": {"code": "    // function initialize(address owner) external {    //test purpose", "highlightLines": [65]}, "category": "code", "location": {"file": "src/test/Immunefi_ch2.sol", "line": 65, "column": 8}, "severity": "high", "references": [], "description": ""}, {"id": "593e8a5f44a6", "fix": {"template": null, "available": false}, "title": "Initializer function not protected - can be called multiple times", "ruleId": "rules.sol-initializer-not-protected", "snippet": {"code": "    function initialize(address owner) external initializer {", "highlightLines": [66]}, "category": "code", "location": {"file": "src/test/Immunefi_ch2.sol", "line": 66, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "628f0f38f769", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.18;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "6af0fa8aff1e", "fix": {"template": null, "available": false}, "title": "Consider using Ownable2Step instead of Ownable for safer ownership transfers", "ruleId": "rules.sol-use-ownable2step", "snippet": {"code": "import \"@openzeppelin/contracts/access/Ownable.sol\";", "highlightLines": [6]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 6, "column": 1}, "severity": "info", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/access/Ownable2Step.sol"], "description": ""}, {"id": "47c0070f308d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "uint256 amount = locker.amount;", "highlightLines": [20]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 20, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a412dea57da9", "fix": {"template": null, "available": false}, "title": "Block timestamp used for critical logic - miners can manipulate within ~15 second window", "ruleId": "rules.sol-block-timestamp-manipulation", "snippet": {"code": "if (block.timestamp > locker.lockTime) {", "highlightLines": [21]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 21, "column": 5}, "severity": "medium", "references": ["https://consensys.github.io/smart-contract-best-practices/development-recommendations/solidity-specific/timestamp-dependence/"], "description": ""}, {"id": "8a1e82382679", "fix": {"template": null, "available": false}, "title": "ERC20 transfer return value not checked - token may return false instead of revert", "ruleId": "rules.sol-unchecked-transfer-bool", "snippet": {"code": "    IERC20(locker.tokenAddress).transfer(msg.sender, amount);", "highlightLines": [22]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 22, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/Returnfalse.sol"], "description": ""}, {"id": "f1ba6458a901", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract ContractTest is Test {\n    VulnerableBank VulnerableBankContract;\n    BanksLP BanksLPContract;\n    FixedeBank FixedeBankContract;\n    address alice = vm.addr(1);", "highlightLines": [31]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 31, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "643f2c956c40", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address alice = vm.addr(1);", "highlightLines": [35]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 35, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "93a4d34532c1", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        VulnerableBankContract = new VulnerableBank();\n        FixedeBankContract = new FixedeBank();", "highlightLines": [38]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 38, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d8fd3f03b01f", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        VulnerableBankContract = new VulnerableBank();", "highlightLines": [38]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 38, "column": 34}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "2fa6de26c39e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        FixedeBankContract = new FixedeBank();\n        BanksLPContract = new BanksLP();", "highlightLines": [39]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 39, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "8fd1eedc4dca", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        FixedeBankContract = new FixedeBank();", "highlightLines": [39]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 39, "column": 30}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "11b4a045c1ea", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        BanksLPContract = new BanksLP();", "highlightLines": [40]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 40, "column": 27}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "686e5237a780", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        BanksLPContract.transfer(address(alice), 10000);", "highlightLines": [41]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 41, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "97073468af4b", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "        BanksLPContract.transfer(address(alice), 10000);", "highlightLines": [41]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 41, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "264579b66672", "fix": {"template": null, "available": false}, "title": "ERC20 transfer() return value not checked - tokens like USDT don't return bool", "ruleId": "rules.sol-erc20-transfer-no-return-check", "snippet": {"code": "        BanksLPContract.transfer(address(alice), 10000);", "highlightLines": [41]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 41, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e689bc653669", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        BanksLPContract.transfer(address(VulnerableBankContract), 100000);", "highlightLines": [42]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 42, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "f7eb3d1abcea", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "        BanksLPContract.transfer(address(VulnerableBankContract), 100000);", "highlightLines": [42]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 42, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "65b312cbba9a", "fix": {"template": null, "available": false}, "title": "ERC20 transfer() return value not checked - tokens like USDT don't return bool", "ruleId": "rules.sol-erc20-transfer-no-return-check", "snippet": {"code": "        BanksLPContract.transfer(address(VulnerableBankContract), 100000);", "highlightLines": [42]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 42, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "1bf5702c0ecd", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        console.log(\"Current timestamp\", block.timestamp);", "highlightLines": [47]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 47, "column": 42}, "severity": "medium", "references": [], "description": ""}, {"id": "dbb369a171fc", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        console.log(\"Current timestamp\", block.timestamp);", "highlightLines": [77]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 77, "column": 42}, "severity": "medium", "references": [], "description": ""}, {"id": "399f0d2ebb99", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool hasLockedTokens;", "highlightLines": [106]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 106, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "720fb8599d93", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 amount;", "highlightLines": [107]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 107, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "1c0de3e90bac", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 lockTime;", "highlightLines": [108]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 108, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d3d4b8d3c835", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address tokenAddress;", "highlightLines": [109]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 109, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4038cdee8171", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function createLocker(\n        address tokenAddress,\n        uint256 amount,\n        uint256 lockTime\n    ) public {\n        require(amount > 0, \"Amount must be greater than 0\");\n        require(lockTime > block.timestamp, \"Lock time must be in the future\");\n        require(\n            IERC20(tokenAddress).balanceOf(msg.sender) >= amount,\n            \"Insufficient token balance\"\n        );\n\n        // Transfer the tokens to this contract\n        IERC20(tokenAddress).transferFrom(msg.sender, address(this), amount);\n\n        // Create the locker\n        Locker storage locker = _unlockToken[msg.sender][_nextLockerId];\n        locker.hasLockedTokens = true;\n        locker.amount = amount;\n        locker.lockTime = lockTime;", "highlightLines": [115]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 115, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "c6be38d6ebfc", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        require(lockTime > block.timestamp, \"Lock time must be in the future\");", "highlightLines": [121]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 121, "column": 28}, "severity": "medium", "references": [], "description": ""}, {"id": "1c6615305f6b", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "            IERC20(tokenAddress).balanceOf(msg.sender) >= amount,", "highlightLines": [123]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 123, "column": 13}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "4e847010f0a9", "fix": {"template": null, "available": false}, "title": "Token transfer without checking actual received amount - deflationary tokens may transfer less", "ruleId": "rules.sol-deflationary-token-transfer", "snippet": {"code": "        IERC20(tokenAddress).transferFrom(msg.sender, address(this), amount);", "highlightLines": [128]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 128, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "224b1f313656", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        IERC20(tokenAddress).transferFrom(msg.sender, address(this), amount);", "highlightLines": [128]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 128, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "bbae66b210a0", "fix": {"template": null, "available": false}, "title": "Token amount after transfer may differ - check actual received amount", "ruleId": "rules.sol-fee-on-transfer-token", "snippet": {"code": "        IERC20(tokenAddress).transferFrom(msg.sender, address(this), amount);", "highlightLines": [128]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 128, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "a69a5e9838d6", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "        IERC20(tokenAddress).transferFrom(msg.sender, address(this), amount);", "highlightLines": [128]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 128, "column": 9}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "9420ec39655f", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without SafeERC20 - some tokens dont return bool", "ruleId": "rules.sol-unsafe-erc20-transfer", "snippet": {"code": "        IERC20(tokenAddress).transferFrom(msg.sender, address(this), amount);", "highlightLines": [128]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 128, "column": 9}, "severity": "medium", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/token/ERC20/utils/SafeERC20.sol"], "description": ""}, {"id": "d8d2341cd091", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        Locker storage locker = _unlockToken[msg.sender][_nextLockerId];\n        locker.hasLockedTokens = true;", "highlightLines": [131]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 131, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "1425a793fe71", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        locker.hasLockedTokens = true;\n        locker.amount = amount;", "highlightLines": [132]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 132, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "1dab86eaee3f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        locker.amount = amount;\n        locker.lockTime = lockTime;", "highlightLines": [133]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 133, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "66eced5ac694", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        locker.lockTime = lockTime;\n        locker.tokenAddress = tokenAddress;", "highlightLines": [134]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 134, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "f391b3d385a3", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        Locker storage locker = _unlockToken[msg.sender][lockerId];\n        // Save the amount to a local variable\n        uint256 amount = locker.amount;", "highlightLines": [141]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 141, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "b1422c08cff3", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 amount = locker.amount;", "highlightLines": [143]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 143, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f05194efe0eb", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 amount = locker.amount;\n        require(locker.hasLockedTokens, \"No locked tokens\");\n\n        // Incorrect sanity checks.\n        if (block.timestamp > locker.lockTime) {\n            locker.amount = 0;\n        }", "highlightLines": [143]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 143, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "51e6ea6b586f", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        if (block.timestamp > locker.lockTime) {", "highlightLines": [147]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 147, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "ef331cbaa91f", "fix": {"template": null, "available": false}, "title": "Block timestamp used for critical logic - miners can manipulate within ~15 second window", "ruleId": "rules.sol-block-timestamp-manipulation", "snippet": {"code": "        if (block.timestamp > locker.lockTime) {", "highlightLines": [147]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 147, "column": 13}, "severity": "medium", "references": ["https://consensys.github.io/smart-contract-best-practices/development-recommendations/solidity-specific/timestamp-dependence/"], "description": ""}, {"id": "0137b396201a", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        IERC20(locker.tokenAddress).transfer(msg.sender, amount);", "highlightLines": [154]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 154, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "69192686f09d", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "        IERC20(locker.tokenAddress).transfer(msg.sender, amount);", "highlightLines": [154]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 154, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "220893dc7cab", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without SafeERC20 - some tokens dont return bool", "ruleId": "rules.sol-unsafe-erc20-transfer", "snippet": {"code": "        IERC20(locker.tokenAddress).transfer(msg.sender, amount);", "highlightLines": [154]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 154, "column": 9}, "severity": "medium", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/token/ERC20/utils/SafeERC20.sol"], "description": ""}, {"id": "d84407c4d4b4", "fix": {"template": null, "available": false}, "title": "ERC20 transfer return value not checked - token may return false instead of revert", "ruleId": "rules.sol-unchecked-transfer-bool", "snippet": {"code": "        IERC20(locker.tokenAddress).transfer(msg.sender, amount);", "highlightLines": [154]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 154, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/Returnfalse.sol"], "description": ""}, {"id": "1226f6463582", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor() ERC20(\"BanksLP\", \"BanksLP\") {\n        _mint(msg.sender, 10000 * 10 ** decimals());\n    }", "highlightLines": [159]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 159, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "368e8ffa0553", "fix": {"template": null, "available": false}, "title": "NFT mint without supply check - potential overflow in tokenId", "ruleId": "rules.sol-nft-overflow-mint", "snippet": {"code": "        _mint(msg.sender, 10000 * 10 ** decimals());", "highlightLines": [160]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 160, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "8edd176052ef", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function mint(address to, uint256 amount) public onlyOwner {", "highlightLines": [163]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 163, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "2af6199b4566", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function mint(address to, uint256 amount) public onlyOwner {", "highlightLines": [163]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 163, "column": 54}, "severity": "info", "references": [], "description": ""}, {"id": "22618333fa12", "fix": {"template": null, "available": false}, "title": "Owner has excessive privileges - single account controls critical functions without checks", "ruleId": "rules.sol-owner-privilege-escalation", "snippet": {"code": "    function mint(address to, uint256 amount) public onlyOwner {\n        _mint(to, amount);", "highlightLines": [163]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 163, "column": 54}, "severity": "medium", "references": [], "description": ""}, {"id": "42c546c4ba1e", "fix": {"template": null, "available": false}, "title": "NFT mint without supply check - potential overflow in tokenId", "ruleId": "rules.sol-nft-overflow-mint", "snippet": {"code": "        _mint(to, amount);", "highlightLines": [164]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 164, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "9c2b2a5b2ad7", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool hasLockedTokens;", "highlightLines": [170]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 170, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "58f4d7ba815b", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 amount;", "highlightLines": [171]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 171, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "df2e5ef37ea0", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 lockTime;", "highlightLines": [172]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 172, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e979dd310094", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address tokenAddress;", "highlightLines": [173]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 173, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "aeda666ea6eb", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function createLocker(\n        address tokenAddress,\n        uint256 amount,\n        uint256 lockTime\n    ) public {\n        require(amount > 0, \"Amount must be greater than 0\");\n        require(lockTime > block.timestamp, \"Lock time must be in the future\");\n        require(\n            IERC20(tokenAddress).balanceOf(msg.sender) >= amount,\n            \"Insufficient token balance\"\n        );\n\n        // Transfer the tokens to this contract\n        IERC20(tokenAddress).transferFrom(msg.sender, address(this), amount);\n\n        // Create the locker\n        Locker storage locker = _unlockToken[msg.sender][_nextLockerId];\n        locker.hasLockedTokens = true;\n        locker.amount = amount;\n        locker.lockTime = lockTime;", "highlightLines": [179]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 179, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "d6e7c182a901", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        require(lockTime > block.timestamp, \"Lock time must be in the future\");", "highlightLines": [185]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 185, "column": 28}, "severity": "medium", "references": [], "description": ""}, {"id": "589572092ae1", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "            IERC20(tokenAddress).balanceOf(msg.sender) >= amount,", "highlightLines": [187]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 187, "column": 13}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "138a62a43217", "fix": {"template": null, "available": false}, "title": "Token transfer without checking actual received amount - deflationary tokens may transfer less", "ruleId": "rules.sol-deflationary-token-transfer", "snippet": {"code": "        IERC20(tokenAddress).transferFrom(msg.sender, address(this), amount);", "highlightLines": [192]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 192, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "c7d2f4353152", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        IERC20(tokenAddress).transferFrom(msg.sender, address(this), amount);", "highlightLines": [192]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 192, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "8d2261814367", "fix": {"template": null, "available": false}, "title": "Token amount after transfer may differ - check actual received amount", "ruleId": "rules.sol-fee-on-transfer-token", "snippet": {"code": "        IERC20(tokenAddress).transferFrom(msg.sender, address(this), amount);", "highlightLines": [192]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 192, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "a62c02530eb3", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "        IERC20(tokenAddress).transferFrom(msg.sender, address(this), amount);", "highlightLines": [192]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 192, "column": 9}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "341375bbf1ba", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without SafeERC20 - some tokens dont return bool", "ruleId": "rules.sol-unsafe-erc20-transfer", "snippet": {"code": "        IERC20(tokenAddress).transferFrom(msg.sender, address(this), amount);", "highlightLines": [192]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 192, "column": 9}, "severity": "medium", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/token/ERC20/utils/SafeERC20.sol"], "description": ""}, {"id": "38ce8b983338", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        Locker storage locker = _unlockToken[msg.sender][_nextLockerId];\n        locker.hasLockedTokens = true;", "highlightLines": [195]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 195, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "903a39f90ce0", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        locker.hasLockedTokens = true;\n        locker.amount = amount;", "highlightLines": [196]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 196, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "4f52bf4251e9", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        locker.amount = amount;\n        locker.lockTime = lockTime;", "highlightLines": [197]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 197, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "06ae5f258d99", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        locker.lockTime = lockTime;\n        locker.tokenAddress = tokenAddress;", "highlightLines": [198]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 198, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "5678b5ac86d6", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        Locker storage locker = _unlockToken[msg.sender][lockerId];\n\n        require(locker.hasLockedTokens, \"No locked tokens\");\n        require(block.timestamp > locker.lockTime, \"Tokens are still locked\");\n        // Save the amount to a local variable\n        uint256 amount = locker.amount;", "highlightLines": [205]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 205, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "44969d46c979", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        require(block.timestamp > locker.lockTime, \"Tokens are still locked\");", "highlightLines": [208]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 208, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "6afd272d366b", "fix": {"template": null, "available": false}, "title": "Block timestamp used for critical logic - miners can manipulate within ~15 second window", "ruleId": "rules.sol-block-timestamp-manipulation", "snippet": {"code": "        require(block.timestamp > locker.lockTime, \"Tokens are still locked\");", "highlightLines": [208]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 208, "column": 17}, "severity": "medium", "references": ["https://consensys.github.io/smart-contract-best-practices/development-recommendations/solidity-specific/timestamp-dependence/"], "description": ""}, {"id": "a313e392264e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 amount = locker.amount;", "highlightLines": [210]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 210, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "bfeca8134b1c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 amount = locker.amount;\n\n        // Mark the tokens as unlocked\n        locker.hasLockedTokens = false;", "highlightLines": [210]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 210, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "5f516b27a704", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        locker.hasLockedTokens = false;\n        locker.amount = 0;", "highlightLines": [213]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 213, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "5293d388173f", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        IERC20(locker.tokenAddress).transfer(msg.sender, amount);", "highlightLines": [217]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 217, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "ac2ff7b0d307", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "        IERC20(locker.tokenAddress).transfer(msg.sender, amount);", "highlightLines": [217]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 217, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "b6cd8a63e2e6", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without SafeERC20 - some tokens dont return bool", "ruleId": "rules.sol-unsafe-erc20-transfer", "snippet": {"code": "        IERC20(locker.tokenAddress).transfer(msg.sender, amount);", "highlightLines": [217]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 217, "column": 9}, "severity": "medium", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/token/ERC20/utils/SafeERC20.sol"], "description": ""}, {"id": "4dd8ee0ca2b0", "fix": {"template": null, "available": false}, "title": "ERC20 transfer return value not checked - token may return false instead of revert", "ruleId": "rules.sol-unchecked-transfer-bool", "snippet": {"code": "        IERC20(locker.tokenAddress).transfer(msg.sender, amount);", "highlightLines": [217]}, "category": "code", "location": {"file": "src/test/Incorrect_sanity_checks.sol", "line": 217, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/Returnfalse.sol"], "description": ""}, {"id": "31bfeeb7d71f", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.7.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/Invariant.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "3e13c142be02", "fix": {"template": null, "available": false}, "title": "Possible incorrect exponentiation - ^ is XOR in Solidity, use ** for power", "ruleId": "rules.sol-incorrect-exponentiation", "snippet": {"code": "Unsigned integers can store values from 0 to 2^n - 1, so in this case 2^64 - 1, or roughly 18.4467 Ether.", "highlightLines": [16]}, "category": "code", "location": {"file": "src/test/Invariant.sol", "line": 16, "column": 71}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-exponentiation"], "description": ""}, {"id": "976ab118233a", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        InvariantContract = new Invariant();", "highlightLines": [36]}, "category": "code", "location": {"file": "src/test/Invariant.sol", "line": 36, "column": 29}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "333d27fde203", "fix": {"template": null, "available": false}, "title": "Possible incorrect exponentiation - ^ is XOR in Solidity, use ** for power", "ruleId": "rules.sol-incorrect-exponentiation", "snippet": {"code": "so that's 2^64-1 or 18446744073709551615. So, it can store a max of 18.4467...", "highlightLines": [52]}, "category": "code", "location": {"file": "src/test/Invariant.sol", "line": 52, "column": 11}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-exponentiation"], "description": ""}, {"id": "4897adaed1e5", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    receive() external payable {}", "highlightLines": [58]}, "category": "code", "location": {"file": "src/test/Invariant.sol", "line": 58, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "50088b96c419", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "    receive() external payable {}", "highlightLines": [58]}, "category": "code", "location": {"file": "src/test/Invariant.sol", "line": 58, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "fe41f07acce8", "fix": {"template": null, "available": false}, "title": "Balance mapping uses uint64/uint32 - overflows at ~18 ETH, use uint256", "ruleId": "rules.sol-undersized-balance-mapping", "snippet": {"code": "    mapping(address => uint64) public balanceReceived;", "highlightLines": [62]}, "category": "code", "location": {"file": "src/test/Invariant.sol", "line": 62, "column": 5}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/Invariant.sol"], "description": ""}, {"id": "2b10acaf4b0c", "fix": {"template": null, "available": false}, "title": "Casting to smaller uint in unchecked accumulator can overflow silently", "ruleId": "rules.sol-invariant-uint64-overflow", "snippet": {"code": "        balanceReceived[msg.sender] += uint64(msg.value);", "highlightLines": [65]}, "category": "code", "location": {"file": "src/test/Invariant.sol", "line": 65, "column": 37}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/Invariant.sol"], "description": ""}, {"id": "17ed4d21a04e", "fix": {"template": null, "available": false}, "title": "ETH value cast to uint64/uint32 - overflows silently at ~18 ETH", "ruleId": "rules.sol-undersized-eth-accumulator", "snippet": {"code": "        balanceReceived[msg.sender] += uint64(msg.value);", "highlightLines": [65]}, "category": "code", "location": {"file": "src/test/Invariant.sol", "line": 65, "column": 37}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/Invariant.sol"], "description": ""}, {"id": "2d0349ed020a", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        balanceReceived[msg.sender] += uint64(msg.value);", "highlightLines": [65]}, "category": "code", "location": {"file": "src/test/Invariant.sol", "line": 65, "column": 40}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "56e90c7182cb", "fix": {"template": null, "available": false}, "title": "require() in withdrawal path - griefing possible if condition can be manipulated", "ruleId": "rules.sol-force-revert-griefing", "snippet": {"code": "    function withdrawMoney(address payable _to, uint64 _amount) public {\n        require(\n            _amount <= balanceReceived[msg.sender],", "highlightLines": [68]}, "category": "code", "location": {"file": "src/test/Invariant.sol", "line": 68, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "a3c02e2d9dd5", "fix": {"template": null, "available": false}, "title": "SWC-105: Ether withdrawal without access control - anyone can drain funds", "ruleId": "rules.sol-swc-105-unprotected-withdrawal", "snippet": {"code": "    function withdrawMoney(address payable _to, uint64 _amount) public {\n        require(\n            _amount <= balanceReceived[msg.sender],\n            \"Not Enough Funds, aborting\"\n        );\n\n        balanceReceived[msg.sender] -= _amount;\n        _to.transfer(_amount);", "highlightLines": [68]}, "category": "code", "location": {"file": "src/test/Invariant.sol", "line": 68, "column": 5}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-105"], "description": ""}, {"id": "407b9de85116", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        _to.transfer(_amount);", "highlightLines": [75]}, "category": "code", "location": {"file": "src/test/Invariant.sol", "line": 75, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "da2863ef1aea", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.18;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/NFT-transfer.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "cf2918b8bee1", "fix": {"template": null, "available": false}, "title": "Consider using Ownable2Step instead of Ownable for safer ownership transfers", "ruleId": "rules.sol-use-ownable2step", "snippet": {"code": "import \"@openzeppelin/contracts/access/Ownable.sol\";", "highlightLines": [6]}, "category": "code", "location": {"file": "src/test/NFT-transfer.sol", "line": 6, "column": 1}, "severity": "info", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/access/Ownable2Step.sol"], "description": ""}, {"id": "a147ff9a63d0", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract ContractTest is Test {\n    VulnerableERC721 VulnerableERC721Contract;\n    FixedERC721 FixedERC721Contract;\n    address alice = vm.addr(1);\n    address bob = vm.addr(2);", "highlightLines": [29]}, "category": "code", "location": {"file": "src/test/NFT-transfer.sol", "line": 29, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "f6b7902eeb20", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address alice = vm.addr(1);", "highlightLines": [32]}, "category": "code", "location": {"file": "src/test/NFT-transfer.sol", "line": 32, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "973b3a682b61", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address bob = vm.addr(2);", "highlightLines": [33]}, "category": "code", "location": {"file": "src/test/NFT-transfer.sol", "line": 33, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b0780c54e073", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        VulnerableERC721Contract = new VulnerableERC721();\n        VulnerableERC721Contract.safeMint(alice, 1);\n        FixedERC721Contract = new FixedERC721();", "highlightLines": [36]}, "category": "code", "location": {"file": "src/test/NFT-transfer.sol", "line": 36, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "92b6594d46c7", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        VulnerableERC721Contract = new VulnerableERC721();", "highlightLines": [36]}, "category": "code", "location": {"file": "src/test/NFT-transfer.sol", "line": 36, "column": 36}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "4a722eae5455", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        FixedERC721Contract = new FixedERC721();", "highlightLines": [38]}, "category": "code", "location": {"file": "src/test/NFT-transfer.sol", "line": 38, "column": 31}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "49c6952f9454", "fix": {"template": null, "available": false}, "title": "Token transfer without checking actual received amount - deflationary tokens may transfer less", "ruleId": "rules.sol-deflationary-token-transfer", "snippet": {"code": "        VulnerableERC721Contract.transferFrom(address(alice), address(bob), 1);", "highlightLines": [45]}, "category": "code", "location": {"file": "src/test/NFT-transfer.sol", "line": 45, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "b6d89b1b0ef0", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        VulnerableERC721Contract.transferFrom(address(alice), address(bob), 1);", "highlightLines": [45]}, "category": "code", "location": {"file": "src/test/NFT-transfer.sol", "line": 45, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "f93f7f99dc79", "fix": {"template": null, "available": false}, "title": "Token amount after transfer may differ - check actual received amount", "ruleId": "rules.sol-fee-on-transfer-token", "snippet": {"code": "        VulnerableERC721Contract.transferFrom(address(alice), address(bob), 1);", "highlightLines": [45]}, "category": "code", "location": {"file": "src/test/NFT-transfer.sol", "line": 45, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "c9fe82e7c435", "fix": {"template": null, "available": false}, "title": "Token transfer without checking actual received amount - deflationary tokens may transfer less", "ruleId": "rules.sol-deflationary-token-transfer", "snippet": {"code": "        FixedERC721Contract.transferFrom(address(alice), address(bob), 1);", "highlightLines": [54]}, "category": "code", "location": {"file": "src/test/NFT-transfer.sol", "line": 54, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "85aeb4bfebc2", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        FixedERC721Contract.transferFrom(address(alice), address(bob), 1);", "highlightLines": [54]}, "category": "code", "location": {"file": "src/test/NFT-transfer.sol", "line": 54, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "36bef8740b12", "fix": {"template": null, "available": false}, "title": "Token amount after transfer may differ - check actual received amount", "ruleId": "rules.sol-fee-on-transfer-token", "snippet": {"code": "        FixedERC721Contract.transferFrom(address(alice), address(bob), 1);", "highlightLines": [54]}, "category": "code", "location": {"file": "src/test/NFT-transfer.sol", "line": 54, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "4a45a9c07808", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    receive() external payable {}", "highlightLines": [58]}, "category": "code", "location": {"file": "src/test/NFT-transfer.sol", "line": 58, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "5e082007473a", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "    receive() external payable {}", "highlightLines": [58]}, "category": "code", "location": {"file": "src/test/NFT-transfer.sol", "line": 58, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "c7f2322b0fab", "fix": {"template": null, "available": false}, "title": "Token callback function without reentrancy protection - ERC777/721/1155 callbacks can reenter", "ruleId": "rules.sol-callback-without-reentrancy-guard", "snippet": {"code": "    function onERC721Received(\n        address,\n        address,\n        uint256,\n        bytes memory\n    ) external pure returns (bytes4) {", "highlightLines": [60]}, "category": "code", "location": {"file": "src/test/NFT-transfer.sol", "line": 60, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "7f2352457aef", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor() ERC721(\"MyNFT\", \"MNFT\") {}", "highlightLines": [71]}, "category": "code", "location": {"file": "src/test/NFT-transfer.sol", "line": 71, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "30af7c411f8d", "fix": {"template": null, "available": false}, "title": "ERC20 transferFrom without payload size validation - consider adding onlyPayloadSize modifier", "ruleId": "rules.sol-erc20-missing-payload-modifier", "snippet": {"code": "    function transferFrom(\n        address from,\n        address to,\n        uint256 tokenId\n    ) public override {", "highlightLines": [74]}, "category": "code", "location": {"file": "src/test/NFT-transfer.sol", "line": 74, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address"], "description": ""}, {"id": "f6735f4a95af", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function transferFrom(\n        address from,\n        address to,\n        uint256 tokenId\n    ) public override {", "highlightLines": [74]}, "category": "code", "location": {"file": "src/test/NFT-transfer.sol", "line": 74, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "dac50d9d54e9", "fix": {"template": null, "available": false}, "title": "NFT transfer without approval/ownership check - add _isApprovedOrOwner validation", "ruleId": "rules.sol-nft-transfer-no-approval-check", "snippet": {"code": "    function transferFrom(\n        address from,\n        address to,\n        uint256 tokenId\n    ) public override {", "highlightLines": [74]}, "category": "code", "location": {"file": "src/test/NFT-transfer.sol", "line": 74, "column": 5}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/NFT-transfer.sol"], "description": ""}, {"id": "1ec9ddf6c3fc", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function transferFrom(\n        address from,\n        address to,\n        uint256 tokenId\n    ) public override {", "highlightLines": [74]}, "category": "code", "location": {"file": "src/test/NFT-transfer.sol", "line": 74, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "61f55e92e8e6", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function safeMint(address to, uint256 tokenId) public onlyOwner {", "highlightLines": [83]}, "category": "code", "location": {"file": "src/test/NFT-transfer.sol", "line": 83, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "9b0e493322e5", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function safeMint(address to, uint256 tokenId) public onlyOwner {", "highlightLines": [83]}, "category": "code", "location": {"file": "src/test/NFT-transfer.sol", "line": 83, "column": 59}, "severity": "info", "references": [], "description": ""}, {"id": "4899ebb8f7a4", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor() ERC721(\"MyNFT\", \"MNFT\") {}", "highlightLines": [89]}, "category": "code", "location": {"file": "src/test/NFT-transfer.sol", "line": 89, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "aca5eca5bc17", "fix": {"template": null, "available": false}, "title": "ERC20 transferFrom without payload size validation - consider adding onlyPayloadSize modifier", "ruleId": "rules.sol-erc20-missing-payload-modifier", "snippet": {"code": "    function transferFrom(\n        address from,\n        address to,\n        uint256 tokenId\n    ) public override {", "highlightLines": [92]}, "category": "code", "location": {"file": "src/test/NFT-transfer.sol", "line": 92, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address"], "description": ""}, {"id": "2363254d33e0", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function transferFrom(\n        address from,\n        address to,\n        uint256 tokenId\n    ) public override {", "highlightLines": [92]}, "category": "code", "location": {"file": "src/test/NFT-transfer.sol", "line": 92, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "0f9173384bb9", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function transferFrom(\n        address from,\n        address to,\n        uint256 tokenId\n    ) public override {", "highlightLines": [92]}, "category": "code", "location": {"file": "src/test/NFT-transfer.sol", "line": 92, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "e1f4c2109936", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function safeMint(address to, uint256 tokenId) public onlyOwner {", "highlightLines": [105]}, "category": "code", "location": {"file": "src/test/NFT-transfer.sol", "line": 105, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "052ce55f4a4d", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function safeMint(address to, uint256 tokenId) public onlyOwner {", "highlightLines": [105]}, "category": "code", "location": {"file": "src/test/NFT-transfer.sol", "line": 105, "column": 59}, "severity": "info", "references": [], "description": ""}, {"id": "d8fe5b8ba43e", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function _isApprovedOrOwner(address spender, uint256 tokenId) internal view virtual returns (bool) {", "highlightLines": [109]}, "category": "code", "location": {"file": "src/test/NFT-transfer.sol", "line": 109, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "1cdd2a90558d", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function _isApprovedOrOwner(address spender, uint256 tokenId) internal view virtual returns (bool) {\n        address owner = ERC721.ownerOf(tokenId);", "highlightLines": [109]}, "category": "code", "location": {"file": "src/test/NFT-transfer.sol", "line": 109, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "80299d42d788", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function _isApprovedOrOwner(address spender, uint256 tokenId) internal view virtual returns (bool) {\n        address owner = ERC721.ownerOf(tokenId);\n        return (spender == owner || isApprovedForAll(owner, spender) || getApproved(tokenId) == spender);", "highlightLines": [109]}, "category": "code", "location": {"file": "src/test/NFT-transfer.sol", "line": 109, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "0f8be3178935", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address owner = ERC721.ownerOf(tokenId);", "highlightLines": [110]}, "category": "code", "location": {"file": "src/test/NFT-transfer.sol", "line": 110, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "826be7dc95a6", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "        address owner = ERC721.ownerOf(tokenId);", "highlightLines": [110]}, "category": "code", "location": {"file": "src/test/NFT-transfer.sol", "line": 110, "column": 9}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "757364b3e0cf", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.18;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/NFTMint_exposedMetadata.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "cc2e8d48cfc3", "fix": {"template": null, "available": false}, "title": "Potential mnemonic seed phrase detected - CRITICAL if real", "ruleId": "rules._shared.shared-mnemonic-phrase", "snippet": {"code": "As a result, attacker can find out valuable NFTs and then target mint of specific NFTs by monitoring mempool \nand sell the NFTs for a profit in secondary market.", "highlightLines": [12]}, "category": "code", "location": {"file": "src/test/NFTMint_exposedMetadata.sol", "line": 12, "column": 40}, "severity": "high", "references": [], "description": ""}, {"id": "b70c86c1d28f", "fix": {"template": null, "available": false}, "title": "Potential mnemonic seed phrase detected - CRITICAL if real", "ruleId": "rules._shared.shared-mnemonic-phrase", "snippet": {"code": "        //As a result, attacker can find out valuable NFTs and then target mint specified NFTs by monitoring Mempool and sell the NFTs for a profit in secondary market", "highlightLines": [38]}, "category": "code", "location": {"file": "src/test/NFTMint_exposedMetadata.sol", "line": 38, "column": 50}, "severity": "high", "references": [], "description": ""}, {"id": "79c0d765adbd", "fix": {"template": null, "available": false}, "title": "HTTP NFT metadata URL with token ID - vulnerable to metadata sniping (CVE-2022-38217)", "ruleId": "rules.sol-nft-http-metadata-exposed", "snippet": {"code": "        //View Metadata of the NFTs via cURL -> curl -k https://bafybeic23x4v75z7isyqhy5p6ylzqutm6lnpobwngaouovdu6qjjvt4wpu.ipfs.dweb.link/142.json", "highlightLines": [41]}, "category": "code", "location": {"file": "src/test/NFTMint_exposedMetadata.sol", "line": 41, "column": 57}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/NFTMint_exposedMetadata.sol"], "description": ""}, {"id": "6ad429b4ec02", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "        //etherscan tx - 0xfa4434236d2a9717e3410d7cdc60eed6acfddb054f58bc779c07349a1f45ce6b", "highlightLines": [44]}, "category": "code", "location": {"file": "src/test/NFTMint_exposedMetadata.sol", "line": 44, "column": 26}, "severity": "high", "references": [], "description": ""}, {"id": "251c97e6128d", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "        //etherscan tx - 0x24af97355f6cec4ae02fff8bbf7144a02857e3ffd36a650aa295c62f6272cc83", "highlightLines": [45]}, "category": "code", "location": {"file": "src/test/NFTMint_exposedMetadata.sol", "line": 45, "column": 26}, "severity": "high", "references": [], "description": ""}, {"id": "33587a1f8d8c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        address attacker = 0x1fCebBb5D3EACd26e70b0BD1E54a979a479906aA;", "highlightLines": [46]}, "category": "code", "location": {"file": "src/test/NFTMint_exposedMetadata.sol", "line": 46, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7f9c630a87ef", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "            0x0ea49bae9ab4f8b82fb0e0b5e876576c9a4a945edc2fa5a7b448fad470802ae6", "highlightLines": [51]}, "category": "code", "location": {"file": "src/test/NFTMint_exposedMetadata.sol", "line": 51, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "fdbe5b21aeb9", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "            0x852233af3700b87dc51f6abf53d4f935746d746d84a33d4d7e6302d9c110fedd", "highlightLines": [54]}, "category": "code", "location": {"file": "src/test/NFTMint_exposedMetadata.sol", "line": 54, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "559604657f3a", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "            0x5de513269badb3a0b73e237a9f28f86994791f4421effd1865df975a0f8ee52c", "highlightLines": [57]}, "category": "code", "location": {"file": "src/test/NFTMint_exposedMetadata.sol", "line": 57, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "5e0339a2b984", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "            0xe52d780f15394a8f6254f328ca06a66909c41f1ee3adab33d02cd087f8c37604", "highlightLines": [60]}, "category": "code", "location": {"file": "src/test/NFTMint_exposedMetadata.sol", "line": 60, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "8b77b6949d7b", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "            0xede88505e4259ab482a1019cc8d4364cf9e1e7866768245854c0f6e369d2b08c", "highlightLines": [63]}, "category": "code", "location": {"file": "src/test/NFTMint_exposedMetadata.sol", "line": 63, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "905954399ebe", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "            0x776fee48d9285a8e2d1ecde47354e9ebe91b10f0b5f2d754968af831a7047808", "highlightLines": [66]}, "category": "code", "location": {"file": "src/test/NFTMint_exposedMetadata.sol", "line": 66, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "18acb44ed2dc", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "            0x3d13c4757d9e35123b8785040c29f232483941fb7d591b1a94167c1ca5e8875f", "highlightLines": [69]}, "category": "code", "location": {"file": "src/test/NFTMint_exposedMetadata.sol", "line": 69, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "1e766c54eb39", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "            0xc36c091c358833709f1b6f44e783e5d9ad5ad9f5f0ee09a37c376fd354827fb1", "highlightLines": [72]}, "category": "code", "location": {"file": "src/test/NFTMint_exposedMetadata.sol", "line": 72, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "16a4df3b5918", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "            0xce26991b2af9fc0fb807aea36667d37439ae7122d3ea8edcbfe92b04bf674922", "highlightLines": [75]}, "category": "code", "location": {"file": "src/test/NFTMint_exposedMetadata.sol", "line": 75, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "8e6b93f38808", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "            0x8452c207732923a758c53fb296f3d88340a04fe9c381c73ba44343a45340953e", "highlightLines": [78]}, "category": "code", "location": {"file": "src/test/NFTMint_exposedMetadata.sol", "line": 78, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "aede310aa7c8", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "            0xcc44822b3b5a19839899f6795622daff3bab327895558977ea58a30a42c6a49e", "highlightLines": [81]}, "category": "code", "location": {"file": "src/test/NFTMint_exposedMetadata.sol", "line": 81, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "b821426f7930", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "            0x45c575962e5a88b5e8c3aedf4e3e74306d0124f4cc86c25bc4cd1bcae16c54a0", "highlightLines": [84]}, "category": "code", "location": {"file": "src/test/NFTMint_exposedMetadata.sol", "line": 84, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "49b62945ad2b", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.18;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/Oracle-stale.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "b5cdfc42798f", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "        //Chainlink oracle data feed is not sufficiently validated and can return stale price.\n        (, int256 answer, , , ) = priceFeed.latestRoundData();\n        emit log_named_decimal_int(\"price\", answer, 8);", "highlightLines": [36]}, "category": "code", "location": {"file": "src/test/Oracle-stale.sol", "line": 36, "column": 76}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "aee6e89a582f", "fix": {"template": null, "available": false}, "title": "Chainlink latestRoundData() without staleness check - stale prices can be exploited", "ruleId": "rules.sol-chainlink-stale-price", "snippet": {"code": "        (, int256 answer, , , ) = priceFeed.latestRoundData();", "highlightLines": [37]}, "category": "code", "location": {"file": "src/test/Oracle-stale.sol", "line": 37, "column": 35}, "severity": "high", "references": ["https://docs.chain.link/data-feeds/price-feeds"], "description": ""}, {"id": "574c7f520ae0", "fix": {"template": null, "available": false}, "title": "L2 oracle without sequencer uptime check - prices may be stale after sequencer downtime", "ruleId": "rules.sol-oracle-no-sequencer-check", "snippet": {"code": "        (, int256 answer, , , ) = priceFeed.latestRoundData();", "highlightLines": [37]}, "category": "code", "location": {"file": "src/test/Oracle-stale.sol", "line": 37, "column": 45}, "severity": "medium", "references": [], "description": ""}, {"id": "1b1a12216a11", "fix": {"template": null, "available": false}, "title": "Chainlink oracle without staleness check - stale prices can cause liquidations", "ruleId": "rules.sol-chainlink-stale-price", "snippet": {"code": "        (, int256 answer, , , ) = priceFeed.latestRoundData();", "highlightLines": [37]}, "category": "code", "location": {"file": "src/test/Oracle-stale.sol", "line": 37, "column": 45}, "severity": "high", "references": [], "description": ""}, {"id": "f08b0647c419", "fix": {"template": null, "available": false}, "title": "Chainlink latestRoundData() without staleness check - stale prices can be exploited", "ruleId": "rules.sol-chainlink-stale-price", "snippet": {"code": "        ) = priceFeed.latestRoundData();", "highlightLines": [48]}, "category": "code", "location": {"file": "src/test/Oracle-stale.sol", "line": 48, "column": 13}, "severity": "high", "references": ["https://docs.chain.link/data-feeds/price-feeds"], "description": ""}, {"id": "c1af87715d82", "fix": {"template": null, "available": false}, "title": "L2 oracle without sequencer uptime check - prices may be stale after sequencer downtime", "ruleId": "rules.sol-oracle-no-sequencer-check", "snippet": {"code": "        ) = priceFeed.latestRoundData();", "highlightLines": [48]}, "category": "code", "location": {"file": "src/test/Oracle-stale.sol", "line": 48, "column": 23}, "severity": "medium", "references": [], "description": ""}, {"id": "276d306b2180", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    receive() external payable {}", "highlightLines": [61]}, "category": "code", "location": {"file": "src/test/Oracle-stale.sol", "line": 61, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "c1914164e6a4", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "    receive() external payable {}", "highlightLines": [61]}, "category": "code", "location": {"file": "src/test/Oracle-stale.sol", "line": 61, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "d285030f03f0", "fix": {"template": null, "available": false}, "title": "L2 oracle without sequencer uptime check - prices may be stale after sequencer downtime", "ruleId": "rules.sol-oracle-no-sequencer-check", "snippet": {"code": "    function latestRoundData()", "highlightLines": [65]}, "category": "code", "location": {"file": "src/test/Oracle-stale.sol", "line": 65, "column": 14}, "severity": "medium", "references": [], "description": ""}, {"id": "d89683d8e5f9", "fix": {"template": null, "available": false}, "title": "Chainlink oracle without staleness check - stale prices can cause liquidations", "ruleId": "rules.sol-chainlink-stale-price", "snippet": {"code": "    function latestRoundData()\n        external\n        view\n        returns (\n            uint80 roundId,\n            int256 answer,\n            uint256 startedAt,\n            uint256 updatedAt,\n            uint80 answeredInRound\n        );", "highlightLines": [65]}, "category": "code", "location": {"file": "src/test/Oracle-stale.sol", "line": 65, "column": 14}, "severity": "high", "references": [], "description": ""}, {"id": "6147db9f666c", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.7.6;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/Overflow.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "1a64321c5f2d", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function deposit() external payable {", "highlightLines": [43]}, "category": "code", "location": {"file": "src/test/Overflow.sol", "line": 43, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "905e802c252f", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        lockTime[msg.sender] = block.timestamp + 1 weeks;", "highlightLines": [45]}, "category": "code", "location": {"file": "src/test/Overflow.sol", "line": 45, "column": 32}, "severity": "medium", "references": [], "description": ""}, {"id": "1a6d5c76ab20", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function withdraw() public {", "highlightLines": [52]}, "category": "code", "location": {"file": "src/test/Overflow.sol", "line": 52, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "4b5b11a3616d", "fix": {"template": null, "available": false}, "title": "require() in withdrawal path - griefing possible if condition can be manipulated", "ruleId": "rules.sol-force-revert-griefing", "snippet": {"code": "    function withdraw() public {\n        require(balances[msg.sender] > 0, \"Insufficient funds\");", "highlightLines": [52]}, "category": "code", "location": {"file": "src/test/Overflow.sol", "line": 52, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "cddc48b0caba", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "            block.timestamp > lockTime[msg.sender],", "highlightLines": [55]}, "category": "code", "location": {"file": "src/test/Overflow.sol", "line": 55, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "1a7542a0bc29", "fix": {"template": null, "available": false}, "title": "Block timestamp used for critical logic - miners can manipulate within ~15 second window", "ruleId": "rules.sol-block-timestamp-manipulation", "snippet": {"code": "            block.timestamp > lockTime[msg.sender],", "highlightLines": [55]}, "category": "code", "location": {"file": "src/test/Overflow.sol", "line": 55, "column": 13}, "severity": "medium", "references": ["https://consensys.github.io/smart-contract-best-practices/development-recommendations/solidity-specific/timestamp-dependence/"], "description": ""}, {"id": "e1b3761df007", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint amount = balances[msg.sender];", "highlightLines": [58]}, "category": "code", "location": {"file": "src/test/Overflow.sol", "line": 58, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "aaa188248036", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint amount = balances[msg.sender];\n        balances[msg.sender] = 0;", "highlightLines": [59]}, "category": "code", "location": {"file": "src/test/Overflow.sol", "line": 59, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "bbb472dabe5e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        balances[msg.sender] = 0;\n\n        (bool sent, ) = msg.sender.call{value: amount}(\"\");", "highlightLines": [60]}, "category": "code", "location": {"file": "src/test/Overflow.sol", "line": 60, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "000cba12b6d7", "fix": {"template": null, "available": false}, "title": "Low-level call without checking return value - silent failure possible", "ruleId": "rules.sol-unchecked-call-return", "snippet": {"code": "        (bool sent, ) = msg.sender.call{value: amount}(\"\");", "highlightLines": [62]}, "category": "code", "location": {"file": "src/test/Overflow.sol", "line": 62, "column": 35}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-104/", "https://blocksecteam.medium.com/li-fi-attack"], "description": ""}, {"id": "240dfa31e2a7", "fix": {"template": null, "available": false}, "title": "State change after external call - potential reentrancy vulnerability", "ruleId": "rules.sol-external-call-state-change", "snippet": {"code": "        (bool sent, ) = msg.sender.call{value: amount}(\"\");\n        require(sent, \"Failed to send Ether\");\n    }\n}\n\ncontract ContractTest is Test {\n    TimeLock TimeLockContract;\n    address alice;\n    address bob;\n\n    function setUp() public {\n        TimeLockContract = new TimeLock();", "highlightLines": [62]}, "category": "code", "location": {"file": "src/test/Overflow.sol", "line": 62, "column": 35}, "severity": "high", "references": ["https://consensys.github.io/smart-contract-best-practices/attacks/reentrancy/"], "description": ""}, {"id": "8cfc9c8ca066", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract ContractTest is Test {\n    TimeLock TimeLockContract;\n    address alice;\n    address bob;", "highlightLines": [67]}, "category": "code", "location": {"file": "src/test/Overflow.sol", "line": 67, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "086007fa9caa", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address alice;", "highlightLines": [69]}, "category": "code", "location": {"file": "src/test/Overflow.sol", "line": 69, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d1493bb1d85b", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address bob;", "highlightLines": [70]}, "category": "code", "location": {"file": "src/test/Overflow.sol", "line": 70, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4fe07ba053f0", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        TimeLockContract = new TimeLock();\n        alice = vm.addr(1);", "highlightLines": [73]}, "category": "code", "location": {"file": "src/test/Overflow.sol", "line": 73, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "b97ce9d46c83", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        TimeLockContract = new TimeLock();", "highlightLines": [73]}, "category": "code", "location": {"file": "src/test/Overflow.sol", "line": 73, "column": 28}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "af7efb5070a0", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "        alice = vm.addr(1);\n        bob = vm.addr(2);", "highlightLines": [74]}, "category": "code", "location": {"file": "src/test/Overflow.sol", "line": 74, "column": 9}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "b1e7332b11fe", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        alice = vm.addr(1);\n        bob = vm.addr(2);", "highlightLines": [74]}, "category": "code", "location": {"file": "src/test/Overflow.sol", "line": 74, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "87b2f1e185e2", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.7.6;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/Overflow2.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "f97cde3cea64", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract ContractTest is Test {\n    TokenWhaleChallenge TokenWhaleChallengeContract;\n\n    function testOverflow2() public {\n        address alice = vm.addr(1);\n        address bob = vm.addr(2);", "highlightLines": [40]}, "category": "code", "location": {"file": "src/test/Overflow2.sol", "line": 40, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "950db622c8bb", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address alice = vm.addr(1);", "highlightLines": [44]}, "category": "code", "location": {"file": "src/test/Overflow2.sol", "line": 44, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "22c163d7232f", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "        address alice = vm.addr(1);\n        address bob = vm.addr(2);", "highlightLines": [44]}, "category": "code", "location": {"file": "src/test/Overflow2.sol", "line": 44, "column": 9}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "d109b7b9424c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address alice = vm.addr(1);\n        address bob = vm.addr(2);", "highlightLines": [44]}, "category": "code", "location": {"file": "src/test/Overflow2.sol", "line": 44, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "a3a8c3827731", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address bob = vm.addr(2);", "highlightLines": [45]}, "category": "code", "location": {"file": "src/test/Overflow2.sol", "line": 45, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0c841e894895", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address bob = vm.addr(2);\n\n        TokenWhaleChallengeContract = new TokenWhaleChallenge();", "highlightLines": [45]}, "category": "code", "location": {"file": "src/test/Overflow2.sol", "line": 45, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e6dc6435331c", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        TokenWhaleChallengeContract = new TokenWhaleChallenge();", "highlightLines": [47]}, "category": "code", "location": {"file": "src/test/Overflow2.sol", "line": 47, "column": 39}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "e24d1eedaeb1", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        TokenWhaleChallengeContract.transfer(address(alice), 800);", "highlightLines": [53]}, "category": "code", "location": {"file": "src/test/Overflow2.sol", "line": 53, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "06b895cfbba6", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "        TokenWhaleChallengeContract.transfer(address(alice), 800);", "highlightLines": [53]}, "category": "code", "location": {"file": "src/test/Overflow2.sol", "line": 53, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "b1bd1dfedf09", "fix": {"template": null, "available": false}, "title": "ERC20 transfer() return value not checked - tokens like USDT don't return bool", "ruleId": "rules.sol-erc20-transfer-no-return-check", "snippet": {"code": "        TokenWhaleChallengeContract.transfer(address(alice), 800);", "highlightLines": [53]}, "category": "code", "location": {"file": "src/test/Overflow2.sol", "line": 53, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "97759031e12c", "fix": {"template": null, "available": false}, "title": "Token transfer without checking actual received amount - deflationary tokens may transfer less", "ruleId": "rules.sol-deflationary-token-transfer", "snippet": {"code": "        TokenWhaleChallengeContract.transferFrom(\n            address(alice),\n            address(bob),\n            500\n        ); //exploit here", "highlightLines": [57]}, "category": "code", "location": {"file": "src/test/Overflow2.sol", "line": 57, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "5426230cf733", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        TokenWhaleChallengeContract.transferFrom(\n            address(alice),\n            address(bob),\n            500\n        ); //exploit here", "highlightLines": [57]}, "category": "code", "location": {"file": "src/test/Overflow2.sol", "line": 57, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "9581dd7c7142", "fix": {"template": null, "available": false}, "title": "Token amount after transfer may differ - check actual received amount", "ruleId": "rules.sol-fee-on-transfer-token", "snippet": {"code": "        TokenWhaleChallengeContract.transferFrom(\n            address(alice),\n            address(bob),\n            500\n        ); //exploit here", "highlightLines": [57]}, "category": "code", "location": {"file": "src/test/Overflow2.sol", "line": 57, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "29a713978642", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    receive() external payable {}", "highlightLines": [70]}, "category": "code", "location": {"file": "src/test/Overflow2.sol", "line": 70, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "5871ea017c34", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "    receive() external payable {}", "highlightLines": [70]}, "category": "code", "location": {"file": "src/test/Overflow2.sol", "line": 70, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "7325f8eb845e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address player;", "highlightLines": [74]}, "category": "code", "location": {"file": "src/test/Overflow2.sol", "line": 74, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b46813a701d3", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        player = _player;\n        totalSupply = 1000;", "highlightLines": [85]}, "category": "code", "location": {"file": "src/test/Overflow2.sol", "line": 85, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "57cd5795efe6", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        totalSupply = 1000;\n        balanceOf[player] = 1000;", "highlightLines": [86]}, "category": "code", "location": {"file": "src/test/Overflow2.sol", "line": 86, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "5fc810b26154", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Transfer(address indexed from, address indexed to, uint256 value);", "highlightLines": [94]}, "category": "code", "location": {"file": "src/test/Overflow2.sol", "line": 94, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "5390acee7af9", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function transfer(address to, uint256 value) public {", "highlightLines": [103]}, "category": "code", "location": {"file": "src/test/Overflow2.sol", "line": 103, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "1391c7141d45", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without msg.data.length validation - vulnerable to short address attack padding", "ruleId": "rules.sol-short-address-no-payload-check", "snippet": {"code": "    function transfer(address to, uint256 value) public {", "highlightLines": [103]}, "category": "code", "location": {"file": "src/test/Overflow2.sol", "line": 103, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address", "https://vessenes.com/the-erc20-short-address-attack-explained/"], "description": ""}, {"id": "e91fed285b27", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(balanceOf[msg.sender] >= value);", "highlightLines": [104]}, "category": "code", "location": {"file": "src/test/Overflow2.sol", "line": 104, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "cc22d279fd5e", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(balanceOf[to] + value >= balanceOf[to]);", "highlightLines": [105]}, "category": "code", "location": {"file": "src/test/Overflow2.sol", "line": 105, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "4ff01230ab86", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event Approval(\n        address indexed owner,\n        address indexed spender,\n        uint256 value\n    );", "highlightLines": [110]}, "category": "code", "location": {"file": "src/test/Overflow2.sol", "line": 110, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "2a46c95a7a31", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Approval(\n        address indexed owner,\n        address indexed spender,\n        uint256 value\n    );", "highlightLines": [110]}, "category": "code", "location": {"file": "src/test/Overflow2.sol", "line": 110, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "bb901f89e097", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function approve(address spender, uint256 value) public {", "highlightLines": [116]}, "category": "code", "location": {"file": "src/test/Overflow2.sol", "line": 116, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "d3aaf7be785f", "fix": {"template": null, "available": false}, "title": "ERC20 transferFrom without payload size validation - consider adding onlyPayloadSize modifier", "ruleId": "rules.sol-erc20-missing-payload-modifier", "snippet": {"code": "    function transferFrom(address from, address to, uint256 value) public {", "highlightLines": [121]}, "category": "code", "location": {"file": "src/test/Overflow2.sol", "line": 121, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address"], "description": ""}, {"id": "df0b8eec267c", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function transferFrom(address from, address to, uint256 value) public {", "highlightLines": [121]}, "category": "code", "location": {"file": "src/test/Overflow2.sol", "line": 121, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "f0520af7037d", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(balanceOf[from] >= value);", "highlightLines": [122]}, "category": "code", "location": {"file": "src/test/Overflow2.sol", "line": 122, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "ffa376f89dfc", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(balanceOf[to] + value >= balanceOf[to]);", "highlightLines": [123]}, "category": "code", "location": {"file": "src/test/Overflow2.sol", "line": 123, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "726407f57535", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(allowance[from][msg.sender] >= value);", "highlightLines": [124]}, "category": "code", "location": {"file": "src/test/Overflow2.sol", "line": 124, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "0f060987157b", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.18;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/Precision-loss.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "13822931bcf3", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        SimplePoolContract = new SimplePool();", "highlightLines": [32]}, "category": "code", "location": {"file": "src/test/Precision-loss.sol", "line": 32, "column": 30}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "66cc75f67956", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    receive() external payable {}", "highlightLines": [39]}, "category": "code", "location": {"file": "src/test/Precision-loss.sol", "line": 39, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "c11ca3e822f5", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "    receive() external payable {}", "highlightLines": [39]}, "category": "code", "location": {"file": "src/test/Precision-loss.sol", "line": 39, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "7941b68a8575", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor() {\n        totalDebt = 10000e6; //debt token is USDC and has 6 digit decimals.\n        lastAccrueInterestTime = block.timestamp - 1;\n        loanTokenBalance = 500e18;\n    }", "highlightLines": [47]}, "category": "code", "location": {"file": "src/test/Precision-loss.sol", "line": 47, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "aa9f3a27f5b0", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        totalDebt = 10000e6; //debt token is USDC and has 6 digit decimals.\n        lastAccrueInterestTime = block.timestamp - 1;", "highlightLines": [48]}, "category": "code", "location": {"file": "src/test/Precision-loss.sol", "line": 48, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "f9887631b1c0", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        lastAccrueInterestTime = block.timestamp - 1;\n        loanTokenBalance = 500e18;", "highlightLines": [49]}, "category": "code", "location": {"file": "src/test/Precision-loss.sol", "line": 49, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "1e9073dbae34", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        lastAccrueInterestTime = block.timestamp - 1;", "highlightLines": [49]}, "category": "code", "location": {"file": "src/test/Precision-loss.sol", "line": 49, "column": 34}, "severity": "medium", "references": [], "description": ""}, {"id": "6fb5b9b457ed", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function getCurrentReward() public view returns (uint _reward) {\n        // Get the time passed since the last interest accrual\n        uint _timeDelta = block.timestamp - lastAccrueInterestTime; //_timeDelta=1\n\n        // If the time passed is 0, return 0 reward\n        if (_timeDelta == 0) return 0;\n\n        // Calculate the supplied value\n        // uint _supplied = totalDebt + loanTokenBalance;\n        //console.log(_supplied);\n        // Calculate the reward\n        _reward = (totalDebt * _timeDelta) / (365 days * 1e18);\n        console.log(\"Current reward\", _reward);\n\n        // 31536000 is the number of seconds in a year\n        // 365 days * 1e18 = 31_536_000_000_000_000_000_000_000", "highlightLines": [53]}, "category": "code", "location": {"file": "src/test/Precision-loss.sol", "line": 53, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "14554dae08d3", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint _timeDelta = block.timestamp - lastAccrueInterestTime; //_timeDelta=1", "highlightLines": [55]}, "category": "code", "location": {"file": "src/test/Precision-loss.sol", "line": 55, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3f870047a5bb", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint _timeDelta = block.timestamp - lastAccrueInterestTime; //_timeDelta=1\n\n        // If the time passed is 0, return 0 reward\n        if (_timeDelta == 0) return 0;\n\n        // Calculate the supplied value\n        // uint _supplied = totalDebt + loanTokenBalance;\n        //console.log(_supplied);\n        // Calculate the reward\n        _reward = (totalDebt * _timeDelta) / (365 days * 1e18);", "highlightLines": [55]}, "category": "code", "location": {"file": "src/test/Precision-loss.sol", "line": 55, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "bfd5b684bd83", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        uint _timeDelta = block.timestamp - lastAccrueInterestTime; //_timeDelta=1", "highlightLines": [55]}, "category": "code", "location": {"file": "src/test/Precision-loss.sol", "line": 55, "column": 27}, "severity": "medium", "references": [], "description": ""}, {"id": "e0c32feb4b36", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimal assumption - tokens with >18 or <18 decimals will cause overflow/underflow", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        _reward = (totalDebt * _timeDelta) / (365 days * 1e18);", "highlightLines": [64]}, "category": "code", "location": {"file": "src/test/Precision-loss.sol", "line": 64, "column": 56}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20"], "description": ""}, {"id": "42b3f257c9c1", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        _reward = (totalDebt * _timeDelta) / (365 days * 1e18);", "highlightLines": [64]}, "category": "code", "location": {"file": "src/test/Precision-loss.sol", "line": 64, "column": 58}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "795f65509ab1", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimal assumption - tokens with >18 or <18 decimals will cause overflow/underflow", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        // 365 days * 1e18 = 31_536_000_000_000_000_000_000_000", "highlightLines": [68]}, "category": "code", "location": {"file": "src/test/Precision-loss.sol", "line": 68, "column": 21}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20"], "description": ""}, {"id": "7e5da35def95", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        // 365 days * 1e18 = 31_536_000_000_000_000_000_000_000", "highlightLines": [68]}, "category": "code", "location": {"file": "src/test/Precision-loss.sol", "line": 68, "column": 23}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "7aed243cac26", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _reward;", "highlightLines": [71]}, "category": "code", "location": {"file": "src/test/Precision-loss.sol", "line": 71, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "edff30edc901", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.18;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "04f7f790d5ee", "fix": {"template": null, "available": false}, "title": "Consider using Ownable2Step instead of Ownable for safer ownership transfers", "ruleId": "rules.sol-use-ownable2step", "snippet": {"code": "import \"@openzeppelin/contracts/access/Ownable.sol\";", "highlightLines": [6]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 6, "column": 1}, "severity": "info", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/access/Ownable2Step.sol"], "description": ""}, {"id": "983113d4c86d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        USDaContract = new USDa();\n        USDbContract = new USDb();", "highlightLines": [32]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 32, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "44d3c3ed4b3e", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        USDaContract = new USDa();", "highlightLines": [32]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 32, "column": 24}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "177727bb6c62", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        USDbContract = new USDb();\n        SimplePoolContract = new SimplePool(\n            address(USDaContract),\n            address(USDbContract)\n        );", "highlightLines": [33]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 33, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "acdc9f1dd206", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        USDbContract = new USDb();", "highlightLines": [33]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 33, "column": 24}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "084204db7706", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        SimplePoolContract = new SimplePool(\n            address(USDaContract),\n            address(USDbContract)\n        );\n        SimpleBankContract = new SimpleBank(\n            address(USDaContract),\n            address(SimplePoolContract),\n            address(USDbContract)\n        );", "highlightLines": [34]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 34, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d75efef8cb87", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        SimplePoolContract = new SimplePool(\n            address(USDaContract),\n            address(USDbContract)\n        );", "highlightLines": [34]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 34, "column": 30}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "e7c579b4b5da", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        SimpleBankContract = new SimpleBank(\n            address(USDaContract),\n            address(SimplePoolContract),\n            address(USDbContract)\n        );", "highlightLines": [38]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 38, "column": 30}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "2356b57a0b65", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        USDbContract.transfer(address(SimpleBankContract), 9000 ether);", "highlightLines": [46]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 46, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "b96457116e7b", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "        USDbContract.transfer(address(SimpleBankContract), 9000 ether);", "highlightLines": [46]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 46, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "6716e36d9b0e", "fix": {"template": null, "available": false}, "title": "ERC20 transfer() return value not checked - tokens like USDT don't return bool", "ruleId": "rules.sol-erc20-transfer-no-return-check", "snippet": {"code": "        USDbContract.transfer(address(SimpleBankContract), 9000 ether);", "highlightLines": [46]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 46, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "a62f39a19217", "fix": {"template": null, "available": false}, "title": "Event emitted after external call - reentrancy can cause events to be logged out of order", "ruleId": "rules.sol-event-after-external-call", "snippet": {"code": "        USDbContract.transfer(address(SimpleBankContract), 9000 ether);\n        USDaContract.transfer(address(SimplePoolContract), 1000 ether);\n        USDbContract.transfer(address(SimplePoolContract), 1000 ether);\n        // Get the current price of USDa in terms of USDb (initially 1 USDa : 1 USDb)\n        SimplePoolContract.getPrice(); // 1 USDa : 1 USDb\n\n        console.log(\n            \"There are 1000 USDa and USDb in the pool, so the price of USDa is 1 to 1 USDb.\"\n        );\n        emit log_named_decimal_uint(", "highlightLines": [46]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 46, "column": 21}, "severity": "info", "references": [], "description": ""}, {"id": "7461175cfeb7", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        USDaContract.transfer(address(SimplePoolContract), 1000 ether);", "highlightLines": [47]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 47, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "7054f55039c0", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "        USDaContract.transfer(address(SimplePoolContract), 1000 ether);", "highlightLines": [47]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 47, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "5e778bf337ea", "fix": {"template": null, "available": false}, "title": "ERC20 transfer() return value not checked - tokens like USDT don't return bool", "ruleId": "rules.sol-erc20-transfer-no-return-check", "snippet": {"code": "        USDaContract.transfer(address(SimplePoolContract), 1000 ether);", "highlightLines": [47]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 47, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "23b693056572", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        USDbContract.transfer(address(SimplePoolContract), 1000 ether);", "highlightLines": [48]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 48, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "38c62e4a0b95", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "        USDbContract.transfer(address(SimplePoolContract), 1000 ether);", "highlightLines": [48]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 48, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "dd4e840a7cb4", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        USDaContract.transfer(address(SimplePoolContract), 500 ether);", "highlightLines": [80]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 80, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "5c18892eb519", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "        USDaContract.transfer(address(SimplePoolContract), 500 ether);", "highlightLines": [80]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 80, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "953eec10cde2", "fix": {"template": null, "available": false}, "title": "Event emitted after external call - reentrancy can cause events to be logged out of order", "ruleId": "rules.sol-event-after-external-call", "snippet": {"code": "        USDaContract.transfer(address(SimplePoolContract), 500 ether);\n\n        // Get the balance of USDb owned by us.\n        emit log_named_decimal_uint(", "highlightLines": [80]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 80, "column": 21}, "severity": "info", "references": [], "description": ""}, {"id": "fbca629ec4a2", "fix": {"template": null, "available": false}, "title": "address(this) directly in emit - likely wrong address (should use token/handler variable)", "ruleId": "rules.sol-emit-address-this", "snippet": {"code": "        emit log_named_decimal_uint(\n            \"Use 100 USDa to convert, My USDb balance\",\n            USDbContract.balanceOf(address(this)),", "highlightLines": [83]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 83, "column": 9}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "4d7143d94f26", "fix": {"template": null, "available": false}, "title": "address(this) emitted in event - may emit wrong address (handler vs token confusion)", "ruleId": "rules.sol-address-this-in-event", "snippet": {"code": "        emit log_named_decimal_uint(\n            \"Use 100 USDa to convert, My USDb balance\",\n            USDbContract.balanceOf(address(this)),", "highlightLines": [83]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 83, "column": 9}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "d2ea9e96e15f", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    receive() external payable {}", "highlightLines": [90]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 90, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "075fd9dcd516", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "    receive() external payable {}", "highlightLines": [90]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 90, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "86169fa1bf48", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor() ERC20(\"USDA\", \"USDA\") {\n        _mint(msg.sender, 10000 * 10 ** decimals());\n    }", "highlightLines": [94]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 94, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "c5d77742a82c", "fix": {"template": null, "available": false}, "title": "NFT mint without supply check - potential overflow in tokenId", "ruleId": "rules.sol-nft-overflow-mint", "snippet": {"code": "        _mint(msg.sender, 10000 * 10 ** decimals());", "highlightLines": [95]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 95, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "38225d91ab3e", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function mint(address to, uint256 amount) public onlyOwner {", "highlightLines": [98]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 98, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "fb62a023ce57", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function mint(address to, uint256 amount) public onlyOwner {", "highlightLines": [98]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 98, "column": 54}, "severity": "info", "references": [], "description": ""}, {"id": "44ea28b9ae3d", "fix": {"template": null, "available": false}, "title": "Owner has excessive privileges - single account controls critical functions without checks", "ruleId": "rules.sol-owner-privilege-escalation", "snippet": {"code": "    function mint(address to, uint256 amount) public onlyOwner {\n        _mint(to, amount);", "highlightLines": [98]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 98, "column": 54}, "severity": "medium", "references": [], "description": ""}, {"id": "438f89a1c930", "fix": {"template": null, "available": false}, "title": "NFT mint without supply check - potential overflow in tokenId", "ruleId": "rules.sol-nft-overflow-mint", "snippet": {"code": "        _mint(to, amount);", "highlightLines": [99]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 99, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "9a560fad4145", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor() ERC20(\"USDB\", \"USDB\") {\n        _mint(msg.sender, 10000 * 10 ** decimals());\n    }", "highlightLines": [104]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 104, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "9c87b45a3420", "fix": {"template": null, "available": false}, "title": "NFT mint without supply check - potential overflow in tokenId", "ruleId": "rules.sol-nft-overflow-mint", "snippet": {"code": "        _mint(msg.sender, 10000 * 10 ** decimals());", "highlightLines": [105]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 105, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d7dc8c8a58d5", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function mint(address to, uint256 amount) public onlyOwner {", "highlightLines": [108]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 108, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "d217e383401a", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function mint(address to, uint256 amount) public onlyOwner {", "highlightLines": [108]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 108, "column": 54}, "severity": "info", "references": [], "description": ""}, {"id": "3e67710a0474", "fix": {"template": null, "available": false}, "title": "Owner has excessive privileges - single account controls critical functions without checks", "ruleId": "rules.sol-owner-privilege-escalation", "snippet": {"code": "    function mint(address to, uint256 amount) public onlyOwner {\n        _mint(to, amount);", "highlightLines": [108]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 108, "column": 54}, "severity": "medium", "references": [], "description": ""}, {"id": "4bdb9535ec31", "fix": {"template": null, "available": false}, "title": "NFT mint without supply check - potential overflow in tokenId", "ruleId": "rules.sol-nft-overflow-mint", "snippet": {"code": "        _mint(to, amount);", "highlightLines": [109]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 109, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e7ad8616c9db", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(address _USDa, address _USDb) {\n        USDaToken = IERC20(_USDa);\n        USDbToken = IERC20(_USDb);\n    }", "highlightLines": [117]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 117, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "0819c15b4f7d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        USDaToken = IERC20(_USDa);\n        USDbToken = IERC20(_USDb);", "highlightLines": [118]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 118, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "3c19c7cb890a", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function getPrice() public view returns (uint256) {\n        //Incorrect price calculation over balanceOf\n        uint256 USDaAmount = USDaToken.balanceOf(address(this));\n        uint256 USDbAmount = USDbToken.balanceOf(address(this));", "highlightLines": [122]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 122, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "6318cf43314b", "fix": {"template": null, "available": false}, "title": "View function reads state that may be stale during callback - read-only reentrancy risk", "ruleId": "rules.sol-read-only-reentrancy", "snippet": {"code": "    function getPrice() public view returns (uint256) {\n        //Incorrect price calculation over balanceOf\n        uint256 USDaAmount = USDaToken.balanceOf(address(this));\n        uint256 USDbAmount = USDbToken.balanceOf(address(this));", "highlightLines": [122]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 122, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs", "https://chainsecurity.com/curve-lp-oracle-manipulation-post-mortem/"], "description": ""}, {"id": "6f859e2329e8", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 USDaAmount = USDaToken.balanceOf(address(this));", "highlightLines": [124]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 124, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ead91b281cf5", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 USDaAmount = USDaToken.balanceOf(address(this));\n        uint256 USDbAmount = USDbToken.balanceOf(address(this));", "highlightLines": [124]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 124, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "025bfb743d2f", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 USDbAmount = USDbToken.balanceOf(address(this));", "highlightLines": [125]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 125, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3713094899a9", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 USDbAmount = USDbToken.balanceOf(address(this));\n\n        // Ensure USDbAmount is not zero to prevent division by zero\n        if (USDaAmount == 0) {\n            return 0;\n        }\n\n        // Calculate the price as the ratio of USDa to USDb\n        uint256 USDaPrice = (USDbAmount * (10 ** 18)) / USDaAmount;", "highlightLines": [125]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 125, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "19688dae6406", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 USDaPrice = (USDbAmount * (10 ** 18)) / USDaAmount;", "highlightLines": [133]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 133, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "78f1b6746a3b", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        uint256 USDaPrice = (USDbAmount * (10 ** 18)) / USDaAmount;", "highlightLines": [133]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 133, "column": 44}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "3040825c914f", "fix": {"template": null, "available": false}, "title": "Flash loan amount not validated against available liquidity", "ruleId": "rules.sol-flash-loan-amount-validation", "snippet": {"code": "    function flashLoan(\n        uint256 amount,\n        address borrower,\n        bytes calldata data\n    ) public {", "highlightLines": [137]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 137, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "c60f51abff5d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 balanceBefore = USDaToken.balanceOf(address(this));", "highlightLines": [142]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 142, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3c2f218ab132", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 balanceBefore = USDaToken.balanceOf(address(this));\n        require(balanceBefore >= amount, \"Not enough liquidity\");\n        require(\n            USDaToken.transfer(borrower, amount),\n            \"Flashloan transfer failed\"\n        );\n        (bool success, ) = borrower.call(data);", "highlightLines": [142]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 142, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "cfe16e202916", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "        uint256 balanceBefore = USDaToken.balanceOf(address(this));\n        require(balanceBefore >= amount, \"Not enough liquidity\");\n        require(\n            USDaToken.transfer(borrower, amount),\n            \"Flashloan transfer failed\"\n        );\n        (bool success, ) = borrower.call(data);\n        require(success, \"Flashloan callback failed\");\n        uint256 balanceAfter = USDaToken.balanceOf(address(this));", "highlightLines": [142]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 142, "column": 9}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "53fd52121fa8", "fix": {"template": null, "available": false}, "title": "Missing zero address validation - tokens/ETH could be lost", "ruleId": "rules.sol-missing-zero-address-check", "snippet": {"code": "            USDaToken.transfer(borrower, amount),", "highlightLines": [145]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 145, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "b70008ff69eb", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        (bool success, ) = borrower.call(data);\n        require(success, \"Flashloan callback failed\");\n        uint256 balanceAfter = USDaToken.balanceOf(address(this));", "highlightLines": [148]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 148, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "3842c5768a58", "fix": {"template": null, "available": false}, "title": "Arbitrary address with controlled calldata in low-level call - potential code injection", "ruleId": "rules.sol-arbitrary-low-level-call", "snippet": {"code": "        (bool success, ) = borrower.call(data);", "highlightLines": [148]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 148, "column": 28}, "severity": "high", "references": ["https://blocksecteam.medium.com/li-fi-attack-a-cross-chain-bridge-vulnerability-no-its-due-to-unchecked-external-call-c31e7dadf60f"], "description": ""}, {"id": "d2f71ae61ae6", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "        (bool success, ) = borrower.call(data);", "highlightLines": [148]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 148, "column": 28}, "severity": "medium", "references": [], "description": ""}, {"id": "2cbc242ec19a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 balanceAfter = USDaToken.balanceOf(address(this));", "highlightLines": [150]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 150, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8127cc143359", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(address _token, address _pool, address _payoutToken) {\n        token = IERC20(_token);\n        pool = SimplePool(_pool);\n        payoutToken = IERC20(_payoutToken);\n    }", "highlightLines": [160]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 160, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "938fb657004d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        token = IERC20(_token);\n        pool = SimplePool(_pool);", "highlightLines": [161]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 161, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "4224bcaff7db", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        pool = SimplePool(_pool);\n        payoutToken = IERC20(_payoutToken);", "highlightLines": [162]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 162, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "99cc61e3d817", "fix": {"template": null, "available": false}, "title": "Token swap/buy without slippage protection - MEV/sandwich attack risk", "ruleId": "rules.sol-missing-slippage-protection", "snippet": {"code": "    function exchange(uint256 amount) public {", "highlightLines": [166]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 166, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "baec54e1c167", "fix": {"template": null, "available": false}, "title": "Token transfer without checking actual received amount - deflationary tokens may transfer less", "ruleId": "rules.sol-deflationary-token-transfer", "snippet": {"code": "            token.transferFrom(msg.sender, address(this), amount),", "highlightLines": [168]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 168, "column": 13}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "7797753c1e74", "fix": {"template": null, "available": false}, "title": "Token amount after transfer may differ - check actual received amount", "ruleId": "rules.sol-fee-on-transfer-token", "snippet": {"code": "            token.transferFrom(msg.sender, address(this), amount),", "highlightLines": [168]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 168, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "d9118ca0b96d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 price = pool.getPrice();", "highlightLines": [171]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 171, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "57500c4c1d08", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 price = pool.getPrice();\n        require(price > 0, \"Price cannot be zero\");\n        uint256 tokensToReceive = (amount * price) / (10 ** 18);", "highlightLines": [171]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 171, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "58e73c4d9e66", "fix": {"template": null, "available": false}, "title": "Using AMM spot price without TWAP - vulnerable to flash loan price manipulation", "ruleId": "rules.sol-amm-price-oracle-single-block", "snippet": {"code": "        uint256 price = pool.getPrice();", "highlightLines": [171]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 171, "column": 25}, "severity": "high", "references": [], "description": ""}, {"id": "dcfb1538d132", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 tokensToReceive = (amount * price) / (10 ** 18);", "highlightLines": [173]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 173, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "bbfbb2b41ea4", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        uint256 tokensToReceive = (amount * price) / (10 ** 18);", "highlightLines": [173]}, "category": "code", "location": {"file": "src/test/Price_manipulation.sol", "line": 173, "column": 55}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "35868b3bfbb8", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.18;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/Privatedata.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "83f6f7cdb4c1", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract ContractTest is Test {\n    Vault VaultContract;\n\n    function testReadprivatedata() public {\n        VaultContract = new Vault(123456789);\n        bytes32 leet = vm.load(address(VaultContract), bytes32(uint256(0)));\n        console.log(uint256(leet));\n\n        // users in slot 1 - length of array\n        // starting from slot hash(1) - array elements\n        // slot where array element is stored = keccak256(slot)) + (index * elementSize)\n        // where slot = 1 and elementSize = 2 (1 (uint) +  1 (bytes32))\n        bytes32 user = vm.load(", "highlightLines": [21]}, "category": "code", "location": {"file": "src/test/Privatedata.sol", "line": 21, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "5d50d7d93b32", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        VaultContract = new Vault(123456789);\n        bytes32 leet = vm.load(address(VaultContract), bytes32(uint256(0)));", "highlightLines": [25]}, "category": "code", "location": {"file": "src/test/Privatedata.sol", "line": 25, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "29124c0f68a5", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        VaultContract = new Vault(123456789);", "highlightLines": [25]}, "category": "code", "location": {"file": "src/test/Privatedata.sol", "line": 25, "column": 25}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "3e9cb084fbb7", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 leet = vm.load(address(VaultContract), bytes32(uint256(0)));", "highlightLines": [26]}, "category": "code", "location": {"file": "src/test/Privatedata.sol", "line": 26, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "2b10c89f256f", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "        bytes32 leet = vm.load(address(VaultContract), bytes32(uint256(0)));\n        console.log(uint256(leet));\n\n        // users in slot 1 - length of array\n        // starting from slot hash(1) - array elements\n        // slot where array element is stored = keccak256(slot)) + (index * elementSize)\n        // where slot = 1 and elementSize = 2 (1 (uint) +  1 (bytes32))\n        bytes32 user = vm.load(\n            address(VaultContract),\n            VaultContract.getArrayLocation(1, 1, 1)\n        );", "highlightLines": [26]}, "category": "code", "location": {"file": "src/test/Privatedata.sol", "line": 26, "column": 9}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "dee1ad37ab72", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes32 leet = vm.load(address(VaultContract), bytes32(uint256(0)));\n        console.log(uint256(leet));\n\n        // users in slot 1 - length of array\n        // starting from slot hash(1) - array elements\n        // slot where array element is stored = keccak256(slot)) + (index * elementSize)\n        // where slot = 1 and elementSize = 2 (1 (uint) +  1 (bytes32))\n        bytes32 user = vm.load(\n            address(VaultContract),\n            VaultContract.getArrayLocation(1, 1, 1)\n        );", "highlightLines": [26]}, "category": "code", "location": {"file": "src/test/Privatedata.sol", "line": 26, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "697ec5a11ab7", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 user = vm.load(", "highlightLines": [33]}, "category": "code", "location": {"file": "src/test/Privatedata.sol", "line": 33, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c01beddeda15", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(uint256 _password) {\n        password = _password;\n        User memory user = User({id: 0, password: bytes32(_password)});\n        users.push(user);\n        idToUser[0] = user;\n    }", "highlightLines": [45]}, "category": "code", "location": {"file": "src/test/Privatedata.sol", "line": 45, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "8209d251c247", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        password = _password;\n        User memory user = User({id: 0, password: bytes32(_password)});", "highlightLines": [46]}, "category": "code", "location": {"file": "src/test/Privatedata.sol", "line": 46, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "a27df2df6a76", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        User memory user = User({id: 0, password: bytes32(_password)});\n        users.push(user);\n        idToUser[0] = user;", "highlightLines": [47]}, "category": "code", "location": {"file": "src/test/Privatedata.sol", "line": 47, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "ab8363f7121f", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint id;", "highlightLines": [53]}, "category": "code", "location": {"file": "src/test/Privatedata.sol", "line": 53, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "6048f96b8fe4", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 password;", "highlightLines": [54]}, "category": "code", "location": {"file": "src/test/Privatedata.sol", "line": 54, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "bf7556715a7d", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function getArrayLocation(\n        uint slot,\n        uint index,\n        uint elementSize\n    ) public pure returns (bytes32) {\n        uint256 a = uint(keccak256(abi.encodePacked(slot))) +", "highlightLines": [62]}, "category": "code", "location": {"file": "src/test/Privatedata.sol", "line": 62, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "83903426b869", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 a = uint(keccak256(abi.encodePacked(slot))) +", "highlightLines": [67]}, "category": "code", "location": {"file": "src/test/Privatedata.sol", "line": 67, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "86d763ef7d9b", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "        uint256 a = uint(keccak256(abi.encodePacked(slot))) +", "highlightLines": [67]}, "category": "code", "location": {"file": "src/test/Privatedata.sol", "line": 67, "column": 21}, "severity": "info", "references": [], "description": ""}, {"id": "ec0bfff0530f", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        uint256 a = uint(keccak256(abi.encodePacked(slot))) +", "highlightLines": [67]}, "category": "code", "location": {"file": "src/test/Privatedata.sol", "line": 67, "column": 26}, "severity": "high", "references": [], "description": ""}, {"id": "8e61894c209e", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.18;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/Randomness.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "d927fda4a406", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract ContractTest is Test {\n    GuessTheRandomNumber GuessTheRandomNumberContract;\n    Attack AttackerContract;\n\n    function testRandomness() public {\n        address alice = vm.addr(1);\n        address eve = vm.addr(2);", "highlightLines": [35]}, "category": "code", "location": {"file": "src/test/Randomness.sol", "line": 35, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "0f0c56675c3b", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address alice = vm.addr(1);", "highlightLines": [40]}, "category": "code", "location": {"file": "src/test/Randomness.sol", "line": 40, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "1249db27a188", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "        address alice = vm.addr(1);\n        address eve = vm.addr(2);", "highlightLines": [40]}, "category": "code", "location": {"file": "src/test/Randomness.sol", "line": 40, "column": 9}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "d7c8354f3cf4", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address alice = vm.addr(1);\n        address eve = vm.addr(2);", "highlightLines": [40]}, "category": "code", "location": {"file": "src/test/Randomness.sol", "line": 40, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "b6691705e77c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address eve = vm.addr(2);", "highlightLines": [41]}, "category": "code", "location": {"file": "src/test/Randomness.sol", "line": 41, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "01397b741e7a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address eve = vm.addr(2);\n        vm.deal(address(alice), 1 ether);\n        vm.prank(alice);\n\n        GuessTheRandomNumberContract = new GuessTheRandomNumber{\n            value: 1 ether\n        }();", "highlightLines": [41]}, "category": "code", "location": {"file": "src/test/Randomness.sol", "line": 41, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "da49c826a8a2", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        GuessTheRandomNumberContract = new GuessTheRandomNumber{\n            value: 1 ether\n        }();\n        vm.startPrank(eve);\n        AttackerContract = new Attack();", "highlightLines": [45]}, "category": "code", "location": {"file": "src/test/Randomness.sol", "line": 45, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "0ed79a0366fd", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        AttackerContract = new Attack();", "highlightLines": [49]}, "category": "code", "location": {"file": "src/test/Randomness.sol", "line": 49, "column": 28}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "359e277c0a7f", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    receive() external payable {}", "highlightLines": [62]}, "category": "code", "location": {"file": "src/test/Randomness.sol", "line": 62, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "280f0d5ba1cc", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "    receive() external payable {}", "highlightLines": [62]}, "category": "code", "location": {"file": "src/test/Randomness.sol", "line": 62, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "c1105d8ff47c", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor() payable {}", "highlightLines": [66]}, "category": "code", "location": {"file": "src/test/Randomness.sol", "line": 66, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "79bf4d789e10", "fix": {"template": null, "available": false}, "title": "Empty constructor or constructor with no effect - may indicate incomplete implementation", "ruleId": "rules.sol-void-constructor", "snippet": {"code": "    constructor() payable {}", "highlightLines": [66]}, "category": "code", "location": {"file": "src/test/Randomness.sol", "line": 66, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "b4f540c498b2", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function guess(uint _guess) public {\n        uint answer = uint(\n            keccak256(\n                abi.encodePacked(blockhash(block.number - 1), block.timestamp)\n            )\n        );\n\n        if (_guess == answer) {", "highlightLines": [68]}, "category": "code", "location": {"file": "src/test/Randomness.sol", "line": 68, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "786704ed4c68", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint answer = uint(", "highlightLines": [69]}, "category": "code", "location": {"file": "src/test/Randomness.sol", "line": 69, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b69e17efc302", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint answer = uint(\n            keccak256(\n                abi.encodePacked(blockhash(block.number - 1), block.timestamp)\n            )\n        );\n\n        if (_guess == answer) {\n            (bool sent, ) = msg.sender.call{value: 1 ether}(\"\");\n            require(sent, \"Failed to send Ether\");\n        }", "highlightLines": [69]}, "category": "code", "location": {"file": "src/test/Randomness.sol", "line": 69, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "08721e3936c7", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "        uint answer = uint(\n            keccak256(\n                abi.encodePacked(blockhash(block.number - 1), block.timestamp)\n            )", "highlightLines": [69]}, "category": "code", "location": {"file": "src/test/Randomness.sol", "line": 69, "column": 23}, "severity": "info", "references": [], "description": ""}, {"id": "dff4df7f66f4", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "            keccak256(\n                abi.encodePacked(blockhash(block.number - 1), block.timestamp)\n            )", "highlightLines": [70]}, "category": "code", "location": {"file": "src/test/Randomness.sol", "line": 70, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "df2c08591fbf", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "                abi.encodePacked(blockhash(block.number - 1), block.timestamp)", "highlightLines": [71]}, "category": "code", "location": {"file": "src/test/Randomness.sol", "line": 71, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "df40b010eae9", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - predictable by miners, 0 after 256 blocks", "ruleId": "rules.sol-blockhash-randomness", "snippet": {"code": "                abi.encodePacked(blockhash(block.number - 1), block.timestamp)", "highlightLines": [71]}, "category": "code", "location": {"file": "src/test/Randomness.sol", "line": 71, "column": 34}, "severity": "high", "references": [], "description": ""}, {"id": "02eb6d540c87", "fix": {"template": null, "available": false}, "title": "blockhash only works for last 256 blocks - older blocks return 0 (PredictTheBlockHash pattern)", "ruleId": "rules.sol-blockhash-256-limit", "snippet": {"code": "                abi.encodePacked(blockhash(block.number - 1), block.timestamp)", "highlightLines": [71]}, "category": "code", "location": {"file": "src/test/Randomness.sol", "line": 71, "column": 34}, "severity": "medium", "references": ["https://capturetheether.com/challenges/lottery/predict-block-hash/"], "description": ""}, {"id": "2ed51fe56cc4", "fix": {"template": null, "available": false}, "title": "blockhash(block.number - 1) used for randomness - miners can manipulate", "ruleId": "rules.sol-blockhash-previous-block", "snippet": {"code": "                abi.encodePacked(blockhash(block.number - 1), block.timestamp)", "highlightLines": [71]}, "category": "code", "location": {"file": "src/test/Randomness.sol", "line": 71, "column": 34}, "severity": "medium", "references": [], "description": ""}, {"id": "7722440986e9", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "                abi.encodePacked(blockhash(block.number - 1), block.timestamp)", "highlightLines": [71]}, "category": "code", "location": {"file": "src/test/Randomness.sol", "line": 71, "column": 34}, "severity": "medium", "references": [], "description": ""}, {"id": "ca7b5043cd4f", "fix": {"template": null, "available": false}, "title": "Low-level call without checking return value - silent failure possible", "ruleId": "rules.sol-unchecked-call-return", "snippet": {"code": "            (bool sent, ) = msg.sender.call{value: 1 ether}(\"\");", "highlightLines": [76]}, "category": "code", "location": {"file": "src/test/Randomness.sol", "line": 76, "column": 39}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-104/", "https://blocksecteam.medium.com/li-fi-attack"], "description": ""}, {"id": "fab957d6fa54", "fix": {"template": null, "available": false}, "title": "State change after external call - potential reentrancy vulnerability", "ruleId": "rules.sol-external-call-state-change", "snippet": {"code": "            (bool sent, ) = msg.sender.call{value: 1 ether}(\"\");\n            require(sent, \"Failed to send Ether\");\n        }\n    }\n}\n\ncontract Attack {\n    receive() external payable {}\n\n    function attack(GuessTheRandomNumber guessTheRandomNumber) public {\n        uint answer = uint(", "highlightLines": [76]}, "category": "code", "location": {"file": "src/test/Randomness.sol", "line": 76, "column": 39}, "severity": "high", "references": ["https://consensys.github.io/smart-contract-best-practices/attacks/reentrancy/"], "description": ""}, {"id": "36867a47bfe4", "fix": {"template": null, "available": false}, "title": "Contract accepts ETH or tokens but has no withdrawal function - funds may be stuck", "ruleId": "rules.sol-no-withdrawal-function", "snippet": {"code": "contract Attack {\n    receive() external payable {}", "highlightLines": [82]}, "category": "code", "location": {"file": "src/test/Randomness.sol", "line": 82, "column": 1}, "severity": "medium", "references": [], "description": ""}, {"id": "2b19a867d215", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    receive() external payable {}", "highlightLines": [83]}, "category": "code", "location": {"file": "src/test/Randomness.sol", "line": 83, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "1ad9df162a0c", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "    receive() external payable {}", "highlightLines": [83]}, "category": "code", "location": {"file": "src/test/Randomness.sol", "line": 83, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "7d361be62e26", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint answer = uint(", "highlightLines": [86]}, "category": "code", "location": {"file": "src/test/Randomness.sol", "line": 86, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "56f335a8f3eb", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "        uint answer = uint(\n            keccak256(\n                abi.encodePacked(blockhash(block.number - 1), block.timestamp)\n            )", "highlightLines": [86]}, "category": "code", "location": {"file": "src/test/Randomness.sol", "line": 86, "column": 23}, "severity": "info", "references": [], "description": ""}, {"id": "60f66285f604", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "            keccak256(\n                abi.encodePacked(blockhash(block.number - 1), block.timestamp)\n            )", "highlightLines": [87]}, "category": "code", "location": {"file": "src/test/Randomness.sol", "line": 87, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "a3f6f38a23ce", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "                abi.encodePacked(blockhash(block.number - 1), block.timestamp)", "highlightLines": [88]}, "category": "code", "location": {"file": "src/test/Randomness.sol", "line": 88, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "f8a96ab0c559", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - predictable by miners, 0 after 256 blocks", "ruleId": "rules.sol-blockhash-randomness", "snippet": {"code": "                abi.encodePacked(blockhash(block.number - 1), block.timestamp)", "highlightLines": [88]}, "category": "code", "location": {"file": "src/test/Randomness.sol", "line": 88, "column": 34}, "severity": "high", "references": [], "description": ""}, {"id": "ca2acf19a3e9", "fix": {"template": null, "available": false}, "title": "blockhash only works for last 256 blocks - older blocks return 0 (PredictTheBlockHash pattern)", "ruleId": "rules.sol-blockhash-256-limit", "snippet": {"code": "                abi.encodePacked(blockhash(block.number - 1), block.timestamp)", "highlightLines": [88]}, "category": "code", "location": {"file": "src/test/Randomness.sol", "line": 88, "column": 34}, "severity": "medium", "references": ["https://capturetheether.com/challenges/lottery/predict-block-hash/"], "description": ""}, {"id": "a2bba56a936a", "fix": {"template": null, "available": false}, "title": "blockhash(block.number - 1) used for randomness - miners can manipulate", "ruleId": "rules.sol-blockhash-previous-block", "snippet": {"code": "                abi.encodePacked(blockhash(block.number - 1), block.timestamp)", "highlightLines": [88]}, "category": "code", "location": {"file": "src/test/Randomness.sol", "line": 88, "column": 34}, "severity": "medium", "references": [], "description": ""}, {"id": "e5f081281e90", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "                abi.encodePacked(blockhash(block.number - 1), block.timestamp)", "highlightLines": [88]}, "category": "code", "location": {"file": "src/test/Randomness.sol", "line": 88, "column": 34}, "severity": "medium", "references": [], "description": ""}, {"id": "cf044b6ca076", "fix": {"template": null, "available": false}, "title": "Potential mnemonic seed phrase detected - CRITICAL if real", "ruleId": "rules._shared.shared-mnemonic-phrase", "snippet": {"code": "The Read-Only Reentrancy Vulnerability is a flaw in smart contract design that allows attackers \nto exploit the \"read-only\" nature of a function to make unintended changes to the contract's state.", "highlightLines": [10]}, "category": "code", "location": {"file": "src/test/ReadOnlyReentrancy.sol", "line": 10, "column": 32}, "severity": "high", "references": [], "description": ""}, {"id": "76acc6e2387b", "fix": {"template": null, "available": false}, "title": "Potential mnemonic seed phrase detected - CRITICAL if real", "ruleId": "rules._shared.shared-mnemonic-phrase", "snippet": {"code": "Specifically, the vulnerability arises when an attacker uses the remove_liquidity function of the ICurve contract \nto trigger the receive function in the ExploitContract. This is achieved by an external call", "highlightLines": [12]}, "category": "code", "location": {"file": "src/test/ReadOnlyReentrancy.sol", "line": 12, "column": 25}, "severity": "high", "references": [], "description": ""}, {"id": "4bf8ce094b6f", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function get_virtual_price() external view returns (uint);\n\n    function add_liquidity(\n        uint[2] calldata amounts,\n        uint min_mint_amount\n    ) external payable returns (uint);\n\n    function remove_liquidity(\n        uint lp,\n        uint[2] calldata min_amounts\n    ) external returns (uint[2] memory);\n\n    function remove_liquidity_one_coin(\n        uint lp,\n        int128 i,\n        uint min_amount\n    ) external returns (uint);\n}\n\naddress constant STETH_POOL = 0xDC24316b9AE028F1497c275EB9192a3Ea0f67022;\naddress constant LP_TOKEN = 0x06325440D014e39736583c165C2963BA99fAf14E; //steCRV Token\n\n// VulnContract\n// users stake LP_TOKEN\n// getReward rewards the users based on the current price of the pool LP token\ncontract VulnContract {\n    IERC20 public constant token = IERC20(LP_TOKEN);\n    ICurve private constant pool = ICurve(STETH_POOL);\n\n    mapping(address => uint) public balanceOf;", "highlightLines": [39]}, "category": "code", "location": {"file": "src/test/ReadOnlyReentrancy.sol", "line": 39, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "356f2cfc9aad", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function stake(uint amount) external {", "highlightLines": [70]}, "category": "code", "location": {"file": "src/test/ReadOnlyReentrancy.sol", "line": 70, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "de2d6c553a1b", "fix": {"template": null, "available": false}, "title": "Token transfer without before/after balance comparison - rebasing/fee tokens may transfer different amounts", "ruleId": "rules.sol-no-balance-before-after", "snippet": {"code": "    function stake(uint amount) external {\n        token.transferFrom(msg.sender, address(this), amount);", "highlightLines": [70]}, "category": "code", "location": {"file": "src/test/ReadOnlyReentrancy.sol", "line": 70, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "e0a23e49450f", "fix": {"template": null, "available": false}, "title": "Token transfer without checking actual received amount - deflationary tokens may transfer less", "ruleId": "rules.sol-deflationary-token-transfer", "snippet": {"code": "        token.transferFrom(msg.sender, address(this), amount);", "highlightLines": [71]}, "category": "code", "location": {"file": "src/test/ReadOnlyReentrancy.sol", "line": 71, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "0e6bcedc8517", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        token.transferFrom(msg.sender, address(this), amount);", "highlightLines": [71]}, "category": "code", "location": {"file": "src/test/ReadOnlyReentrancy.sol", "line": 71, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "193c6078ec12", "fix": {"template": null, "available": false}, "title": "Token amount after transfer may differ - check actual received amount", "ruleId": "rules.sol-fee-on-transfer-token", "snippet": {"code": "        token.transferFrom(msg.sender, address(this), amount);", "highlightLines": [71]}, "category": "code", "location": {"file": "src/test/ReadOnlyReentrancy.sol", "line": 71, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "6a521a561c96", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function unstake(uint amount) external {", "highlightLines": [75]}, "category": "code", "location": {"file": "src/test/ReadOnlyReentrancy.sol", "line": 75, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "e536573b39b1", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        token.transfer(msg.sender, amount);", "highlightLines": [77]}, "category": "code", "location": {"file": "src/test/ReadOnlyReentrancy.sol", "line": 77, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "74a999578f44", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "        token.transfer(msg.sender, amount);", "highlightLines": [77]}, "category": "code", "location": {"file": "src/test/ReadOnlyReentrancy.sol", "line": 77, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "965570d43138", "fix": {"template": null, "available": false}, "title": "ERC20 transfer() return value not checked - tokens like USDT don't return bool", "ruleId": "rules.sol-erc20-transfer-no-return-check", "snippet": {"code": "        token.transfer(msg.sender, amount);", "highlightLines": [77]}, "category": "code", "location": {"file": "src/test/ReadOnlyReentrancy.sol", "line": 77, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "1edc248479dc", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function getReward() external view returns (uint) {\n        //rewarding tokens based on the current virtual price of the pool LP token\n        uint reward = (balanceOf[msg.sender] * pool.get_virtual_price()) /", "highlightLines": [80]}, "category": "code", "location": {"file": "src/test/ReadOnlyReentrancy.sol", "line": 80, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "c123c05ed1a4", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint reward = (balanceOf[msg.sender] * pool.get_virtual_price()) /", "highlightLines": [82]}, "category": "code", "location": {"file": "src/test/ReadOnlyReentrancy.sol", "line": 82, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "af9d580bfd80", "fix": {"template": null, "available": false}, "title": "Rewards calculated from spot balance - deposit timing manipulation possible", "ruleId": "rules.sol-reward-deposit-timing", "snippet": {"code": "        uint reward = (balanceOf[msg.sender] * pool.get_virtual_price()) /", "highlightLines": [82]}, "category": "code", "location": {"file": "src/test/ReadOnlyReentrancy.sol", "line": 82, "column": 14}, "severity": "medium", "references": ["https://github.com/code-423n4/2023-04-rubicon-findings"], "description": ""}, {"id": "35ad518df76e", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(address _target) {\n        target = VulnContract(_target);\n    }", "highlightLines": [94]}, "category": "code", "location": {"file": "src/test/ReadOnlyReentrancy.sol", "line": 94, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "c0fc8bfb297d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint[2] memory amounts = [msg.value, 0];\n        uint lp = pool.add_liquidity{value: msg.value}(amounts, 1);", "highlightLines": [100]}, "category": "code", "location": {"file": "src/test/ReadOnlyReentrancy.sol", "line": 100, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "7700c4a4c74f", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint lp = pool.add_liquidity{value: msg.value}(amounts, 1);", "highlightLines": [101]}, "category": "code", "location": {"file": "src/test/ReadOnlyReentrancy.sol", "line": 101, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "556fe5f21778", "fix": {"template": null, "available": false}, "title": "Curve get_virtual_price() called during callback - read-only reentrancy attack possible", "ruleId": "rules.sol-curve-virtual-price-in-callback", "snippet": {"code": "            pool.get_virtual_price()", "highlightLines": [104]}, "category": "code", "location": {"file": "src/test/ReadOnlyReentrancy.sol", "line": 104, "column": 13}, "severity": "high", "references": ["https://www.damnvulnerabledefi.xyz/challenges/curvy-puppet/", "https://chainsecurity.com/heartbreaks-curve-lp-oracles/"], "description": ""}, {"id": "ec88ada8a19e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint[2] memory amounts = [msg.value, 0];\n        uint lp = pool.add_liquidity{value: msg.value}(amounts, 1);", "highlightLines": [114]}, "category": "code", "location": {"file": "src/test/ReadOnlyReentrancy.sol", "line": 114, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "27a842b32f73", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint lp = pool.add_liquidity{value: msg.value}(amounts, 1);", "highlightLines": [115]}, "category": "code", "location": {"file": "src/test/ReadOnlyReentrancy.sol", "line": 115, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3dbbce5482bd", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint lp = pool.add_liquidity{value: msg.value}(amounts, 1);\n        // Log get_virtual_price\n        console.log(\n            \"LP token price before remove_liquidity()\",\n            pool.get_virtual_price()\n        );\n        // Remove liquidity from Curve\n        // remove_liquidity() invokes the recieve() callback\n        uint[2] memory min_amounts = [uint(0), uint(0)];", "highlightLines": [115]}, "category": "code", "location": {"file": "src/test/ReadOnlyReentrancy.sol", "line": 115, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "7e6054e833df", "fix": {"template": null, "available": false}, "title": "Curve get_virtual_price() called during callback - read-only reentrancy attack possible", "ruleId": "rules.sol-curve-virtual-price-in-callback", "snippet": {"code": "            pool.get_virtual_price()", "highlightLines": [119]}, "category": "code", "location": {"file": "src/test/ReadOnlyReentrancy.sol", "line": 119, "column": 13}, "severity": "high", "references": ["https://www.damnvulnerabledefi.xyz/challenges/curvy-puppet/", "https://chainsecurity.com/heartbreaks-curve-lp-oracles/"], "description": ""}, {"id": "30c9a2ddb396", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint[2] memory min_amounts = [uint(0), uint(0)];\n        pool.remove_liquidity(lp, min_amounts);\n        // Log get_virtual_price\n        console.log(\n            \"--------------------------------------------------------------------\"\n        );\n        console.log(\n            \"LP token price after remove_liquidity()\",\n            pool.get_virtual_price()\n        );\n\n        // Attack - Log reward amount\n        uint reward = target.getReward();", "highlightLines": [123]}, "category": "code", "location": {"file": "src/test/ReadOnlyReentrancy.sol", "line": 123, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "bdaf7a7fbcfc", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "        uint[2] memory min_amounts = [uint(0), uint(0)];", "highlightLines": [123]}, "category": "code", "location": {"file": "src/test/ReadOnlyReentrancy.sol", "line": 123, "column": 39}, "severity": "info", "references": [], "description": ""}, {"id": "28dde38e6e97", "fix": {"template": null, "available": false}, "title": "Curve get_virtual_price() called during callback - read-only reentrancy attack possible", "ruleId": "rules.sol-curve-virtual-price-in-callback", "snippet": {"code": "            pool.get_virtual_price()", "highlightLines": [131]}, "category": "code", "location": {"file": "src/test/ReadOnlyReentrancy.sol", "line": 131, "column": 13}, "severity": "high", "references": ["https://www.damnvulnerabledefi.xyz/challenges/curvy-puppet/", "https://chainsecurity.com/heartbreaks-curve-lp-oracles/"], "description": ""}, {"id": "3cc875f6fe8a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint reward = target.getReward();", "highlightLines": [135]}, "category": "code", "location": {"file": "src/test/ReadOnlyReentrancy.sol", "line": 135, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "aa2bf6123fe1", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    receive() external payable {", "highlightLines": [139]}, "category": "code", "location": {"file": "src/test/ReadOnlyReentrancy.sol", "line": 139, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "49079d1b4881", "fix": {"template": null, "available": false}, "title": "Curve get_virtual_price() called during callback - read-only reentrancy attack possible", "ruleId": "rules.sol-curve-virtual-price-in-callback", "snippet": {"code": "            pool.get_virtual_price()", "highlightLines": [146]}, "category": "code", "location": {"file": "src/test/ReadOnlyReentrancy.sol", "line": 146, "column": 13}, "severity": "high", "references": ["https://www.damnvulnerabledefi.xyz/challenges/curvy-puppet/", "https://chainsecurity.com/heartbreaks-curve-lp-oracles/"], "description": ""}, {"id": "f876503fc344", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint reward = target.getReward();", "highlightLines": [149]}, "category": "code", "location": {"file": "src/test/ReadOnlyReentrancy.sol", "line": 149, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "202b3faf9873", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        target = new VulnContract(); // deploy the vulnerable contract\n        hack = new ExploitContract(address(target)); // deploy attacker contract", "highlightLines": [160]}, "category": "code", "location": {"file": "src/test/ReadOnlyReentrancy.sol", "line": 160, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "86886e180064", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        target = new VulnContract(); // deploy the vulnerable contract", "highlightLines": [160]}, "category": "code", "location": {"file": "src/test/ReadOnlyReentrancy.sol", "line": 160, "column": 18}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "a23f8985aad7", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        hack = new ExploitContract(address(target)); // deploy attacker contract", "highlightLines": [161]}, "category": "code", "location": {"file": "src/test/ReadOnlyReentrancy.sol", "line": 161, "column": 16}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "47045972a0ad", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.18;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/Reentrancy.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "84d2fb732548", "fix": {"template": null, "available": false}, "title": "Potential mnemonic seed phrase detected - CRITICAL if real", "ruleId": "rules._shared.shared-mnemonic-phrase", "snippet": {"code": "The EtherStore Reentrancy Vulnerability is a flaw in the smart contract design that allows \nan attacker to exploit reentrancy and withdraw more funds than they are entitled to from the EtherStore contract.", "highlightLines": [10]}, "category": "code", "location": {"file": "src/test/Reentrancy.sol", "line": 10, "column": 33}, "severity": "high", "references": [], "description": ""}, {"id": "f5160ceb8c19", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function deposit() public payable {", "highlightLines": [33]}, "category": "code", "location": {"file": "src/test/Reentrancy.sol", "line": 33, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "55f279eb5c40", "fix": {"template": null, "available": false}, "title": "require() in withdrawal path - griefing possible if condition can be manipulated", "ruleId": "rules.sol-force-revert-griefing", "snippet": {"code": "    function withdrawFunds(uint256 _weiToWithdraw) public {\n        require(balances[msg.sender] >= _weiToWithdraw);", "highlightLines": [37]}, "category": "code", "location": {"file": "src/test/Reentrancy.sol", "line": 37, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "2eca700e8018", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(balances[msg.sender] >= _weiToWithdraw);", "highlightLines": [38]}, "category": "code", "location": {"file": "src/test/Reentrancy.sol", "line": 38, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "c606bbe4dc12", "fix": {"template": null, "available": false}, "title": "Low-level call without checking return value - silent failure possible", "ruleId": "rules.sol-unchecked-call-return", "snippet": {"code": "        (bool send, ) = msg.sender.call{value: _weiToWithdraw}(\"\");", "highlightLines": [39]}, "category": "code", "location": {"file": "src/test/Reentrancy.sol", "line": 39, "column": 35}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-104/", "https://blocksecteam.medium.com/li-fi-attack"], "description": ""}, {"id": "5c91d049421b", "fix": {"template": null, "available": false}, "title": "State change after external call - potential reentrancy vulnerability", "ruleId": "rules.sol-external-call-state-change", "snippet": {"code": "        (bool send, ) = msg.sender.call{value: _weiToWithdraw}(\"\");\n        require(send, \"send failed\");\n\n        // check if after send still enough to avoid underflow\n        if (balances[msg.sender] >= _weiToWithdraw) {\n            balances[msg.sender] -= _weiToWithdraw;\n        }\n    }\n}\n\ncontract EtherStoreRemediated {\n    mapping(address => uint256) public balances;", "highlightLines": [39]}, "category": "code", "location": {"file": "src/test/Reentrancy.sol", "line": 39, "column": 35}, "severity": "high", "references": ["https://consensys.github.io/smart-contract-best-practices/attacks/reentrancy/"], "description": ""}, {"id": "2810df2d1868", "fix": {"template": null, "available": false}, "title": "State variable used as reentrancy guard - use OpenZeppelin ReentrancyGuard", "ruleId": "rules.sol-reentrancy-lock", "snippet": {"code": "    bool internal locked;", "highlightLines": [51]}, "category": "code", "location": {"file": "src/test/Reentrancy.sol", "line": 51, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "1864d729205d", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier nonReentrant() {\n        require(!locked, \"No re-entrancy\");\n        locked = true;\n        _;\n        locked = false;\n    }", "highlightLines": [53]}, "category": "code", "location": {"file": "src/test/Reentrancy.sol", "line": 53, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "13ee3f4d910d", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "    modifier nonReentrant() {\n        require(!locked, \"No re-entrancy\");\n        locked = true;\n        _;\n        locked = false;\n    }", "highlightLines": [53]}, "category": "code", "location": {"file": "src/test/Reentrancy.sol", "line": 53, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "66fc445d01c2", "fix": {"template": null, "available": false}, "title": "State variable used as reentrancy guard - use OpenZeppelin ReentrancyGuard", "ruleId": "rules.sol-reentrancy-lock", "snippet": {"code": "        require(!locked, \"No re-entrancy\");", "highlightLines": [54]}, "category": "code", "location": {"file": "src/test/Reentrancy.sol", "line": 54, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "44d8cfe8d1ba", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        locked = true;\n        _;\n        locked = false;", "highlightLines": [55]}, "category": "code", "location": {"file": "src/test/Reentrancy.sol", "line": 55, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "4d5195699d24", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [56]}, "category": "code", "location": {"file": "src/test/Reentrancy.sol", "line": 56, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "0aa14040d3a9", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function deposit() public payable {", "highlightLines": [60]}, "category": "code", "location": {"file": "src/test/Reentrancy.sol", "line": 60, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "ecb57f3deba3", "fix": {"template": null, "available": false}, "title": "require() in withdrawal path - griefing possible if condition can be manipulated", "ruleId": "rules.sol-force-revert-griefing", "snippet": {"code": "    function withdrawFunds(uint256 _weiToWithdraw) public nonReentrant {\n        require(balances[msg.sender] >= _weiToWithdraw);", "highlightLines": [64]}, "category": "code", "location": {"file": "src/test/Reentrancy.sol", "line": 64, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "515c160e36c0", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(balances[msg.sender] >= _weiToWithdraw);", "highlightLines": [65]}, "category": "code", "location": {"file": "src/test/Reentrancy.sol", "line": 65, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "b91afc4f9af5", "fix": {"template": null, "available": false}, "title": "Low-level call without checking return value - silent failure possible", "ruleId": "rules.sol-unchecked-call-return", "snippet": {"code": "        (bool send, ) = msg.sender.call{value: _weiToWithdraw}(\"\");", "highlightLines": [67]}, "category": "code", "location": {"file": "src/test/Reentrancy.sol", "line": 67, "column": 35}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-104/", "https://blocksecteam.medium.com/li-fi-attack"], "description": ""}, {"id": "c991352cc628", "fix": {"template": null, "available": false}, "title": "State change after external call - potential reentrancy vulnerability", "ruleId": "rules.sol-external-call-state-change", "snippet": {"code": "        (bool send, ) = msg.sender.call{value: _weiToWithdraw}(\"\");\n        require(send, \"send failed\");\n    }\n}\n\ncontract ContractTest is Test {\n    EtherStore store;\n    EtherStoreRemediated storeRemediated;\n    EtherStoreAttack attack;\n    EtherStoreAttack attackRemediated;\n\n    function setUp() public {\n        store = new EtherStore();", "highlightLines": [67]}, "category": "code", "location": {"file": "src/test/Reentrancy.sol", "line": 67, "column": 35}, "severity": "high", "references": ["https://consensys.github.io/smart-contract-best-practices/attacks/reentrancy/"], "description": ""}, {"id": "d05ad68382dc", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        store = new EtherStore();\n        storeRemediated = new EtherStoreRemediated();", "highlightLines": [79]}, "category": "code", "location": {"file": "src/test/Reentrancy.sol", "line": 79, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "4c3c0f69204d", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        store = new EtherStore();", "highlightLines": [79]}, "category": "code", "location": {"file": "src/test/Reentrancy.sol", "line": 79, "column": 17}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "a9f174f18ffe", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        storeRemediated = new EtherStoreRemediated();\n        attack = new EtherStoreAttack(address(store));", "highlightLines": [80]}, "category": "code", "location": {"file": "src/test/Reentrancy.sol", "line": 80, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "c6845632fdd4", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        storeRemediated = new EtherStoreRemediated();", "highlightLines": [80]}, "category": "code", "location": {"file": "src/test/Reentrancy.sol", "line": 80, "column": 27}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "3b23035de9eb", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        attack = new EtherStoreAttack(address(store));\n        attackRemediated = new EtherStoreAttack(address(storeRemediated));", "highlightLines": [81]}, "category": "code", "location": {"file": "src/test/Reentrancy.sol", "line": 81, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "4cb12d206442", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        attack = new EtherStoreAttack(address(store));", "highlightLines": [81]}, "category": "code", "location": {"file": "src/test/Reentrancy.sol", "line": 81, "column": 18}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "235c7903c391", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        attackRemediated = new EtherStoreAttack(address(storeRemediated));", "highlightLines": [82]}, "category": "code", "location": {"file": "src/test/Reentrancy.sol", "line": 82, "column": 28}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "eed4cfbe92c6", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(address _store) {\n        store = EtherStore(_store);\n    }", "highlightLines": [101]}, "category": "code", "location": {"file": "src/test/Reentrancy.sol", "line": 101, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "37e827dc94fb", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "            \"Deposited 1 Ether, EtherStore balance\",", "highlightLines": [111]}, "category": "code", "location": {"file": "src/test/Reentrancy.sol", "line": 111, "column": 26}, "severity": "info", "references": [], "description": ""}, {"id": "83951be3d309", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    // fallback() external payable {}", "highlightLines": [120]}, "category": "code", "location": {"file": "src/test/Reentrancy.sol", "line": 120, "column": 8}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "0a211572f562", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    receive() external payable {", "highlightLines": [123]}, "category": "code", "location": {"file": "src/test/Reentrancy.sol", "line": 123, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "125f36a0b6ad", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.18;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/Returnfalse.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "803de2457c76", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "Some tokens do not revert on failure, but instead return false (e.g. ZRX).\n\nZRX transfer return false:\n    function transfer(address _to, uint _value) returns (bool) {\n        //Default assumes totalSupply can't be over max (2^256 - 1).\n        if (balances[msg.sender] >= _value && balances[_to] + _value >= balances[_to]) {\n            balances[msg.sender] -= _value;\n            balances[_to] += _value;", "highlightLines": [13]}, "category": "code", "location": {"file": "src/test/Returnfalse.sol", "line": 13, "column": 51}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "3c3abba18605", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without msg.data.length validation - vulnerable to short address attack padding", "ruleId": "rules.sol-short-address-no-payload-check", "snippet": {"code": "    function transfer(address _to, uint _value) returns (bool) {", "highlightLines": [16]}, "category": "code", "location": {"file": "src/test/Returnfalse.sol", "line": 16, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address", "https://vessenes.com/the-erc20-short-address-attack-explained/"], "description": ""}, {"id": "dfc59371f167", "fix": {"template": null, "available": false}, "title": "Possible incorrect exponentiation - ^ is XOR in Solidity, use ** for power", "ruleId": "rules.sol-incorrect-exponentiation", "snippet": {"code": "        //Default assumes totalSupply can't be over max (2^256 - 1).", "highlightLines": [17]}, "category": "code", "location": {"file": "src/test/Returnfalse.sol", "line": 17, "column": 58}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-exponentiation"], "description": ""}, {"id": "567668a5e542", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        zrx.transfer(address(this), 123); //return false, do not revert", "highlightLines": [40]}, "category": "code", "location": {"file": "src/test/Returnfalse.sol", "line": 40, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "dca7ebc2b48f", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "        zrx.transfer(address(this), 123); //return false, do not revert", "highlightLines": [40]}, "category": "code", "location": {"file": "src/test/Returnfalse.sol", "line": 40, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "5309a71961a6", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    receive() external payable {}", "highlightLines": [54]}, "category": "code", "location": {"file": "src/test/Returnfalse.sol", "line": 54, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "c5329485bed6", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "    receive() external payable {}", "highlightLines": [54]}, "category": "code", "location": {"file": "src/test/Returnfalse.sol", "line": 54, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "c120fe872057", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.18;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/Returnvalue.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "cbd2c31e0dc2", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "Name: Unchecked return value\n\nDescription:\nEIP20 standard:\nReturns a boolean value indicating whether the operation succeeded.\nfunction transfer(address to, uint256 amount) external returns (bool);\n\nUSDT doesn't correctly implement the EIP20 standard,", "highlightLines": [8]}, "category": "code", "location": {"file": "src/test/Returnvalue.sol", "line": 8, "column": 17}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "02a679abedc3", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "function transfer(address to, uint256 amount) external returns (bool);\n\nUSDT doesn't correctly implement the EIP20 standard,\nso calling these functions with the correct EIP20 function signatures will always revert.\nfunction transfer(address to, uint256 value) external;\n\nERC20 transfer:\n    function transfer(address to, uint256 amount) public virtual returns (bool) {", "highlightLines": [13]}, "category": "code", "location": {"file": "src/test/Returnvalue.sol", "line": 13, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "b29c3ad96cc2", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without msg.data.length validation - vulnerable to short address attack padding", "ruleId": "rules.sol-short-address-no-payload-check", "snippet": {"code": "function transfer(address to, uint256 amount) external returns (bool);\n\nUSDT doesn't correctly implement the EIP20 standard,\nso calling these functions with the correct EIP20 function signatures will always revert.\nfunction transfer(address to, uint256 value) external;\n\nERC20 transfer:\n    function transfer(address to, uint256 amount) public virtual returns (bool) {", "highlightLines": [13]}, "category": "code", "location": {"file": "src/test/Returnvalue.sol", "line": 13, "column": 1}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address", "https://vessenes.com/the-erc20-short-address-attack-explained/"], "description": ""}, {"id": "9c6594e5bd22", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address owner = _msgSender();", "highlightLines": [21]}, "category": "code", "location": {"file": "src/test/Returnvalue.sol", "line": 21, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "be66257eab8b", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "        address owner = _msgSender();", "highlightLines": [21]}, "category": "code", "location": {"file": "src/test/Returnvalue.sol", "line": 21, "column": 9}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "3dd641220ac1", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function transfer(address _to, uint _value) public onlyPayloadSize(2 * 32) {", "highlightLines": [27]}, "category": "code", "location": {"file": "src/test/Returnvalue.sol", "line": 27, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "fbba2f55a213", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without msg.data.length validation - vulnerable to short address attack padding", "ruleId": "rules.sol-short-address-no-payload-check", "snippet": {"code": "    function transfer(address _to, uint _value) public onlyPayloadSize(2 * 32) {", "highlightLines": [27]}, "category": "code", "location": {"file": "src/test/Returnvalue.sol", "line": 27, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address", "https://vessenes.com/the-erc20-short-address-attack-explained/"], "description": ""}, {"id": "74ab413fc16b", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function transfer(address to, uint256 value) external;", "highlightLines": [41]}, "category": "code", "location": {"file": "src/test/Returnvalue.sol", "line": 41, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "2fd64a3ce3c0", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function transfer(address to, uint256 value) external;\n\n    function balanceOf(address account) external view returns (uint256);\n\n    function approve(address spender, uint256 value) external;\n}\n\ncontract ContractTest is Test {", "highlightLines": [41]}, "category": "code", "location": {"file": "src/test/Returnvalue.sol", "line": 41, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "89e204ac452a", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without msg.data.length validation - vulnerable to short address attack padding", "ruleId": "rules.sol-short-address-no-payload-check", "snippet": {"code": "    function transfer(address to, uint256 value) external;\n\n    function balanceOf(address account) external view returns (uint256);\n\n    function approve(address spender, uint256 value) external;\n}\n\ncontract ContractTest is Test {", "highlightLines": [41]}, "category": "code", "location": {"file": "src/test/Returnvalue.sol", "line": 41, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address", "https://vessenes.com/the-erc20-short-address-attack-explained/"], "description": ""}, {"id": "c86782d784d8", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function transfer(address to, uint256 value) external;\n\n    function balanceOf(address account) external view returns (uint256);\n\n    function approve(address spender, uint256 value) external;\n}\n\ncontract ContractTest is Test {\n    using SafeERC20 for IERC20;\n    IERC20 constant usdt = IERC20(0xdAC17F958D2ee523a2206206994597C13D831ec7);", "highlightLines": [41]}, "category": "code", "location": {"file": "src/test/Returnvalue.sol", "line": 41, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "15102bcea82c", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function balanceOf(address account) external view returns (uint256);", "highlightLines": [43]}, "category": "code", "location": {"file": "src/test/Returnvalue.sol", "line": 43, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "4420857aa53e", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function approve(address spender, uint256 value) external;", "highlightLines": [45]}, "category": "code", "location": {"file": "src/test/Returnvalue.sol", "line": 45, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "c63d88a000f5", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        usdt.transfer(address(this), 123); //revert", "highlightLines": [58]}, "category": "code", "location": {"file": "src/test/Returnvalue.sol", "line": 58, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "7b2bc9f139b5", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "        usdt.transfer(address(this), 123); //revert", "highlightLines": [58]}, "category": "code", "location": {"file": "src/test/Returnvalue.sol", "line": 58, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e1d9b001c7bd", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    receive() external payable {}", "highlightLines": [68]}, "category": "code", "location": {"file": "src/test/Returnvalue.sol", "line": 68, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "fa505bc46a39", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "    receive() external payable {}", "highlightLines": [68]}, "category": "code", "location": {"file": "src/test/Returnvalue.sol", "line": 68, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "b35df7a2ed84", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.18;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/Selfdestruct.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "d23eb32bc27d", "fix": {"template": null, "available": false}, "title": "Potential mnemonic seed phrase detected - CRITICAL if real", "ruleId": "rules._shared.shared-mnemonic-phrase", "snippet": {"code": "The EtherGame Self-Destruct Vulnerability is a flaw in the smart contract code that allows an attacker \nto disrupt the game by causing the EtherGame contract to self-destruct (using the selfdestruct opcode).", "highlightLines": [10]}, "category": "code", "location": {"file": "src/test/Selfdestruct.sol", "line": 10, "column": 35}, "severity": "high", "references": [], "description": ""}, {"id": "84ac67ff8368", "fix": {"template": null, "available": false}, "title": "Selfdestruct with user-controlled recipient - funds can be sent anywhere", "ruleId": "rules.sol-selfdestruct-arbitrary", "snippet": {"code": "The selfdestruct(address) function removes all bytecode from the contract address and sends all ether stored to the specified address.", "highlightLines": [26]}, "category": "code", "location": {"file": "src/test/Selfdestruct.sol", "line": 26, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "d908ef75f13c", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function deposit() public payable {", "highlightLines": [37]}, "category": "code", "location": {"file": "src/test/Selfdestruct.sol", "line": 37, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "be63b91ef914", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint balance = address(this).balance; // vulnerable", "highlightLines": [39]}, "category": "code", "location": {"file": "src/test/Selfdestruct.sol", "line": 39, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "5de16d121c35", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "        uint balance = address(this).balance; // vulnerable", "highlightLines": [40]}, "category": "code", "location": {"file": "src/test/Selfdestruct.sol", "line": 40, "column": 9}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "353a9e18b19f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint balance = address(this).balance; // vulnerable\n        require(balance <= targetAmount, \"Game is over\");\n\n        if (balance == targetAmount) {\n            winner = msg.sender;\n        }", "highlightLines": [40]}, "category": "code", "location": {"file": "src/test/Selfdestruct.sol", "line": 40, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "68b570458d8b", "fix": {"template": null, "available": false}, "title": "Low-level call without checking return value - silent failure possible", "ruleId": "rules.sol-unchecked-call-return", "snippet": {"code": "        (bool sent, ) = msg.sender.call{value: address(this).balance}(\"\");", "highlightLines": [51]}, "category": "code", "location": {"file": "src/test/Selfdestruct.sol", "line": 51, "column": 35}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-104/", "https://blocksecteam.medium.com/li-fi-attack"], "description": ""}, {"id": "e7cd91a6e5ba", "fix": {"template": null, "available": false}, "title": "State change after external call - potential reentrancy vulnerability", "ruleId": "rules.sol-external-call-state-change", "snippet": {"code": "        (bool sent, ) = msg.sender.call{value: address(this).balance}(\"\");\n        require(sent, \"Failed to send Ether\");\n    }\n}\n\ncontract ContractTest is Test {\n    EtherGame EtherGameContract;\n    Attack AttackerContract;\n    address alice;\n    address eve;\n\n    function setUp() public {\n        EtherGameContract = new EtherGame();", "highlightLines": [51]}, "category": "code", "location": {"file": "src/test/Selfdestruct.sol", "line": 51, "column": 35}, "severity": "high", "references": ["https://consensys.github.io/smart-contract-best-practices/attacks/reentrancy/"], "description": ""}, {"id": "5de8f71fb0c0", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract ContractTest is Test {\n    EtherGame EtherGameContract;\n    Attack AttackerContract;\n    address alice;\n    address eve;", "highlightLines": [56]}, "category": "code", "location": {"file": "src/test/Selfdestruct.sol", "line": 56, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "8befbe6943a0", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address alice;", "highlightLines": [59]}, "category": "code", "location": {"file": "src/test/Selfdestruct.sol", "line": 59, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "af35ef51e9d0", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address eve;", "highlightLines": [60]}, "category": "code", "location": {"file": "src/test/Selfdestruct.sol", "line": 60, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8e2969f74e6d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        EtherGameContract = new EtherGame();\n        alice = vm.addr(1);", "highlightLines": [63]}, "category": "code", "location": {"file": "src/test/Selfdestruct.sol", "line": 63, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "37a28bb70360", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        EtherGameContract = new EtherGame();", "highlightLines": [63]}, "category": "code", "location": {"file": "src/test/Selfdestruct.sol", "line": 63, "column": 29}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "e9aabd56be81", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "        alice = vm.addr(1);\n        eve = vm.addr(2);", "highlightLines": [64]}, "category": "code", "location": {"file": "src/test/Selfdestruct.sol", "line": 64, "column": 9}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "ec1bdd57bdfa", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        alice = vm.addr(1);\n        eve = vm.addr(2);", "highlightLines": [64]}, "category": "code", "location": {"file": "src/test/Selfdestruct.sol", "line": 64, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "bb8988f2ef21", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        AttackerContract = new Attack(EtherGameContract);", "highlightLines": [88]}, "category": "code", "location": {"file": "src/test/Selfdestruct.sol", "line": 88, "column": 28}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "1ed5e579bc63", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(EtherGame _etherGame) {\n        etherGame = EtherGame(_etherGame);\n    }", "highlightLines": [103]}, "category": "code", "location": {"file": "src/test/Selfdestruct.sol", "line": 103, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "14433052e5fd", "fix": {"template": null, "available": false}, "title": "Contract can be destructed by anyone - missing access control on selfdestruct", "ruleId": "rules.sol-accessible-selfdestruct", "snippet": {"code": "        selfdestruct(addr);", "highlightLines": [113]}, "category": "code", "location": {"file": "src/test/Selfdestruct.sol", "line": 113, "column": 9}, "severity": "high", "references": ["https://www.parity.io/blog/a-postmortem-on-the-parity-multi-sig-library-self-destruct/"], "description": ""}, {"id": "844fb746ddb8", "fix": {"template": null, "available": false}, "title": "Selfdestruct with user-controlled recipient - funds can be sent anywhere", "ruleId": "rules.sol-selfdestruct-arbitrary", "snippet": {"code": "        selfdestruct(addr);", "highlightLines": [113]}, "category": "code", "location": {"file": "src/test/Selfdestruct.sol", "line": 113, "column": 9}, "severity": "high", "references": [], "description": ""}, {"id": "e2f1eac83f33", "fix": {"template": null, "available": false}, "title": "selfdestruct can force ETH to any address - contracts cannot prevent receiving ETH this way (Force pattern)", "ruleId": "rules.sol-selfdestruct-force-eth", "snippet": {"code": "        selfdestruct(addr);", "highlightLines": [113]}, "category": "code", "location": {"file": "src/test/Selfdestruct.sol", "line": 113, "column": 9}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/7"], "description": ""}, {"id": "1b831f95d9f2", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.18;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/Selfdestruct2.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "dc396669c2a8", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        ForceContract = new Force();\n        console.log(\"Balance of ForceContract:\", address(ForceContract).balance);\n        AttackerContract = new Attack();", "highlightLines": [16]}, "category": "code", "location": {"file": "src/test/Selfdestruct2.sol", "line": 16, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "0a40becf83ba", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        ForceContract = new Force();", "highlightLines": [16]}, "category": "code", "location": {"file": "src/test/Selfdestruct2.sol", "line": 16, "column": 25}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "17eee18382ab", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        AttackerContract = new Attack();", "highlightLines": [18]}, "category": "code", "location": {"file": "src/test/Selfdestruct2.sol", "line": 18, "column": 28}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "f6a0326e0305", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    receive() external payable {}", "highlightLines": [36]}, "category": "code", "location": {"file": "src/test/Selfdestruct2.sol", "line": 36, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "94776e19dbc5", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "    receive() external payable {}", "highlightLines": [36]}, "category": "code", "location": {"file": "src/test/Selfdestruct2.sol", "line": 36, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "0af8810f0758", "fix": {"template": null, "available": false}, "title": "Selfdestruct with user-controlled recipient - funds can be sent anywhere", "ruleId": "rules.sol-selfdestruct-arbitrary", "snippet": {"code": "        selfdestruct(payable(force));", "highlightLines": [53]}, "category": "code", "location": {"file": "src/test/Selfdestruct2.sol", "line": 53, "column": 9}, "severity": "high", "references": [], "description": ""}, {"id": "bf1d7bb5ed2c", "fix": {"template": null, "available": false}, "title": "Contract can be destructed by anyone - missing access control on selfdestruct", "ruleId": "rules.sol-accessible-selfdestruct", "snippet": {"code": "        selfdestruct(payable(force));", "highlightLines": [53]}, "category": "code", "location": {"file": "src/test/Selfdestruct2.sol", "line": 53, "column": 9}, "severity": "high", "references": ["https://www.parity.io/blog/a-postmortem-on-the-parity-multi-sig-library-self-destruct/"], "description": ""}, {"id": "98526bba6a53", "fix": {"template": null, "available": false}, "title": "selfdestruct can force ETH to any address - contracts cannot prevent receiving ETH this way (Force pattern)", "ruleId": "rules.sol-selfdestruct-force-eth", "snippet": {"code": "        selfdestruct(payable(force));", "highlightLines": [53]}, "category": "code", "location": {"file": "src/test/Selfdestruct2.sol", "line": 53, "column": 9}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/7"], "description": ""}, {"id": "4984412b776c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 amount;", "highlightLines": [20]}, "category": "code", "location": {"file": "src/test/SenseFinance_exp.sol", "line": 20, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ebe49d99e2c7", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 poolId;", "highlightLines": [22]}, "category": "code", "location": {"file": "src/test/SenseFinance_exp.sol", "line": 22, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "97488e7479a9", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 lastChangeBlock;", "highlightLines": [23]}, "category": "code", "location": {"file": "src/test/SenseFinance_exp.sol", "line": 23, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b912d0c3dc82", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address from;", "highlightLines": [24]}, "category": "code", "location": {"file": "src/test/SenseFinance_exp.sol", "line": 24, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a3be03c4ecfe", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address to;", "highlightLines": [25]}, "category": "code", "location": {"file": "src/test/SenseFinance_exp.sol", "line": 25, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3e6ccb48f6bd", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes userData;", "highlightLines": [26]}, "category": "code", "location": {"file": "src/test/SenseFinance_exp.sol", "line": 26, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0dd03e10e6e3", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "            0x3f9fee026fcebb40719a69416c72b714d89a17d900020000000000000000017c,", "highlightLines": [46]}, "category": "code", "location": {"file": "src/test/SenseFinance_exp.sol", "line": 46, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "ea3ccf8a65cb", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.18;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "a62609d05320", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract ContractTest is Test {\n    TokenWhale TokenWhaleContract;\n    SixEyeToken SixEyeTokenContract;\n    address alice = vm.addr(1);\n    address bob = vm.addr(2);", "highlightLines": [27]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 27, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "9fc1331afc33", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address alice = vm.addr(1);", "highlightLines": [30]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 30, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3494db70dea8", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address bob = vm.addr(2);", "highlightLines": [31]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 31, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d6fb32bcec8b", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor() {\n        TokenWhaleContract = new TokenWhale();\n        TokenWhaleContract.TokenWhaleDeploy(address(this));\n        TokenWhaleContract.transfer(alice, 1000);\n        SixEyeTokenContract = new SixEyeToken();\n        SixEyeTokenContract.TokenWhaleDeploy(address(this));\n        SixEyeTokenContract.transfer(alice, 1000);\n    }", "highlightLines": [33]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 33, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "14039fb81f9b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        TokenWhaleContract = new TokenWhale();\n        TokenWhaleContract.TokenWhaleDeploy(address(this));\n        TokenWhaleContract.transfer(alice, 1000);\n        SixEyeTokenContract = new SixEyeToken();", "highlightLines": [34]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 34, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "000f1fc90b82", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        TokenWhaleContract = new TokenWhale();", "highlightLines": [34]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 34, "column": 30}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "45eb26f5773c", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        TokenWhaleContract.transfer(alice, 1000);", "highlightLines": [36]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 36, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "d4e6f4b2172e", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "        TokenWhaleContract.transfer(alice, 1000);", "highlightLines": [36]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 36, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "42968a55dcfe", "fix": {"template": null, "available": false}, "title": "ERC20 transfer() return value not checked - tokens like USDT don't return bool", "ruleId": "rules.sol-erc20-transfer-no-return-check", "snippet": {"code": "        TokenWhaleContract.transfer(alice, 1000);", "highlightLines": [36]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 36, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "1a22a1fd809a", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        SixEyeTokenContract = new SixEyeToken();", "highlightLines": [37]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 37, "column": 31}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "19133d35bc9b", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        SixEyeTokenContract.transfer(alice, 1000);", "highlightLines": [39]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 39, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "80fb89afa86a", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "        SixEyeTokenContract.transfer(alice, 1000);", "highlightLines": [39]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 39, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "fbdb30ece75d", "fix": {"template": null, "available": false}, "title": "ERC20 transfer() return value not checked - tokens like USDT don't return bool", "ruleId": "rules.sol-erc20-transfer-no-return-check", "snippet": {"code": "        SixEyeTokenContract.transfer(alice, 1000);", "highlightLines": [39]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 39, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "6d0ef98a988e", "fix": {"template": null, "available": false}, "title": "address(this) directly in emit - likely wrong address (should use token/handler variable)", "ruleId": "rules.sol-emit-address-this", "snippet": {"code": "        emit log_named_uint(\n            \"Balance\",\n            TokenWhaleContract.balanceOf(address(this))", "highlightLines": [43]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 43, "column": 9}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "57de64db78e4", "fix": {"template": null, "available": false}, "title": "address(this) emitted in event - may emit wrong address (handler vs token confusion)", "ruleId": "rules.sol-address-this-in-event", "snippet": {"code": "        emit log_named_uint(\n            \"Balance\",\n            TokenWhaleContract.balanceOf(address(this))", "highlightLines": [43]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 43, "column": 9}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "cc334defd5b5", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        bytes32 hash = keccak256(", "highlightLines": [47]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 47, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "dbde6edd9e1c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes32 hash = keccak256(\n            abi.encodePacked(\n                address(alice),\n                address(bob),\n                uint256(499),\n                uint256(1),\n                uint256(0)\n            )\n        );\n        emit log_named_bytes32(\"hash\", hash);\n\n        // The {r, s, v} signature can be combined into one 65-byte-long sequence: 32 bytes for r , 32 bytes for s , and one byte for v\n        //r - a point on the secp256k1 elliptic curve (32 bytes)\n        //s - a point on the secp256k1 elliptic curve (32 bytes)\n        //v - recovery id (1 byte)\n\n        (uint8 v, bytes32 r, bytes32 s) = vm.sign(1, hash);", "highlightLines": [48]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 48, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "9073f33fe49e", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        bytes32 hash = keccak256(\n            abi.encodePacked(\n                address(alice),\n                address(bob),\n                uint256(499),\n                uint256(1),\n                uint256(0)\n            )\n        );", "highlightLines": [48]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 48, "column": 24}, "severity": "high", "references": [], "description": ""}, {"id": "f63e492884f4", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "            abi.encodePacked(\n                address(alice),\n                address(bob),\n                uint256(499),\n                uint256(1),\n                uint256(0)\n            )", "highlightLines": [49]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 49, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "18dbe208b57e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        (uint8 v, bytes32 r, bytes32 s) = vm.sign(1, hash);\n        emit log_named_uint(\"v\", v);\n        emit log_named_bytes32(\"r\", r);\n        emit log_named_bytes32(\"s\", s);\n\n        address alice_address = ecrecover(hash, v, r, s);", "highlightLines": [64]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 64, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "aff211aac80b", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        address alice_address = ecrecover(hash, v, r, s);", "highlightLines": [68]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 68, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8af331b8ccc7", "fix": {"template": null, "available": false}, "title": "ecrecover is vulnerable to signature malleability - use OpenZeppelin ECDSA", "ruleId": "rules.sol-ecrecover-malleable", "snippet": {"code": "        address alice_address = ecrecover(hash, v, r, s);", "highlightLines": [69]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 69, "column": 33}, "severity": "medium", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/utils/cryptography/ECDSA.sol"], "description": ""}, {"id": "b3d4bb2bf8ac", "fix": {"template": null, "available": false}, "title": "ecrecover result not checked for zero address - invalid signatures return address(0)", "ruleId": "rules.sol-ethernaut-ecrecover-no-zero-check", "snippet": {"code": "        address alice_address = ecrecover(hash, v, r, s);", "highlightLines": [69]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 69, "column": 33}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-117", "https://swcregistry.io/docs/SWC-122"], "description": ""}, {"id": "5a8c5d548a7b", "fix": {"template": null, "available": false}, "title": "Signature verification without s-value malleability check - signatures can be replayed with modified s", "ruleId": "rules.sol-ethernaut-signature-malleability", "snippet": {"code": "        address alice_address = ecrecover(hash, v, r, s);", "highlightLines": [69]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 69, "column": 33}, "severity": "medium", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/utils/cryptography/ECDSA.sol"], "description": ""}, {"id": "a7bd6b960285", "fix": {"template": null, "available": false}, "title": "ECDSA signature without s-value check - signature malleability possible", "ruleId": "rules.sol-signature-malleability", "snippet": {"code": "        address alice_address = ecrecover(hash, v, r, s);", "highlightLines": [69]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 69, "column": 33}, "severity": "medium", "references": [], "description": ""}, {"id": "bc95a3c0f34b", "fix": {"template": null, "available": false}, "title": "Signature verification without domain separator - cross-contract replay possible", "ruleId": "rules.sol-signature-no-domain-separator", "snippet": {"code": "        address alice_address = ecrecover(hash, v, r, s);", "highlightLines": [69]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 69, "column": 33}, "severity": "medium", "references": [], "description": ""}, {"id": "be9bd6fdf5d9", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract TokenWhale is Test {\n    address player;\n\n    uint256 public totalSupply;\n    mapping(address => uint256) public balanceOf;\n    mapping(address => mapping(address => uint256)) public allowance;\n\n    string public name = \"Simple ERC20 Token\";\n    string public symbol = \"SET\";\n    uint8 public decimals = 18;", "highlightLines": [134]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 134, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "2ea9b459ff4e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address player;", "highlightLines": [135]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 135, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "5fcf53319802", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        player = _player;\n        totalSupply = 2000;", "highlightLines": [147]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 147, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "100f818b98e1", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        totalSupply = 2000;\n        balanceOf[player] = 2000;", "highlightLines": [148]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 148, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "a6cfd063da52", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function transfer(address to, uint256 value) public {", "highlightLines": [157]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 157, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "84da8f7080ad", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without msg.data.length validation - vulnerable to short address attack padding", "ruleId": "rules.sol-short-address-no-payload-check", "snippet": {"code": "    function transfer(address to, uint256 value) public {", "highlightLines": [157]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 157, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address", "https://vessenes.com/the-erc20-short-address-attack-explained/"], "description": ""}, {"id": "9acc3a3f9ca5", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(balanceOf[msg.sender] >= value);", "highlightLines": [158]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 158, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "26b04da53591", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(balanceOf[to] + value >= balanceOf[to]);", "highlightLines": [159]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 159, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "dbdcf0fd3ce8", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "    function transferProxy(\n        address _from,\n        address _to,\n        uint256 _value,\n        uint256 _feeUgt,\n        uint8 _v,\n        bytes32 _r,\n        bytes32 _s\n    ) public returns (bool) {\n        uint256 nonce = nonces[_from];\n        emit log_named_uint(\"nonce\", nonce);\n        bytes32 h = keccak256(\n            abi.encodePacked(_from, _to, _value, _feeUgt, nonce)\n        );\n        if (_from != ecrecover(h, _v, _r, _s)) revert();\n\n        if (\n            balanceOf[_to] + _value < balanceOf[_to] ||\n            balanceOf[msg.sender] + _feeUgt < balanceOf[msg.sender]\n        ) revert();", "highlightLines": [164]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 164, "column": 5}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "71b9737b62b0", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 nonce = nonces[_from];", "highlightLines": [173]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 173, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "476b5a0d0f78", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 nonce = nonces[_from];\n        emit log_named_uint(\"nonce\", nonce);\n        bytes32 h = keccak256(\n            abi.encodePacked(_from, _to, _value, _feeUgt, nonce)\n        );", "highlightLines": [173]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 173, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "4f30e91025c0", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 h = keccak256(", "highlightLines": [175]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 175, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ce6b5d091839", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes32 h = keccak256(\n            abi.encodePacked(_from, _to, _value, _feeUgt, nonce)\n        );\n        if (_from != ecrecover(h, _v, _r, _s)) revert();\n\n        if (\n            balanceOf[_to] + _value < balanceOf[_to] ||\n            balanceOf[msg.sender] + _feeUgt < balanceOf[msg.sender]\n        ) revert();\n        balanceOf[_to] += _value;\n\n        balanceOf[msg.sender] += _feeUgt;\n\n        balanceOf[_from] -= _value + _feeUgt;\n        nonces[_from] = nonce + 1;", "highlightLines": [175]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 175, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d6b68f197ed6", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        bytes32 h = keccak256(\n            abi.encodePacked(_from, _to, _value, _feeUgt, nonce)\n        );", "highlightLines": [175]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 175, "column": 21}, "severity": "high", "references": [], "description": ""}, {"id": "21ac8339f83b", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "            abi.encodePacked(_from, _to, _value, _feeUgt, nonce)", "highlightLines": [176]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 176, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "f99710ab8dbb", "fix": {"template": null, "available": false}, "title": "ECDSA signature without s-value check - signature malleability possible", "ruleId": "rules.sol-signature-malleability", "snippet": {"code": "        if (_from != ecrecover(h, _v, _r, _s)) revert();", "highlightLines": [178]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 178, "column": 22}, "severity": "medium", "references": [], "description": ""}, {"id": "76b0e6f24489", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "        if (_from != ecrecover(h, _v, _r, _s)) revert();\n\n        if (", "highlightLines": [178]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 178, "column": 48}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "68327cd536f1", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "        ) revert();\n        balanceOf[_to] += _value;", "highlightLines": [183]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 183, "column": 11}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "a9885c08547f", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract SixEyeToken is Test {\n    address player;\n\n    uint256 public totalSupply;\n    mapping(address => uint256) public balanceOf;\n    mapping(address => mapping(address => uint256)) public allowance;\n\n    string public name = \"Six Eye Token\";\n    string public symbol = \"SIX\";\n    uint8 public decimals = 18;", "highlightLines": [194]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 194, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "155cd03a96d4", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address player;", "highlightLines": [195]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 195, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a5cafc716769", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        player = _player;\n        totalSupply = 2000;", "highlightLines": [207]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 207, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "10b46f06dd4c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        totalSupply = 2000;\n        balanceOf[player] = 2000;", "highlightLines": [208]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 208, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "0816cf96a7e6", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function transfer(address to, uint256 value) public {", "highlightLines": [217]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 217, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "4ae2d95b344d", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without msg.data.length validation - vulnerable to short address attack padding", "ruleId": "rules.sol-short-address-no-payload-check", "snippet": {"code": "    function transfer(address to, uint256 value) public {", "highlightLines": [217]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 217, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address", "https://vessenes.com/the-erc20-short-address-attack-explained/"], "description": ""}, {"id": "1cdd45d6ac7d", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(balanceOf[msg.sender] >= value);", "highlightLines": [218]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 218, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "469a722e64c9", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(balanceOf[to] + value >= balanceOf[to]);", "highlightLines": [219]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 219, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "91c3c0c9155a", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "    function transferProxy(\n        address _from,\n        address _to,\n        uint256 _value,\n        uint256 _feeUgt,\n        uint8 _v,\n        bytes32 _r,\n        bytes32 _s\n    ) public returns (bool) {\n        uint256 nonce = nonces[_from];\n        bytes32 h = keccak256(\n            abi.encodePacked(_from, _to, _value, _feeUgt, nonce)\n        );\n        if (_from != ecrecover(h, _v, _r, _s)) revert();\n\n        if (\n            balanceOf[_to] + _value < balanceOf[_to] ||\n            balanceOf[msg.sender] + _feeUgt < balanceOf[msg.sender]\n        ) revert();", "highlightLines": [224]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 224, "column": 5}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "d00e6b08db5a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 nonce = nonces[_from];", "highlightLines": [233]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 233, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "060f26e1708a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 nonce = nonces[_from];\n        bytes32 h = keccak256(\n            abi.encodePacked(_from, _to, _value, _feeUgt, nonce)\n        );", "highlightLines": [233]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 233, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "4926051c3a29", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 h = keccak256(", "highlightLines": [234]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 234, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "dffa22acf0bd", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        bytes32 h = keccak256(\n            abi.encodePacked(_from, _to, _value, _feeUgt, nonce)\n        );", "highlightLines": [234]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 234, "column": 21}, "severity": "high", "references": [], "description": ""}, {"id": "e0537f7771a6", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "            abi.encodePacked(_from, _to, _value, _feeUgt, nonce)", "highlightLines": [235]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 235, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "2471469575e5", "fix": {"template": null, "available": false}, "title": "ECDSA signature without s-value check - signature malleability possible", "ruleId": "rules.sol-signature-malleability", "snippet": {"code": "        if (_from != ecrecover(h, _v, _r, _s)) revert();", "highlightLines": [237]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 237, "column": 22}, "severity": "medium", "references": [], "description": ""}, {"id": "ee978793e2fe", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "        if (_from != ecrecover(h, _v, _r, _s)) revert();\n\n        if (", "highlightLines": [237]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 237, "column": 48}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "6bcb543afce5", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "        ) revert();\n        balanceOf[_to] += _value;", "highlightLines": [242]}, "category": "code", "location": {"file": "src/test/SignatureReplay.sol", "line": 242, "column": 11}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "9e0ef4b9aae0", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.18;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/SignatureReplayNBA.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "2b7657e42b39", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool mint_free;", "highlightLines": [17]}, "category": "code", "location": {"file": "src/test/SignatureReplayNBA.sol", "line": 17, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "42ca637638bd", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 max_mint;", "highlightLines": [18]}, "category": "code", "location": {"file": "src/test/SignatureReplayNBA.sol", "line": 18, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ec772d95348e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address from;", "highlightLines": [19]}, "category": "code", "location": {"file": "src/test/SignatureReplayNBA.sol", "line": 19, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4f33fb1ec0b5", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 start;", "highlightLines": [20]}, "category": "code", "location": {"file": "src/test/SignatureReplayNBA.sol", "line": 20, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "16bb628bb5aa", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 end;", "highlightLines": [21]}, "category": "code", "location": {"file": "src/test/SignatureReplayNBA.sol", "line": 21, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7c9c9ab199d9", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 eth_price;", "highlightLines": [22]}, "category": "code", "location": {"file": "src/test/SignatureReplayNBA.sol", "line": 22, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e7dfdb4fda96", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 dust_price;", "highlightLines": [23]}, "category": "code", "location": {"file": "src/test/SignatureReplayNBA.sol", "line": 23, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d371bcdbd19b", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes signature;", "highlightLines": [24]}, "category": "code", "location": {"file": "src/test/SignatureReplayNBA.sol", "line": 24, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "2f8c08fb63a2", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function mint_approved(\n        vData memory info,\n        uint256 number_of_items_requested,\n        uint16 _batchNumber\n    ) external;\n}\n\ncontract ContractTest is Test {\n    NBA NBAContract;\n\n    function testMintNFT() public {\n        NBAContract = new NBA();\n        // Copy any successful signature from etherscan.\n        // https://etherscan.io/tx/0x0555d3d7a9d1d5659cd99c69f15fb88da57307c3970678fb5e6547879bc548a6\n        INBA.vData memory info = INBA.vData({", "highlightLines": [27]}, "category": "code", "location": {"file": "src/test/SignatureReplayNBA.sol", "line": 27, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "cb57e0f2151c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        NBAContract = new NBA();\n        // Copy any successful signature from etherscan.\n        // https://etherscan.io/tx/0x0555d3d7a9d1d5659cd99c69f15fb88da57307c3970678fb5e6547879bc548a6\n        INBA.vData memory info = INBA.vData({\n            mint_free: true,\n            max_mint: 1,\n            from: 0x23Bd1adaB0917A2Ed5007aA39e4040487BE2DAd1,\n            start: 0,\n            end: 5555555555,\n            eth_price: 0,\n            dust_price: 0,\n            signature: hex\"b3589c052ba90e14654d1fac78fb2fd9708355e1a686bed502f65e7ac0a47ad722dcc6c0dcc9445f608162648e000dcc8a845c2ed523202465dc9bdd239484b51b\"\n        });", "highlightLines": [38]}, "category": "code", "location": {"file": "src/test/SignatureReplayNBA.sol", "line": 38, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "1fbeaea3b2fb", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        NBAContract = new NBA();", "highlightLines": [38]}, "category": "code", "location": {"file": "src/test/SignatureReplayNBA.sol", "line": 38, "column": 23}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "3420e47a73c0", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "        // https://etherscan.io/tx/0x0555d3d7a9d1d5659cd99c69f15fb88da57307c3970678fb5e6547879bc548a6", "highlightLines": [40]}, "category": "code", "location": {"file": "src/test/SignatureReplayNBA.sol", "line": 40, "column": 36}, "severity": "high", "references": [], "description": ""}, {"id": "0cd7dc8ba85d", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    receive() external payable {}", "highlightLines": [54]}, "category": "code", "location": {"file": "src/test/SignatureReplayNBA.sol", "line": 54, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "d84b3406b8cd", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "    receive() external payable {}", "highlightLines": [54]}, "category": "code", "location": {"file": "src/test/SignatureReplayNBA.sol", "line": 54, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "faf9795bf122", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract NBA is Test {\n    uint16 public batchNumber;\n\n    address signer = 0x669F499e7BA51836BB76F7dD2bc3C1A37a5342D7;\n    struct vData {\n        bool mint_free;\n        uint256 max_mint;\n        address from;\n        uint256 start;\n        uint256 end;\n        uint256 eth_price;\n        uint256 dust_price;\n        bytes signature;", "highlightLines": [57]}, "category": "code", "location": {"file": "src/test/SignatureReplayNBA.sol", "line": 57, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "48a204554960", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    address signer = 0x669F499e7BA51836BB76F7dD2bc3C1A37a5342D7;", "highlightLines": [59]}, "category": "code", "location": {"file": "src/test/SignatureReplayNBA.sol", "line": 59, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "88c395382a03", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool mint_free;", "highlightLines": [62]}, "category": "code", "location": {"file": "src/test/SignatureReplayNBA.sol", "line": 62, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "5aad8dbeea16", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 max_mint;", "highlightLines": [63]}, "category": "code", "location": {"file": "src/test/SignatureReplayNBA.sol", "line": 63, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "9c21e638b0ab", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address from;", "highlightLines": [64]}, "category": "code", "location": {"file": "src/test/SignatureReplayNBA.sol", "line": 64, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b27e81492f43", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 start;", "highlightLines": [65]}, "category": "code", "location": {"file": "src/test/SignatureReplayNBA.sol", "line": 65, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7eb537640928", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 end;", "highlightLines": [66]}, "category": "code", "location": {"file": "src/test/SignatureReplayNBA.sol", "line": 66, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "281d69c2e924", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 eth_price;", "highlightLines": [67]}, "category": "code", "location": {"file": "src/test/SignatureReplayNBA.sol", "line": 67, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c1931ea460f1", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 dust_price;", "highlightLines": [68]}, "category": "code", "location": {"file": "src/test/SignatureReplayNBA.sol", "line": 68, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "6276878fca09", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes signature;", "highlightLines": [69]}, "category": "code", "location": {"file": "src/test/SignatureReplayNBA.sol", "line": 69, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e1d36a91c312", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function mint_approved(\n        vData memory info,\n        uint256 number_of_items_requested,\n        uint16 _batchNumber\n    ) external view {\n        require(batchNumber == _batchNumber, \"!batch\");\n        // address from = msg.sender;", "highlightLines": [72]}, "category": "code", "location": {"file": "src/test/SignatureReplayNBA.sol", "line": 72, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "9d27f054adb6", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "    function verify(vData memory info) public view returns (bool) {\n        require(info.from != address(0), \"INVALID_SIGNER\");\n        bytes memory cat = abi.encode(\n            info.from,\n            info.start,\n            info.end,\n            info.eth_price,\n            info.dust_price,\n            info.max_mint,\n            info.mint_free\n        );\n        // console.log(\"data-->\");\n        // console.logBytes(cat);\n        bytes32 hash = keccak256(cat);\n        // console.log(\"hash ->\");\n        //    console.logBytes32(hash);\n        require(info.signature.length == 65, \"Invalid signature length\");", "highlightLines": [87]}, "category": "code", "location": {"file": "src/test/SignatureReplayNBA.sol", "line": 87, "column": 5}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "8fd0275d9f2d", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function verify(vData memory info) public view returns (bool) {\n        require(info.from != address(0), \"INVALID_SIGNER\");\n        bytes memory cat = abi.encode(\n            info.from,\n            info.start,\n            info.end,\n            info.eth_price,\n            info.dust_price,\n            info.max_mint,\n            info.mint_free\n        );\n        // console.log(\"data-->\");\n        // console.logBytes(cat);\n        bytes32 hash = keccak256(cat);\n        // console.log(\"hash ->\");\n        //    console.logBytes32(hash);\n        require(info.signature.length == 65, \"Invalid signature length\");\n        bytes32 sigR;\n        bytes32 sigS;\n        uint8 sigV;\n        bytes memory signature = info.signature;", "highlightLines": [87]}, "category": "code", "location": {"file": "src/test/SignatureReplayNBA.sol", "line": 87, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "614d1d287797", "fix": {"template": null, "available": false}, "title": "View/pure function uses assembly - may modify state unexpectedly", "ruleId": "rules.sol-constant-function-assembly", "snippet": {"code": "    function verify(vData memory info) public view returns (bool) {\n        require(info.from != address(0), \"INVALID_SIGNER\");\n        bytes memory cat = abi.encode(\n            info.from,\n            info.start,\n            info.end,\n            info.eth_price,\n            info.dust_price,\n            info.max_mint,\n            info.mint_free\n        );\n        // console.log(\"data-->\");\n        // console.logBytes(cat);\n        bytes32 hash = keccak256(cat);\n        // console.log(\"hash ->\");\n        //    console.logBytes32(hash);\n        require(info.signature.length == 65, \"Invalid signature length\");\n        bytes32 sigR;\n        bytes32 sigS;\n        uint8 sigV;\n        bytes memory signature = info.signature;\n        // ecrecover takes the signature parameters, and the only way to get them\n        // currently is to use assembly.\n        assembly {", "highlightLines": [87]}, "category": "code", "location": {"file": "src/test/SignatureReplayNBA.sol", "line": 87, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-using-assembly-code"], "description": ""}, {"id": "919c7c145a51", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes memory cat = abi.encode(\n            info.from,\n            info.start,\n            info.end,\n            info.eth_price,\n            info.dust_price,\n            info.max_mint,\n            info.mint_free\n        );\n        // console.log(\"data-->\");\n        // console.logBytes(cat);\n        bytes32 hash = keccak256(cat);", "highlightLines": [89]}, "category": "code", "location": {"file": "src/test/SignatureReplayNBA.sol", "line": 89, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d350d90a617d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 hash = keccak256(cat);", "highlightLines": [100]}, "category": "code", "location": {"file": "src/test/SignatureReplayNBA.sol", "line": 100, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "5d4118d0afad", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes32 hash = keccak256(cat);\n        // console.log(\"hash ->\");\n        //    console.logBytes32(hash);\n        require(info.signature.length == 65, \"Invalid signature length\");\n        bytes32 sigR;\n        bytes32 sigS;\n        uint8 sigV;\n        bytes memory signature = info.signature;", "highlightLines": [100]}, "category": "code", "location": {"file": "src/test/SignatureReplayNBA.sol", "line": 100, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "3fe1ad14add2", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 sigR;", "highlightLines": [104]}, "category": "code", "location": {"file": "src/test/SignatureReplayNBA.sol", "line": 104, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "2f1fedf36d84", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 sigS;", "highlightLines": [105]}, "category": "code", "location": {"file": "src/test/SignatureReplayNBA.sol", "line": 105, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0e9d0a4ff204", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint8 sigV;", "highlightLines": [106]}, "category": "code", "location": {"file": "src/test/SignatureReplayNBA.sol", "line": 106, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "82e644326154", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes memory signature = info.signature;\n        // ecrecover takes the signature parameters, and the only way to get them\n        // currently is to use assembly.\n        assembly {\n            sigR := mload(add(signature, 0x20))\n            sigS := mload(add(signature, 0x40))\n            sigV := byte(0, mload(add(signature, 0x60)))\n        }", "highlightLines": [107]}, "category": "code", "location": {"file": "src/test/SignatureReplayNBA.sol", "line": 107, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "de6263a92dce", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [110]}, "category": "code", "location": {"file": "src/test/SignatureReplayNBA.sol", "line": 110, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "e580b9fcfa9c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            sigR := mload(add(signature, 0x20))\n            sigS := mload(add(signature, 0x40))", "highlightLines": [111]}, "category": "code", "location": {"file": "src/test/SignatureReplayNBA.sol", "line": 111, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "45429646fa31", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            sigS := mload(add(signature, 0x40))\n            sigV := byte(0, mload(add(signature, 0x60)))", "highlightLines": [112]}, "category": "code", "location": {"file": "src/test/SignatureReplayNBA.sol", "line": 112, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "20edbce42051", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        bytes32 data = keccak256(", "highlightLines": [115]}, "category": "code", "location": {"file": "src/test/SignatureReplayNBA.sol", "line": 115, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "168929c58a1f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes32 data = keccak256(\n            abi.encodePacked(\"\\x19Ethereum Signed Message:\\n32\", hash)\n        );\n        address recovered = ecrecover(data, sigV, sigR, sigS);", "highlightLines": [116]}, "category": "code", "location": {"file": "src/test/SignatureReplayNBA.sol", "line": 116, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e949b1761541", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        bytes32 data = keccak256(\n            abi.encodePacked(\"\\x19Ethereum Signed Message:\\n32\", hash)\n        );", "highlightLines": [116]}, "category": "code", "location": {"file": "src/test/SignatureReplayNBA.sol", "line": 116, "column": 24}, "severity": "high", "references": [], "description": ""}, {"id": "45aedc0630d3", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "            abi.encodePacked(\"\\x19Ethereum Signed Message:\\n32\", hash)", "highlightLines": [117]}, "category": "code", "location": {"file": "src/test/SignatureReplayNBA.sol", "line": 117, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "9cbdc6f258a0", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address recovered = ecrecover(data, sigV, sigR, sigS);", "highlightLines": [119]}, "category": "code", "location": {"file": "src/test/SignatureReplayNBA.sol", "line": 119, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "05b62769ffa2", "fix": {"template": null, "available": false}, "title": "ecrecover is vulnerable to signature malleability - use OpenZeppelin ECDSA", "ruleId": "rules.sol-ecrecover-malleable", "snippet": {"code": "        address recovered = ecrecover(data, sigV, sigR, sigS);", "highlightLines": [119]}, "category": "code", "location": {"file": "src/test/SignatureReplayNBA.sol", "line": 119, "column": 29}, "severity": "medium", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/utils/cryptography/ECDSA.sol"], "description": ""}, {"id": "ccad27509053", "fix": {"template": null, "available": false}, "title": "ecrecover result not checked for zero address - invalid signatures return address(0)", "ruleId": "rules.sol-ethernaut-ecrecover-no-zero-check", "snippet": {"code": "        address recovered = ecrecover(data, sigV, sigR, sigS);", "highlightLines": [119]}, "category": "code", "location": {"file": "src/test/SignatureReplayNBA.sol", "line": 119, "column": 29}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-117", "https://swcregistry.io/docs/SWC-122"], "description": ""}, {"id": "8db75c019e4d", "fix": {"template": null, "available": false}, "title": "Signature verification without s-value malleability check - signatures can be replayed with modified s", "ruleId": "rules.sol-ethernaut-signature-malleability", "snippet": {"code": "        address recovered = ecrecover(data, sigV, sigR, sigS);", "highlightLines": [119]}, "category": "code", "location": {"file": "src/test/SignatureReplayNBA.sol", "line": 119, "column": 29}, "severity": "medium", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/utils/cryptography/ECDSA.sol"], "description": ""}, {"id": "3041a3bd7006", "fix": {"template": null, "available": false}, "title": "ECDSA signature without s-value check - signature malleability possible", "ruleId": "rules.sol-signature-malleability", "snippet": {"code": "        address recovered = ecrecover(data, sigV, sigR, sigS);", "highlightLines": [119]}, "category": "code", "location": {"file": "src/test/SignatureReplayNBA.sol", "line": 119, "column": 29}, "severity": "medium", "references": [], "description": ""}, {"id": "54d86eb3388f", "fix": {"template": null, "available": false}, "title": "Signature verification without domain separator - cross-contract replay possible", "ruleId": "rules.sol-signature-no-domain-separator", "snippet": {"code": "        address recovered = ecrecover(data, sigV, sigR, sigS);", "highlightLines": [119]}, "category": "code", "location": {"file": "src/test/SignatureReplayNBA.sol", "line": 119, "column": 29}, "severity": "medium", "references": [], "description": ""}, {"id": "64013750b5d4", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.18;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/Slippage-deadline.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "bdb67b5bf8cd", "fix": {"template": null, "available": false}, "title": "Swap/liquidity operation without deadline parameter - transaction can be delayed indefinitely", "ruleId": "rules.sol-missing-deadline-check", "snippet": {"code": "    function swapExactTokensForTokens(\n        uint256 amountIn,\n        uint256 amountOutMin,\n        address[] calldata path,\n        address to,\n        uint256 deadline\n    ) external returns (uint256[] memory amounts);\n}\n\ninterface IWETH {", "highlightLines": [29]}, "category": "code", "location": {"file": "src/test/Slippage-deadline.sol", "line": 29, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "e268de37b836", "fix": {"template": null, "available": false}, "title": "Token swap/buy without slippage protection - MEV/sandwich attack risk", "ruleId": "rules.sol-missing-slippage-protection", "snippet": {"code": "    function swapExactTokensForTokens(\n        uint256 amountIn,\n        uint256 amountOutMin,\n        address[] calldata path,\n        address to,\n        uint256 deadline\n    ) external returns (uint256[] memory amounts);\n}\n\ninterface IWETH {", "highlightLines": [29]}, "category": "code", "location": {"file": "src/test/Slippage-deadline.sol", "line": 29, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "313551ed46b8", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function deposit() external payable;\n\n    function approve(address guy, uint256 wad) external returns (bool);\n\n    function withdraw(uint256 wad) external;\n}\n\ncontract ContractTest is Test {", "highlightLines": [39]}, "category": "code", "location": {"file": "src/test/Slippage-deadline.sol", "line": 39, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "6aa1849660bd", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function approve(address guy, uint256 wad) external returns (bool);", "highlightLines": [41]}, "category": "code", "location": {"file": "src/test/Slippage-deadline.sol", "line": 41, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "1f16d37f5e3d", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function approve(address guy, uint256 wad) external returns (bool);\n\n    function withdraw(uint256 wad) external;\n}\n\ncontract ContractTest is Test {", "highlightLines": [41]}, "category": "code", "location": {"file": "src/test/Slippage-deadline.sol", "line": 41, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "b1a940c6522a", "fix": {"template": null, "available": false}, "title": "Function accepts zero amount without validation - can cause division by zero or empty operations", "ruleId": "rules.sol-missing-zero-amount-check", "snippet": {"code": "    function withdraw(uint256 wad) external;\n}\n\ncontract ContractTest is Test {", "highlightLines": [43]}, "category": "code", "location": {"file": "src/test/Slippage-deadline.sol", "line": 43, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "df8dbaf5ab0d", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract ContractTest is Test {\n    address UNISWAP_ROUTER = 0x7a250d5630B4cF539739dF2C5dAcb4c659F2488D; // Uniswap Router address on Ethereum Mainnet\n    IWETH WETH = IWETH(0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2);\n    address USDT = 0xdAC17F958D2ee523a2206206994597C13D831ec7;", "highlightLines": [46]}, "category": "code", "location": {"file": "src/test/Slippage-deadline.sol", "line": 46, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "3f6652c7a796", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address UNISWAP_ROUTER = 0x7a250d5630B4cF539739dF2C5dAcb4c659F2488D; // Uniswap Router address on Ethereum Mainnet", "highlightLines": [47]}, "category": "code", "location": {"file": "src/test/Slippage-deadline.sol", "line": 47, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e242d2573099", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address USDT = 0xdAC17F958D2ee523a2206206994597C13D831ec7;", "highlightLines": [49]}, "category": "code", "location": {"file": "src/test/Slippage-deadline.sol", "line": 49, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7e1a3036f56a", "fix": {"template": null, "available": false}, "title": "Unlimited token approval - use exact amount needed", "ruleId": "rules.sol-approve-max", "snippet": {"code": "        WETH.approve(address(UNISWAP_ROUTER), type(uint256).max);", "highlightLines": [56]}, "category": "code", "location": {"file": "src/test/Slippage-deadline.sol", "line": 56, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "d48c6948fd4f", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        WETH.approve(address(UNISWAP_ROUTER), type(uint256).max);", "highlightLines": [56]}, "category": "code", "location": {"file": "src/test/Slippage-deadline.sol", "line": 56, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "549bdfbd5297", "fix": {"template": null, "available": false}, "title": "Unlimited token approval (type(uint256).max) - user loses control of all tokens", "ruleId": "rules.sol-approval-scam-max-uint", "snippet": {"code": "        WETH.approve(address(UNISWAP_ROUTER), type(uint256).max);", "highlightLines": [56]}, "category": "code", "location": {"file": "src/test/Slippage-deadline.sol", "line": 56, "column": 13}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/ApproveScam.sol"], "description": ""}, {"id": "932d9c26831d", "fix": {"template": null, "available": false}, "title": "Unlimited token approval using type(uint256).max - consider limited approvals", "ruleId": "rules.sol-unlimited-approval-type-max", "snippet": {"code": "        WETH.approve(address(UNISWAP_ROUTER), type(uint256).max);", "highlightLines": [56]}, "category": "code", "location": {"file": "src/test/Slippage-deadline.sol", "line": 56, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "136e14d71ef1", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 amountIn = 1 ether;", "highlightLines": [58]}, "category": "code", "location": {"file": "src/test/Slippage-deadline.sol", "line": 58, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d3b8f79b8fc7", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 amountIn = 1 ether;\n        uint256 amountOutMin = 0;", "highlightLines": [59]}, "category": "code", "location": {"file": "src/test/Slippage-deadline.sol", "line": 59, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e865ae1f2698", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 amountOutMin = 0;", "highlightLines": [60]}, "category": "code", "location": {"file": "src/test/Slippage-deadline.sol", "line": 60, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "2e5f3eccd8a2", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 amountOutMin = 0;\n        //uint256 amountOutMin = 1867363899; //1867363899 INSUFFICIENT_OUTPUT_AMOUNT\n        // Path for swapping ETH to USDT\n        address[] memory path = new address[](2);", "highlightLines": [60]}, "category": "code", "location": {"file": "src/test/Slippage-deadline.sol", "line": 60, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "4f754b390755", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address[] memory path = new address[](2);\n        path[0] = address(WETH); // WETH (Wrapped Ether)", "highlightLines": [63]}, "category": "code", "location": {"file": "src/test/Slippage-deadline.sol", "line": 63, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "9b896c012ece", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        address[] memory path = new address[](2);", "highlightLines": [63]}, "category": "code", "location": {"file": "src/test/Slippage-deadline.sol", "line": 63, "column": 33}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "680a6cf6b3ab", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        path[0] = address(WETH); // WETH (Wrapped Ether)\n        path[1] = USDT; // USDT (Tether)", "highlightLines": [64]}, "category": "code", "location": {"file": "src/test/Slippage-deadline.sol", "line": 64, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "ef640c0940cf", "fix": {"template": null, "available": false}, "title": "Hardcoded deadline in swap - use block.timestamp + buffer", "ruleId": "rules.sol-hardcoded-deadline", "snippet": {"code": "        IUniswapV2Router02(UNISWAP_ROUTER).swapExactTokensForTokens(\n            amountIn,\n            amountOutMin,\n            path,\n            address(this),\n            type(uint256).max // Setting deadline to max value\n        );", "highlightLines": [70]}, "category": "code", "location": {"file": "src/test/Slippage-deadline.sol", "line": 70, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "49f28782e8c2", "fix": {"template": null, "available": false}, "title": "Swap output sent to contract address - tokens can be rescued by others", "ruleId": "rules.sol-swap-output-to-contract", "snippet": {"code": "        IUniswapV2Router02(UNISWAP_ROUTER).swapExactTokensForTokens(\n            amountIn,\n            amountOutMin,\n            path,\n            address(this),", "highlightLines": [70]}, "category": "code", "location": {"file": "src/test/Slippage-deadline.sol", "line": 70, "column": 44}, "severity": "medium", "references": [], "description": ""}, {"id": "43c934b3a18f", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    receive() external payable {}", "highlightLines": [81]}, "category": "code", "location": {"file": "src/test/Slippage-deadline.sol", "line": 81, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "cde92dc39cca", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "    receive() external payable {}", "highlightLines": [81]}, "category": "code", "location": {"file": "src/test/Slippage-deadline.sol", "line": 81, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "a68f5666e0b1", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.18;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/Storage-collision-audio.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "bb10cc8d4bb2", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function getguardianAddress() external returns (address);\n\n    function getproxyAdmin() external returns (address);\n\n    function initialize(address) external;\n\n    function getinitializing() external returns (bool);\n\n    function getinitialized() external returns (bool);\n\n    function isConstructor() external view returns (bool);\n}\n\ncontract ContractTest is Test {\n    Logic LogicContract;\n    TestProxy ProxyContract;\n\n    function testStorageCollision() public {\n        LogicContract = new Logic();\n        ProxyContract = new TestProxy(", "highlightLines": [11]}, "category": "code", "location": {"file": "src/test/Storage-collision-audio.sol", "line": 11, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "197a53ee1379", "fix": {"template": null, "available": false}, "title": "Initialization function can be front-run - use initializer modifier or constructor", "ruleId": "rules.sol-initialization-frontrun", "snippet": {"code": "    function initialize(address) external;", "highlightLines": [15]}, "category": "code", "location": {"file": "src/test/Storage-collision-audio.sol", "line": 15, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "f4cba57fd4c3", "fix": {"template": null, "available": false}, "title": "Clone/minimal proxy initializer without protection - can be front-run and hijacked", "ruleId": "rules.sol-unprotected-clone-initializer", "snippet": {"code": "    function initialize(address) external;", "highlightLines": [15]}, "category": "code", "location": {"file": "src/test/Storage-collision-audio.sol", "line": 15, "column": 5}, "severity": "high", "references": ["https://blog.openzeppelin.com/security-advisory-initialize-uups-implementation-contracts"], "description": ""}, {"id": "536479b4b3ea", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LogicContract = new Logic();\n        ProxyContract = new TestProxy(\n            address(LogicContract),\n            address(msg.sender),\n            address(this)\n        );", "highlightLines": [29]}, "category": "code", "location": {"file": "src/test/Storage-collision-audio.sol", "line": 29, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "91dfd884173e", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        LogicContract = new Logic();", "highlightLines": [29]}, "category": "code", "location": {"file": "src/test/Storage-collision-audio.sol", "line": 29, "column": 25}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "5bf8ca1bf849", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        ProxyContract = new TestProxy(\n            address(LogicContract),\n            address(msg.sender),\n            address(this)\n        );", "highlightLines": [30]}, "category": "code", "location": {"file": "src/test/Storage-collision-audio.sol", "line": 30, "column": 25}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "fe1e4da2d154", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    receive() external payable {}", "highlightLines": [73]}, "category": "code", "location": {"file": "src/test/Storage-collision-audio.sol", "line": 73, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "92f486019e6b", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "    receive() external payable {}", "highlightLines": [73]}, "category": "code", "location": {"file": "src/test/Storage-collision-audio.sol", "line": 73, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "e64bddfc6844", "fix": {"template": null, "available": false}, "title": "Upgradeable contract without storage gap - adding variables in parent will corrupt child storage", "ruleId": "rules.sol-missing-storage-gap", "snippet": {"code": "contract TestProxy is TransparentUpgradeableProxy {", "highlightLines": [76]}, "category": "code", "location": {"file": "src/test/Storage-collision-audio.sol", "line": 76, "column": 1}, "severity": "medium", "references": ["https://docs.openzeppelin.com/upgrades-plugins/writing-upgradeable"], "description": ""}, {"id": "9457473b08d3", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract TestProxy is TransparentUpgradeableProxy {\n    address private proxyAdmin; // slot 0 - storage collision here", "highlightLines": [76]}, "category": "code", "location": {"file": "src/test/Storage-collision-audio.sol", "line": 76, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "fe2340adabfe", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(\n        address _logic,\n        address _admin,\n        address guardianAddress\n    )\n        TransparentUpgradeableProxy(\n            _logic,\n            _admin,\n            abi.encodeWithSelector(\n                bytes4(0xc4d66de8), // bytes4(keccak256(\"initialize(address)\"))\n                guardianAddress\n            )\n        )\n    {\n        proxyAdmin = _admin;\n    }", "highlightLines": [79]}, "category": "code", "location": {"file": "src/test/Storage-collision-audio.sol", "line": 79, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "cc6510ebd25c", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier initializer() {\n        require(\n            initializing || isConstructor() || !initialized,\n            \"Contract instance has already been initialized\"\n        );\n\n        bool isTopLevelCall = !initializing;\n        if (isTopLevelCall) {\n            initializing = true;\n            initialized = true;\n        }\n\n        _;\n\n        if (isTopLevelCall) {\n            initializing = false;\n        }\n    }", "highlightLines": [111]}, "category": "code", "location": {"file": "src/test/Storage-collision-audio.sol", "line": 111, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "a896063ac32d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        bool isTopLevelCall = !initializing;", "highlightLines": [116]}, "category": "code", "location": {"file": "src/test/Storage-collision-audio.sol", "line": 116, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "2f602beced55", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bool isTopLevelCall = !initializing;\n        if (isTopLevelCall) {\n            initializing = true;\n            initialized = true;\n        }", "highlightLines": [117]}, "category": "code", "location": {"file": "src/test/Storage-collision-audio.sol", "line": 117, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "74b11f88d554", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            initializing = true;\n            initialized = true;", "highlightLines": [119]}, "category": "code", "location": {"file": "src/test/Storage-collision-audio.sol", "line": 119, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "83a0f6c9f53a", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "\n        _;", "highlightLines": [122]}, "category": "code", "location": {"file": "src/test/Storage-collision-audio.sol", "line": 122, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "7a1d744dd6ac", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function isConstructor() private view returns (bool) {\n        // extcodesize checks the size of the code stored in an address, and\n        // address returns the current address. Since the code is still not\n        // deployed when running a constructor, any checks on its code size will\n        // yield zero, making it an effective way to detect if a contract is\n        // under construction or not.\n        address self = address(this);", "highlightLines": [131]}, "category": "code", "location": {"file": "src/test/Storage-collision-audio.sol", "line": 131, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "4665167192ad", "fix": {"template": null, "available": false}, "title": "View/pure function uses assembly - may modify state unexpectedly", "ruleId": "rules.sol-constant-function-assembly", "snippet": {"code": "    function isConstructor() private view returns (bool) {\n        // extcodesize checks the size of the code stored in an address, and\n        // address returns the current address. Since the code is still not\n        // deployed when running a constructor, any checks on its code size will\n        // yield zero, making it an effective way to detect if a contract is\n        // under construction or not.\n        address self = address(this);\n        uint256 cs;\n        assembly {", "highlightLines": [131]}, "category": "code", "location": {"file": "src/test/Storage-collision-audio.sol", "line": 131, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-using-assembly-code"], "description": ""}, {"id": "fc11ee7f8f93", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address self = address(this);", "highlightLines": [137]}, "category": "code", "location": {"file": "src/test/Storage-collision-audio.sol", "line": 137, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "782d8f3e2b9f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address self = address(this);\n        uint256 cs;\n        assembly {\n            cs := extcodesize(self)\n        }", "highlightLines": [137]}, "category": "code", "location": {"file": "src/test/Storage-collision-audio.sol", "line": 137, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d62c159e95b7", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 cs;", "highlightLines": [138]}, "category": "code", "location": {"file": "src/test/Storage-collision-audio.sol", "line": 138, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a71d3a15c515", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [139]}, "category": "code", "location": {"file": "src/test/Storage-collision-audio.sol", "line": 139, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "528c19348d9a", "fix": {"template": null, "available": false}, "title": "isContract check can be bypassed by calling from constructor - extcodesize is 0 during construction", "ruleId": "rules.sol-ethernaut-iscontract-bypass", "snippet": {"code": "        assembly {\n            cs := extcodesize(self)\n        }", "highlightLines": [139]}, "category": "code", "location": {"file": "src/test/Storage-collision-audio.sol", "line": 139, "column": 9}, "severity": "high", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2943"], "description": ""}, {"id": "d939ecc360b7", "fix": {"template": null, "available": false}, "title": "extcodesize check can be bypassed during constructor - contracts have size 0 while being created", "ruleId": "rules.sol-extcodesize-check", "snippet": {"code": "            cs := extcodesize(self)", "highlightLines": [140]}, "category": "code", "location": {"file": "src/test/Storage-collision-audio.sol", "line": 140, "column": 19}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/18"], "description": ""}, {"id": "a3402beadc76", "fix": {"template": null, "available": false}, "title": "Upgradeable contract without storage gap - future upgrade collision risk", "ruleId": "rules.sol-no-gap-storage", "snippet": {"code": "contract Logic is Initializable {", "highlightLines": [157]}, "category": "code", "location": {"file": "src/test/Storage-collision-audio.sol", "line": 157, "column": 1}, "severity": "info", "references": ["https://docs.openzeppelin.com/contracts/4.x/upgradeable#storage_gaps"], "description": ""}, {"id": "53e6c2b7bb19", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract Logic is Initializable {\n    address private guardianAddress;", "highlightLines": [157]}, "category": "code", "location": {"file": "src/test/Storage-collision-audio.sol", "line": 157, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "32fec6764e49", "fix": {"template": null, "available": false}, "title": "Initializer function not protected - can be called multiple times", "ruleId": "rules.sol-initializer-not-protected", "snippet": {"code": "    function initialize(address _guardianAddress) public initializer {", "highlightLines": [160]}, "category": "code", "location": {"file": "src/test/Storage-collision-audio.sol", "line": 160, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "480721b6b37a", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.18;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/Storage-collision.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "6cfe54570979", "fix": {"template": null, "available": false}, "title": "Potential mnemonic seed phrase detected - CRITICAL if real", "ruleId": "rules._shared.shared-mnemonic-phrase", "snippet": {"code": "The vulnerability is that both the Proxy and Logic contracts use the same storage slot (slot 0) to store important variables,", "highlightLines": [10]}, "category": "code", "location": {"file": "src/test/Storage-collision.sol", "line": 10, "column": 11}, "severity": "high", "references": [], "description": ""}, {"id": "9443d7fa3178", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LogicContract = new Logic();\n        ProxyContract = new Proxy(address(LogicContract));", "highlightLines": [28]}, "category": "code", "location": {"file": "src/test/Storage-collision.sol", "line": 28, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "8dbd7bd3e519", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        LogicContract = new Logic();", "highlightLines": [28]}, "category": "code", "location": {"file": "src/test/Storage-collision.sol", "line": 28, "column": 25}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "ae5ba186766c", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        ProxyContract = new Proxy(address(LogicContract));", "highlightLines": [29]}, "category": "code", "location": {"file": "src/test/Storage-collision.sol", "line": 29, "column": 25}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "6c5ec5fc9d3a", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    receive() external payable {}", "highlightLines": [43]}, "category": "code", "location": {"file": "src/test/Storage-collision.sol", "line": 43, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "4d8142e3210a", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "    receive() external payable {}", "highlightLines": [43]}, "category": "code", "location": {"file": "src/test/Storage-collision.sol", "line": 43, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "113bc86b2888", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(address _implementation) {\n        implementation = _implementation;\n    }", "highlightLines": [49]}, "category": "code", "location": {"file": "src/test/Storage-collision.sol", "line": 49, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "57e3c174aa04", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool success;", "highlightLines": [54]}, "category": "code", "location": {"file": "src/test/Storage-collision.sol", "line": 54, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "55c3b523dd9f", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "        (success, ) = implementation.delegatecall(\n            abi.encodeWithSignature(\"foo(address)\", address(this))", "highlightLines": [55]}, "category": "code", "location": {"file": "src/test/Storage-collision.sol", "line": 55, "column": 23}, "severity": "medium", "references": [], "description": ""}, {"id": "07024b61b8e6", "fix": {"template": null, "available": false}, "title": "Delegatecall with user-controlled data - storage slot collision possible", "ruleId": "rules.sol-arbitrary-delegatecall-data", "snippet": {"code": "        (success, ) = implementation.delegatecall(\n            abi.encodeWithSignature(\"foo(address)\", address(this))", "highlightLines": [55]}, "category": "code", "location": {"file": "src/test/Storage-collision.sol", "line": 55, "column": 37}, "severity": "high", "references": [], "description": ""}, {"id": "55a9430c21ba", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor() {\n        GuestAddress = address(0x0);\n    }", "highlightLines": [64]}, "category": "code", "location": {"file": "src/test/Storage-collision.sol", "line": 64, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "251dd6180b09", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.18;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/Struct-deletion.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "ecc250584fa8", "fix": {"template": null, "available": false}, "title": "Deleting mapping inside struct leaves nested data - use separate mapping deletion", "ruleId": "rules.sol-mapping-deletion", "snippet": {"code": "When delete  myStructs[structId] is called,", "highlightLines": [15]}, "category": "code", "location": {"file": "src/test/Struct-deletion.sol", "line": 15, "column": 6}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#deletion-on-mapping-containing-a-structure"], "description": ""}, {"id": "cb9686d4d231", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        StructDeletionBugContract = new StructDeletionBug();\n        FixedStructDeletionContract = new FixedStructDeletion();", "highlightLines": [34]}, "category": "code", "location": {"file": "src/test/Struct-deletion.sol", "line": 34, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "f9d1165a8e37", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        StructDeletionBugContract = new StructDeletionBug();", "highlightLines": [34]}, "category": "code", "location": {"file": "src/test/Struct-deletion.sol", "line": 34, "column": 37}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "0c933b8d46a1", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        FixedStructDeletionContract = new FixedStructDeletion();", "highlightLines": [35]}, "category": "code", "location": {"file": "src/test/Struct-deletion.sol", "line": 35, "column": 39}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "9d74d0902ec6", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    receive() external payable {}", "highlightLines": [52]}, "category": "code", "location": {"file": "src/test/Struct-deletion.sol", "line": 52, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "621eb8dc969f", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "    receive() external payable {}", "highlightLines": [52]}, "category": "code", "location": {"file": "src/test/Struct-deletion.sol", "line": 52, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "7d6d95bfd299", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 id;", "highlightLines": [57]}, "category": "code", "location": {"file": "src/test/Struct-deletion.sol", "line": 57, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "1c131e9adf25", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        MyStruct storage newStruct = myStructs[structId];\n        newStruct.id = structId;", "highlightLines": [64]}, "category": "code", "location": {"file": "src/test/Struct-deletion.sol", "line": 64, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "73901295f8a0", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        newStruct.id = structId;\n        newStruct.flags[flagKeys] = true;", "highlightLines": [65]}, "category": "code", "location": {"file": "src/test/Struct-deletion.sol", "line": 65, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "529f9c8d616d", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function getStruct(\n        uint256 structId,\n        uint256 flagKeys\n    ) public view returns (uint256, bool) {\n        MyStruct storage myStruct = myStructs[structId];\n        bool keys = myStruct.flags[flagKeys];", "highlightLines": [69]}, "category": "code", "location": {"file": "src/test/Struct-deletion.sol", "line": 69, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "8fc9b6cb3fe8", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        MyStruct storage myStruct = myStructs[structId];\n        bool keys = myStruct.flags[flagKeys];", "highlightLines": [73]}, "category": "code", "location": {"file": "src/test/Struct-deletion.sol", "line": 73, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "13b2c408a31c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool keys = myStruct.flags[flagKeys];", "highlightLines": [74]}, "category": "code", "location": {"file": "src/test/Struct-deletion.sol", "line": 74, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b07624fdee9a", "fix": {"template": null, "available": false}, "title": "Deleting mapping inside struct leaves nested data - use separate mapping deletion", "ruleId": "rules.sol-mapping-deletion", "snippet": {"code": "        delete myStructs[structId];", "highlightLines": [80]}, "category": "code", "location": {"file": "src/test/Struct-deletion.sol", "line": 80, "column": 9}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#deletion-on-mapping-containing-a-structure"], "description": ""}, {"id": "7b42aa607879", "fix": {"template": null, "available": false}, "title": "delete array[i] leaves gap with zero value - use swap-and-pop pattern instead", "ruleId": "rules.sol-array-element-delete", "snippet": {"code": "        delete myStructs[structId];", "highlightLines": [80]}, "category": "code", "location": {"file": "src/test/Struct-deletion.sol", "line": 80, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/Array-deletion.sol"], "description": ""}, {"id": "db854ad74218", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 id;", "highlightLines": [86]}, "category": "code", "location": {"file": "src/test/Struct-deletion.sol", "line": 86, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e54d192c6c89", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        MyStruct storage newStruct = myStructs[structId];\n        newStruct.id = structId;", "highlightLines": [93]}, "category": "code", "location": {"file": "src/test/Struct-deletion.sol", "line": 93, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "fea29830a48d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        newStruct.id = structId;\n        newStruct.flags[flagKeys] = true;", "highlightLines": [94]}, "category": "code", "location": {"file": "src/test/Struct-deletion.sol", "line": 94, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "8cb4fde43e8e", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function getStruct(\n        uint256 structId,\n        uint256 flagKeys\n    ) public view returns (uint256, bool) {\n        MyStruct storage myStruct = myStructs[structId];\n        bool keys = myStruct.flags[flagKeys];", "highlightLines": [98]}, "category": "code", "location": {"file": "src/test/Struct-deletion.sol", "line": 98, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "beabb6514755", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        MyStruct storage myStruct = myStructs[structId];\n        bool keys = myStruct.flags[flagKeys];", "highlightLines": [102]}, "category": "code", "location": {"file": "src/test/Struct-deletion.sol", "line": 102, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "8599e9a3d528", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool keys = myStruct.flags[flagKeys];", "highlightLines": [103]}, "category": "code", "location": {"file": "src/test/Struct-deletion.sol", "line": 103, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "5d99e76d659e", "fix": {"template": null, "available": false}, "title": "Deleting mapping inside struct leaves nested data - use separate mapping deletion", "ruleId": "rules.sol-mapping-deletion", "snippet": {"code": "        delete myStructs[structId];", "highlightLines": [113]}, "category": "code", "location": {"file": "src/test/Struct-deletion.sol", "line": 113, "column": 9}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#deletion-on-mapping-containing-a-structure"], "description": ""}, {"id": "f321d032553e", "fix": {"template": null, "available": false}, "title": "delete array[i] leaves gap with zero value - use swap-and-pop pattern instead", "ruleId": "rules.sol-array-element-delete", "snippet": {"code": "        delete myStructs[structId];", "highlightLines": [113]}, "category": "code", "location": {"file": "src/test/Struct-deletion.sol", "line": 113, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/Array-deletion.sol"], "description": ""}, {"id": "311890430deb", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.24;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/TransientStorageMisuse.t.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "cdce344bfc7e", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function mint(uint256 amountToDeposit) external returns (uint256) {", "highlightLines": [16]}, "category": "code", "location": {"file": "src/test/TransientStorageMisuse.t.sol", "line": 16, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "4e5a9d62451f", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function mint(uint256 amountToDeposit) external returns (uint256) {", "highlightLines": [16]}, "category": "code", "location": {"file": "src/test/TransientStorageMisuse.t.sol", "line": 16, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "7c655bb004e5", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address vault = address(this);", "highlightLines": [18]}, "category": "code", "location": {"file": "src/test/TransientStorageMisuse.t.sol", "line": 18, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "507a87cb70ce", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [19]}, "category": "code", "location": {"file": "src/test/TransientStorageMisuse.t.sol", "line": 19, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "dff1f6f0ed8b", "fix": {"template": null, "available": false}, "title": "Transient storage used for unlock state - verify proper access control", "ruleId": "rules.sol-ethernaut-transient-storage-unlock", "snippet": {"code": "            tstore(1, vault)", "highlightLines": [20]}, "category": "code", "location": {"file": "src/test/TransientStorageMisuse.t.sol", "line": 20, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "b6fa3d700451", "fix": {"template": null, "available": false}, "title": "Callback handler doesn't update status - repeated callbacks possible", "ruleId": "rules.sol-callback-no-status-update", "snippet": {"code": "    function SwapCallback(uint256 amount ,bytes calldata data) external {", "highlightLines": [29]}, "category": "code", "location": {"file": "src/test/TransientStorageMisuse.t.sol", "line": 29, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "5cc113c032a2", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address vault;", "highlightLines": [31]}, "category": "code", "location": {"file": "src/test/TransientStorageMisuse.t.sol", "line": 31, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "978d16149aa0", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [32]}, "category": "code", "location": {"file": "src/test/TransientStorageMisuse.t.sol", "line": 32, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "0eeba18bae24", "fix": {"template": null, "available": false}, "title": "Transient storage used for unlock state - verify proper access control", "ruleId": "rules.sol-ethernaut-transient-storage-unlock", "snippet": {"code": "            vault := tload(1)", "highlightLines": [33]}, "category": "code", "location": {"file": "src/test/TransientStorageMisuse.t.sol", "line": 33, "column": 22}, "severity": "medium", "references": [], "description": ""}, {"id": "cb351a665b56", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "            assembly {", "highlightLines": [43]}, "category": "code", "location": {"file": "src/test/TransientStorageMisuse.t.sol", "line": 43, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "923bdfa2e7eb", "fix": {"template": null, "available": false}, "title": "Transient storage used for unlock state - verify proper access control", "ruleId": "rules.sol-ethernaut-transient-storage-unlock", "snippet": {"code": "                tstore(1, amount)", "highlightLines": [44]}, "category": "code", "location": {"file": "src/test/TransientStorageMisuse.t.sol", "line": 44, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "b01d8a0580fb", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        vault = new SimpleVault();", "highlightLines": [57]}, "category": "code", "location": {"file": "src/test/TransientStorageMisuse.t.sol", "line": 57, "column": 17}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "920ebe88cdd6", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 amount = uint256(uint160(address(this)));", "highlightLines": [66]}, "category": "code", "location": {"file": "src/test/TransientStorageMisuse.t.sol", "line": 66, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "5513b80b719d", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.18;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/Uninitialized_variables.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "a3441a5e5029", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        EngineContract = new Engine();\n        MotorbikeContract = new Motorbike(address(EngineContract));", "highlightLines": [25]}, "category": "code", "location": {"file": "src/test/Uninitialized_variables.sol", "line": 25, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d375a83d6461", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        EngineContract = new Engine();", "highlightLines": [25]}, "category": "code", "location": {"file": "src/test/Uninitialized_variables.sol", "line": 25, "column": 26}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "4b67f4d836c3", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        MotorbikeContract = new Motorbike(address(EngineContract));\n        AttackContract = new Attack();", "highlightLines": [26]}, "category": "code", "location": {"file": "src/test/Uninitialized_variables.sol", "line": 26, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "aadfb791ab61", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        MotorbikeContract = new Motorbike(address(EngineContract));", "highlightLines": [26]}, "category": "code", "location": {"file": "src/test/Uninitialized_variables.sol", "line": 26, "column": 29}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "faadd4a072b7", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        AttackContract = new Attack();\n\n        // Engine contract is not initialized\n        console.log(\"Unintialized Upgrader:\", EngineContract.upgrader());\n        // Malicious user calls initialize() on Engine contract to become upgrader.\n        address(EngineContract).call(abi.encodeWithSignature(\"initialize()\"));\n        // Malicious user becomes the upgrader\n        console.log(\"Initialized Upgrader:\", EngineContract.upgrader());\n\n        // Upgrade the implementation of the proxy to a malicious contract and call `attack()`\n        bytes memory initEncoded = abi.encodeWithSignature(\"attack()\");", "highlightLines": [27]}, "category": "code", "location": {"file": "src/test/Uninitialized_variables.sol", "line": 27, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "ff35ca7219e6", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        AttackContract = new Attack();", "highlightLines": [27]}, "category": "code", "location": {"file": "src/test/Uninitialized_variables.sol", "line": 27, "column": 26}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "59154455453c", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        0x360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc;", "highlightLines": [61]}, "category": "code", "location": {"file": "src/test/Uninitialized_variables.sol", "line": 61, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "8a66b96cee08", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "        0x360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc;", "highlightLines": [61]}, "category": "code", "location": {"file": "src/test/Uninitialized_variables.sol", "line": 61, "column": 9}, "severity": "high", "references": [], "description": ""}, {"id": "c41d54fbc417", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address value;", "highlightLines": [64]}, "category": "code", "location": {"file": "src/test/Uninitialized_variables.sol", "line": 64, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3a9da5cb5d32", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(address _logic) {\n        require(\n            Address.isContract(_logic),\n            \"ERC1967: new implementation is not a contract\"\n        );\n        _getAddressSlot(_IMPLEMENTATION_SLOT).value = _logic;\n        (bool success, ) = _logic.delegatecall(\n            abi.encodeWithSignature(\"initialize()\")\n        );\n        require(success, \"Call failed\");\n    }", "highlightLines": [68]}, "category": "code", "location": {"file": "src/test/Uninitialized_variables.sol", "line": 68, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "cff27f0f1da1", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        _getAddressSlot(_IMPLEMENTATION_SLOT).value = _logic;\n        (bool success, ) = _logic.delegatecall(\n            abi.encodeWithSignature(\"initialize()\")\n        );", "highlightLines": [73]}, "category": "code", "location": {"file": "src/test/Uninitialized_variables.sol", "line": 73, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "6eabc9842f1a", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "        (bool success, ) = _logic.delegatecall(\n            abi.encodeWithSignature(\"initialize()\")", "highlightLines": [74]}, "category": "code", "location": {"file": "src/test/Uninitialized_variables.sol", "line": 74, "column": 28}, "severity": "medium", "references": [], "description": ""}, {"id": "991b7f06aeb3", "fix": {"template": null, "available": false}, "title": "Delegatecall with user-controlled data - storage slot collision possible", "ruleId": "rules.sol-arbitrary-delegatecall-data", "snippet": {"code": "        (bool success, ) = _logic.delegatecall(\n            abi.encodeWithSignature(\"initialize()\")", "highlightLines": [74]}, "category": "code", "location": {"file": "src/test/Uninitialized_variables.sol", "line": 74, "column": 34}, "severity": "high", "references": [], "description": ""}, {"id": "29da65b42179", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [83]}, "category": "code", "location": {"file": "src/test/Uninitialized_variables.sol", "line": 83, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "46e24f8b374c", "fix": {"template": null, "available": false}, "title": "View/pure function uses assembly - may modify state unexpectedly", "ruleId": "rules.sol-constant-function-assembly", "snippet": {"code": "    function _getAddressSlot(\n        bytes32 slot\n    ) internal pure returns (AddressSlot storage r) {\n        assembly {", "highlightLines": [111]}, "category": "code", "location": {"file": "src/test/Uninitialized_variables.sol", "line": 111, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-using-assembly-code"], "description": ""}, {"id": "e7d9ab136130", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [114]}, "category": "code", "location": {"file": "src/test/Uninitialized_variables.sol", "line": 114, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "c0948a78edb4", "fix": {"template": null, "available": false}, "title": "Upgradeable contract without storage gap - future upgrade collision risk", "ruleId": "rules.sol-no-gap-storage", "snippet": {"code": "contract Engine is Initializable {", "highlightLines": [120]}, "category": "code", "location": {"file": "src/test/Uninitialized_variables.sol", "line": 120, "column": 1}, "severity": "info", "references": ["https://docs.openzeppelin.com/contracts/4.x/upgradeable#storage_gaps"], "description": ""}, {"id": "eb65274e2596", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract Engine is Initializable {\n    // keccak-256 hash of \"eip1967.proxy.implementation\" subtracted by 1\n    bytes32 internal constant _IMPLEMENTATION_SLOT =\n        0x360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc;\n\n    address public upgrader;\n    uint256 public horsePower;\n\n    struct AddressSlot {\n        address value;", "highlightLines": [120]}, "category": "code", "location": {"file": "src/test/Uninitialized_variables.sol", "line": 120, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "c625342330ae", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        0x360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc;", "highlightLines": [123]}, "category": "code", "location": {"file": "src/test/Uninitialized_variables.sol", "line": 123, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "7a9bbb84fa44", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "        0x360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc;", "highlightLines": [123]}, "category": "code", "location": {"file": "src/test/Uninitialized_variables.sol", "line": 123, "column": 9}, "severity": "high", "references": [], "description": ""}, {"id": "338639111a4e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address value;", "highlightLines": [129]}, "category": "code", "location": {"file": "src/test/Uninitialized_variables.sol", "line": 129, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0329f2322fe8", "fix": {"template": null, "available": false}, "title": "Initializer function not protected - can be called multiple times", "ruleId": "rules.sol-initializer-not-protected", "snippet": {"code": "    function initialize() external initializer {", "highlightLines": [132]}, "category": "code", "location": {"file": "src/test/Uninitialized_variables.sol", "line": 132, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "6d1020e22e15", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        horsePower = 1000;\n        upgrader = msg.sender;", "highlightLines": [133]}, "category": "code", "location": {"file": "src/test/Uninitialized_variables.sol", "line": 133, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "5b775f64c092", "fix": {"template": null, "available": false}, "title": "Proxy upgrade executable immediately - malicious upgrade can drain funds before users react", "ruleId": "rules.sol-proxy-upgrade-no-delay", "snippet": {"code": "    function upgradeToAndCall(\n        address newImplementation,\n        bytes memory data\n    ) external payable {", "highlightLines": [139]}, "category": "code", "location": {"file": "src/test/Uninitialized_variables.sol", "line": 139, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "69f4af7bb9bb", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "            (bool success, ) = newImplementation.delegatecall(data);", "highlightLines": [160]}, "category": "code", "location": {"file": "src/test/Uninitialized_variables.sol", "line": 160, "column": 32}, "severity": "medium", "references": [], "description": ""}, {"id": "f96fce7db541", "fix": {"template": null, "available": false}, "title": "Delegatecall with user-controlled data - storage slot collision possible", "ruleId": "rules.sol-arbitrary-delegatecall-data", "snippet": {"code": "            (bool success, ) = newImplementation.delegatecall(data);", "highlightLines": [160]}, "category": "code", "location": {"file": "src/test/Uninitialized_variables.sol", "line": 160, "column": 49}, "severity": "high", "references": [], "description": ""}, {"id": "0e7c06e06164", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event Returny(uint256);", "highlightLines": [165]}, "category": "code", "location": {"file": "src/test/Uninitialized_variables.sol", "line": 165, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "1e4d34425fd3", "fix": {"template": null, "available": false}, "title": "Uninitialized storage pointer defaults to slot 0 - can overwrite critical state (FiftyYears pattern)", "ruleId": "rules.sol-uninitialized-storage-pointer", "snippet": {"code": "        AddressSlot storage r;", "highlightLines": [178]}, "category": "code", "location": {"file": "src/test/Uninitialized_variables.sol", "line": 178, "column": 9}, "severity": "high", "references": ["https://capturetheether.com/challenges/math/fifty-years/"], "description": ""}, {"id": "02da873fdabe", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [179]}, "category": "code", "location": {"file": "src/test/Uninitialized_variables.sol", "line": 179, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "226195c055b4", "fix": {"template": null, "available": false}, "title": "Selfdestruct with user-controlled recipient - funds can be sent anywhere", "ruleId": "rules.sol-selfdestruct-arbitrary", "snippet": {"code": "        selfdestruct(payable(msg.sender));", "highlightLines": [188]}, "category": "code", "location": {"file": "src/test/Uninitialized_variables.sol", "line": 188, "column": 9}, "severity": "high", "references": [], "description": ""}, {"id": "187fbee0e839", "fix": {"template": null, "available": false}, "title": "Contract can be destructed by anyone - missing access control on selfdestruct", "ruleId": "rules.sol-accessible-selfdestruct", "snippet": {"code": "        selfdestruct(payable(msg.sender));", "highlightLines": [188]}, "category": "code", "location": {"file": "src/test/Uninitialized_variables.sol", "line": 188, "column": 9}, "severity": "high", "references": ["https://www.parity.io/blog/a-postmortem-on-the-parity-multi-sig-library-self-destruct/"], "description": ""}, {"id": "49650f7fffb5", "fix": {"template": null, "available": false}, "title": "selfdestruct can force ETH to any address - contracts cannot prevent receiving ETH this way (Force pattern)", "ruleId": "rules.sol-selfdestruct-force-eth", "snippet": {"code": "        selfdestruct(payable(msg.sender));", "highlightLines": [188]}, "category": "code", "location": {"file": "src/test/Uninitialized_variables.sol", "line": 188, "column": 9}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/7"], "description": ""}, {"id": "c7517f438dec", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.18;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/UniswapV3ETHRefundExploit.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "4e2806f5ff06", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address tokenIn;", "highlightLines": [11]}, "category": "code", "location": {"file": "src/test/UniswapV3ETHRefundExploit.sol", "line": 11, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c2adcca7fb28", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address tokenOut;", "highlightLines": [12]}, "category": "code", "location": {"file": "src/test/UniswapV3ETHRefundExploit.sol", "line": 12, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "5c32afe0fa6a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint24 fee;", "highlightLines": [13]}, "category": "code", "location": {"file": "src/test/UniswapV3ETHRefundExploit.sol", "line": 13, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3b7cdc9e3419", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address recipient;", "highlightLines": [14]}, "category": "code", "location": {"file": "src/test/UniswapV3ETHRefundExploit.sol", "line": 14, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "81c352ad4def", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 deadline;", "highlightLines": [15]}, "category": "code", "location": {"file": "src/test/UniswapV3ETHRefundExploit.sol", "line": 15, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e37a92f8e87b", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 amountIn;", "highlightLines": [16]}, "category": "code", "location": {"file": "src/test/UniswapV3ETHRefundExploit.sol", "line": 16, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "9973a7c5c141", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 amountOutMinimum;", "highlightLines": [17]}, "category": "code", "location": {"file": "src/test/UniswapV3ETHRefundExploit.sol", "line": 17, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0ddcb66e4122", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint160 sqrtPriceLimitX96;", "highlightLines": [18]}, "category": "code", "location": {"file": "src/test/UniswapV3ETHRefundExploit.sol", "line": 18, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "2e3aa80db615", "fix": {"template": null, "available": false}, "title": "View function reads state that may be stale during callback - read-only reentrancy risk", "ruleId": "rules.sol-read-only-reentrancy", "snippet": {"code": "    function slot0()\n        external\n        view\n        returns (\n            uint160 sqrtPriceX96,\n            int24 tick,\n            uint16 observationIndex,\n            uint16 observationCardinality,\n            uint16 observationCardinalityNext,\n            uint8 feeProtocol,\n            bool unlocked\n        );\n}\n\ninterface IERC20 {\n    function balanceOf(address) external view returns (uint256);", "highlightLines": [30]}, "category": "code", "location": {"file": "src/test/UniswapV3ETHRefundExploit.sol", "line": 30, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs", "https://chainsecurity.com/curve-lp-oracle-manipulation-post-mortem/"], "description": ""}, {"id": "d419312eecbe", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function approve(address guy, uint256 wad) external returns (bool);", "highlightLines": [49]}, "category": "code", "location": {"file": "src/test/UniswapV3ETHRefundExploit.sol", "line": 49, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "55646b1356b7", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function approve(address guy, uint256 wad) external returns (bool);\n}\n\ncontract UniswapV3ETHRefundExploitTest is Test {", "highlightLines": [49]}, "category": "code", "location": {"file": "src/test/UniswapV3ETHRefundExploit.sol", "line": 49, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "ae676d0f4bd4", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract UniswapV3ETHRefundExploitTest is Test {\n    ISwapRouter router =\n        ISwapRouter(0xE592427A0AEce92De3Edee1F18E0157C05861564);\n    IPool pool = IPool(0x88e6A0c2dDD26FEEb64F039a2c41296FcB3f5640);\n\n    address weth = 0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2;\n    address usdc = 0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48;\n\n    function testExploit() public {\n        vm.createSelectFork(\"mainnet\", 16454867);\n\n        uint256 amountIn = 100 ether;", "highlightLines": [52]}, "category": "code", "location": {"file": "src/test/UniswapV3ETHRefundExploit.sol", "line": 52, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "1e5b2a63283d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    address weth = 0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2;", "highlightLines": [56]}, "category": "code", "location": {"file": "src/test/UniswapV3ETHRefundExploit.sol", "line": 56, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e1f1907131de", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address usdc = 0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48;", "highlightLines": [58]}, "category": "code", "location": {"file": "src/test/UniswapV3ETHRefundExploit.sol", "line": 58, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8aed70456079", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 amountIn = 100 ether;", "highlightLines": [62]}, "category": "code", "location": {"file": "src/test/UniswapV3ETHRefundExploit.sol", "line": 62, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "84bccd015bbb", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 amountIn = 100 ether;\n\n        vm.label(address(this), \"user\");\n        vm.deal(address(this), amountIn);\n\n        // Users sells 100 ETH to buy USDC. They have a limit price set.\n        ExactInputSingleParams memory params = ExactInputSingleParams({\n            tokenIn: weth,\n            tokenOut: usdc,\n            fee: 500,\n            recipient: address(this),\n            deadline: block.timestamp,\n            amountIn: amountIn,\n            amountOutMinimum: 0,\n            sqrtPriceLimitX96: 1956260967287247098961477920037032 // (sqrtPrice before + sqrtPrice after) / 2\n        });", "highlightLines": [63]}, "category": "code", "location": {"file": "src/test/UniswapV3ETHRefundExploit.sol", "line": 63, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "1ea74fbf7655", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        ExactInputSingleParams memory params = ExactInputSingleParams({\n            tokenIn: weth,\n            tokenOut: usdc,\n            fee: 500,\n            recipient: address(this),\n            deadline: block.timestamp,\n            amountIn: amountIn,\n            amountOutMinimum: 0,\n            sqrtPriceLimitX96: 1956260967287247098961477920037032 // (sqrtPrice before + sqrtPrice after) / 2\n        });\n\n        // Full input amount is sent along the call.\n        router.exactInputSingle{value: amountIn}(params);\n\n        // User has bought some USDC. However, the full input ETH amount wasn't used...\n        assertEq(IERC20(usdc).balanceOf(address(this)), 81979.308775e6);\n\n        // ... the remaining ETH is still in the Router contract.\n        uint256 routerBeforeBalance = address(router).balance;", "highlightLines": [69]}, "category": "code", "location": {"file": "src/test/UniswapV3ETHRefundExploit.sol", "line": 69, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e12f0c713d24", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "            deadline: block.timestamp,", "highlightLines": [74]}, "category": "code", "location": {"file": "src/test/UniswapV3ETHRefundExploit.sol", "line": 74, "column": 23}, "severity": "medium", "references": [], "description": ""}, {"id": "20e3485572e5", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 routerBeforeBalance = address(router).balance;", "highlightLines": [87]}, "category": "code", "location": {"file": "src/test/UniswapV3ETHRefundExploit.sol", "line": 87, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b57e6070833b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 routerBeforeBalance = address(router).balance;\n        assertEq(routerBeforeBalance, 50 ether);\n\n        // A MEV bot steals the remaining ETH by calling the public refundETH function.\n        address mev = address(0x31337);", "highlightLines": [87]}, "category": "code", "location": {"file": "src/test/UniswapV3ETHRefundExploit.sol", "line": 87, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "9d889e6d5a9a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address mev = address(0x31337);", "highlightLines": [91]}, "category": "code", "location": {"file": "src/test/UniswapV3ETHRefundExploit.sol", "line": 91, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7db2f63b58e4", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address mev = address(0x31337);\n        vm.label(mev, \"mev\");\n\n        vm.prank(mev);\n        router.refundETH();\n        assertEq(address(mev).balance, 50 ether);\n        uint256 routerAfterBalance = address(router).balance;", "highlightLines": [91]}, "category": "code", "location": {"file": "src/test/UniswapV3ETHRefundExploit.sol", "line": 91, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "b3b8b376f1a6", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 routerAfterBalance = address(router).balance;", "highlightLines": [97]}, "category": "code", "location": {"file": "src/test/UniswapV3ETHRefundExploit.sol", "line": 97, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "55c360d76936", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.18;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/Unprotected-callback.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "eb5319d1acb1", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "The contract ContractTest is exploiting a callback feature to bypass the maximum mint limit \nset by the MaxMint721 contract. This is achieved by triggering the onERC721Received function,\nwhich internally calls the mint function again. Therefore, although MaxMint721 attempts \nto limit the number of tokens that a user can mint to MAX_PER_USER, the ContractTest contract \nsuccessfully mints more tokens than this limit. \n\nScenario:\nThis excersise is about a contract that via callback function to mint more NFTs\n\nMitigation:\nFollow check-effect-interaction and use OpenZeppelin Reentrancy Guard.\n\nREF\nhttps://blocksecteam.medium.com/when-safemint-becomes-unsafe-lessons-from-the-hypebears-security-incident-2965209bda2a\nhttps://www.paradigm.xyz/2021/08/the-dangers-of-surprising-code\n\n*/\n\ncontract ContractTest is Test {\n    MaxMint721 MaxMint721Contract;\n    bool complete;\n    uint256 maxMints = 10;\n    address alice = vm.addr(1);\n    address eve = vm.addr(2);", "highlightLines": [11]}, "category": "code", "location": {"file": "src/test/Unprotected-callback.sol", "line": 11, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "45415971d2a6", "fix": {"template": null, "available": false}, "title": "Potential mnemonic seed phrase detected - CRITICAL if real", "ruleId": "rules._shared.shared-mnemonic-phrase", "snippet": {"code": "This excersise is about a contract that via callback function to mint more NFTs\n\nMitigation:", "highlightLines": [18]}, "category": "code", "location": {"file": "src/test/Unprotected-callback.sol", "line": 18, "column": 19}, "severity": "high", "references": [], "description": ""}, {"id": "43286ab46d12", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    bool complete;", "highlightLines": [31]}, "category": "code", "location": {"file": "src/test/Unprotected-callback.sol", "line": 31, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "bddea4b27c1a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 maxMints = 10;", "highlightLines": [32]}, "category": "code", "location": {"file": "src/test/Unprotected-callback.sol", "line": 32, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "05958aa5f6fb", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address alice = vm.addr(1);", "highlightLines": [33]}, "category": "code", "location": {"file": "src/test/Unprotected-callback.sol", "line": 33, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a1adeffe06ce", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address eve = vm.addr(2);", "highlightLines": [34]}, "category": "code", "location": {"file": "src/test/Unprotected-callback.sol", "line": 34, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0e51248f1cd3", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        MaxMint721Contract = new MaxMint721();", "highlightLines": [37]}, "category": "code", "location": {"file": "src/test/Unprotected-callback.sol", "line": 37, "column": 30}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "cf94d94cd822", "fix": {"template": null, "available": false}, "title": "Token callback function without reentrancy protection - ERC777/721/1155 callbacks can reenter", "ruleId": "rules.sol-callback-without-reentrancy-guard", "snippet": {"code": "    function onERC721Received(\n        address,\n        address,\n        uint256,\n        bytes memory\n    ) public returns (bytes4) {", "highlightLines": [44]}, "category": "code", "location": {"file": "src/test/Unprotected-callback.sol", "line": 44, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "650fc17c096e", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    receive() external payable {}", "highlightLines": [58]}, "category": "code", "location": {"file": "src/test/Unprotected-callback.sol", "line": 58, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "568a2dec7288", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "    receive() external payable {}", "highlightLines": [58]}, "category": "code", "location": {"file": "src/test/Unprotected-callback.sol", "line": 58, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "dca78f21dc9e", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract MaxMint721 is ERC721Enumerable {\n    uint256 public MAX_PER_USER = 10;", "highlightLines": [61]}, "category": "code", "location": {"file": "src/test/Unprotected-callback.sol", "line": 61, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "811b0cb95070", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor() ERC721(\"ERC721\", \"ERC721\") {}", "highlightLines": [64]}, "category": "code", "location": {"file": "src/test/Unprotected-callback.sol", "line": 64, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "34406bb59cce", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function mint(uint256 amount) external {", "highlightLines": [66]}, "category": "code", "location": {"file": "src/test/Unprotected-callback.sol", "line": 66, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "a8171d5030b6", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function mint(uint256 amount) external {", "highlightLines": [66]}, "category": "code", "location": {"file": "src/test/Unprotected-callback.sol", "line": 66, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "41b372f869ee", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint256 mintIndex = totalSupply();", "highlightLines": [72]}, "category": "code", "location": {"file": "src/test/Unprotected-callback.sol", "line": 72, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "dd6f9df7770c", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.18;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/UnsafeCall.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "a144d0113473", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "and unintended consequences. The function uses a low-level call (_spender.call(_extraData))", "highlightLines": [10]}, "category": "code", "location": {"file": "src/test/UnsafeCall.sol", "line": 10, "column": 66}, "severity": "medium", "references": [], "description": ""}, {"id": "320ba2788c98", "fix": {"template": null, "available": false}, "title": "Potential mnemonic seed phrase detected - CRITICAL if real", "ruleId": "rules._shared.shared-mnemonic-phrase", "snippet": {"code": "This excersise is about  a low level call to a contract where input and return values are not checked\nIf the call data is controllable, it is easy to cause arbitrary function execution.", "highlightLines": [14]}, "category": "code", "location": {"file": "src/test/UnsafeCall.sol", "line": 14, "column": 19}, "severity": "high", "references": [], "description": ""}, {"id": "fd52e19b6fbd", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "This excersise is about  a low level call to a contract where input and return values are not checked\nIf the call data is controllable, it is easy to cause arbitrary function execution.\n\nMitigation:\nUse of low level \"call\" should be avoided whenever possible.  \n\nREF\nhttps://blog.li.fi/20th-march-the-exploit-e9e1c5c03eb9\n*/\n\nimport \"forge-std/Test.sol\";\n\ncontract ContractTest is Test {", "highlightLines": [14]}, "category": "code", "location": {"file": "src/test/UnsafeCall.sol", "line": 14, "column": 73}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "423bfd47ed6c", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract ContractTest is Test {\n    TokenWhale TokenWhaleContract;\n\n    function testUnsafeCall() public {\n        address alice = vm.addr(1);", "highlightLines": [26]}, "category": "code", "location": {"file": "src/test/UnsafeCall.sol", "line": 26, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "1c1ff4949633", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address alice = vm.addr(1);", "highlightLines": [30]}, "category": "code", "location": {"file": "src/test/UnsafeCall.sol", "line": 30, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e507a4c17bb6", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address alice = vm.addr(1);\n        TokenWhaleContract = new TokenWhale();", "highlightLines": [30]}, "category": "code", "location": {"file": "src/test/UnsafeCall.sol", "line": 30, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "92e3c835d70f", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        TokenWhaleContract = new TokenWhale();", "highlightLines": [31]}, "category": "code", "location": {"file": "src/test/UnsafeCall.sol", "line": 31, "column": 30}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "eb558f242b1c", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    receive() external payable {}", "highlightLines": [67]}, "category": "code", "location": {"file": "src/test/UnsafeCall.sol", "line": 67, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "373cfe686223", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "    receive() external payable {}", "highlightLines": [67]}, "category": "code", "location": {"file": "src/test/UnsafeCall.sol", "line": 67, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "454bff00b4e7", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address player;", "highlightLines": [71]}, "category": "code", "location": {"file": "src/test/UnsafeCall.sol", "line": 71, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "76979bdba4de", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        player = _player;\n        totalSupply = 1000;", "highlightLines": [82]}, "category": "code", "location": {"file": "src/test/UnsafeCall.sol", "line": 82, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "5d9507344cec", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        totalSupply = 1000;\n        balanceOf[player] = 1000;", "highlightLines": [83]}, "category": "code", "location": {"file": "src/test/UnsafeCall.sol", "line": 83, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "f868f14e507a", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Transfer(address indexed from, address indexed to, uint256 value);", "highlightLines": [91]}, "category": "code", "location": {"file": "src/test/UnsafeCall.sol", "line": 91, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "302f7e62d0da", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function transfer(address to, uint256 value) public {", "highlightLines": [100]}, "category": "code", "location": {"file": "src/test/UnsafeCall.sol", "line": 100, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "70191a24239c", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without msg.data.length validation - vulnerable to short address attack padding", "ruleId": "rules.sol-short-address-no-payload-check", "snippet": {"code": "    function transfer(address to, uint256 value) public {", "highlightLines": [100]}, "category": "code", "location": {"file": "src/test/UnsafeCall.sol", "line": 100, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address", "https://vessenes.com/the-erc20-short-address-attack-explained/"], "description": ""}, {"id": "5df345ff40ec", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(balanceOf[msg.sender] >= value);", "highlightLines": [101]}, "category": "code", "location": {"file": "src/test/UnsafeCall.sol", "line": 101, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "9bd31c845b3e", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(balanceOf[to] + value >= balanceOf[to]);", "highlightLines": [102]}, "category": "code", "location": {"file": "src/test/UnsafeCall.sol", "line": 102, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "590395c21641", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event Approval(\n        address indexed owner,\n        address indexed spender,\n        uint256 value\n    );", "highlightLines": [107]}, "category": "code", "location": {"file": "src/test/UnsafeCall.sol", "line": 107, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "08a6190df0b7", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Approval(\n        address indexed owner,\n        address indexed spender,\n        uint256 value\n    );", "highlightLines": [107]}, "category": "code", "location": {"file": "src/test/UnsafeCall.sol", "line": 107, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "8146d201bb33", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function approve(address spender, uint256 value) public {", "highlightLines": [113]}, "category": "code", "location": {"file": "src/test/UnsafeCall.sol", "line": 113, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "8433be33c2da", "fix": {"template": null, "available": false}, "title": "ERC20 transferFrom without payload size validation - consider adding onlyPayloadSize modifier", "ruleId": "rules.sol-erc20-missing-payload-modifier", "snippet": {"code": "    function transferFrom(address from, address to, uint256 value) public {", "highlightLines": [118]}, "category": "code", "location": {"file": "src/test/UnsafeCall.sol", "line": 118, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address"], "description": ""}, {"id": "e29782fb43ec", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function transferFrom(address from, address to, uint256 value) public {", "highlightLines": [118]}, "category": "code", "location": {"file": "src/test/UnsafeCall.sol", "line": 118, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "e9697bc575b7", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(balanceOf[from] >= value);", "highlightLines": [119]}, "category": "code", "location": {"file": "src/test/UnsafeCall.sol", "line": 119, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "1cc4761774a6", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(balanceOf[to] + value >= balanceOf[to]);", "highlightLines": [120]}, "category": "code", "location": {"file": "src/test/UnsafeCall.sol", "line": 120, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "c6083f136d3d", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(allowance[from][msg.sender] >= value);", "highlightLines": [121]}, "category": "code", "location": {"file": "src/test/UnsafeCall.sol", "line": 121, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "d3ba2074c89a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        allowance[msg.sender][_spender] = _value;\n\n        bool success;\n        // vulnerable call execute unsafe user code\n        (success, ) = _spender.call(_extraData);", "highlightLines": [134]}, "category": "code", "location": {"file": "src/test/UnsafeCall.sol", "line": 134, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "3e306ce56f47", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        bool success;", "highlightLines": [135]}, "category": "code", "location": {"file": "src/test/UnsafeCall.sol", "line": 135, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d30a87f2e5da", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "        (success, ) = _spender.call(_extraData);", "highlightLines": [138]}, "category": "code", "location": {"file": "src/test/UnsafeCall.sol", "line": 138, "column": 23}, "severity": "medium", "references": [], "description": ""}, {"id": "3a8b47a1b9b1", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.18;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/Visibility.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "bb28ca191993", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        ownerGameContract = new ownerGame();", "highlightLines": [29]}, "category": "code", "location": {"file": "src/test/Visibility.sol", "line": 29, "column": 29}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "5ac6477127b7", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    receive() external payable {}", "highlightLines": [42]}, "category": "code", "location": {"file": "src/test/Visibility.sol", "line": 42, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "e121c8f0725e", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "    receive() external payable {}", "highlightLines": [42]}, "category": "code", "location": {"file": "src/test/Visibility.sol", "line": 42, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "aaa1b9887148", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor() {\n        owner = msg.sender;\n    }", "highlightLines": [48]}, "category": "code", "location": {"file": "src/test/Visibility.sol", "line": 48, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "6987fddbaed1", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        owner = msg.sender;", "highlightLines": [49]}, "category": "code", "location": {"file": "src/test/Visibility.sol", "line": 49, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "8928f64f53d0", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function changeOwner(address _new) public {", "highlightLines": [53]}, "category": "code", "location": {"file": "src/test/Visibility.sol", "line": 53, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "a733e77f0768", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        owner = _new;", "highlightLines": [54]}, "category": "code", "location": {"file": "src/test/Visibility.sol", "line": 54, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "8d110fee6b21", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.18;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/ecrecover.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "3b62614fa223", "fix": {"template": null, "available": false}, "title": "Potential mnemonic seed phrase detected - CRITICAL if real", "ruleId": "rules._shared.shared-mnemonic-phrase", "snippet": {"code": "It recovers the signer address and checks if it equals Admin. The vulnerability lies in the fact \nthat the ecrecover function may return a 0x0 address when the signature parameters \nare invali, If v value isn't 27 or 28. it will return address(0).", "highlightLines": [11]}, "category": "code", "location": {"file": "src/test/ecrecover.sol", "line": 11, "column": 73}, "severity": "high", "references": [], "description": ""}, {"id": "4fd11c577a82", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "that the ecrecover function may return a 0x0 address when the signature parameters \nare invali, If v value isn't 27 or 28. it will return address(0).\n\nMitigation:  \nVerify that the result from ecrecover isn't 0 or instead use OpenZeppelins ECDSA library.\n\nREF:\nhttps://twitter.com/1nf0s3cpt/status/1674268926761668608\nhttps://github.com/code-423n4/2021-09-swivel-findings/issues/61\nhttps://github.com/Kaiziron/numen_ctf_2023_writeup/blob/main/wallet.md\n*/\n\ncontract ContractTest is Test {\n    SimpleBank SimpleBankContract;\n\n    function setUp() public {", "highlightLines": [12]}, "category": "code", "location": {"file": "src/test/ecrecover.sol", "line": 12, "column": 33}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "c9be25a6f6dc", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        SimpleBankContract = new SimpleBank();", "highlightLines": [28]}, "category": "code", "location": {"file": "src/test/ecrecover.sol", "line": 28, "column": 30}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "0a53c077a9b7", "fix": {"template": null, "available": false}, "title": "address(this) directly in emit - likely wrong address (should use token/handler variable)", "ruleId": "rules.sol-emit-address-this", "snippet": {"code": "        emit log_named_decimal_uint(\n            \"Before exploiting, my balance\",\n            SimpleBankContract.getBalance(address(this)),", "highlightLines": [32]}, "category": "code", "location": {"file": "src/test/ecrecover.sol", "line": 32, "column": 9}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "aa1d0f16399e", "fix": {"template": null, "available": false}, "title": "address(this) emitted in event - may emit wrong address (handler vs token confusion)", "ruleId": "rules.sol-address-this-in-event", "snippet": {"code": "        emit log_named_decimal_uint(\n            \"Before exploiting, my balance\",\n            SimpleBankContract.getBalance(address(this)),", "highlightLines": [32]}, "category": "code", "location": {"file": "src/test/ecrecover.sol", "line": 32, "column": 9}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "a9decd9f946c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 _hash = keccak256(", "highlightLines": [37]}, "category": "code", "location": {"file": "src/test/ecrecover.sol", "line": 37, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "df41c2fd6bea", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes32 _hash = keccak256(\n            abi.encodePacked(\"\\x19Ethereum Signed Message:\\n32\")\n        );\n        (, bytes32 r, bytes32 s) = vm.sign(1, _hash);", "highlightLines": [37]}, "category": "code", "location": {"file": "src/test/ecrecover.sol", "line": 37, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e369456eb26d", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        bytes32 _hash = keccak256(\n            abi.encodePacked(\"\\x19Ethereum Signed Message:\\n32\")\n        );", "highlightLines": [37]}, "category": "code", "location": {"file": "src/test/ecrecover.sol", "line": 37, "column": 25}, "severity": "high", "references": [], "description": ""}, {"id": "62465073d713", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        (, bytes32 r, bytes32 s) = vm.sign(1, _hash);\n\n        // If v value isn't 27 or 28. it will return address(0)\n        uint8 v = 29;", "highlightLines": [40]}, "category": "code", "location": {"file": "src/test/ecrecover.sol", "line": 40, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "805fe7c09323", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "        // If v value isn't 27 or 28. it will return address(0)\n        uint8 v = 29;\n        SimpleBankContract.transfer(address(this), 1 ether, _hash, v, r, s);", "highlightLines": [42]}, "category": "code", "location": {"file": "src/test/ecrecover.sol", "line": 42, "column": 47}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "161f90b6774a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint8 v = 29;", "highlightLines": [43]}, "category": "code", "location": {"file": "src/test/ecrecover.sol", "line": 43, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f3a18d677d18", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        SimpleBankContract.transfer(address(this), 1 ether, _hash, v, r, s);", "highlightLines": [44]}, "category": "code", "location": {"file": "src/test/ecrecover.sol", "line": 44, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "369c50d35757", "fix": {"template": null, "available": false}, "title": "ERC20 transfer() return value not checked - tokens like USDT don't return bool", "ruleId": "rules.sol-erc20-transfer-no-return-check", "snippet": {"code": "        SimpleBankContract.transfer(address(this), 1 ether, _hash, v, r, s);", "highlightLines": [44]}, "category": "code", "location": {"file": "src/test/ecrecover.sol", "line": 44, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "b3f95545fad3", "fix": {"template": null, "available": false}, "title": "Event emitted after external call - reentrancy can cause events to be logged out of order", "ruleId": "rules.sol-event-after-external-call", "snippet": {"code": "        SimpleBankContract.transfer(address(this), 1 ether, _hash, v, r, s);\n\n        emit log_named_decimal_uint(", "highlightLines": [44]}, "category": "code", "location": {"file": "src/test/ecrecover.sol", "line": 44, "column": 27}, "severity": "info", "references": [], "description": ""}, {"id": "35786450bca9", "fix": {"template": null, "available": false}, "title": "address(this) directly in emit - likely wrong address (should use token/handler variable)", "ruleId": "rules.sol-emit-address-this", "snippet": {"code": "        emit log_named_decimal_uint(\n            \"After exploiting, my balance\",\n            SimpleBankContract.getBalance(address(this)),", "highlightLines": [46]}, "category": "code", "location": {"file": "src/test/ecrecover.sol", "line": 46, "column": 9}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "24e29daaa6d3", "fix": {"template": null, "available": false}, "title": "address(this) emitted in event - may emit wrong address (handler vs token confusion)", "ruleId": "rules.sol-address-this-in-event", "snippet": {"code": "        emit log_named_decimal_uint(\n            \"After exploiting, my balance\",\n            SimpleBankContract.getBalance(address(this)),", "highlightLines": [46]}, "category": "code", "location": {"file": "src/test/ecrecover.sol", "line": 46, "column": 9}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "ca429da91dd8", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    receive() external payable {}", "highlightLines": [53]}, "category": "code", "location": {"file": "src/test/ecrecover.sol", "line": 53, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "f1f65db85ec1", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "    receive() external payable {}", "highlightLines": [53]}, "category": "code", "location": {"file": "src/test/ecrecover.sol", "line": 53, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "33f69019c972", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address Admin; //default is address(0)", "highlightLines": [58]}, "category": "code", "location": {"file": "src/test/ecrecover.sol", "line": 58, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "6a0bc8d074f4", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function recoverSignerAddress(\n        bytes32 _hash,\n        uint8 _v,\n        bytes32 _r,\n        bytes32 _s\n    ) private pure returns (address) {\n        address recoveredAddress = ecrecover(_hash, _v, _r, _s);", "highlightLines": [64]}, "category": "code", "location": {"file": "src/test/ecrecover.sol", "line": 64, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "64019b603f9e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address recoveredAddress = ecrecover(_hash, _v, _r, _s);", "highlightLines": [70]}, "category": "code", "location": {"file": "src/test/ecrecover.sol", "line": 70, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "11239d5045df", "fix": {"template": null, "available": false}, "title": "ecrecover is vulnerable to signature malleability - use OpenZeppelin ECDSA", "ruleId": "rules.sol-ecrecover-malleable", "snippet": {"code": "        address recoveredAddress = ecrecover(_hash, _v, _r, _s);", "highlightLines": [70]}, "category": "code", "location": {"file": "src/test/ecrecover.sol", "line": 70, "column": 36}, "severity": "medium", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/utils/cryptography/ECDSA.sol"], "description": ""}, {"id": "3b2631d982cb", "fix": {"template": null, "available": false}, "title": "ecrecover result not checked for zero address - invalid signatures return address(0)", "ruleId": "rules.sol-ethernaut-ecrecover-no-zero-check", "snippet": {"code": "        address recoveredAddress = ecrecover(_hash, _v, _r, _s);", "highlightLines": [70]}, "category": "code", "location": {"file": "src/test/ecrecover.sol", "line": 70, "column": 36}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-117", "https://swcregistry.io/docs/SWC-122"], "description": ""}, {"id": "017e6d84708b", "fix": {"template": null, "available": false}, "title": "Signature verification without s-value malleability check - signatures can be replayed with modified s", "ruleId": "rules.sol-ethernaut-signature-malleability", "snippet": {"code": "        address recoveredAddress = ecrecover(_hash, _v, _r, _s);", "highlightLines": [70]}, "category": "code", "location": {"file": "src/test/ecrecover.sol", "line": 70, "column": 36}, "severity": "medium", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/utils/cryptography/ECDSA.sol"], "description": ""}, {"id": "2734da37f6e2", "fix": {"template": null, "available": false}, "title": "ECDSA signature without s-value check - signature malleability possible", "ruleId": "rules.sol-signature-malleability", "snippet": {"code": "        address recoveredAddress = ecrecover(_hash, _v, _r, _s);", "highlightLines": [70]}, "category": "code", "location": {"file": "src/test/ecrecover.sol", "line": 70, "column": 36}, "severity": "medium", "references": [], "description": ""}, {"id": "5c3e3e941e3c", "fix": {"template": null, "available": false}, "title": "Signature verification without domain separator - cross-contract replay possible", "ruleId": "rules.sol-signature-no-domain-separator", "snippet": {"code": "        address recoveredAddress = ecrecover(_hash, _v, _r, _s);", "highlightLines": [70]}, "category": "code", "location": {"file": "src/test/ecrecover.sol", "line": 70, "column": 36}, "severity": "medium", "references": [], "description": ""}, {"id": "7f7845a58f09", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function transfer(\n        address _to,\n        uint256 _amount,\n        bytes32 _hash,\n        uint8 _v,\n        bytes32 _r,\n        bytes32 _s\n    ) public {", "highlightLines": [74]}, "category": "code", "location": {"file": "src/test/ecrecover.sol", "line": 74, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "dc3f66fbbf2e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        address signer = recoverSignerAddress(_hash, _v, _r, _s);", "highlightLines": [83]}, "category": "code", "location": {"file": "src/test/ecrecover.sol", "line": 83, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "fd5282b855cd", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.15;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/empty-loop.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "0cce450742b7", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        SimpleBankContract = new SimpleBank();", "highlightLines": [26]}, "category": "code", "location": {"file": "src/test/empty-loop.sol", "line": 26, "column": 30}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "3c55f3384d38", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        payable(address(SimpleBankContract)).transfer(10 ether);", "highlightLines": [30]}, "category": "code", "location": {"file": "src/test/empty-loop.sol", "line": 30, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "937f1b665c22", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address alice = vm.addr(1);", "highlightLines": [31]}, "category": "code", "location": {"file": "src/test/empty-loop.sol", "line": 31, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "46c39db3a400", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address alice = vm.addr(1);\n        vm.startPrank(alice);\n\n        SimpleBank.Signature[] memory sigs = new SimpleBank.Signature[](0); // empty input", "highlightLines": [31]}, "category": "code", "location": {"file": "src/test/empty-loop.sol", "line": 31, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "824f8b09fb4f", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    receive() external payable {}", "highlightLines": [49]}, "category": "code", "location": {"file": "src/test/empty-loop.sol", "line": 49, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "ae8c5bb7f515", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "    receive() external payable {}", "highlightLines": [49]}, "category": "code", "location": {"file": "src/test/empty-loop.sol", "line": 49, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "6effbbcb4105", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 hash;", "highlightLines": [54]}, "category": "code", "location": {"file": "src/test/empty-loop.sol", "line": 54, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "dd823388e91e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint8 v;", "highlightLines": [55]}, "category": "code", "location": {"file": "src/test/empty-loop.sol", "line": 55, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "31765aa50011", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 r;", "highlightLines": [56]}, "category": "code", "location": {"file": "src/test/empty-loop.sol", "line": 56, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "523c6747652c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 s;", "highlightLines": [57]}, "category": "code", "location": {"file": "src/test/empty-loop.sol", "line": 57, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "6208f3136645", "fix": {"template": null, "available": false}, "title": "ECDSA signature without s-value check - signature malleability possible", "ruleId": "rules.sol-signature-malleability", "snippet": {"code": "            msg.sender == ecrecover(sig.hash, sig.v, sig.r, sig.s),", "highlightLines": [62]}, "category": "code", "location": {"file": "src/test/empty-loop.sol", "line": 62, "column": 27}, "severity": "medium", "references": [], "description": ""}, {"id": "d351751c4f2c", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function withdraw(Signature[] calldata sigs) public {", "highlightLines": [67]}, "category": "code", "location": {"file": "src/test/empty-loop.sol", "line": 67, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "fb90971bd899", "fix": {"template": null, "available": false}, "title": "Empty array bypasses loop logic - add length check before loop", "ruleId": "rules.sol-empty-array-loop-bypass", "snippet": {"code": "        for (uint i = 0; i < sigs.length; i++) {", "highlightLines": [70]}, "category": "code", "location": {"file": "src/test/empty-loop.sol", "line": 70, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/empty-loop.sol"], "description": ""}, {"id": "848f1f960026", "fix": {"template": null, "available": false}, "title": "Unbounded loop iterating over dynamic array - can cause out-of-gas DoS", "ruleId": "rules.sol-unbounded-loop-dos", "snippet": {"code": "        for (uint i = 0; i < sigs.length; i++) {\n            Signature calldata signature = sigs[i];", "highlightLines": [70]}, "category": "code", "location": {"file": "src/test/empty-loop.sol", "line": 70, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "0695bfa93a11", "fix": {"template": null, "available": false}, "title": "Unbounded loop over dynamic array - can cause DoS if array grows large", "ruleId": "rules.sol-unbounded-protocol-loop", "snippet": {"code": "        for (uint i = 0; i < sigs.length; i++) {\n            Signature calldata signature = sigs[i];", "highlightLines": [70]}, "category": "code", "location": {"file": "src/test/empty-loop.sol", "line": 70, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "5a2f14e66558", "fix": {"template": null, "available": false}, "title": "Unbounded loop over array - potential DOS via gas limit", "ruleId": "rules.sol-unbounded-loop", "snippet": {"code": "        for (uint i = 0; i < sigs.length; i++) {\n            Signature calldata signature = sigs[i];\n            // Verify every signature and revert if any of them fails to verify.\n            verifySignatures(signature);\n        }", "highlightLines": [70]}, "category": "code", "location": {"file": "src/test/empty-loop.sol", "line": 70, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "92926b293c38", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        payable(msg.sender).transfer(1 ether);", "highlightLines": [75]}, "category": "code", "location": {"file": "src/test/empty-loop.sol", "line": 75, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "c5ebd0c16779", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    receive() external payable {}", "highlightLines": [78]}, "category": "code", "location": {"file": "src/test/empty-loop.sol", "line": 78, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "044609587ca7", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "    receive() external payable {}", "highlightLines": [78]}, "category": "code", "location": {"file": "src/test/empty-loop.sol", "line": 78, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "5f30586b048f", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.18;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "e197ac340f1c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        STAContract = new STA();\n        VulnVaultContract = new VulnVault(address(STAContract));", "highlightLines": [29]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 29, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "5d93fde07473", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        STAContract = new STA();", "highlightLines": [29]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 29, "column": 23}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "fba38418451e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        VulnVaultContract = new VulnVault(address(STAContract));\n        VaultContract = new Vault(address(STAContract));", "highlightLines": [30]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 30, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "7d99b27d5175", "fix": {"template": null, "available": false}, "title": "Variable written twice without being read between - first write is dead store", "ruleId": "rules.sol-write-after-write", "snippet": {"code": "        VulnVaultContract = new VulnVault(address(STAContract));\n        VaultContract = new Vault(address(STAContract));", "highlightLines": [30]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 30, "column": 13}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#write-after-write"], "description": ""}, {"id": "501dafae7dcc", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        VulnVaultContract = new VulnVault(address(STAContract));", "highlightLines": [30]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 30, "column": 29}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "9d46aa92fd4c", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        VaultContract = new Vault(address(STAContract));", "highlightLines": [31]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 31, "column": 25}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "32878d93b854", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address alice = vm.addr(1);", "highlightLines": [35]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 35, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "60b49b70c407", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "        address alice = vm.addr(1);\n        address bob = vm.addr(2);", "highlightLines": [35]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 35, "column": 9}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "4f731a090f6a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address alice = vm.addr(1);\n        address bob = vm.addr(2);", "highlightLines": [35]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 35, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "5c009cf8434b", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address bob = vm.addr(2);", "highlightLines": [36]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 36, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8dc5bc8ff7ed", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        STAContract.transfer(alice, 1000000);", "highlightLines": [38]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 38, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "f88b03998845", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "        STAContract.transfer(alice, 1000000);", "highlightLines": [38]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 38, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "18290bce3aae", "fix": {"template": null, "available": false}, "title": "ERC20 transfer() return value not checked - tokens like USDT don't return bool", "ruleId": "rules.sol-erc20-transfer-no-return-check", "snippet": {"code": "        STAContract.transfer(alice, 1000000);", "highlightLines": [38]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 38, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "38e14fbfc45e", "fix": {"template": null, "available": false}, "title": "Balance checked after transfer - use balanceBefore/balanceAfter pattern", "ruleId": "rules.sol-balance-after-transfer", "snippet": {"code": "        STAContract.transfer(alice, 1000000);\n        console.log(\"Alice's STA balance:\", STAContract.balanceOf(alice)); // charge 1% fee\n        vm.startPrank(alice);\n        STAContract.approve(address(VulnVaultContract), type(uint256).max);\n        VulnVaultContract.deposit(10000);\n        //VulnVaultContract.getBalance(alice);\n\n        console.log(\n            \"Alice deposit 10000 STA, but Alice's STA balance in VulnVaultContract:\",\n            VulnVaultContract.getBalance(alice)\n        ); // charge 1% fee\n        assertEq(\n            STAContract.balanceOf(address(VulnVaultContract)),", "highlightLines": [38]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 38, "column": 20}, "severity": "info", "references": [], "description": ""}, {"id": "9de8a70651e7", "fix": {"template": null, "available": false}, "title": "Unlimited token approval - use exact amount needed", "ruleId": "rules.sol-approve-max", "snippet": {"code": "        STAContract.approve(address(VulnVaultContract), type(uint256).max);", "highlightLines": [41]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 41, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "01ac715e94b2", "fix": {"template": null, "available": false}, "title": "Unlimited token approval (type(uint256).max) - user loses control of all tokens", "ruleId": "rules.sol-approval-scam-max-uint", "snippet": {"code": "        STAContract.approve(address(VulnVaultContract), type(uint256).max);", "highlightLines": [41]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 41, "column": 20}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/ApproveScam.sol"], "description": ""}, {"id": "46507325af22", "fix": {"template": null, "available": false}, "title": "Unlimited token approval using type(uint256).max - consider limited approvals", "ruleId": "rules.sol-unlimited-approval-type-max", "snippet": {"code": "        STAContract.approve(address(VulnVaultContract), type(uint256).max);", "highlightLines": [41]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 41, "column": 20}, "severity": "medium", "references": [], "description": ""}, {"id": "da83c6a7dd99", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address alice = vm.addr(1);", "highlightLines": [56]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 56, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b24cd941c638", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "        address alice = vm.addr(1);\n        address bob = vm.addr(2);", "highlightLines": [56]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 56, "column": 9}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "60a89e5b8ea1", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address alice = vm.addr(1);\n        address bob = vm.addr(2);", "highlightLines": [56]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 56, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "427651552fec", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address bob = vm.addr(2);", "highlightLines": [57]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 57, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0dbbe4f67d35", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        STAContract.transfer(alice, 1000000);", "highlightLines": [59]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 59, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "71de7ae2f00a", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "        STAContract.transfer(alice, 1000000);", "highlightLines": [59]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 59, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "ac8481062d20", "fix": {"template": null, "available": false}, "title": "ERC20 transfer() return value not checked - tokens like USDT don't return bool", "ruleId": "rules.sol-erc20-transfer-no-return-check", "snippet": {"code": "        STAContract.transfer(alice, 1000000);", "highlightLines": [59]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 59, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "342842840756", "fix": {"template": null, "available": false}, "title": "Balance checked after transfer - use balanceBefore/balanceAfter pattern", "ruleId": "rules.sol-balance-after-transfer", "snippet": {"code": "        STAContract.transfer(alice, 1000000);\n        console.log(\"Alice's STA balance:\", STAContract.balanceOf(alice)); // charge 1% fee\n        vm.startPrank(alice);\n        STAContract.approve(address(VaultContract), type(uint256).max);\n        VaultContract.deposit(10000);\n        //VaultContract.getBalance(alice);\n\n        console.log(\n            \"Alice deposit 10000, Alice's STA balance in VaultContract:\",\n            VaultContract.getBalance(alice)\n        ); // charge 1% fee\n        assertEq(\n            STAContract.balanceOf(address(VaultContract)),", "highlightLines": [59]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 59, "column": 20}, "severity": "info", "references": [], "description": ""}, {"id": "7fe8d0483a60", "fix": {"template": null, "available": false}, "title": "Unlimited token approval - use exact amount needed", "ruleId": "rules.sol-approve-max", "snippet": {"code": "        STAContract.approve(address(VaultContract), type(uint256).max);", "highlightLines": [62]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 62, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "68c5dddafa69", "fix": {"template": null, "available": false}, "title": "Unlimited token approval (type(uint256).max) - user loses control of all tokens", "ruleId": "rules.sol-approval-scam-max-uint", "snippet": {"code": "        STAContract.approve(address(VaultContract), type(uint256).max);", "highlightLines": [62]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 62, "column": 20}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/ApproveScam.sol"], "description": ""}, {"id": "f4bd4638e299", "fix": {"template": null, "available": false}, "title": "Unlimited token approval using type(uint256).max - consider limited approvals", "ruleId": "rules.sol-unlimited-approval-type-max", "snippet": {"code": "        STAContract.approve(address(VaultContract), type(uint256).max);", "highlightLines": [62]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 62, "column": 20}, "severity": "medium", "references": [], "description": ""}, {"id": "2c2ddf4e6889", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    receive() external payable {}", "highlightLines": [76]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 76, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "ca45126c4d4a", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "    receive() external payable {}", "highlightLines": [76]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 76, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "22c11c37169d", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function balanceOf(address who) external view returns (uint256);", "highlightLines": [82]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 82, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "fceaec0c0eac", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function allowance(\n        address owner,\n        address spender\n    ) external view returns (uint256);", "highlightLines": [84]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 84, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "330e5168b561", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function transfer(address to, uint256 value) external returns (bool);", "highlightLines": [89]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 89, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "d8323281a96d", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function transfer(address to, uint256 value) external returns (bool);\n\n    function approve(address spender, uint256 value) external returns (bool);\n\n    function transferFrom(\n        address from,\n        address to,\n        uint256 value\n    ) external returns (bool);\n\n    event Transfer(address indexed from, address indexed to, uint256 value);\n    event Approval(\n        address indexed owner,\n        address indexed spender,\n        uint256 value\n    );\n}\n\nlibrary SafeMath {", "highlightLines": [89]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 89, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "5c8fcb0ebf68", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without msg.data.length validation - vulnerable to short address attack padding", "ruleId": "rules.sol-short-address-no-payload-check", "snippet": {"code": "    function transfer(address to, uint256 value) external returns (bool);\n\n    function approve(address spender, uint256 value) external returns (bool);\n\n    function transferFrom(\n        address from,\n        address to,\n        uint256 value\n    ) external returns (bool);\n\n    event Transfer(address indexed from, address indexed to, uint256 value);\n    event Approval(\n        address indexed owner,\n        address indexed spender,\n        uint256 value\n    );\n}\n\nlibrary SafeMath {", "highlightLines": [89]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 89, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address", "https://vessenes.com/the-erc20-short-address-attack-explained/"], "description": ""}, {"id": "3eccb243270e", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function approve(address spender, uint256 value) external returns (bool);", "highlightLines": [91]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 91, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "faabf91db1a0", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function transferFrom(\n        address from,\n        address to,\n        uint256 value\n    ) external returns (bool);", "highlightLines": [93]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 93, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "2dc242477dbe", "fix": {"template": null, "available": false}, "title": "ERC20 transferFrom without payload size validation - consider adding onlyPayloadSize modifier", "ruleId": "rules.sol-erc20-missing-payload-modifier", "snippet": {"code": "    function transferFrom(\n        address from,\n        address to,\n        uint256 value\n    ) external returns (bool);\n\n    event Transfer(address indexed from, address indexed to, uint256 value);\n    event Approval(\n        address indexed owner,\n        address indexed spender,\n        uint256 value\n    );\n}\n\nlibrary SafeMath {", "highlightLines": [93]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 93, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address"], "description": ""}, {"id": "3fc9d3b3469e", "fix": {"template": null, "available": false}, "title": "NFT transfer without approval/ownership check - add _isApprovedOrOwner validation", "ruleId": "rules.sol-nft-transfer-no-approval-check", "snippet": {"code": "    function transferFrom(\n        address from,\n        address to,\n        uint256 value\n    ) external returns (bool);\n\n    event Transfer(address indexed from, address indexed to, uint256 value);\n    event Approval(\n        address indexed owner,\n        address indexed spender,\n        uint256 value\n    );\n}\n\nlibrary SafeMath {", "highlightLines": [93]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 93, "column": 5}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/NFT-transfer.sol"], "description": ""}, {"id": "5cc356c14582", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Transfer(address indexed from, address indexed to, uint256 value);", "highlightLines": [99]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 99, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "7ebc6417a1e6", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event Approval(\n        address indexed owner,\n        address indexed spender,\n        uint256 value\n    );", "highlightLines": [100]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 100, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "0a68d298d97b", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Approval(\n        address indexed owner,\n        address indexed spender,\n        uint256 value\n    );", "highlightLines": [100]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 100, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "0174029bdbd1", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function mul(uint256 a, uint256 b) internal pure returns (uint256) {\n        if (a == 0) {", "highlightLines": [108]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 108, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "fe19b3a4c8ab", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 c = a * b;", "highlightLines": [112]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 112, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "71e66057b1ce", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function div(uint256 a, uint256 b) internal pure returns (uint256) {\n        uint256 c = a / b;", "highlightLines": [117]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 117, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "37f05caca93b", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 c = a / b;", "highlightLines": [118]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 118, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "791d8349988f", "fix": {"template": null, "available": false}, "title": "SWC-110: assert() used for input validation - use require() instead, assert is for invariants", "ruleId": "rules.sol-swc-110-assert-user-input", "snippet": {"code": "        assert(b <= a);", "highlightLines": [123]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 123, "column": 9}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-110"], "description": ""}, {"id": "b911173897cf", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function add(uint256 a, uint256 b) internal pure returns (uint256) {\n        uint256 c = a + b;", "highlightLines": [127]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 127, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "3a7263a4bffe", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 c = a + b;", "highlightLines": [128]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 128, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ca22b3b0c709", "fix": {"template": null, "available": false}, "title": "SWC-110: assert() used for input validation - use require() instead, assert is for invariants", "ruleId": "rules.sol-swc-110-assert-user-input", "snippet": {"code": "        assert(c >= a);", "highlightLines": [129]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 129, "column": 9}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-110"], "description": ""}, {"id": "c8263d06e9c4", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function ceil(uint256 a, uint256 m) internal pure returns (uint256) {\n        uint256 c = add(a, m);\n        uint256 d = sub(c, 1);", "highlightLines": [133]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 133, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "24872c888fe7", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 c = add(a, m);", "highlightLines": [134]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 134, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "87b83756f687", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 c = add(a, m);\n        uint256 d = sub(c, 1);", "highlightLines": [134]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 134, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "56fe06c8e632", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 d = sub(c, 1);", "highlightLines": [135]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 135, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "04843cf21063", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "abstract contract ERC20Detailed is IERC20 {", "highlightLines": [140]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 140, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "e8d79c61fe8b", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "abstract contract ERC20Detailed is IERC20 {\n    string private _name;\n    string private _symbol;\n    uint8 private _decimals;", "highlightLines": [140]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 140, "column": 10}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "f79199ce8f96", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(\n        string memory name,\n        string memory symbol,\n        uint8 decimals\n    ) internal {\n        _name = name;\n        _symbol = symbol;\n        _decimals = decimals;\n    }", "highlightLines": [145]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 145, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "aa9807109014", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        _name = name;\n        _symbol = symbol;", "highlightLines": [150]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 150, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "3fa658970204", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        _symbol = symbol;\n        _decimals = decimals;", "highlightLines": [151]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 151, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "babcde5f5fff", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract STA is ERC20Detailed {\n    using SafeMath for uint256;\n    mapping(address => uint256) private _balances;\n    mapping(address => mapping(address => uint256)) private _allowed;\n\n    string constant tokenName = \"Statera\";\n    string constant tokenSymbol = \"STA\";\n    uint8 constant tokenDecimals = 18;\n    uint256 _totalSupply = 100000000000000000000000000;\n    uint256 public basePercent = 100;", "highlightLines": [168]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 168, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "407928e55b0f", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 _totalSupply = 100000000000000000000000000;", "highlightLines": [176]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 176, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "6bc15450d31e", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    uint256 _totalSupply = 100000000000000000000000000;", "highlightLines": [176]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 176, "column": 28}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "9fd191c46f72", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function cut(uint256 value) public view returns (uint256) {\n        uint256 roundValue = value.ceil(basePercent);\n        uint256 cutValue = roundValue.mul(basePercent).div(10000);", "highlightLines": [202]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 202, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "1a58277dbb48", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 roundValue = value.ceil(basePercent);", "highlightLines": [203]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 203, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "582e86627ee2", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 roundValue = value.ceil(basePercent);\n        uint256 cutValue = roundValue.mul(basePercent).div(10000);", "highlightLines": [203]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 203, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "be0da552eeba", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 cutValue = roundValue.mul(basePercent).div(10000);", "highlightLines": [204]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 204, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e88c311eaa83", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function transfer(address to, uint256 value) public returns (bool) {", "highlightLines": [208]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 208, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "a32399f7ff97", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without msg.data.length validation - vulnerable to short address attack padding", "ruleId": "rules.sol-short-address-no-payload-check", "snippet": {"code": "    function transfer(address to, uint256 value) public returns (bool) {", "highlightLines": [208]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 208, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address", "https://vessenes.com/the-erc20-short-address-attack-explained/"], "description": ""}, {"id": "e3fc90c1eb7f", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "    function transfer(address to, uint256 value) public returns (bool) {\n        require(value <= _balances[msg.sender]);\n        require(to != address(0));", "highlightLines": [208]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 208, "column": 5}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "39ff097fa71b", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - will never return false, only revert", "ruleId": "rules.sol-return-bool-always-reverts", "snippet": {"code": "    function transfer(address to, uint256 value) public returns (bool) {\n        require(value <= _balances[msg.sender]);\n        require(to != address(0));\n\n        uint256 tokensToBurn = cut(value);\n        uint256 tokensToTransfer = value.sub(tokensToBurn);\n\n        _balances[msg.sender] = _balances[msg.sender].sub(value);\n        _balances[to] = _balances[to].add(tokensToTransfer);\n\n        _totalSupply = _totalSupply.sub(tokensToBurn);\n\n        emit Transfer(msg.sender, to, tokensToTransfer);\n        emit Transfer(msg.sender, address(0), tokensToBurn);\n        return true;\n    }", "highlightLines": [208]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 208, "column": 5}, "severity": "info", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "2864f23e4b5e", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(value <= _balances[msg.sender]);", "highlightLines": [209]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 209, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "f814b3d60a66", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(to != address(0));", "highlightLines": [210]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 210, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "1c79910edb0d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 tokensToBurn = cut(value);", "highlightLines": [211]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 211, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7d2c8d1d95cb", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 tokensToBurn = cut(value);\n        uint256 tokensToTransfer = value.sub(tokensToBurn);", "highlightLines": [212]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 212, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "4d6c905afd96", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 tokensToTransfer = value.sub(tokensToBurn);", "highlightLines": [213]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 213, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f9b89c149bd6", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 tokensToTransfer = value.sub(tokensToBurn);\n\n        _balances[msg.sender] = _balances[msg.sender].sub(value);", "highlightLines": [213]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 213, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "2bc6e6517a1c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        _balances[msg.sender] = _balances[msg.sender].sub(value);\n        _balances[to] = _balances[to].add(tokensToTransfer);", "highlightLines": [215]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 215, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "34153ea36593", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        _balances[to] = _balances[to].add(tokensToTransfer);\n\n        _totalSupply = _totalSupply.sub(tokensToBurn);", "highlightLines": [216]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 216, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "79f668ceb490", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function approve(address spender, uint256 value) public returns (bool) {", "highlightLines": [225]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 225, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "b13c768d3390", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "    function approve(address spender, uint256 value) public returns (bool) {\n        require(spender != address(0));", "highlightLines": [225]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 225, "column": 5}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "e03d97fa04bd", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - will never return false, only revert", "ruleId": "rules.sol-return-bool-always-reverts", "snippet": {"code": "    function approve(address spender, uint256 value) public returns (bool) {\n        require(spender != address(0));\n        _allowed[msg.sender][spender] = value;\n        emit Approval(msg.sender, spender, value);\n        return true;\n    }", "highlightLines": [225]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 225, "column": 5}, "severity": "info", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "e871eeb0d5d7", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(spender != address(0));", "highlightLines": [226]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 226, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "23b9513c133c", "fix": {"template": null, "available": false}, "title": "ERC20 transferFrom without payload size validation - consider adding onlyPayloadSize modifier", "ruleId": "rules.sol-erc20-missing-payload-modifier", "snippet": {"code": "    function transferFrom(\n        address from,\n        address to,\n        uint256 value\n    ) public returns (bool) {", "highlightLines": [232]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 232, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address"], "description": ""}, {"id": "06bd6750d8a5", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function transferFrom(\n        address from,\n        address to,\n        uint256 value\n    ) public returns (bool) {", "highlightLines": [232]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 232, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "0535bb1af779", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "    function transferFrom(\n        address from,\n        address to,\n        uint256 value\n    ) public returns (bool) {\n        require(value <= _balances[from]);\n        require(value <= _allowed[from][msg.sender]);\n        require(to != address(0));", "highlightLines": [232]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 232, "column": 5}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "59ce7f1167f8", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - will never return false, only revert", "ruleId": "rules.sol-return-bool-always-reverts", "snippet": {"code": "    function transferFrom(\n        address from,\n        address to,\n        uint256 value\n    ) public returns (bool) {\n        require(value <= _balances[from]);\n        require(value <= _allowed[from][msg.sender]);\n        require(to != address(0));\n\n        _balances[from] = _balances[from].sub(value);\n\n        uint256 tokensToBurn = cut(value);\n        uint256 tokensToTransfer = value.sub(tokensToBurn);\n\n        _balances[to] = _balances[to].add(tokensToTransfer);\n        _totalSupply = _totalSupply.sub(tokensToBurn);\n\n        _allowed[from][msg.sender] = _allowed[from][msg.sender].sub(value);\n\n        emit Transfer(from, to, tokensToTransfer);\n        emit Transfer(from, address(0), tokensToBurn);\n\n        return true;\n    }", "highlightLines": [232]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 232, "column": 5}, "severity": "info", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "5b6ea9c848e4", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(value <= _balances[from]);", "highlightLines": [237]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 237, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "3623d16e83e9", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(value <= _allowed[from][msg.sender]);", "highlightLines": [238]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 238, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "deb0657e87d0", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(to != address(0));", "highlightLines": [239]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 239, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "a33ab9c769c2", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        _balances[from] = _balances[from].sub(value);\n\n        uint256 tokensToBurn = cut(value);", "highlightLines": [241]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 241, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "6f8db64cb481", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 tokensToBurn = cut(value);", "highlightLines": [242]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 242, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "07bf9c4022ca", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 tokensToBurn = cut(value);\n        uint256 tokensToTransfer = value.sub(tokensToBurn);", "highlightLines": [243]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 243, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "28144072dddc", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 tokensToTransfer = value.sub(tokensToBurn);", "highlightLines": [244]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 244, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3a15ff476f2a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 tokensToTransfer = value.sub(tokensToBurn);\n\n        _balances[to] = _balances[to].add(tokensToTransfer);", "highlightLines": [244]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 244, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "18037fbc7d63", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        _balances[to] = _balances[to].add(tokensToTransfer);\n        _totalSupply = _totalSupply.sub(tokensToBurn);", "highlightLines": [246]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 246, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "1c489a05aa20", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        _totalSupply = _totalSupply.sub(tokensToBurn);\n\n        _allowed[from][msg.sender] = _allowed[from][msg.sender].sub(value);", "highlightLines": [247]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 247, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "2e1caed08b76", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "    function upAllowance(\n        address spender,\n        uint256 addedValue\n    ) public returns (bool) {\n        require(spender != address(0));", "highlightLines": [257]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 257, "column": 5}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "1ec4b5a9fe60", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - will never return false, only revert", "ruleId": "rules.sol-return-bool-always-reverts", "snippet": {"code": "    function upAllowance(\n        address spender,\n        uint256 addedValue\n    ) public returns (bool) {\n        require(spender != address(0));\n        _allowed[msg.sender][spender] = (\n            _allowed[msg.sender][spender].add(addedValue)\n        );\n        emit Approval(msg.sender, spender, _allowed[msg.sender][spender]);\n        return true;\n    }", "highlightLines": [257]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 257, "column": 5}, "severity": "info", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "789efa6df39b", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(spender != address(0));", "highlightLines": [261]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 261, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "9addfa02e957", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "    function downAllowance(\n        address spender,\n        uint256 subtractedValue\n    ) public returns (bool) {\n        require(spender != address(0));", "highlightLines": [269]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 269, "column": 5}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "03697ad8a728", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - will never return false, only revert", "ruleId": "rules.sol-return-bool-always-reverts", "snippet": {"code": "    function downAllowance(\n        address spender,\n        uint256 subtractedValue\n    ) public returns (bool) {\n        require(spender != address(0));\n        _allowed[msg.sender][spender] = (\n            _allowed[msg.sender][spender].sub(subtractedValue)\n        );\n        emit Approval(msg.sender, spender, _allowed[msg.sender][spender]);\n        return true;\n    }", "highlightLines": [269]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 269, "column": 5}, "severity": "info", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "40e5a1cd8c6b", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(spender != address(0));", "highlightLines": [273]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 273, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "cc8ffd6ecfae", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(amount != 0);", "highlightLines": [282]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 282, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "cb7533df3bb6", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(amount != 0);", "highlightLines": [292]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 292, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "9a2930f1b148", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(amount <= _balances[account]);", "highlightLines": [293]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 293, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "1008093cbbb9", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        _totalSupply = _totalSupply.sub(amount);\n        _balances[account] = _balances[account].sub(amount);", "highlightLines": [294]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 294, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "6e9beac02f7e", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(amount <= _allowed[account][msg.sender]);", "highlightLines": [300]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 300, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "95172d710f68", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Deposit(address indexed depositor, uint256 amount);", "highlightLines": [314]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 314, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "2dcc64060395", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Withdrawal(address indexed recipient, uint256 amount);", "highlightLines": [315]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 315, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "94c7152216a6", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(address _tokenAddress) {\n        token = IERC20(_tokenAddress);\n    }", "highlightLines": [317]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 317, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "ae318e875f0e", "fix": {"template": null, "available": false}, "title": "Token transfer without before/after balance comparison - rebasing/fee tokens may transfer different amounts", "ruleId": "rules.sol-no-balance-before-after", "snippet": {"code": "    function deposit(uint256 amount) external {\n        require(amount > 0, \"Deposit amount must be greater than zero\");\n\n        token.transferFrom(msg.sender, address(this), amount);", "highlightLines": [321]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 321, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "161ba462df55", "fix": {"template": null, "available": false}, "title": "ERC777 token interaction without reentrancy guard - token hooks can reenter", "ruleId": "rules.sol-erc777-without-reentrancy-guard", "snippet": {"code": "    function deposit(uint256 amount) external {\n        require(amount > 0, \"Deposit amount must be greater than zero\");\n\n        token.transferFrom(msg.sender, address(this), amount);", "highlightLines": [321]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 321, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "e8d2731b0c98", "fix": {"template": null, "available": false}, "title": "Token transfer without checking actual received amount - deflationary tokens may transfer less", "ruleId": "rules.sol-deflationary-token-transfer", "snippet": {"code": "        token.transferFrom(msg.sender, address(this), amount);", "highlightLines": [324]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 324, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "147016683bc4", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        token.transferFrom(msg.sender, address(this), amount);", "highlightLines": [324]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 324, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "3de5a03682c9", "fix": {"template": null, "available": false}, "title": "Token amount after transfer may differ - check actual received amount", "ruleId": "rules.sol-fee-on-transfer-token", "snippet": {"code": "        token.transferFrom(msg.sender, address(this), amount);", "highlightLines": [324]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 324, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "6b515bc49a4b", "fix": {"template": null, "available": false}, "title": "require() in withdrawal path - griefing possible if condition can be manipulated", "ruleId": "rules.sol-force-revert-griefing", "snippet": {"code": "    function withdraw(uint256 amount) external {\n        require(amount > 0, \"Withdrawal amount must be greater than zero\");\n        require(amount <= balances[msg.sender], \"Insufficient balance\");", "highlightLines": [329]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 329, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "20c808241b53", "fix": {"template": null, "available": false}, "title": "SWC-105: Ether withdrawal without access control - anyone can drain funds", "ruleId": "rules.sol-swc-105-unprotected-withdrawal", "snippet": {"code": "    function withdraw(uint256 amount) external {\n        require(amount > 0, \"Withdrawal amount must be greater than zero\");\n        require(amount <= balances[msg.sender], \"Insufficient balance\");\n\n        balances[msg.sender] -= amount;\n        token.transfer(msg.sender, amount);", "highlightLines": [329]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 329, "column": 5}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-105"], "description": ""}, {"id": "1dc839c152e4", "fix": {"template": null, "available": false}, "title": "Bridge withdrawal without Merkle proof verification", "ruleId": "rules.sol-bridge-withdrawal-no-merkle-verify", "snippet": {"code": "        token.transfer(msg.sender, amount);", "highlightLines": [334]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 334, "column": 9}, "severity": "high", "references": [], "description": ""}, {"id": "6a4c8042920e", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        token.transfer(msg.sender, amount);", "highlightLines": [334]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 334, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "d50ed13ab9ec", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "        token.transfer(msg.sender, amount);", "highlightLines": [334]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 334, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "054ff53cea79", "fix": {"template": null, "available": false}, "title": "ERC20 transfer() return value not checked - tokens like USDT don't return bool", "ruleId": "rules.sol-erc20-transfer-no-return-check", "snippet": {"code": "        token.transfer(msg.sender, amount);", "highlightLines": [334]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 334, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "0ea1f9df65ab", "fix": {"template": null, "available": false}, "title": "Event emitted after external call - reentrancy can cause events to be logged out of order", "ruleId": "rules.sol-event-after-external-call", "snippet": {"code": "        token.transfer(msg.sender, amount);\n        emit Withdrawal(msg.sender, amount);", "highlightLines": [334]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 334, "column": 14}, "severity": "info", "references": [], "description": ""}, {"id": "af9792e3b7fe", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Deposit(address indexed depositor, uint256 amount);", "highlightLines": [349]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 349, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "eeefc3a8fcb4", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Withdrawal(address indexed recipient, uint256 amount);", "highlightLines": [350]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 350, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "a625f60da7d7", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(address _tokenAddress) {\n        token = IERC20(_tokenAddress);\n    }", "highlightLines": [352]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 352, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "7532c65bafcd", "fix": {"template": null, "available": false}, "title": "ERC777 token interaction without reentrancy guard - token hooks can reenter", "ruleId": "rules.sol-erc777-without-reentrancy-guard", "snippet": {"code": "    function deposit(uint256 amount) external {\n        require(amount > 0, \"Deposit amount must be greater than zero\");\n\n        uint256 balanceBefore = token.balanceOf(address(this));\n\n        token.transferFrom(msg.sender, address(this), amount);", "highlightLines": [356]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 356, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "920ffba0aaad", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 balanceBefore = token.balanceOf(address(this));", "highlightLines": [358]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 358, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f8fdb1ed4f5b", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "        uint256 balanceBefore = token.balanceOf(address(this));\n\n        token.transferFrom(msg.sender, address(this), amount);\n\n        uint256 balanceAfter = token.balanceOf(address(this));", "highlightLines": [359]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 359, "column": 9}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "c358c16f365b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 balanceBefore = token.balanceOf(address(this));\n\n        token.transferFrom(msg.sender, address(this), amount);\n\n        uint256 balanceAfter = token.balanceOf(address(this));", "highlightLines": [359]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 359, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "f4d7ecef9fe7", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        token.transferFrom(msg.sender, address(this), amount);", "highlightLines": [361]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 361, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "1574cb12b9bd", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 balanceAfter = token.balanceOf(address(this));", "highlightLines": [362]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 362, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "26f8d1539146", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 balanceAfter = token.balanceOf(address(this));\n        uint256 actualDepositAmount = balanceAfter - balanceBefore;", "highlightLines": [363]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 363, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e7f301ce4ae9", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 actualDepositAmount = balanceAfter - balanceBefore;", "highlightLines": [364]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 364, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e77282332269", "fix": {"template": null, "available": false}, "title": "require() in withdrawal path - griefing possible if condition can be manipulated", "ruleId": "rules.sol-force-revert-griefing", "snippet": {"code": "    function withdraw(uint256 amount) external {\n        require(amount > 0, \"Withdrawal amount must be greater than zero\");\n        require(amount <= balances[msg.sender], \"Insufficient balance\");", "highlightLines": [370]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 370, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "7ab44e328a8c", "fix": {"template": null, "available": false}, "title": "SWC-105: Ether withdrawal without access control - anyone can drain funds", "ruleId": "rules.sol-swc-105-unprotected-withdrawal", "snippet": {"code": "    function withdraw(uint256 amount) external {\n        require(amount > 0, \"Withdrawal amount must be greater than zero\");\n        require(amount <= balances[msg.sender], \"Insufficient balance\");\n\n        balances[msg.sender] -= amount;\n        token.transfer(msg.sender, amount);", "highlightLines": [370]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 370, "column": 5}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-105"], "description": ""}, {"id": "78fc2cb02661", "fix": {"template": null, "available": false}, "title": "Bridge withdrawal without Merkle proof verification", "ruleId": "rules.sol-bridge-withdrawal-no-merkle-verify", "snippet": {"code": "        token.transfer(msg.sender, amount);", "highlightLines": [375]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 375, "column": 9}, "severity": "high", "references": [], "description": ""}, {"id": "f0dae151a62a", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        token.transfer(msg.sender, amount);", "highlightLines": [375]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 375, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "44fb83fd480f", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "        token.transfer(msg.sender, amount);", "highlightLines": [375]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 375, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "ec99f4923cb6", "fix": {"template": null, "available": false}, "title": "ERC20 transfer() return value not checked - tokens like USDT don't return bool", "ruleId": "rules.sol-erc20-transfer-no-return-check", "snippet": {"code": "        token.transfer(msg.sender, amount);", "highlightLines": [375]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 375, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "45d7043afeeb", "fix": {"template": null, "available": false}, "title": "Event emitted after external call - reentrancy can cause events to be logged out of order", "ruleId": "rules.sol-event-after-external-call", "snippet": {"code": "        token.transfer(msg.sender, amount);\n        emit Withdrawal(msg.sender, amount);", "highlightLines": [375]}, "category": "code", "location": {"file": "src/test/fee-on-transfer.sol", "line": 375, "column": 14}, "severity": "info", "references": [], "description": ""}, {"id": "076183282d83", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.15;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/first-deposit.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "c6544e547210", "fix": {"template": null, "available": false}, "title": "Consider using Ownable2Step instead of Ownable for safer ownership transfers", "ruleId": "rules.sol-use-ownable2step", "snippet": {"code": "import \"@openzeppelin/contracts/access/Ownable.sol\";", "highlightLines": [6]}, "category": "code", "location": {"file": "src/test/first-deposit.sol", "line": 6, "column": 1}, "severity": "info", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/access/Ownable2Step.sol"], "description": ""}, {"id": "62cc8941326d", "fix": {"template": null, "available": false}, "title": "Share calculation vulnerable to first depositor attack - attacker can inflate share price", "ruleId": "rules.sol-first-depositor-attack", "snippet": {"code": "The same can be done in this case i.e. when totalSupply() == 0,", "highlightLines": [26]}, "category": "code", "location": {"file": "src/test/first-deposit.sol", "line": 26, "column": 45}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs", "https://blog.openzeppelin.com/compound-comprehensive-security-assessment"], "description": ""}, {"id": "f3f150bbff21", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        MyTokenContract = new MyToken();\n        SimplePoolContract = new SimplePool(address(MyTokenContract));", "highlightLines": [40]}, "category": "code", "location": {"file": "src/test/first-deposit.sol", "line": 40, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d95ffb776401", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        MyTokenContract = new MyToken();", "highlightLines": [40]}, "category": "code", "location": {"file": "src/test/first-deposit.sol", "line": 40, "column": 27}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "8ae5b3b66e7d", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        SimplePoolContract = new SimplePool(address(MyTokenContract));", "highlightLines": [41]}, "category": "code", "location": {"file": "src/test/first-deposit.sol", "line": 41, "column": 30}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "d21dc8626a90", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address alice = vm.addr(1);", "highlightLines": [45]}, "category": "code", "location": {"file": "src/test/first-deposit.sol", "line": 45, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "6f4e1c9fd795", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "        address alice = vm.addr(1);\n        address bob = vm.addr(2);", "highlightLines": [45]}, "category": "code", "location": {"file": "src/test/first-deposit.sol", "line": 45, "column": 9}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "08b5e9af42f4", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address alice = vm.addr(1);\n        address bob = vm.addr(2);", "highlightLines": [45]}, "category": "code", "location": {"file": "src/test/first-deposit.sol", "line": 45, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "f0911b3b1420", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address bob = vm.addr(2);", "highlightLines": [46]}, "category": "code", "location": {"file": "src/test/first-deposit.sol", "line": 46, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "bc31a5f52e05", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        MyTokenContract.transfer(alice, 1 ether + 1);", "highlightLines": [47]}, "category": "code", "location": {"file": "src/test/first-deposit.sol", "line": 47, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "6a338f679104", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "        MyTokenContract.transfer(alice, 1 ether + 1);", "highlightLines": [47]}, "category": "code", "location": {"file": "src/test/first-deposit.sol", "line": 47, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "089c90fbbeef", "fix": {"template": null, "available": false}, "title": "ERC20 transfer() return value not checked - tokens like USDT don't return bool", "ruleId": "rules.sol-erc20-transfer-no-return-check", "snippet": {"code": "        MyTokenContract.transfer(alice, 1 ether + 1);", "highlightLines": [47]}, "category": "code", "location": {"file": "src/test/first-deposit.sol", "line": 47, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "96f2f3e137c1", "fix": {"template": null, "available": false}, "title": "Balance checked after transfer - use balanceBefore/balanceAfter pattern", "ruleId": "rules.sol-balance-after-transfer", "snippet": {"code": "        MyTokenContract.transfer(alice, 1 ether + 1);\n        MyTokenContract.transfer(bob, 2 ether);\n\n        vm.startPrank(alice);\n        // Alice deposits 1 wei, gets 1 pool token\n        MyTokenContract.approve(address(SimplePoolContract), 1);\n        SimplePoolContract.deposit(1);\n\n        // Alice transfers 1 ether to the pool, inflating the pool token price\n        MyTokenContract.transfer(address(SimplePoolContract), 1 ether);\n\n        vm.stopPrank();\n        vm.startPrank(bob);\n        // Bob deposits 2 ether, gets 1 pool token due to inflated price\n        // uint shares = _tokenAmount * _sharesTotalSupply / _supplied;\n        // shares = 2000000000000000000 * 1 / 1000000000000000001 = 1.9999999999999999999 => round down to 1.\n        MyTokenContract.approve(address(SimplePoolContract), 2 ether);\n        SimplePoolContract.deposit(2 ether);\n        vm.stopPrank();\n        vm.startPrank(alice);\n\n        MyTokenContract.balanceOf(address(SimplePoolContract));\n\n        // Alice withdraws and gets 1.5 ether, making a profit\n        SimplePoolContract.withdraw(1);\n        assertEq(MyTokenContract.balanceOf(alice), 1.5 ether);\n        console.log(\"Alice balance\", MyTokenContract.balanceOf(alice));", "highlightLines": [47]}, "category": "code", "location": {"file": "src/test/first-deposit.sol", "line": 47, "column": 24}, "severity": "info", "references": [], "description": ""}, {"id": "7f469c611844", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        MyTokenContract.transfer(bob, 2 ether);", "highlightLines": [48]}, "category": "code", "location": {"file": "src/test/first-deposit.sol", "line": 48, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "658c209fcee8", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "        MyTokenContract.transfer(bob, 2 ether);", "highlightLines": [48]}, "category": "code", "location": {"file": "src/test/first-deposit.sol", "line": 48, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "52d36d3b31ed", "fix": {"template": null, "available": false}, "title": "ERC20 transfer() return value not checked - tokens like USDT don't return bool", "ruleId": "rules.sol-erc20-transfer-no-return-check", "snippet": {"code": "        MyTokenContract.transfer(bob, 2 ether);", "highlightLines": [48]}, "category": "code", "location": {"file": "src/test/first-deposit.sol", "line": 48, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "b3f85567b8ee", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        MyTokenContract.transfer(address(SimplePoolContract), 1 ether);", "highlightLines": [56]}, "category": "code", "location": {"file": "src/test/first-deposit.sol", "line": 56, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "1701d5b4359d", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "        MyTokenContract.transfer(address(SimplePoolContract), 1 ether);", "highlightLines": [56]}, "category": "code", "location": {"file": "src/test/first-deposit.sol", "line": 56, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "a40550fad7ee", "fix": {"template": null, "available": false}, "title": "ERC20 transfer() return value not checked - tokens like USDT don't return bool", "ruleId": "rules.sol-erc20-transfer-no-return-check", "snippet": {"code": "        MyTokenContract.transfer(address(SimplePoolContract), 1 ether);", "highlightLines": [56]}, "category": "code", "location": {"file": "src/test/first-deposit.sol", "line": 56, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "2da81341314c", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    receive() external payable {}", "highlightLines": [76]}, "category": "code", "location": {"file": "src/test/first-deposit.sol", "line": 76, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "e7e69872278f", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "    receive() external payable {}", "highlightLines": [76]}, "category": "code", "location": {"file": "src/test/first-deposit.sol", "line": 76, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "3e70a075fa09", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor() ERC20(\"MyToken\", \"MTK\") {\n        _mint(msg.sender, 10000 * 10 ** decimals());\n    }", "highlightLines": [80]}, "category": "code", "location": {"file": "src/test/first-deposit.sol", "line": 80, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "a25963dd7a1d", "fix": {"template": null, "available": false}, "title": "NFT mint without supply check - potential overflow in tokenId", "ruleId": "rules.sol-nft-overflow-mint", "snippet": {"code": "        _mint(msg.sender, 10000 * 10 ** decimals());", "highlightLines": [81]}, "category": "code", "location": {"file": "src/test/first-deposit.sol", "line": 81, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "0e326914555b", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function mint(address to, uint256 amount) public onlyOwner {", "highlightLines": [84]}, "category": "code", "location": {"file": "src/test/first-deposit.sol", "line": 84, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "b971af271309", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function mint(address to, uint256 amount) public onlyOwner {", "highlightLines": [84]}, "category": "code", "location": {"file": "src/test/first-deposit.sol", "line": 84, "column": 54}, "severity": "info", "references": [], "description": ""}, {"id": "75662f78e292", "fix": {"template": null, "available": false}, "title": "Owner has excessive privileges - single account controls critical functions without checks", "ruleId": "rules.sol-owner-privilege-escalation", "snippet": {"code": "    function mint(address to, uint256 amount) public onlyOwner {\n        _mint(to, amount);", "highlightLines": [84]}, "category": "code", "location": {"file": "src/test/first-deposit.sol", "line": 84, "column": 54}, "severity": "medium", "references": [], "description": ""}, {"id": "84de26b1b933", "fix": {"template": null, "available": false}, "title": "NFT mint without supply check - potential overflow in tokenId", "ruleId": "rules.sol-nft-overflow-mint", "snippet": {"code": "        _mint(to, amount);", "highlightLines": [85]}, "category": "code", "location": {"file": "src/test/first-deposit.sol", "line": 85, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "7a1ab90b684e", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(address _loanToken) {\n        loanToken = IERC20(_loanToken);\n    }", "highlightLines": [95]}, "category": "code", "location": {"file": "src/test/first-deposit.sol", "line": 95, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "d86dcc5e960c", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function deposit(uint amount) external {", "highlightLines": [99]}, "category": "code", "location": {"file": "src/test/first-deposit.sol", "line": 99, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "eabf91a48e79", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint _shares;", "highlightLines": [101]}, "category": "code", "location": {"file": "src/test/first-deposit.sol", "line": 101, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e903a9ca2dee", "fix": {"template": null, "available": false}, "title": "Token transfer without checking actual received amount - deflationary tokens may transfer less", "ruleId": "rules.sol-deflationary-token-transfer", "snippet": {"code": "            loanToken.transferFrom(msg.sender, address(this), amount),", "highlightLines": [115]}, "category": "code", "location": {"file": "src/test/first-deposit.sol", "line": 115, "column": 13}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "810317b7af10", "fix": {"template": null, "available": false}, "title": "Token amount after transfer may differ - check actual received amount", "ruleId": "rules.sol-fee-on-transfer-token", "snippet": {"code": "            loanToken.transferFrom(msg.sender, address(this), amount),", "highlightLines": [115]}, "category": "code", "location": {"file": "src/test/first-deposit.sol", "line": 115, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "ae156779c4c1", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function tokenToShares(\n        uint _tokenAmount,\n        uint _supplied,\n        uint _sharesTotalSupply,\n        bool roundUpCheck\n    ) internal pure returns (uint) {\n        if (_supplied == 0) return _tokenAmount;", "highlightLines": [122]}, "category": "code", "location": {"file": "src/test/first-deposit.sol", "line": 122, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "16831db3b746", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function tokenToShares(\n        uint _tokenAmount,\n        uint _supplied,\n        uint _sharesTotalSupply,\n        bool roundUpCheck\n    ) internal pure returns (uint) {\n        if (_supplied == 0) return _tokenAmount;\n        uint shares = (_tokenAmount * _sharesTotalSupply) / _supplied;", "highlightLines": [122]}, "category": "code", "location": {"file": "src/test/first-deposit.sol", "line": 122, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "22ddae10bddc", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "        if (_supplied == 0) return _tokenAmount;\n        uint shares = (_tokenAmount * _sharesTotalSupply) / _supplied;", "highlightLines": [128]}, "category": "code", "location": {"file": "src/test/first-deposit.sol", "line": 128, "column": 29}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "d03f96230d63", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint shares = (_tokenAmount * _sharesTotalSupply) / _supplied;", "highlightLines": [129]}, "category": "code", "location": {"file": "src/test/first-deposit.sol", "line": 129, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "50196deaeaf0", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function withdraw(uint shares) external {", "highlightLines": [137]}, "category": "code", "location": {"file": "src/test/first-deposit.sol", "line": 137, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "327545db45ef", "fix": {"template": null, "available": false}, "title": "require() in withdrawal path - griefing possible if condition can be manipulated", "ruleId": "rules.sol-force-revert-griefing", "snippet": {"code": "    function withdraw(uint shares) external {\n        require(shares > 0, \"Shares must be greater than zero\");\n        require(balanceOf[msg.sender] >= shares, \"Insufficient balance\");", "highlightLines": [137]}, "category": "code", "location": {"file": "src/test/first-deposit.sol", "line": 137, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "e0833228d841", "fix": {"template": null, "available": false}, "title": "SWC-105: Ether withdrawal without access control - anyone can drain funds", "ruleId": "rules.sol-swc-105-unprotected-withdrawal", "snippet": {"code": "    function withdraw(uint shares) external {\n        require(shares > 0, \"Shares must be greater than zero\");\n        require(balanceOf[msg.sender] >= shares, \"Insufficient balance\");\n\n        uint tokenAmount = (shares * loanToken.balanceOf(address(this))) /\n            totalShares;\n\n        balanceOf[msg.sender] -= shares;\n        totalShares -= shares;\n\n        require(loanToken.transfer(msg.sender, tokenAmount), \"Transfer failed\");", "highlightLines": [137]}, "category": "code", "location": {"file": "src/test/first-deposit.sol", "line": 137, "column": 5}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-105"], "description": ""}, {"id": "bab8d94534ec", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint tokenAmount = (shares * loanToken.balanceOf(address(this))) /", "highlightLines": [140]}, "category": "code", "location": {"file": "src/test/first-deposit.sol", "line": 140, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "1dccacab4aef", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "            totalShares;", "highlightLines": [142]}, "category": "code", "location": {"file": "src/test/first-deposit.sol", "line": 142, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "1c3fa2dbf465", "fix": {"template": null, "available": false}, "title": "Bridge withdrawal without Merkle proof verification", "ruleId": "rules.sol-bridge-withdrawal-no-merkle-verify", "snippet": {"code": "        require(loanToken.transfer(msg.sender, tokenAmount), \"Transfer failed\");", "highlightLines": [147]}, "category": "code", "location": {"file": "src/test/first-deposit.sol", "line": 147, "column": 17}, "severity": "high", "references": [], "description": ""}, {"id": "f529847e602b", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.18;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/gas-price.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "3608f895182f", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        GasReimbursementContract = new GasReimbursement();", "highlightLines": [32]}, "category": "code", "location": {"file": "src/test/gas-price.sol", "line": 32, "column": 36}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "88f31921198b", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint balanceBefore = address(this).balance;", "highlightLines": [37]}, "category": "code", "location": {"file": "src/test/gas-price.sol", "line": 37, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "db50321ba5e7", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint balanceBefore = address(this).balance;\n        GasReimbursementContract.executeTransfer(address(this));\n        uint balanceAfter = address(this).balance - tx.gasprice; // --gas-price 200000000000000", "highlightLines": [37]}, "category": "code", "location": {"file": "src/test/gas-price.sol", "line": 37, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "f13b412194c0", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint balanceAfter = address(this).balance - tx.gasprice; // --gas-price 200000000000000", "highlightLines": [39]}, "category": "code", "location": {"file": "src/test/gas-price.sol", "line": 39, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "de328abf7361", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    receive() external payable {}", "highlightLines": [43]}, "category": "code", "location": {"file": "src/test/gas-price.sol", "line": 43, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "30cf8a7ab0d3", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "    receive() external payable {}", "highlightLines": [43]}, "category": "code", "location": {"file": "src/test/gas-price.sol", "line": 43, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "b1392035e443", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function calculateTotalFee() public view returns (uint) {\n        uint256 totalFee = (gasUsed + GAS_OVERHEAD_NATIVE) * tx.gasprice;", "highlightLines": [52]}, "category": "code", "location": {"file": "src/test/gas-price.sol", "line": 52, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "c156672d2ecc", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 totalFee = (gasUsed + GAS_OVERHEAD_NATIVE) * tx.gasprice;", "highlightLines": [53]}, "category": "code", "location": {"file": "src/test/gas-price.sol", "line": 53, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "9e22a3b4dd94", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "        uint256 totalFee = (gasUsed + GAS_OVERHEAD_NATIVE) * tx.gasprice;", "highlightLines": [53]}, "category": "code", "location": {"file": "src/test/gas-price.sol", "line": 53, "column": 9}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "887bda83998e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 totalFee = calculateTotalFee();", "highlightLines": [58]}, "category": "code", "location": {"file": "src/test/gas-price.sol", "line": 58, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b66e37fc2cb1", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "        uint256 totalFee = calculateTotalFee();", "highlightLines": [58]}, "category": "code", "location": {"file": "src/test/gas-price.sol", "line": 58, "column": 9}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "417743ee31c7", "fix": {"template": null, "available": false}, "title": "payable.transfer() has 2300 gas limit - fails for contracts with receive logic", "ruleId": "rules.sol-payable-transfer-gas-limit", "snippet": {"code": "        payable(recipient).transfer(amount);", "highlightLines": [63]}, "category": "code", "location": {"file": "src/test/gas-price.sol", "line": 63, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/payable-transfer.sol"], "description": ""}, {"id": "d39e6596705d", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        payable(recipient).transfer(amount);", "highlightLines": [63]}, "category": "code", "location": {"file": "src/test/gas-price.sol", "line": 63, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "af0b8392c78f", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "        payable(recipient).transfer(amount);", "highlightLines": [63]}, "category": "code", "location": {"file": "src/test/gas-price.sol", "line": 63, "column": 9}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "d4b0ca1af95c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes data;", "highlightLines": [11]}, "category": "code", "location": {"file": "src/test/interface.sol", "line": 11, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "193afb97d3ab", "fix": {"template": null, "available": false}, "title": "Storage write without access control - arbitrary data manipulation", "ruleId": "rules.sol-unprotected-storage-write", "snippet": {"code": "    function store(address, bytes32, bytes32) external;\n\n    // Signs data, (privateKey, digest) => (v, r, s)\n    function sign(uint256, bytes32) external returns (uint8, bytes32, bytes32);\n\n    // Gets address for a given private key, (privateKey) => (address)\n    function addr(uint256) external returns (address);\n\n    // Derive a private key from a provided mnenomic string (or mnenomic file path) at the derivation path m/44'/60'/0'/0/{index}", "highlightLines": [30]}, "category": "code", "location": {"file": "src/test/interface.sol", "line": 30, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "acfd9ce83497", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function balanceOf(address account) external view returns (uint);", "highlightLines": [299]}, "category": "code", "location": {"file": "src/test/interface.sol", "line": 299, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "9aba89d4c1c1", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function transfer(address recipient, uint amount) external returns (bool);", "highlightLines": [301]}, "category": "code", "location": {"file": "src/test/interface.sol", "line": 301, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "45dcc3f26a1b", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function transfer(address recipient, uint amount) external returns (bool);\n\n    function allowance(\n        address owner,\n        address spender\n    ) external view returns (uint);\n\n    function approve(address spender, uint amount) external returns (bool);\n\n    function transferFrom(\n        address sender,\n        address recipient,\n        uint amount\n    ) external returns (bool);\n\n    event Transfer(address indexed from, address indexed to, uint value);\n    event Approval(address indexed owner, address indexed spender, uint value);\n}\n\ninterface IFantasticWeslie {", "highlightLines": [301]}, "category": "code", "location": {"file": "src/test/interface.sol", "line": 301, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "2780ce11909e", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without msg.data.length validation - vulnerable to short address attack padding", "ruleId": "rules.sol-short-address-no-payload-check", "snippet": {"code": "    function transfer(address recipient, uint amount) external returns (bool);\n\n    function allowance(\n        address owner,\n        address spender\n    ) external view returns (uint);\n\n    function approve(address spender, uint amount) external returns (bool);\n\n    function transferFrom(\n        address sender,\n        address recipient,\n        uint amount\n    ) external returns (bool);\n\n    event Transfer(address indexed from, address indexed to, uint value);\n    event Approval(address indexed owner, address indexed spender, uint value);\n}\n\ninterface IFantasticWeslie {", "highlightLines": [301]}, "category": "code", "location": {"file": "src/test/interface.sol", "line": 301, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address", "https://vessenes.com/the-erc20-short-address-attack-explained/"], "description": ""}, {"id": "0a58ae27d4f2", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function allowance(\n        address owner,\n        address spender\n    ) external view returns (uint);", "highlightLines": [303]}, "category": "code", "location": {"file": "src/test/interface.sol", "line": 303, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "51446b177787", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function approve(address spender, uint amount) external returns (bool);", "highlightLines": [308]}, "category": "code", "location": {"file": "src/test/interface.sol", "line": 308, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "54128a2752da", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function transferFrom(\n        address sender,\n        address recipient,\n        uint amount\n    ) external returns (bool);", "highlightLines": [310]}, "category": "code", "location": {"file": "src/test/interface.sol", "line": 310, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "7bc8a66aa73c", "fix": {"template": null, "available": false}, "title": "ERC20 transferFrom without payload size validation - consider adding onlyPayloadSize modifier", "ruleId": "rules.sol-erc20-missing-payload-modifier", "snippet": {"code": "    function transferFrom(\n        address sender,\n        address recipient,\n        uint amount\n    ) external returns (bool);\n\n    event Transfer(address indexed from, address indexed to, uint value);\n    event Approval(address indexed owner, address indexed spender, uint value);\n}\n\ninterface IFantasticWeslie {", "highlightLines": [310]}, "category": "code", "location": {"file": "src/test/interface.sol", "line": 310, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address"], "description": ""}, {"id": "ce1090e972fc", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Transfer(address indexed from, address indexed to, uint value);", "highlightLines": [316]}, "category": "code", "location": {"file": "src/test/interface.sol", "line": 316, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "8f46a25f7a1f", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Approval(address indexed owner, address indexed spender, uint value);", "highlightLines": [317]}, "category": "code", "location": {"file": "src/test/interface.sol", "line": 317, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "bb43c60cfc27", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function mint(bytes32[] memory merkleProof) external payable;", "highlightLines": [323]}, "category": "code", "location": {"file": "src/test/interface.sol", "line": 323, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "38fed57190a7", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.18;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/payable-transfer.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "34173a5c61ba", "fix": {"template": null, "available": false}, "title": "Potential mnemonic seed phrase detected - CRITICAL if real", "ruleId": "rules._shared.shared-mnemonic-phrase", "snippet": {"code": "    3.implements a payable fallback function incurring less than 2300 gas units but is called through a proxy that raises the calls gas usage above 2300.", "highlightLines": [22]}, "category": "code", "location": {"file": "src/test/payable-transfer.sol", "line": 22, "column": 23}, "severity": "high", "references": [], "description": ""}, {"id": "f858b8b3aada", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        SimpleBankContract = new SimpleBank();\n        FixedSimpleBankContract = new FixedSimpleBank();", "highlightLines": [38]}, "category": "code", "location": {"file": "src/test/payable-transfer.sol", "line": 38, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "f9fb755d3aa8", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        SimpleBankContract = new SimpleBank();", "highlightLines": [38]}, "category": "code", "location": {"file": "src/test/payable-transfer.sol", "line": 38, "column": 30}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "2d195a629c9a", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        FixedSimpleBankContract = new FixedSimpleBank();", "highlightLines": [39]}, "category": "code", "location": {"file": "src/test/payable-transfer.sol", "line": 39, "column": 35}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "5340e118686f", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    receive() external payable {", "highlightLines": [55]}, "category": "code", "location": {"file": "src/test/payable-transfer.sol", "line": 55, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "93a77ad3e112", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function deposit() public payable {", "highlightLines": [64]}, "category": "code", "location": {"file": "src/test/payable-transfer.sol", "line": 64, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "4d3a35b10a8f", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function withdraw(uint amount) public {", "highlightLines": [72]}, "category": "code", "location": {"file": "src/test/payable-transfer.sol", "line": 72, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "4bd7e11390e3", "fix": {"template": null, "available": false}, "title": "require() in withdrawal path - griefing possible if condition can be manipulated", "ruleId": "rules.sol-force-revert-griefing", "snippet": {"code": "    function withdraw(uint amount) public {\n        require(balances[msg.sender] >= amount);", "highlightLines": [72]}, "category": "code", "location": {"file": "src/test/payable-transfer.sol", "line": 72, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "c444bc56dd48", "fix": {"template": null, "available": false}, "title": "SWC-105: Ether withdrawal without access control - anyone can drain funds", "ruleId": "rules.sol-swc-105-unprotected-withdrawal", "snippet": {"code": "    function withdraw(uint amount) public {\n        require(balances[msg.sender] >= amount);\n        balances[msg.sender] -= amount;\n        // the issue is here\n        payable(msg.sender).transfer(amount);", "highlightLines": [72]}, "category": "code", "location": {"file": "src/test/payable-transfer.sol", "line": 72, "column": 5}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-105"], "description": ""}, {"id": "8b96f0fb3da3", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(balances[msg.sender] >= amount);", "highlightLines": [73]}, "category": "code", "location": {"file": "src/test/payable-transfer.sol", "line": 73, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "2f4d4938c61c", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        payable(msg.sender).transfer(amount);", "highlightLines": [76]}, "category": "code", "location": {"file": "src/test/payable-transfer.sol", "line": 76, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "f0668b836122", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function deposit() public payable {", "highlightLines": [83]}, "category": "code", "location": {"file": "src/test/payable-transfer.sol", "line": 83, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "12e9b1b165c8", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function withdraw(uint amount) public {", "highlightLines": [91]}, "category": "code", "location": {"file": "src/test/payable-transfer.sol", "line": 91, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "4ba92b760de9", "fix": {"template": null, "available": false}, "title": "require() in withdrawal path - griefing possible if condition can be manipulated", "ruleId": "rules.sol-force-revert-griefing", "snippet": {"code": "    function withdraw(uint amount) public {\n        require(balances[msg.sender] >= amount);", "highlightLines": [91]}, "category": "code", "location": {"file": "src/test/payable-transfer.sol", "line": 91, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "ac4f6a0781ab", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(balances[msg.sender] >= amount);", "highlightLines": [92]}, "category": "code", "location": {"file": "src/test/payable-transfer.sol", "line": 92, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "af6897984d2e", "fix": {"template": null, "available": false}, "title": "Low-level call without checking return value - silent failure possible", "ruleId": "rules.sol-unchecked-call-return", "snippet": {"code": "        (bool success, ) = payable(msg.sender).call{value: amount}(\"\");", "highlightLines": [94]}, "category": "code", "location": {"file": "src/test/payable-transfer.sol", "line": 94, "column": 47}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-104/", "https://blocksecteam.medium.com/li-fi-attack"], "description": ""}, {"id": "3bb27bea2aeb", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.18;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "9b32be26f79a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        WETH9Contract = new WETH9();\n        VulnPermitContract = new VulnPermit(IERC20(address(WETH9Contract)));", "highlightLines": [31]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 31, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "4a32aef81da0", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        WETH9Contract = new WETH9();", "highlightLines": [31]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 31, "column": 25}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "a27aef264645", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        VulnPermitContract = new VulnPermit(IERC20(address(WETH9Contract)));", "highlightLines": [32]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 32, "column": 30}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "b4a26487241e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address alice = vm.addr(1);", "highlightLines": [36]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 36, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4bfb397ec3cb", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address alice = vm.addr(1);\n        vm.deal(address(alice), 10 ether);\n\n        vm.startPrank(alice);\n        WETH9Contract.deposit{value: 10 ether}();\n        WETH9Contract.approve(address(VulnPermitContract), type(uint256).max);\n        vm.stopPrank();\n        console.log(\n            \"start WETH balanceOf this\",\n            WETH9Contract.balanceOf(address(this))\n        );\n\n        VulnPermitContract.depositWithPermit(\n            address(alice),\n            1000,\n            27,\n            0x0,\n            0x0\n        );\n        uint wbal = WETH9Contract.balanceOf(address(VulnPermitContract));", "highlightLines": [36]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 36, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "42c38bd8b326", "fix": {"template": null, "available": false}, "title": "Unlimited token approval - use exact amount needed", "ruleId": "rules.sol-approve-max", "snippet": {"code": "        WETH9Contract.approve(address(VulnPermitContract), type(uint256).max);", "highlightLines": [41]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 41, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "a965be62eb08", "fix": {"template": null, "available": false}, "title": "Unlimited token approval (type(uint256).max) - user loses control of all tokens", "ruleId": "rules.sol-approval-scam-max-uint", "snippet": {"code": "        WETH9Contract.approve(address(VulnPermitContract), type(uint256).max);", "highlightLines": [41]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 41, "column": 22}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/ApproveScam.sol"], "description": ""}, {"id": "3228919727a2", "fix": {"template": null, "available": false}, "title": "Unlimited token approval using type(uint256).max - consider limited approvals", "ruleId": "rules.sol-unlimited-approval-type-max", "snippet": {"code": "        WETH9Contract.approve(address(VulnPermitContract), type(uint256).max);", "highlightLines": [41]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 41, "column": 22}, "severity": "medium", "references": [], "description": ""}, {"id": "19777884c62a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint wbal = WETH9Contract.balanceOf(address(VulnPermitContract));", "highlightLines": [55]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 55, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "102dbc0fa909", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "        uint wbal = WETH9Contract.balanceOf(address(VulnPermitContract));\n        console.log(\"WETH balanceOf VulnPermitContract\", wbal);\n\n        VulnPermitContract.withdraw(1000);\n\n        wbal = WETH9Contract.balanceOf(address(this));", "highlightLines": [55]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 55, "column": 9}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "7c6baacda419", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint wbal = WETH9Contract.balanceOf(address(VulnPermitContract));\n        console.log(\"WETH balanceOf VulnPermitContract\", wbal);\n\n        VulnPermitContract.withdraw(1000);\n\n        wbal = WETH9Contract.balanceOf(address(this));", "highlightLines": [55]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 55, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "52f3046472af", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    receive() external payable {}", "highlightLines": [64]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 64, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "ec694cd298e0", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "    receive() external payable {}", "highlightLines": [64]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 64, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "afc1a31ec58b", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(IERC20 _token) {\n        token = _token;\n    }", "highlightLines": [70]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 70, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "127e48c8db9a", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function deposit(uint256 amount) public {", "highlightLines": [74]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 74, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "c9c48f174ef2", "fix": {"template": null, "available": false}, "title": "Function accepts zero amount without validation - can cause division by zero or empty operations", "ruleId": "rules.sol-missing-zero-amount-check", "snippet": {"code": "    function deposit(uint256 amount) public {", "highlightLines": [74]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 74, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "d9e1ab6cd1b9", "fix": {"template": null, "available": false}, "title": "Token transfer without before/after balance comparison - rebasing/fee tokens may transfer different amounts", "ruleId": "rules.sol-no-balance-before-after", "snippet": {"code": "    function deposit(uint256 amount) public {\n        require(\n            token.transferFrom(msg.sender, address(this), amount),", "highlightLines": [74]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 74, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "efc5f7473d75", "fix": {"template": null, "available": false}, "title": "ERC777 token interaction without reentrancy guard - token hooks can reenter", "ruleId": "rules.sol-erc777-without-reentrancy-guard", "snippet": {"code": "    function deposit(uint256 amount) public {\n        require(\n            token.transferFrom(msg.sender, address(this), amount),", "highlightLines": [74]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 74, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "22c179fdd668", "fix": {"template": null, "available": false}, "title": "Token transfer without checking actual received amount - deflationary tokens may transfer less", "ruleId": "rules.sol-deflationary-token-transfer", "snippet": {"code": "            token.transferFrom(msg.sender, address(this), amount),", "highlightLines": [76]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 76, "column": 13}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "354a0c41f6be", "fix": {"template": null, "available": false}, "title": "Token amount after transfer may differ - check actual received amount", "ruleId": "rules.sol-fee-on-transfer-token", "snippet": {"code": "            token.transferFrom(msg.sender, address(this), amount),", "highlightLines": [76]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 76, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "c3e1d3bc7fc4", "fix": {"template": null, "available": false}, "title": "Token transfer without before/after balance comparison - rebasing/fee tokens may transfer different amounts", "ruleId": "rules.sol-no-balance-before-after", "snippet": {"code": "    function depositWithPermit(\n        address target,\n        uint256 amount,\n        uint8 v,\n        bytes32 r,\n        bytes32 s\n    ) public {\n        (bool success, ) = address(token).call(\n            abi.encodeWithSignature(\n                \"permit(address,uint256,uint8,bytes32,bytes32)\",\n                target,\n                amount,\n                v,\n                r,\n                s\n            )\n        );\n        require(success, \"Permit failed\");\n\n        require(\n            token.transferFrom(target, address(this), amount),", "highlightLines": [81]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 81, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "7d3c414303f6", "fix": {"template": null, "available": false}, "title": "Calling permit on token without EIP-2612 support silently succeeds via fallback", "ruleId": "rules.sol-phantom-function-permit", "snippet": {"code": "        (bool success, ) = address(token).call(\n            abi.encodeWithSignature(\n                \"permit(address,uint256,uint8,bytes32,bytes32)\",", "highlightLines": [88]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 88, "column": 42}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/phantom-permit.sol"], "description": ""}, {"id": "d06819f1e3e2", "fix": {"template": null, "available": false}, "title": "ERC721/ERC20 transferFrom with user-controlled from address - potential unauthorized transfer", "ruleId": "rules.sol-arbitrary-transferfrom", "snippet": {"code": "            token.transferFrom(target, address(this), amount),", "highlightLines": [101]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 101, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "b6aa6a2a19de", "fix": {"template": null, "available": false}, "title": "Token transfer without checking actual received amount - deflationary tokens may transfer less", "ruleId": "rules.sol-deflationary-token-transfer", "snippet": {"code": "            token.transferFrom(target, address(this), amount),", "highlightLines": [101]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 101, "column": 13}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "d4a0437f0ec8", "fix": {"template": null, "available": false}, "title": "Token amount after transfer may differ - check actual received amount", "ruleId": "rules.sol-fee-on-transfer-token", "snippet": {"code": "            token.transferFrom(target, address(this), amount),", "highlightLines": [101]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 101, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "c481ce4607bd", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function withdraw(uint256 amount) public {", "highlightLines": [106]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 106, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "1a9c90f523b3", "fix": {"template": null, "available": false}, "title": "Function accepts zero amount without validation - can cause division by zero or empty operations", "ruleId": "rules.sol-missing-zero-amount-check", "snippet": {"code": "    function withdraw(uint256 amount) public {", "highlightLines": [106]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 106, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "841b66fffd82", "fix": {"template": null, "available": false}, "title": "SWC-105: Ether withdrawal without access control - anyone can drain funds", "ruleId": "rules.sol-swc-105-unprotected-withdrawal", "snippet": {"code": "    function withdraw(uint256 amount) public {\n        require(token.transfer(msg.sender, amount), \"Transfer failed\");", "highlightLines": [106]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 106, "column": 5}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-105"], "description": ""}, {"id": "02bf21ffb835", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "//     function deposit(uint256 amount) public {", "highlightLines": [118]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 118, "column": 8}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "447ad791980a", "fix": {"template": null, "available": false}, "title": "Function accepts zero amount without validation - can cause division by zero or empty operations", "ruleId": "rules.sol-missing-zero-amount-check", "snippet": {"code": "//     function deposit(uint256 amount) public {", "highlightLines": [118]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 118, "column": 8}, "severity": "info", "references": [], "description": ""}, {"id": "7cd59cef0d9d", "fix": {"template": null, "available": false}, "title": "Token transfer without before/after balance comparison - rebasing/fee tokens may transfer different amounts", "ruleId": "rules.sol-no-balance-before-after", "snippet": {"code": "//     function deposit(uint256 amount) public {\n//         require(\n//             token.transferFrom(msg.sender, address(this), amount),", "highlightLines": [118]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 118, "column": 8}, "severity": "medium", "references": [], "description": ""}, {"id": "eb5e964be549", "fix": {"template": null, "available": false}, "title": "ERC777 token interaction without reentrancy guard - token hooks can reenter", "ruleId": "rules.sol-erc777-without-reentrancy-guard", "snippet": {"code": "//     function deposit(uint256 amount) public {\n//         require(\n//             token.transferFrom(msg.sender, address(this), amount),", "highlightLines": [118]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 118, "column": 8}, "severity": "high", "references": [], "description": ""}, {"id": "99e1447b35a0", "fix": {"template": null, "available": false}, "title": "Token transfer without before/after balance comparison - rebasing/fee tokens may transfer different amounts", "ruleId": "rules.sol-no-balance-before-after", "snippet": {"code": "//     function depositWithPermit(\n//         address target,\n//         uint256 amount,\n//         uint8 v,\n//         bytes32 r,\n//         bytes32 s\n//     ) public {\n//         (bool success, ) = address(token).call(\n//             abi.encodeWithSignature(\n//                 \"permit(address,uint256,uint8,bytes32,bytes32)\",\n//                 target,\n//                 amount,\n//                 v,\n//                 r,\n//                 s\n//             )\n//         );\n//         require(success, \"Permit failed\");\n\n//         require(\n//             token.transferFrom(target, address(this), amount),", "highlightLines": [125]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 125, "column": 8}, "severity": "medium", "references": [], "description": ""}, {"id": "b547171836d1", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "//     function withdraw(uint256 amount) public {", "highlightLines": [150]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 150, "column": 8}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "16b7c10fb67c", "fix": {"template": null, "available": false}, "title": "Function accepts zero amount without validation - can cause division by zero or empty operations", "ruleId": "rules.sol-missing-zero-amount-check", "snippet": {"code": "//     function withdraw(uint256 amount) public {", "highlightLines": [150]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 150, "column": 8}, "severity": "info", "references": [], "description": ""}, {"id": "5ded3aac1afe", "fix": {"template": null, "available": false}, "title": "SWC-105: Ether withdrawal without access control - anyone can drain funds", "ruleId": "rules.sol-swc-105-unprotected-withdrawal", "snippet": {"code": "//     function withdraw(uint256 amount) public {\n//         require(token.transfer(msg.sender, amount), \"Transfer failed\");", "highlightLines": [150]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 150, "column": 8}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-105"], "description": ""}, {"id": "f0c6ca517bc3", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Approval(address indexed src, address indexed guy, uint wad);", "highlightLines": [160]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 160, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "47ae6b2d9f46", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Transfer(address indexed src, address indexed dst, uint wad);", "highlightLines": [161]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 161, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "257394e4726b", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Deposit(address indexed dst, uint wad);", "highlightLines": [162]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 162, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "c4e82dcb5ed3", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Withdrawal(address indexed src, uint wad);", "highlightLines": [163]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 163, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "29841432646d", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    fallback() external payable {", "highlightLines": [168]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 168, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "d87f820f0291", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    receive() external payable {}", "highlightLines": [172]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 172, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "f5f914f12c46", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "    receive() external payable {}", "highlightLines": [172]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 172, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "bea66a9c2a42", "fix": {"template": null, "available": false}, "title": "require() in withdrawal path - griefing possible if condition can be manipulated", "ruleId": "rules.sol-force-revert-griefing", "snippet": {"code": "    function withdraw(uint wad) public {\n        require(balanceOf[msg.sender] >= wad);", "highlightLines": [179]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 179, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "2f6192526a95", "fix": {"template": null, "available": false}, "title": "SWC-105: Ether withdrawal without access control - anyone can drain funds", "ruleId": "rules.sol-swc-105-unprotected-withdrawal", "snippet": {"code": "    function withdraw(uint wad) public {\n        require(balanceOf[msg.sender] >= wad);\n        balanceOf[msg.sender] -= wad;\n        payable(msg.sender).transfer(wad);", "highlightLines": [179]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 179, "column": 5}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-105"], "description": ""}, {"id": "cd35943ae60a", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(balanceOf[msg.sender] >= wad);", "highlightLines": [180]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 180, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "2a5cce97300a", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        payable(msg.sender).transfer(wad);", "highlightLines": [182]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 182, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "3c03871a5daa", "fix": {"template": null, "available": false}, "title": "Event emitted after external call - reentrancy can cause events to be logged out of order", "ruleId": "rules.sol-event-after-external-call", "snippet": {"code": "        payable(msg.sender).transfer(wad);\n        emit Withdrawal(msg.sender, wad);", "highlightLines": [182]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 182, "column": 28}, "severity": "info", "references": [], "description": ""}, {"id": "edc55ab411e8", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function approve(address guy, uint wad) public returns (bool) {", "highlightLines": [190]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 190, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "93a8d0084ac0", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function transfer(address dst, uint wad) public returns (bool) {", "highlightLines": [196]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 196, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "1f2700273e53", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without msg.data.length validation - vulnerable to short address attack padding", "ruleId": "rules.sol-short-address-no-payload-check", "snippet": {"code": "    function transfer(address dst, uint wad) public returns (bool) {", "highlightLines": [196]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 196, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address", "https://vessenes.com/the-erc20-short-address-attack-explained/"], "description": ""}, {"id": "5df49e342c0b", "fix": {"template": null, "available": false}, "title": "NFT transfer without royalty enforcement - use ERC2981", "ruleId": "rules.sol-nft-royalty-bypass", "snippet": {"code": "        return transferFrom(msg.sender, dst, wad);", "highlightLines": [197]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 197, "column": 16}, "severity": "info", "references": [], "description": ""}, {"id": "4a531f469537", "fix": {"template": null, "available": false}, "title": "ERC20 transferFrom without payload size validation - consider adding onlyPayloadSize modifier", "ruleId": "rules.sol-erc20-missing-payload-modifier", "snippet": {"code": "    function transferFrom(\n        address src,\n        address dst,\n        uint wad\n    ) public returns (bool) {", "highlightLines": [200]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 200, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address"], "description": ""}, {"id": "0120ee0f2d68", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function transferFrom(\n        address src,\n        address dst,\n        uint wad\n    ) public returns (bool) {", "highlightLines": [200]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 200, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "3e1ae2f376e3", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "    function transferFrom(\n        address src,\n        address dst,\n        uint wad\n    ) public returns (bool) {\n        require(balanceOf[src] >= wad);\n\n        if (\n            src != msg.sender && allowance[src][msg.sender] != type(uint128).max\n        ) {\n            require(allowance[src][msg.sender] >= wad);", "highlightLines": [200]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 200, "column": 5}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "a322bab3121f", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(balanceOf[src] >= wad);", "highlightLines": [205]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 205, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "9234e2348fdd", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "            require(allowance[src][msg.sender] >= wad);", "highlightLines": [210]}, "category": "code", "location": {"file": "src/test/phantom-permit.sol", "line": 210, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "4dd3941fcdfa", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.18;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/recoverERC20.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "8b3af3dd6b53", "fix": {"template": null, "available": false}, "title": "Consider using Ownable2Step instead of Ownable for safer ownership transfers", "ruleId": "rules.sol-use-ownable2step", "snippet": {"code": "import \"@openzeppelin/contracts/access/Ownable.sol\";", "highlightLines": [6]}, "category": "code", "location": {"file": "src/test/recoverERC20.sol", "line": 6, "column": 1}, "severity": "info", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/access/Ownable2Step.sol"], "description": ""}, {"id": "28d16baf9fc9", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract ContractTest is Test {\n    RewardToken RewardTokenContract;\n    VulnStakingRewards VulnStakingRewardsContract;\n    FixedtakingRewards FixedtakingRewardsContract;\n    address alice = vm.addr(1);", "highlightLines": [28]}, "category": "code", "location": {"file": "src/test/recoverERC20.sol", "line": 28, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "9e86df409929", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address alice = vm.addr(1);", "highlightLines": [32]}, "category": "code", "location": {"file": "src/test/recoverERC20.sol", "line": 32, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4db5c0b525bc", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        RewardTokenContract = new RewardToken();\n        VulnStakingRewardsContract = new VulnStakingRewards(\n            address(RewardTokenContract)\n        );", "highlightLines": [35]}, "category": "code", "location": {"file": "src/test/recoverERC20.sol", "line": 35, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "9c5a2b3a03d9", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        RewardTokenContract = new RewardToken();", "highlightLines": [35]}, "category": "code", "location": {"file": "src/test/recoverERC20.sol", "line": 35, "column": 31}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "659454d6ba46", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        VulnStakingRewardsContract = new VulnStakingRewards(\n            address(RewardTokenContract)\n        );\n        RewardTokenContract.transfer(address(alice), 10000 ether);\n        FixedtakingRewardsContract = new FixedtakingRewards(\n            address(RewardTokenContract)\n        );", "highlightLines": [36]}, "category": "code", "location": {"file": "src/test/recoverERC20.sol", "line": 36, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "fa4436c2bfb6", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        VulnStakingRewardsContract = new VulnStakingRewards(\n            address(RewardTokenContract)\n        );", "highlightLines": [36]}, "category": "code", "location": {"file": "src/test/recoverERC20.sol", "line": 36, "column": 38}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "cb8bad4abb95", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        RewardTokenContract.transfer(address(alice), 10000 ether);", "highlightLines": [39]}, "category": "code", "location": {"file": "src/test/recoverERC20.sol", "line": 39, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "7dd3189c6523", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "        RewardTokenContract.transfer(address(alice), 10000 ether);", "highlightLines": [39]}, "category": "code", "location": {"file": "src/test/recoverERC20.sol", "line": 39, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "f829d21ad803", "fix": {"template": null, "available": false}, "title": "ERC20 transfer() return value not checked - tokens like USDT don't return bool", "ruleId": "rules.sol-erc20-transfer-no-return-check", "snippet": {"code": "        RewardTokenContract.transfer(address(alice), 10000 ether);", "highlightLines": [39]}, "category": "code", "location": {"file": "src/test/recoverERC20.sol", "line": 39, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "b281c4600a32", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        FixedtakingRewardsContract = new FixedtakingRewards(\n            address(RewardTokenContract)\n        );", "highlightLines": [40]}, "category": "code", "location": {"file": "src/test/recoverERC20.sol", "line": 40, "column": 38}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "fb6a520bf690", "fix": {"template": null, "available": false}, "title": "ERC20 transfer() return value not checked - tokens like USDT don't return bool", "ruleId": "rules.sol-erc20-transfer-no-return-check", "snippet": {"code": "        //RewardTokenContract.transfer(address(alice),10000 ether);", "highlightLines": [43]}, "category": "code", "location": {"file": "src/test/recoverERC20.sol", "line": 43, "column": 11}, "severity": "medium", "references": [], "description": ""}, {"id": "620e82a62d5a", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        RewardTokenContract.transfer(\n            address(VulnStakingRewardsContract),\n            10000 ether\n        );", "highlightLines": [53]}, "category": "code", "location": {"file": "src/test/recoverERC20.sol", "line": 53, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "8f22ed2f7eda", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "        RewardTokenContract.transfer(\n            address(VulnStakingRewardsContract),\n            10000 ether\n        );", "highlightLines": [53]}, "category": "code", "location": {"file": "src/test/recoverERC20.sol", "line": 53, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "74e6f22368d3", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        RewardTokenContract.transfer(\n            address(FixedtakingRewardsContract),\n            10000 ether\n        );", "highlightLines": [75]}, "category": "code", "location": {"file": "src/test/recoverERC20.sol", "line": 75, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "7322056d1800", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "        RewardTokenContract.transfer(\n            address(FixedtakingRewardsContract),\n            10000 ether\n        );", "highlightLines": [75]}, "category": "code", "location": {"file": "src/test/recoverERC20.sol", "line": 75, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "9270d39af229", "fix": {"template": null, "available": false}, "title": "ERC20 transfer() return value not checked - tokens like USDT don't return bool", "ruleId": "rules.sol-erc20-transfer-no-return-check", "snippet": {"code": "        RewardTokenContract.transfer(\n            address(FixedtakingRewardsContract),\n            10000 ether\n        );", "highlightLines": [75]}, "category": "code", "location": {"file": "src/test/recoverERC20.sol", "line": 75, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "988c7005aab7", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    receive() external payable {}", "highlightLines": [89]}, "category": "code", "location": {"file": "src/test/recoverERC20.sol", "line": 89, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "0896f92be7f2", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "    receive() external payable {}", "highlightLines": [89]}, "category": "code", "location": {"file": "src/test/recoverERC20.sol", "line": 89, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "989caf958107", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event Recovered(address token, uint256 amount);", "highlightLines": [98]}, "category": "code", "location": {"file": "src/test/recoverERC20.sol", "line": 98, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "a79e7f32019a", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Recovered(address token, uint256 amount);", "highlightLines": [98]}, "category": "code", "location": {"file": "src/test/recoverERC20.sol", "line": 98, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "0af0e148ff6c", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(address _rewardsToken) {\n        rewardsToken = IERC20(_rewardsToken);\n        owner = msg.sender;\n    }", "highlightLines": [100]}, "category": "code", "location": {"file": "src/test/recoverERC20.sol", "line": 100, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "46f2257e15a5", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        rewardsToken = IERC20(_rewardsToken);\n        owner = msg.sender;", "highlightLines": [101]}, "category": "code", "location": {"file": "src/test/recoverERC20.sol", "line": 101, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "02e4ce8b0a0c", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        owner = msg.sender;", "highlightLines": [102]}, "category": "code", "location": {"file": "src/test/recoverERC20.sol", "line": 102, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "f8a8e42e2ba5", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyOwner() {\n        require(msg.sender == owner, \"Only owner can call this function\");\n        _;\n    }", "highlightLines": [105]}, "category": "code", "location": {"file": "src/test/recoverERC20.sol", "line": 105, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "46a2e21d8161", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "    modifier onlyOwner() {\n        require(msg.sender == owner, \"Only owner can call this function\");\n        _;\n    }", "highlightLines": [105]}, "category": "code", "location": {"file": "src/test/recoverERC20.sol", "line": 105, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "7d18c470998e", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "        require(msg.sender == owner, \"Only owner can call this function\");", "highlightLines": [106]}, "category": "code", "location": {"file": "src/test/recoverERC20.sol", "line": 106, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "2b8ae4a7e3e4", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [107]}, "category": "code", "location": {"file": "src/test/recoverERC20.sol", "line": 107, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "56de2fbb924a", "fix": {"template": null, "available": false}, "title": "recoverERC20 can withdraw reward tokens - exclude staking/reward token addresses", "ruleId": "rules.sol-recover-erc20-backdoor", "snippet": {"code": "    function recoverERC20(\n        address tokenAddress,\n        uint256 tokenAmount\n    ) public onlyOwner {", "highlightLines": [110]}, "category": "code", "location": {"file": "src/test/recoverERC20.sol", "line": 110, "column": 5}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/recoverERC20.sol"], "description": ""}, {"id": "f818517cff53", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    ) public onlyOwner {", "highlightLines": [113]}, "category": "code", "location": {"file": "src/test/recoverERC20.sol", "line": 113, "column": 14}, "severity": "info", "references": [], "description": ""}, {"id": "50ccc6c4748a", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "        IERC20(tokenAddress).safeTransfer(owner, tokenAmount);", "highlightLines": [114]}, "category": "code", "location": {"file": "src/test/recoverERC20.sol", "line": 114, "column": 9}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "dfd14821357b", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event Recovered(address token, uint256 amount);", "highlightLines": [125]}, "category": "code", "location": {"file": "src/test/recoverERC20.sol", "line": 125, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "109be687c398", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Recovered(address token, uint256 amount);", "highlightLines": [125]}, "category": "code", "location": {"file": "src/test/recoverERC20.sol", "line": 125, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "b99fe85d113e", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(address _rewardsToken) {\n        rewardsToken = IERC20(_rewardsToken);\n        owner = msg.sender;\n    }", "highlightLines": [127]}, "category": "code", "location": {"file": "src/test/recoverERC20.sol", "line": 127, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "894dfc2d5b51", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        rewardsToken = IERC20(_rewardsToken);\n        owner = msg.sender;", "highlightLines": [128]}, "category": "code", "location": {"file": "src/test/recoverERC20.sol", "line": 128, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "ac44430a1c2f", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        owner = msg.sender;", "highlightLines": [129]}, "category": "code", "location": {"file": "src/test/recoverERC20.sol", "line": 129, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "54cd917753d9", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyOwner() {\n        require(msg.sender == owner, \"Only owner can call this function\");\n        _;\n    }", "highlightLines": [132]}, "category": "code", "location": {"file": "src/test/recoverERC20.sol", "line": 132, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "46c9463ddec9", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "    modifier onlyOwner() {\n        require(msg.sender == owner, \"Only owner can call this function\");\n        _;\n    }", "highlightLines": [132]}, "category": "code", "location": {"file": "src/test/recoverERC20.sol", "line": 132, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "b764a17354f5", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "        require(msg.sender == owner, \"Only owner can call this function\");", "highlightLines": [133]}, "category": "code", "location": {"file": "src/test/recoverERC20.sol", "line": 133, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "b03b539bfe6d", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [134]}, "category": "code", "location": {"file": "src/test/recoverERC20.sol", "line": 134, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "1361c8f0bd62", "fix": {"template": null, "available": false}, "title": "recoverERC20 can withdraw reward tokens - exclude staking/reward token addresses", "ruleId": "rules.sol-recover-erc20-backdoor", "snippet": {"code": "    function recoverERC20(\n        address tokenAddress,\n        uint256 tokenAmount\n    ) external onlyOwner {", "highlightLines": [137]}, "category": "code", "location": {"file": "src/test/recoverERC20.sol", "line": 137, "column": 5}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/recoverERC20.sol"], "description": ""}, {"id": "3bf85d6f1132", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    ) external onlyOwner {", "highlightLines": [140]}, "category": "code", "location": {"file": "src/test/recoverERC20.sol", "line": 140, "column": 16}, "severity": "info", "references": [], "description": ""}, {"id": "72daa9885b86", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "        IERC20(tokenAddress).safeTransfer(owner, tokenAmount);", "highlightLines": [145]}, "category": "code", "location": {"file": "src/test/recoverERC20.sol", "line": 145, "column": 9}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "85a6e3a0a2de", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor() ERC20(\"Rewardoken\", \"Reward\") {\n        _mint(msg.sender, 10000 * 10 ** decimals());\n    }", "highlightLines": [151]}, "category": "code", "location": {"file": "src/test/recoverERC20.sol", "line": 151, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "d4545302fde4", "fix": {"template": null, "available": false}, "title": "NFT mint without supply check - potential overflow in tokenId", "ruleId": "rules.sol-nft-overflow-mint", "snippet": {"code": "        _mint(msg.sender, 10000 * 10 ** decimals());", "highlightLines": [152]}, "category": "code", "location": {"file": "src/test/recoverERC20.sol", "line": 152, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "1f2308b7e45c", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.18;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "075ec0e101c7", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "Name: Use of return in inner loop iteration leads to unintended termination. \n\nDescription:\nThis demonstrates the difference between using 'return' and 'break' in nested loop iterations.\nWhen removing multiple banks from a list, using 'return' in the BuggyBankManager will prematurely exit the function\nafter removing only the first bank, leaving other banks untouched.\nIn contrast, the FixedBankManager uses 'break' correctly to only exit the current inner loop iteration,\nallowing the outer loop to continue processing other banks.\n\nThis is similar to a real bug where a function intended to allow the removal of multiple DEXes approved for swaps,\nbut would only remove the first DEX because 'return' was used instead of 'break' in the inner for loop.\n\nMitigation:  \nUse break instead of return when you only want to exit the current loop, not the entire function.\n\nREF:\nhttps://twitter.com/1nf0s3cpt/status/1678596730865221632\nhttps://github.com/code-423n4/2022-03-lifinance-findings/issues/34\nhttps://solidity-by-example.org/loop/\n*/\n\ncontract ContractTest is Test {\n    BuggyBankManager buggyManager;\n    FixedBankManager fixedManager;", "highlightLines": [7]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 7, "column": 14}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "c24babc6d23d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        buggyManager = new BuggyBankManager();\n        fixedManager = new FixedBankManager();", "highlightLines": [33]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 33, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "33144c899097", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        buggyManager = new BuggyBankManager();", "highlightLines": [33]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 33, "column": 24}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "cbdf71c2b87c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        fixedManager = new FixedBankManager();\n        \n        // Initialize both managers with the same 3 banks\n        address[] memory initialBanks = new address[](3);", "highlightLines": [34]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 34, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "a6ac95f86095", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        fixedManager = new FixedBankManager();", "highlightLines": [34]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 34, "column": 24}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "45186cac7b4c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address[] memory initialBanks = new address[](3);\n        string[] memory initialNames = new string[](3);", "highlightLines": [37]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 37, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e5cd86a16aee", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        address[] memory initialBanks = new address[](3);", "highlightLines": [37]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 37, "column": 41}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "e59fdff8056d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        string[] memory initialNames = new string[](3);\n        \n        initialBanks[0] = address(0x1);", "highlightLines": [38]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 38, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "5348a3709180", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        string[] memory initialNames = new string[](3);", "highlightLines": [38]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 38, "column": 40}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "9d0fdf83271b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        initialBanks[0] = address(0x1);\n        initialNames[0] = \"ABC Bank\";", "highlightLines": [40]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 40, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d48a8939bf1a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        initialNames[0] = \"ABC Bank\";\n        \n        initialBanks[1] = address(0x2);", "highlightLines": [41]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 41, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "1ead42a50c8a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        initialBanks[1] = address(0x2);\n        initialNames[1] = \"XYZ Bank\";", "highlightLines": [43]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 43, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "994878d01dd0", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        initialNames[1] = \"XYZ Bank\";\n        \n        initialBanks[2] = address(0x3);", "highlightLines": [44]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 44, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "02f20e5cf29a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        initialBanks[2] = address(0x3);\n        initialNames[2] = \"Global Bank\";", "highlightLines": [46]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 46, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "320abe1c4971", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address[] memory banksToRemove = new address[](3);\n        banksToRemove[0] = address(0x1); // ABC Bank", "highlightLines": [63]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 63, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "f14c543c956c", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        address[] memory banksToRemove = new address[](3);", "highlightLines": [63]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 63, "column": 42}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "96bf732163a8", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        banksToRemove[0] = address(0x1); // ABC Bank\n        banksToRemove[1] = address(0x2); // XYZ Bank", "highlightLines": [64]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 64, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "6fa32fb995fb", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        banksToRemove[1] = address(0x2); // XYZ Bank\n        banksToRemove[2] = address(0x3); // Global Bank", "highlightLines": [65]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 65, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d726a3a2d305", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address bankAddress;", "highlightLines": [84]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 84, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "bf598cb21958", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        string bankName;", "highlightLines": [85]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 85, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a043497f8106", "fix": {"template": null, "available": false}, "title": "Empty array bypasses loop logic - add length check before loop", "ruleId": "rules.sol-empty-array-loop-bypass", "snippet": {"code": "        for (uint i = 0; i < addresses.length; i++) {", "highlightLines": [94]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 94, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/empty-loop.sol"], "description": ""}, {"id": "5683e47ee7fb", "fix": {"template": null, "available": false}, "title": "Unbounded loop over array - potential DOS via gas limit", "ruleId": "rules.sol-unbounded-loop", "snippet": {"code": "        for (uint i = 0; i < addresses.length; i++) {\n            banks.push(Bank(addresses[i], names[i]));\n        }", "highlightLines": [94]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 94, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "0887b3d74216", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract BuggyBankManager is BankManager, Test {\n    // Remove all banks in the provided list\n    // BUG: Using 'return' causes premature exit after removing only one bank\n    function removeBanksWithReturn(address[] memory banksToRemove) public {\n        for (uint i = 0; i < banks.length; i++) {\n            for (uint j = 0; j < banksToRemove.length; j++) {", "highlightLines": [125]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 125, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "cb3e32b8b744", "fix": {"template": null, "available": false}, "title": "Empty array bypasses loop logic - add length check before loop", "ruleId": "rules.sol-empty-array-loop-bypass", "snippet": {"code": "        for (uint i = 0; i < banks.length; i++) {", "highlightLines": [129]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 129, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/empty-loop.sol"], "description": ""}, {"id": "9023df9af222", "fix": {"template": null, "available": false}, "title": "Unbounded loop over array - potential DOS via gas limit", "ruleId": "rules.sol-unbounded-loop", "snippet": {"code": "        for (uint i = 0; i < banks.length; i++) {\n            for (uint j = 0; j < banksToRemove.length; j++) {\n                if (banks[i].bankAddress == banksToRemove[j]) {\n                    emit log_string(string(abi.encodePacked(\n                        \"Removing bank: \", banks[i].bankName, \n                        \" (Address: \", toHexString(uint160(banks[i].bankAddress)), \")\"\n                    )));\n                    \n                    _removeBank(i);\n                    return; // BUG: This exits the entire function after removing just one bank\n                }\n            }\n        }", "highlightLines": [129]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 129, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "328be08a2344", "fix": {"template": null, "available": false}, "title": "Empty array bypasses loop logic - add length check before loop", "ruleId": "rules.sol-empty-array-loop-bypass", "snippet": {"code": "            for (uint j = 0; j < banksToRemove.length; j++) {", "highlightLines": [130]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 130, "column": 13}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/empty-loop.sol"], "description": ""}, {"id": "edd51bb0a409", "fix": {"template": null, "available": false}, "title": "Unbounded loop over array - potential DOS via gas limit", "ruleId": "rules.sol-unbounded-loop", "snippet": {"code": "            for (uint j = 0; j < banksToRemove.length; j++) {\n                if (banks[i].bankAddress == banksToRemove[j]) {\n                    emit log_string(string(abi.encodePacked(\n                        \"Removing bank: \", banks[i].bankName, \n                        \" (Address: \", toHexString(uint160(banks[i].bankAddress)), \")\"\n                    )));\n                    \n                    _removeBank(i);\n                    return; // BUG: This exits the entire function after removing just one bank\n                }\n            }", "highlightLines": [130]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 130, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "451126e6bf78", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "                    emit log_string(string(abi.encodePacked(\n                        \"Removing bank: \", banks[i].bankName, \n                        \" (Address: \", toHexString(uint160(banks[i].bankAddress)), \")\"\n                    )));", "highlightLines": [132]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 132, "column": 44}, "severity": "medium", "references": [], "description": ""}, {"id": "aabe36c81e70", "fix": {"template": null, "available": false}, "title": "Empty array bypasses loop logic - add length check before loop", "ruleId": "rules.sol-empty-array-loop-bypass", "snippet": {"code": "        for (uint i = 0; i < banks.length; i++) {", "highlightLines": [147]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 147, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/empty-loop.sol"], "description": ""}, {"id": "55408f422400", "fix": {"template": null, "available": false}, "title": "Unbounded loop over array - potential DOS via gas limit", "ruleId": "rules.sol-unbounded-loop", "snippet": {"code": "        for (uint i = 0; i < banks.length; i++) {\n            emit log_string(string(abi.encodePacked(\n                \"Bank \", toString(i), \": \", \n                banks[i].bankName, \" (Address: \", \n                toHexString(uint160(banks[i].bankAddress)), \")\"\n            )));\n        }", "highlightLines": [147]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 147, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "3b56068d7028", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "            emit log_string(string(abi.encodePacked(\n                \"Bank \", toString(i), \": \", \n                banks[i].bankName, \" (Address: \", \n                toHexString(uint160(banks[i].bankAddress)), \")\"\n            )));", "highlightLines": [148]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 148, "column": 36}, "severity": "medium", "references": [], "description": ""}, {"id": "b796e45a025c", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function toString(uint value) internal pure returns (string memory) {\n        if (value == 0) {", "highlightLines": [157]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 157, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "7f1d84bbedfb", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint temp = value;", "highlightLines": [161]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 161, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a590ea997777", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint temp = value;\n        uint digits;\n        while (temp != 0) {\n            digits++;\n            temp /= 10;\n        }\n        bytes memory buffer = new bytes(digits);", "highlightLines": [161]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 161, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d88dd94de1f1", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint digits;", "highlightLines": [162]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 162, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "32870b5d55b2", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes memory buffer = new bytes(digits);\n        while (value != 0) {\n            digits -= 1;\n            buffer[digits] = bytes1(uint8(48 + uint(value % 10)));\n            value /= 10;\n        }", "highlightLines": [167]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 167, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "6c97936071ff", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        bytes memory buffer = new bytes(digits);", "highlightLines": [167]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 167, "column": 31}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "58e24d9d4e9f", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "            buffer[digits] = bytes1(uint8(48 + uint(value % 10)));", "highlightLines": [170]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 170, "column": 37}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "47169f335257", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "            buffer[digits] = bytes1(uint8(48 + uint(value % 10)));", "highlightLines": [170]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 170, "column": 48}, "severity": "info", "references": [], "description": ""}, {"id": "a4a99468f1ad", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function toHexString(uint value) internal pure returns (string memory) {\n        bytes16 hexSymbols = \"0123456789abcdef\";\n        uint length = 40; // 20 bytes * 2 characters per byte\n        bytes memory buffer = new bytes(2 + length);\n        buffer[0] = '0';\n        buffer[1] = 'x';\n        for (uint i = 2 + length - 1; i >= 2; i--) {", "highlightLines": [177]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 177, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "69673d9fcdc0", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes16 hexSymbols = \"0123456789abcdef\";", "highlightLines": [178]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 178, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e0701f1679cd", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes16 hexSymbols = \"0123456789abcdef\";\n        uint length = 40; // 20 bytes * 2 characters per byte", "highlightLines": [178]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 178, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "024bd45cc654", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint length = 40; // 20 bytes * 2 characters per byte", "highlightLines": [179]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 179, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "106338065765", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint length = 40; // 20 bytes * 2 characters per byte\n        bytes memory buffer = new bytes(2 + length);", "highlightLines": [179]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 179, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "5511d5429917", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes memory buffer = new bytes(2 + length);\n        buffer[0] = '0';", "highlightLines": [180]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 180, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "6b3d6cc76ef0", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        bytes memory buffer = new bytes(2 + length);", "highlightLines": [180]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 180, "column": 31}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "d876147cc5ec", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        buffer[0] = '0';\n        buffer[1] = 'x';", "highlightLines": [181]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 181, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e77e5b55d347", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        buffer[1] = 'x';\n        for (uint i = 2 + length - 1; i >= 2; i--) {\n            buffer[i] = hexSymbols[value & 0xf];\n            value >>= 4;\n        }", "highlightLines": [182]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 182, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "3bb8d0ad7480", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "            buffer[i] = hexSymbols[value & 0xf];", "highlightLines": [184]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 184, "column": 36}, "severity": "medium", "references": [], "description": ""}, {"id": "adfc9fa23c6a", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract FixedBankManager is BankManager, Test {\n    // Remove all banks in the provided list\n    // FIXED: Using proper iteration to remove multiple elements\n    function removeBanksWithBreak(address[] memory banksToRemove) public {\n        // We need to iterate backwards to avoid index issues when removing elements\n        for (int i = int(banks.length) - 1; i >= 0; i--) {\n            for (uint j = 0; j < banksToRemove.length; j++) {", "highlightLines": [192]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 192, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "f5701c03bd07", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "        for (int i = int(banks.length) - 1; i >= 0; i--) {", "highlightLines": [197]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 197, "column": 22}, "severity": "info", "references": [], "description": ""}, {"id": "1b6f9359a3be", "fix": {"template": null, "available": false}, "title": "Empty array bypasses loop logic - add length check before loop", "ruleId": "rules.sol-empty-array-loop-bypass", "snippet": {"code": "            for (uint j = 0; j < banksToRemove.length; j++) {", "highlightLines": [198]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 198, "column": 13}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/empty-loop.sol"], "description": ""}, {"id": "5ebedd5e5766", "fix": {"template": null, "available": false}, "title": "Unbounded loop over array - potential DOS via gas limit", "ruleId": "rules.sol-unbounded-loop", "snippet": {"code": "            for (uint j = 0; j < banksToRemove.length; j++) {\n                if (banks[uint(i)].bankAddress == banksToRemove[j]) {\n                    emit log_string(string(abi.encodePacked(\n                        \"Removing bank: \", banks[uint(i)].bankName, \n                        \" (Address: \", toHexString(uint160(banks[uint(i)].bankAddress)), \")\"\n                    )));\n                    \n                    _removeBank(uint(i));\n                    break; // FIXED: Only break from the inner loop, continue with the next bank\n                }\n            }", "highlightLines": [198]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 198, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "9d4741077c2d", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "                if (banks[uint(i)].bankAddress == banksToRemove[j]) {", "highlightLines": [199]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 199, "column": 27}, "severity": "info", "references": [], "description": ""}, {"id": "cc9afbd066bd", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "                    emit log_string(string(abi.encodePacked(\n                        \"Removing bank: \", banks[uint(i)].bankName, \n                        \" (Address: \", toHexString(uint160(banks[uint(i)].bankAddress)), \")\"\n                    )));", "highlightLines": [200]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 200, "column": 44}, "severity": "medium", "references": [], "description": ""}, {"id": "1abae914ddb5", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "                        \"Removing bank: \", banks[uint(i)].bankName,", "highlightLines": [201]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 201, "column": 50}, "severity": "info", "references": [], "description": ""}, {"id": "7be07789d4f5", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "                        \" (Address: \", toHexString(uint160(banks[uint(i)].bankAddress)), \")\"", "highlightLines": [202]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 202, "column": 66}, "severity": "info", "references": [], "description": ""}, {"id": "b22bd2ebf2df", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "                    _removeBank(uint(i));", "highlightLines": [205]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 205, "column": 33}, "severity": "info", "references": [], "description": ""}, {"id": "35d38a2551a6", "fix": {"template": null, "available": false}, "title": "Empty array bypasses loop logic - add length check before loop", "ruleId": "rules.sol-empty-array-loop-bypass", "snippet": {"code": "        for (uint i = 0; i < banks.length; i++) {", "highlightLines": [215]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 215, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/empty-loop.sol"], "description": ""}, {"id": "13ed1f42a33c", "fix": {"template": null, "available": false}, "title": "Unbounded loop over array - potential DOS via gas limit", "ruleId": "rules.sol-unbounded-loop", "snippet": {"code": "        for (uint i = 0; i < banks.length; i++) {\n            emit log_string(string(abi.encodePacked(\n                \"Bank \", toString(i), \": \", \n                banks[i].bankName, \" (Address: \", \n                toHexString(uint160(banks[i].bankAddress)), \")\"\n            )));\n        }", "highlightLines": [215]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 215, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "0a089a29e3fa", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "            emit log_string(string(abi.encodePacked(\n                \"Bank \", toString(i), \": \", \n                banks[i].bankName, \" (Address: \", \n                toHexString(uint160(banks[i].bankAddress)), \")\"\n            )));", "highlightLines": [216]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 216, "column": 36}, "severity": "medium", "references": [], "description": ""}, {"id": "523dda8bc886", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function toString(uint value) internal pure returns (string memory) {\n        if (value == 0) {", "highlightLines": [225]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 225, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "6f03d55b8480", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint temp = value;", "highlightLines": [229]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 229, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d67c41cbfd2e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint temp = value;\n        uint digits;\n        while (temp != 0) {\n            digits++;\n            temp /= 10;\n        }\n        bytes memory buffer = new bytes(digits);", "highlightLines": [229]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 229, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "48a02eb844f7", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint digits;", "highlightLines": [230]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 230, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b5d1c1cb843c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes memory buffer = new bytes(digits);\n        while (value != 0) {\n            digits -= 1;\n            buffer[digits] = bytes1(uint8(48 + uint(value % 10)));\n            value /= 10;\n        }", "highlightLines": [235]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 235, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "2acfac8f182f", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        bytes memory buffer = new bytes(digits);", "highlightLines": [235]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 235, "column": 31}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "d395cf586837", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "            buffer[digits] = bytes1(uint8(48 + uint(value % 10)));", "highlightLines": [238]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 238, "column": 37}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "b666c30cddcc", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "            buffer[digits] = bytes1(uint8(48 + uint(value % 10)));", "highlightLines": [238]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 238, "column": 48}, "severity": "info", "references": [], "description": ""}, {"id": "681fcba9d0aa", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function toHexString(uint value) internal pure returns (string memory) {\n        bytes16 hexSymbols = \"0123456789abcdef\";\n        uint length = 40; // 20 bytes * 2 characters per byte\n        bytes memory buffer = new bytes(2 + length);\n        buffer[0] = '0';\n        buffer[1] = 'x';\n        for (uint i = 2 + length - 1; i >= 2; i--) {", "highlightLines": [245]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 245, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "9f5a63ecda97", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes16 hexSymbols = \"0123456789abcdef\";", "highlightLines": [246]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 246, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4517858bed16", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes16 hexSymbols = \"0123456789abcdef\";\n        uint length = 40; // 20 bytes * 2 characters per byte", "highlightLines": [246]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 246, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e895e6a614ae", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint length = 40; // 20 bytes * 2 characters per byte", "highlightLines": [247]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 247, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0b7c9c87b222", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint length = 40; // 20 bytes * 2 characters per byte\n        bytes memory buffer = new bytes(2 + length);", "highlightLines": [247]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 247, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "3f9a7596ae5b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes memory buffer = new bytes(2 + length);\n        buffer[0] = '0';", "highlightLines": [248]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 248, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "4edc07fc3ffa", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        bytes memory buffer = new bytes(2 + length);", "highlightLines": [248]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 248, "column": 31}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "1f5768647203", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        buffer[0] = '0';\n        buffer[1] = 'x';", "highlightLines": [249]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 249, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "1aacbde64cc2", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        buffer[1] = 'x';\n        for (uint i = 2 + length - 1; i >= 2; i--) {\n            buffer[i] = hexSymbols[value & 0xf];\n            value >>= 4;\n        }", "highlightLines": [250]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 250, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "77ee9b7be21c", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "            buffer[i] = hexSymbols[value & 0xf];", "highlightLines": [252]}, "category": "code", "location": {"file": "src/test/return-break.sol", "line": 252, "column": 36}, "severity": "medium", "references": [], "description": ""}, {"id": "82837888d6a5", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.18;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/self-transfer.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "69aea781aded", "fix": {"template": null, "available": false}, "title": "Potential mnemonic seed phrase detected - CRITICAL if real", "ruleId": "rules._shared.shared-mnemonic-phrase", "snippet": {"code": "The vulnerability in the code stems from the absence of a check to prevent self-transfers.", "highlightLines": [10]}, "category": "code", "location": {"file": "src/test/self-transfer.sol", "line": 10, "column": 11}, "severity": "high", "references": [], "description": ""}, {"id": "d45089af037c", "fix": {"template": null, "available": false}, "title": "Potential mnemonic seed phrase detected - CRITICAL if real", "ruleId": "rules._shared.shared-mnemonic-phrase", "snippet": {"code": "This vulnerability undermines the correctness of fund transfers within the contract and poses a risk \nto the integrity of user balances.", "highlightLines": [13]}, "category": "code", "location": {"file": "src/test/self-transfer.sol", "line": 13, "column": 12}, "severity": "high", "references": [], "description": ""}, {"id": "9394b6fe6a25", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        VSimpleBankContract = new SimpleBank();\n        FixedSimpleBankContract = new FixedSimpleBank();", "highlightLines": [30]}, "category": "code", "location": {"file": "src/test/self-transfer.sol", "line": 30, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "7560c6eb30dc", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        VSimpleBankContract = new SimpleBank();", "highlightLines": [30]}, "category": "code", "location": {"file": "src/test/self-transfer.sol", "line": 30, "column": 31}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "4b78d05799dc", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        FixedSimpleBankContract = new FixedSimpleBank();", "highlightLines": [31]}, "category": "code", "location": {"file": "src/test/self-transfer.sol", "line": 31, "column": 35}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "1e7f623c703d", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        VSimpleBankContract.transfer(address(this), address(this), 10000);", "highlightLines": [35]}, "category": "code", "location": {"file": "src/test/self-transfer.sol", "line": 35, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "07743a22a12d", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        VSimpleBankContract.transfer(address(this), address(this), 10000);", "highlightLines": [36]}, "category": "code", "location": {"file": "src/test/self-transfer.sol", "line": 36, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "46d32cb240dc", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        FixedSimpleBankContract.transfer(address(this), address(this), 10000);", "highlightLines": [49]}, "category": "code", "location": {"file": "src/test/self-transfer.sol", "line": 49, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "486a28b83304", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    receive() external payable {}", "highlightLines": [52]}, "category": "code", "location": {"file": "src/test/self-transfer.sol", "line": 52, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "f9981d6d0575", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "    receive() external payable {}", "highlightLines": [52]}, "category": "code", "location": {"file": "src/test/self-transfer.sol", "line": 52, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "281166f55a06", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function transfer(address _from, address _to, uint256 _amount) public {", "highlightLines": [62]}, "category": "code", "location": {"file": "src/test/self-transfer.sol", "line": 62, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "a66405c7e7b5", "fix": {"template": null, "available": false}, "title": "Self transfer not checked - can cause balance corruption with from == to", "ruleId": "rules.sol-self-transfer-unchecked", "snippet": {"code": "    function transfer(address _from, address _to, uint256 _amount) public {", "highlightLines": [62]}, "category": "code", "location": {"file": "src/test/self-transfer.sol", "line": 62, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/self-transfer.sol"], "description": ""}, {"id": "eb339fd805a7", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 _fromBalance = _balances[_from];", "highlightLines": [64]}, "category": "code", "location": {"file": "src/test/self-transfer.sol", "line": 64, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b5de08e81403", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 _fromBalance = _balances[_from];\n        uint256 _toBalance = _balances[_to];", "highlightLines": [64]}, "category": "code", "location": {"file": "src/test/self-transfer.sol", "line": 64, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "8c50ca0c1f9a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 _toBalance = _balances[_to];", "highlightLines": [65]}, "category": "code", "location": {"file": "src/test/self-transfer.sol", "line": 65, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a52af85d58b2", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 _toBalance = _balances[_to];\n\n        unchecked {\n            _balances[_from] = _fromBalance - _amount;\n            _balances[_to] = _toBalance + _amount;\n        }", "highlightLines": [65]}, "category": "code", "location": {"file": "src/test/self-transfer.sol", "line": 65, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "35e02372a0d0", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            _balances[_from] = _fromBalance - _amount;\n            _balances[_to] = _toBalance + _amount;", "highlightLines": [68]}, "category": "code", "location": {"file": "src/test/self-transfer.sol", "line": 68, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "222efffe1ac6", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "            _balances[_from] = _fromBalance - _amount;", "highlightLines": [68]}, "category": "code", "location": {"file": "src/test/self-transfer.sol", "line": 68, "column": 32}, "severity": "medium", "references": [], "description": ""}, {"id": "68129ac59ddc", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "            _balances[_to] = _toBalance + _amount;", "highlightLines": [69]}, "category": "code", "location": {"file": "src/test/self-transfer.sol", "line": 69, "column": 30}, "severity": "medium", "references": [], "description": ""}, {"id": "a64ea3045389", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function transfer(address _from, address _to, uint256 _amount) public {", "highlightLines": [81]}, "category": "code", "location": {"file": "src/test/self-transfer.sol", "line": 81, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "8ace48c791db", "fix": {"template": null, "available": false}, "title": "Self transfer not checked - can cause balance corruption with from == to", "ruleId": "rules.sol-self-transfer-unchecked", "snippet": {"code": "    function transfer(address _from, address _to, uint256 _amount) public {", "highlightLines": [81]}, "category": "code", "location": {"file": "src/test/self-transfer.sol", "line": 81, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/self-transfer.sol"], "description": ""}, {"id": "7f39f9561838", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 _fromBalance = _balances[_from];", "highlightLines": [84]}, "category": "code", "location": {"file": "src/test/self-transfer.sol", "line": 84, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "dae683302364", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 _fromBalance = _balances[_from];\n        uint256 _toBalance = _balances[_to];", "highlightLines": [85]}, "category": "code", "location": {"file": "src/test/self-transfer.sol", "line": 85, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "92a7e2937997", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 _toBalance = _balances[_to];", "highlightLines": [86]}, "category": "code", "location": {"file": "src/test/self-transfer.sol", "line": 86, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "234fb8c2981d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 _toBalance = _balances[_to];\n\n        unchecked {\n            _balances[_from] = _fromBalance - _amount;\n            _balances[_to] = _toBalance + _amount;\n            /*\n            Another mitigation\n            _balances[_id][_from] -= _amount;\n            _balances[_id][_to] += _amount;\n            */\n        }", "highlightLines": [86]}, "category": "code", "location": {"file": "src/test/self-transfer.sol", "line": 86, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "0b53b021ef47", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            _balances[_from] = _fromBalance - _amount;\n            _balances[_to] = _toBalance + _amount;", "highlightLines": [89]}, "category": "code", "location": {"file": "src/test/self-transfer.sol", "line": 89, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "9de68caa49f7", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "            _balances[_from] = _fromBalance - _amount;", "highlightLines": [89]}, "category": "code", "location": {"file": "src/test/self-transfer.sol", "line": 89, "column": 32}, "severity": "medium", "references": [], "description": ""}, {"id": "c8d9b4020711", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "            _balances[_to] = _toBalance + _amount;", "highlightLines": [90]}, "category": "code", "location": {"file": "src/test/self-transfer.sol", "line": 90, "column": 30}, "severity": "medium", "references": [], "description": ""}, {"id": "1130b99f0054", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.15;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/txorigin.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "19419fd294d7", "fix": {"template": null, "available": false}, "title": "Potential mnemonic seed phrase detected - CRITICAL if real", "ruleId": "rules._shared.shared-mnemonic-phrase", "snippet": {"code": "tx.origin is a global variable in Solidity; using this variable for authentication in \na smart contract makes the contract vulnerable to phishing attacks.", "highlightLines": [10]}, "category": "code", "location": {"file": "src/test/txorigin.sol", "line": 10, "column": 60}, "severity": "high", "references": [], "description": ""}, {"id": "cac51c3ddf9b", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract ContractTest is Test {\n    Wallet WalletContract;\n    Attack AttackerContract;\n\n    function testtxorigin() public {\n        address alice = vm.addr(1);\n        address eve = vm.addr(2);", "highlightLines": [31]}, "category": "code", "location": {"file": "src/test/txorigin.sol", "line": 31, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "1536348ad67e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address alice = vm.addr(1);", "highlightLines": [36]}, "category": "code", "location": {"file": "src/test/txorigin.sol", "line": 36, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d3f0b71ad464", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "        address alice = vm.addr(1);\n        address eve = vm.addr(2);", "highlightLines": [36]}, "category": "code", "location": {"file": "src/test/txorigin.sol", "line": 36, "column": 9}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "acfeb7c23a4a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address alice = vm.addr(1);\n        address eve = vm.addr(2);", "highlightLines": [36]}, "category": "code", "location": {"file": "src/test/txorigin.sol", "line": 36, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "bfe6d7abc5e3", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address eve = vm.addr(2);", "highlightLines": [37]}, "category": "code", "location": {"file": "src/test/txorigin.sol", "line": 37, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "6959c7825b17", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address eve = vm.addr(2);\n        vm.deal(address(alice), 10 ether);\n        vm.deal(address(eve), 1 ether);\n        vm.prank(alice);\n        WalletContract = new Wallet{value: 10 ether}(); //Alice deploys Wallet with 10 Ether", "highlightLines": [37]}, "category": "code", "location": {"file": "src/test/txorigin.sol", "line": 37, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "c7aa04893a66", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        WalletContract = new Wallet{value: 10 ether}(); //Alice deploys Wallet with 10 Ether\n        console.log(\"Owner of wallet contract\", WalletContract.owner());\n        vm.prank(eve);\n        AttackerContract = new Attack(WalletContract); //Eve deploys Attack with the address of Alice's Wallet contract.", "highlightLines": [41]}, "category": "code", "location": {"file": "src/test/txorigin.sol", "line": 41, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e09937033e27", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        AttackerContract = new Attack(WalletContract); //Eve deploys Attack with the address of Alice's Wallet contract.", "highlightLines": [44]}, "category": "code", "location": {"file": "src/test/txorigin.sol", "line": 44, "column": 28}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "a6dceaf84488", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    receive() external payable {}", "highlightLines": [55]}, "category": "code", "location": {"file": "src/test/txorigin.sol", "line": 55, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "5f4f5f483cee", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "    receive() external payable {}", "highlightLines": [55]}, "category": "code", "location": {"file": "src/test/txorigin.sol", "line": 55, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "30f97a1d7045", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor() payable {\n        owner = msg.sender;\n    }", "highlightLines": [61]}, "category": "code", "location": {"file": "src/test/txorigin.sol", "line": 61, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "b3f228f75bc1", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        owner = msg.sender;", "highlightLines": [62]}, "category": "code", "location": {"file": "src/test/txorigin.sol", "line": 62, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "1d2b81e9760f", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function transfer(address payable _to, uint _amount) public {", "highlightLines": [65]}, "category": "code", "location": {"file": "src/test/txorigin.sol", "line": 65, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "52565287f641", "fix": {"template": null, "available": false}, "title": "tx.origin used for authorization - vulnerable to phishing attacks", "ruleId": "rules.sol-tx-origin-auth", "snippet": {"code": "        require(tx.origin == owner, \"Not owner\");", "highlightLines": [67]}, "category": "code", "location": {"file": "src/test/txorigin.sol", "line": 67, "column": 9}, "severity": "high", "references": [], "description": ""}, {"id": "aa2a1d31a9f0", "fix": {"template": null, "available": false}, "title": "Low-level call without checking return value - silent failure possible", "ruleId": "rules.sol-unchecked-call-return", "snippet": {"code": "        (bool sent, ) = _to.call{value: _amount}(\"\");", "highlightLines": [69]}, "category": "code", "location": {"file": "src/test/txorigin.sol", "line": 69, "column": 28}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-104/", "https://blocksecteam.medium.com/li-fi-attack"], "description": ""}, {"id": "445f4e73c824", "fix": {"template": null, "available": false}, "title": "State change after external call - potential reentrancy vulnerability", "ruleId": "rules.sol-external-call-state-change", "snippet": {"code": "        (bool sent, ) = _to.call{value: _amount}(\"\");\n        require(sent, \"Failed to send Ether\");\n    }\n}\n\ncontract Attack {\n    address payable public owner;\n    Wallet wallet;\n\n    constructor(Wallet _wallet) {\n        wallet = Wallet(_wallet);", "highlightLines": [69]}, "category": "code", "location": {"file": "src/test/txorigin.sol", "line": 69, "column": 28}, "severity": "high", "references": ["https://consensys.github.io/smart-contract-best-practices/attacks/reentrancy/"], "description": ""}, {"id": "0dced3d324f2", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(Wallet _wallet) {\n        wallet = Wallet(_wallet);\n        owner = payable(msg.sender);\n    }", "highlightLines": [78]}, "category": "code", "location": {"file": "src/test/txorigin.sol", "line": 78, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "68a2dbe7563c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        wallet = Wallet(_wallet);\n        owner = payable(msg.sender);", "highlightLines": [79]}, "category": "code", "location": {"file": "src/test/txorigin.sol", "line": 79, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e7ba7dbe4f50", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        owner = payable(msg.sender);", "highlightLines": [80]}, "category": "code", "location": {"file": "src/test/txorigin.sol", "line": 80, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "1c6fda19f55e", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        wallet.transfer(owner, address(wallet).balance);", "highlightLines": [84]}, "category": "code", "location": {"file": "src/test/txorigin.sol", "line": 84, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "4bef09ea3f56", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "        wallet.transfer(owner, address(wallet).balance);", "highlightLines": [84]}, "category": "code", "location": {"file": "src/test/txorigin.sol", "line": 84, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "961250be2b46", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.18;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/test/unsafe-downcast.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "c28ff9af9222", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        SimpleBankContract = new SimpleBank();\n        FixedSimpleBankContract = new FixedSimpleBank();", "highlightLines": [29]}, "category": "code", "location": {"file": "src/test/unsafe-downcast.sol", "line": 29, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "c729a1ec5d07", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        SimpleBankContract = new SimpleBank();", "highlightLines": [29]}, "category": "code", "location": {"file": "src/test/unsafe-downcast.sol", "line": 29, "column": 30}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "e2abafb8b133", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        FixedSimpleBankContract = new FixedSimpleBank();", "highlightLines": [30]}, "category": "code", "location": {"file": "src/test/unsafe-downcast.sol", "line": 30, "column": 35}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "bf96f94c7c33", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    receive() external payable {}", "highlightLines": [50]}, "category": "code", "location": {"file": "src/test/unsafe-downcast.sol", "line": 50, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "8fb945a2417d", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "    receive() external payable {}", "highlightLines": [50]}, "category": "code", "location": {"file": "src/test/unsafe-downcast.sol", "line": 50, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "a4f160d92b76", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function deposit(uint256 amount) public {", "highlightLines": [56]}, "category": "code", "location": {"file": "src/test/unsafe-downcast.sol", "line": 56, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "95d1c0d4637c", "fix": {"template": null, "available": false}, "title": "Function accepts zero amount without validation - can cause division by zero or empty operations", "ruleId": "rules.sol-missing-zero-amount-check", "snippet": {"code": "    function deposit(uint256 amount) public {", "highlightLines": [56]}, "category": "code", "location": {"file": "src/test/unsafe-downcast.sol", "line": 56, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "465cc6269f4b", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint8 balance = uint8(amount);", "highlightLines": [60]}, "category": "code", "location": {"file": "src/test/unsafe-downcast.sol", "line": 60, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c03edecc22a3", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "        uint8 balance = uint8(amount);", "highlightLines": [60]}, "category": "code", "location": {"file": "src/test/unsafe-downcast.sol", "line": 60, "column": 9}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "87383bb4be09", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint8 balance = uint8(amount);\n\n        // store the balance\n        balances[msg.sender] = balance;", "highlightLines": [60]}, "category": "code", "location": {"file": "src/test/unsafe-downcast.sol", "line": 60, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "a47243694a0c", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        uint8 balance = uint8(amount);", "highlightLines": [60]}, "category": "code", "location": {"file": "src/test/unsafe-downcast.sol", "line": 60, "column": 25}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "3c61fc6d38b6", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function deposit(uint256 _amount) public {", "highlightLines": [76]}, "category": "code", "location": {"file": "src/test/unsafe-downcast.sol", "line": 76, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "6cbca010d107", "fix": {"template": null, "available": false}, "title": "Function accepts zero amount without validation - can cause division by zero or empty operations", "ruleId": "rules.sol-missing-zero-amount-check", "snippet": {"code": "    function deposit(uint256 _amount) public {", "highlightLines": [76]}, "category": "code", "location": {"file": "src/test/unsafe-downcast.sol", "line": 76, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "979ae4642b1d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint8 amount = _amount.toUint8(); // or keep uint256", "highlightLines": [80]}, "category": "code", "location": {"file": "src/test/unsafe-downcast.sol", "line": 80, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "6a0ce9383638", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint8 amount = _amount.toUint8(); // or keep uint256\n\n        // Store the balance\n        balances[msg.sender] = amount;", "highlightLines": [80]}, "category": "code", "location": {"file": "src/test/unsafe-downcast.sol", "line": 80, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "53f916ea7d01", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "token:\n    description:", "highlightLines": [3]}, "category": "secrets", "location": {"file": "lib/openzeppelin-contracts/.github/actions/gas-compare/action.yml", "line": 3}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "cfa037b05991", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "token=ERC20VotesHarness", "highlightLines": [4]}, "category": "secrets", "location": {"file": "lib/openzeppelin-contracts/certora/scripts/WizardControlFirstPriority.sh", "line": 4}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "f928d7e738ad", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "token=ERC20VotesHarness", "highlightLines": [17]}, "category": "secrets", "location": {"file": "lib/openzeppelin-contracts/certora/scripts/verifyAll.sh", "line": 17}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "6c111fc1bad1", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "token = tokenAddress;", "highlightLines": [18]}, "category": "secrets", "location": {"file": "lib/openzeppelin-contracts/contracts/governance/extensions/GovernorVotes.sol", "line": 18}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "4f1ade537f6a", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "token = IERC777(_msgSender());", "highlightLines": [60]}, "category": "secrets", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC777SenderRecipientMock.sol", "line": 60}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "97b4b6fdb3b1", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "token = IERC777(_msgSender());", "highlightLines": [91]}, "category": "secrets", "location": {"file": "lib/openzeppelin-contracts/contracts/mocks/ERC777SenderRecipientMock.sol", "line": 91}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "948925b00212", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "token: token.address,", "highlightLines": [6]}, "category": "secrets", "location": {"file": "lib/openzeppelin-contracts/test/finance/VestingWallet.behavior.js", "line": 6}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "e4bbb698fb48", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "token: token.address,", "highlightLines": [519]}, "category": "secrets", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC777/ERC777.behavior.js", "line": 519}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "2c542877e82d", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "token: token.address,", "highlightLines": [526]}, "category": "secrets", "location": {"file": "lib/openzeppelin-contracts/test/token/ERC777/ERC777.behavior.js", "line": 526}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "487351b5e443", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "token = ERC777(nftAddress);", "highlightLines": [127]}, "category": "secrets", "location": {"file": "src/test/ERC777-reentrancy.sol", "line": 127}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "a138ede5f1a4", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "Token = IERC20(_USDa);", "highlightLines": [118]}, "category": "secrets", "location": {"file": "src/test/Price_manipulation.sol", "line": 118}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "185fd906c9ef", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "Token = IERC20(_USDb);", "highlightLines": [119]}, "category": "secrets", "location": {"file": "src/test/Price_manipulation.sol", "line": 119}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "a4d2b4208b55", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "token = IERC20(_token);", "highlightLines": [161]}, "category": "secrets", "location": {"file": "src/test/Price_manipulation.sol", "line": 161}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "162ac0d438db", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "Token = IERC20(_payoutToken);", "highlightLines": [163]}, "category": "secrets", "location": {"file": "src/test/Price_manipulation.sol", "line": 163}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "7d6a72339137", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "password = _password;", "highlightLines": [46]}, "category": "secrets", "location": {"file": "src/test/Privatedata.sol", "line": 46}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "ec9e0c582383", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "password: bytes32(_password)});", "highlightLines": [47]}, "category": "secrets", "location": {"file": "src/test/Privatedata.sol", "line": 47}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "92de7f535f93", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "TOKEN = 0x06325440D014e39736583c165C2963BA99fAf14E...", "highlightLines": [59]}, "category": "secrets", "location": {"file": "src/test/ReadOnlyReentrancy.sol", "line": 59}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "c801321c7f1f", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "token = IERC20(LP_TOKEN);", "highlightLines": [65]}, "category": "secrets", "location": {"file": "src/test/ReadOnlyReentrancy.sol", "line": 65}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "cb0d41f6dc1e", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "Token = IERC20(LP_TOKEN);", "highlightLines": [91]}, "category": "secrets", "location": {"file": "src/test/ReadOnlyReentrancy.sol", "line": 91}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "b13992b9228f", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "Token = IERC20(_loanToken);", "highlightLines": [96]}, "category": "secrets", "location": {"file": "src/test/first-deposit.sol", "line": 96}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "c10335ffe08a", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "Token = IERC20(_rewardsToken);", "highlightLines": [101]}, "category": "secrets", "location": {"file": "src/test/recoverERC20.sol", "line": 101}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "5868915653bd", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "Token = IERC20(_rewardsToken);", "highlightLines": [128]}, "category": "secrets", "location": {"file": "src/test/recoverERC20.sol", "line": 128}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "0414caa19965", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "token = IERC20(_tokenAddress);", "highlightLines": [318]}, "category": "secrets", "location": {"file": "src/test/fee-on-transfer.sol", "line": 318}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "6737aeed4ffa", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "token = IERC20(_tokenAddress);", "highlightLines": [353]}, "category": "secrets", "location": {"file": "src/test/fee-on-transfer.sol", "line": 353}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}]}]