[{"findings":[{"id": "d289c0e5e6ec", "fix": {"template": null, "available": false}, "title": "ecrecover result not checked for zero address - invalid signatures return address(0)", "ruleId": "rules.sol-ethernaut-ecrecover-no-zero-check", "snippet": {"code": "      address recoveredAddress = ecrecover(digest, v, r, s);", "highlightLines": [137]}, "category": "code", "location": {"file": "src/core/ERC20.sol", "line": 137, "column": 34}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-117", "https://swcregistry.io/docs/SWC-122"], "description": ""}, {"id": "cf680f87e4e2", "fix": {"template": null, "available": false}, "title": "Signature verification without s-value malleability check - signatures can be replayed with modified s", "ruleId": "rules.sol-ethernaut-signature-malleability", "snippet": {"code": "      address recoveredAddress = ecrecover(digest, v, r, s);", "highlightLines": [137]}, "category": "code", "location": {"file": "src/core/ERC20.sol", "line": 137, "column": 34}, "severity": "medium", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/utils/cryptography/ECDSA.sol"], "description": ""}, {"id": "cf2eedb12a27", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "    if (token0 == token1) revert SameTokenError();", "highlightLines": [74]}, "category": "code", "location": {"file": "src/core/Factory.sol", "line": 74, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "5a5e0223feb0", "fix": {"template": null, "available": false}, "title": "Potential mnemonic seed phrase detected - CRITICAL if real", "ruleId": "rules._shared.shared-mnemonic-phrase", "snippet": {"code": "  /// @dev Called by the immutable state constructor to fetch the parameters of the lendgine\n  function parameters()", "highlightLines": [24]}, "category": "code", "location": {"file": "src/core/interfaces/IFactory.sol", "line": 24, "column": 31}, "severity": "high", "references": [], "description": ""}, {"id": "21537172d6a3", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "      if (_positionInfo.size == 0) revert NoPositionError();", "highlightLines": [56]}, "category": "code", "location": {"file": "src/core/libraries/Position.sol", "line": 56, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "baf9287aa906", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "      uint256 twos = denominator & (~denominator + 1);", "highlightLines": [71]}, "category": "code", "location": {"file": "src/libraries/FullMath.sol", "line": 71, "column": 22}, "severity": "medium", "references": [], "description": ""}, {"id": "7e43861bea0d", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "      mstore(freeMemoryPointer, 0x23b872dd00000000000000000000000000000000000000000000000000000000) // Begin with", "highlightLines": [43]}, "category": "code", "location": {"file": "src/libraries/SafeTransferLib.sol", "line": 43, "column": 33}, "severity": "high", "references": [], "description": ""}, {"id": "7caa1fc1f12c", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "      mstore(freeMemoryPointer, 0xa9059cbb00000000000000000000000000000000000000000000000000000000) // Begin with", "highlightLines": [68]}, "category": "code", "location": {"file": "src/libraries/SafeTransferLib.sol", "line": 68, "column": 33}, "severity": "high", "references": [], "description": ""}, {"id": "0910dea81fb5", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "          if (result.length == 0) revert();", "highlightLines": [19]}, "category": "code", "location": {"file": "src/periphery/Multicall.sol", "line": 19, "column": 11}, "severity": "medium", "references": [], "description": ""}, {"id": "a5b3eaf9bd3b", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "    } else if (payer == address(this)) {\n      // pay with tokens already in the contract (for the exact input multihop case)\n      SafeTransferLib.safeTransfer(token, recipient, value);\n    } else {\n      // pull payment\n      SafeTransferLib.safeTransferFrom(token, payer, recipient, value);\n    }", "highlightLines": [57]}, "category": "code", "location": {"file": "src/periphery/Payment.sol", "line": 57, "column": 12}, "severity": "medium", "references": [], "description": ""}, {"id": "d8e02b3d96b4", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "  bytes32 internal constant POOL_INIT_CODE_HASH = 0xe34f199b19b2b4f47f68442619d555527d244f78a3297ea89325f843f87b8b54;", "highlightLines": [6]}, "category": "code", "location": {"file": "src/periphery/UniswapV3/libraries/PoolAddress.sol", "line": 6, "column": 51}, "severity": "high", "references": [], "description": ""}, {"id": "41596184619d", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "    lendgine.transfer(address(lendgine), 0.5 ether);", "highlightLines": [73]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 73, "column": 5}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "a0487ff8fe9e", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "    lendgine.transfer(address(lendgine), 0.5 ether);", "highlightLines": [97]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 97, "column": 5}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "72fcc9974598", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "    lendgine.transfer(address(lendgine), 0.5 ether);", "highlightLines": [122]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 122, "column": 5}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "81d194a7544d", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "    lendgine.transfer(address(lendgine), 0.25 ether);", "highlightLines": [215]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 215, "column": 5}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "456b28cb9682", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "    token0.transfer(cuh, 100 ether);", "highlightLines": [58]}, "category": "code", "location": {"file": "test/LendgineRouterTest.t.sol", "line": 58, "column": 5}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "24786b6b80ba", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "    token1.transfer(cuh, 100 ether);", "highlightLines": [61]}, "category": "code", "location": {"file": "test/LendgineRouterTest.t.sol", "line": 61, "column": 5}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "ef26d9fc4c67", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "    if (decoded.payer == address(this)) {\n      SafeTransferLib.safeTransfer(decoded.token, msg.sender, collateral);\n    } else {\n      SafeTransferLib.safeTransferFrom(decoded.token, decoded.payer, msg.sender, collateral);\n    }", "highlightLines": [43]}, "category": "code", "location": {"file": "test/utils/CallbackHelper.sol", "line": 43, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "d38cc6d1a74f", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "      lendgine.transfer(address(lendgine), shares);", "highlightLines": [73]}, "category": "code", "location": {"file": "test/utils/TestHelper.sol", "line": 73, "column": 7}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "e33598e0706d", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "      lendgine.transfer(address(lendgine), shares);", "highlightLines": [78]}, "category": "code", "location": {"file": "test/utils/TestHelper.sol", "line": 78, "column": 7}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "e2e7281dadc7", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "test/AccrueInterestTest.t.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "f1d7fc5df68e", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event AccrueInterest(uint256 timeElapsed, uint256 collateral, uint256 liquidity);", "highlightLines": [9]}, "category": "code", "location": {"file": "test/AccrueInterestTest.t.sol", "line": 9, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "f9ed797190a1", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);", "highlightLines": [41]}, "category": "code", "location": {"file": "test/AccrueInterestTest.t.sol", "line": 41, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8e646f2c4850", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);\n    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year", "highlightLines": [42]}, "category": "code", "location": {"file": "test/AccrueInterestTest.t.sol", "line": 42, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "36122114c759", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year", "highlightLines": [43]}, "category": "code", "location": {"file": "test/AccrueInterestTest.t.sol", "line": 43, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "23e11c31a211", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year\n    uint256 token1Dilution = 10 * lpDilution; // same as rewardPerPosition because position size is 1", "highlightLines": [43]}, "category": "code", "location": {"file": "test/AccrueInterestTest.t.sol", "line": 43, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "b3ddd4465ce0", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 token1Dilution = 10 * lpDilution; // same as rewardPerPosition because position size is 1", "highlightLines": [44]}, "category": "code", "location": {"file": "test/AccrueInterestTest.t.sol", "line": 44, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e98aedf2c8e8", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);", "highlightLines": [69]}, "category": "code", "location": {"file": "test/AccrueInterestTest.t.sol", "line": 69, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ffec8f8d6c75", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);\n    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year", "highlightLines": [70]}, "category": "code", "location": {"file": "test/AccrueInterestTest.t.sol", "line": 70, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "c90273fcc378", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year", "highlightLines": [71]}, "category": "code", "location": {"file": "test/AccrueInterestTest.t.sol", "line": 71, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "9a506b5146e5", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year\n    uint256 token1Dilution = 10 * lpDilution; // same as rewardPerPosition because position size is 1", "highlightLines": [71]}, "category": "code", "location": {"file": "test/AccrueInterestTest.t.sol", "line": 71, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "dd3e8c8bda11", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 token1Dilution = 10 * lpDilution; // same as rewardPerPosition because position size is 1", "highlightLines": [72]}, "category": "code", "location": {"file": "test/AccrueInterestTest.t.sol", "line": 72, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "12028a1c26f8", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    token1Scale = 9;\n\n    lendgine = Lendgine(factory.createLendgine(address(token0), address(token1), token0Scale, token1Scale, upperBound));", "highlightLines": [80]}, "category": "code", "location": {"file": "test/AccrueInterestTest.t.sol", "line": 80, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "193df202754e", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    lendgine = Lendgine(factory.createLendgine(address(token0), address(token1), token0Scale, token1Scale, upperBound));\n\n    token0.mint(address(this), 1e18);\n    token1.mint(address(this), 8 * 1e9);\n\n    lendgine.deposit(\n      address(this),\n      1 ether,\n      abi.encode(\n        PairMintCallbackData({\n          token0: address(token0),\n          token1: address(token1),\n          amount0: 1e18,\n          amount1: 8 * 1e9,\n          payer: address(this)\n        })\n      )\n    );\n\n    token1.mint(cuh, 5 * 1e9);\n\n    vm.prank(cuh);\n    token1.approve(address(this), 5 * 1e9);\n    lendgine.mint(cuh, 5 * 1e9, abi.encode(MintCallbackData({token: address(token1), payer: cuh})));\n\n    vm.warp(365 days + 1);\n\n    lendgine.accrueInterest();\n\n    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);", "highlightLines": [82]}, "category": "code", "location": {"file": "test/AccrueInterestTest.t.sol", "line": 82, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "cbf4633272f8", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    token0.mint(address(this), 1e18);", "highlightLines": [84]}, "category": "code", "location": {"file": "test/AccrueInterestTest.t.sol", "line": 84, "column": 32}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "57b1c7dfca9b", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "          amount0: 1e18,", "highlightLines": [94]}, "category": "code", "location": {"file": "test/AccrueInterestTest.t.sol", "line": 94, "column": 20}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "adfde9dd4813", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);", "highlightLines": [110]}, "category": "code", "location": {"file": "test/AccrueInterestTest.t.sol", "line": 110, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8fea4058776d", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);\n    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year", "highlightLines": [111]}, "category": "code", "location": {"file": "test/AccrueInterestTest.t.sol", "line": 111, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "36963ba70309", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);\n    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year\n    uint256 token1Dilution = lendgine.convertLiquidityToCollateral(lpDilution); // same as rewardPerPosition because", "highlightLines": [111]}, "category": "code", "location": {"file": "test/AccrueInterestTest.t.sol", "line": 111, "column": 5}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "8d97d16a4d91", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year", "highlightLines": [112]}, "category": "code", "location": {"file": "test/AccrueInterestTest.t.sol", "line": 112, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a2b7ab510b73", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year\n    uint256 token1Dilution = lendgine.convertLiquidityToCollateral(lpDilution); // same as rewardPerPosition because", "highlightLines": [112]}, "category": "code", "location": {"file": "test/AccrueInterestTest.t.sol", "line": 112, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "7e221c7b6fc4", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 token1Dilution = lendgine.convertLiquidityToCollateral(lpDilution); // same as rewardPerPosition because", "highlightLines": [113]}, "category": "code", "location": {"file": "test/AccrueInterestTest.t.sol", "line": 113, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b399e83031db", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "test/AccruePositionInterestTest.t.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "91a7d53154f0", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event AccruePositionInterest(address indexed owner, uint256 rewardPerPosition);", "highlightLines": [10]}, "category": "code", "location": {"file": "test/AccruePositionInterestTest.t.sol", "line": 10, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "d31e083ba538", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);", "highlightLines": [43]}, "category": "code", "location": {"file": "test/AccruePositionInterestTest.t.sol", "line": 43, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e720e44574e3", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);\n    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year", "highlightLines": [44]}, "category": "code", "location": {"file": "test/AccruePositionInterestTest.t.sol", "line": 44, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "55841d0261e2", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);\n    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year\n    uint256 token1Dilution = 10 * lpDilution; // same as rewardPerPosition because position size is 1\n\n    (uint256 positionSize, uint256 rewardPerPositionPaid, uint256 tokensOwed) = lendgine.positions(cuh);", "highlightLines": [44]}, "category": "code", "location": {"file": "test/AccruePositionInterestTest.t.sol", "line": 44, "column": 5}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "276a2808d84a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year", "highlightLines": [45]}, "category": "code", "location": {"file": "test/AccruePositionInterestTest.t.sol", "line": 45, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b2a9f594bc3e", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year\n    uint256 token1Dilution = 10 * lpDilution; // same as rewardPerPosition because position size is 1", "highlightLines": [45]}, "category": "code", "location": {"file": "test/AccruePositionInterestTest.t.sol", "line": 45, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "685f4daa720d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 token1Dilution = 10 * lpDilution; // same as rewardPerPosition because position size is 1", "highlightLines": [46]}, "category": "code", "location": {"file": "test/AccruePositionInterestTest.t.sol", "line": 46, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "bbf30e873815", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 token1Dilution = 10 * lpDilution; // same as rewardPerPosition because position size is 1\n\n    (uint256 positionSize, uint256 rewardPerPositionPaid, uint256 tokensOwed) = lendgine.positions(cuh);", "highlightLines": [46]}, "category": "code", "location": {"file": "test/AccruePositionInterestTest.t.sol", "line": 46, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "555987ffda7e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);", "highlightLines": [59]}, "category": "code", "location": {"file": "test/AccruePositionInterestTest.t.sol", "line": 59, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8d4aee2d7f14", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);\n    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year", "highlightLines": [60]}, "category": "code", "location": {"file": "test/AccruePositionInterestTest.t.sol", "line": 60, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "782f6d9a7291", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year", "highlightLines": [61]}, "category": "code", "location": {"file": "test/AccruePositionInterestTest.t.sol", "line": 61, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4901a2490701", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year\n    uint256 token1Dilution = 10 * lpDilution; // same as rewardPerPosition because position size is 1", "highlightLines": [61]}, "category": "code", "location": {"file": "test/AccruePositionInterestTest.t.sol", "line": 61, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "cf10ba1f31c6", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 token1Dilution = 10 * lpDilution; // same as rewardPerPosition because position size is 1", "highlightLines": [62]}, "category": "code", "location": {"file": "test/AccruePositionInterestTest.t.sol", "line": 62, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7ef79796cebb", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "5495227d7f6e", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event Burn(address indexed sender, uint256 collateral, uint256 shares, uint256 liquidity, address indexed to);", "highlightLines": [10]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 10, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "87ca491f3b5d", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event Mint(uint256 amount0In, uint256 amount1In, uint256 liquidity);", "highlightLines": [12]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 12, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "7f841690720f", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 collateral = _burn(cuh, cuh, 0.25 ether, 0.25 ether, 2 ether);", "highlightLines": [21]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 21, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f0f34a598e6e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 collateral = _burn(cuh, cuh, 0.5 ether, 0.5 ether, 4 ether);", "highlightLines": [44]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 44, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c9c3ab52e6f9", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "    lendgine.transfer(address(lendgine), 0.5 ether);", "highlightLines": [73]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 73, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "63f77b292e68", "fix": {"template": null, "available": false}, "title": "ERC20 transfer() return value not checked - tokens like USDT don't return bool", "ruleId": "rules.sol-erc20-transfer-no-return-check", "snippet": {"code": "    lendgine.transfer(address(lendgine), 0.5 ether);", "highlightLines": [73]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 73, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "24173e3fa585", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "    lendgine.transfer(address(lendgine), 0.5 ether);", "highlightLines": [97]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 97, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "8fb06509bc40", "fix": {"template": null, "available": false}, "title": "ERC20 transfer() return value not checked - tokens like USDT don't return bool", "ruleId": "rules.sol-erc20-transfer-no-return-check", "snippet": {"code": "    lendgine.transfer(address(lendgine), 0.5 ether);", "highlightLines": [97]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 97, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "9dee6816bed5", "fix": {"template": null, "available": false}, "title": "Event emitted after external call - reentrancy can cause events to be logged out of order", "ruleId": "rules.sol-event-after-external-call", "snippet": {"code": "    lendgine.transfer(address(lendgine), 0.5 ether);\n\n    vm.startPrank(cuh);\n    token0.approve(address(this), 0.5 ether);\n    token1.approve(address(this), 4 ether);\n    vm.stopPrank();\n\n    vm.expectEmit(true, true, false, true, address(lendgine));\n    emit Burn(address(this), 5 ether, 0.5 ether, 0.5 ether, cuh);", "highlightLines": [97]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 97, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "94e3d86e14d9", "fix": {"template": null, "available": false}, "title": "address(this) directly in emit - likely wrong address (should use token/handler variable)", "ruleId": "rules.sol-emit-address-this", "snippet": {"code": "    emit Burn(address(this), 5 ether, 0.5 ether, 0.5 ether, cuh);", "highlightLines": [105]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 105, "column": 5}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "c48245f6b753", "fix": {"template": null, "available": false}, "title": "address(this) emitted in event - may emit wrong address (handler vs token confusion)", "ruleId": "rules.sol-address-this-in-event", "snippet": {"code": "    emit Burn(address(this), 5 ether, 0.5 ether, 0.5 ether, cuh);", "highlightLines": [105]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 105, "column": 5}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "9223fa176018", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "    lendgine.transfer(address(lendgine), 0.5 ether);", "highlightLines": [122]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 122, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "c5a32e0a8696", "fix": {"template": null, "available": false}, "title": "ERC20 transfer() return value not checked - tokens like USDT don't return bool", "ruleId": "rules.sol-erc20-transfer-no-return-check", "snippet": {"code": "    lendgine.transfer(address(lendgine), 0.5 ether);", "highlightLines": [122]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 122, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "80c93739270d", "fix": {"template": null, "available": false}, "title": "Event emitted after external call - reentrancy can cause events to be logged out of order", "ruleId": "rules.sol-event-after-external-call", "snippet": {"code": "    lendgine.transfer(address(lendgine), 0.5 ether);\n\n    vm.startPrank(cuh);\n    token0.approve(address(this), 0.5 ether);\n    token1.approve(address(this), 4 ether);\n    vm.stopPrank();\n\n    vm.expectEmit(false, false, false, true, address(lendgine));\n    emit Mint(0.5 ether, 4 ether, 0.5 ether);", "highlightLines": [122]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 122, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "ec7170bb009a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 reserve0 = lendgine.reserve0();", "highlightLines": [148]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 148, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4b4190b993d7", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "    uint256 reserve0 = lendgine.reserve0();\n    uint256 reserve1 = lendgine.reserve1();", "highlightLines": [149]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 149, "column": 5}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "b42a4074724f", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 reserve0 = lendgine.reserve0();\n    uint256 reserve1 = lendgine.reserve1();", "highlightLines": [149]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 149, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "e56ba211d0c3", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 reserve1 = lendgine.reserve1();", "highlightLines": [150]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 150, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8f3d3045bca5", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 reserve1 = lendgine.reserve1();\n\n    uint256 amount0 =\n      FullMath.mulDivRoundingUp(reserve0, lendgine.convertShareToLiquidity(0.5 ether), lendgine.totalLiquidity());", "highlightLines": [150]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 150, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "f4168896c72e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 amount0 =", "highlightLines": [151]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 151, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "bbf901eab0cc", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "    uint256 amount0 =\n      FullMath.mulDivRoundingUp(reserve0, lendgine.convertShareToLiquidity(0.5 ether), lendgine.totalLiquidity());\n    uint256 amount1 =\n      FullMath.mulDivRoundingUp(reserve1, lendgine.convertShareToLiquidity(0.5 ether), lendgine.totalLiquidity());", "highlightLines": [152]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 152, "column": 5}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "4a39457d0dc1", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 amount0 =\n      FullMath.mulDivRoundingUp(reserve0, lendgine.convertShareToLiquidity(0.5 ether), lendgine.totalLiquidity());\n    uint256 amount1 =\n      FullMath.mulDivRoundingUp(reserve1, lendgine.convertShareToLiquidity(0.5 ether), lendgine.totalLiquidity());", "highlightLines": [152]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 152, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "7be7af894183", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 amount1 =", "highlightLines": [154]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 154, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c5422b733691", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);", "highlightLines": [166]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 166, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "090a092806b5", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);\n    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year", "highlightLines": [167]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 167, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "65d5bf12575b", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);\n    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year\n\n    uint256 reserve0 = lendgine.reserve0();", "highlightLines": [167]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 167, "column": 5}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "0246d068f6b8", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year", "highlightLines": [168]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 168, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "6a2b25e4558c", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year\n\n    uint256 reserve0 = lendgine.reserve0();", "highlightLines": [168]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 168, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "2e09b43d4cf5", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 reserve0 = lendgine.reserve0();", "highlightLines": [169]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 169, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c0c099eb37fd", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "    uint256 reserve0 = lendgine.reserve0();\n    uint256 reserve1 = lendgine.reserve1();", "highlightLines": [170]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 170, "column": 5}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "79f911fe497a", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 reserve0 = lendgine.reserve0();\n    uint256 reserve1 = lendgine.reserve1();", "highlightLines": [170]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 170, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "f1223062aa21", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 reserve1 = lendgine.reserve1();", "highlightLines": [171]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 171, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7d2f206f3fd2", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 reserve1 = lendgine.reserve1();\n    uint256 shares = 0.25 ether;", "highlightLines": [171]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 171, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "735a1b04df23", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 shares = 0.25 ether;", "highlightLines": [172]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 172, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "6ea10f1e4602", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 shares = 0.25 ether;\n\n    uint256 amount0 =\n      FullMath.mulDivRoundingUp(reserve0, lendgine.convertShareToLiquidity(shares), lendgine.totalLiquidity());", "highlightLines": [172]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 172, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "cb23a465c1b2", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 amount0 =", "highlightLines": [173]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 173, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "821b9eaf9b76", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "    uint256 amount0 =\n      FullMath.mulDivRoundingUp(reserve0, lendgine.convertShareToLiquidity(shares), lendgine.totalLiquidity());\n    uint256 amount1 =\n      FullMath.mulDivRoundingUp(reserve1, lendgine.convertShareToLiquidity(shares), lendgine.totalLiquidity());", "highlightLines": [174]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 174, "column": 5}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "6aaf403ae319", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 amount0 =\n      FullMath.mulDivRoundingUp(reserve0, lendgine.convertShareToLiquidity(shares), lendgine.totalLiquidity());\n    uint256 amount1 =\n      FullMath.mulDivRoundingUp(reserve1, lendgine.convertShareToLiquidity(shares), lendgine.totalLiquidity());", "highlightLines": [174]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 174, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "670a9e73eec8", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 amount1 =", "highlightLines": [176]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 176, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e12195214b19", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 amount1 =\n      FullMath.mulDivRoundingUp(reserve1, lendgine.convertShareToLiquidity(shares), lendgine.totalLiquidity());\n\n    uint256 collateral = _burn(cuh, cuh, shares, amount0, amount1);", "highlightLines": [176]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 176, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "1766ae9eb74a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 collateral = _burn(cuh, cuh, shares, amount0, amount1);", "highlightLines": [178]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 178, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ad6353a25fec", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    token1Scale = 9;\n\n    lendgine = Lendgine(factory.createLendgine(address(token0), address(token1), token0Scale, token1Scale, upperBound));", "highlightLines": [190]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 190, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "ed9443713506", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    lendgine = Lendgine(factory.createLendgine(address(token0), address(token1), token0Scale, token1Scale, upperBound));\n\n    token0.mint(address(this), 1e18);\n    token1.mint(address(this), 8 * 1e9);\n\n    lendgine.deposit(\n      address(this),\n      1 ether,\n      abi.encode(\n        PairMintCallbackData({\n          token0: address(token0),\n          token1: address(token1),\n          amount0: 1e18,\n          amount1: 8 * 1e9,\n          payer: address(this)\n        })\n      )\n    );\n\n    token1.mint(address(this), 5 * 1e9);\n\n    lendgine.mint(address(this), 5 * 1e9, abi.encode(MintCallbackData({token: address(token1), payer: address(this)})));\n\n    lendgine.transfer(address(lendgine), 0.25 ether);\n\n    uint256 collateral = lendgine.burn(\n      address(this),\n      abi.encode(\n        PairMintCallbackData({\n          token0: address(token0),\n          token1: address(token1),\n          amount0: 0.25 ether,\n          amount1: 2 * 1e9,\n          payer: address(this)\n        })\n      )\n    );", "highlightLines": [192]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 192, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "e35f3b47a8a1", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    token0.mint(address(this), 1e18);", "highlightLines": [194]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 194, "column": 32}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "69c5d72c48fe", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "          amount0: 1e18,", "highlightLines": [204]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 204, "column": 20}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "3b70600ade97", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "    lendgine.transfer(address(lendgine), 0.25 ether);", "highlightLines": [215]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 215, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "236807b3d179", "fix": {"template": null, "available": false}, "title": "ERC20 transfer() return value not checked - tokens like USDT don't return bool", "ruleId": "rules.sol-erc20-transfer-no-return-check", "snippet": {"code": "    lendgine.transfer(address(lendgine), 0.25 ether);", "highlightLines": [215]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 215, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "ef2d91f03dec", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 collateral = lendgine.burn(", "highlightLines": [216]}, "category": "code", "location": {"file": "test/BurnTest.t.sol", "line": 216, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "49ed9923b2a3", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "test/CollectTest.t.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "cc0e49fc0b84", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event Collect(address indexed owner, address indexed to, uint256 amount);", "highlightLines": [9]}, "category": "code", "location": {"file": "test/CollectTest.t.sol", "line": 9, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "d580d13e8db5", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 collateral = lendgine.collect(cuh, 0);", "highlightLines": [16]}, "category": "code", "location": {"file": "test/CollectTest.t.sol", "line": 16, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d9d778e64862", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "    uint256 collateral = lendgine.collect(cuh, 0);\n    assertEq(0, collateral);\n\n    collateral = lendgine.collect(cuh, 1 ether);", "highlightLines": [16]}, "category": "code", "location": {"file": "test/CollectTest.t.sol", "line": 16, "column": 5}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "9209b79c471e", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 collateral = lendgine.collect(cuh, 0);\n    assertEq(0, collateral);\n\n    collateral = lendgine.collect(cuh, 1 ether);", "highlightLines": [16]}, "category": "code", "location": {"file": "test/CollectTest.t.sol", "line": 16, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "9b44a60af419", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);", "highlightLines": [28]}, "category": "code", "location": {"file": "test/CollectTest.t.sol", "line": 28, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "66a95790340d", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);\n    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year", "highlightLines": [29]}, "category": "code", "location": {"file": "test/CollectTest.t.sol", "line": 29, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "74a5bf54bf5a", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);\n    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year\n\n    vm.prank(cuh);\n    lendgine.accruePositionInterest();\n\n    vm.prank(cuh);\n    uint256 collateral = lendgine.collect(cuh, lpDilution * 5);", "highlightLines": [29]}, "category": "code", "location": {"file": "test/CollectTest.t.sol", "line": 29, "column": 5}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "a0c76c967bd9", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year", "highlightLines": [30]}, "category": "code", "location": {"file": "test/CollectTest.t.sol", "line": 30, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "afa4ccb7ea73", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year\n\n    vm.prank(cuh);\n    lendgine.accruePositionInterest();\n\n    vm.prank(cuh);\n    uint256 collateral = lendgine.collect(cuh, lpDilution * 5);", "highlightLines": [30]}, "category": "code", "location": {"file": "test/CollectTest.t.sol", "line": 30, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "67e2d9764c59", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 collateral = lendgine.collect(cuh, lpDilution * 5);", "highlightLines": [36]}, "category": "code", "location": {"file": "test/CollectTest.t.sol", "line": 36, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "06a6e726dfd2", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "    uint256 collateral = lendgine.collect(cuh, lpDilution * 5);\n\n    // check return data\n    assertEq(lpDilution * 5, collateral);\n\n    // check position\n    (,, uint256 tokensOwed) = lendgine.positions(cuh);", "highlightLines": [36]}, "category": "code", "location": {"file": "test/CollectTest.t.sol", "line": 36, "column": 5}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "3363934dff8a", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 collateral = lendgine.collect(cuh, lpDilution * 5);\n\n    // check return data\n    assertEq(lpDilution * 5, collateral);\n\n    // check position\n    (,, uint256 tokensOwed) = lendgine.positions(cuh);", "highlightLines": [36]}, "category": "code", "location": {"file": "test/CollectTest.t.sol", "line": 36, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "af7d89e8ef0e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);", "highlightLines": [54]}, "category": "code", "location": {"file": "test/CollectTest.t.sol", "line": 54, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "cd6f10a04f69", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);\n    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year", "highlightLines": [55]}, "category": "code", "location": {"file": "test/CollectTest.t.sol", "line": 55, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "4d60a395e05c", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);\n    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year\n\n    vm.prank(cuh);\n    lendgine.accruePositionInterest();\n\n    vm.prank(cuh);\n    uint256 collateral = lendgine.collect(cuh, 100 ether);", "highlightLines": [55]}, "category": "code", "location": {"file": "test/CollectTest.t.sol", "line": 55, "column": 5}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "6ba97fdc85d2", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year", "highlightLines": [56]}, "category": "code", "location": {"file": "test/CollectTest.t.sol", "line": 56, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8eaa73ae5d69", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year\n\n    vm.prank(cuh);\n    lendgine.accruePositionInterest();\n\n    vm.prank(cuh);\n    uint256 collateral = lendgine.collect(cuh, 100 ether);", "highlightLines": [56]}, "category": "code", "location": {"file": "test/CollectTest.t.sol", "line": 56, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "8230627ae84c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 collateral = lendgine.collect(cuh, 100 ether);", "highlightLines": [62]}, "category": "code", "location": {"file": "test/CollectTest.t.sol", "line": 62, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "482238705ab7", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "    uint256 collateral = lendgine.collect(cuh, 100 ether);\n\n    // check return data\n    assertEq(lpDilution * 10, collateral);\n\n    // check position\n    (,, uint256 tokensOwed) = lendgine.positions(cuh);", "highlightLines": [62]}, "category": "code", "location": {"file": "test/CollectTest.t.sol", "line": 62, "column": 5}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "c390bb06d5fd", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 collateral = lendgine.collect(cuh, 100 ether);\n\n    // check return data\n    assertEq(lpDilution * 10, collateral);\n\n    // check position\n    (,, uint256 tokensOwed) = lendgine.positions(cuh);", "highlightLines": [62]}, "category": "code", "location": {"file": "test/CollectTest.t.sol", "line": 62, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "d36918f4e76e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);", "highlightLines": [80]}, "category": "code", "location": {"file": "test/CollectTest.t.sol", "line": 80, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "82dff82f7298", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);\n    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year", "highlightLines": [81]}, "category": "code", "location": {"file": "test/CollectTest.t.sol", "line": 81, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "5cf132727a6a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year", "highlightLines": [82]}, "category": "code", "location": {"file": "test/CollectTest.t.sol", "line": 82, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "bb9309a93421", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "test/DepositTest.t.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "578d0416b413", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event Deposit(address indexed sender, uint256 size, uint256 liquidity, address indexed to);", "highlightLines": [9]}, "category": "code", "location": {"file": "test/DepositTest.t.sol", "line": 9, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "6fe24833bec3", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event Mint(uint256 amount0In, uint256 amount1In, uint256 liquidity);", "highlightLines": [11]}, "category": "code", "location": {"file": "test/DepositTest.t.sol", "line": 11, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "1f39f6374e58", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 size = _deposit(cuh, cuh, 1 ether, 8 ether, 1 ether);", "highlightLines": [18]}, "category": "code", "location": {"file": "test/DepositTest.t.sol", "line": 18, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ab12bfbf93b0", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 size = _deposit(cuh, cuh, 1 ether, 8 ether, 1 ether);\n\n    // check lendgine storage slots\n    assertEq(1 ether, lendgine.totalLiquidity());\n    assertEq(1 ether, lendgine.totalPositionSize());\n    assertEq(1 ether, uint256(lendgine.reserve0()));\n    assertEq(8 ether, uint256(lendgine.reserve1()));\n\n    // check lendgine balances\n    assertEq(1 ether, token0.balanceOf(address(lendgine)));\n    assertEq(8 ether, token1.balanceOf(address(lendgine)));\n\n    // check position size\n    assertEq(1 ether, size);\n    (uint256 positionSize,,) = lendgine.positions(cuh);", "highlightLines": [18]}, "category": "code", "location": {"file": "test/DepositTest.t.sol", "line": 18, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "e3296cd3b9da", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 size = _deposit(cuh, cuh, 1 ether + 1, 8 ether + 1, 1 ether);", "highlightLines": [37]}, "category": "code", "location": {"file": "test/DepositTest.t.sol", "line": 37, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a131e9160e77", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 size = _deposit(cuh, cuh, 1 ether + 1, 8 ether + 1, 1 ether);\n\n    // check lendgine storage slots\n    assertEq(1 ether, lendgine.totalLiquidity());\n    assertEq(1 ether, lendgine.totalPositionSize());\n    assertEq(1 ether + 1, uint256(lendgine.reserve0()));\n    assertEq(8 ether + 1, uint256(lendgine.reserve1()));\n\n    // check lendgine balances\n    assertEq(1 ether + 1, token0.balanceOf(address(lendgine)));\n    assertEq(8 ether + 1, token1.balanceOf(address(lendgine)));\n\n    // check position size\n    assertEq(1 ether, size);\n    (uint256 positionSize,,) = lendgine.positions(cuh);", "highlightLines": [37]}, "category": "code", "location": {"file": "test/DepositTest.t.sol", "line": 37, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "16b0ab9a9c9d", "fix": {"template": null, "available": false}, "title": "address(this) directly in emit - likely wrong address (should use token/handler variable)", "ruleId": "rules.sol-emit-address-this", "snippet": {"code": "    emit Deposit(address(this), 1 ether, 1 ether, cuh);", "highlightLines": [95]}, "category": "code", "location": {"file": "test/DepositTest.t.sol", "line": 95, "column": 5}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "a50031a0a53d", "fix": {"template": null, "available": false}, "title": "address(this) emitted in event - may emit wrong address (handler vs token confusion)", "ruleId": "rules.sol-address-this-in-event", "snippet": {"code": "    emit Deposit(address(this), 1 ether, 1 ether, cuh);", "highlightLines": [95]}, "category": "code", "location": {"file": "test/DepositTest.t.sol", "line": 95, "column": 5}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "774349cd06cc", "fix": {"template": null, "available": false}, "title": "SWC-110: assert() used for input validation - use require() instead, assert is for invariants", "ruleId": "rules.sol-swc-110-assert-user-input", "snippet": {"code": "    assert(rewardPerPositionPaid != 0);", "highlightLines": [164]}, "category": "code", "location": {"file": "test/DepositTest.t.sol", "line": 164, "column": 5}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-110"], "description": ""}, {"id": "51603ff736af", "fix": {"template": null, "available": false}, "title": "SWC-110: assert() used for input validation - use require() instead, assert is for invariants", "ruleId": "rules.sol-swc-110-assert-user-input", "snippet": {"code": "    assert(tokensOwed != 0);", "highlightLines": [165]}, "category": "code", "location": {"file": "test/DepositTest.t.sol", "line": 165, "column": 5}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-110"], "description": ""}, {"id": "e3b64b700551", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 size = _deposit(cuh, cuh, 1 ether, 8 ether, 1 ether);", "highlightLines": [173]}, "category": "code", "location": {"file": "test/DepositTest.t.sol", "line": 173, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "25afbd7f7c3b", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 size = _deposit(cuh, cuh, 1 ether, 8 ether, 1 ether);\n\n    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);", "highlightLines": [174]}, "category": "code", "location": {"file": "test/DepositTest.t.sol", "line": 174, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "02e68a90ba4c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);", "highlightLines": [175]}, "category": "code", "location": {"file": "test/DepositTest.t.sol", "line": 175, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e194402f5d54", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);\n    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year", "highlightLines": [176]}, "category": "code", "location": {"file": "test/DepositTest.t.sol", "line": 176, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "112fe772887c", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);\n    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year\n\n    // check position size\n    assertEq((1 ether * 1 ether) / (1 ether - lpDilution), size);\n    assertApproxEqAbs(1 ether, (size * (2 ether - lpDilution)) / (1 ether + size), 1);\n    (uint256 positionSize,,) = lendgine.positions(cuh);", "highlightLines": [176]}, "category": "code", "location": {"file": "test/DepositTest.t.sol", "line": 176, "column": 5}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "95f781cea1b3", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year", "highlightLines": [177]}, "category": "code", "location": {"file": "test/DepositTest.t.sol", "line": 177, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f1bd9549d5d9", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year\n\n    // check position size\n    assertEq((1 ether * 1 ether) / (1 ether - lpDilution), size);\n    assertApproxEqAbs(1 ether, (size * (2 ether - lpDilution)) / (1 ether + size), 1);\n    (uint256 positionSize,,) = lendgine.positions(cuh);", "highlightLines": [177]}, "category": "code", "location": {"file": "test/DepositTest.t.sol", "line": 177, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "212aa65f50fb", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    token1Scale = 9;\n\n    lendgine = Lendgine(factory.createLendgine(address(token0), address(token1), token0Scale, token1Scale, upperBound));", "highlightLines": [191]}, "category": "code", "location": {"file": "test/DepositTest.t.sol", "line": 191, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "43fe79c36ba1", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    lendgine = Lendgine(factory.createLendgine(address(token0), address(token1), token0Scale, token1Scale, upperBound));\n\n    token0.mint(address(this), 1e18);\n    token1.mint(address(this), 8 * 1e9);\n\n    uint256 size = lendgine.deposit(\n      address(this),\n      1 ether,\n      abi.encode(\n        PairMintCallbackData({\n          token0: address(token0),\n          token1: address(token1),\n          amount0: 1e18,\n          amount1: 8 * 1e9,\n          payer: address(this)\n        })\n      )\n    );", "highlightLines": [193]}, "category": "code", "location": {"file": "test/DepositTest.t.sol", "line": 193, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "30f59661aae3", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    token0.mint(address(this), 1e18);", "highlightLines": [195]}, "category": "code", "location": {"file": "test/DepositTest.t.sol", "line": 195, "column": 32}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "f5e718e24d1b", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 size = lendgine.deposit(", "highlightLines": [197]}, "category": "code", "location": {"file": "test/DepositTest.t.sol", "line": 197, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "5aa140d9de14", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "    uint256 size = lendgine.deposit(\n      address(this),\n      1 ether,\n      abi.encode(\n        PairMintCallbackData({\n          token0: address(token0),\n          token1: address(token1),\n          amount0: 1e18,\n          amount1: 8 * 1e9,\n          payer: address(this)\n        })\n      )\n    );\n\n    // check lendgine storage slots\n    assertEq(1 ether, lendgine.totalLiquidity());\n    assertEq(1 ether, lendgine.totalPositionSize());\n    assertEq(1 ether, uint256(lendgine.reserve0()));\n    assertEq(8 * 1e9, uint256(lendgine.reserve1()));\n\n    // check lendgine balances\n    assertEq(1 ether, token0.balanceOf(address(lendgine)));\n    assertEq(8 * 1e9, token1.balanceOf(address(lendgine)));\n\n    // check position size\n    assertEq(1 ether, size);\n    (uint256 positionSize,,) = lendgine.positions(address(this));", "highlightLines": [198]}, "category": "code", "location": {"file": "test/DepositTest.t.sol", "line": 198, "column": 5}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "083fbf850952", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 size = lendgine.deposit(\n      address(this),\n      1 ether,\n      abi.encode(\n        PairMintCallbackData({\n          token0: address(token0),\n          token1: address(token1),\n          amount0: 1e18,\n          amount1: 8 * 1e9,\n          payer: address(this)\n        })\n      )\n    );\n\n    // check lendgine storage slots\n    assertEq(1 ether, lendgine.totalLiquidity());\n    assertEq(1 ether, lendgine.totalPositionSize());\n    assertEq(1 ether, uint256(lendgine.reserve0()));\n    assertEq(8 * 1e9, uint256(lendgine.reserve1()));\n\n    // check lendgine balances\n    assertEq(1 ether, token0.balanceOf(address(lendgine)));\n    assertEq(8 * 1e9, token1.balanceOf(address(lendgine)));\n\n    // check position size\n    assertEq(1 ether, size);\n    (uint256 positionSize,,) = lendgine.positions(address(this));", "highlightLines": [198]}, "category": "code", "location": {"file": "test/DepositTest.t.sol", "line": 198, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "aff12d3385ed", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "          amount0: 1e18,", "highlightLines": [205]}, "category": "code", "location": {"file": "test/DepositTest.t.sol", "line": 205, "column": 20}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "f4697af598fa", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "test/FactoryTest.t.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "cb0a1e187650", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event LendgineCreated(\n    address indexed token0,\n    address indexed token1,\n    uint256 token0Scale,\n    uint256 token1Scale,\n    uint256 indexed upperBound,\n    address lendgine\n  );", "highlightLines": [11]}, "category": "code", "location": {"file": "test/FactoryTest.t.sol", "line": 11, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "aed6f2e308e0", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event LendgineCreated(\n    address indexed token0,\n    address indexed token1,\n    uint256 token0Scale,\n    uint256 token1Scale,\n    uint256 indexed upperBound,\n    address lendgine\n  );", "highlightLines": [11]}, "category": "code", "location": {"file": "test/FactoryTest.t.sol", "line": 11, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "a4cfa95236e6", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    factory = new Factory();", "highlightLines": [23]}, "category": "code", "location": {"file": "test/FactoryTest.t.sol", "line": 23, "column": 15}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "9d9eafa0cb96", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address lendgine = factory.createLendgine(address(1), address(2), 18, 18, 1e18);", "highlightLines": [27]}, "category": "code", "location": {"file": "test/FactoryTest.t.sol", "line": 27, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d16cf3e57e57", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    address lendgine = factory.createLendgine(address(1), address(2), 18, 18, 1e18);", "highlightLines": [27]}, "category": "code", "location": {"file": "test/FactoryTest.t.sol", "line": 27, "column": 79}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "8c5cd4917bfd", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    assertEq(lendgine, factory.getLendgine(address(1), address(2), 18, 18, 1e18));", "highlightLines": [29]}, "category": "code", "location": {"file": "test/FactoryTest.t.sol", "line": 29, "column": 76}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "8bacdf3bf41a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address lendgineEstimate = LendgineAddress.computeAddress(address(factory), address(1), address(2), 18, 18, 1e18);", "highlightLines": [33]}, "category": "code", "location": {"file": "test/FactoryTest.t.sol", "line": 33, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "bdc5a387837d", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    address lendgineEstimate = LendgineAddress.computeAddress(address(factory), address(1), address(2), 18, 18, 1e18);\n\n    address lendgine = factory.createLendgine(address(1), address(2), 18, 18, 1e18);", "highlightLines": [33]}, "category": "code", "location": {"file": "test/FactoryTest.t.sol", "line": 33, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "58dfcba81e3e", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    address lendgineEstimate = LendgineAddress.computeAddress(address(factory), address(1), address(2), 18, 18, 1e18);", "highlightLines": [33]}, "category": "code", "location": {"file": "test/FactoryTest.t.sol", "line": 33, "column": 113}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "7e30d97a8d9a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    address lendgine = factory.createLendgine(address(1), address(2), 18, 18, 1e18);", "highlightLines": [34]}, "category": "code", "location": {"file": "test/FactoryTest.t.sol", "line": 34, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ae663ff546c9", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    address lendgine = factory.createLendgine(address(1), address(2), 18, 18, 1e18);", "highlightLines": [35]}, "category": "code", "location": {"file": "test/FactoryTest.t.sol", "line": 35, "column": 79}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "6d4674180cb2", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "    assertEq(lendgine, lendgineEstimate);", "highlightLines": [37]}, "category": "code", "location": {"file": "test/FactoryTest.t.sol", "line": 37, "column": 14}, "severity": "info", "references": [], "description": ""}, {"id": "c3b537f17219", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    factory.createLendgine(address(1), address(1), 18, 18, 1e18);", "highlightLines": [42]}, "category": "code", "location": {"file": "test/FactoryTest.t.sol", "line": 42, "column": 60}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "ecc0eac54cc8", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    factory.createLendgine(address(0), address(1), 18, 18, 1e18);", "highlightLines": [47]}, "category": "code", "location": {"file": "test/FactoryTest.t.sol", "line": 47, "column": 60}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "9c402212f46d", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    factory.createLendgine(address(1), address(0), 18, 18, 1e18);", "highlightLines": [50]}, "category": "code", "location": {"file": "test/FactoryTest.t.sol", "line": 50, "column": 60}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "4b18ded6e032", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    factory.createLendgine(address(1), address(2), 18, 18, 1e18);", "highlightLines": [54]}, "category": "code", "location": {"file": "test/FactoryTest.t.sol", "line": 54, "column": 60}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "574bda4ee70a", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    factory.createLendgine(address(1), address(2), 18, 18, 1e18);", "highlightLines": [57]}, "category": "code", "location": {"file": "test/FactoryTest.t.sol", "line": 57, "column": 60}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "f4e8305f8cb6", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    factory.createLendgine(address(1), address(2), 18, 18, 1e18);", "highlightLines": [74]}, "category": "code", "location": {"file": "test/FactoryTest.t.sol", "line": 74, "column": 60}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "cac87ed2af08", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address lendgineEstimate = address(", "highlightLines": [80]}, "category": "code", "location": {"file": "test/FactoryTest.t.sol", "line": 80, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "fe563b8810ec", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "          keccak256(\n            abi.encodePacked(\n              hex\"ff\",\n              address(factory),\n              keccak256(abi.encode(address(1), address(2), 18, 18, 1e18)),\n              keccak256(type(Lendgine).creationCode)\n            )\n          )", "highlightLines": [83]}, "category": "code", "location": {"file": "test/FactoryTest.t.sol", "line": 83, "column": 11}, "severity": "high", "references": [], "description": ""}, {"id": "15071a80b14e", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "            abi.encodePacked(\n              hex\"ff\",\n              address(factory),\n              keccak256(abi.encode(address(1), address(2), 18, 18, 1e18)),\n              keccak256(type(Lendgine).creationCode)\n            )", "highlightLines": [84]}, "category": "code", "location": {"file": "test/FactoryTest.t.sol", "line": 84, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "192271f9d29e", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "              keccak256(abi.encode(address(1), address(2), 18, 18, 1e18)),", "highlightLines": [87]}, "category": "code", "location": {"file": "test/FactoryTest.t.sol", "line": 87, "column": 15}, "severity": "high", "references": [], "description": ""}, {"id": "0513b5544732", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "              keccak256(abi.encode(address(1), address(2), 18, 18, 1e18)),", "highlightLines": [87]}, "category": "code", "location": {"file": "test/FactoryTest.t.sol", "line": 87, "column": 68}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "8ccd3c7810a1", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    emit LendgineCreated(address(1), address(2), 18, 18, 1e18, lendgineEstimate);", "highlightLines": [95]}, "category": "code", "location": {"file": "test/FactoryTest.t.sol", "line": 95, "column": 58}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "3d45e84e94ac", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    factory.createLendgine(address(1), address(2), 18, 18, 1e18);", "highlightLines": [96]}, "category": "code", "location": {"file": "test/FactoryTest.t.sol", "line": 96, "column": 60}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "134efda9c209", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "test/ImmutableStateTest.t.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "137e6a4c028c", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    factory = new Factory();\n    lendgine = Lendgine(factory.createLendgine(address(1), address(2), 18, 18, 1e18));", "highlightLines": [13]}, "category": "code", "location": {"file": "test/ImmutableStateTest.t.sol", "line": 13, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "d484aca75e13", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    factory = new Factory();", "highlightLines": [13]}, "category": "code", "location": {"file": "test/ImmutableStateTest.t.sol", "line": 13, "column": 15}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "9aa3b5f9deb4", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    lendgine = Lendgine(factory.createLendgine(address(1), address(2), 18, 18, 1e18));", "highlightLines": [14]}, "category": "code", "location": {"file": "test/ImmutableStateTest.t.sol", "line": 14, "column": 80}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "457babc44183", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    assertEq(1e18, lendgine.upperBound());", "highlightLines": [22]}, "category": "code", "location": {"file": "test/ImmutableStateTest.t.sol", "line": 22, "column": 14}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "073ed5cb9fef", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "test/LendgineRouterTest.t.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "062ce60e00eb", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event Mint(address indexed from, address indexed lendgine, uint256 collateral, uint256 shares, address indexed to);", "highlightLines": [16]}, "category": "code", "location": {"file": "test/LendgineRouterTest.t.sol", "line": 16, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "4e6b9364197d", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event Burn(address indexed from, address indexed lendgine, uint256 collateral, uint256 shares, address indexed to);", "highlightLines": [18]}, "category": "code", "location": {"file": "test/LendgineRouterTest.t.sol", "line": 18, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "4b07136bcf4a", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    lendgineRouter = new LendgineRouter(\n      address(factory),\n      address(uniswapV2Factory),\n      address(uniswapV3Factory),\n      address(0)\n    );\n\n    // set up the uniswap v2 pair\n    uniswapV2Pair = IUniswapV2Pair(uniswapV2Factory.createPair(address(token0), address(token1)));", "highlightLines": [35]}, "category": "code", "location": {"file": "test/LendgineRouterTest.t.sol", "line": 35, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "e9a8bd301c4d", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    lendgineRouter = new LendgineRouter(\n      address(factory),\n      address(uniswapV2Factory),\n      address(uniswapV3Factory),\n      address(0)\n    );", "highlightLines": [35]}, "category": "code", "location": {"file": "test/LendgineRouterTest.t.sol", "line": 35, "column": 22}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "537f1b143204", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    token0 = MockERC20(0x1f9840a85d5aF5bf1D1762F925BDADdC4201F984); // UNI\n    token1 = MockERC20(0xB4FBF271143F4FBf7B91A5ded31805e42b2208d6); // WETH", "highlightLines": [53]}, "category": "code", "location": {"file": "test/LendgineRouterTest.t.sol", "line": 53, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "5a0c58dcef4c", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    token1 = MockERC20(0xB4FBF271143F4FBf7B91A5ded31805e42b2208d6); // WETH\n\n    // get tokens\n    vm.prank(0x1f9840a85d5aF5bf1D1762F925BDADdC4201F984);\n    token0.transfer(cuh, 100 ether);\n\n    vm.prank(0xb3A16C2B68BBB0111EbD27871a5934b949837D95);\n    token1.transfer(cuh, 100 ether);\n\n    // deploy lendgine\n    lendgine = Lendgine(factory.createLendgine(address(token0), address(token1), 18, 18, 3 ether));", "highlightLines": [54]}, "category": "code", "location": {"file": "test/LendgineRouterTest.t.sol", "line": 54, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "e07cce41e5fe", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "    token0.transfer(cuh, 100 ether);", "highlightLines": [58]}, "category": "code", "location": {"file": "test/LendgineRouterTest.t.sol", "line": 58, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "27a79bfb0593", "fix": {"template": null, "available": false}, "title": "ERC20 transfer() return value not checked - tokens like USDT don't return bool", "ruleId": "rules.sol-erc20-transfer-no-return-check", "snippet": {"code": "    token0.transfer(cuh, 100 ether);", "highlightLines": [58]}, "category": "code", "location": {"file": "test/LendgineRouterTest.t.sol", "line": 58, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "179d55264ba0", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "    token1.transfer(cuh, 100 ether);", "highlightLines": [61]}, "category": "code", "location": {"file": "test/LendgineRouterTest.t.sol", "line": 61, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "342e4dc8bf3a", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        deadline: block.timestamp", "highlightLines": [108]}, "category": "code", "location": {"file": "test/LendgineRouterTest.t.sol", "line": 108, "column": 19}, "severity": "medium", "references": [], "description": ""}, {"id": "f06c857eba4b", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        deadline: block.timestamp", "highlightLines": [153]}, "category": "code", "location": {"file": "test/LendgineRouterTest.t.sol", "line": 153, "column": 19}, "severity": "medium", "references": [], "description": ""}, {"id": "f19051af787e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 balance0Before = token0.balanceOf(address(uniswapV3Pool));", "highlightLines": [180]}, "category": "code", "location": {"file": "test/LendgineRouterTest.t.sol", "line": 180, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b2f6163a7cdf", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 balance0Before = token0.balanceOf(address(uniswapV3Pool));\n    uint256 balance1Before = token1.balanceOf(address(uniswapV3Pool));", "highlightLines": [181]}, "category": "code", "location": {"file": "test/LendgineRouterTest.t.sol", "line": 181, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "86c7a90a84f0", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 balance1Before = token1.balanceOf(address(uniswapV3Pool));", "highlightLines": [182]}, "category": "code", "location": {"file": "test/LendgineRouterTest.t.sol", "line": 182, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "157637364a12", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        deadline: block.timestamp", "highlightLines": [201]}, "category": "code", "location": {"file": "test/LendgineRouterTest.t.sol", "line": 201, "column": 19}, "severity": "medium", "references": [], "description": ""}, {"id": "07591c66ff62", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        deadline: block.timestamp", "highlightLines": [244]}, "category": "code", "location": {"file": "test/LendgineRouterTest.t.sol", "line": 244, "column": 19}, "severity": "medium", "references": [], "description": ""}, {"id": "8e9c3e0c763c", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        deadline: block.timestamp", "highlightLines": [270]}, "category": "code", "location": {"file": "test/LendgineRouterTest.t.sol", "line": 270, "column": 19}, "severity": "medium", "references": [], "description": ""}, {"id": "28e679ad757b", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        deadline: block.timestamp", "highlightLines": [297]}, "category": "code", "location": {"file": "test/LendgineRouterTest.t.sol", "line": 297, "column": 19}, "severity": "medium", "references": [], "description": ""}, {"id": "d4393f1517d1", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        deadline: block.timestamp", "highlightLines": [322]}, "category": "code", "location": {"file": "test/LendgineRouterTest.t.sol", "line": 322, "column": 19}, "severity": "medium", "references": [], "description": ""}, {"id": "0f0d8caf13c9", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        deadline: block.timestamp", "highlightLines": [344]}, "category": "code", "location": {"file": "test/LendgineRouterTest.t.sol", "line": 344, "column": 19}, "severity": "medium", "references": [], "description": ""}, {"id": "fd55e7126d32", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        deadline: block.timestamp", "highlightLines": [388]}, "category": "code", "location": {"file": "test/LendgineRouterTest.t.sol", "line": 388, "column": 19}, "severity": "medium", "references": [], "description": ""}, {"id": "720cd0b82339", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        deadline: block.timestamp", "highlightLines": [412]}, "category": "code", "location": {"file": "test/LendgineRouterTest.t.sol", "line": 412, "column": 19}, "severity": "medium", "references": [], "description": ""}, {"id": "7484cbcc76af", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 balance0Before = token0.balanceOf(address(uniswapV3Pool));", "highlightLines": [438]}, "category": "code", "location": {"file": "test/LendgineRouterTest.t.sol", "line": 438, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "de53b2d64ac6", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 balance0Before = token0.balanceOf(address(uniswapV3Pool));\n    uint256 balance1Before = token1.balanceOf(address(uniswapV3Pool));", "highlightLines": [439]}, "category": "code", "location": {"file": "test/LendgineRouterTest.t.sol", "line": 439, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "3ecaa04360df", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 balance1Before = token1.balanceOf(address(uniswapV3Pool));", "highlightLines": [440]}, "category": "code", "location": {"file": "test/LendgineRouterTest.t.sol", "line": 440, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f169617937a3", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "    uint256 balance1Before = token1.balanceOf(address(uniswapV3Pool));\n\n    uint256 userBalanceBefore = token1.balanceOf(cuh);", "highlightLines": [440]}, "category": "code", "location": {"file": "test/LendgineRouterTest.t.sol", "line": 440, "column": 5}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "301ed9ec2196", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 balance1Before = token1.balanceOf(address(uniswapV3Pool));\n\n    uint256 userBalanceBefore = token1.balanceOf(cuh);", "highlightLines": [440]}, "category": "code", "location": {"file": "test/LendgineRouterTest.t.sol", "line": 440, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "ded28e6138c2", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 userBalanceBefore = token1.balanceOf(cuh);", "highlightLines": [441]}, "category": "code", "location": {"file": "test/LendgineRouterTest.t.sol", "line": 441, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c28f1c96e7d8", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        deadline: block.timestamp", "highlightLines": [461]}, "category": "code", "location": {"file": "test/LendgineRouterTest.t.sol", "line": 461, "column": 19}, "severity": "medium", "references": [], "description": ""}, {"id": "69195b6c6814", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        deadline: block.timestamp", "highlightLines": [483]}, "category": "code", "location": {"file": "test/LendgineRouterTest.t.sol", "line": 483, "column": 19}, "severity": "medium", "references": [], "description": ""}, {"id": "8f2f7db527be", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        deadline: block.timestamp", "highlightLines": [527]}, "category": "code", "location": {"file": "test/LendgineRouterTest.t.sol", "line": 527, "column": 19}, "severity": "medium", "references": [], "description": ""}, {"id": "cc8d4a44f2d2", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        deadline: block.timestamp", "highlightLines": [551]}, "category": "code", "location": {"file": "test/LendgineRouterTest.t.sol", "line": 551, "column": 19}, "severity": "medium", "references": [], "description": ""}, {"id": "8dd7b93ebfe5", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        deadline: block.timestamp", "highlightLines": [576]}, "category": "code", "location": {"file": "test/LendgineRouterTest.t.sol", "line": 576, "column": 19}, "severity": "medium", "references": [], "description": ""}, {"id": "d5aca47b89cb", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        deadline: block.timestamp", "highlightLines": [599]}, "category": "code", "location": {"file": "test/LendgineRouterTest.t.sol", "line": 599, "column": 19}, "severity": "medium", "references": [], "description": ""}, {"id": "247b124769ec", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        deadline: block.timestamp", "highlightLines": [624]}, "category": "code", "location": {"file": "test/LendgineRouterTest.t.sol", "line": 624, "column": 19}, "severity": "medium", "references": [], "description": ""}, {"id": "85b5bb9252d8", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        deadline: block.timestamp", "highlightLines": [647]}, "category": "code", "location": {"file": "test/LendgineRouterTest.t.sol", "line": 647, "column": 19}, "severity": "medium", "references": [], "description": ""}, {"id": "9f4990587ce2", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        deadline: block.timestamp", "highlightLines": [672]}, "category": "code", "location": {"file": "test/LendgineRouterTest.t.sol", "line": 672, "column": 19}, "severity": "medium", "references": [], "description": ""}, {"id": "783b3ca23820", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 balanceBefore = token1.balanceOf(address(cuh));", "highlightLines": [675]}, "category": "code", "location": {"file": "test/LendgineRouterTest.t.sol", "line": 675, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f6750882cde5", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        deadline: block.timestamp", "highlightLines": [696]}, "category": "code", "location": {"file": "test/LendgineRouterTest.t.sol", "line": 696, "column": 19}, "severity": "medium", "references": [], "description": ""}, {"id": "d2999c6215c4", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "43804d51ceb5", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event AddLiquidity(\n    address indexed from,\n    address indexed lendgine,\n    uint256 liquidity,\n    uint256 size,\n    uint256 amount0,\n    uint256 amount1,\n    address indexed to\n  );", "highlightLines": [9]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 9, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "fe46b9fdce9f", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event AddLiquidity(\n    address indexed from,\n    address indexed lendgine,\n    uint256 liquidity,\n    uint256 size,\n    uint256 amount0,\n    uint256 amount1,\n    address indexed to\n  );", "highlightLines": [9]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 9, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "05c9c37f3120", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event RemoveLiquidity(\n    address indexed from,\n    address indexed lendgine,\n    uint256 liquidity,\n    uint256 size,\n    uint256 amount0,\n    uint256 amount1,\n    address indexed to\n  );", "highlightLines": [19]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 19, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "1c2d4e2c5960", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event RemoveLiquidity(\n    address indexed from,\n    address indexed lendgine,\n    uint256 liquidity,\n    uint256 size,\n    uint256 amount0,\n    uint256 amount1,\n    address indexed to\n  );", "highlightLines": [19]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 19, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "ede794424b8d", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event Collect(address indexed from, address indexed lendgine, uint256 amount, address indexed to);", "highlightLines": [29]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 29, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "0073aba7954b", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    liquidityManager = new LiquidityManager(address(factory), address(0));", "highlightLines": [35]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 35, "column": 24}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "f05a8d20978c", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        deadline: block.timestamp", "highlightLines": [65]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 65, "column": 19}, "severity": "medium", "references": [], "description": ""}, {"id": "7fdb183475ed", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    (uint256 positionSize,,) = lendgine.positions(address(liquidityManager));\n    assertEq(1 ether, positionSize);\n\n    // test balances\n    assertEq(0, token0.balanceOf(address(liquidityManager)));\n    assertEq(0, token1.balanceOf(address(liquidityManager)));\n\n    // test liquidity manager position\n    (positionSize,,) = liquidityManager.positions(cuh, address(lendgine));", "highlightLines": [80]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 80, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "9969cb973b18", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    (uint256 positionSize,,) = lendgine.positions(address(liquidityManager));\n    assertEq(1 ether, positionSize);\n\n    // test balances\n    assertEq(0, token0.balanceOf(address(liquidityManager)));\n    assertEq(0, token1.balanceOf(address(liquidityManager)));\n\n    // test liquidity manager position\n    (positionSize,,) = liquidityManager.positions(cuh, address(lendgine));", "highlightLines": [104]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 104, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "338512607acd", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        deadline: block.timestamp", "highlightLines": [158]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 158, "column": 19}, "severity": "medium", "references": [], "description": ""}, {"id": "d8da55fd095f", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);", "highlightLines": [172]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 172, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "10ddaccb84a4", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);\n    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year", "highlightLines": [173]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 173, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "c0e64d128ccb", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);\n    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year\n    uint256 size = (1 ether * 1 ether) / (1 ether - lpDilution);\n\n    // test lendgine storage\n    assertEq(lendgine.totalLiquidity(), 1.5 ether);\n    assertEq(lendgine.totalPositionSize(), 1 ether + size);\n    assertEq(lendgine.reserve0(), 1.5 ether);\n    assertEq(lendgine.reserve1(), 12 ether);\n\n    // test lendgine position\n    (uint256 positionSize, uint256 rewardPerPositionPaid, uint256 tokensOwed) =\n      lendgine.positions(address(liquidityManager));", "highlightLines": [173]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 173, "column": 5}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "9d9f84d68856", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year", "highlightLines": [174]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 174, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ecb5a96f81fd", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year\n    uint256 size = (1 ether * 1 ether) / (1 ether - lpDilution);", "highlightLines": [174]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 174, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "d118eae53733", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 size = (1 ether * 1 ether) / (1 ether - lpDilution);", "highlightLines": [175]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 175, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f341279a4db4", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 size = (1 ether * 1 ether) / (1 ether - lpDilution);\n\n    // test lendgine storage\n    assertEq(lendgine.totalLiquidity(), 1.5 ether);\n    assertEq(lendgine.totalPositionSize(), 1 ether + size);\n    assertEq(lendgine.reserve0(), 1.5 ether);\n    assertEq(lendgine.reserve1(), 12 ether);\n\n    // test lendgine position\n    (uint256 positionSize, uint256 rewardPerPositionPaid, uint256 tokensOwed) =\n      lendgine.positions(address(liquidityManager));", "highlightLines": [175]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 175, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "2ec617839d94", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    (uint256 positionSize, uint256 rewardPerPositionPaid, uint256 tokensOwed) =\n      lendgine.positions(address(liquidityManager));\n    assertEq(1 ether + size, positionSize);\n    assertEq(10 * lpDilution, rewardPerPositionPaid);\n    assertEq(10 * lpDilution, tokensOwed);\n\n    // test balances\n    assertEq(0, token0.balanceOf(address(liquidityManager)));\n    assertEq(0, token1.balanceOf(address(liquidityManager)));\n\n    // test liquidity manager position\n    (positionSize, rewardPerPositionPaid, tokensOwed) = liquidityManager.positions(cuh, address(lendgine));", "highlightLines": [184]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 184, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "4190c4825465", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);", "highlightLines": [209]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 209, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "681a0b5306cb", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);\n    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year", "highlightLines": [210]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 210, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "016b4b480d65", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);\n    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year\n    uint256 size = (1 ether * 1 ether) / (1 ether - lpDilution);\n\n    // test lendgine storage\n    assertEq(lendgine.totalLiquidity(), 1.5 ether);\n    assertEq(lendgine.totalPositionSize(), 1 ether + size);\n    assertEq(lendgine.reserve0(), 1.5 ether);\n    assertEq(lendgine.reserve1(), 12 ether);\n\n    // test lendgine position\n    (uint256 positionSize, uint256 rewardPerPositionPaid,) = lendgine.positions(address(liquidityManager));", "highlightLines": [210]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 210, "column": 5}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "8d6895de7804", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year", "highlightLines": [211]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 211, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4371894e9c84", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year\n    uint256 size = (1 ether * 1 ether) / (1 ether - lpDilution);", "highlightLines": [211]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 211, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "8170117771c2", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 size = (1 ether * 1 ether) / (1 ether - lpDilution);", "highlightLines": [212]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 212, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7330dc7936e2", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 size = (1 ether * 1 ether) / (1 ether - lpDilution);\n\n    // test lendgine storage\n    assertEq(lendgine.totalLiquidity(), 1.5 ether);\n    assertEq(lendgine.totalPositionSize(), 1 ether + size);\n    assertEq(lendgine.reserve0(), 1.5 ether);\n    assertEq(lendgine.reserve1(), 12 ether);\n\n    // test lendgine position\n    (uint256 positionSize, uint256 rewardPerPositionPaid,) = lendgine.positions(address(liquidityManager));", "highlightLines": [212]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 212, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "95361eb9dcd2", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    (uint256 positionSize, uint256 rewardPerPositionPaid,) = lendgine.positions(address(liquidityManager));\n    assertEq(1 ether + size, positionSize);\n    assertEq(10 * lpDilution, rewardPerPositionPaid);\n\n    // test balances\n    assertEq(0, token0.balanceOf(address(liquidityManager)));\n    assertEq(0, token1.balanceOf(address(liquidityManager)));\n\n    // test liquidity manager position\n    (positionSize, rewardPerPositionPaid,) = liquidityManager.positions(cuh, address(lendgine));", "highlightLines": [221]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 221, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "0047fd7672b4", "fix": {"template": null, "available": false}, "title": "Callback handler doesn't update status - repeated callbacks possible", "ruleId": "rules.sol-callback-no-status-update", "snippet": {"code": "  function testCallbackValidation() external {", "highlightLines": [235]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 235, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "2b95eccb8e27", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        deadline: block.timestamp", "highlightLines": [276]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 276, "column": 19}, "severity": "medium", "references": [], "description": ""}, {"id": "9348efcbc49a", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        deadline: block.timestamp", "highlightLines": [297]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 297, "column": 19}, "severity": "medium", "references": [], "description": ""}, {"id": "1b3b17fa5999", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    (uint256 positionSize,,) = lendgine.positions(address(liquidityManager));\n    assertEq(0, positionSize);\n\n    // test balances\n    assertEq(0, token0.balanceOf(address(liquidityManager)));\n    assertEq(0, token1.balanceOf(address(liquidityManager)));\n\n    // test liquidity manager position\n    (positionSize,,) = liquidityManager.positions(cuh, address(lendgine));", "highlightLines": [308]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 308, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "beb74084f3f5", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        deadline: block.timestamp", "highlightLines": [336]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 336, "column": 19}, "severity": "medium", "references": [], "description": ""}, {"id": "676446cc44f1", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        deadline: block.timestamp", "highlightLines": [356]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 356, "column": 19}, "severity": "medium", "references": [], "description": ""}, {"id": "cbb70dcdb5f8", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    (uint256 positionSize,,) = lendgine.positions(address(liquidityManager));\n    assertEq(0, positionSize);\n\n    // test balances\n    assertEq(1 ether, token0.balanceOf(address(liquidityManager)));\n    assertEq(8 ether, token1.balanceOf(address(liquidityManager)));\n\n    // test liquidity manager position\n    (positionSize,,) = liquidityManager.positions(cuh, address(lendgine));", "highlightLines": [367]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 367, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "5ea00a8140a2", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        deadline: block.timestamp", "highlightLines": [396]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 396, "column": 19}, "severity": "medium", "references": [], "description": ""}, {"id": "15de3136ee16", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        deadline: block.timestamp", "highlightLines": [418]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 418, "column": 19}, "severity": "medium", "references": [], "description": ""}, {"id": "ef940e9a85e0", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        deadline: block.timestamp", "highlightLines": [440]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 440, "column": 19}, "severity": "medium", "references": [], "description": ""}, {"id": "b236492aa125", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);", "highlightLines": [443]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 443, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "fd3631db28f8", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);\n    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year", "highlightLines": [444]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 444, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "8f08c42761eb", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);\n    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year\n\n    // test lendgine storage\n    assertEq(lendgine.totalLiquidity(), lpDilution / 2);\n    assertEq(lendgine.totalPositionSize(), 0.5 ether);\n    assertEq(lendgine.reserve0(), lpDilution / 2);\n    assertEq(lendgine.reserve1(), lpDilution * 4);\n\n    // test lendgine position\n    (uint256 positionSize, uint256 rewardPerPositionPaid,) = lendgine.positions(address(liquidityManager));", "highlightLines": [444]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 444, "column": 5}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "d65e2ccbf21c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year", "highlightLines": [445]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 445, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d7a059204ed6", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year\n\n    // test lendgine storage\n    assertEq(lendgine.totalLiquidity(), lpDilution / 2);\n    assertEq(lendgine.totalPositionSize(), 0.5 ether);\n    assertEq(lendgine.reserve0(), lpDilution / 2);\n    assertEq(lendgine.reserve1(), lpDilution * 4);\n\n    // test lendgine position\n    (uint256 positionSize, uint256 rewardPerPositionPaid,) = lendgine.positions(address(liquidityManager));", "highlightLines": [445]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 445, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "466238ef46ed", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    (uint256 positionSize, uint256 rewardPerPositionPaid,) = lendgine.positions(address(liquidityManager));\n    assertEq(0.5 ether, positionSize);\n    assertEq(lpDilution * 10, rewardPerPositionPaid);\n\n    // test balances\n    assertEq(0, token0.balanceOf(address(liquidityManager)));\n    assertEq(0, token1.balanceOf(address(liquidityManager)));\n\n    // test liquidity manager position\n    (positionSize, rewardPerPositionPaid,) = liquidityManager.positions(cuh, address(lendgine));", "highlightLines": [454]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 454, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "2949f94286f9", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);", "highlightLines": [472]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 472, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "6dfda46dece3", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);\n    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year", "highlightLines": [473]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 473, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "6fc623638a22", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);\n    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year\n\n    vm.prank(cuh);\n    liquidityManager.collect(\n      LiquidityManager.CollectParams({lendgine: address(lendgine), recipient: cuh, amountRequested: lpDilution * 10})\n    );\n\n    // test lendgine storage slots\n    assertEq(lpDilution * 10, lendgine.rewardPerPositionStored());\n\n    // test lendgine position\n    (, uint256 rewardPerPositionPaid, uint256 tokensOwed) = lendgine.positions(address(liquidityManager));", "highlightLines": [473]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 473, "column": 5}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "6e466e12a323", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year", "highlightLines": [474]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 474, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "77321d6cefae", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year\n\n    vm.prank(cuh);\n    liquidityManager.collect(\n      LiquidityManager.CollectParams({lendgine: address(lendgine), recipient: cuh, amountRequested: lpDilution * 10})\n    );\n\n    // test lendgine storage slots\n    assertEq(lpDilution * 10, lendgine.rewardPerPositionStored());\n\n    // test lendgine position\n    (, uint256 rewardPerPositionPaid, uint256 tokensOwed) = lendgine.positions(address(liquidityManager));", "highlightLines": [474]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 474, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "7165b707d7db", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    (, uint256 rewardPerPositionPaid, uint256 tokensOwed) = lendgine.positions(address(liquidityManager));\n    assertEq(lpDilution * 10, rewardPerPositionPaid);\n    assertEq(0, tokensOwed);\n\n    // test liquidity manager position\n    (, rewardPerPositionPaid, tokensOwed) = liquidityManager.positions(cuh, address(lendgine));", "highlightLines": [485]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 485, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "a111771d2982", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);", "highlightLines": [502]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 502, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "eadc98853e07", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);\n    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year", "highlightLines": [503]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 503, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "ed7aadf76695", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);\n    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year\n\n    vm.prank(cuh);\n    liquidityManager.collect(\n      LiquidityManager.CollectParams({lendgine: address(lendgine), recipient: cuh, amountRequested: 100 ether})\n    );\n\n    // test lendgine storage slots\n    assertEq(lpDilution * 10, lendgine.rewardPerPositionStored());\n\n    // test lendgine position\n    (, uint256 rewardPerPositionPaid, uint256 tokensOwed) = lendgine.positions(address(liquidityManager));", "highlightLines": [503]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 503, "column": 5}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "793a8ea9fabd", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year", "highlightLines": [504]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 504, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "44ea1b8f47f1", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year\n\n    vm.prank(cuh);\n    liquidityManager.collect(\n      LiquidityManager.CollectParams({lendgine: address(lendgine), recipient: cuh, amountRequested: 100 ether})\n    );\n\n    // test lendgine storage slots\n    assertEq(lpDilution * 10, lendgine.rewardPerPositionStored());\n\n    // test lendgine position\n    (, uint256 rewardPerPositionPaid, uint256 tokensOwed) = lendgine.positions(address(liquidityManager));", "highlightLines": [504]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 504, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "c7ce9090e6c3", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    (, uint256 rewardPerPositionPaid, uint256 tokensOwed) = lendgine.positions(address(liquidityManager));\n    assertEq(lpDilution * 10, rewardPerPositionPaid);\n    assertEq(0, tokensOwed);\n\n    // test liquidity manager position\n    (, rewardPerPositionPaid, tokensOwed) = liquidityManager.positions(cuh, address(lendgine));", "highlightLines": [515]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 515, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "4774a28a0300", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);", "highlightLines": [532]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 532, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "dfd625390d96", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);\n    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year", "highlightLines": [533]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 533, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "339762caad3f", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year", "highlightLines": [534]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 534, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "24d640e6fe62", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);", "highlightLines": [553]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 553, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "22fc2136066d", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);\n    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year", "highlightLines": [554]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 554, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "31c2a8420ee2", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year", "highlightLines": [555]}, "category": "code", "location": {"file": "test/LiquidityManagerTest.t.sol", "line": 555, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b3c3ed826f72", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "test/MintTest.t.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "15637ed24d29", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event Mint(address indexed sender, uint256 collateral, uint256 shares, uint256 liquidity, address indexed to);", "highlightLines": [9]}, "category": "code", "location": {"file": "test/MintTest.t.sol", "line": 9, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "7b10671d53dc", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 shares = _mint(cuh, cuh, 5 ether);", "highlightLines": [19]}, "category": "code", "location": {"file": "test/MintTest.t.sol", "line": 19, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "352869093076", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 shares = _mint(cuh, cuh, 10 ether);", "highlightLines": [42]}, "category": "code", "location": {"file": "test/MintTest.t.sol", "line": 42, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "eb0bc74aee00", "fix": {"template": null, "available": false}, "title": "address(this) directly in emit - likely wrong address (should use token/handler variable)", "ruleId": "rules.sol-emit-address-this", "snippet": {"code": "    emit Mint(address(this), 5 ether, 0.5 ether, 0.5 ether, cuh);", "highlightLines": [88]}, "category": "code", "location": {"file": "test/MintTest.t.sol", "line": 88, "column": 5}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "f6db6de56779", "fix": {"template": null, "available": false}, "title": "address(this) emitted in event - may emit wrong address (handler vs token confusion)", "ruleId": "rules.sol-address-this-in-event", "snippet": {"code": "    emit Mint(address(this), 5 ether, 0.5 ether, 0.5 ether, cuh);", "highlightLines": [88]}, "category": "code", "location": {"file": "test/MintTest.t.sol", "line": 88, "column": 5}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "77b4802d804c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 shares = _mint(cuh, cuh, 1 ether);", "highlightLines": [115]}, "category": "code", "location": {"file": "test/MintTest.t.sol", "line": 115, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "87677d33d89a", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 shares = _mint(cuh, cuh, 1 ether);\n\n    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);", "highlightLines": [115]}, "category": "code", "location": {"file": "test/MintTest.t.sol", "line": 115, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "6df4313d2c99", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);", "highlightLines": [116]}, "category": "code", "location": {"file": "test/MintTest.t.sol", "line": 116, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c5b2f1a83b9a", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);\n    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year", "highlightLines": [117]}, "category": "code", "location": {"file": "test/MintTest.t.sol", "line": 117, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "66f03f33a61a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year", "highlightLines": [118]}, "category": "code", "location": {"file": "test/MintTest.t.sol", "line": 118, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a30c5b5f333c", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    token1Scale = 9;\n\n    lendgine = Lendgine(factory.createLendgine(address(token0), address(token1), token0Scale, token1Scale, upperBound));", "highlightLines": [130]}, "category": "code", "location": {"file": "test/MintTest.t.sol", "line": 130, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "3b2f5e774ac2", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    lendgine = Lendgine(factory.createLendgine(address(token0), address(token1), token0Scale, token1Scale, upperBound));\n\n    token0.mint(address(this), 1e18);\n    token1.mint(address(this), 8 * 1e9);\n\n    lendgine.deposit(\n      address(this),\n      1 ether,\n      abi.encode(\n        PairMintCallbackData({\n          token0: address(token0),\n          token1: address(token1),\n          amount0: 1e18,\n          amount1: 8 * 1e9,\n          payer: address(this)\n        })\n      )\n    );\n\n    token1.mint(cuh, 5 * 1e9);\n\n    vm.prank(cuh);\n    token1.approve(address(this), 5 * 1e9);\n    uint256 shares = lendgine.mint(cuh, 5 * 1e9, abi.encode(MintCallbackData({token: address(token1), payer: cuh})));", "highlightLines": [132]}, "category": "code", "location": {"file": "test/MintTest.t.sol", "line": 132, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "223eef9bb73b", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    token0.mint(address(this), 1e18);", "highlightLines": [134]}, "category": "code", "location": {"file": "test/MintTest.t.sol", "line": 134, "column": 32}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "5d6aad25044f", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "          amount0: 1e18,", "highlightLines": [144]}, "category": "code", "location": {"file": "test/MintTest.t.sol", "line": 144, "column": 20}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "8d27febc083c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 shares = lendgine.mint(cuh, 5 * 1e9, abi.encode(MintCallbackData({token: address(token1), payer: cuh})));", "highlightLines": [155]}, "category": "code", "location": {"file": "test/MintTest.t.sol", "line": 155, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3287e9c1ac61", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "test/PrecisionTest.t.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "b6fce3bee75b", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimal assumption - tokens with >18 or <18 decimals will cause overflow/underflow", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    lendgine.invariant((upperBound * upperBound) / 1e18, 0, 1 ether);", "highlightLines": [28]}, "category": "code", "location": {"file": "test/PrecisionTest.t.sol", "line": 28, "column": 50}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20"], "description": ""}, {"id": "22f03e3ad394", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    lendgine.invariant((upperBound * upperBound) / 1e18, 0, 1 ether);", "highlightLines": [28]}, "category": "code", "location": {"file": "test/PrecisionTest.t.sol", "line": 28, "column": 52}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "5261c8388cec", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 value = (upperBound * upperBound) / 1e18;", "highlightLines": [29]}, "category": "code", "location": {"file": "test/PrecisionTest.t.sol", "line": 29, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "9089c75a0129", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 value = (upperBound * upperBound) / 1e18;\n    uint256 basePerDollar = 1e18;", "highlightLines": [30]}, "category": "code", "location": {"file": "test/PrecisionTest.t.sol", "line": 30, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "e50f8301dba1", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimal assumption - tokens with >18 or <18 decimals will cause overflow/underflow", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    uint256 value = (upperBound * upperBound) / 1e18;", "highlightLines": [30]}, "category": "code", "location": {"file": "test/PrecisionTest.t.sol", "line": 30, "column": 47}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20"], "description": ""}, {"id": "8b03a84d14a0", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    uint256 value = (upperBound * upperBound) / 1e18;", "highlightLines": [30]}, "category": "code", "location": {"file": "test/PrecisionTest.t.sol", "line": 30, "column": 49}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "3c0016da899e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 basePerDollar = 1e18;", "highlightLines": [31]}, "category": "code", "location": {"file": "test/PrecisionTest.t.sol", "line": 31, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "02ba966bf1c4", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 basePerDollar = 1e18;\n\n    uint256 minLP = value / basePerDollar;", "highlightLines": [31]}, "category": "code", "location": {"file": "test/PrecisionTest.t.sol", "line": 31, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "c7f079f58260", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    uint256 basePerDollar = 1e18;", "highlightLines": [31]}, "category": "code", "location": {"file": "test/PrecisionTest.t.sol", "line": 31, "column": 29}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "c6c141c3815b", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 minLP = value / basePerDollar;", "highlightLines": [32]}, "category": "code", "location": {"file": "test/PrecisionTest.t.sol", "line": 32, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c083baa6c909", "fix": {"template": null, "available": false}, "title": "SWC-110: assert() used for input validation - use require() instead, assert is for invariants", "ruleId": "rules.sol-swc-110-assert-user-input", "snippet": {"code": "    assert(minLP < 1 ether);", "highlightLines": [36]}, "category": "code", "location": {"file": "test/PrecisionTest.t.sol", "line": 36, "column": 5}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-110"], "description": ""}, {"id": "e36f9fbb3c1c", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    upperBound = 1e27;\n    lendgine = Lendgine(factory.createLendgine(address(token0), address(token1), token0Scale, token1Scale, upperBound));", "highlightLines": [40]}, "category": "code", "location": {"file": "test/PrecisionTest.t.sol", "line": 40, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "3a9654ca4143", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    lendgine = Lendgine(factory.createLendgine(address(token0), address(token1), token0Scale, token1Scale, upperBound));\n\n    lendgine.invariant((upperBound * upperBound) / 1e18, 0, 1 ether);\n\n    uint256 value = (upperBound * upperBound) / 1e18;", "highlightLines": [41]}, "category": "code", "location": {"file": "test/PrecisionTest.t.sol", "line": 41, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "1aab0a815350", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimal assumption - tokens with >18 or <18 decimals will cause overflow/underflow", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    lendgine.invariant((upperBound * upperBound) / 1e18, 0, 1 ether);", "highlightLines": [43]}, "category": "code", "location": {"file": "test/PrecisionTest.t.sol", "line": 43, "column": 50}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20"], "description": ""}, {"id": "92dfedbea7af", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    lendgine.invariant((upperBound * upperBound) / 1e18, 0, 1 ether);", "highlightLines": [43]}, "category": "code", "location": {"file": "test/PrecisionTest.t.sol", "line": 43, "column": 52}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "6be14074eac6", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 value = (upperBound * upperBound) / 1e18;", "highlightLines": [44]}, "category": "code", "location": {"file": "test/PrecisionTest.t.sol", "line": 44, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a4cfe59b6959", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 value = (upperBound * upperBound) / 1e18;\n    uint256 basePerDollar = 1e21;", "highlightLines": [45]}, "category": "code", "location": {"file": "test/PrecisionTest.t.sol", "line": 45, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "0237fb8984e6", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimal assumption - tokens with >18 or <18 decimals will cause overflow/underflow", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    uint256 value = (upperBound * upperBound) / 1e18;", "highlightLines": [45]}, "category": "code", "location": {"file": "test/PrecisionTest.t.sol", "line": 45, "column": 47}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20"], "description": ""}, {"id": "3952a58fc34b", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    uint256 value = (upperBound * upperBound) / 1e18;", "highlightLines": [45]}, "category": "code", "location": {"file": "test/PrecisionTest.t.sol", "line": 45, "column": 49}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "ac410a3e1f07", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 basePerDollar = 1e21;", "highlightLines": [46]}, "category": "code", "location": {"file": "test/PrecisionTest.t.sol", "line": 46, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a6a883c8d003", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 basePerDollar = 1e21;\n\n    uint256 minLP = value / basePerDollar;", "highlightLines": [46]}, "category": "code", "location": {"file": "test/PrecisionTest.t.sol", "line": 46, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "5595bdd70afe", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 minLP = value / basePerDollar;", "highlightLines": [47]}, "category": "code", "location": {"file": "test/PrecisionTest.t.sol", "line": 47, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "33e1bd939a9c", "fix": {"template": null, "available": false}, "title": "SWC-110: assert() used for input validation - use require() instead, assert is for invariants", "ruleId": "rules.sol-swc-110-assert-user-input", "snippet": {"code": "    assert(minLP < 1 ether);", "highlightLines": [51]}, "category": "code", "location": {"file": "test/PrecisionTest.t.sol", "line": 51, "column": 5}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-110"], "description": ""}, {"id": "35e5a73b4fa0", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    upperBound = 1e9;\n    lendgine = Lendgine(factory.createLendgine(address(token0), address(token1), token0Scale, token1Scale, upperBound));", "highlightLines": [55]}, "category": "code", "location": {"file": "test/PrecisionTest.t.sol", "line": 55, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "622072d63f4b", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    lendgine = Lendgine(factory.createLendgine(address(token0), address(token1), token0Scale, token1Scale, upperBound));\n\n    lendgine.invariant((upperBound * upperBound) / 1e18, 0, 1 ether);\n\n    uint256 value = (upperBound * upperBound) / 1e18;", "highlightLines": [56]}, "category": "code", "location": {"file": "test/PrecisionTest.t.sol", "line": 56, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "576d405919f9", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimal assumption - tokens with >18 or <18 decimals will cause overflow/underflow", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    lendgine.invariant((upperBound * upperBound) / 1e18, 0, 1 ether);", "highlightLines": [58]}, "category": "code", "location": {"file": "test/PrecisionTest.t.sol", "line": 58, "column": 50}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20"], "description": ""}, {"id": "d19c05739184", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    lendgine.invariant((upperBound * upperBound) / 1e18, 0, 1 ether);", "highlightLines": [58]}, "category": "code", "location": {"file": "test/PrecisionTest.t.sol", "line": 58, "column": 52}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "78d0372ee7e7", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 value = (upperBound * upperBound) / 1e18;", "highlightLines": [59]}, "category": "code", "location": {"file": "test/PrecisionTest.t.sol", "line": 59, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f8fdb33fb949", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 value = (upperBound * upperBound) / 1e18;\n    uint256 basePerDollar = 1e27;", "highlightLines": [60]}, "category": "code", "location": {"file": "test/PrecisionTest.t.sol", "line": 60, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "a508dd23b26c", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimal assumption - tokens with >18 or <18 decimals will cause overflow/underflow", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    uint256 value = (upperBound * upperBound) / 1e18;", "highlightLines": [60]}, "category": "code", "location": {"file": "test/PrecisionTest.t.sol", "line": 60, "column": 47}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20"], "description": ""}, {"id": "d2d3c7071ed6", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    uint256 value = (upperBound * upperBound) / 1e18;", "highlightLines": [60]}, "category": "code", "location": {"file": "test/PrecisionTest.t.sol", "line": 60, "column": 49}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "544787bcd559", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 basePerDollar = 1e27;", "highlightLines": [61]}, "category": "code", "location": {"file": "test/PrecisionTest.t.sol", "line": 61, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "64883d3405ab", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 basePerDollar = 1e27;\n\n    uint256 minLP = value / basePerDollar;", "highlightLines": [61]}, "category": "code", "location": {"file": "test/PrecisionTest.t.sol", "line": 61, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "f9b9b450a2a3", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 minLP = value / basePerDollar;", "highlightLines": [62]}, "category": "code", "location": {"file": "test/PrecisionTest.t.sol", "line": 62, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "fdb7fc5f5176", "fix": {"template": null, "available": false}, "title": "SWC-110: assert() used for input validation - use require() instead, assert is for invariants", "ruleId": "rules.sol-swc-110-assert-user-input", "snippet": {"code": "    assert(minLP < 1 ether);", "highlightLines": [66]}, "category": "code", "location": {"file": "test/PrecisionTest.t.sol", "line": 66, "column": 5}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-110"], "description": ""}, {"id": "ac123b548590", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "test/SwapTest.t.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "a22443d5a271", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "test/WithdrawTest.t.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "a45ee599950d", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event Withdraw(address indexed sender, uint256 size, uint256 liquidity, address indexed to);", "highlightLines": [10]}, "category": "code", "location": {"file": "test/WithdrawTest.t.sol", "line": 10, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "aa89f9d51bf0", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    (uint256 amount0, uint256 amount1, uint256 liquidity) = _withdraw(cuh, cuh, 0.5 ether);\n\n    assertEq(liquidity, 0.5 ether);\n    assertEq(0.5 ether, amount0);\n    assertEq(4 ether, amount1);\n\n    assertEq(0.5 ether, lendgine.totalLiquidity());\n    assertEq(0.5 ether, lendgine.totalPositionSize());\n\n    assertEq(0.5 ether, uint256(lendgine.reserve0()));\n    assertEq(4 ether, uint256(lendgine.reserve1()));\n    assertEq(0.5 ether, token0.balanceOf(address(lendgine)));\n    assertEq(4 ether, token1.balanceOf(address(lendgine)));\n\n    assertEq(0.5 ether, token0.balanceOf(address(cuh)));\n    assertEq(4 ether, token1.balanceOf(address(cuh)));\n\n    (uint256 positionSize,,) = lendgine.positions(cuh);", "highlightLines": [21]}, "category": "code", "location": {"file": "test/WithdrawTest.t.sol", "line": 21, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "3d1e627db691", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    (uint256 amount0, uint256 amount1, uint256 liquidity) = _withdraw(cuh, cuh, 1 ether);\n\n    assertEq(liquidity, 1 ether);\n    assertEq(1 ether, amount0);\n    assertEq(8 ether, amount1);\n\n    assertEq(0, lendgine.totalLiquidity());\n    assertEq(0, lendgine.totalPositionSize());\n\n    assertEq(0, uint256(lendgine.reserve0()));\n    assertEq(0, uint256(lendgine.reserve1()));\n    assertEq(0, token0.balanceOf(address(lendgine)));\n    assertEq(0, token1.balanceOf(address(lendgine)));\n\n    assertEq(1 ether, token0.balanceOf(address(cuh)));\n    assertEq(8 ether, token1.balanceOf(address(cuh)));\n\n    (uint256 positionSize,,) = lendgine.positions(cuh);", "highlightLines": [43]}, "category": "code", "location": {"file": "test/WithdrawTest.t.sol", "line": 43, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "ee77be06f208", "fix": {"template": null, "available": false}, "title": "SWC-110: assert() used for input validation - use require() instead, assert is for invariants", "ruleId": "rules.sol-swc-110-assert-user-input", "snippet": {"code": "    assert(rewardPerPositionPaid != 0);", "highlightLines": [113]}, "category": "code", "location": {"file": "test/WithdrawTest.t.sol", "line": 113, "column": 5}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-110"], "description": ""}, {"id": "d04e341debb4", "fix": {"template": null, "available": false}, "title": "SWC-110: assert() used for input validation - use require() instead, assert is for invariants", "ruleId": "rules.sol-swc-110-assert-user-input", "snippet": {"code": "    assert(tokensOwed != 0);", "highlightLines": [114]}, "category": "code", "location": {"file": "test/WithdrawTest.t.sol", "line": 114, "column": 5}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-110"], "description": ""}, {"id": "1765e798dee6", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 shares = _mint(address(this), address(this), 5 ether);", "highlightLines": [118]}, "category": "code", "location": {"file": "test/WithdrawTest.t.sol", "line": 118, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f754f17d30ae", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 shares = _mint(address(this), address(this), 5 ether);\n    vm.warp(365 days + 1);\n    lendgine.accrueInterest();\n\n    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);", "highlightLines": [118]}, "category": "code", "location": {"file": "test/WithdrawTest.t.sol", "line": 118, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "a152b481affc", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);", "highlightLines": [121]}, "category": "code", "location": {"file": "test/WithdrawTest.t.sol", "line": 121, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "9785f390f50f", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);\n    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year", "highlightLines": [122]}, "category": "code", "location": {"file": "test/WithdrawTest.t.sol", "line": 122, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "ba93eda1d41e", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "    uint256 borrowRate = lendgine.getBorrowRate(0.5 ether, 1 ether);\n    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year\n\n    uint256 reserve0 = lendgine.reserve0();", "highlightLines": [122]}, "category": "code", "location": {"file": "test/WithdrawTest.t.sol", "line": 122, "column": 5}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "e177782c2711", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year", "highlightLines": [123]}, "category": "code", "location": {"file": "test/WithdrawTest.t.sol", "line": 123, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c725eefc787e", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 lpDilution = borrowRate / 2; // 0.5 lp for one year\n\n    uint256 reserve0 = lendgine.reserve0();", "highlightLines": [123]}, "category": "code", "location": {"file": "test/WithdrawTest.t.sol", "line": 123, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "0ad94dd1772d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 reserve0 = lendgine.reserve0();", "highlightLines": [124]}, "category": "code", "location": {"file": "test/WithdrawTest.t.sol", "line": 124, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b4e3c8df3eaf", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "    uint256 reserve0 = lendgine.reserve0();\n    uint256 reserve1 = lendgine.reserve1();", "highlightLines": [125]}, "category": "code", "location": {"file": "test/WithdrawTest.t.sol", "line": 125, "column": 5}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "cbbdb3ea001b", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 reserve0 = lendgine.reserve0();\n    uint256 reserve1 = lendgine.reserve1();", "highlightLines": [125]}, "category": "code", "location": {"file": "test/WithdrawTest.t.sol", "line": 125, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "f0f37c7b7ffb", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 reserve1 = lendgine.reserve1();", "highlightLines": [126]}, "category": "code", "location": {"file": "test/WithdrawTest.t.sol", "line": 126, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a3d1e85623f1", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 reserve1 = lendgine.reserve1();\n\n    uint256 _amount0 =\n      FullMath.mulDivRoundingUp(reserve0, lendgine.convertShareToLiquidity(0.5 ether), lendgine.totalLiquidity());", "highlightLines": [126]}, "category": "code", "location": {"file": "test/WithdrawTest.t.sol", "line": 126, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "6ba24772b272", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 _amount0 =", "highlightLines": [127]}, "category": "code", "location": {"file": "test/WithdrawTest.t.sol", "line": 127, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4909dd7e0285", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "    uint256 _amount0 =\n      FullMath.mulDivRoundingUp(reserve0, lendgine.convertShareToLiquidity(0.5 ether), lendgine.totalLiquidity());\n    uint256 _amount1 =\n      FullMath.mulDivRoundingUp(reserve1, lendgine.convertShareToLiquidity(0.5 ether), lendgine.totalLiquidity());", "highlightLines": [128]}, "category": "code", "location": {"file": "test/WithdrawTest.t.sol", "line": 128, "column": 5}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "2904dc2945ef", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 _amount0 =\n      FullMath.mulDivRoundingUp(reserve0, lendgine.convertShareToLiquidity(0.5 ether), lendgine.totalLiquidity());\n    uint256 _amount1 =\n      FullMath.mulDivRoundingUp(reserve1, lendgine.convertShareToLiquidity(0.5 ether), lendgine.totalLiquidity());", "highlightLines": [128]}, "category": "code", "location": {"file": "test/WithdrawTest.t.sol", "line": 128, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "ad72ca6fb8ba", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 _amount1 =", "highlightLines": [130]}, "category": "code", "location": {"file": "test/WithdrawTest.t.sol", "line": 130, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8ff505548ac0", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 _amount1 =\n      FullMath.mulDivRoundingUp(reserve1, lendgine.convertShareToLiquidity(0.5 ether), lendgine.totalLiquidity());\n\n    _burn(address(this), address(this), 0.5 ether, _amount0, _amount1);\n\n    (,, uint256 liquidity) = _withdraw(cuh, cuh, 1 ether);", "highlightLines": [130]}, "category": "code", "location": {"file": "test/WithdrawTest.t.sol", "line": 130, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "26a7cec07e8e", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    token1Scale = 9;\n\n    lendgine = Lendgine(factory.createLendgine(address(token0), address(token1), token0Scale, token1Scale, upperBound));", "highlightLines": [149]}, "category": "code", "location": {"file": "test/WithdrawTest.t.sol", "line": 149, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "622cf534d31e", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    lendgine = Lendgine(factory.createLendgine(address(token0), address(token1), token0Scale, token1Scale, upperBound));\n\n    token0.mint(address(this), 1e18);\n    token1.mint(address(this), 8 * 1e9);\n\n    lendgine.deposit(\n      address(this),\n      1 ether,\n      abi.encode(\n        PairMintCallbackData({\n          token0: address(token0),\n          token1: address(token1),\n          amount0: 1e18,\n          amount1: 8 * 1e9,\n          payer: address(this)\n        })\n      )\n    );\n\n    (uint256 amount0, uint256 amount1, uint256 liquidity) = lendgine.withdraw(address(this), 0.5 ether);", "highlightLines": [151]}, "category": "code", "location": {"file": "test/WithdrawTest.t.sol", "line": 151, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "31ec1f2f7b5c", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    token0.mint(address(this), 1e18);", "highlightLines": [153]}, "category": "code", "location": {"file": "test/WithdrawTest.t.sol", "line": 153, "column": 32}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "c5275ceed98f", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "          amount0: 1e18,", "highlightLines": [163]}, "category": "code", "location": {"file": "test/WithdrawTest.t.sol", "line": 163, "column": 20}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "541bf7a7f24a", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "    (uint256 amount0, uint256 amount1, uint256 liquidity) = lendgine.withdraw(address(this), 0.5 ether);\n\n    assertEq(liquidity, 0.5 ether);\n    assertEq(0.5 ether, amount0);\n    assertEq(4 * 1e9, amount1);\n\n    assertEq(0.5 ether, lendgine.totalLiquidity());\n    assertEq(0.5 ether, lendgine.totalPositionSize());\n\n    assertEq(0.5 ether, uint256(lendgine.reserve0()));\n    assertEq(4 * 1e9, uint256(lendgine.reserve1()));\n    assertEq(0.5 ether, token0.balanceOf(address(lendgine)));\n    assertEq(4 * 1e9, token1.balanceOf(address(lendgine)));\n\n    assertEq(0.5 ether, token0.balanceOf(address(this)));\n    assertEq(4 * 1e9, token1.balanceOf(address(this)));\n\n    (uint256 positionSize,,) = lendgine.positions(address(this));", "highlightLines": [170]}, "category": "code", "location": {"file": "test/WithdrawTest.t.sol", "line": 170, "column": 5}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "7aeb5be108a8", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    (uint256 amount0, uint256 amount1, uint256 liquidity) = lendgine.withdraw(address(this), 0.5 ether);\n\n    assertEq(liquidity, 0.5 ether);\n    assertEq(0.5 ether, amount0);\n    assertEq(4 * 1e9, amount1);\n\n    assertEq(0.5 ether, lendgine.totalLiquidity());\n    assertEq(0.5 ether, lendgine.totalPositionSize());\n\n    assertEq(0.5 ether, uint256(lendgine.reserve0()));\n    assertEq(4 * 1e9, uint256(lendgine.reserve1()));\n    assertEq(0.5 ether, token0.balanceOf(address(lendgine)));\n    assertEq(4 * 1e9, token1.balanceOf(address(lendgine)));\n\n    assertEq(0.5 ether, token0.balanceOf(address(this)));\n    assertEq(4 * 1e9, token1.balanceOf(address(this)));\n\n    (uint256 positionSize,,) = lendgine.positions(address(this));", "highlightLines": [170]}, "category": "code", "location": {"file": "test/WithdrawTest.t.sol", "line": 170, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "d2ef212df13b", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "test/utils/CallbackHelper.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "2ce156ee6dfb", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "contract CallbackHelper is IPairMintCallback, IMintCallback, ISwapCallback {", "highlightLines": [10]}, "category": "code", "location": {"file": "test/utils/CallbackHelper.sol", "line": 10, "column": 1}, "severity": "medium", "references": [], "description": ""}, {"id": "9731cb2ce349", "fix": {"template": null, "available": false}, "title": "Base constructor called multiple times through diamond inheritance - may initialize twice", "ruleId": "rules.sol-reused-constructor", "snippet": {"code": "contract CallbackHelper is IPairMintCallback, IMintCallback, ISwapCallback {", "highlightLines": [10]}, "category": "code", "location": {"file": "test/utils/CallbackHelper.sol", "line": 10, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#reused-base-constructor"], "description": ""}, {"id": "9f945fa47dc6", "fix": {"template": null, "available": false}, "title": "SWC-125: Multiple inheritance may cause incorrect function resolution - check C3 linearization", "ruleId": "rules.sol-swc-125-inheritance-order", "snippet": {"code": "contract CallbackHelper is IPairMintCallback, IMintCallback, ISwapCallback {", "highlightLines": [10]}, "category": "code", "location": {"file": "test/utils/CallbackHelper.sol", "line": 10, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-125"], "description": ""}, {"id": "01fde1ff102a", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract CallbackHelper is IPairMintCallback, IMintCallback, ISwapCallback {\n  struct PairMintCallbackData {\n    address token0;\n    address token1;\n    uint256 amount0;\n    uint256 amount1;\n    address payer;", "highlightLines": [10]}, "category": "code", "location": {"file": "test/utils/CallbackHelper.sol", "line": 10, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "89f384fe971f", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address token0;", "highlightLines": [12]}, "category": "code", "location": {"file": "test/utils/CallbackHelper.sol", "line": 12, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d5b814aa6a3f", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address token1;", "highlightLines": [13]}, "category": "code", "location": {"file": "test/utils/CallbackHelper.sol", "line": 13, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "225c3a881121", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 amount0;", "highlightLines": [14]}, "category": "code", "location": {"file": "test/utils/CallbackHelper.sol", "line": 14, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0e02586c3208", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 amount1;", "highlightLines": [15]}, "category": "code", "location": {"file": "test/utils/CallbackHelper.sol", "line": 15, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "eb27b6516e42", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address payer;", "highlightLines": [16]}, "category": "code", "location": {"file": "test/utils/CallbackHelper.sol", "line": 16, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "9c65e4ba4822", "fix": {"template": null, "available": false}, "title": "Callback handler doesn't update status - repeated callbacks possible", "ruleId": "rules.sol-callback-no-status-update", "snippet": {"code": "  function pairMintCallback(uint256, bytes calldata data) external override {", "highlightLines": [19]}, "category": "code", "location": {"file": "test/utils/CallbackHelper.sol", "line": 19, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "d63e3a91ad34", "fix": {"template": null, "available": false}, "title": "abi.decode on untrusted calldata - potential ABI smuggling attack", "ruleId": "rules.sol-abi-decode-untrusted", "snippet": {"code": "    PairMintCallbackData memory decoded = abi.decode(data, (PairMintCallbackData));", "highlightLines": [20]}, "category": "code", "location": {"file": "test/utils/CallbackHelper.sol", "line": 20, "column": 43}, "severity": "medium", "references": [], "description": ""}, {"id": "79a7436b0eec", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address token;", "highlightLines": [36]}, "category": "code", "location": {"file": "test/utils/CallbackHelper.sol", "line": 36, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "61234664ab5f", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address payer;", "highlightLines": [37]}, "category": "code", "location": {"file": "test/utils/CallbackHelper.sol", "line": 37, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f67eaba466ad", "fix": {"template": null, "available": false}, "title": "Callback handler doesn't update status - repeated callbacks possible", "ruleId": "rules.sol-callback-no-status-update", "snippet": {"code": "  function mintCallback(uint256 collateral, uint256, uint256, uint256, bytes calldata data) external override {", "highlightLines": [40]}, "category": "code", "location": {"file": "test/utils/CallbackHelper.sol", "line": 40, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "bc71fca5a359", "fix": {"template": null, "available": false}, "title": "abi.decode on untrusted calldata - potential ABI smuggling attack", "ruleId": "rules.sol-abi-decode-untrusted", "snippet": {"code": "    MintCallbackData memory decoded = abi.decode(data, (MintCallbackData));", "highlightLines": [41]}, "category": "code", "location": {"file": "test/utils/CallbackHelper.sol", "line": 41, "column": 39}, "severity": "medium", "references": [], "description": ""}, {"id": "8802b67a984c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address token0;", "highlightLines": [51]}, "category": "code", "location": {"file": "test/utils/CallbackHelper.sol", "line": 51, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "be660606aa3e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address token1;", "highlightLines": [52]}, "category": "code", "location": {"file": "test/utils/CallbackHelper.sol", "line": 52, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4a5a588f3542", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 amount0;", "highlightLines": [53]}, "category": "code", "location": {"file": "test/utils/CallbackHelper.sol", "line": 53, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "1500ebfbcc00", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 amount1;", "highlightLines": [54]}, "category": "code", "location": {"file": "test/utils/CallbackHelper.sol", "line": 54, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "35ff98f00724", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address payer;", "highlightLines": [55]}, "category": "code", "location": {"file": "test/utils/CallbackHelper.sol", "line": 55, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "fa8277a55647", "fix": {"template": null, "available": false}, "title": "Callback handler doesn't update status - repeated callbacks possible", "ruleId": "rules.sol-callback-no-status-update", "snippet": {"code": "  function swapCallback(uint256, uint256, bytes calldata data) external override {", "highlightLines": [58]}, "category": "code", "location": {"file": "test/utils/CallbackHelper.sol", "line": 58, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "2fb3ee44cf6e", "fix": {"template": null, "available": false}, "title": "Swap/liquidity operation without deadline parameter - transaction can be delayed indefinitely", "ruleId": "rules.sol-missing-deadline-check", "snippet": {"code": "  function swapCallback(uint256, uint256, bytes calldata data) external override {", "highlightLines": [58]}, "category": "code", "location": {"file": "test/utils/CallbackHelper.sol", "line": 58, "column": 3}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "1e17aa0bc923", "fix": {"template": null, "available": false}, "title": "Token swap/buy without slippage protection - MEV/sandwich attack risk", "ruleId": "rules.sol-missing-slippage-protection", "snippet": {"code": "  function swapCallback(uint256, uint256, bytes calldata data) external override {", "highlightLines": [58]}, "category": "code", "location": {"file": "test/utils/CallbackHelper.sol", "line": 58, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "49ce55d529a8", "fix": {"template": null, "available": false}, "title": "abi.decode on untrusted calldata - potential ABI smuggling attack", "ruleId": "rules.sol-abi-decode-untrusted", "snippet": {"code": "    SwapCallbackData memory decoded = abi.decode(data, (SwapCallbackData));", "highlightLines": [59]}, "category": "code", "location": {"file": "test/utils/CallbackHelper.sol", "line": 59, "column": 39}, "severity": "medium", "references": [], "description": ""}, {"id": "89c09bd55388", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "test/utils/TestHelper.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "41a543aedd57", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "abstract contract TestHelper is Test, CallbackHelper {\n  MockERC20 public token0;\n  MockERC20 public token1;\n\n  uint8 public token0Scale;\n  uint8 public token1Scale;\n\n  uint256 public upperBound;\n\n  Factory public factory;\n  Lendgine public lendgine;\n\n  address public cuh;\n  address public dennis;\n\n  function mkaddr(string memory name) public returns (address) {\n    address addr = address(uint160(uint256(keccak256(abi.encodePacked(name)))));", "highlightLines": [11]}, "category": "code", "location": {"file": "test/utils/TestHelper.sol", "line": 11, "column": 10}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "2945e2035a5b", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address addr = address(uint160(uint256(keccak256(abi.encodePacked(name)))));", "highlightLines": [27]}, "category": "code", "location": {"file": "test/utils/TestHelper.sol", "line": 27, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "03da9e57e652", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "    address addr = address(uint160(uint256(keccak256(abi.encodePacked(name)))));", "highlightLines": [27]}, "category": "code", "location": {"file": "test/utils/TestHelper.sol", "line": 27, "column": 44}, "severity": "high", "references": [], "description": ""}, {"id": "6910fb6824a0", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  constructor() {\n    cuh = mkaddr(\"cuh\");\n    dennis = mkaddr(\"dennis\");\n\n    token0Scale = 18;\n    token1Scale = 18;\n\n    upperBound = 5 * 1e18;\n  }", "highlightLines": [32]}, "category": "code", "location": {"file": "test/utils/TestHelper.sol", "line": 32, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "79ae96d4b824", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    cuh = mkaddr(\"cuh\");\n    dennis = mkaddr(\"dennis\");", "highlightLines": [33]}, "category": "code", "location": {"file": "test/utils/TestHelper.sol", "line": 33, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "0f3968f8e445", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    dennis = mkaddr(\"dennis\");\n\n    token0Scale = 18;", "highlightLines": [34]}, "category": "code", "location": {"file": "test/utils/TestHelper.sol", "line": 34, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "cd5c2f22382c", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    token0Scale = 18;\n    token1Scale = 18;", "highlightLines": [36]}, "category": "code", "location": {"file": "test/utils/TestHelper.sol", "line": 36, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "72df30aeb1a9", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    token1Scale = 18;\n\n    upperBound = 5 * 1e18;", "highlightLines": [37]}, "category": "code", "location": {"file": "test/utils/TestHelper.sol", "line": 37, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "b93852dc5018", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimal assumption - tokens with >18 or <18 decimals will cause overflow/underflow", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    upperBound = 5 * 1e18;", "highlightLines": [39]}, "category": "code", "location": {"file": "test/utils/TestHelper.sol", "line": 39, "column": 20}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20"], "description": ""}, {"id": "62e44182a952", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    upperBound = 5 * 1e18;", "highlightLines": [39]}, "category": "code", "location": {"file": "test/utils/TestHelper.sol", "line": 39, "column": 22}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "ef2a78a96839", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    token0 = new MockERC20();\n    token1 = new MockERC20();", "highlightLines": [43]}, "category": "code", "location": {"file": "test/utils/TestHelper.sol", "line": 43, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "1ec3716b673a", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    token0 = new MockERC20();", "highlightLines": [43]}, "category": "code", "location": {"file": "test/utils/TestHelper.sol", "line": 43, "column": 14}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "633bbfd75918", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    token1 = new MockERC20();\n\n    factory = new Factory();", "highlightLines": [44]}, "category": "code", "location": {"file": "test/utils/TestHelper.sol", "line": 44, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "9de0ef85b8c8", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    token1 = new MockERC20();", "highlightLines": [44]}, "category": "code", "location": {"file": "test/utils/TestHelper.sol", "line": 44, "column": 14}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "bda18d9e37aa", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    factory = new Factory();\n    lendgine = Lendgine(factory.createLendgine(address(token0), address(token1), token0Scale, token1Scale, upperBound));", "highlightLines": [46]}, "category": "code", "location": {"file": "test/utils/TestHelper.sol", "line": 46, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "78c82a88879c", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    factory = new Factory();", "highlightLines": [46]}, "category": "code", "location": {"file": "test/utils/TestHelper.sol", "line": 46, "column": 15}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "c7d3dc8d3b14", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "      lendgine.transfer(address(lendgine), shares);", "highlightLines": [73]}, "category": "code", "location": {"file": "test/utils/TestHelper.sol", "line": 73, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "87df4da950d3", "fix": {"template": null, "available": false}, "title": "ERC20 transfer() return value not checked - tokens like USDT don't return bool", "ruleId": "rules.sol-erc20-transfer-no-return-check", "snippet": {"code": "      lendgine.transfer(address(lendgine), shares);", "highlightLines": [73]}, "category": "code", "location": {"file": "test/utils/TestHelper.sol", "line": 73, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "3a221c23f729", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "      lendgine.transfer(address(lendgine), shares);", "highlightLines": [78]}, "category": "code", "location": {"file": "test/utils/TestHelper.sol", "line": 78, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "57ee1645a96f", "fix": {"template": null, "available": false}, "title": "ERC20 transfer() return value not checked - tokens like USDT don't return bool", "ruleId": "rules.sol-erc20-transfer-no-return-check", "snippet": {"code": "      lendgine.transfer(address(lendgine), shares);", "highlightLines": [78]}, "category": "code", "location": {"file": "test/utils/TestHelper.sol", "line": 78, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "64d963323eee", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.4;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "4a87da63b316", "fix": {"template": null, "available": false}, "title": "Base constructor called multiple times through diamond inheritance - may initialize twice", "ruleId": "rules.sol-reused-constructor", "snippet": {"code": "contract LendgineRouter is Multicall, Payment, SelfPermit, SwapHelper, IMintCallback, IPairMintCallback {", "highlightLines": [20]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 20, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#reused-base-constructor"], "description": ""}, {"id": "8a23c3397ce2", "fix": {"template": null, "available": false}, "title": "SWC-125: Multiple inheritance may cause incorrect function resolution - check C3 linearization", "ruleId": "rules.sol-swc-125-inheritance-order", "snippet": {"code": "contract LendgineRouter is Multicall, Payment, SelfPermit, SwapHelper, IMintCallback, IPairMintCallback {", "highlightLines": [20]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 20, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-125"], "description": ""}, {"id": "461d269925e4", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "contract LendgineRouter is Multicall, Payment, SelfPermit, SwapHelper, IMintCallback, IPairMintCallback {", "highlightLines": [20]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 20, "column": 1}, "severity": "medium", "references": [], "description": ""}, {"id": "55593a49b947", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event Mint(address indexed from, address indexed lendgine, uint256 collateral, uint256 shares, address indexed to);", "highlightLines": [25]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 25, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "0ae93d9c4846", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event Burn(address indexed from, address indexed lendgine, uint256 collateral, uint256 shares, address indexed to);", "highlightLines": [27]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 27, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "ff0a2b8c6cd4", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  constructor(\n    address _factory,\n    address _uniswapV2Factory,\n    address _uniswapV3Factory,\n    address _weth\n  )\n    SwapHelper(_uniswapV2Factory, _uniswapV3Factory)\n    Payment(_weth)\n  {\n    factory = _factory;\n  }", "highlightLines": [49]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 49, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "6046df8e98f9", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  modifier checkDeadline(uint256 deadline) {\n    if (deadline < block.timestamp) revert LivelinessError();\n    _;\n  }", "highlightLines": [65]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 65, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "0941d70b2326", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "  modifier checkDeadline(uint256 deadline) {\n    if (deadline < block.timestamp) revert LivelinessError();\n    _;\n  }", "highlightLines": [65]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 65, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "6ba567efd861", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "    if (deadline < block.timestamp) revert LivelinessError();", "highlightLines": [66]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 66, "column": 20}, "severity": "medium", "references": [], "description": ""}, {"id": "d79546874878", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    _;", "highlightLines": [67]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 67, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "2ac3eddecf6c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address token0;", "highlightLines": [75]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 75, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "92a3bc33e8ce", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address token1;", "highlightLines": [76]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 76, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "fc9aaa0e5e86", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 token0Exp;", "highlightLines": [77]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 77, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b5fac0029707", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 token1Exp;", "highlightLines": [78]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 78, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d2bf73865bc1", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 upperBound;", "highlightLines": [79]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 79, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "cb20699aa08f", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 collateralMax;", "highlightLines": [80]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 80, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4084dcc52647", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    bytes swapExtraData;", "highlightLines": [82]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 82, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "6e390352f882", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address payer;", "highlightLines": [83]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 83, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4a0c6cdec706", "fix": {"template": null, "available": false}, "title": "Callback handler doesn't update status - repeated callbacks possible", "ruleId": "rules.sol-callback-no-status-update", "snippet": {"code": "  function mintCallback(\n    uint256 collateralTotal,\n    uint256 amount0,\n    uint256 amount1,\n    uint256,\n    bytes calldata data\n  )\n    external\n    override\n  {", "highlightLines": [87]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 87, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "4ffc99e1f1f7", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    MintCallbackData memory decoded = abi.decode(data, (MintCallbackData));\n\n    address lendgine = LendgineAddress.computeAddress(\n      factory, decoded.token0, decoded.token1, decoded.token0Exp, decoded.token1Exp, decoded.upperBound\n    );", "highlightLines": [97]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 97, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "2bf48dd16f33", "fix": {"template": null, "available": false}, "title": "abi.decode on untrusted calldata - potential ABI smuggling attack", "ruleId": "rules.sol-abi-decode-untrusted", "snippet": {"code": "    MintCallbackData memory decoded = abi.decode(data, (MintCallbackData));", "highlightLines": [97]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 97, "column": 39}, "severity": "medium", "references": [], "description": ""}, {"id": "d87f737d6cb0", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    address lendgine = LendgineAddress.computeAddress(", "highlightLines": [98]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 98, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0ed6fedea8da", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    address lendgine = LendgineAddress.computeAddress(\n      factory, decoded.token0, decoded.token1, decoded.token0Exp, decoded.token1Exp, decoded.upperBound\n    );\n    if (lendgine != msg.sender) revert ValidationError();\n\n    // swap all token0 to token1\n    uint256 collateralSwap = swap(\n      decoded.swapType,\n      SwapParams({\n        tokenIn: decoded.token0,\n        tokenOut: decoded.token1,\n        amount: SafeCast.toInt256(amount0),\n        recipient: msg.sender\n      }),\n      decoded.swapExtraData\n    );", "highlightLines": [99]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 99, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "45c9326e4326", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 collateralSwap = swap(", "highlightLines": [105]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 105, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "147990f68817", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 collateralSwap = swap(\n      decoded.swapType,\n      SwapParams({\n        tokenIn: decoded.token0,\n        tokenOut: decoded.token1,\n        amount: SafeCast.toInt256(amount0),\n        recipient: msg.sender\n      }),\n      decoded.swapExtraData\n    );\n\n    // send token1 back\n    SafeTransferLib.safeTransfer(decoded.token1, msg.sender, amount1);\n\n    // pull the rest of tokens from the user\n    uint256 collateralIn = collateralTotal - amount1 - collateralSwap;", "highlightLines": [105]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 105, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "9df44eab94ea", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 collateralIn = collateralTotal - amount1 - collateralSwap;", "highlightLines": [120]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 120, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "5fd5bfa48822", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address token0;", "highlightLines": [127]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 127, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "51f59dbf8cf0", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address token1;", "highlightLines": [128]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 128, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "209344ab8d0e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 token0Exp;", "highlightLines": [129]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 129, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8c4ab4a6c54a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 token1Exp;", "highlightLines": [130]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 130, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0335df2f9083", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 upperBound;", "highlightLines": [131]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 131, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "729b91731541", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 amountIn;", "highlightLines": [132]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 132, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "2bd3fc7866f8", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 amountBorrow;", "highlightLines": [133]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 133, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0db43b4313d6", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 sharesMin;", "highlightLines": [134]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 134, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "990bd0e04b24", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    bytes swapExtraData;", "highlightLines": [136]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 136, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "011cb1491514", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address recipient;", "highlightLines": [137]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 137, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "9af0ac135723", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 deadline;", "highlightLines": [138]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 138, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "46f9ec070955", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "  function mint(MintParams calldata params) external payable checkDeadline(params.deadline) returns (uint256 shares) {", "highlightLines": [142]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 142, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "906c09b68ac2", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "  function mint(MintParams calldata params) external payable checkDeadline(params.deadline) returns (uint256 shares) {", "highlightLines": [142]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 142, "column": 3}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "3bdaa36e2efb", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address lendgine = LendgineAddress.computeAddress(", "highlightLines": [143]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 143, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7e7cbebe3580", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    address lendgine = LendgineAddress.computeAddress(\n      factory, params.token0, params.token1, params.token0Exp, params.token1Exp, params.upperBound\n    );\n\n    shares = ILendgine(lendgine).mint(\n      address(this),\n      params.amountIn + params.amountBorrow,\n      abi.encode(\n        MintCallbackData({\n          token0: params.token0,\n          token1: params.token1,\n          token0Exp: params.token0Exp,\n          token1Exp: params.token1Exp,\n          upperBound: params.upperBound,\n          collateralMax: params.amountIn,\n          swapType: params.swapType,\n          swapExtraData: params.swapExtraData,\n          payer: msg.sender\n        })\n      )\n    );", "highlightLines": [143]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 143, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "df30edf885aa", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address token0;", "highlightLines": [176]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 176, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "91bfbc6df07c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address token1;", "highlightLines": [177]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 177, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c2f03375843f", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 token0Exp;", "highlightLines": [178]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 178, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3dc62dad708a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 token1Exp;", "highlightLines": [179]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 179, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d997e2e3bf3c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 upperBound;", "highlightLines": [180]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 180, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b20f4df5f9d8", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 collateralMin;", "highlightLines": [181]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 181, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "baa084b46708", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 amount0Min;", "highlightLines": [182]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 182, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7d670e7179a5", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 amount1Min;", "highlightLines": [183]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 183, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "9e85e21bb10e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    bytes swapExtraData;", "highlightLines": [185]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 185, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "2f2d9bb6f7c8", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address recipient;", "highlightLines": [186]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 186, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7dc50a7e9731", "fix": {"template": null, "available": false}, "title": "Callback handler doesn't update status - repeated callbacks possible", "ruleId": "rules.sol-callback-no-status-update", "snippet": {"code": "  function pairMintCallback(uint256 liquidity, bytes calldata data) external override {", "highlightLines": [190]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 190, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "979f78ab327a", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    PairMintCallbackData memory decoded = abi.decode(data, (PairMintCallbackData));\n\n    address lendgine = LendgineAddress.computeAddress(\n      factory, decoded.token0, decoded.token1, decoded.token0Exp, decoded.token1Exp, decoded.upperBound\n    );", "highlightLines": [191]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 191, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "42840d36fb28", "fix": {"template": null, "available": false}, "title": "abi.decode on untrusted calldata - potential ABI smuggling attack", "ruleId": "rules.sol-abi-decode-untrusted", "snippet": {"code": "    PairMintCallbackData memory decoded = abi.decode(data, (PairMintCallbackData));", "highlightLines": [191]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 191, "column": 43}, "severity": "medium", "references": [], "description": ""}, {"id": "f983124323a6", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    address lendgine = LendgineAddress.computeAddress(", "highlightLines": [192]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 192, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "93c9047c7c22", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    address lendgine = LendgineAddress.computeAddress(\n      factory, decoded.token0, decoded.token1, decoded.token0Exp, decoded.token1Exp, decoded.upperBound\n    );\n    if (lendgine != msg.sender) revert ValidationError();\n\n    uint256 r0 = ILendgine(msg.sender).reserve0();", "highlightLines": [193]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 193, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "28a21fb27e9d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 r0 = ILendgine(msg.sender).reserve0();", "highlightLines": [197]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 197, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8e8ff279cd63", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "    uint256 r0 = ILendgine(msg.sender).reserve0();\n    uint256 r1 = ILendgine(msg.sender).reserve1();", "highlightLines": [198]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 198, "column": 5}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "58be01960a7b", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 r0 = ILendgine(msg.sender).reserve0();\n    uint256 r1 = ILendgine(msg.sender).reserve1();", "highlightLines": [198]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 198, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "0106486b05c1", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 r1 = ILendgine(msg.sender).reserve1();", "highlightLines": [199]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 199, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7dd5650f7ad2", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "    uint256 r1 = ILendgine(msg.sender).reserve1();\n    uint256 totalLiquidity = ILendgine(msg.sender).totalLiquidity();", "highlightLines": [199]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 199, "column": 5}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "0393c80839bc", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 r1 = ILendgine(msg.sender).reserve1();\n    uint256 totalLiquidity = ILendgine(msg.sender).totalLiquidity();", "highlightLines": [199]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 199, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "84b0aaee173d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 totalLiquidity = ILendgine(msg.sender).totalLiquidity();", "highlightLines": [200]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 200, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "6e6f4541f96d", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "    uint256 totalLiquidity = ILendgine(msg.sender).totalLiquidity();", "highlightLines": [200]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 200, "column": 5}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "f04868f81b81", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 totalLiquidity = ILendgine(msg.sender).totalLiquidity();\n\n    uint256 amount0;\n    uint256 amount1;\n\n    if (totalLiquidity == 0) {\n      amount0 = decoded.amount0Min;\n      amount1 = decoded.amount1Min;\n    } else {\n      amount0 = FullMath.mulDivRoundingUp(liquidity, r0, totalLiquidity);\n      amount1 = FullMath.mulDivRoundingUp(liquidity, r1, totalLiquidity);\n    }", "highlightLines": [200]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 200, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "6f6dca1c39d3", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "    uint256 totalLiquidity = ILendgine(msg.sender).totalLiquidity();\n\n    uint256 amount0;\n    uint256 amount1;\n\n    if (totalLiquidity == 0) {\n      amount0 = decoded.amount0Min;\n      amount1 = decoded.amount1Min;\n    } else {\n      amount0 = FullMath.mulDivRoundingUp(liquidity, r0, totalLiquidity);\n      amount1 = FullMath.mulDivRoundingUp(liquidity, r1, totalLiquidity);\n    }\n\n    if (amount0 < decoded.amount0Min || amount1 < decoded.amount1Min) revert AmountError();\n\n    // swap for required token0\n    uint256 collateralSwapped = swap(\n      decoded.swapType,\n      SwapParams({\n        tokenIn: decoded.token1,\n        tokenOut: decoded.token0,\n        amount: -SafeCast.toInt256(amount0),\n        recipient: msg.sender\n      }),\n      decoded.swapExtraData\n    );\n\n    // pay token1\n    SafeTransferLib.safeTransfer(decoded.token1, msg.sender, amount1);\n\n    // determine remaining and send to recipient\n    uint256 collateralTotal = ILendgine(msg.sender).convertLiquidityToCollateral(liquidity);", "highlightLines": [200]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 200, "column": 5}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "4b5999c897a7", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 amount0;", "highlightLines": [201]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 201, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "2860fd0a01ab", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 amount1;", "highlightLines": [203]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 203, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "6017e7b5f3b9", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "      amount0 = decoded.amount0Min;\n      amount1 = decoded.amount1Min;", "highlightLines": [206]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 206, "column": 7}, "severity": "info", "references": [], "description": ""}, {"id": "c4d18f897b2a", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "      amount0 = FullMath.mulDivRoundingUp(liquidity, r0, totalLiquidity);\n      amount1 = FullMath.mulDivRoundingUp(liquidity, r1, totalLiquidity);", "highlightLines": [209]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 209, "column": 7}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "6b1d181e0b2c", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "      amount0 = FullMath.mulDivRoundingUp(liquidity, r0, totalLiquidity);\n      amount1 = FullMath.mulDivRoundingUp(liquidity, r1, totalLiquidity);", "highlightLines": [209]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 209, "column": 7}, "severity": "info", "references": [], "description": ""}, {"id": "0888967fc264", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 collateralSwapped = swap(", "highlightLines": [216]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 216, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "bb5f37c7ec8e", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 collateralSwapped = swap(\n      decoded.swapType,\n      SwapParams({\n        tokenIn: decoded.token1,\n        tokenOut: decoded.token0,\n        amount: -SafeCast.toInt256(amount0),\n        recipient: msg.sender\n      }),\n      decoded.swapExtraData\n    );\n\n    // pay token1\n    SafeTransferLib.safeTransfer(decoded.token1, msg.sender, amount1);\n\n    // determine remaining and send to recipient\n    uint256 collateralTotal = ILendgine(msg.sender).convertLiquidityToCollateral(liquidity);", "highlightLines": [216]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 216, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "00df0a54fc19", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 collateralTotal = ILendgine(msg.sender).convertLiquidityToCollateral(liquidity);", "highlightLines": [231]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 231, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ad2af024feef", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 collateralTotal = ILendgine(msg.sender).convertLiquidityToCollateral(liquidity);\n    uint256 collateralOut = collateralTotal - amount1 - collateralSwapped;", "highlightLines": [231]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 231, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "7566e956d1a1", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 collateralOut = collateralTotal - amount1 - collateralSwapped;", "highlightLines": [232]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 232, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a43e70d52bfd", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address token0;", "highlightLines": [241]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 241, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "86d7cfbb7db0", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address token1;", "highlightLines": [242]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 242, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c3666ff5b5af", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 token0Exp;", "highlightLines": [243]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 243, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "711972aa92df", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 token1Exp;", "highlightLines": [244]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 244, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "fee855a5afc3", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 upperBound;", "highlightLines": [245]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 245, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8be76f6bedbd", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 shares;", "highlightLines": [246]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 246, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "6c99b6036084", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 collateralMin;", "highlightLines": [247]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 247, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a4422339ef24", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 amount0Min;", "highlightLines": [248]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 248, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d3b837d51959", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 amount1Min;", "highlightLines": [249]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 249, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "9d40a8f61104", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    bytes swapExtraData;", "highlightLines": [251]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 251, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "70740bbe8dd7", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address recipient;", "highlightLines": [252]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 252, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "baf4e77797a0", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 deadline;", "highlightLines": [253]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 253, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d8168bf7e500", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "  function burn(BurnParams calldata params) external payable checkDeadline(params.deadline) returns (uint256 amount) {", "highlightLines": [257]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 257, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "03ea125b0138", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "  function burn(BurnParams calldata params) external payable checkDeadline(params.deadline) returns (uint256 amount) {", "highlightLines": [257]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 257, "column": 3}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "f7562ee96276", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address lendgine = LendgineAddress.computeAddress(", "highlightLines": [258]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 258, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b8426757eac9", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    address lendgine = LendgineAddress.computeAddress(\n      factory, params.token0, params.token1, params.token0Exp, params.token1Exp, params.upperBound\n    );\n\n    address recipient = params.recipient == address(0) ? address(this) : params.recipient;", "highlightLines": [258]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 258, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "0b3f2b559429", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    address recipient = params.recipient == address(0) ? address(this) : params.recipient;", "highlightLines": [261]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 261, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "374042c69838", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    address recipient = params.recipient == address(0) ? address(this) : params.recipient;\n\n    SafeTransferLib.safeTransferFrom(lendgine, msg.sender, lendgine, params.shares);\n\n    amount = ILendgine(lendgine).burn(\n      address(this),\n      abi.encode(\n        PairMintCallbackData({\n          token0: params.token0,\n          token1: params.token1,\n          token0Exp: params.token0Exp,\n          token1Exp: params.token1Exp,\n          upperBound: params.upperBound,\n          collateralMin: params.collateralMin,\n          amount0Min: params.amount0Min,\n          amount1Min: params.amount1Min,\n          swapType: params.swapType,\n          swapExtraData: params.swapExtraData,\n          recipient: recipient\n        })\n      )\n    );", "highlightLines": [262]}, "category": "code", "location": {"file": "src/periphery/LendgineRouter.sol", "line": 262, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "abeff5d956dd", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.4;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "1601aa9cdf52", "fix": {"template": null, "available": false}, "title": "Base constructor called multiple times through diamond inheritance - may initialize twice", "ruleId": "rules.sol-reused-constructor", "snippet": {"code": "contract LiquidityManager is Multicall, Payment, SelfPermit, IPairMintCallback {", "highlightLines": [16]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 16, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#reused-base-constructor"], "description": ""}, {"id": "3a6bbd713079", "fix": {"template": null, "available": false}, "title": "SWC-125: Multiple inheritance may cause incorrect function resolution - check C3 linearization", "ruleId": "rules.sol-swc-125-inheritance-order", "snippet": {"code": "contract LiquidityManager is Multicall, Payment, SelfPermit, IPairMintCallback {", "highlightLines": [16]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 16, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-125"], "description": ""}, {"id": "fa9bf7b0558c", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "contract LiquidityManager is Multicall, Payment, SelfPermit, IPairMintCallback {", "highlightLines": [16]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 16, "column": 1}, "severity": "medium", "references": [], "description": ""}, {"id": "a73d853d165f", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract LiquidityManager is Multicall, Payment, SelfPermit, IPairMintCallback {\n  /*//////////////////////////////////////////////////////////////\n                                 EVENTS\n    //////////////////////////////////////////////////////////////*/\n  event AddLiquidity(\n    address indexed from,\n    address indexed lendgine,\n    uint256 liquidity,\n    uint256 size,\n    uint256 amount0,\n    uint256 amount1,\n    address indexed to\n  );\n\n  event RemoveLiquidity(\n    address indexed from,\n    address indexed lendgine,\n    uint256 liquidity,\n    uint256 size,\n    uint256 amount0,\n    uint256 amount1,\n    address indexed to\n  );\n\n  event Collect(address indexed from, address indexed lendgine, uint256 amount, address indexed to);\n\n  /*//////////////////////////////////////////////////////////////\n                                 ERRORS\n    //////////////////////////////////////////////////////////////*/\n\n  error LivelinessError();\n\n  error AmountError();\n\n  error ValidationError();\n\n  error PositionInvalidError();\n\n  error CollectError();\n\n  /*//////////////////////////////////////////////////////////////\n                                STORAGE\n    //////////////////////////////////////////////////////////////*/\n\n  address public immutable factory;\n\n  struct Position {\n    uint256 size;\n    uint256 rewardPerPositionPaid;\n    uint256 tokensOwed;", "highlightLines": [16]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 16, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "53e3c78fe0bd", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event AddLiquidity(\n    address indexed from,\n    address indexed lendgine,\n    uint256 liquidity,\n    uint256 size,\n    uint256 amount0,\n    uint256 amount1,\n    address indexed to\n  );", "highlightLines": [20]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 20, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "2a88bb033c61", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event AddLiquidity(\n    address indexed from,\n    address indexed lendgine,\n    uint256 liquidity,\n    uint256 size,\n    uint256 amount0,\n    uint256 amount1,\n    address indexed to\n  );", "highlightLines": [20]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 20, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "062e37813e64", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event RemoveLiquidity(\n    address indexed from,\n    address indexed lendgine,\n    uint256 liquidity,\n    uint256 size,\n    uint256 amount0,\n    uint256 amount1,\n    address indexed to\n  );", "highlightLines": [30]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 30, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "bcb2088b35d8", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event RemoveLiquidity(\n    address indexed from,\n    address indexed lendgine,\n    uint256 liquidity,\n    uint256 size,\n    uint256 amount0,\n    uint256 amount1,\n    address indexed to\n  );", "highlightLines": [30]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 30, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "1feb4e1ac500", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event Collect(address indexed from, address indexed lendgine, uint256 amount, address indexed to);", "highlightLines": [40]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 40, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "752268b62fc1", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 size;", "highlightLines": [63]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 63, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "025a79dba7d3", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 rewardPerPositionPaid;", "highlightLines": [64]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 64, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "41fe092645a2", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 tokensOwed;", "highlightLines": [65]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 65, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "832ac44cb804", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  constructor(address _factory, address _weth) Payment(_weth) {\n    factory = _factory;\n  }", "highlightLines": [75]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 75, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "ba37677e94e7", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  modifier checkDeadline(uint256 deadline) {\n    if (deadline < block.timestamp) revert LivelinessError();\n    _;\n  }", "highlightLines": [83]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 83, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "bd4bb7cd3852", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "  modifier checkDeadline(uint256 deadline) {\n    if (deadline < block.timestamp) revert LivelinessError();\n    _;\n  }", "highlightLines": [83]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 83, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "102783eb7d3a", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "    if (deadline < block.timestamp) revert LivelinessError();", "highlightLines": [84]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 84, "column": 20}, "severity": "medium", "references": [], "description": ""}, {"id": "da9814050423", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    _;", "highlightLines": [85]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 85, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "73df91dad274", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address token0;", "highlightLines": [93]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 93, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f61c03b5689e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address token1;", "highlightLines": [94]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 94, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "731322ebd218", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 token0Exp;", "highlightLines": [95]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 95, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8b235aa2dc38", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 token1Exp;", "highlightLines": [96]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 96, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e8e7d19b9d19", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 upperBound;", "highlightLines": [97]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 97, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "de464d73867d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 amount0;", "highlightLines": [98]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 98, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "65322fef3901", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 amount1;", "highlightLines": [99]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 99, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b898722e08f3", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address payer;", "highlightLines": [100]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 100, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e29ea9ba63ec", "fix": {"template": null, "available": false}, "title": "Callback handler doesn't update status - repeated callbacks possible", "ruleId": "rules.sol-callback-no-status-update", "snippet": {"code": "  function pairMintCallback(uint256, bytes calldata data) external {", "highlightLines": [104]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 104, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "a1062af79352", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    PairMintCallbackData memory decoded = abi.decode(data, (PairMintCallbackData));\n\n    address lendgine = LendgineAddress.computeAddress(\n      factory, decoded.token0, decoded.token1, decoded.token0Exp, decoded.token1Exp, decoded.upperBound\n    );", "highlightLines": [105]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 105, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "d6fb96e3b112", "fix": {"template": null, "available": false}, "title": "abi.decode on untrusted calldata - potential ABI smuggling attack", "ruleId": "rules.sol-abi-decode-untrusted", "snippet": {"code": "    PairMintCallbackData memory decoded = abi.decode(data, (PairMintCallbackData));", "highlightLines": [105]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 105, "column": 43}, "severity": "medium", "references": [], "description": ""}, {"id": "8a3d81eec1a0", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    address lendgine = LendgineAddress.computeAddress(", "highlightLines": [106]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 106, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "1d321cb23154", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address token0;", "highlightLines": [121]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 121, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b55f50476d28", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address token1;", "highlightLines": [122]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 122, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "591d6aa29524", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 token0Exp;", "highlightLines": [123]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 123, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0295e2bcf645", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 token1Exp;", "highlightLines": [124]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 124, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b0405f12860e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 upperBound;", "highlightLines": [125]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 125, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "72894c2a8dad", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 liquidity;", "highlightLines": [126]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 126, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "59f7bbc26745", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 amount0Min;", "highlightLines": [127]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 127, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "dc1c329e8956", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 amount1Min;", "highlightLines": [128]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 128, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c5898481363b", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 sizeMin;", "highlightLines": [129]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 129, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ab26b5fafb6f", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address recipient;", "highlightLines": [130]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 130, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "63a1d4125d27", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 deadline;", "highlightLines": [131]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 131, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "19a9f378bcbb", "fix": {"template": null, "available": false}, "title": "Swap/liquidity operation without deadline parameter - transaction can be delayed indefinitely", "ruleId": "rules.sol-missing-deadline-check", "snippet": {"code": "  function addLiquidity(AddLiquidityParams calldata params) external payable checkDeadline(params.deadline) {", "highlightLines": [135]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 135, "column": 3}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "4ff217aaad2e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address lendgine = LendgineAddress.computeAddress(", "highlightLines": [136]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 136, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "49e6616f7dd7", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    address lendgine = LendgineAddress.computeAddress(\n      factory, params.token0, params.token1, params.token0Exp, params.token1Exp, params.upperBound\n    );\n\n    uint256 r0 = ILendgine(lendgine).reserve0();", "highlightLines": [136]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 136, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "e4598637cc86", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 r0 = ILendgine(lendgine).reserve0();", "highlightLines": [139]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 139, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b8f492479cd8", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "    uint256 r0 = ILendgine(lendgine).reserve0();\n    uint256 r1 = ILendgine(lendgine).reserve1();", "highlightLines": [140]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 140, "column": 5}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "0480900bca57", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 r0 = ILendgine(lendgine).reserve0();\n    uint256 r1 = ILendgine(lendgine).reserve1();", "highlightLines": [140]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 140, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "a6f02eab84b3", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 r1 = ILendgine(lendgine).reserve1();", "highlightLines": [141]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 141, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c627445e257d", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "    uint256 r1 = ILendgine(lendgine).reserve1();\n    uint256 totalLiquidity = ILendgine(lendgine).totalLiquidity();", "highlightLines": [141]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 141, "column": 5}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "178c0ee253ff", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 r1 = ILendgine(lendgine).reserve1();\n    uint256 totalLiquidity = ILendgine(lendgine).totalLiquidity();", "highlightLines": [141]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 141, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "d4fe21b64ad3", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 totalLiquidity = ILendgine(lendgine).totalLiquidity();", "highlightLines": [142]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 142, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "1e9a15df4e8c", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "    uint256 totalLiquidity = ILendgine(lendgine).totalLiquidity();", "highlightLines": [142]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 142, "column": 5}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "7b7ab62af6fa", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 totalLiquidity = ILendgine(lendgine).totalLiquidity();\n\n    uint256 amount0;\n    uint256 amount1;\n\n    if (totalLiquidity == 0) {\n      amount0 = params.amount0Min;\n      amount1 = params.amount1Min;\n    } else {\n      amount0 = FullMath.mulDivRoundingUp(params.liquidity, r0, totalLiquidity);\n      amount1 = FullMath.mulDivRoundingUp(params.liquidity, r1, totalLiquidity);\n    }", "highlightLines": [142]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 142, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "488fd4d396b7", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "    uint256 totalLiquidity = ILendgine(lendgine).totalLiquidity();\n\n    uint256 amount0;\n    uint256 amount1;\n\n    if (totalLiquidity == 0) {\n      amount0 = params.amount0Min;\n      amount1 = params.amount1Min;\n    } else {\n      amount0 = FullMath.mulDivRoundingUp(params.liquidity, r0, totalLiquidity);\n      amount1 = FullMath.mulDivRoundingUp(params.liquidity, r1, totalLiquidity);\n    }\n\n    if (amount0 < params.amount0Min || amount1 < params.amount1Min) revert AmountError();\n\n    uint256 size = ILendgine(lendgine).deposit(\n      address(this),\n      params.liquidity,\n      abi.encode(\n        PairMintCallbackData({\n          token0: params.token0,\n          token1: params.token1,\n          token0Exp: params.token0Exp,\n          token1Exp: params.token1Exp,\n          upperBound: params.upperBound,\n          amount0: amount0,\n          amount1: amount1,\n          payer: msg.sender\n        })\n      )\n    );", "highlightLines": [142]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 142, "column": 5}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "222a07e61cb8", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 amount0;", "highlightLines": [143]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 143, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c38e32d7ec4c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 amount1;", "highlightLines": [145]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 145, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "840f093c7c26", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "      amount0 = params.amount0Min;\n      amount1 = params.amount1Min;", "highlightLines": [148]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 148, "column": 7}, "severity": "info", "references": [], "description": ""}, {"id": "35fabfbd041c", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "      amount0 = FullMath.mulDivRoundingUp(params.liquidity, r0, totalLiquidity);\n      amount1 = FullMath.mulDivRoundingUp(params.liquidity, r1, totalLiquidity);", "highlightLines": [151]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 151, "column": 7}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "1016bcbae661", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "      amount0 = FullMath.mulDivRoundingUp(params.liquidity, r0, totalLiquidity);\n      amount1 = FullMath.mulDivRoundingUp(params.liquidity, r1, totalLiquidity);", "highlightLines": [151]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 151, "column": 7}, "severity": "info", "references": [], "description": ""}, {"id": "7697e100f448", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 size = ILendgine(lendgine).deposit(", "highlightLines": [156]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 156, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "9440fe6ff73c", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 size = ILendgine(lendgine).deposit(\n      address(this),\n      params.liquidity,\n      abi.encode(\n        PairMintCallbackData({\n          token0: params.token0,\n          token1: params.token1,\n          token0Exp: params.token0Exp,\n          token1Exp: params.token1Exp,\n          upperBound: params.upperBound,\n          amount0: amount0,\n          amount1: amount1,\n          payer: msg.sender\n        })\n      )\n    );\n    if (size < params.sizeMin) revert AmountError();\n\n    Position memory position = positions[params.recipient][lendgine]; // SLOAD", "highlightLines": [157]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 157, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "6f7dcccbf7ec", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "    uint256 size = ILendgine(lendgine).deposit(\n      address(this),\n      params.liquidity,\n      abi.encode(\n        PairMintCallbackData({\n          token0: params.token0,\n          token1: params.token1,\n          token0Exp: params.token0Exp,\n          token1Exp: params.token1Exp,\n          upperBound: params.upperBound,\n          amount0: amount0,\n          amount1: amount1,\n          payer: msg.sender\n        })\n      )\n    );\n    if (size < params.sizeMin) revert AmountError();\n\n    Position memory position = positions[params.recipient][lendgine]; // SLOAD\n\n    (, uint256 rewardPerPositionPaid,) = ILendgine(lendgine).positions(address(this));", "highlightLines": [157]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 157, "column": 5}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "7f5bc1489925", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    Position memory position = positions[params.recipient][lendgine]; // SLOAD\n\n    (, uint256 rewardPerPositionPaid,) = ILendgine(lendgine).positions(address(this));", "highlightLines": [175]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 175, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "5d96b1e2810e", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    (, uint256 rewardPerPositionPaid,) = ILendgine(lendgine).positions(address(this));\n    position.tokensOwed += FullMath.mulDiv(position.size, rewardPerPositionPaid - position.rewardPerPositionPaid, 1e18);\n    position.rewardPerPositionPaid = rewardPerPositionPaid;", "highlightLines": [177]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 177, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "f58c9351f7f0", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    position.tokensOwed += FullMath.mulDiv(position.size, rewardPerPositionPaid - position.rewardPerPositionPaid, 1e18);", "highlightLines": [178]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 178, "column": 115}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "acb1d156971a", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    position.rewardPerPositionPaid = rewardPerPositionPaid;\n    position.size += size;\n\n    positions[params.recipient][lendgine] = position; // SSTORE", "highlightLines": [179]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 179, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "b55cdb56dbfd", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address token0;", "highlightLines": [188]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 188, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "fc55ccbdf222", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address token1;", "highlightLines": [189]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 189, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "fb1c36e6fe6d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 token0Exp;", "highlightLines": [190]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 190, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "5662f784966e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 token1Exp;", "highlightLines": [191]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 191, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "2bf50180e677", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 upperBound;", "highlightLines": [192]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 192, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "653d7e0c5b87", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 size;", "highlightLines": [193]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 193, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "bf171727b959", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 amount0Min;", "highlightLines": [194]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 194, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "2cfd0e47b411", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 amount1Min;", "highlightLines": [195]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 195, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "412a4a18c8bc", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address recipient;", "highlightLines": [196]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 196, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "382677b38291", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 deadline;", "highlightLines": [197]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 197, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "1b397c08f410", "fix": {"template": null, "available": false}, "title": "Swap/liquidity operation without deadline parameter - transaction can be delayed indefinitely", "ruleId": "rules.sol-missing-deadline-check", "snippet": {"code": "  function removeLiquidity(RemoveLiquidityParams calldata params) external payable checkDeadline(params.deadline) {", "highlightLines": [201]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 201, "column": 3}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "786ec170359b", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address lendgine = LendgineAddress.computeAddress(", "highlightLines": [202]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 202, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "049dcc28cdfb", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    address lendgine = LendgineAddress.computeAddress(\n      factory, params.token0, params.token1, params.token0Exp, params.token1Exp, params.upperBound\n    );\n\n    address recipient = params.recipient == address(0) ? address(this) : params.recipient;", "highlightLines": [202]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 202, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "eff887ca255c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    address recipient = params.recipient == address(0) ? address(this) : params.recipient;", "highlightLines": [205]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 205, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e5f6c3d2fad6", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    address recipient = params.recipient == address(0) ? address(this) : params.recipient;\n\n    (uint256 amount0, uint256 amount1, uint256 liquidity) = ILendgine(lendgine).withdraw(recipient, params.size);", "highlightLines": [206]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 206, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "26b8897a4b19", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    (uint256 amount0, uint256 amount1, uint256 liquidity) = ILendgine(lendgine).withdraw(recipient, params.size);\n    if (amount0 < params.amount0Min || amount1 < params.amount1Min) revert AmountError();\n\n    Position memory position = positions[msg.sender][lendgine]; // SLOAD", "highlightLines": [208]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 208, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "49688479c42f", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "    (uint256 amount0, uint256 amount1, uint256 liquidity) = ILendgine(lendgine).withdraw(recipient, params.size);\n    if (amount0 < params.amount0Min || amount1 < params.amount1Min) revert AmountError();\n\n    Position memory position = positions[msg.sender][lendgine]; // SLOAD\n\n    (, uint256 rewardPerPositionPaid,) = ILendgine(lendgine).positions(address(this));", "highlightLines": [208]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 208, "column": 5}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "cd08ff53abfd", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    Position memory position = positions[msg.sender][lendgine]; // SLOAD\n\n    (, uint256 rewardPerPositionPaid,) = ILendgine(lendgine).positions(address(this));", "highlightLines": [211]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 211, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "da4aa5eead24", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    (, uint256 rewardPerPositionPaid,) = ILendgine(lendgine).positions(address(this));\n    position.tokensOwed += FullMath.mulDiv(position.size, rewardPerPositionPaid - position.rewardPerPositionPaid, 1e18);\n    position.rewardPerPositionPaid = rewardPerPositionPaid;", "highlightLines": [213]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 213, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "566611475321", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    position.tokensOwed += FullMath.mulDiv(position.size, rewardPerPositionPaid - position.rewardPerPositionPaid, 1e18);", "highlightLines": [214]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 214, "column": 115}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "8513ca93795e", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    position.rewardPerPositionPaid = rewardPerPositionPaid;\n    position.size -= params.size;\n\n    positions[msg.sender][lendgine] = position; // SSTORE", "highlightLines": [215]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 215, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "5fa4a52a09b9", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address lendgine;", "highlightLines": [224]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 224, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a1a6fff1f393", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address recipient;", "highlightLines": [225]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 225, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3c545ff7802c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 amountRequested;", "highlightLines": [226]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 226, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c0eec793207f", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    address recipient = params.recipient == address(0) ? address(this) : params.recipient;", "highlightLines": [232]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 232, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0601cbd14c2c", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    address recipient = params.recipient == address(0) ? address(this) : params.recipient;\n\n    Position memory position = positions[msg.sender][params.lendgine]; // SLOAD", "highlightLines": [233]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 233, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "a77e32106f8b", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    Position memory position = positions[msg.sender][params.lendgine]; // SLOAD\n\n    (, uint256 rewardPerPositionPaid,) = ILendgine(params.lendgine).positions(address(this));", "highlightLines": [235]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 235, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "4fb6424550c5", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    (, uint256 rewardPerPositionPaid,) = ILendgine(params.lendgine).positions(address(this));\n    position.tokensOwed += FullMath.mulDiv(position.size, rewardPerPositionPaid - position.rewardPerPositionPaid, 1e18);\n    position.rewardPerPositionPaid = rewardPerPositionPaid;", "highlightLines": [237]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 237, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "40a550ad8261", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "    (, uint256 rewardPerPositionPaid,) = ILendgine(params.lendgine).positions(address(this));\n    position.tokensOwed += FullMath.mulDiv(position.size, rewardPerPositionPaid - position.rewardPerPositionPaid, 1e18);\n    position.rewardPerPositionPaid = rewardPerPositionPaid;\n\n    amount = params.amountRequested > position.tokensOwed ? position.tokensOwed : params.amountRequested;\n    position.tokensOwed -= amount;\n\n    positions[msg.sender][params.lendgine] = position; // SSTORE\n\n    uint256 collectAmount = ILendgine(params.lendgine).collect(recipient, amount);", "highlightLines": [237]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 237, "column": 5}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "bd292f899d75", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    position.tokensOwed += FullMath.mulDiv(position.size, rewardPerPositionPaid - position.rewardPerPositionPaid, 1e18);", "highlightLines": [238]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 238, "column": 115}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "c5eb5b5424ef", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    position.rewardPerPositionPaid = rewardPerPositionPaid;\n\n    amount = params.amountRequested > position.tokensOwed ? position.tokensOwed : params.amountRequested;", "highlightLines": [239]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 239, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "7d93da356fe6", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    amount = params.amountRequested > position.tokensOwed ? position.tokensOwed : params.amountRequested;\n    position.tokensOwed -= amount;\n\n    positions[msg.sender][params.lendgine] = position; // SSTORE", "highlightLines": [241]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 241, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "21a2f982803a", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    positions[msg.sender][params.lendgine] = position; // SSTORE\n\n    uint256 collectAmount = ILendgine(params.lendgine).collect(recipient, amount);", "highlightLines": [244]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 244, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "1fcb239802da", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 collectAmount = ILendgine(params.lendgine).collect(recipient, amount);", "highlightLines": [245]}, "category": "code", "location": {"file": "src/periphery/LiquidityManager.sol", "line": 245, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "6153c504ee6a", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/periphery/Multicall.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "f70d649d4a30", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "abstract contract Multicall is IMulticall {", "highlightLines": [10]}, "category": "code", "location": {"file": "src/periphery/Multicall.sol", "line": 10, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "0b16cb237f1c", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "abstract contract Multicall is IMulticall {\n  /// @inheritdoc IMulticall\n  function multicall(bytes[] calldata data) public payable override returns (bytes[] memory results) {\n    results = new bytes[](data.length);\n    unchecked {\n      for (uint256 i = 0; i < data.length; i++) {", "highlightLines": [10]}, "category": "code", "location": {"file": "src/periphery/Multicall.sol", "line": 10, "column": 10}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "0ec53b4db851", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    results = new bytes[](data.length);\n    unchecked {\n      for (uint256 i = 0; i < data.length; i++) {\n        (bool success, bytes memory result) = address(this).delegatecall(data[i]);\n\n        if (!success) {\n          if (result.length == 0) revert();\n          assembly {\n            revert(add(32, result), mload(result))\n          }\n        }\n\n        results[i] = result;\n      }\n    }", "highlightLines": [13]}, "category": "code", "location": {"file": "src/periphery/Multicall.sol", "line": 13, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "c4598cdcee12", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    results = new bytes[](data.length);", "highlightLines": [13]}, "category": "code", "location": {"file": "src/periphery/Multicall.sol", "line": 13, "column": 15}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "88b3c610bce5", "fix": {"template": null, "available": false}, "title": "Delegatecall inside loop with msg.value - value may be reused across iterations", "ruleId": "rules.sol-delegatecall-in-loop", "snippet": {"code": "      for (uint256 i = 0; i < data.length; i++) {\n        (bool success, bytes memory result) = address(this).delegatecall(data[i]);", "highlightLines": [15]}, "category": "code", "location": {"file": "src/periphery/Multicall.sol", "line": 15, "column": 7}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#payable-functions-using-delegatecall-inside-a-loop"], "description": ""}, {"id": "0bcd1c7e163f", "fix": {"template": null, "available": false}, "title": "Unbounded loop iterating over dynamic array - can cause out-of-gas DoS", "ruleId": "rules.sol-unbounded-loop-dos", "snippet": {"code": "      for (uint256 i = 0; i < data.length; i++) {\n        (bool success, bytes memory result) = address(this).delegatecall(data[i]);", "highlightLines": [15]}, "category": "code", "location": {"file": "src/periphery/Multicall.sol", "line": 15, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "f81cc3640cc5", "fix": {"template": null, "available": false}, "title": "Unbounded loop over dynamic array - can cause DoS if array grows large", "ruleId": "rules.sol-unbounded-protocol-loop", "snippet": {"code": "      for (uint256 i = 0; i < data.length; i++) {\n        (bool success, bytes memory result) = address(this).delegatecall(data[i]);", "highlightLines": [15]}, "category": "code", "location": {"file": "src/periphery/Multicall.sol", "line": 15, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "c32d273d60d5", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        (bool success, bytes memory result) = address(this).delegatecall(data[i]);\n\n        if (!success) {\n          if (result.length == 0) revert();\n          assembly {\n            revert(add(32, result), mload(result))\n          }\n        }\n\n        results[i] = result;", "highlightLines": [16]}, "category": "code", "location": {"file": "src/periphery/Multicall.sol", "line": 16, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "a7f178d3f258", "fix": {"template": null, "available": false}, "title": "Delegatecall with user-controlled data - storage slot collision possible", "ruleId": "rules.sol-arbitrary-delegatecall-data", "snippet": {"code": "        (bool success, bytes memory result) = address(this).delegatecall(data[i]);", "highlightLines": [16]}, "category": "code", "location": {"file": "src/periphery/Multicall.sol", "line": 16, "column": 60}, "severity": "high", "references": [], "description": ""}, {"id": "8d62d7ab4a94", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "          if (result.length == 0) revert();\n          assembly {", "highlightLines": [19]}, "category": "code", "location": {"file": "src/periphery/Multicall.sol", "line": 19, "column": 35}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "401bf346439e", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "          assembly {", "highlightLines": [20]}, "category": "code", "location": {"file": "src/periphery/Multicall.sol", "line": 20, "column": 11}, "severity": "info", "references": [], "description": ""}, {"id": "97092d15d7e6", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.4;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/periphery/Payment.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "546e1e51e75b", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  constructor(address _weth) {\n    weth = _weth;\n  }", "highlightLines": [17]}, "category": "code", "location": {"file": "src/periphery/Payment.sol", "line": 17, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "7eef29c55eed", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "  receive() external payable {", "highlightLines": [21]}, "category": "code", "location": {"file": "src/periphery/Payment.sol", "line": 21, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "1c79e25b3313", "fix": {"template": null, "available": false}, "title": "Fallback/receive with require can cause DoS - callers cannot send ETH if condition fails (King pattern)", "ruleId": "rules.sol-reverting-fallback-dos", "snippet": {"code": "  receive() external payable {\n    require(msg.sender == weth, \"Not WETH9\");", "highlightLines": [21]}, "category": "code", "location": {"file": "src/periphery/Payment.sol", "line": 21, "column": 3}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/9"], "description": ""}, {"id": "8541790d1a3b", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 balanceWETH = Balance.balance(weth);", "highlightLines": [26]}, "category": "code", "location": {"file": "src/periphery/Payment.sol", "line": 26, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e1ef1c7e82f8", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 balanceToken = Balance.balance(token);", "highlightLines": [36]}, "category": "code", "location": {"file": "src/periphery/Payment.sol", "line": 36, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a2f9d9a1c15f", "fix": {"template": null, "available": false}, "title": "ETH balance check without accounting for selfdestruct donations - can be manipulated", "ruleId": "rules.sol-eth-balance-accounting", "snippet": {"code": "    if (address(this).balance > 0) SafeTransferLib.safeTransferETH(msg.sender, address(this).balance);", "highlightLines": [45]}, "category": "code", "location": {"file": "src/periphery/Payment.sol", "line": 45, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d40050cefa59", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "  function pay(address token, address payer, address recipient, uint256 value) internal {\n    if (token == weth && address(this).balance >= value) {", "highlightLines": [52]}, "category": "code", "location": {"file": "src/periphery/Payment.sol", "line": 52, "column": 3}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "6e95b0bc2e45", "fix": {"template": null, "available": false}, "title": "ETH balance check without accounting for selfdestruct donations - can be manipulated", "ruleId": "rules.sol-eth-balance-accounting", "snippet": {"code": "    if (token == weth && address(this).balance >= value) {", "highlightLines": [53]}, "category": "code", "location": {"file": "src/periphery/Payment.sol", "line": 53, "column": 26}, "severity": "medium", "references": [], "description": ""}, {"id": "a9befae3092a", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/periphery/SelfPermit.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "08903f28ce74", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "abstract contract SelfPermit is ISelfPermit {", "highlightLines": [10]}, "category": "code", "location": {"file": "src/periphery/SelfPermit.sol", "line": 10, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "309f9f35a37d", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "    IERC20Permit(token).permit(msg.sender, address(this), value, deadline, v, r, s);", "highlightLines": [20]}, "category": "code", "location": {"file": "src/periphery/SelfPermit.sol", "line": 20, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "1f88c4321b7a", "fix": {"template": null, "available": false}, "title": "ERC20 permit without deadline validation - permits can be replayed", "ruleId": "rules.sol-permit-no-deadline-check", "snippet": {"code": "    IERC20Permit(token).permit(msg.sender, address(this), value, deadline, v, r, s);", "highlightLines": [20]}, "category": "code", "location": {"file": "src/periphery/SelfPermit.sol", "line": 20, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "8fd005b81ae6", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "    IERC20PermitAllowed(token).permit(msg.sender, address(this), nonce, expiry, true, v, r, s);", "highlightLines": [42]}, "category": "code", "location": {"file": "src/periphery/SelfPermit.sol", "line": 42, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "5b2e3e8a5039", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.4;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/periphery/SwapHelper.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "a58a450d8861", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "abstract contract SwapHelper is IUniswapV3SwapCallback {", "highlightLines": [15]}, "category": "code", "location": {"file": "src/periphery/SwapHelper.sol", "line": 15, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "f6104a968444", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  constructor(address _uniswapV2Factory, address _uniswapV3Factory) {\n    uniswapV2Factory = _uniswapV2Factory;\n    uniswapV3Factory = _uniswapV3Factory;\n  }", "highlightLines": [29]}, "category": "code", "location": {"file": "src/periphery/SwapHelper.sol", "line": 29, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "8c0689d06526", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uniswapV2Factory = _uniswapV2Factory;\n    uniswapV3Factory = _uniswapV3Factory;", "highlightLines": [30]}, "category": "code", "location": {"file": "src/periphery/SwapHelper.sol", "line": 30, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "6a8a166bb2d8", "fix": {"template": null, "available": false}, "title": "Callback function without caller validation - external contracts can trigger unexpected behavior", "ruleId": "rules.sol-unprotected-callback", "snippet": {"code": "  function uniswapV3SwapCallback(int256 amount0Delta, int256 amount1Delta, bytes calldata data) external override {", "highlightLines": [38]}, "category": "code", "location": {"file": "src/periphery/SwapHelper.sol", "line": 38, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "55e16334f827", "fix": {"template": null, "available": false}, "title": "Callback handler doesn't update status - repeated callbacks possible", "ruleId": "rules.sol-callback-no-status-update", "snippet": {"code": "  function uniswapV3SwapCallback(int256 amount0Delta, int256 amount1Delta, bytes calldata data) external override {", "highlightLines": [38]}, "category": "code", "location": {"file": "src/periphery/SwapHelper.sol", "line": 38, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "965a08a6d56a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address tokenIn = abi.decode(data, (address));", "highlightLines": [39]}, "category": "code", "location": {"file": "src/periphery/SwapHelper.sol", "line": 39, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "bc66eb0dc631", "fix": {"template": null, "available": false}, "title": "abi.decode on untrusted calldata - potential ABI smuggling attack", "ruleId": "rules.sol-abi-decode-untrusted", "snippet": {"code": "    address tokenIn = abi.decode(data, (address));", "highlightLines": [39]}, "category": "code", "location": {"file": "src/periphery/SwapHelper.sol", "line": 39, "column": 23}, "severity": "medium", "references": [], "description": ""}, {"id": "dfc849f6b4a3", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address tokenIn;", "highlightLines": [55]}, "category": "code", "location": {"file": "src/periphery/SwapHelper.sol", "line": 55, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f6db1d77b8fc", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address tokenOut;", "highlightLines": [56]}, "category": "code", "location": {"file": "src/periphery/SwapHelper.sol", "line": 56, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f00ec6da7eba", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    int256 amount; // negative corresponds to exact out", "highlightLines": [57]}, "category": "code", "location": {"file": "src/periphery/SwapHelper.sol", "line": 57, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0704e06034ab", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address recipient;", "highlightLines": [58]}, "category": "code", "location": {"file": "src/periphery/SwapHelper.sol", "line": 58, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3614e2c12319", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint24 fee;", "highlightLines": [62]}, "category": "code", "location": {"file": "src/periphery/SwapHelper.sol", "line": 62, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "af440abb11fc", "fix": {"template": null, "available": false}, "title": "Swap/liquidity operation without deadline parameter - transaction can be delayed indefinitely", "ruleId": "rules.sol-missing-deadline-check", "snippet": {"code": "  function swap(SwapType swapType, SwapParams memory params, bytes memory data) internal returns (uint256 amount) {", "highlightLines": [69]}, "category": "code", "location": {"file": "src/periphery/SwapHelper.sol", "line": 69, "column": 3}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "a7e602104522", "fix": {"template": null, "available": false}, "title": "Token swap/buy without slippage protection - MEV/sandwich attack risk", "ruleId": "rules.sol-missing-slippage-protection", "snippet": {"code": "  function swap(SwapType swapType, SwapParams memory params, bytes memory data) internal returns (uint256 amount) {", "highlightLines": [69]}, "category": "code", "location": {"file": "src/periphery/SwapHelper.sol", "line": 69, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "57f02de11a5a", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "  function swap(SwapType swapType, SwapParams memory params, bytes memory data) internal returns (uint256 amount) {\n    if (swapType == SwapType.UniswapV2) {", "highlightLines": [69]}, "category": "code", "location": {"file": "src/periphery/SwapHelper.sol", "line": 69, "column": 3}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "0696bb4044a2", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "      address pair = UniswapV2Library.pairFor(uniswapV2Factory, params.tokenIn, params.tokenOut);", "highlightLines": [71]}, "category": "code", "location": {"file": "src/periphery/SwapHelper.sol", "line": 71, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b98e353705b2", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "      address pair = UniswapV2Library.pairFor(uniswapV2Factory, params.tokenIn, params.tokenOut);\n\n      (uint256 reserveIn, uint256 reserveOut) =\n        UniswapV2Library.getReserves(uniswapV2Factory, params.tokenIn, params.tokenOut);", "highlightLines": [71]}, "category": "code", "location": {"file": "src/periphery/SwapHelper.sol", "line": 71, "column": 7}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "ec73d21a98b7", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "      address pair = UniswapV2Library.pairFor(uniswapV2Factory, params.tokenIn, params.tokenOut);\n\n      (uint256 reserveIn, uint256 reserveOut) =\n        UniswapV2Library.getReserves(uniswapV2Factory, params.tokenIn, params.tokenOut);", "highlightLines": [71]}, "category": "code", "location": {"file": "src/periphery/SwapHelper.sol", "line": 71, "column": 7}, "severity": "info", "references": [], "description": ""}, {"id": "0b0744f71e1f", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "      (uint256 reserveIn, uint256 reserveOut) =\n        UniswapV2Library.getReserves(uniswapV2Factory, params.tokenIn, params.tokenOut);\n\n      amount = params.amount > 0\n        ? UniswapV2Library.getAmountOut(uint256(params.amount), reserveIn, reserveOut)\n        : UniswapV2Library.getAmountIn(uint256(-params.amount), reserveIn, reserveOut);", "highlightLines": [73]}, "category": "code", "location": {"file": "src/periphery/SwapHelper.sol", "line": 73, "column": 7}, "severity": "info", "references": [], "description": ""}, {"id": "4ad5a64fa359", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "      (uint256 reserveIn, uint256 reserveOut) =\n        UniswapV2Library.getReserves(uniswapV2Factory, params.tokenIn, params.tokenOut);\n\n      amount = params.amount > 0\n        ? UniswapV2Library.getAmountOut(uint256(params.amount), reserveIn, reserveOut)\n        : UniswapV2Library.getAmountIn(uint256(-params.amount), reserveIn, reserveOut);\n\n      (uint256 amountIn, uint256 amountOut) =\n        params.amount > 0 ? (uint256(params.amount), amount) : (amount, uint256(-params.amount));\n\n      (address token0,) = UniswapV2Library.sortTokens(params.tokenIn, params.tokenOut);", "highlightLines": [73]}, "category": "code", "location": {"file": "src/periphery/SwapHelper.sol", "line": 73, "column": 7}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "f25022db36fb", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "      amount = params.amount > 0\n        ? UniswapV2Library.getAmountOut(uint256(params.amount), reserveIn, reserveOut)\n        : UniswapV2Library.getAmountIn(uint256(-params.amount), reserveIn, reserveOut);\n\n      (uint256 amountIn, uint256 amountOut) =\n        params.amount > 0 ? (uint256(params.amount), amount) : (amount, uint256(-params.amount));", "highlightLines": [76]}, "category": "code", "location": {"file": "src/periphery/SwapHelper.sol", "line": 76, "column": 7}, "severity": "info", "references": [], "description": ""}, {"id": "214868a1cd64", "fix": {"template": null, "available": false}, "title": "Price derived from single block data - vulnerable to flash loan manipulation", "ruleId": "rules.sol-price-manipulation-single-block", "snippet": {"code": "        ? UniswapV2Library.getAmountOut(uint256(params.amount), reserveIn, reserveOut)", "highlightLines": [77]}, "category": "code", "location": {"file": "src/periphery/SwapHelper.sol", "line": 77, "column": 28}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "c1f58aa80c41", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "      (uint256 amountIn, uint256 amountOut) =\n        params.amount > 0 ? (uint256(params.amount), amount) : (amount, uint256(-params.amount));\n\n      (address token0,) = UniswapV2Library.sortTokens(params.tokenIn, params.tokenOut);", "highlightLines": [80]}, "category": "code", "location": {"file": "src/periphery/SwapHelper.sol", "line": 80, "column": 7}, "severity": "info", "references": [], "description": ""}, {"id": "1b01a690618e", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "      (address token0,) = UniswapV2Library.sortTokens(params.tokenIn, params.tokenOut);\n      (uint256 amount0Out, uint256 amount1Out) =\n        params.tokenIn == token0 ? (uint256(0), amountOut) : (amountOut, uint256(0));", "highlightLines": [83]}, "category": "code", "location": {"file": "src/periphery/SwapHelper.sol", "line": 83, "column": 7}, "severity": "info", "references": [], "description": ""}, {"id": "ff6d317119a4", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "      UniV3Data memory uniV3Data = abi.decode(data, (UniV3Data));\n\n      // Borrowed logic from https://github.com/Uniswap/v3-periphery/blob/main/contracts/SwapRouter.sol\n      // exactInputInternal and exactOutputInternal\n\n      bool zeroForOne = params.tokenIn < params.tokenOut;", "highlightLines": [90]}, "category": "code", "location": {"file": "src/periphery/SwapHelper.sol", "line": 90, "column": 7}, "severity": "info", "references": [], "description": ""}, {"id": "ae84febaea3f", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n      bool zeroForOne = params.tokenIn < params.tokenOut;", "highlightLines": [94]}, "category": "code", "location": {"file": "src/periphery/SwapHelper.sol", "line": 94, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "da9db85157ea", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "      bool zeroForOne = params.tokenIn < params.tokenOut;\n\n      IUniswapV3Pool pool = IUniswapV3Pool(\n        PoolAddress.computeAddress(\n          uniswapV3Factory, PoolAddress.getPoolKey(params.tokenIn, params.tokenOut, uniV3Data.fee)\n        )\n      );", "highlightLines": [95]}, "category": "code", "location": {"file": "src/periphery/SwapHelper.sol", "line": 95, "column": 7}, "severity": "info", "references": [], "description": ""}, {"id": "d8a8ed70d3b2", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "      IUniswapV3Pool pool = IUniswapV3Pool(\n        PoolAddress.computeAddress(\n          uniswapV3Factory, PoolAddress.getPoolKey(params.tokenIn, params.tokenOut, uniV3Data.fee)\n        )\n      );\n\n      (int256 amount0, int256 amount1) = pool.swap(\n        params.recipient,\n        zeroForOne,\n        params.amount,\n        zeroForOne ? TickMath.MIN_SQRT_RATIO + 1 : TickMath.MAX_SQRT_RATIO - 1,\n        abi.encode(params.tokenIn)\n      );", "highlightLines": [97]}, "category": "code", "location": {"file": "src/periphery/SwapHelper.sol", "line": 97, "column": 7}, "severity": "info", "references": [], "description": ""}, {"id": "a82d7699f1bf", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "      (int256 amount0, int256 amount1) = pool.swap(\n        params.recipient,\n        zeroForOne,\n        params.amount,\n        zeroForOne ? TickMath.MIN_SQRT_RATIO + 1 : TickMath.MAX_SQRT_RATIO - 1,\n        abi.encode(params.tokenIn)\n      );\n\n      if (params.amount > 0) {\n        amount = uint256(-(zeroForOne ? amount1 : amount0));\n      } else {\n        int256 amountOutReceived;\n        (amount, amountOutReceived) = zeroForOne ? (uint256(amount0), amount1) : (uint256(amount1), amount0);\n        require(amountOutReceived == params.amount);\n      }", "highlightLines": [103]}, "category": "code", "location": {"file": "src/periphery/SwapHelper.sol", "line": 103, "column": 7}, "severity": "info", "references": [], "description": ""}, {"id": "7a80e2264a06", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        int256 amountOutReceived;", "highlightLines": [114]}, "category": "code", "location": {"file": "src/periphery/SwapHelper.sol", "line": 114, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "68bb86ec3c35", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "        (amount, amountOutReceived) = zeroForOne ? (uint256(amount0), amount1) : (uint256(amount1), amount0);", "highlightLines": [115]}, "category": "code", "location": {"file": "src/periphery/SwapHelper.sol", "line": 115, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "6260ef17e2fd", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(amountOutReceived == params.amount);", "highlightLines": [116]}, "category": "code", "location": {"file": "src/periphery/SwapHelper.sol", "line": 116, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "4631056282c5", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event PairCreated(address indexed token0, address indexed token1, address pair, uint256);", "highlightLines": [5]}, "category": "code", "location": {"file": "src/periphery/UniswapV2/interfaces/IUniswapV2Factory.sol", "line": 5, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "751efa28abc6", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function getPair(address tokenA, address tokenB) external view returns (address pair);", "highlightLines": [13]}, "category": "code", "location": {"file": "src/periphery/UniswapV2/interfaces/IUniswapV2Factory.sol", "line": 13, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "8d7953368468", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function createPair(address tokenA, address tokenB) external returns (address pair);", "highlightLines": [19]}, "category": "code", "location": {"file": "src/periphery/UniswapV2/interfaces/IUniswapV2Factory.sol", "line": 19, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "e299aff7c363", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event Approval(address indexed owner, address indexed spender, uint256 value);", "highlightLines": [5]}, "category": "code", "location": {"file": "src/periphery/UniswapV2/interfaces/IUniswapV2Pair.sol", "line": 5, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "cb2f184dc6b5", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event Transfer(address indexed from, address indexed to, uint256 value);", "highlightLines": [6]}, "category": "code", "location": {"file": "src/periphery/UniswapV2/interfaces/IUniswapV2Pair.sol", "line": 6, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "b477897a80ae", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function balanceOf(address owner) external view returns (uint256);", "highlightLines": [16]}, "category": "code", "location": {"file": "src/periphery/UniswapV2/interfaces/IUniswapV2Pair.sol", "line": 16, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "23896158f911", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function allowance(address owner, address spender) external view returns (uint256);", "highlightLines": [18]}, "category": "code", "location": {"file": "src/periphery/UniswapV2/interfaces/IUniswapV2Pair.sol", "line": 18, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "0d9f3aeaf2ce", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function approve(address spender, uint256 value) external returns (bool);", "highlightLines": [20]}, "category": "code", "location": {"file": "src/periphery/UniswapV2/interfaces/IUniswapV2Pair.sol", "line": 20, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "4651c2270bc7", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function transfer(address to, uint256 value) external returns (bool);", "highlightLines": [22]}, "category": "code", "location": {"file": "src/periphery/UniswapV2/interfaces/IUniswapV2Pair.sol", "line": 22, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "fb4b6d74f6d2", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function transferFrom(address from, address to, uint256 value) external returns (bool);", "highlightLines": [24]}, "category": "code", "location": {"file": "src/periphery/UniswapV2/interfaces/IUniswapV2Pair.sol", "line": 24, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "646bfb8560fc", "fix": {"template": null, "available": false}, "title": "Custom function named DOMAIN_SEPARATOR may collide with EIP-712 implementation", "ruleId": "rules.sol-domain-separator-collision", "snippet": {"code": "  function DOMAIN_SEPARATOR() external view returns (bytes32);", "highlightLines": [26]}, "category": "code", "location": {"file": "src/periphery/UniswapV2/interfaces/IUniswapV2Pair.sol", "line": 26, "column": 3}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#domain-separator-collision"], "description": ""}, {"id": "03f903b730fb", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function nonces(address owner) external view returns (uint256);", "highlightLines": [30]}, "category": "code", "location": {"file": "src/periphery/UniswapV2/interfaces/IUniswapV2Pair.sol", "line": 30, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "5abb58d371b0", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function permit(\n    address owner,\n    address spender,\n    uint256 value,\n    uint256 deadline,\n    uint8 v,\n    bytes32 r,\n    bytes32 s\n  )\n    external;", "highlightLines": [32]}, "category": "code", "location": {"file": "src/periphery/UniswapV2/interfaces/IUniswapV2Pair.sol", "line": 32, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "a977b26acd42", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    external;", "highlightLines": [41]}, "category": "code", "location": {"file": "src/periphery/UniswapV2/interfaces/IUniswapV2Pair.sol", "line": 41, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "8bc5cf8dbdab", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event Mint(address indexed sender, uint256 amount0, uint256 amount1);", "highlightLines": [43]}, "category": "code", "location": {"file": "src/periphery/UniswapV2/interfaces/IUniswapV2Pair.sol", "line": 43, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "b89c30b3465b", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event Burn(address indexed sender, uint256 amount0, uint256 amount1, address indexed to);", "highlightLines": [44]}, "category": "code", "location": {"file": "src/periphery/UniswapV2/interfaces/IUniswapV2Pair.sol", "line": 44, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "ff35d345c29b", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event Swap(\n    address indexed sender,\n    uint256 amount0In,\n    uint256 amount1In,\n    uint256 amount0Out,\n    uint256 amount1Out,\n    address indexed to\n  );", "highlightLines": [45]}, "category": "code", "location": {"file": "src/periphery/UniswapV2/interfaces/IUniswapV2Pair.sol", "line": 45, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "69459b9d7c70", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event Swap(\n    address indexed sender,\n    uint256 amount0In,\n    uint256 amount1In,\n    uint256 amount0Out,\n    uint256 amount1Out,\n    address indexed to\n  );", "highlightLines": [45]}, "category": "code", "location": {"file": "src/periphery/UniswapV2/interfaces/IUniswapV2Pair.sol", "line": 45, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "1035ee5da21f", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event Sync(uint112 reserve0, uint112 reserve1);", "highlightLines": [53]}, "category": "code", "location": {"file": "src/periphery/UniswapV2/interfaces/IUniswapV2Pair.sol", "line": 53, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "6eec93abb06c", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "  function mint(address to) external returns (uint256 liquidity);", "highlightLines": [71]}, "category": "code", "location": {"file": "src/periphery/UniswapV2/interfaces/IUniswapV2Pair.sol", "line": 71, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "d33671595cc5", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function mint(address to) external returns (uint256 liquidity);", "highlightLines": [71]}, "category": "code", "location": {"file": "src/periphery/UniswapV2/interfaces/IUniswapV2Pair.sol", "line": 71, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "04800b7bcf80", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "  function burn(address to) external returns (uint256 amount0, uint256 amount1);", "highlightLines": [73]}, "category": "code", "location": {"file": "src/periphery/UniswapV2/interfaces/IUniswapV2Pair.sol", "line": 73, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "de5c4bf812ae", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function burn(address to) external returns (uint256 amount0, uint256 amount1);", "highlightLines": [73]}, "category": "code", "location": {"file": "src/periphery/UniswapV2/interfaces/IUniswapV2Pair.sol", "line": 73, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "a639a4883070", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function skim(address to) external;", "highlightLines": [77]}, "category": "code", "location": {"file": "src/periphery/UniswapV2/interfaces/IUniswapV2Pair.sol", "line": 77, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "2532470875ee", "fix": {"template": null, "available": false}, "title": "Initialization function can be front-run - use initializer modifier or constructor", "ruleId": "rules.sol-initialization-frontrun", "snippet": {"code": "  function initialize(address, address) external;", "highlightLines": [81]}, "category": "code", "location": {"file": "src/periphery/UniswapV2/interfaces/IUniswapV2Pair.sol", "line": 81, "column": 3}, "severity": "high", "references": [], "description": ""}, {"id": "65777ae72da6", "fix": {"template": null, "available": false}, "title": "Clone/minimal proxy initializer without protection - can be front-run and hijacked", "ruleId": "rules.sol-unprotected-clone-initializer", "snippet": {"code": "  function initialize(address, address) external;", "highlightLines": [81]}, "category": "code", "location": {"file": "src/periphery/UniswapV2/interfaces/IUniswapV2Pair.sol", "line": 81, "column": 3}, "severity": "high", "references": ["https://blog.openzeppelin.com/security-advisory-initialize-uups-implementation-contracts"], "description": ""}, {"id": "f4b234432495", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "  function pairFor(address factory, address tokenA, address tokenB) internal pure returns (address pair) {\n    (address token0, address token1) = sortTokens(tokenA, tokenB);\n    pair = address(", "highlightLines": [17]}, "category": "code", "location": {"file": "src/periphery/UniswapV2/libraries/UniswapV2Library.sol", "line": 17, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "8de1a26be2d4", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    (address token0, address token1) = sortTokens(tokenA, tokenB);\n    pair = address(\n      uint160( // extra cast for newer solidity\n        uint256(\n          keccak256(\n            abi.encodePacked(\n              hex\"ff\",\n              factory,\n              keccak256(abi.encodePacked(token0, token1)),\n              hex\"e18a34eb0e04b04f7a0ac29a6e80748dca96319b42c54d679cb821dca90c6303\" // init code hash\n            )\n          )\n        )\n      )\n    );", "highlightLines": [18]}, "category": "code", "location": {"file": "src/periphery/UniswapV2/libraries/UniswapV2Library.sol", "line": 18, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "20e8415029ad", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "          keccak256(\n            abi.encodePacked(\n              hex\"ff\",\n              factory,\n              keccak256(abi.encodePacked(token0, token1)),\n              hex\"e18a34eb0e04b04f7a0ac29a6e80748dca96319b42c54d679cb821dca90c6303\" // init code hash\n            )\n          )", "highlightLines": [22]}, "category": "code", "location": {"file": "src/periphery/UniswapV2/libraries/UniswapV2Library.sol", "line": 22, "column": 11}, "severity": "high", "references": [], "description": ""}, {"id": "2d8208c6f883", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "            abi.encodePacked(\n              hex\"ff\",\n              factory,\n              keccak256(abi.encodePacked(token0, token1)),\n              hex\"e18a34eb0e04b04f7a0ac29a6e80748dca96319b42c54d679cb821dca90c6303\" // init code hash\n            )", "highlightLines": [23]}, "category": "code", "location": {"file": "src/periphery/UniswapV2/libraries/UniswapV2Library.sol", "line": 23, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "648b6201076a", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "              keccak256(abi.encodePacked(token0, token1)),", "highlightLines": [26]}, "category": "code", "location": {"file": "src/periphery/UniswapV2/libraries/UniswapV2Library.sol", "line": 26, "column": 15}, "severity": "high", "references": [], "description": ""}, {"id": "e0f1a8bd792c", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "              keccak256(abi.encodePacked(token0, token1)),", "highlightLines": [26]}, "category": "code", "location": {"file": "src/periphery/UniswapV2/libraries/UniswapV2Library.sol", "line": 26, "column": 25}, "severity": "medium", "references": [], "description": ""}, {"id": "f17affa575c2", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "  function getReserves(\n    address factory,\n    address tokenA,\n    address tokenB\n  )\n    internal\n    view\n    returns (uint256 reserveA, uint256 reserveB)\n  {\n    (address token0,) = sortTokens(tokenA, tokenB);\n    (uint256 reserve0, uint256 reserve1,) = IUniswapV2Pair(pairFor(factory, tokenA, tokenB)).getReserves();\n    (reserveA, reserveB) = tokenA == token0 ? (reserve0, reserve1) : (reserve1, reserve0);", "highlightLines": [36]}, "category": "code", "location": {"file": "src/periphery/UniswapV2/libraries/UniswapV2Library.sol", "line": 36, "column": 3}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "0800cb012c3b", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    (address token0,) = sortTokens(tokenA, tokenB);\n    (uint256 reserve0, uint256 reserve1,) = IUniswapV2Pair(pairFor(factory, tokenA, tokenB)).getReserves();", "highlightLines": [45]}, "category": "code", "location": {"file": "src/periphery/UniswapV2/libraries/UniswapV2Library.sol", "line": 45, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "2c8152c3d7cd", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    (uint256 reserve0, uint256 reserve1,) = IUniswapV2Pair(pairFor(factory, tokenA, tokenB)).getReserves();\n    (reserveA, reserveB) = tokenA == token0 ? (reserve0, reserve1) : (reserve1, reserve0);", "highlightLines": [46]}, "category": "code", "location": {"file": "src/periphery/UniswapV2/libraries/UniswapV2Library.sol", "line": 46, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "2decee35d36f", "fix": {"template": null, "available": false}, "title": "Using spot price from AMM for valuation - flash loan manipulation possible", "ruleId": "rules.sol-amm-spot-price-usage", "snippet": {"code": "    (uint256 reserve0, uint256 reserve1,) = IUniswapV2Pair(pairFor(factory, tokenA, tokenB)).getReserves();", "highlightLines": [46]}, "category": "code", "location": {"file": "src/periphery/UniswapV2/libraries/UniswapV2Library.sol", "line": 46, "column": 45}, "severity": "high", "references": [], "description": ""}, {"id": "06cf03e1480e", "fix": {"template": null, "available": false}, "title": "Single-block price oracle - vulnerable to flash loan manipulation", "ruleId": "rules.sol-basic-oracle-manipulation", "snippet": {"code": "    (uint256 reserve0, uint256 reserve1,) = IUniswapV2Pair(pairFor(factory, tokenA, tokenB)).getReserves();", "highlightLines": [46]}, "category": "code", "location": {"file": "src/periphery/UniswapV2/libraries/UniswapV2Library.sol", "line": 46, "column": 45}, "severity": "medium", "references": ["https://www.paradigm.xyz/2020/11/so-you-want-to-use-a-price-oracle"], "description": ""}, {"id": "a314f07d5d70", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "  function getAmountOut(\n    uint256 amountIn,\n    uint256 reserveIn,\n    uint256 reserveOut\n  )\n    internal\n    pure\n    returns (uint256 amountOut)\n  {\n    require(amountIn > 0, \"UniswapV2Library: INSUFFICIENT_INPUT_AMOUNT\");\n    require(reserveIn > 0 && reserveOut > 0, \"UniswapV2Library: INSUFFICIENT_LIQUIDITY\");\n    uint256 amountInWithFee = amountIn * 997;\n    uint256 numerator = amountInWithFee * reserveOut;\n    uint256 denominator = (reserveIn * 1000) + amountInWithFee;\n    amountOut = numerator / denominator;", "highlightLines": [51]}, "category": "code", "location": {"file": "src/periphery/UniswapV2/libraries/UniswapV2Library.sol", "line": 51, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "71812ad18901", "fix": {"template": null, "available": false}, "title": "Price derived from single block data - vulnerable to flash loan manipulation", "ruleId": "rules.sol-price-manipulation-single-block", "snippet": {"code": "  function getAmountOut(", "highlightLines": [51]}, "category": "code", "location": {"file": "src/periphery/UniswapV2/libraries/UniswapV2Library.sol", "line": 51, "column": 12}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "6f113dab667e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 amountInWithFee = amountIn * 997;", "highlightLines": [62]}, "category": "code", "location": {"file": "src/periphery/UniswapV2/libraries/UniswapV2Library.sol", "line": 62, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "46b8e8a7c94a", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 amountInWithFee = amountIn * 997;\n    uint256 numerator = amountInWithFee * reserveOut;", "highlightLines": [62]}, "category": "code", "location": {"file": "src/periphery/UniswapV2/libraries/UniswapV2Library.sol", "line": 62, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "bbf193e8f2a0", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 numerator = amountInWithFee * reserveOut;", "highlightLines": [63]}, "category": "code", "location": {"file": "src/periphery/UniswapV2/libraries/UniswapV2Library.sol", "line": 63, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3b9deb026057", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 numerator = amountInWithFee * reserveOut;\n    uint256 denominator = (reserveIn * 1000) + amountInWithFee;", "highlightLines": [63]}, "category": "code", "location": {"file": "src/periphery/UniswapV2/libraries/UniswapV2Library.sol", "line": 63, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "5b6ac525862a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 denominator = (reserveIn * 1000) + amountInWithFee;", "highlightLines": [64]}, "category": "code", "location": {"file": "src/periphery/UniswapV2/libraries/UniswapV2Library.sol", "line": 64, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "66ecc5465da7", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 denominator = (reserveIn * 1000) + amountInWithFee;\n    amountOut = numerator / denominator;", "highlightLines": [64]}, "category": "code", "location": {"file": "src/periphery/UniswapV2/libraries/UniswapV2Library.sol", "line": 64, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "5b0fb1907d54", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "  function getAmountIn(\n    uint256 amountOut,\n    uint256 reserveIn,\n    uint256 reserveOut\n  )\n    internal\n    pure\n    returns (uint256 amountIn)\n  {\n    require(amountOut > 0, \"UniswapV2Library: INSUFFICIENT_OUTPUT_AMOUNT\");\n    require(reserveIn > 0 && reserveOut > 0, \"UniswapV2Library: INSUFFICIENT_LIQUIDITY\");\n    uint256 numerator = reserveIn * amountOut * 1000;\n    uint256 denominator = (reserveOut - amountOut) * 997;\n    amountIn = (numerator / denominator) + 1;", "highlightLines": [69]}, "category": "code", "location": {"file": "src/periphery/UniswapV2/libraries/UniswapV2Library.sol", "line": 69, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "8c831e871234", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 numerator = reserveIn * amountOut * 1000;", "highlightLines": [80]}, "category": "code", "location": {"file": "src/periphery/UniswapV2/libraries/UniswapV2Library.sol", "line": 80, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c361613c89fc", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 numerator = reserveIn * amountOut * 1000;\n    uint256 denominator = (reserveOut - amountOut) * 997;", "highlightLines": [80]}, "category": "code", "location": {"file": "src/periphery/UniswapV2/libraries/UniswapV2Library.sol", "line": 80, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "4db690613126", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 denominator = (reserveOut - amountOut) * 997;", "highlightLines": [81]}, "category": "code", "location": {"file": "src/periphery/UniswapV2/libraries/UniswapV2Library.sol", "line": 81, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "fa7a9310379a", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 denominator = (reserveOut - amountOut) * 997;\n    amountIn = (numerator / denominator) + 1;", "highlightLines": [81]}, "category": "code", "location": {"file": "src/periphery/UniswapV2/libraries/UniswapV2Library.sol", "line": 81, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "d4f9a9a9933d", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event OwnerChanged(address indexed oldOwner, address indexed newOwner);", "highlightLines": [10]}, "category": "code", "location": {"file": "src/periphery/UniswapV3/interfaces/IUniswapV3Factory.sol", "line": 10, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "30f64f170642", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event PoolCreated(\n    address indexed token0, address indexed token1, uint24 indexed fee, int24 tickSpacing, address pool\n  );", "highlightLines": [18]}, "category": "code", "location": {"file": "src/periphery/UniswapV3/interfaces/IUniswapV3Factory.sol", "line": 18, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "28aa9ab9532a", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event PoolCreated(\n    address indexed token0, address indexed token1, uint24 indexed fee, int24 tickSpacing, address pool\n  );", "highlightLines": [18]}, "category": "code", "location": {"file": "src/periphery/UniswapV3/interfaces/IUniswapV3Factory.sol", "line": 18, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "c92c1654af4c", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function getPool(address tokenA, address tokenB, uint24 fee) external view returns (address pool);", "highlightLines": [44]}, "category": "code", "location": {"file": "src/periphery/UniswapV3/interfaces/IUniswapV3Factory.sol", "line": 44, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "3673e5e6111d", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function createPool(address tokenA, address tokenB, uint24 fee) external returns (address pool);", "highlightLines": [54]}, "category": "code", "location": {"file": "src/periphery/UniswapV3/interfaces/IUniswapV3Factory.sol", "line": 54, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "d2385335e741", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "  function setOwner(address _owner) external;", "highlightLines": [59]}, "category": "code", "location": {"file": "src/periphery/UniswapV3/interfaces/IUniswapV3Factory.sol", "line": 59, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "82f590a570be", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function setOwner(address _owner) external;", "highlightLines": [59]}, "category": "code", "location": {"file": "src/periphery/UniswapV3/interfaces/IUniswapV3Factory.sol", "line": 59, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "5c6a1dd545fe", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/periphery/interfaces/IMulticall.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "f4b895c27264", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/periphery/interfaces/ISelfPermit.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "dbbd94db0c72", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function selfPermit(address token, uint256 value, uint256 deadline, uint8 v, bytes32 r, bytes32 s) external payable;", "highlightLines": [13]}, "category": "code", "location": {"file": "src/periphery/interfaces/ISelfPermit.sol", "line": 13, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "c86ff26ca7d4", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function selfPermitAllowed(\n    address token,\n    uint256 nonce,\n    uint256 expiry,\n    uint8 v,\n    bytes32 r,\n    bytes32 s\n  )\n    external\n    payable;", "highlightLines": [23]}, "category": "code", "location": {"file": "src/periphery/interfaces/ISelfPermit.sol", "line": 23, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "4889c8183381", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    payable;", "highlightLines": [32]}, "category": "code", "location": {"file": "src/periphery/interfaces/ISelfPermit.sol", "line": 32, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "a5b32c3b4292", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    71_695_300_681_742_793_458_567_320_549_603_773_755_938_496_017_772_337_363_704_152_556_600_186_974;", "highlightLines": [7]}, "category": "code", "location": {"file": "src/periphery/libraries/LendgineAddress.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "45b8cb20b2b5", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "  function computeAddress(\n    address factory,\n    address token0,\n    address token1,\n    uint256 token0Exp,\n    uint256 token1Exp,\n    uint256 upperBound\n  )\n    internal\n    pure\n    returns (address lendgine)\n  {\n    lendgine = address(", "highlightLines": [9]}, "category": "code", "location": {"file": "src/periphery/libraries/LendgineAddress.sol", "line": 9, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "88a9c695d933", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "          keccak256(\n            abi.encodePacked(\n              hex\"ff\",\n              factory,\n              keccak256(abi.encode(token0, token1, token0Exp, token1Exp, upperBound)),\n              bytes32(INIT_CODE_HASH)\n            )\n          )", "highlightLines": [24]}, "category": "code", "location": {"file": "src/periphery/libraries/LendgineAddress.sol", "line": 24, "column": 11}, "severity": "high", "references": [], "description": ""}, {"id": "4daf4df4e8b7", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "            abi.encodePacked(\n              hex\"ff\",\n              factory,\n              keccak256(abi.encode(token0, token1, token0Exp, token1Exp, upperBound)),\n              bytes32(INIT_CODE_HASH)\n            )", "highlightLines": [25]}, "category": "code", "location": {"file": "src/periphery/libraries/LendgineAddress.sol", "line": 25, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "ff989fbed7f7", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "              keccak256(abi.encode(token0, token1, token0Exp, token1Exp, upperBound)),", "highlightLines": [28]}, "category": "code", "location": {"file": "src/periphery/libraries/LendgineAddress.sol", "line": 28, "column": 15}, "severity": "high", "references": [], "description": ""}, {"id": "ae882f3f30c2", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "test/utils/mocks/MockERC20.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "ff82fae03074", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  constructor() ERC20() { }", "highlightLines": [7]}, "category": "code", "location": {"file": "test/utils/mocks/MockERC20.sol", "line": 7, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "c7b595347825", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "  function mint(address to, uint256 value) public virtual {", "highlightLines": [9]}, "category": "code", "location": {"file": "test/utils/mocks/MockERC20.sol", "line": 9, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "8f8dfddf0545", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "  function mint(address to, uint256 value) public virtual {", "highlightLines": [9]}, "category": "code", "location": {"file": "test/utils/mocks/MockERC20.sol", "line": 9, "column": 3}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "31d6bc30c493", "fix": {"template": null, "available": false}, "title": "NFT mint without supply check - potential overflow in tokenId", "ruleId": "rules.sol-nft-overflow-mint", "snippet": {"code": "    _mint(to, value);", "highlightLines": [10]}, "category": "code", "location": {"file": "test/utils/mocks/MockERC20.sol", "line": 10, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "8ab04ef427f9", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "  function burn(address from, uint256 value) public virtual {", "highlightLines": [13]}, "category": "code", "location": {"file": "test/utils/mocks/MockERC20.sol", "line": 13, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "e41bde4b77b5", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "  function burn(address from, uint256 value) public virtual {", "highlightLines": [13]}, "category": "code", "location": {"file": "test/utils/mocks/MockERC20.sol", "line": 13, "column": 3}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "cffd72fc7a2e", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event Transfer(address indexed from, address indexed to, uint256 amount);", "highlightLines": [15]}, "category": "code", "location": {"file": "src/core/ERC20.sol", "line": 15, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "4fab00b0f62d", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event Approval(address indexed owner, address indexed spender, uint256 amount);", "highlightLines": [17]}, "category": "code", "location": {"file": "src/core/ERC20.sol", "line": 17, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "885ce15ed6f8", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  constructor() {\n    INITIAL_CHAIN_ID = block.chainid;\n    INITIAL_DOMAIN_SEPARATOR = computeDomainSeparator();\n  }", "highlightLines": [56]}, "category": "code", "location": {"file": "src/core/ERC20.sol", "line": 56, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "aa96ee8d8694", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    INITIAL_CHAIN_ID = block.chainid;\n    INITIAL_DOMAIN_SEPARATOR = computeDomainSeparator();", "highlightLines": [57]}, "category": "code", "location": {"file": "src/core/ERC20.sol", "line": 57, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "a5aee18f09fa", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "  function approve(address spender, uint256 amount) external virtual returns (bool) {", "highlightLines": [66]}, "category": "code", "location": {"file": "src/core/ERC20.sol", "line": 66, "column": 3}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "02822ec13c25", "fix": {"template": null, "available": false}, "title": "Oracle price update without deviation check - prices can change arbitrarily (Compromised pattern)", "ruleId": "rules.sol-oracle-no-price-deviation-check", "snippet": {"code": "    allowance[msg.sender][spender] = amount;", "highlightLines": [67]}, "category": "code", "location": {"file": "src/core/ERC20.sol", "line": 67, "column": 5}, "severity": "medium", "references": ["https://www.damnvulnerabledefi.xyz/challenges/compromised/"], "description": ""}, {"id": "fd5c9aa23de8", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "  function transfer(address to, uint256 amount) external virtual returns (bool) {", "highlightLines": [75]}, "category": "code", "location": {"file": "src/core/ERC20.sol", "line": 75, "column": 3}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "406c9235ae4a", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without msg.data.length validation - vulnerable to short address attack padding", "ruleId": "rules.sol-short-address-no-payload-check", "snippet": {"code": "  function transfer(address to, uint256 amount) external virtual returns (bool) {", "highlightLines": [75]}, "category": "code", "location": {"file": "src/core/ERC20.sol", "line": 75, "column": 3}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address", "https://vessenes.com/the-erc20-short-address-attack-explained/"], "description": ""}, {"id": "92491ed96524", "fix": {"template": null, "available": false}, "title": "ERC20 transferFrom without payload size validation - consider adding onlyPayloadSize modifier", "ruleId": "rules.sol-erc20-missing-payload-modifier", "snippet": {"code": "  function transferFrom(address from, address to, uint256 amount) external virtual returns (bool) {", "highlightLines": [90]}, "category": "code", "location": {"file": "src/core/ERC20.sol", "line": 90, "column": 3}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address"], "description": ""}, {"id": "be6132ac4eae", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "  function transferFrom(address from, address to, uint256 amount) external virtual returns (bool) {", "highlightLines": [90]}, "category": "code", "location": {"file": "src/core/ERC20.sol", "line": 90, "column": 3}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "e49e21231412", "fix": {"template": null, "available": false}, "title": "NFT transfer without approval/ownership check - add _isApprovedOrOwner validation", "ruleId": "rules.sol-nft-transfer-no-approval-check", "snippet": {"code": "  function transferFrom(address from, address to, uint256 amount) external virtual returns (bool) {", "highlightLines": [90]}, "category": "code", "location": {"file": "src/core/ERC20.sol", "line": 90, "column": 3}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/NFT-transfer.sol"], "description": ""}, {"id": "2994ddc7160c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 allowed = allowance[from][msg.sender]; // Saves gas for limited approvals.", "highlightLines": [91]}, "category": "code", "location": {"file": "src/core/ERC20.sol", "line": 91, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "182d644a121f", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 allowed = allowance[from][msg.sender]; // Saves gas for limited approvals.\n\n    if (allowed != type(uint256).max) allowance[from][msg.sender] = allowed - amount;", "highlightLines": [91]}, "category": "code", "location": {"file": "src/core/ERC20.sol", "line": 91, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "b22712615002", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "    require(deadline >= block.timestamp, \"PERMIT_DEADLINE_EXPIRED\");", "highlightLines": [124]}, "category": "code", "location": {"file": "src/core/ERC20.sol", "line": 124, "column": 25}, "severity": "medium", "references": [], "description": ""}, {"id": "b9e3891e4cb9", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "      bytes32 digest = keccak256(", "highlightLines": [129]}, "category": "code", "location": {"file": "src/core/ERC20.sol", "line": 129, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "2da56b675c38", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "      bytes32 digest = keccak256(\n        abi.encodePacked(\n          \"\\x19\\x01\",\n          DOMAIN_SEPARATOR(),\n          keccak256(abi.encode(PERMIT_TYPEHASH, owner, spender, value, nonces[owner]++, deadline))\n        )\n      );\n\n      address recoveredAddress = ecrecover(digest, v, r, s);", "highlightLines": [129]}, "category": "code", "location": {"file": "src/core/ERC20.sol", "line": 129, "column": 7}, "severity": "info", "references": [], "description": ""}, {"id": "5b26ac7d6126", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "      bytes32 digest = keccak256(\n        abi.encodePacked(\n          \"\\x19\\x01\",\n          DOMAIN_SEPARATOR(),\n          keccak256(abi.encode(PERMIT_TYPEHASH, owner, spender, value, nonces[owner]++, deadline))\n        )\n      );", "highlightLines": [129]}, "category": "code", "location": {"file": "src/core/ERC20.sol", "line": 129, "column": 24}, "severity": "high", "references": [], "description": ""}, {"id": "aca0ef0febc4", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "        abi.encodePacked(\n          \"\\x19\\x01\",\n          DOMAIN_SEPARATOR(),\n          keccak256(abi.encode(PERMIT_TYPEHASH, owner, spender, value, nonces[owner]++, deadline))\n        )", "highlightLines": [130]}, "category": "code", "location": {"file": "src/core/ERC20.sol", "line": 130, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "9c4202d068d3", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "          keccak256(abi.encode(PERMIT_TYPEHASH, owner, spender, value, nonces[owner]++, deadline))", "highlightLines": [133]}, "category": "code", "location": {"file": "src/core/ERC20.sol", "line": 133, "column": 11}, "severity": "high", "references": [], "description": ""}, {"id": "f9dce065c62a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n      address recoveredAddress = ecrecover(digest, v, r, s);", "highlightLines": [136]}, "category": "code", "location": {"file": "src/core/ERC20.sol", "line": 136, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8b0539436dbe", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "      address recoveredAddress = ecrecover(digest, v, r, s);\n\n      require(recoveredAddress != address(0) && recoveredAddress == owner, \"INVALID_SIGNER\");\n\n      allowance[recoveredAddress][spender] = value;", "highlightLines": [137]}, "category": "code", "location": {"file": "src/core/ERC20.sol", "line": 137, "column": 7}, "severity": "info", "references": [], "description": ""}, {"id": "e5d26cce87bd", "fix": {"template": null, "available": false}, "title": "ecrecover is vulnerable to signature malleability - use OpenZeppelin ECDSA", "ruleId": "rules.sol-ecrecover-malleable", "snippet": {"code": "      address recoveredAddress = ecrecover(digest, v, r, s);", "highlightLines": [137]}, "category": "code", "location": {"file": "src/core/ERC20.sol", "line": 137, "column": 34}, "severity": "medium", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/utils/cryptography/ECDSA.sol"], "description": ""}, {"id": "eafa375a4cdd", "fix": {"template": null, "available": false}, "title": "ECDSA signature without s-value check - signature malleability possible", "ruleId": "rules.sol-signature-malleability", "snippet": {"code": "      address recoveredAddress = ecrecover(digest, v, r, s);", "highlightLines": [137]}, "category": "code", "location": {"file": "src/core/ERC20.sol", "line": 137, "column": 34}, "severity": "medium", "references": [], "description": ""}, {"id": "feca8cf6fede", "fix": {"template": null, "available": false}, "title": "Signature verification without domain separator - cross-contract replay possible", "ruleId": "rules.sol-signature-no-domain-separator", "snippet": {"code": "      address recoveredAddress = ecrecover(digest, v, r, s);", "highlightLines": [137]}, "category": "code", "location": {"file": "src/core/ERC20.sol", "line": 137, "column": 34}, "severity": "medium", "references": [], "description": ""}, {"id": "5dc221167bd2", "fix": {"template": null, "available": false}, "title": "Custom function named DOMAIN_SEPARATOR may collide with EIP-712 implementation", "ruleId": "rules.sol-domain-separator-collision", "snippet": {"code": "  function DOMAIN_SEPARATOR() public view virtual returns (bytes32) {", "highlightLines": [147]}, "category": "code", "location": {"file": "src/core/ERC20.sol", "line": 147, "column": 3}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#domain-separator-collision"], "description": ""}, {"id": "df260e27e821", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.4;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "4f4130caef67", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "abstract contract Pair is ImmutableState, ReentrancyGuard, IPair {", "highlightLines": [16]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 16, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "c1efe2a7f6c7", "fix": {"template": null, "available": false}, "title": "Base constructor called multiple times through diamond inheritance - may initialize twice", "ruleId": "rules.sol-reused-constructor", "snippet": {"code": "abstract contract Pair is ImmutableState, ReentrancyGuard, IPair {", "highlightLines": [16]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 16, "column": 10}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#reused-base-constructor"], "description": ""}, {"id": "da5d191bcc12", "fix": {"template": null, "available": false}, "title": "SWC-125: Multiple inheritance may cause incorrect function resolution - check C3 linearization", "ruleId": "rules.sol-swc-125-inheritance-order", "snippet": {"code": "abstract contract Pair is ImmutableState, ReentrancyGuard, IPair {", "highlightLines": [16]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 16, "column": 10}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-125"], "description": ""}, {"id": "fe0e63c7db57", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "abstract contract Pair is ImmutableState, ReentrancyGuard, IPair {\n  /*//////////////////////////////////////////////////////////////\n                                 EVENTS\n    //////////////////////////////////////////////////////////////*/\n\n  event Mint(uint256 amount0In, uint256 amount1In, uint256 liquidity);\n\n  event Burn(uint256 amount0Out, uint256 amount1Out, uint256 liquidity, address indexed to);\n\n  event Swap(uint256 amount0Out, uint256 amount1Out, uint256 amount0In, uint256 amount1In, address indexed to);\n\n  /*//////////////////////////////////////////////////////////////\n                                 ERRORS\n    //////////////////////////////////////////////////////////////*/\n\n  error InvariantError();\n\n  error InsufficientOutputError();\n\n  /*//////////////////////////////////////////////////////////////\n                                 STORAGE\n    //////////////////////////////////////////////////////////////*/\n\n  /// @inheritdoc IPair\n  uint120 public override reserve0;\n\n  /// @inheritdoc IPair\n  uint120 public override reserve1;\n\n  /// @inheritdoc IPair\n  uint256 public override totalLiquidity;\n\n  /*//////////////////////////////////////////////////////////////\n                              PAIR LOGIC\n    //////////////////////////////////////////////////////////////*/\n\n  /// @inheritdoc IPair\n  function invariant(uint256 amount0, uint256 amount1, uint256 liquidity) public view override returns (bool) {\n    if (liquidity == 0) return (amount0 == 0 && amount1 == 0);\n\n    uint256 scale0 = FullMath.mulDiv(amount0, 1e18, liquidity) * token0Scale;\n    uint256 scale1 = FullMath.mulDiv(amount1, 1e18, liquidity) * token1Scale;\n\n    if (scale1 > 2 * upperBound) revert InvariantError();\n\n    uint256 a = scale0 * 1e18;\n    uint256 b = scale1 * upperBound;\n    uint256 c = (scale1 * scale1) / 4;\n    uint256 d = upperBound * upperBound;", "highlightLines": [16]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 16, "column": 10}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "49fb62f8005a", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event Mint(uint256 amount0In, uint256 amount1In, uint256 liquidity);", "highlightLines": [21]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 21, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "e098eac4a9b4", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "  function invariant(uint256 amount0, uint256 amount1, uint256 liquidity) public view override returns (bool) {\n    if (liquidity == 0) return (amount0 == 0 && amount1 == 0);", "highlightLines": [53]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 53, "column": 3}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "f695cf5aed46", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "  function invariant(uint256 amount0, uint256 amount1, uint256 liquidity) public view override returns (bool) {\n    if (liquidity == 0) return (amount0 == 0 && amount1 == 0);\n\n    uint256 scale0 = FullMath.mulDiv(amount0, 1e18, liquidity) * token0Scale;\n    uint256 scale1 = FullMath.mulDiv(amount1, 1e18, liquidity) * token1Scale;\n\n    if (scale1 > 2 * upperBound) revert InvariantError();\n\n    uint256 a = scale0 * 1e18;\n    uint256 b = scale1 * upperBound;\n    uint256 c = (scale1 * scale1) / 4;\n    uint256 d = upperBound * upperBound;", "highlightLines": [53]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 53, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "8d270c848155", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "    if (liquidity == 0) return (amount0 == 0 && amount1 == 0);\n\n    uint256 scale0 = FullMath.mulDiv(amount0, 1e18, liquidity) * token0Scale;", "highlightLines": [54]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 54, "column": 25}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "13c5b88504c0", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 scale0 = FullMath.mulDiv(amount0, 1e18, liquidity) * token0Scale;", "highlightLines": [55]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 55, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "dd7fc724ad61", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 scale0 = FullMath.mulDiv(amount0, 1e18, liquidity) * token0Scale;\n    uint256 scale1 = FullMath.mulDiv(amount1, 1e18, liquidity) * token1Scale;", "highlightLines": [56]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 56, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "afb95d367457", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    uint256 scale0 = FullMath.mulDiv(amount0, 1e18, liquidity) * token0Scale;", "highlightLines": [56]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 56, "column": 47}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "1b2a5b9f2235", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 scale1 = FullMath.mulDiv(amount1, 1e18, liquidity) * token1Scale;", "highlightLines": [57]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 57, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "dbcb2acca262", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 scale1 = FullMath.mulDiv(amount1, 1e18, liquidity) * token1Scale;\n\n    if (scale1 > 2 * upperBound) revert InvariantError();\n\n    uint256 a = scale0 * 1e18;", "highlightLines": [57]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 57, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "c6d33ff9acdc", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    uint256 scale1 = FullMath.mulDiv(amount1, 1e18, liquidity) * token1Scale;", "highlightLines": [57]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 57, "column": 47}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "9be95b6791fe", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 a = scale0 * 1e18;", "highlightLines": [60]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 60, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e23db2a610a1", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 a = scale0 * 1e18;\n    uint256 b = scale1 * upperBound;", "highlightLines": [61]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 61, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "647c0af6849e", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimal assumption - tokens with >18 or <18 decimals will cause overflow/underflow", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    uint256 a = scale0 * 1e18;", "highlightLines": [61]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 61, "column": 24}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20"], "description": ""}, {"id": "ea43455790a7", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    uint256 a = scale0 * 1e18;", "highlightLines": [61]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 61, "column": 26}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "66eb1c9af087", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 b = scale1 * upperBound;", "highlightLines": [62]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 62, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ca582ec50f69", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 b = scale1 * upperBound;\n    uint256 c = (scale1 * scale1) / 4;", "highlightLines": [62]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 62, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "01f2f3c4e1c2", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 c = (scale1 * scale1) / 4;", "highlightLines": [63]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 63, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "29fa43a93180", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 c = (scale1 * scale1) / 4;\n    uint256 d = upperBound * upperBound;", "highlightLines": [63]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 63, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "6d0d4c5c5a71", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 d = upperBound * upperBound;", "highlightLines": [64]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 64, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "6473cf6ba505", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "  function mint(uint256 liquidity, bytes calldata data) internal {", "highlightLines": [70]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 70, "column": 3}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "c5b053053d32", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint120 _reserve0 = reserve0; // SLOAD", "highlightLines": [71]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 71, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "335280f9f4f4", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint120 _reserve0 = reserve0; // SLOAD\n    uint120 _reserve1 = reserve1; // SLOAD", "highlightLines": [71]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 71, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "eff3835f9b4d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint120 _reserve1 = reserve1; // SLOAD", "highlightLines": [72]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 72, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3b67e7b5a2ab", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint120 _reserve1 = reserve1; // SLOAD\n    uint256 _totalLiquidity = totalLiquidity; // SLOAD", "highlightLines": [72]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 72, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "dfc1ee8ba4e7", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 _totalLiquidity = totalLiquidity; // SLOAD", "highlightLines": [73]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 73, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "60ac71eec48a", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 _totalLiquidity = totalLiquidity; // SLOAD\n\n    uint256 balance0Before = Balance.balance(token0);", "highlightLines": [73]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 73, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "a63ad792f91e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 balance0Before = Balance.balance(token0);", "highlightLines": [74]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 74, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "5f72bdc64f72", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "    uint256 balance0Before = Balance.balance(token0);\n    uint256 balance1Before = Balance.balance(token1);", "highlightLines": [75]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 75, "column": 5}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "1b58969b931a", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 balance0Before = Balance.balance(token0);\n    uint256 balance1Before = Balance.balance(token1);", "highlightLines": [75]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 75, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "f0bfcba6faef", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 balance1Before = Balance.balance(token1);", "highlightLines": [76]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 76, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "39d86d5b4215", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 balance1Before = Balance.balance(token1);\n    IPairMintCallback(msg.sender).pairMintCallback(liquidity, data);\n    uint256 amount0In = Balance.balance(token0) - balance0Before;", "highlightLines": [76]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 76, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "5e22bba9d9a2", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 amount0In = Balance.balance(token0) - balance0Before;", "highlightLines": [78]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 78, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e9f79b9459bc", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 amount0In = Balance.balance(token0) - balance0Before;\n    uint256 amount1In = Balance.balance(token1) - balance1Before;", "highlightLines": [78]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 78, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "57c077c05ffc", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 amount1In = Balance.balance(token1) - balance1Before;", "highlightLines": [79]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 79, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "cb2ebff39a27", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 amount1In = Balance.balance(token1) - balance1Before;\n\n    if (!invariant(_reserve0 + amount0In, _reserve1 + amount1In, _totalLiquidity + liquidity)) {\n      revert InvariantError();\n    }\n\n    reserve0 = _reserve0 + SafeCast.toUint120(amount0In); // SSTORE", "highlightLines": [79]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 79, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "cb96f5614e10", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    reserve0 = _reserve0 + SafeCast.toUint120(amount0In); // SSTORE\n    reserve1 = _reserve1 + SafeCast.toUint120(amount1In); // SSTORE", "highlightLines": [85]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 85, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "5b927a0a10e4", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    reserve1 = _reserve1 + SafeCast.toUint120(amount1In); // SSTORE\n    totalLiquidity = _totalLiquidity + liquidity; // SSTORE", "highlightLines": [86]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 86, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "f62210cb8e92", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint120 _reserve0 = reserve0; // SLOAD", "highlightLines": [94]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 94, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ea857c960bcd", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint120 _reserve0 = reserve0; // SLOAD\n    uint120 _reserve1 = reserve1; // SLOAD", "highlightLines": [94]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 94, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "e96528b82b7a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint120 _reserve1 = reserve1; // SLOAD", "highlightLines": [95]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 95, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "1fe52c42e6fe", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint120 _reserve1 = reserve1; // SLOAD\n    uint256 _totalLiquidity = totalLiquidity; // SLOAD", "highlightLines": [95]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 95, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "8251bf33fb4f", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 _totalLiquidity = totalLiquidity; // SLOAD", "highlightLines": [96]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 96, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "772ecfa03dcf", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 _totalLiquidity = totalLiquidity; // SLOAD\n\n    amount0 = FullMath.mulDiv(_reserve0, liquidity, _totalLiquidity);", "highlightLines": [96]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 96, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "807d83bd09df", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "    amount0 = FullMath.mulDiv(_reserve0, liquidity, _totalLiquidity);\n    amount1 = FullMath.mulDiv(_reserve1, liquidity, _totalLiquidity);", "highlightLines": [98]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 98, "column": 5}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "56bbcf8d54b5", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    amount0 = FullMath.mulDiv(_reserve0, liquidity, _totalLiquidity);\n    amount1 = FullMath.mulDiv(_reserve1, liquidity, _totalLiquidity);", "highlightLines": [98]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 98, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "f87b775a3452", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    amount1 = FullMath.mulDiv(_reserve1, liquidity, _totalLiquidity);\n    if (amount0 == 0 && amount1 == 0) revert InsufficientOutputError();\n\n    if (amount0 > 0) SafeTransferLib.safeTransfer(token0, to, amount0);\n    if (amount1 > 0) SafeTransferLib.safeTransfer(token1, to, amount1);\n\n    // Extra check of the invariant\n    if (!invariant(_reserve0 - amount0, _reserve1 - amount1, _totalLiquidity - liquidity)) revert InvariantError();\n\n    reserve0 = _reserve0 - SafeCast.toUint120(amount0); // SSTORE", "highlightLines": [99]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 99, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "7613827be1b4", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    reserve0 = _reserve0 - SafeCast.toUint120(amount0); // SSTORE\n    reserve1 = _reserve1 - SafeCast.toUint120(amount1); // SSTORE", "highlightLines": [108]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 108, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "495e7f860e31", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    reserve1 = _reserve1 - SafeCast.toUint120(amount1); // SSTORE\n    totalLiquidity = _totalLiquidity - liquidity; // SSTORE", "highlightLines": [109]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 109, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "2e9e2bdf760b", "fix": {"template": null, "available": false}, "title": "Swap/liquidity operation without deadline parameter - transaction can be delayed indefinitely", "ruleId": "rules.sol-missing-deadline-check", "snippet": {"code": "  function swap(address to, uint256 amount0Out, uint256 amount1Out, bytes calldata data) external override nonReentrant {", "highlightLines": [116]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 116, "column": 3}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "997cad795ab9", "fix": {"template": null, "available": false}, "title": "Token swap/buy without slippage protection - MEV/sandwich attack risk", "ruleId": "rules.sol-missing-slippage-protection", "snippet": {"code": "  function swap(address to, uint256 amount0Out, uint256 amount1Out, bytes calldata data) external override nonReentrant {", "highlightLines": [116]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 116, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "02c2beb3091c", "fix": {"template": null, "available": false}, "title": "Function accepts zero amount without validation - can cause division by zero or empty operations", "ruleId": "rules.sol-missing-zero-amount-check", "snippet": {"code": "  function swap(address to, uint256 amount0Out, uint256 amount1Out, bytes calldata data) external override nonReentrant {", "highlightLines": [116]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 116, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "fd415b6d5ad9", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "  function swap(address to, uint256 amount0Out, uint256 amount1Out, bytes calldata data) external override nonReentrant {\n    if (amount0Out == 0 && amount1Out == 0) revert InsufficientOutputError();", "highlightLines": [116]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 116, "column": 3}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "99221d545a4b", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint120 _reserve0 = reserve0; // SLOAD", "highlightLines": [118]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 118, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f3801505bef4", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint120 _reserve0 = reserve0; // SLOAD\n    uint120 _reserve1 = reserve1; // SLOAD", "highlightLines": [119]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 119, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "07b1b797c40c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint120 _reserve1 = reserve1; // SLOAD", "highlightLines": [120]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 120, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "58cdeffb4ad2", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint120 _reserve1 = reserve1; // SLOAD\n\n    if (amount0Out > 0) SafeTransferLib.safeTransfer(token0, to, amount0Out);\n    if (amount1Out > 0) SafeTransferLib.safeTransfer(token1, to, amount1Out);\n\n    uint256 balance0Before = Balance.balance(token0);", "highlightLines": [120]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 120, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "b6779cdc5a5c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 balance0Before = Balance.balance(token0);", "highlightLines": [124]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 124, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3750cc2f8c38", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "    uint256 balance0Before = Balance.balance(token0);\n    uint256 balance1Before = Balance.balance(token1);", "highlightLines": [125]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 125, "column": 5}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "6fa46847a09c", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 balance0Before = Balance.balance(token0);\n    uint256 balance1Before = Balance.balance(token1);", "highlightLines": [125]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 125, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "9cb31789c487", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 balance1Before = Balance.balance(token1);", "highlightLines": [126]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 126, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "bb1e915aafef", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 balance1Before = Balance.balance(token1);\n    ISwapCallback(msg.sender).swapCallback(amount0Out, amount1Out, data);\n    uint256 amount0In = Balance.balance(token0) - balance0Before;", "highlightLines": [126]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 126, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "927c8f0c9dbb", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 amount0In = Balance.balance(token0) - balance0Before;", "highlightLines": [128]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 128, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "58e8fe662c77", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 amount0In = Balance.balance(token0) - balance0Before;\n    uint256 amount1In = Balance.balance(token1) - balance1Before;", "highlightLines": [128]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 128, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "1bedd47b3627", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 amount1In = Balance.balance(token1) - balance1Before;", "highlightLines": [129]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 129, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "628f95542e3b", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 amount1In = Balance.balance(token1) - balance1Before;\n\n    if (!invariant(_reserve0 + amount0In - amount0Out, _reserve1 + amount1In - amount1Out, totalLiquidity)) {\n      revert InvariantError();\n    }\n\n    reserve0 = _reserve0 + SafeCast.toUint120(amount0In) - SafeCast.toUint120(amount0Out); // SSTORE", "highlightLines": [129]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 129, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "7bfd75c5fd01", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    reserve0 = _reserve0 + SafeCast.toUint120(amount0In) - SafeCast.toUint120(amount0Out); // SSTORE\n    reserve1 = _reserve1 + SafeCast.toUint120(amount1In) - SafeCast.toUint120(amount1Out); // SSTORE", "highlightLines": [135]}, "category": "code", "location": {"file": "src/core/Pair.sol", "line": 135, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "e4d3c38de8b7", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.4;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/libraries/Balance.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "192b89d04bb5", "fix": {"template": null, "available": false}, "title": "External call result copied to memory - malicious contract can return huge data (return bomb)", "ruleId": "rules.sol-return-bomb", "snippet": {"code": "    (bool success, bytes memory data) =\n      token.staticcall(abi.encodeWithSelector(bytes4(keccak256(bytes(\"balanceOf(address)\"))), address(this)));", "highlightLines": [13]}, "category": "code", "location": {"file": "src/libraries/Balance.sol", "line": 13, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#return-bomb"], "description": ""}, {"id": "4ccf253a53ed", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "      token.staticcall(abi.encodeWithSelector(bytes4(keccak256(bytes(\"balanceOf(address)\"))), address(this)));", "highlightLines": [14]}, "category": "code", "location": {"file": "src/libraries/Balance.sol", "line": 14, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "cd4be8ebf323", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/libraries/FullMath.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "5b68f98ec138", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "  function mulDiv(uint256 a, uint256 b, uint256 denominator) internal pure returns (uint256 result) {\n    unchecked {\n      // 512-bit multiply [prod1 prod0] = a * b\n      // Compute the product mod 2**256 and mod 2**256 - 1\n      // then use the Chinese Remainder Theorem to reconstruct\n      // the 512 bit result. The result is stored in two 256\n      // variables such that product = prod1 * 2**256 + prod0", "highlightLines": [20]}, "category": "code", "location": {"file": "src/libraries/FullMath.sol", "line": 20, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "d41a2bcb1a24", "fix": {"template": null, "available": false}, "title": "View/pure function uses assembly - may modify state unexpectedly", "ruleId": "rules.sol-constant-function-assembly", "snippet": {"code": "  function mulDiv(uint256 a, uint256 b, uint256 denominator) internal pure returns (uint256 result) {\n    unchecked {\n      // 512-bit multiply [prod1 prod0] = a * b\n      // Compute the product mod 2**256 and mod 2**256 - 1\n      // then use the Chinese Remainder Theorem to reconstruct\n      // the 512 bit result. The result is stored in two 256\n      // variables such that product = prod1 * 2**256 + prod0\n      uint256 prod0; // Least significant 256 bits of the product\n      uint256 prod1; // Most significant 256 bits of the product\n      assembly {", "highlightLines": [20]}, "category": "code", "location": {"file": "src/libraries/FullMath.sol", "line": 20, "column": 3}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-using-assembly-code"], "description": ""}, {"id": "fa33070350d1", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "      uint256 prod0; // Least significant 256 bits of the product", "highlightLines": [27]}, "category": "code", "location": {"file": "src/libraries/FullMath.sol", "line": 27, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ca961bebe93e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "      uint256 prod1; // Most significant 256 bits of the product", "highlightLines": [28]}, "category": "code", "location": {"file": "src/libraries/FullMath.sol", "line": 28, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "6781befdc95e", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "      assembly {", "highlightLines": [29]}, "category": "code", "location": {"file": "src/libraries/FullMath.sol", "line": 29, "column": 7}, "severity": "info", "references": [], "description": ""}, {"id": "972142a56172", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        let mm := mulmod(a, b, not(0))\n        prod0 := mul(a, b)", "highlightLines": [30]}, "category": "code", "location": {"file": "src/libraries/FullMath.sol", "line": 30, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "a6c0335996d1", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        prod0 := mul(a, b)\n        prod1 := sub(sub(mm, prod0), lt(mm, prod0))", "highlightLines": [31]}, "category": "code", "location": {"file": "src/libraries/FullMath.sol", "line": 31, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "f9cd7ed04fb9", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(denominator > 0);", "highlightLines": [37]}, "category": "code", "location": {"file": "src/libraries/FullMath.sol", "line": 37, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "4c1f8d45b1c2", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [38]}, "category": "code", "location": {"file": "src/libraries/FullMath.sol", "line": 38, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "95b78b3de02a", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "      require(denominator > prod1);", "highlightLines": [46]}, "category": "code", "location": {"file": "src/libraries/FullMath.sol", "line": 46, "column": 7}, "severity": "info", "references": [], "description": ""}, {"id": "03e4396e8589", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "      uint256 remainder;", "highlightLines": [54]}, "category": "code", "location": {"file": "src/libraries/FullMath.sol", "line": 54, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0fa47db952fd", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "      assembly {", "highlightLines": [55]}, "category": "code", "location": {"file": "src/libraries/FullMath.sol", "line": 55, "column": 7}, "severity": "info", "references": [], "description": ""}, {"id": "fb17d701bc69", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "      assembly {", "highlightLines": [59]}, "category": "code", "location": {"file": "src/libraries/FullMath.sol", "line": 59, "column": 7}, "severity": "info", "references": [], "description": ""}, {"id": "2dcc2443889d", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        prod1 := sub(prod1, gt(remainder, prod0))\n        prod0 := sub(prod0, remainder)", "highlightLines": [60]}, "category": "code", "location": {"file": "src/libraries/FullMath.sol", "line": 60, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "680a76768b63", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "      uint256 twos = denominator & (~denominator + 1);", "highlightLines": [71]}, "category": "code", "location": {"file": "src/libraries/FullMath.sol", "line": 71, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f7f25572e5a4", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "      uint256 twos = denominator & (~denominator + 1);\n\n      // Divide denominator by power of two\n      assembly {\n        denominator := div(denominator, twos)\n      }", "highlightLines": [71]}, "category": "code", "location": {"file": "src/libraries/FullMath.sol", "line": 71, "column": 7}, "severity": "info", "references": [], "description": ""}, {"id": "e55a50237c6e", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "      uint256 twos = denominator & (~denominator + 1);", "highlightLines": [71]}, "category": "code", "location": {"file": "src/libraries/FullMath.sol", "line": 71, "column": 37}, "severity": "medium", "references": [], "description": ""}, {"id": "dba6548ad292", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "      assembly {", "highlightLines": [74]}, "category": "code", "location": {"file": "src/libraries/FullMath.sol", "line": 74, "column": 7}, "severity": "info", "references": [], "description": ""}, {"id": "780e14b4ba6b", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "      assembly {", "highlightLines": [79]}, "category": "code", "location": {"file": "src/libraries/FullMath.sol", "line": 79, "column": 7}, "severity": "info", "references": [], "description": ""}, {"id": "fded84baf767", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "      assembly {", "highlightLines": [85]}, "category": "code", "location": {"file": "src/libraries/FullMath.sol", "line": 85, "column": 7}, "severity": "info", "references": [], "description": ""}, {"id": "d357d98535a4", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "      prod0 |= prod1 * twos;", "highlightLines": [88]}, "category": "code", "location": {"file": "src/libraries/FullMath.sol", "line": 88, "column": 16}, "severity": "medium", "references": [], "description": ""}, {"id": "0f550177d5e0", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "      uint256 inv = (3 * denominator) ^ 2;", "highlightLines": [95]}, "category": "code", "location": {"file": "src/libraries/FullMath.sol", "line": 95, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0bc60e8908fa", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "      uint256 inv = (3 * denominator) ^ 2;\n      // Now use Newton-Raphson iteration to improve the precision.\n      // Thanks to Hensel's lifting lemma, this also works in modular\n      // arithmetic, doubling the correct bits in each step.\n      inv *= 2 - denominator * inv; // inverse mod 2**8\n      inv *= 2 - denominator * inv; // inverse mod 2**16\n      inv *= 2 - denominator * inv; // inverse mod 2**32\n      inv *= 2 - denominator * inv; // inverse mod 2**64\n      inv *= 2 - denominator * inv; // inverse mod 2**128\n      inv *= 2 - denominator * inv; // inverse mod 2**256\n\n      // Because the division is now exact we can divide by multiplying\n      // with the modular inverse of denominator. This will give us the\n      // correct result modulo 2**256. Since the precoditions guarantee\n      // that the outcome is less than 2**256, this is the final result.\n      // We don't need to compute the high bits of the result and prod1\n      // is no longer required.\n      result = prod0 * inv;", "highlightLines": [95]}, "category": "code", "location": {"file": "src/libraries/FullMath.sol", "line": 95, "column": 7}, "severity": "info", "references": [], "description": ""}, {"id": "f3760cad1841", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "      uint256 inv = (3 * denominator) ^ 2;", "highlightLines": [95]}, "category": "code", "location": {"file": "src/libraries/FullMath.sol", "line": 95, "column": 22}, "severity": "medium", "references": [], "description": ""}, {"id": "246920d51dbd", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "      inv *= 2 - denominator * inv; // inverse mod 2**8", "highlightLines": [99]}, "category": "code", "location": {"file": "src/libraries/FullMath.sol", "line": 99, "column": 14}, "severity": "medium", "references": [], "description": ""}, {"id": "6ae230f47980", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "      inv *= 2 - denominator * inv; // inverse mod 2**16", "highlightLines": [100]}, "category": "code", "location": {"file": "src/libraries/FullMath.sol", "line": 100, "column": 14}, "severity": "medium", "references": [], "description": ""}, {"id": "772c8f61fea8", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "      inv *= 2 - denominator * inv; // inverse mod 2**32", "highlightLines": [101]}, "category": "code", "location": {"file": "src/libraries/FullMath.sol", "line": 101, "column": 14}, "severity": "medium", "references": [], "description": ""}, {"id": "e08857cbb76b", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "      inv *= 2 - denominator * inv; // inverse mod 2**64", "highlightLines": [102]}, "category": "code", "location": {"file": "src/libraries/FullMath.sol", "line": 102, "column": 14}, "severity": "medium", "references": [], "description": ""}, {"id": "e54b17fa49f6", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "      inv *= 2 - denominator * inv; // inverse mod 2**128", "highlightLines": [103]}, "category": "code", "location": {"file": "src/libraries/FullMath.sol", "line": 103, "column": 14}, "severity": "medium", "references": [], "description": ""}, {"id": "f86797143600", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "      inv *= 2 - denominator * inv; // inverse mod 2**256", "highlightLines": [104]}, "category": "code", "location": {"file": "src/libraries/FullMath.sol", "line": 104, "column": 14}, "severity": "medium", "references": [], "description": ""}, {"id": "df6173afe483", "fix": {"template": null, "available": false}, "title": "Unchecked arithmetic operation - potential overflow/underflow (Solidity <0.8.0)", "ruleId": "rules.sol-unchecked-arithmetic", "snippet": {"code": "      result = prod0 * inv;", "highlightLines": [112]}, "category": "code", "location": {"file": "src/libraries/FullMath.sol", "line": 112, "column": 16}, "severity": "medium", "references": [], "description": ""}, {"id": "f689c79b7d76", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "  /// @return result The 256-bit result\n  function mulDivRoundingUp(uint256 a, uint256 b, uint256 denominator) internal pure returns (uint256 result) {\n    result = mulDiv(a, b, denominator);\n    if (mulmod(a, b, denominator) > 0) {", "highlightLines": [122]}, "category": "code", "location": {"file": "src/libraries/FullMath.sol", "line": 122, "column": 8}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "eef57e94397f", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "  function mulDivRoundingUp(uint256 a, uint256 b, uint256 denominator) internal pure returns (uint256 result) {\n    result = mulDiv(a, b, denominator);", "highlightLines": [123]}, "category": "code", "location": {"file": "src/libraries/FullMath.sol", "line": 123, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "c43dbe0ce82e", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/libraries/SafeCast.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "254e4a6a3fbe", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "  function toUint120(uint256 y) internal pure returns (uint120 z) {\n    require((z = uint120(y)) == y);", "highlightLines": [8]}, "category": "code", "location": {"file": "src/libraries/SafeCast.sol", "line": 8, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "256c70b033d5", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require((z = uint120(y)) == y);", "highlightLines": [9]}, "category": "code", "location": {"file": "src/libraries/SafeCast.sol", "line": 9, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "6a897e48581e", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "  /// @return z The casted integer, now type int256\n  function toInt256(uint256 y) internal pure returns (int256 z) {\n    require(y < 2 ** 255);\n    z = int256(y);", "highlightLines": [14]}, "category": "code", "location": {"file": "src/libraries/SafeCast.sol", "line": 14, "column": 8}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "1eeab6dd33d0", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "  function toInt256(uint256 y) internal pure returns (int256 z) {\n    require(y < 2 ** 255);\n    z = int256(y);", "highlightLines": [15]}, "category": "code", "location": {"file": "src/libraries/SafeCast.sol", "line": 15, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "016734c4351c", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(y < 2 ** 255);", "highlightLines": [16]}, "category": "code", "location": {"file": "src/libraries/SafeCast.sol", "line": 16, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "ff51edfd6f66", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "/// @notice Safe ETH and ERC20 transfer library that gracefully handles missing return values.\n/// @author Muffin (https://github.com/muffinfi/muffin/blob/master/contracts/libraries/utils/SafeTransferLib.sol)\n/// @dev Use with caution! Some functions in this library knowingly create dirty bits at the destination of the free\n/// memory pointer.\nlibrary SafeTransferLib {\n  error FailedTransferETH();\n  error FailedTransfer();", "highlightLines": [6]}, "category": "code", "location": {"file": "src/libraries/SafeTransferLib.sol", "line": 6, "column": 81}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "8113a2a311ba", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    bool callStatus;", "highlightLines": [21]}, "category": "code", "location": {"file": "src/libraries/SafeTransferLib.sol", "line": 21, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "db2cc20e6d29", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "    assembly {", "highlightLines": [23]}, "category": "code", "location": {"file": "src/libraries/SafeTransferLib.sol", "line": 23, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "4a5e16348e22", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    bool callStatus;", "highlightLines": [36]}, "category": "code", "location": {"file": "src/libraries/SafeTransferLib.sol", "line": 36, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "69bcdc8624be", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "    assembly {", "highlightLines": [38]}, "category": "code", "location": {"file": "src/libraries/SafeTransferLib.sol", "line": 38, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "8596eecbf87e", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "      let freeMemoryPointer := mload(0x40)\n\n      // Write the abi-encoded calldata to memory piece by piece:\n      mstore(freeMemoryPointer, 0x23b872dd00000000000000000000000000000000000000000000000000000000) // Begin with\n      // the function selector.\n      mstore(add(freeMemoryPointer, 4), and(from, 0xffffffffffffffffffffffffffffffffffffffff)) // Mask and append\n      // the \"from\" argument.\n      mstore(add(freeMemoryPointer, 36), and(to, 0xffffffffffffffffffffffffffffffffffffffff)) // Mask and append\n      // the \"to\" argument.\n      mstore(add(freeMemoryPointer, 68), amount) // Finally append the \"amount\" argument. No mask as it's a full\n      // 32 byte value.\n\n      // Call the token and store if it succeeded or not.\n      // We use 100 because the calldata length is 4 + 32 * 3.\n      callStatus := call(gas(), token, 0, freeMemoryPointer, 100, 0, 0)", "highlightLines": [40]}, "category": "code", "location": {"file": "src/libraries/SafeTransferLib.sol", "line": 40, "column": 11}, "severity": "info", "references": [], "description": ""}, {"id": "4159bbb8f060", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    bool callStatus;", "highlightLines": [61]}, "category": "code", "location": {"file": "src/libraries/SafeTransferLib.sol", "line": 61, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "926e49babd16", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "    assembly {", "highlightLines": [63]}, "category": "code", "location": {"file": "src/libraries/SafeTransferLib.sol", "line": 63, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "e4a4cff0731c", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "      let freeMemoryPointer := mload(0x40)\n\n      // Write the abi-encoded calldata to memory piece by piece:\n      mstore(freeMemoryPointer, 0xa9059cbb00000000000000000000000000000000000000000000000000000000) // Begin with\n      // the function selector.\n      mstore(add(freeMemoryPointer, 4), and(to, 0xffffffffffffffffffffffffffffffffffffffff)) // Mask and append\n      // the \"to\" argument.\n      mstore(add(freeMemoryPointer, 36), amount) // Finally append the \"amount\" argument. No mask as it's a full\n      // 32 byte value.\n\n      // Call the token and store if it succeeded or not.\n      // We use 68 because the calldata length is 4 + 32 * 2.\n      callStatus := call(gas(), token, 0, freeMemoryPointer, 68, 0, 0)", "highlightLines": [65]}, "category": "code", "location": {"file": "src/libraries/SafeTransferLib.sol", "line": 65, "column": 11}, "severity": "info", "references": [], "description": ""}, {"id": "4ff0f748e083", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "      // the function selector.\n      mstore(add(freeMemoryPointer, 4), and(to, 0xffffffffffffffffffffffffffffffffffffffff)) // Mask and append\n      // the \"to\" argument.\n      mstore(add(freeMemoryPointer, 36), amount) // Finally append the \"amount\" argument. No mask as it's a full\n      // 32 byte value.\n\n      // Call the token and store if it succeeded or not.\n      // We use 68 because the calldata length is 4 + 32 * 2.\n      callStatus := call(gas(), token, 0, freeMemoryPointer, 68, 0, 0)\n    }\n\n    if (!didLastOptionalReturnCallSucceed(callStatus)) revert FailedTransfer();\n  }\n\n  /*///////////////////////////////////////////////////////////////\n                         INTERNAL HELPER LOGIC\n    //////////////////////////////////////////////////////////////*/\n\n  function didLastOptionalReturnCallSucceed(bool callStatus) private pure returns (bool success) {\n    assembly {\n      // If the call reverted:\n      if iszero(callStatus) {\n        // Copy the revert message into memory.\n        returndatacopy(0, 0, returndatasize())\n\n        // Revert with the same message.\n        revert(0, returndatasize())", "highlightLines": [69]}, "category": "code", "location": {"file": "src/libraries/SafeTransferLib.sol", "line": 69, "column": 14}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "5d6dfde2f3a8", "fix": {"template": null, "available": false}, "title": "View/pure function uses assembly - may modify state unexpectedly", "ruleId": "rules.sol-constant-function-assembly", "snippet": {"code": "  function didLastOptionalReturnCallSucceed(bool callStatus) private pure returns (bool success) {\n    assembly {", "highlightLines": [87]}, "category": "code", "location": {"file": "src/libraries/SafeTransferLib.sol", "line": 87, "column": 3}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-using-assembly-code"], "description": ""}, {"id": "2d2912fac16a", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "    assembly {", "highlightLines": [88]}, "category": "code", "location": {"file": "src/libraries/SafeTransferLib.sol", "line": 88, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "eda1efc74b35", "fix": {"template": null, "available": false}, "title": "Callback function without caller validation - external contracts can trigger unexpected behavior", "ruleId": "rules.sol-unprotected-callback", "snippet": {"code": "  function uniswapV3SwapCallback(int256 amount0Delta, int256 amount1Delta, bytes calldata data) external;", "highlightLines": [16]}, "category": "code", "location": {"file": "src/periphery/UniswapV3/interfaces/callback/IUniswapV3SwapCallback.sol", "line": 16, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "c7fe9b44efe9", "fix": {"template": null, "available": false}, "title": "Initialization function can be front-run - use initializer modifier or constructor", "ruleId": "rules.sol-initialization-frontrun", "snippet": {"code": "  function initialize(uint160 sqrtPriceX96) external;", "highlightLines": [10]}, "category": "code", "location": {"file": "src/periphery/UniswapV3/interfaces/pool/IUniswapV3PoolActions.sol", "line": 10, "column": 3}, "severity": "high", "references": [], "description": ""}, {"id": "14131d98428c", "fix": {"template": null, "available": false}, "title": "Clone/minimal proxy initializer without protection - can be front-run and hijacked", "ruleId": "rules.sol-unprotected-clone-initializer", "snippet": {"code": "  function initialize(uint160 sqrtPriceX96) external;", "highlightLines": [10]}, "category": "code", "location": {"file": "src/periphery/UniswapV3/interfaces/pool/IUniswapV3PoolActions.sol", "line": 10, "column": 3}, "severity": "high", "references": ["https://blog.openzeppelin.com/security-advisory-initialize-uups-implementation-contracts"], "description": ""}, {"id": "e7a888ce8bda", "fix": {"template": null, "available": false}, "title": "Initializer function not protected - can be called multiple times", "ruleId": "rules.sol-initializer-not-protected", "snippet": {"code": "  function initialize(uint160 sqrtPriceX96) external;\n\n  /// @notice Adds liquidity for the given recipient/tickLower/tickUpper position\n  /// @dev The caller of this method receives a callback in the form of IUniswapV3MintCallback#uniswapV3MintCallback\n  /// in which they must pay any token0 or token1 owed for the liquidity. The amount of token0/token1 due depends\n  /// on tickLower, tickUpper, the amount of liquidity, and the current price.\n  /// @param recipient The address for which the liquidity will be created\n  /// @param tickLower The lower tick of the position in which to add liquidity\n  /// @param tickUpper The upper tick of the position in which to add liquidity\n  /// @param amount The amount of liquidity to mint\n  /// @param data Any data that should be passed through to the callback\n  /// @return amount0 The amount of token0 that was paid to mint the given amount of liquidity. Matches the value in\n  /// the callback\n  /// @return amount1 The amount of token1 that was paid to mint the given amount of liquidity. Matches the value in\n  /// the callback\n  function mint(\n    address recipient,\n    int24 tickLower,\n    int24 tickUpper,\n    uint128 amount,\n    bytes calldata data\n  )\n    external\n    returns (uint256 amount0, uint256 amount1);\n\n  /// @notice Collects tokens owed to a position\n  /// @dev Does not recompute fees earned, which must be done either via mint or burn of any amount of liquidity.\n  /// Collect must be called by the position owner. To withdraw only token0 or only token1, amount0Requested or\n  /// amount1Requested may be set to zero. To withdraw all tokens owed, caller may pass any value greater than the\n  /// actual tokens owed, e.g. type(uint128).max. Tokens owed may be from accumulated swap fees or burned liquidity.\n  /// @param recipient The address which should receive the fees collected\n  /// @param tickLower The lower tick of the position for which to collect fees\n  /// @param tickUpper The upper tick of the position for which to collect fees\n  /// @param amount0Requested How much token0 should be withdrawn from the fees owed\n  /// @param amount1Requested How much token1 should be withdrawn from the fees owed\n  /// @return amount0 The amount of fees collected in token0\n  /// @return amount1 The amount of fees collected in token1\n  function collect(\n    address recipient,\n    int24 tickLower,\n    int24 tickUpper,\n    uint128 amount0Requested,\n    uint128 amount1Requested\n  )\n    external\n    returns (uint128 amount0, uint128 amount1);\n\n  /// @notice Burn liquidity from the sender and account tokens owed for the liquidity to the position\n  /// @dev Can be used to trigger a recalculation of fees owed to a position by calling with an amount of 0\n  /// @dev Fees must be collected separately via a call to #collect\n  /// @param tickLower The lower tick of the position for which to burn liquidity\n  /// @param tickUpper The upper tick of the position for which to burn liquidity\n  /// @param amount How much liquidity to burn\n  /// @return amount0 The amount of token0 sent to the recipient\n  /// @return amount1 The amount of token1 sent to the recipient\n  function burn(int24 tickLower, int24 tickUpper, uint128 amount) external returns (uint256 amount0, uint256 amount1);\n\n  /// @notice Swap token0 for token1, or token1 for token0\n  /// @dev The caller of this method receives a callback in the form of IUniswapV3SwapCallback#uniswapV3SwapCallback\n  /// @param recipient The address to receive the output of the swap\n  /// @param zeroForOne The direction of the swap, true for token0 to token1, false for token1 to token0\n  /// @param amountSpecified The amount of the swap, which implicitly configures the swap as exact input (positive),\n  /// or exact output (negative)\n  /// @param sqrtPriceLimitX96 The Q64.96 sqrt price limit. If zero for one, the price cannot be less than this\n  /// value after the swap. If one for zero, the price cannot be greater than this value after the swap\n  /// @param data Any data to be passed through to the callback\n  /// @return amount0 The delta of the balance of token0 of the pool, exact when negative, minimum when positive\n  /// @return amount1 The delta of the balance of token1 of the pool, exact when negative, minimum when positive\n  function swap(\n    address recipient,\n    bool zeroForOne,\n    int256 amountSpecified,\n    uint160 sqrtPriceLimitX96,\n    bytes calldata data\n  )\n    external\n    returns (int256 amount0, int256 amount1);\n\n  /// @notice Receive token0 and/or token1 and pay it back, plus a fee, in the callback\n  /// @dev The caller of this method receives a callback in the form of IUniswapV3FlashCallback#uniswapV3FlashCallback\n  /// @dev Can be used to donate underlying tokens pro-rata to currently in-range liquidity providers by calling\n  /// with 0 amount{0,1} and sending the donation amount(s) from the callback", "highlightLines": [10]}, "category": "code", "location": {"file": "src/periphery/UniswapV3/interfaces/pool/IUniswapV3PoolActions.sol", "line": 10, "column": 3}, "severity": "high", "references": [], "description": ""}, {"id": "b28475f77b54", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "  function mint(\n    address recipient,\n    int24 tickLower,\n    int24 tickUpper,\n    uint128 amount,\n    bytes calldata data\n  )\n    external", "highlightLines": [25]}, "category": "code", "location": {"file": "src/periphery/UniswapV3/interfaces/pool/IUniswapV3PoolActions.sol", "line": 25, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "4a853cce0871", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function mint(\n    address recipient,\n    int24 tickLower,\n    int24 tickUpper,\n    uint128 amount,\n    bytes calldata data\n  )\n    external\n    returns (uint256 amount0, uint256 amount1);", "highlightLines": [25]}, "category": "code", "location": {"file": "src/periphery/UniswapV3/interfaces/pool/IUniswapV3PoolActions.sol", "line": 25, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "9a9e4d645f83", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "  function mint(\n    address recipient,\n    int24 tickLower,\n    int24 tickUpper,\n    uint128 amount,\n    bytes calldata data\n  )\n    external\n    returns (uint256 amount0, uint256 amount1);\n\n  /// @notice Collects tokens owed to a position\n  /// @dev Does not recompute fees earned, which must be done either via mint or burn of any amount of liquidity.\n  /// Collect must be called by the position owner. To withdraw only token0 or only token1, amount0Requested or\n  /// amount1Requested may be set to zero. To withdraw all tokens owed, caller may pass any value greater than the\n  /// actual tokens owed, e.g. type(uint128).max. Tokens owed may be from accumulated swap fees or burned liquidity.\n  /// @param recipient The address which should receive the fees collected\n  /// @param tickLower The lower tick of the position for which to collect fees\n  /// @param tickUpper The upper tick of the position for which to collect fees\n  /// @param amount0Requested How much token0 should be withdrawn from the fees owed\n  /// @param amount1Requested How much token1 should be withdrawn from the fees owed\n  /// @return amount0 The amount of fees collected in token0\n  /// @return amount1 The amount of fees collected in token1\n  function collect(\n    address recipient,\n    int24 tickLower,\n    int24 tickUpper,\n    uint128 amount0Requested,\n    uint128 amount1Requested\n  )\n    external\n    returns (uint128 amount0, uint128 amount1);\n\n  /// @notice Burn liquidity from the sender and account tokens owed for the liquidity to the position\n  /// @dev Can be used to trigger a recalculation of fees owed to a position by calling with an amount of 0\n  /// @dev Fees must be collected separately via a call to #collect\n  /// @param tickLower The lower tick of the position for which to burn liquidity\n  /// @param tickUpper The upper tick of the position for which to burn liquidity\n  /// @param amount How much liquidity to burn\n  /// @return amount0 The amount of token0 sent to the recipient\n  /// @return amount1 The amount of token1 sent to the recipient\n  function burn(int24 tickLower, int24 tickUpper, uint128 amount) external returns (uint256 amount0, uint256 amount1);\n\n  /// @notice Swap token0 for token1, or token1 for token0\n  /// @dev The caller of this method receives a callback in the form of IUniswapV3SwapCallback#uniswapV3SwapCallback\n  /// @param recipient The address to receive the output of the swap\n  /// @param zeroForOne The direction of the swap, true for token0 to token1, false for token1 to token0\n  /// @param amountSpecified The amount of the swap, which implicitly configures the swap as exact input (positive),\n  /// or exact output (negative)\n  /// @param sqrtPriceLimitX96 The Q64.96 sqrt price limit. If zero for one, the price cannot be less than this\n  /// value after the swap. If one for zero, the price cannot be greater than this value after the swap\n  /// @param data Any data to be passed through to the callback\n  /// @return amount0 The delta of the balance of token0 of the pool, exact when negative, minimum when positive\n  /// @return amount1 The delta of the balance of token1 of the pool, exact when negative, minimum when positive\n  function swap(\n    address recipient,\n    bool zeroForOne,\n    int256 amountSpecified,\n    uint160 sqrtPriceLimitX96,\n    bytes calldata data\n  )\n    external\n    returns (int256 amount0, int256 amount1);\n\n  /// @notice Receive token0 and/or token1 and pay it back, plus a fee, in the callback\n  /// @dev The caller of this method receives a callback in the form of IUniswapV3FlashCallback#uniswapV3FlashCallback\n  /// @dev Can be used to donate underlying tokens pro-rata to currently in-range liquidity providers by calling\n  /// with 0 amount{0,1} and sending the donation amount(s) from the callback", "highlightLines": [25]}, "category": "code", "location": {"file": "src/periphery/UniswapV3/interfaces/pool/IUniswapV3PoolActions.sol", "line": 25, "column": 3}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "a1854c9b0e5a", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function collect(\n    address recipient,\n    int24 tickLower,\n    int24 tickUpper,\n    uint128 amount0Requested,\n    uint128 amount1Requested\n  )\n    external\n    returns (uint128 amount0, uint128 amount1);", "highlightLines": [47]}, "category": "code", "location": {"file": "src/periphery/UniswapV3/interfaces/pool/IUniswapV3PoolActions.sol", "line": 47, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "b309f873825f", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "  function burn(int24 tickLower, int24 tickUpper, uint128 amount) external returns (uint256 amount0, uint256 amount1);", "highlightLines": [65]}, "category": "code", "location": {"file": "src/periphery/UniswapV3/interfaces/pool/IUniswapV3PoolActions.sol", "line": 65, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "ee9b1e1601ec", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function swap(\n    address recipient,\n    bool zeroForOne,\n    int256 amountSpecified,\n    uint160 sqrtPriceLimitX96,\n    bytes calldata data\n  )\n    external\n    returns (int256 amount0, int256 amount1);", "highlightLines": [78]}, "category": "code", "location": {"file": "src/periphery/UniswapV3/interfaces/pool/IUniswapV3PoolActions.sol", "line": 78, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "e97bf3c5b6fe", "fix": {"template": null, "available": false}, "title": "Swap/liquidity operation without deadline parameter - transaction can be delayed indefinitely", "ruleId": "rules.sol-missing-deadline-check", "snippet": {"code": "  function swap(\n    address recipient,\n    bool zeroForOne,\n    int256 amountSpecified,\n    uint160 sqrtPriceLimitX96,\n    bytes calldata data\n  )\n    external\n    returns (int256 amount0, int256 amount1);\n\n  /// @notice Receive token0 and/or token1 and pay it back, plus a fee, in the callback\n  /// @dev The caller of this method receives a callback in the form of IUniswapV3FlashCallback#uniswapV3FlashCallback\n  /// @dev Can be used to donate underlying tokens pro-rata to currently in-range liquidity providers by calling\n  /// with 0 amount{0,1} and sending the donation amount(s) from the callback", "highlightLines": [78]}, "category": "code", "location": {"file": "src/periphery/UniswapV3/interfaces/pool/IUniswapV3PoolActions.sol", "line": 78, "column": 3}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "6d85a0a16594", "fix": {"template": null, "available": false}, "title": "Token swap/buy without slippage protection - MEV/sandwich attack risk", "ruleId": "rules.sol-missing-slippage-protection", "snippet": {"code": "  function swap(\n    address recipient,\n    bool zeroForOne,\n    int256 amountSpecified,\n    uint160 sqrtPriceLimitX96,\n    bytes calldata data\n  )\n    external\n    returns (int256 amount0, int256 amount1);\n\n  /// @notice Receive token0 and/or token1 and pay it back, plus a fee, in the callback\n  /// @dev The caller of this method receives a callback in the form of IUniswapV3FlashCallback#uniswapV3FlashCallback\n  /// @dev Can be used to donate underlying tokens pro-rata to currently in-range liquidity providers by calling\n  /// with 0 amount{0,1} and sending the donation amount(s) from the callback", "highlightLines": [78]}, "category": "code", "location": {"file": "src/periphery/UniswapV3/interfaces/pool/IUniswapV3PoolActions.sol", "line": 78, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "bd8ece3aa3d4", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function flash(address recipient, uint256 amount0, uint256 amount1, bytes calldata data) external;", "highlightLines": [96]}, "category": "code", "location": {"file": "src/periphery/UniswapV3/interfaces/pool/IUniswapV3PoolActions.sol", "line": 96, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "9a9548d9e2c7", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event Initialize(uint160 sqrtPriceX96, int24 tick);", "highlightLines": [11]}, "category": "code", "location": {"file": "src/periphery/UniswapV3/interfaces/pool/IUniswapV3PoolEvents.sol", "line": 11, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "7ed1cd955a0a", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event Mint(\n    address sender,\n    address indexed owner,\n    int24 indexed tickLower,\n    int24 indexed tickUpper,\n    uint128 amount,\n    uint256 amount0,\n    uint256 amount1\n  );", "highlightLines": [21]}, "category": "code", "location": {"file": "src/periphery/UniswapV3/interfaces/pool/IUniswapV3PoolEvents.sol", "line": 21, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "c27ca6c02d86", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event Mint(\n    address sender,\n    address indexed owner,\n    int24 indexed tickLower,\n    int24 indexed tickUpper,\n    uint128 amount,\n    uint256 amount0,\n    uint256 amount1\n  );", "highlightLines": [21]}, "category": "code", "location": {"file": "src/periphery/UniswapV3/interfaces/pool/IUniswapV3PoolEvents.sol", "line": 21, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "a56f9621b174", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event Collect(\n    address indexed owner,\n    address recipient,\n    int24 indexed tickLower,\n    int24 indexed tickUpper,\n    uint128 amount0,\n    uint128 amount1\n  );", "highlightLines": [38]}, "category": "code", "location": {"file": "src/periphery/UniswapV3/interfaces/pool/IUniswapV3PoolEvents.sol", "line": 38, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "803076b7b5f3", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event Collect(\n    address indexed owner,\n    address recipient,\n    int24 indexed tickLower,\n    int24 indexed tickUpper,\n    uint128 amount0,\n    uint128 amount1\n  );", "highlightLines": [38]}, "category": "code", "location": {"file": "src/periphery/UniswapV3/interfaces/pool/IUniswapV3PoolEvents.sol", "line": 38, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "00a6e92922a0", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event Burn(\n    address indexed owner,\n    int24 indexed tickLower,\n    int24 indexed tickUpper,\n    uint128 amount,\n    uint256 amount0,\n    uint256 amount1\n  );", "highlightLines": [55]}, "category": "code", "location": {"file": "src/periphery/UniswapV3/interfaces/pool/IUniswapV3PoolEvents.sol", "line": 55, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "04f19b70a8f1", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event Burn(\n    address indexed owner,\n    int24 indexed tickLower,\n    int24 indexed tickUpper,\n    uint128 amount,\n    uint256 amount0,\n    uint256 amount1\n  );", "highlightLines": [55]}, "category": "code", "location": {"file": "src/periphery/UniswapV3/interfaces/pool/IUniswapV3PoolEvents.sol", "line": 55, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "071cefaaa6af", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event Swap(\n    address indexed sender,\n    address indexed recipient,\n    int256 amount0,\n    int256 amount1,\n    uint160 sqrtPriceX96,\n    uint128 liquidity,\n    int24 tick\n  );", "highlightLines": [72]}, "category": "code", "location": {"file": "src/periphery/UniswapV3/interfaces/pool/IUniswapV3PoolEvents.sol", "line": 72, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "981c220ddf23", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event Swap(\n    address indexed sender,\n    address indexed recipient,\n    int256 amount0,\n    int256 amount1,\n    uint160 sqrtPriceX96,\n    uint128 liquidity,\n    int24 tick\n  );", "highlightLines": [72]}, "category": "code", "location": {"file": "src/periphery/UniswapV3/interfaces/pool/IUniswapV3PoolEvents.sol", "line": 72, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "849b9674222e", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event Flash(\n    address indexed sender, address indexed recipient, uint256 amount0, uint256 amount1, uint256 paid0, uint256 paid1\n  );", "highlightLines": [89]}, "category": "code", "location": {"file": "src/periphery/UniswapV3/interfaces/pool/IUniswapV3PoolEvents.sol", "line": 89, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "1895f14964d7", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event Flash(\n    address indexed sender, address indexed recipient, uint256 amount0, uint256 amount1, uint256 paid0, uint256 paid1\n  );", "highlightLines": [89]}, "category": "code", "location": {"file": "src/periphery/UniswapV3/interfaces/pool/IUniswapV3PoolEvents.sol", "line": 89, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "03c9e132a23a", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event IncreaseObservationCardinalityNext(uint16 observationCardinalityNextOld, uint16 observationCardinalityNextNew);", "highlightLines": [98]}, "category": "code", "location": {"file": "src/periphery/UniswapV3/interfaces/pool/IUniswapV3PoolEvents.sol", "line": 98, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "2bedf05bf082", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event SetFeeProtocol(uint8 feeProtocol0Old, uint8 feeProtocol1Old, uint8 feeProtocol0New, uint8 feeProtocol1New);", "highlightLines": [105]}, "category": "code", "location": {"file": "src/periphery/UniswapV3/interfaces/pool/IUniswapV3PoolEvents.sol", "line": 105, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "2f288fd00b51", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event CollectProtocol(address indexed sender, address indexed recipient, uint128 amount0, uint128 amount1);", "highlightLines": [112]}, "category": "code", "location": {"file": "src/periphery/UniswapV3/interfaces/pool/IUniswapV3PoolEvents.sol", "line": 112, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "fbbca24438c7", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function collectProtocol(\n    address recipient,\n    uint128 amount0Requested,\n    uint128 amount1Requested\n  )\n    external\n    returns (uint128 amount0, uint128 amount1);", "highlightLines": [18]}, "category": "code", "location": {"file": "src/periphery/UniswapV3/interfaces/pool/IUniswapV3PoolOwnerActions.sol", "line": 18, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "cfbbb9d98c94", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address token0;", "highlightLines": [10]}, "category": "code", "location": {"file": "src/periphery/UniswapV3/libraries/PoolAddress.sol", "line": 10, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "550abbfc1849", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address token1;", "highlightLines": [11]}, "category": "code", "location": {"file": "src/periphery/UniswapV3/libraries/PoolAddress.sol", "line": 11, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8815ddde61f1", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint24 fee;", "highlightLines": [12]}, "category": "code", "location": {"file": "src/periphery/UniswapV3/libraries/PoolAddress.sol", "line": 12, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "379943cc759a", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "  /// @return Poolkey The pool details with ordered token0 and token1 assignments\n  function getPoolKey(address tokenA, address tokenB, uint24 fee) internal pure returns (PoolKey memory) {\n    if (tokenA > tokenB) (tokenA, tokenB) = (tokenB, tokenA);\n    return PoolKey({token0: tokenA, token1: tokenB, fee: fee});", "highlightLines": [19]}, "category": "code", "location": {"file": "src/periphery/UniswapV3/libraries/PoolAddress.sol", "line": 19, "column": 8}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "126e1294affd", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "  /// @return pool The contract address of the V3 pool\n  function computeAddress(address factory, PoolKey memory key) internal pure returns (address pool) {\n    require(key.token0 < key.token1);\n    pool = address(", "highlightLines": [28]}, "category": "code", "location": {"file": "src/periphery/UniswapV3/libraries/PoolAddress.sol", "line": 28, "column": 8}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "bfa7c41f7c9b", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "  function computeAddress(address factory, PoolKey memory key) internal pure returns (address pool) {\n    require(key.token0 < key.token1);\n    pool = address(", "highlightLines": [29]}, "category": "code", "location": {"file": "src/periphery/UniswapV3/libraries/PoolAddress.sol", "line": 29, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "15c7e4589ead", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(key.token0 < key.token1);", "highlightLines": [30]}, "category": "code", "location": {"file": "src/periphery/UniswapV3/libraries/PoolAddress.sol", "line": 30, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "282896352856", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "          keccak256(\n            abi.encodePacked(\n              hex\"ff\", factory, keccak256(abi.encode(key.token0, key.token1, key.fee)), POOL_INIT_CODE_HASH\n            )\n          )", "highlightLines": [34]}, "category": "code", "location": {"file": "src/periphery/UniswapV3/libraries/PoolAddress.sol", "line": 34, "column": 11}, "severity": "high", "references": [], "description": ""}, {"id": "b05754fb1556", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "            abi.encodePacked(\n              hex\"ff\", factory, keccak256(abi.encode(key.token0, key.token1, key.fee)), POOL_INIT_CODE_HASH\n            )", "highlightLines": [35]}, "category": "code", "location": {"file": "src/periphery/UniswapV3/libraries/PoolAddress.sol", "line": 35, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "d3ba9cffad80", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "              hex\"ff\", factory, keccak256(abi.encode(key.token0, key.token1, key.fee)), POOL_INIT_CODE_HASH", "highlightLines": [36]}, "category": "code", "location": {"file": "src/periphery/UniswapV3/libraries/PoolAddress.sol", "line": 36, "column": 33}, "severity": "high", "references": [], "description": ""}, {"id": "e5e7ed3e8d6d", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.4;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/core/Factory.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "d30bc7b218f7", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "contract Factory is IFactory {", "highlightLines": [8]}, "category": "code", "location": {"file": "src/core/Factory.sol", "line": 8, "column": 1}, "severity": "medium", "references": [], "description": ""}, {"id": "c363e7f13a63", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract Factory is IFactory {\n  /*//////////////////////////////////////////////////////////////\n                                 EVENTS\n    //////////////////////////////////////////////////////////////*/\n\n  event LendgineCreated(\n    address indexed token0,\n    address indexed token1,\n    uint256 token0Exp,\n    uint256 token1Exp,\n    uint256 indexed upperBound,\n    address lendgine\n  );\n\n  /*//////////////////////////////////////////////////////////////\n                                 ERRORS\n    //////////////////////////////////////////////////////////////*/\n\n  error SameTokenError();\n\n  error ZeroAddressError();\n\n  error DeployedError();\n\n  error ScaleError();\n\n  /*//////////////////////////////////////////////////////////////\n                            FACTORY STORAGE\n    //////////////////////////////////////////////////////////////*/\n\n  /// @inheritdoc IFactory\n  mapping(address => mapping(address => mapping(uint256 => mapping(uint256 => mapping(uint256 => address)))))\n    public\n    override getLendgine;\n\n  /*//////////////////////////////////////////////////////////////\n                        TEMPORARY DEPLOY STORAGE\n    //////////////////////////////////////////////////////////////*/\n\n  struct Parameters {\n    address token0;\n    address token1;\n    uint128 token0Exp;\n    uint128 token1Exp;\n    uint256 upperBound;", "highlightLines": [8]}, "category": "code", "location": {"file": "src/core/Factory.sol", "line": 8, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "a71225833c8e", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event LendgineCreated(\n    address indexed token0,\n    address indexed token1,\n    uint256 token0Exp,\n    uint256 token1Exp,\n    uint256 indexed upperBound,\n    address lendgine\n  );", "highlightLines": [13]}, "category": "code", "location": {"file": "src/core/Factory.sol", "line": 13, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "da8dfbe89672", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event LendgineCreated(\n    address indexed token0,\n    address indexed token1,\n    uint256 token0Exp,\n    uint256 token1Exp,\n    uint256 indexed upperBound,\n    address lendgine\n  );", "highlightLines": [13]}, "category": "code", "location": {"file": "src/core/Factory.sol", "line": 13, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "f43c2b70665c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address token0;", "highlightLines": [48]}, "category": "code", "location": {"file": "src/core/Factory.sol", "line": 48, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "9564fd8b4faa", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address token1;", "highlightLines": [49]}, "category": "code", "location": {"file": "src/core/Factory.sol", "line": 49, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ff54328e8908", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint128 token0Exp;", "highlightLines": [50]}, "category": "code", "location": {"file": "src/core/Factory.sol", "line": 50, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f3ffd6dc6991", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint128 token1Exp;", "highlightLines": [51]}, "category": "code", "location": {"file": "src/core/Factory.sol", "line": 51, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "5b7f471445e1", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 upperBound;", "highlightLines": [52]}, "category": "code", "location": {"file": "src/core/Factory.sol", "line": 52, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "5f5c5b6ad149", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "  function createLendgine(\n    address token0,\n    address token1,\n    uint8 token0Exp,\n    uint8 token1Exp,\n    uint256 upperBound\n  )\n    external\n    override\n    returns (address lendgine)\n  {\n    if (token0 == token1) revert SameTokenError();\n    if (token0 == address(0) || token1 == address(0)) revert ZeroAddressError();", "highlightLines": [63]}, "category": "code", "location": {"file": "src/core/Factory.sol", "line": 63, "column": 3}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "3ac5d8761caa", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    parameters =\n      Parameters({token0: token0, token1: token1, token0Exp: token0Exp, token1Exp: token1Exp, upperBound: upperBound});\n\n    lendgine = address(new Lendgine{ salt: keccak256(abi.encode(token0, token1, token0Exp, token1Exp, upperBound)) }());", "highlightLines": [79]}, "category": "code", "location": {"file": "src/core/Factory.sol", "line": 79, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "1d757584d1fe", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    lendgine = address(new Lendgine{ salt: keccak256(abi.encode(token0, token1, token0Exp, token1Exp, upperBound)) }());\n\n    delete parameters;\n\n    getLendgine[token0][token1][token0Exp][token1Exp][upperBound] = lendgine;", "highlightLines": [82]}, "category": "code", "location": {"file": "src/core/Factory.sol", "line": 82, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "c4511658e7e8", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "    lendgine = address(new Lendgine{ salt: keccak256(abi.encode(token0, token1, token0Exp, token1Exp, upperBound)) }());", "highlightLines": [82]}, "category": "code", "location": {"file": "src/core/Factory.sol", "line": 82, "column": 44}, "severity": "high", "references": [], "description": ""}, {"id": "90496190ce8f", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/core/ImmutableState.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "aa4dcabb01b5", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "abstract contract ImmutableState is IImmutableState {", "highlightLines": [8]}, "category": "code", "location": {"file": "src/core/ImmutableState.sol", "line": 8, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "129b7c7e6506", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "abstract contract ImmutableState is IImmutableState {\n  /// @inheritdoc IImmutableState\n  address public immutable override factory;\n\n  /// @inheritdoc IImmutableState\n  address public immutable override token0;\n\n  /// @inheritdoc IImmutableState\n  address public immutable override token1;\n\n  /// @inheritdoc IImmutableState\n  uint256 public immutable override token0Scale;\n\n  /// @inheritdoc IImmutableState\n  uint256 public immutable override token1Scale;\n\n  /// @inheritdoc IImmutableState\n  uint256 public immutable override upperBound;\n\n  constructor() {\n    factory = msg.sender;\n\n    uint128 _token0Exp;\n    uint128 _token1Exp;", "highlightLines": [8]}, "category": "code", "location": {"file": "src/core/ImmutableState.sol", "line": 8, "column": 10}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "f7efa4117de4", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  constructor() {\n    factory = msg.sender;\n\n    uint128 _token0Exp;\n    uint128 _token1Exp;\n\n    (token0, token1, _token0Exp, _token1Exp, upperBound) = Factory(msg.sender).parameters();\n\n    token0Scale = 10 ** (18 - _token0Exp);\n    token1Scale = 10 ** (18 - _token1Exp);\n  }", "highlightLines": [27]}, "category": "code", "location": {"file": "src/core/ImmutableState.sol", "line": 27, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "70e9531388ae", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    factory = msg.sender;\n\n    uint128 _token0Exp;\n    uint128 _token1Exp;\n\n    (token0, token1, _token0Exp, _token1Exp, upperBound) = Factory(msg.sender).parameters();", "highlightLines": [28]}, "category": "code", "location": {"file": "src/core/ImmutableState.sol", "line": 28, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "7f47454a13f3", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint128 _token0Exp;", "highlightLines": [29]}, "category": "code", "location": {"file": "src/core/ImmutableState.sol", "line": 29, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "861d9d335c2c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint128 _token1Exp;", "highlightLines": [31]}, "category": "code", "location": {"file": "src/core/ImmutableState.sol", "line": 31, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "5026a015bdbc", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    (token0, token1, _token0Exp, _token1Exp, upperBound) = Factory(msg.sender).parameters();\n\n    token0Scale = 10 ** (18 - _token0Exp);", "highlightLines": [33]}, "category": "code", "location": {"file": "src/core/ImmutableState.sol", "line": 33, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "7033fbf02a74", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    token0Scale = 10 ** (18 - _token0Exp);\n    token1Scale = 10 ** (18 - _token1Exp);", "highlightLines": [35]}, "category": "code", "location": {"file": "src/core/ImmutableState.sol", "line": 35, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "1d6700f69849", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/core/JumpRate.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "59938e35d2bd", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "abstract contract JumpRate is IJumpRate {", "highlightLines": [6]}, "category": "code", "location": {"file": "src/core/JumpRate.sol", "line": 6, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "3bcb53267d43", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "abstract contract JumpRate is IJumpRate {\n  uint256 public constant override kink = 0.8 ether;\n\n  uint256 public constant override multiplier = 1.375 ether;\n\n  uint256 public constant override jumpMultiplier = 44.5 ether;\n\n  function getBorrowRate(uint256 borrowedLiquidity, uint256 totalLiquidity) public pure override returns (uint256 rate) {\n    uint256 util = utilizationRate(borrowedLiquidity, totalLiquidity);", "highlightLines": [6]}, "category": "code", "location": {"file": "src/core/JumpRate.sol", "line": 6, "column": 10}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "dd4db00d872c", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "  function getBorrowRate(uint256 borrowedLiquidity, uint256 totalLiquidity) public pure override returns (uint256 rate) {\n    uint256 util = utilizationRate(borrowedLiquidity, totalLiquidity);", "highlightLines": [13]}, "category": "code", "location": {"file": "src/core/JumpRate.sol", "line": 13, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "5b2d26bdd3b9", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 util = utilizationRate(borrowedLiquidity, totalLiquidity);", "highlightLines": [14]}, "category": "code", "location": {"file": "src/core/JumpRate.sol", "line": 14, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3449411a5b07", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 util = utilizationRate(borrowedLiquidity, totalLiquidity);\n\n    if (util <= kink) {\n      return (util * multiplier) / 1e18;\n    } else {\n      uint256 normalRate = (kink * multiplier) / 1e18;\n      uint256 excessUtil = util - kink;\n      return ((excessUtil * jumpMultiplier) / 1e18) + normalRate;\n    }", "highlightLines": [14]}, "category": "code", "location": {"file": "src/core/JumpRate.sol", "line": 14, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "35e7157c64e7", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimal assumption - tokens with >18 or <18 decimals will cause overflow/underflow", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "      return (util * multiplier) / 1e18;", "highlightLines": [17]}, "category": "code", "location": {"file": "src/core/JumpRate.sol", "line": 17, "column": 34}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20"], "description": ""}, {"id": "d2f41c2db6bc", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "      return (util * multiplier) / 1e18;", "highlightLines": [17]}, "category": "code", "location": {"file": "src/core/JumpRate.sol", "line": 17, "column": 36}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "a3a7dd3dce10", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "      uint256 normalRate = (kink * multiplier) / 1e18;", "highlightLines": [19]}, "category": "code", "location": {"file": "src/core/JumpRate.sol", "line": 19, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4ebf07931024", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "      uint256 normalRate = (kink * multiplier) / 1e18;\n      uint256 excessUtil = util - kink;", "highlightLines": [19]}, "category": "code", "location": {"file": "src/core/JumpRate.sol", "line": 19, "column": 7}, "severity": "info", "references": [], "description": ""}, {"id": "248e8974daaf", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimal assumption - tokens with >18 or <18 decimals will cause overflow/underflow", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "      uint256 normalRate = (kink * multiplier) / 1e18;", "highlightLines": [19]}, "category": "code", "location": {"file": "src/core/JumpRate.sol", "line": 19, "column": 48}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20"], "description": ""}, {"id": "67a72a2516cd", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "      uint256 normalRate = (kink * multiplier) / 1e18;", "highlightLines": [19]}, "category": "code", "location": {"file": "src/core/JumpRate.sol", "line": 19, "column": 50}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "6f400899bdf0", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "      uint256 excessUtil = util - kink;", "highlightLines": [20]}, "category": "code", "location": {"file": "src/core/JumpRate.sol", "line": 20, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "94b6bcefa058", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimal assumption - tokens with >18 or <18 decimals will cause overflow/underflow", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "      return ((excessUtil * jumpMultiplier) / 1e18) + normalRate;", "highlightLines": [21]}, "category": "code", "location": {"file": "src/core/JumpRate.sol", "line": 21, "column": 45}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20"], "description": ""}, {"id": "071c41af294d", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "      return ((excessUtil * jumpMultiplier) / 1e18) + normalRate;", "highlightLines": [21]}, "category": "code", "location": {"file": "src/core/JumpRate.sol", "line": 21, "column": 47}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "dc00f7c8fcd0", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "  function getSupplyRate(\n    uint256 borrowedLiquidity,\n    uint256 totalLiquidity\n  )\n    external\n    pure\n    override\n    returns (uint256 rate)\n  {\n    uint256 util = utilizationRate(borrowedLiquidity, totalLiquidity);\n    uint256 borrowRate = getBorrowRate(borrowedLiquidity, totalLiquidity);", "highlightLines": [25]}, "category": "code", "location": {"file": "src/core/JumpRate.sol", "line": 25, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "9af9764024fc", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 util = utilizationRate(borrowedLiquidity, totalLiquidity);", "highlightLines": [34]}, "category": "code", "location": {"file": "src/core/JumpRate.sol", "line": 34, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0522b5062a70", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 util = utilizationRate(borrowedLiquidity, totalLiquidity);\n    uint256 borrowRate = getBorrowRate(borrowedLiquidity, totalLiquidity);", "highlightLines": [34]}, "category": "code", "location": {"file": "src/core/JumpRate.sol", "line": 34, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "8ead7223eca4", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 borrowRate = getBorrowRate(borrowedLiquidity, totalLiquidity);", "highlightLines": [35]}, "category": "code", "location": {"file": "src/core/JumpRate.sol", "line": 35, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "40aa86c23656", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimal assumption - tokens with >18 or <18 decimals will cause overflow/underflow", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    return (borrowRate * util) / 1e18;", "highlightLines": [37]}, "category": "code", "location": {"file": "src/core/JumpRate.sol", "line": 37, "column": 32}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20"], "description": ""}, {"id": "8a3e9e8ef549", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    return (borrowRate * util) / 1e18;", "highlightLines": [37]}, "category": "code", "location": {"file": "src/core/JumpRate.sol", "line": 37, "column": 34}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "3b70c3f0a711", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "  function utilizationRate(uint256 borrowedLiquidity, uint256 totalLiquidity) private pure returns (uint256 rate) {\n    if (totalLiquidity == 0) return 0;", "highlightLines": [40]}, "category": "code", "location": {"file": "src/core/JumpRate.sol", "line": 40, "column": 3}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "32348c6c784b", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "    if (totalLiquidity == 0) return 0;\n    return (borrowedLiquidity * 1e18) / totalLiquidity;", "highlightLines": [41]}, "category": "code", "location": {"file": "src/core/JumpRate.sol", "line": 41, "column": 30}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "d16b1d9ed51b", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimal assumption - tokens with >18 or <18 decimals will cause overflow/underflow", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    return (borrowedLiquidity * 1e18) / totalLiquidity;", "highlightLines": [42]}, "category": "code", "location": {"file": "src/core/JumpRate.sol", "line": 42, "column": 31}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20"], "description": ""}, {"id": "6dca0910ba09", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    return (borrowedLiquidity * 1e18) / totalLiquidity;", "highlightLines": [42]}, "category": "code", "location": {"file": "src/core/JumpRate.sol", "line": 42, "column": 33}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "e2be79733367", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.4;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "6510f0806dc0", "fix": {"template": null, "available": false}, "title": "Base constructor called multiple times through diamond inheritance - may initialize twice", "ruleId": "rules.sol-reused-constructor", "snippet": {"code": "contract Lendgine is ERC20, JumpRate, Pair, ILendgine {", "highlightLines": [17]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 17, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#reused-base-constructor"], "description": ""}, {"id": "e335f3f4f066", "fix": {"template": null, "available": false}, "title": "SWC-125: Multiple inheritance may cause incorrect function resolution - check C3 linearization", "ruleId": "rules.sol-swc-125-inheritance-order", "snippet": {"code": "contract Lendgine is ERC20, JumpRate, Pair, ILendgine {", "highlightLines": [17]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 17, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-125"], "description": ""}, {"id": "efe2b2c3d3f5", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "contract Lendgine is ERC20, JumpRate, Pair, ILendgine {", "highlightLines": [17]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 17, "column": 1}, "severity": "medium", "references": [], "description": ""}, {"id": "80877cdc1a82", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract Lendgine is ERC20, JumpRate, Pair, ILendgine {\n  using Position for mapping(address => Position.Info);\n  using Position for Position.Info;\n\n  /*//////////////////////////////////////////////////////////////\n                                 EVENTS\n    //////////////////////////////////////////////////////////////*/\n\n  event Mint(address indexed sender, uint256 collateral, uint256 shares, uint256 liquidity, address indexed to);\n\n  event Burn(address indexed sender, uint256 collateral, uint256 shares, uint256 liquidity, address indexed to);\n\n  event Deposit(address indexed sender, uint256 size, uint256 liquidity, address indexed to);\n\n  event Withdraw(address indexed sender, uint256 size, uint256 liquidity, address indexed to);\n\n  event AccrueInterest(uint256 timeElapsed, uint256 collateral, uint256 liquidity);\n\n  event AccruePositionInterest(address indexed owner, uint256 rewardPerPosition);\n\n  event Collect(address indexed owner, address indexed to, uint256 amount);\n\n  /*//////////////////////////////////////////////////////////////\n                                 ERRORS\n    //////////////////////////////////////////////////////////////*/\n\n  error InputError();\n\n  error CompleteUtilizationError();\n\n  error InsufficientInputError();\n\n  error InsufficientPositionError();\n\n  /*//////////////////////////////////////////////////////////////\n                          LENDGINE STORAGE\n    //////////////////////////////////////////////////////////////*/\n\n  /// @inheritdoc ILendgine\n  mapping(address => Position.Info) public override positions;\n\n  /// @inheritdoc ILendgine\n  uint256 public override totalPositionSize;\n\n  /// @inheritdoc ILendgine\n  uint256 public override totalLiquidityBorrowed;\n\n  /// @inheritdoc ILendgine\n  uint256 public override rewardPerPositionStored;\n\n  /// @inheritdoc ILendgine\n  uint256 public override lastUpdate;\n\n  /// @inheritdoc ILendgine\n  function mint(\n    address to,\n    uint256 collateral,\n    bytes calldata data\n  )\n    external\n    override\n    nonReentrant\n    returns (uint256 shares)\n  {\n    _accrueInterest();\n\n    uint256 liquidity = convertCollateralToLiquidity(collateral);\n    shares = convertLiquidityToShare(liquidity);\n\n    if (collateral == 0 || liquidity == 0 || shares == 0) revert InputError();\n    if (liquidity > totalLiquidity) revert CompleteUtilizationError();\n    // next check is for the case when liquidity is borrowed but then was completely accrued\n    if (totalSupply > 0 && totalLiquidityBorrowed == 0) revert CompleteUtilizationError();\n\n    totalLiquidityBorrowed += liquidity;\n    (uint256 amount0, uint256 amount1) = burn(to, liquidity);\n    _mint(to, shares);\n\n    uint256 balanceBefore = Balance.balance(token1);\n    IMintCallback(msg.sender).mintCallback(collateral, amount0, amount1, liquidity, data);\n    uint256 balanceAfter = Balance.balance(token1);", "highlightLines": [17]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 17, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "b03d7f0241a1", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event Mint(address indexed sender, uint256 collateral, uint256 shares, uint256 liquidity, address indexed to);", "highlightLines": [25]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 25, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "8cc21ce4c6fe", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event Burn(address indexed sender, uint256 collateral, uint256 shares, uint256 liquidity, address indexed to);", "highlightLines": [27]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 27, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "bab0fc9890cf", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event Deposit(address indexed sender, uint256 size, uint256 liquidity, address indexed to);", "highlightLines": [29]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 29, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "e27081269f9c", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event Withdraw(address indexed sender, uint256 size, uint256 liquidity, address indexed to);", "highlightLines": [31]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 31, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "8ccb98fc8ee4", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event AccrueInterest(uint256 timeElapsed, uint256 collateral, uint256 liquidity);", "highlightLines": [33]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 33, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "213b90fa657b", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event AccruePositionInterest(address indexed owner, uint256 rewardPerPosition);", "highlightLines": [35]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 35, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "d9fdd0390003", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event Collect(address indexed owner, address indexed to, uint256 amount);", "highlightLines": [37]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 37, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "d676147722bf", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "  function mint(\n    address to,\n    uint256 collateral,\n    bytes calldata data\n  )\n    external", "highlightLines": [71]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 71, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "9d35d53c52ae", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "  function mint(\n    address to,\n    uint256 collateral,\n    bytes calldata data\n  )\n    external\n    override\n    nonReentrant\n    returns (uint256 shares)\n  {\n    _accrueInterest();\n\n    uint256 liquidity = convertCollateralToLiquidity(collateral);\n    shares = convertLiquidityToShare(liquidity);\n\n    if (collateral == 0 || liquidity == 0 || shares == 0) revert InputError();", "highlightLines": [71]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 71, "column": 3}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "0b36e632fb39", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 liquidity = convertCollateralToLiquidity(collateral);", "highlightLines": [82]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 82, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c44b60a6fe2b", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 liquidity = convertCollateralToLiquidity(collateral);\n    shares = convertLiquidityToShare(liquidity);", "highlightLines": [83]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 83, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "91eb05416a93", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    shares = convertLiquidityToShare(liquidity);\n\n    if (collateral == 0 || liquidity == 0 || shares == 0) revert InputError();\n    if (liquidity > totalLiquidity) revert CompleteUtilizationError();\n    // next check is for the case when liquidity is borrowed but then was completely accrued\n    if (totalSupply > 0 && totalLiquidityBorrowed == 0) revert CompleteUtilizationError();\n\n    totalLiquidityBorrowed += liquidity;\n    (uint256 amount0, uint256 amount1) = burn(to, liquidity);", "highlightLines": [84]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 84, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "47fea8c1aec1", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    (uint256 amount0, uint256 amount1) = burn(to, liquidity);\n    _mint(to, shares);\n\n    uint256 balanceBefore = Balance.balance(token1);", "highlightLines": [92]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 92, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "2297ce7713bc", "fix": {"template": null, "available": false}, "title": "NFT mint without supply check - potential overflow in tokenId", "ruleId": "rules.sol-nft-overflow-mint", "snippet": {"code": "    _mint(to, shares);", "highlightLines": [93]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 93, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "e487c716fa29", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 balanceBefore = Balance.balance(token1);", "highlightLines": [94]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 94, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "2875fcf6e6bd", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "    uint256 balanceBefore = Balance.balance(token1);\n    IMintCallback(msg.sender).mintCallback(collateral, amount0, amount1, liquidity, data);\n    uint256 balanceAfter = Balance.balance(token1);", "highlightLines": [95]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 95, "column": 5}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "f8e6ab13a8e7", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 balanceBefore = Balance.balance(token1);\n    IMintCallback(msg.sender).mintCallback(collateral, amount0, amount1, liquidity, data);\n    uint256 balanceAfter = Balance.balance(token1);", "highlightLines": [95]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 95, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "8370e35f01e7", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 balanceAfter = Balance.balance(token1);", "highlightLines": [97]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 97, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "587b7bda982b", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "  function burn(address to, bytes calldata data) external override nonReentrant returns (uint256 collateral) {", "highlightLines": [105]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 105, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "8b99c56eff76", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 shares = balanceOf[address(this)];", "highlightLines": [107]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 107, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ff10d588709d", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 shares = balanceOf[address(this)];\n    uint256 liquidity = convertShareToLiquidity(shares);", "highlightLines": [108]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 108, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "34ca7595838b", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 liquidity = convertShareToLiquidity(shares);", "highlightLines": [109]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 109, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c8bffc996e09", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 liquidity = convertShareToLiquidity(shares);\n    collateral = convertLiquidityToCollateral(liquidity);", "highlightLines": [109]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 109, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "90da235c12c1", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "  function deposit(\n    address to,\n    uint256 liquidity,\n    bytes calldata data\n  )\n    external\n    override\n    nonReentrant\n    returns (uint256 size)\n  {\n    _accrueInterest();\n\n    uint256 _totalPositionSize = totalPositionSize; // SLOAD\n    uint256 totalLiquiditySupplied = totalLiquidity + totalLiquidityBorrowed;\n\n    size = Position.convertLiquidityToPosition(liquidity, totalLiquiditySupplied, _totalPositionSize);\n\n    if (liquidity == 0 || size == 0) revert InputError();", "highlightLines": [123]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 123, "column": 3}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "d85c3c3e2193", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 _totalPositionSize = totalPositionSize; // SLOAD", "highlightLines": [134]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 134, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b42eb5e7b20b", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 _totalPositionSize = totalPositionSize; // SLOAD\n    uint256 totalLiquiditySupplied = totalLiquidity + totalLiquidityBorrowed;", "highlightLines": [135]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 135, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "0b10ce884471", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 totalLiquiditySupplied = totalLiquidity + totalLiquidityBorrowed;", "highlightLines": [136]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 136, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ccf52e1bcb55", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "    uint256 totalLiquiditySupplied = totalLiquidity + totalLiquidityBorrowed;", "highlightLines": [136]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 136, "column": 5}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "afbe0e65afb6", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 totalLiquiditySupplied = totalLiquidity + totalLiquidityBorrowed;\n\n    size = Position.convertLiquidityToPosition(liquidity, totalLiquiditySupplied, _totalPositionSize);", "highlightLines": [136]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 136, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "fb4c60760c6a", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    size = Position.convertLiquidityToPosition(liquidity, totalLiquiditySupplied, _totalPositionSize);\n\n    if (liquidity == 0 || size == 0) revert InputError();\n    // next check is for the case when liquidity is borrowed but then was completely accrued\n    if (totalLiquiditySupplied == 0 && totalPositionSize > 0) revert CompleteUtilizationError();\n\n    positions.update(to, SafeCast.toInt256(size), rewardPerPositionStored);\n    totalPositionSize = _totalPositionSize + size;", "highlightLines": [138]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 138, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "3fe0d6c02b3b", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "  function withdraw(\n    address to,\n    uint256 size\n  )\n    external\n    override\n    nonReentrant\n    returns (uint256 amount0, uint256 amount1, uint256 liquidity)\n  {\n    _accrueInterest();\n\n    uint256 _totalPositionSize = totalPositionSize; // SLOAD\n    uint256 _totalLiquidity = totalLiquidity; // SLOAD\n    uint256 totalLiquiditySupplied = _totalLiquidity + totalLiquidityBorrowed;\n\n    Position.Info memory positionInfo = positions[msg.sender]; // SLOAD\n    liquidity = Position.convertPositionToLiquidity(size, totalLiquiditySupplied, _totalPositionSize);\n\n    if (liquidity == 0 || size == 0) revert InputError();", "highlightLines": [152]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 152, "column": 3}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "25908bd8dcff", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 _totalPositionSize = totalPositionSize; // SLOAD", "highlightLines": [162]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 162, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3191bf8064c4", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 _totalPositionSize = totalPositionSize; // SLOAD\n    uint256 _totalLiquidity = totalLiquidity; // SLOAD", "highlightLines": [163]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 163, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "a6458abeb552", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 _totalLiquidity = totalLiquidity; // SLOAD", "highlightLines": [164]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 164, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "71358d192ad1", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 _totalLiquidity = totalLiquidity; // SLOAD\n    uint256 totalLiquiditySupplied = _totalLiquidity + totalLiquidityBorrowed;", "highlightLines": [164]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 164, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "d68f1d436652", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 totalLiquiditySupplied = _totalLiquidity + totalLiquidityBorrowed;", "highlightLines": [165]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 165, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ffe9c9a8d712", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "    uint256 totalLiquiditySupplied = _totalLiquidity + totalLiquidityBorrowed;", "highlightLines": [165]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 165, "column": 5}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "6a7a614edced", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 totalLiquiditySupplied = _totalLiquidity + totalLiquidityBorrowed;\n\n    Position.Info memory positionInfo = positions[msg.sender]; // SLOAD", "highlightLines": [165]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 165, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "6dbb3b4095c5", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    Position.Info memory positionInfo = positions[msg.sender]; // SLOAD\n    liquidity = Position.convertPositionToLiquidity(size, totalLiquiditySupplied, _totalPositionSize);", "highlightLines": [167]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 167, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "7e7c25fa9be7", "fix": {"template": null, "available": false}, "title": "Struct copied to memory from mapping - modifications won't persist to storage", "ruleId": "rules.sol-memory-struct-from-mapping", "snippet": {"code": "    Position.Info memory positionInfo = positions[msg.sender]; // SLOAD", "highlightLines": [167]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 167, "column": 14}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/DataLocation.sol"], "description": ""}, {"id": "55f7ae5d3f61", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    liquidity = Position.convertPositionToLiquidity(size, totalLiquiditySupplied, _totalPositionSize);\n\n    if (liquidity == 0 || size == 0) revert InputError();\n\n    if (size > positionInfo.size) revert InsufficientPositionError();\n    if (liquidity > _totalLiquidity) revert CompleteUtilizationError();\n\n    positions.update(msg.sender, -SafeCast.toInt256(size), rewardPerPositionStored);\n    totalPositionSize -= size;\n    (amount0, amount1) = burn(to, liquidity);", "highlightLines": [168]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 168, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "2eed0219ef7b", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    Position.Info storage position = positions[msg.sender]; // SLOAD\n    uint256 tokensOwed = position.tokensOwed;", "highlightLines": [195]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 195, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "be5c0215d387", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 tokensOwed = position.tokensOwed;", "highlightLines": [196]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 196, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "32653bf90cc8", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 tokensOwed = position.tokensOwed;\n\n    collateral = collateralRequested > tokensOwed ? tokensOwed : collateralRequested;", "highlightLines": [196]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 196, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "9c2c9c74b950", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    collateral = collateralRequested > tokensOwed ? tokensOwed : collateralRequested;\n\n    if (collateral > 0) {\n      position.tokensOwed = tokensOwed - collateral; // SSTORE\n      SafeTransferLib.safeTransfer(token1, to, collateral);\n    }", "highlightLines": [198]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 198, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "414e071c6715", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "  function convertLiquidityToShare(uint256 liquidity) public view override returns (uint256) {\n    uint256 _totalLiquidityBorrowed = totalLiquidityBorrowed; // SLOAD", "highlightLines": [213]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 213, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "92836255f276", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 _totalLiquidityBorrowed = totalLiquidityBorrowed; // SLOAD", "highlightLines": [214]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 214, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "5e8880e079e2", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    return FullMath.mulDiv(collateral * token1Scale, 1e18, 2 * upperBound);", "highlightLines": [225]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 225, "column": 54}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "6e6ec6c4c0f9", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    return FullMath.mulDiv(liquidity, 2 * upperBound, 1e18) / token1Scale;", "highlightLines": [230]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 230, "column": 55}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "2e6d3591abe8", "fix": {"template": null, "available": false}, "title": "Share calculation vulnerable to first depositor attack - attacker can inflate share price", "ruleId": "rules.sol-first-depositor-attack", "snippet": {"code": "    if (totalSupply == 0 || totalLiquidityBorrowed == 0) {", "highlightLines": [239]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 239, "column": 9}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs", "https://blog.openzeppelin.com/compound-comprehensive-security-assessment"], "description": ""}, {"id": "7991fb94e6be", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "      lastUpdate = block.timestamp;", "highlightLines": [240]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 240, "column": 20}, "severity": "medium", "references": [], "description": ""}, {"id": "da56c2a4bec3", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "      return;", "highlightLines": [241]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 241, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "23e381067600", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 timeElapsed = block.timestamp - lastUpdate;", "highlightLines": [243]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 243, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c2cfee38d83c", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 timeElapsed = block.timestamp - lastUpdate;\n    if (timeElapsed == 0) return;\n\n    uint256 _totalLiquidityBorrowed = totalLiquidityBorrowed; // SLOAD", "highlightLines": [244]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 244, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "e87159fb931c", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "    uint256 timeElapsed = block.timestamp - lastUpdate;", "highlightLines": [244]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 244, "column": 27}, "severity": "medium", "references": [], "description": ""}, {"id": "8980959ccceb", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 _totalLiquidityBorrowed = totalLiquidityBorrowed; // SLOAD", "highlightLines": [246]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 246, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "1e4650e4ab48", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 _totalLiquidityBorrowed = totalLiquidityBorrowed; // SLOAD\n    uint256 totalLiquiditySupplied = totalLiquidity + _totalLiquidityBorrowed; // SLOAD", "highlightLines": [247]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 247, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "542d2d0946f3", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 totalLiquiditySupplied = totalLiquidity + _totalLiquidityBorrowed; // SLOAD", "highlightLines": [248]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 248, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b5cd410e6f34", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "    uint256 totalLiquiditySupplied = totalLiquidity + _totalLiquidityBorrowed; // SLOAD", "highlightLines": [248]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 248, "column": 5}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "750b7c2208b4", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 totalLiquiditySupplied = totalLiquidity + _totalLiquidityBorrowed; // SLOAD\n\n    uint256 borrowRate = getBorrowRate(_totalLiquidityBorrowed, totalLiquiditySupplied);", "highlightLines": [248]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 248, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "48e3960134a8", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 borrowRate = getBorrowRate(_totalLiquidityBorrowed, totalLiquiditySupplied);", "highlightLines": [249]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 249, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "2c015cfbdf74", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 borrowRate = getBorrowRate(_totalLiquidityBorrowed, totalLiquiditySupplied);\n\n    uint256 dilutionLPRequested = (FullMath.mulDiv(borrowRate, _totalLiquidityBorrowed, 1e18) * timeElapsed) / 365 days;", "highlightLines": [250]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 250, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "bb7dcef44bb9", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 dilutionLPRequested = (FullMath.mulDiv(borrowRate, _totalLiquidityBorrowed, 1e18) * timeElapsed) / 365 days;", "highlightLines": [251]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 251, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "079d05de82f5", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 dilutionLPRequested = (FullMath.mulDiv(borrowRate, _totalLiquidityBorrowed, 1e18) * timeElapsed) / 365 days;\n    uint256 dilutionLP = dilutionLPRequested > _totalLiquidityBorrowed ? _totalLiquidityBorrowed : dilutionLPRequested;", "highlightLines": [252]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 252, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "c769a370ba87", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    uint256 dilutionLPRequested = (FullMath.mulDiv(borrowRate, _totalLiquidityBorrowed, 1e18) * timeElapsed) / 365 days;", "highlightLines": [252]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 252, "column": 89}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "b76817afa36c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 dilutionLP = dilutionLPRequested > _totalLiquidityBorrowed ? _totalLiquidityBorrowed : dilutionLPRequested;", "highlightLines": [253]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 253, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "1f80010b5d1d", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 dilutionLP = dilutionLPRequested > _totalLiquidityBorrowed ? _totalLiquidityBorrowed : dilutionLPRequested;\n    uint256 dilutionSpeculative = convertLiquidityToCollateral(dilutionLP);", "highlightLines": [253]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 253, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "43fc0c8303c5", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 dilutionSpeculative = convertLiquidityToCollateral(dilutionLP);", "highlightLines": [254]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 254, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "1f2e9aa7e4f0", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 dilutionSpeculative = convertLiquidityToCollateral(dilutionLP);\n\n    totalLiquidityBorrowed = _totalLiquidityBorrowed - dilutionLP;", "highlightLines": [254]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 254, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "6a73a87fe5cd", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    totalLiquidityBorrowed = _totalLiquidityBorrowed - dilutionLP;\n    rewardPerPositionStored += FullMath.mulDiv(dilutionSpeculative, 1e18, totalPositionSize);\n    lastUpdate = block.timestamp;", "highlightLines": [256]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 256, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "ce082403f7f6", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    rewardPerPositionStored += FullMath.mulDiv(dilutionSpeculative, 1e18, totalPositionSize);", "highlightLines": [257]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 257, "column": 69}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "c115904ba198", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "    lastUpdate = block.timestamp;", "highlightLines": [258]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 258, "column": 18}, "severity": "medium", "references": [], "description": ""}, {"id": "32bb7c240fb1", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 _rewardPerPositionStored = rewardPerPositionStored; // SLOAD", "highlightLines": [267]}, "category": "code", "location": {"file": "src/core/Lendgine.sol", "line": 267, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7a71b93b3269", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  modifier nonReentrant() virtual {\n    require(locked == 1, \"REENTRANCY\");\n\n    locked = 2;\n\n    _;\n\n    locked = 1;\n  }", "highlightLines": [11]}, "category": "code", "location": {"file": "src/core/ReentrancyGuard.sol", "line": 11, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "d30e3899dca5", "fix": {"template": null, "available": false}, "title": "Variable written twice without being read between - first write is dead store", "ruleId": "rules.sol-write-after-write", "snippet": {"code": "    require(locked == 1, \"REENTRANCY\");\n\n    locked = 2;", "highlightLines": [12]}, "category": "code", "location": {"file": "src/core/ReentrancyGuard.sol", "line": 12, "column": 13}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#write-after-write"], "description": ""}, {"id": "79c2b96b4988", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    locked = 2;\n\n    _;\n\n    locked = 1;", "highlightLines": [14]}, "category": "code", "location": {"file": "src/core/ReentrancyGuard.sol", "line": 14, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "2215e85e3003", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "\n    _;", "highlightLines": [15]}, "category": "code", "location": {"file": "src/core/ReentrancyGuard.sol", "line": 15, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "3d40221dd2ce", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function getLendgine(\n    address token0,\n    address token1,\n    uint256 token0Exp,\n    uint256 token1Exp,\n    uint256 upperBound\n  )\n    external\n    view\n    returns (address lendgine);", "highlightLines": [11]}, "category": "code", "location": {"file": "src/core/interfaces/IFactory.sol", "line": 11, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "a2db30ff6cb0", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function createLendgine(\n    address token0,\n    address token1,\n    uint8 token0Exp,\n    uint8 token1Exp,\n    uint256 upperBound\n  )\n    external\n    returns (address);", "highlightLines": [32]}, "category": "code", "location": {"file": "src/core/interfaces/IFactory.sol", "line": 32, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "7f54178ade86", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "  function mint(address to, uint256 collateral, bytes calldata data) external returns (uint256 shares);", "highlightLines": [31]}, "category": "code", "location": {"file": "src/core/interfaces/ILendgine.sol", "line": 31, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "d9823a8db64c", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function mint(address to, uint256 collateral, bytes calldata data) external returns (uint256 shares);", "highlightLines": [31]}, "category": "code", "location": {"file": "src/core/interfaces/ILendgine.sol", "line": 31, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "2f30071560eb", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "  function burn(address to, bytes calldata data) external returns (uint256 collateral);", "highlightLines": [38]}, "category": "code", "location": {"file": "src/core/interfaces/ILendgine.sol", "line": 38, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "8a4ab3a696c5", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function burn(address to, bytes calldata data) external returns (uint256 collateral);", "highlightLines": [38]}, "category": "code", "location": {"file": "src/core/interfaces/ILendgine.sol", "line": 38, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "b8e5d43a3845", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function deposit(address to, uint256 liquidity, bytes calldata data) external returns (uint256 size);", "highlightLines": [46]}, "category": "code", "location": {"file": "src/core/interfaces/ILendgine.sol", "line": 46, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "7ebe80ef6742", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function withdraw(address to, uint256 size) external returns (uint256 amount0, uint256 amount1, uint256 liquidity);", "highlightLines": [54]}, "category": "code", "location": {"file": "src/core/interfaces/ILendgine.sol", "line": 54, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "ff491a0777d7", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function collect(address to, uint256 collateralRequested) external returns (uint256 collateral);", "highlightLines": [68]}, "category": "code", "location": {"file": "src/core/interfaces/ILendgine.sol", "line": 68, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "ab3e45026681", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function swap(address to, uint256 amount0Out, uint256 amount1Out, bytes calldata data) external;", "highlightLines": [25]}, "category": "code", "location": {"file": "src/core/interfaces/IPair.sol", "line": 25, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "1b4a048332a1", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    external;", "highlightLines": [16]}, "category": "code", "location": {"file": "src/core/interfaces/callback/IMintCallback.sol", "line": 16, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "20baaedcf997", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.4;", "highlightLines": [2]}, "category": "code", "location": {"file": "src/core/libraries/Position.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "de7ec833a9a2", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 size;", "highlightLines": [28]}, "category": "code", "location": {"file": "src/core/libraries/Position.sol", "line": 28, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8e6adacead54", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 rewardPerPositionPaid;", "highlightLines": [29]}, "category": "code", "location": {"file": "src/core/libraries/Position.sol", "line": 29, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "9902db1d08af", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 tokensOwed;", "highlightLines": [30]}, "category": "code", "location": {"file": "src/core/libraries/Position.sol", "line": 30, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c5dbec084f82", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    Position.Info storage positionInfo = self[owner];\n    Position.Info memory _positionInfo = positionInfo;", "highlightLines": [46]}, "category": "code", "location": {"file": "src/core/libraries/Position.sol", "line": 46, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "0288c798ebbe", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    Position.Info memory _positionInfo = positionInfo;\n\n    uint256 tokensOwed;\n    if (_positionInfo.size > 0) {\n      tokensOwed = newTokensOwed(_positionInfo, rewardPerPosition);\n    }", "highlightLines": [47]}, "category": "code", "location": {"file": "src/core/libraries/Position.sol", "line": 47, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "c03ed34a9b35", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 tokensOwed;", "highlightLines": [48]}, "category": "code", "location": {"file": "src/core/libraries/Position.sol", "line": 48, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "5383eaab4cb5", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 sizeNext;", "highlightLines": [53]}, "category": "code", "location": {"file": "src/core/libraries/Position.sol", "line": 53, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "aad9b39e82f4", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "      sizeNext = PositionMath.addDelta(_positionInfo.size, sizeDelta);", "highlightLines": [59]}, "category": "code", "location": {"file": "src/core/libraries/Position.sol", "line": 59, "column": 54}, "severity": "info", "references": [], "description": ""}, {"id": "89fd66d66cf5", "fix": {"template": null, "available": false}, "title": "Potential reward-before-update pattern - verify state is updated before calculations (review suggested)", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    positionInfo.rewardPerPositionPaid = rewardPerPosition;\n    if (tokensOwed > 0) positionInfo.tokensOwed = _positionInfo.tokensOwed + tokensOwed;", "highlightLines": [63]}, "category": "code", "location": {"file": "src/core/libraries/Position.sol", "line": 63, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "962419e436e4", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "  function convertLiquidityToPosition(\n    uint256 liquidity,\n    uint256 totalLiquiditySupplied,\n    uint256 totalPositionSize\n  )\n    internal\n    pure\n    returns (uint256)\n  {\n    return\n      totalLiquiditySupplied == 0 ? liquidity : FullMath.mulDiv(liquidity, totalPositionSize, totalLiquiditySupplied);", "highlightLines": [73]}, "category": "code", "location": {"file": "src/core/libraries/Position.sol", "line": 73, "column": 3}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "acd374329ab4", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "  function addDelta(uint256 x, int256 y) internal pure returns (uint256 z) {\n    if (y < 0) {\n      require((z = x - uint256(-y)) < x, \"LS\");", "highlightLines": [12]}, "category": "code", "location": {"file": "src/core/libraries/PositionMath.sol", "line": 12, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "86b373d379de", "fix": {"template": null, "available": false}, "title": "Condition is always true/false (tautology/contradiction) - logic error", "ruleId": "rules.sol-tautology-condition", "snippet": {"code": "  function addDelta(uint256 x, int256 y) internal pure returns (uint256 z) {\n    if (y < 0) {", "highlightLines": [12]}, "category": "code", "location": {"file": "src/core/libraries/PositionMath.sol", "line": 12, "column": 21}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#tautology-or-contradiction"], "description": ""}, {"id": "f5e2febb414f", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "Token=i.addTokenUsingPush,i.handlePayload=i.handle...", "highlightLines": [155]}, "category": "secrets", "location": {"file": ".yarn/releases/yarn-3.3.1.cjs", "line": 155}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "6a9ff048ff8b", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "Token=function(e,t,i,n){return{image:e,startOffset...", "highlightLines": [159]}, "category": "secrets", "location": {"file": ".yarn/releases/yarn-3.3.1.cjs", "line": 159}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "0ef4aa71b64c", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "token=s.terminalType,this.result.occurrence=s.idx)...", "highlightLines": [190]}, "category": "secrets", "location": {"file": ".yarn/releases/yarn-3.3.1.cjs", "line": 190}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "3b4ab303f18e", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "Token=wf.setNodeLocationFull,this.setNodeLocationF...", "highlightLines": [196]}, "category": "secrets", "location": {"file": ".yarn/releases/yarn-3.3.1.cjs", "line": 196}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "5087ccb4baae", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "Token=je.LexerDefinitionErrorType=je.Lexer=je.EMPT...", "highlightLines": [244]}, "category": "secrets", "location": {"file": ".yarn/releases/yarn-3.3.1.cjs", "line": 244}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "b4ff7ee2740a", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "TOKEN:tke,ERR_HTTP_INVALID_HEADER_VALUE:rke,ERR_IN...", "highlightLines": [254]}, "category": "secrets", "location": {"file": ".yarn/releases/yarn-3.3.1.cjs", "line": 254}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "e5f9626958f2", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "password=(o=t.password)!==null&&o!==void", "highlightLines": [258]}, "category": "secrets", "location": {"file": ".yarn/releases/yarn-3.3.1.cjs", "line": 258}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "4129394cff89", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic API Key", "ruleId": "gitleaks-generic-api-key", "snippet": {"code": "apiKey:\"6fe4476ee5a1832882e326b506d14126\"", "highlightLines": [433]}, "category": "secrets", "location": {"file": ".yarn/plugins/@yarnpkg/plugin-interactive-tools.cjs", "line": 433}, "severity": "critical", "description": "Found generic-api-key in source code"}, {"id": "3905ddd0fb3f", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "Token=!0;zg.tokenize=r9.tokenize;zg.castInput=func...", "highlightLines": [435]}, "category": "secrets", "location": {"file": ".yarn/plugins/@yarnpkg/plugin-interactive-tools.cjs", "line": 435}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "9d3d6c8a74d5", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "password===this.options.password}var", "highlightLines": [278]}, "category": "secrets", "location": {"file": ".yarn/releases/yarn-3.3.1.cjs", "line": 278}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "03134f45957e", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "password=t.password||\"", "highlightLines": [299]}, "category": "secrets", "location": {"file": ".yarn/releases/yarn-3.3.1.cjs", "line": 299}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "86ecb0881bca", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "Token=!0;ym.tokenize=gT.tokenize;ym.castInput=func...", "highlightLines": [434]}, "category": "secrets", "location": {"file": ".yarn/releases/yarn-3.3.1.cjs", "line": 434}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "1029939965c7", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "password:\",required:!0,onCancel:()=>process.exit(1...", "highlightLines": [707]}, "category": "secrets", "location": {"file": ".yarn/releases/yarn-3.3.1.cjs", "line": 707}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "0794a9dcaac5", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "Token:{description:\"", "highlightLines": [708]}, "category": "secrets", "location": {"file": ".yarn/releases/yarn-3.3.1.cjs", "line": 708}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "44e02bee614d", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "Token:e}}},s=i?{npmScopes:n(i)}:{npmRegistries:n(r...", "highlightLines": [724]}, "category": "secrets", "location": {"file": ".yarn/releases/yarn-3.3.1.cjs", "line": 724}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "7bcd66212279", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "Token = Balance.balance(token);", "highlightLines": [36]}, "category": "secrets", "location": {"file": "src/periphery/Payment.sol", "line": 36}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "07d326175766", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "token: address(token1),", "highlightLines": [105]}, "category": "secrets", "location": {"file": "test/AccrueInterestTest.t.sol", "line": 105}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "1837b0d63a6c", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "token: address(token1),", "highlightLines": [213]}, "category": "secrets", "location": {"file": "test/BurnTest.t.sol", "line": 213}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "840173f7dccc", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "token: address(token1),", "highlightLines": [89]}, "category": "secrets", "location": {"file": "test/MintTest.t.sol", "line": 89}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "a8b7b7a5a7f8", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "token: address(token1),", "highlightLines": [100]}, "category": "secrets", "location": {"file": "test/MintTest.t.sol", "line": 100}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "f7c4afd6dfcc", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "token: address(token1),", "highlightLines": [155]}, "category": "secrets", "location": {"file": "test/MintTest.t.sol", "line": 155}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "5a5a2e82c00d", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "token: address(token1),", "highlightLines": [58]}, "category": "secrets", "location": {"file": "test/utils/TestHelper.sol", "line": 58}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "2674ffd67095", "cwe": "CWE-1035", "fix": {"template": "Run 'npm audit fix' or update commitizen to a patched version", "available": true}, "title": "Vulnerable npm package: commitizen", "ruleId": "npm-audit-commitizen", "category": "dependencies", "location": {"file": "package.json", "line": 0}, "severity": "low", "references": [], "description": "Vulnerable dependency: cz-conventional-changelog"}, {"id": "ede58a268227", "cwe": "CWE-1035", "fix": {"template": "Run 'npm audit fix' or update cz-conventional-changelog to a patched version", "available": true}, "title": "Vulnerable npm package: cz-conventional-changelog", "ruleId": "npm-audit-cz-conventional-changelog", "category": "dependencies", "location": {"file": "package.json", "line": 0}, "severity": "low", "references": [], "description": "Vulnerable dependency: commitizen"}, {"id": "dcdea415092d", "cwe": "CWE-1035", "fix": {"template": "Run 'npm audit fix' or update external-editor to a patched version", "available": true}, "title": "Vulnerable npm package: external-editor", "ruleId": "npm-audit-external-editor", "category": "dependencies", "location": {"file": "package.json", "line": 0}, "severity": "low", "references": [], "description": "Vulnerable dependency: tmp"}, {"id": "40db3f342e40", "cwe": "CWE-1035", "fix": {"template": "Run 'npm audit fix' or update inquirer to a patched version", "available": true}, "title": "Vulnerable npm package: inquirer", "ruleId": "npm-audit-inquirer", "category": "dependencies", "location": {"file": "package.json", "line": 0}, "severity": "low", "references": [], "description": "Vulnerable dependency: external-editor"}, {"id": "ba03a1803ccc", "cwe": "CWE-1035", "fix": {"template": "Run 'npm audit fix' or update lint-staged to a patched version", "available": true}, "title": "Vulnerable npm package: lint-staged", "ruleId": "npm-audit-lint-staged", "category": "dependencies", "location": {"file": "package.json", "line": 0}, "severity": "medium", "references": [], "description": "Vulnerable dependency: micromatch"}, {"id": "42fa0880f47d", "cwe": "CWE-1035", "fix": {"template": "Run 'npm audit fix' or update micromatch to a patched version", "available": true}, "title": "Vulnerable npm package: micromatch", "ruleId": "npm-audit-micromatch", "category": "dependencies", "location": {"file": "package.json", "line": 0}, "severity": "medium", "references": ["https://github.com/advisories/GHSA-952p-6rrq-rcjv"], "description": "Regular Expression Denial of Service (ReDoS) in micromatch"}, {"id": "1506bec4fb0c", "cwe": "CWE-1035", "fix": {"template": "Run 'npm audit fix' or update tmp to a patched version", "available": true}, "title": "Vulnerable npm package: tmp", "ruleId": "npm-audit-tmp", "category": "dependencies", "location": {"file": "package.json", "line": 0}, "severity": "low", "references": ["https://github.com/advisories/GHSA-52f5-9888-hmc6"], "description": "tmp allows arbitrary temporary file / directory write via symbolic link `dir` parameter"}]}]