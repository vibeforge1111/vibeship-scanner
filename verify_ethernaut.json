[{"findings":[{"id": "317b1cd9245b", "fix": {"template": null, "available": false}, "title": "Password reset endpoint - add rate limiting to prevent abuse", "ruleId": "rules.express-password-reset-no-rate-limit", "snippet": {"code": "export const loadLevelInstance = (level, reuse, reset) => ({ type: LOAD_LEVEL_INSTANCE, level, reuse, instance: undefined, reset })", "highlightLines": [26]}, "category": "code", "location": {"file": "client/src/actions/index.js", "line": 26, "column": 49}, "severity": "info", "references": [], "description": ""}, {"id": "bc51655e1bc6", "fix": {"template": null, "available": false}, "title": "React dangerouslySetInnerHTML - XSS risk if value is user-controlled. Use DOMPurify.sanitize() (CWE-79)", "ruleId": "rules.react-dangerously-set-inner-html", "snippet": {"code": "        <footer\n            className=\"deploy-footer\"\n            dangerouslySetInnerHTML={{ __html: strings.submitGameFooter }}\n            onClick={raiseIssue}\n        ></footer>", "highlightLines": [12]}, "category": "code", "location": {"file": "client/src/components/common/Footer.js", "line": 12, "column": 9}, "severity": "high", "references": [], "description": ""}, {"id": "858fb5bd5b93", "fix": {"template": null, "available": false}, "title": "React dangerouslySetInnerHTML - XSS risk if data is user-controlled (CWE-79)", "ruleId": "rules.react-dangerous-innerhtml-regex", "snippet": {"code": "            dangerouslySetInnerHTML={{ __html: strings.submitGameFooter }}", "highlightLines": [14]}, "category": "code", "location": {"file": "client/src/components/common/Footer.js", "line": 14, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "ed4f9d9b36dc", "fix": {"template": null, "available": false}, "title": "React __html property - XSS risk if assigned user-controlled data (CWE-79)", "ruleId": "rules.dom-xss-inner-html-pattern", "snippet": {"code": "            dangerouslySetInnerHTML={{ __html: strings.submitGameFooter }}", "highlightLines": [14]}, "category": "code", "location": {"file": "client/src/components/common/Footer.js", "line": 14, "column": 40}, "severity": "high", "references": [], "description": ""}, {"id": "2614e6d5524c", "fix": {"template": null, "available": false}, "title": "React dangerouslySetInnerHTML - XSS risk if value is user-controlled. Use DOMPurify.sanitize() (CWE-79)", "ruleId": "rules.react-dangerously-set-inner-html", "snippet": {"code": "                <footer\n                    className=\"footer\"\n                    dangerouslySetInnerHTML={{ __html: strings.submitLevelFooter }}\n                ></footer>", "highlightLines": [19]}, "category": "code", "location": {"file": "client/src/components/common/Footer.js", "line": 19, "column": 17}, "severity": "high", "references": [], "description": ""}, {"id": "9f8bcf63f4c9", "fix": {"template": null, "available": false}, "title": "React dangerouslySetInnerHTML - XSS risk if data is user-controlled (CWE-79)", "ruleId": "rules.react-dangerous-innerhtml-regex", "snippet": {"code": "                    dangerouslySetInnerHTML={{ __html: strings.submitLevelFooter }}", "highlightLines": [21]}, "category": "code", "location": {"file": "client/src/components/common/Footer.js", "line": 21, "column": 21}, "severity": "high", "references": [], "description": ""}, {"id": "446e2f2b40fa", "fix": {"template": null, "available": false}, "title": "React __html property - XSS risk if assigned user-controlled data (CWE-79)", "ruleId": "rules.dom-xss-inner-html-pattern", "snippet": {"code": "                    dangerouslySetInnerHTML={{ __html: strings.submitLevelFooter }}", "highlightLines": [21]}, "category": "code", "location": {"file": "client/src/components/common/Footer.js", "line": 21, "column": 48}, "severity": "high", "references": [], "description": ""}, {"id": "93e029148951", "fix": {"template": null, "available": false}, "title": "React dangerouslySetInnerHTML - XSS risk if value is user-controlled. Use DOMPurify.sanitize() (CWE-79)", "ruleId": "rules.react-dangerously-set-inner-html", "snippet": {"code": "                <footer\n                    className=\"footer\"\n                    dangerouslySetInnerHTML={{ __html: strings.footer }}\n                ></footer>", "highlightLines": [24]}, "category": "code", "location": {"file": "client/src/components/common/Footer.js", "line": 24, "column": 17}, "severity": "high", "references": [], "description": ""}, {"id": "b45c6f5fba13", "fix": {"template": null, "available": false}, "title": "React dangerouslySetInnerHTML - XSS risk if data is user-controlled (CWE-79)", "ruleId": "rules.react-dangerous-innerhtml-regex", "snippet": {"code": "                    dangerouslySetInnerHTML={{ __html: strings.footer }}", "highlightLines": [26]}, "category": "code", "location": {"file": "client/src/components/common/Footer.js", "line": 26, "column": 21}, "severity": "high", "references": [], "description": ""}, {"id": "4081368825c5", "fix": {"template": null, "available": false}, "title": "React __html property - XSS risk if assigned user-controlled data (CWE-79)", "ruleId": "rules.dom-xss-inner-html-pattern", "snippet": {"code": "                    dangerouslySetInnerHTML={{ __html: strings.footer }}", "highlightLines": [26]}, "category": "code", "location": {"file": "client/src/components/common/Footer.js", "line": 26, "column": 48}, "severity": "high", "references": [], "description": ""}, {"id": "281842c7a019", "fix": {"template": null, "available": false}, "title": "Potential Heroku API key (UUID format) - verify if secret", "ruleId": "rules._shared.shared-heroku-api-key", "snippet": {"code": "                        formId=\"5c2762b1-ad80-4a47-9ef5-91f98d9e9419\"", "highlightLines": [33]}, "category": "code", "location": {"file": "client/src/components/leaderboard/AliasModal.js", "line": 33, "column": 33}, "severity": "info", "references": [], "description": ""}, {"id": "2d0cbc95328c", "fix": {"template": null, "available": false}, "title": "innerHTML assignment - potential XSS vulnerability", "ruleId": "rules.js-innerhtml-xss", "snippet": {"code": "    element.innerHTML = \"Thanks for submitting the form.\"", "highlightLines": [96]}, "category": "code", "location": {"file": "client/src/components/leaderboard/Hubspot.js", "line": 96, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "3ffcaf5b67e4", "fix": {"template": null, "available": false}, "title": "Error logged to console - may expose sensitive information in production. Use proper error handling", "ruleId": "rules.console-log-in-catch", "snippet": {"code": "    } catch (err) { \n        console.log(err)\n    }", "highlightLines": [8]}, "category": "code", "location": {"file": "client/src/components/leaderboard/checkIfAliasExist.js", "line": 8, "column": 7}, "severity": "info", "references": [], "description": ""}, {"id": "9788e53c40c6", "fix": {"template": null, "available": false}, "title": "Error logged to console - may expose sensitive information in production. Use proper error handling", "ruleId": "rules.console-log-in-catch", "snippet": {"code": "    } catch (err) { \n        console.log(err)\n    }", "highlightLines": [17]}, "category": "code", "location": {"file": "client/src/components/leaderboard/checkIfAliasExist.js", "line": 17, "column": 7}, "severity": "info", "references": [], "description": ""}, {"id": "406da4fe70ca", "fix": {"template": null, "available": false}, "title": "React __html property - XSS risk if assigned user-controlled data (CWE-79)", "ruleId": "rules.dom-xss-inner-html-pattern", "snippet": {"code": "        __html: hljs.highlight(this.state.source, { language: 'solidity' }).value,", "highlightLines": [32]}, "category": "code", "location": {"file": "client/src/components/levels/Code.js", "line": 32, "column": 9}, "severity": "high", "references": [], "description": ""}, {"id": "dd7375ceff8e", "fix": {"template": null, "available": false}, "title": "React dangerouslySetInnerHTML - XSS risk if value is user-controlled. Use DOMPurify.sanitize() (CWE-79)", "ruleId": "rules.react-dangerously-set-inner-html", "snippet": {"code": "      <pre><code className='hljs' dangerouslySetInnerHTML={this.getHighlightedCode()}></code></pre>", "highlightLines": [56]}, "category": "code", "location": {"file": "client/src/components/levels/Code.js", "line": 56, "column": 12}, "severity": "high", "references": [], "description": ""}, {"id": "3b657461ed00", "fix": {"template": null, "available": false}, "title": "React dangerouslySetInnerHTML - XSS risk if data is user-controlled (CWE-79)", "ruleId": "rules.react-dangerous-innerhtml-regex", "snippet": {"code": "      <pre><code className='hljs' dangerouslySetInnerHTML={this.getHighlightedCode()}></code></pre>", "highlightLines": [56]}, "category": "code", "location": {"file": "client/src/components/levels/Code.js", "line": 56, "column": 35}, "severity": "high", "references": [], "description": ""}, {"id": "00449112fdda", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "  [NETWORKS.MUMBAI.name]: \"0x09902A56d04a9446601a0d451E07459dC5aF0820\",", "highlightLines": [132]}, "category": "code", "location": {"file": "client/src/constants.js", "line": 132, "column": 28}, "severity": "medium", "references": [], "description": ""}, {"id": "33681fe1af9a", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "  [NETWORKS.GOERLI.name]: \"0x09902A56d04a9446601a0d451E07459dC5aF0820\",", "highlightLines": [133]}, "category": "code", "location": {"file": "client/src/constants.js", "line": 133, "column": 28}, "severity": "medium", "references": [], "description": ""}, {"id": "dc470d031fd6", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "  [NETWORKS.SEPOLIA.name]: \"0x09902A56d04a9446601a0d451E07459dC5aF0820\",", "highlightLines": [134]}, "category": "code", "location": {"file": "client/src/constants.js", "line": 134, "column": 29}, "severity": "medium", "references": [], "description": ""}, {"id": "e46130eee667", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "  [NETWORKS.OPTIMISM_GOERLI.name]: \"0x09902A56d04a9446601a0d451E07459dC5aF0820\",", "highlightLines": [135]}, "category": "code", "location": {"file": "client/src/constants.js", "line": 135, "column": 37}, "severity": "medium", "references": [], "description": ""}, {"id": "d5c7ad079bfb", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "  [NETWORKS.ARBITRUM_GOERLI.name]: \"0x09902A56d04a9446601a0d451E07459dC5aF0820\",", "highlightLines": [136]}, "category": "code", "location": {"file": "client/src/constants.js", "line": 136, "column": 37}, "severity": "medium", "references": [], "description": ""}, {"id": "e074a42463d3", "fix": {"template": null, "available": false}, "title": "Dynamic property assignment - prototype pollution if key is user-controlled", "ruleId": "rules.bracket-notation-user-input", "snippet": {"code": "    (network) => (id_to_network[NETWORKS[network].id] = NETWORKS[network].name)", "highlightLines": [188]}, "category": "code", "location": {"file": "client/src/constants.js", "line": 188, "column": 18}, "severity": "medium", "references": [], "description": ""}, {"id": "3257d608ce4b", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "  return `https://raw.githubusercontent.com/OpenZeppelin/ethernaut-leaderboard/update/boards/networkleaderboards/${network}LeaderBoard.json`", "highlightLines": [198]}, "category": "code", "location": {"file": "client/src/constants.js", "line": 198, "column": 68}, "severity": "medium", "references": [], "description": ""}, {"id": "3dbfeb34fa98", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "            const leaderboardNetworkName = getLeaderboardNetworkNameFromNetworkName(currentNetworkName)", "highlightLines": [69]}, "category": "code", "location": {"file": "client/src/containers/Leaderboard.js", "line": 69, "column": 44}, "severity": "medium", "references": [], "description": ""}, {"id": "80d3831badfe", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "    const getLeaderboardNetworkNameFromNetworkName = (networkName) => {", "highlightLines": [85]}, "category": "code", "location": {"file": "client/src/containers/Leaderboard.js", "line": 85, "column": 11}, "severity": "medium", "references": [], "description": ""}, {"id": "466457e4679d", "fix": {"template": null, "available": false}, "title": "Error logged to console - may expose sensitive information in production. Use proper error handling", "ruleId": "rules.console-log-in-catch", "snippet": {"code": "    } catch (e) {\n      console.log(e);\n    }", "highlightLines": [146]}, "category": "code", "location": {"file": "client/src/containers/Level.js", "line": 146, "column": 7}, "severity": "info", "references": [], "description": ""}, {"id": "9687f42117b7", "fix": {"template": null, "available": false}, "title": "Use === instead of == for comparison to avoid type coercion issues", "ruleId": "rules.double-equals-undefined", "snippet": {"code": "      level && state.contracts.levels[level.deployedAddress] !== undefined,", "highlightLines": [359]}, "category": "code", "location": {"file": "client/src/containers/Level.js", "line": 359, "column": 63}, "severity": "info", "references": [], "description": ""}, {"id": "a959356b9dd3", "fix": {"template": null, "available": false}, "title": "parseInt without radix parameter - specify base to avoid unexpected behavior", "ruleId": "rules.parseint-radix-missing", "snippet": {"code": "    store.dispatch(actions.setNetworkId(parseInt(res)));", "highlightLines": [47]}, "category": "code", "location": {"file": "client/src/index.js", "line": 47, "column": 41}, "severity": "info", "references": [], "description": ""}, {"id": "64ace225fc4d", "fix": {"template": null, "available": false}, "title": "Console error logging - ensure not exposed to users in production (CWE-209)", "ruleId": "rules.nodejs-console-error-production", "snippet": {"code": "      console.error(error);", "highlightLines": [77]}, "category": "code", "location": {"file": "client/src/index.js", "line": 77, "column": 7}, "severity": "info", "references": [], "description": ""}, {"id": "fe8ec9e9bf32", "fix": {"template": null, "available": false}, "title": "Lodash import detected - verify version >= 4.17.21 for security patches", "ruleId": "rules.lodash-import-check", "snippet": {"code": "import _ from 'lodash'", "highlightLines": [1]}, "category": "code", "location": {"file": "client/src/middlewares/activateLevel.js", "line": 1, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "3971d4ee2de9", "fix": {"template": null, "available": false}, "title": "Use === instead of == for comparison to avoid type coercion issues", "ruleId": "rules.double-equals-undefined", "snippet": {"code": "  // console.log(`TRY COLLECT_STATS >`, state.contracts.ethernaut !== undefined)", "highlightLines": [18]}, "category": "code", "location": {"file": "client/src/middlewares/collectStats.js", "line": 18, "column": 68}, "severity": "info", "references": [], "description": ""}, {"id": "6bf009ce50c8", "fix": {"template": null, "available": false}, "title": "Logging user-controlled variable - potential log injection if input contains newlines", "ruleId": "rules.js-log-user-input-regex", "snippet": {"code": "  // console.log(`query`, query)", "highlightLines": [34]}, "category": "code", "location": {"file": "client/src/middlewares/collectStats.js", "line": 34, "column": 6}, "severity": "medium", "references": [], "description": ""}, {"id": "3670a7b3bc49", "fix": {"template": null, "available": false}, "title": "Use === instead of == for comparison to avoid type coercion issues", "ruleId": "rules.double-equals-undefined", "snippet": {"code": "  if (action.contract !== undefined) return next(action)", "highlightLines": [11]}, "category": "code", "location": {"file": "client/src/middlewares/loadEthernautContract.js", "line": 11, "column": 24}, "severity": "info", "references": [], "description": ""}, {"id": "ae5267e79ec9", "fix": {"template": null, "available": false}, "title": "Specific error for missing user enables username enumeration (CWE-204)", "ruleId": "rules.auth-username-enumeration", "snippet": {"code": "    window.alert(strings.noLevelsDataMessage) //need to do something here more nicer to tell user", "highlightLines": [41]}, "category": "code", "location": {"file": "client/src/middlewares/loadGamedata.js", "line": 41, "column": 26}, "severity": "medium", "references": [], "description": ""}, {"id": "cbf7608c4653", "fix": {"template": null, "available": false}, "title": "Specific error for missing user enables username enumeration (CWE-204)", "ruleId": "rules.auth-username-enumeration", "snippet": {"code": "// -- ELSE notify the user that they need to deploy on this network to play the game or switch to a network that has the game, then run deployment script and set returned addresses to localstorage", "highlightLines": [12]}, "category": "code", "location": {"file": "client/src/middlewares/setNetwork.js", "line": 12, "column": 12}, "severity": "medium", "references": [], "description": ""}, {"id": "e46e77109156", "fix": {"template": null, "available": false}, "title": "Code marked for removal - clean up before production", "ruleId": "rules._shared.shared-todo-remove", "snippet": {"code": "  window.localdeploy = deployAdminContracts; //TODO later remove refrence to contract from windows", "highlightLines": [14]}, "category": "code", "location": {"file": "client/src/middlewares/setNetwork.js", "line": 14, "column": 46}, "severity": "info", "references": [], "description": ""}, {"id": "bcbd5277b82d", "fix": {"template": null, "available": false}, "title": "Use === instead of == for comparison to avoid type coercion issues", "ruleId": "rules.double-equals-undefined", "snippet": {"code": "  if (store.getState().network.networkId !== undefined && store.getState().network.networkId !== action.id) {", "highlightLines": [26]}, "category": "code", "location": {"file": "client/src/middlewares/setNetwork.js", "line": 26, "column": 43}, "severity": "info", "references": [], "description": ""}, {"id": "dd7d2821c629", "fix": {"template": null, "available": false}, "title": "Console error logging - ensure not exposed to users in production (CWE-209)", "ruleId": "rules.nodejs-console-error-production", "snippet": {"code": "    console.error(error)", "highlightLines": [74]}, "category": "code", "location": {"file": "client/src/middlewares/submitLevelInstance.js", "line": 74, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "38be7971b181", "fix": {"template": null, "available": false}, "title": "Dynamic property assignment - prototype pollution if key is user-controlled", "ruleId": "rules.bracket-notation-user-input", "snippet": {"code": "    completedLevels[levelAddress] = true;", "highlightLines": [31]}, "category": "code", "location": {"file": "client/src/middlewares/syncPlayerProgress.js", "line": 31, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "2686cd5d620b", "fix": {"template": null, "available": false}, "title": "Password reset endpoint - add rate limiting to prevent abuse", "ruleId": "rules.express-password-reset-no-rate-limit", "snippet": {"code": "      if (action.reset) newState = {", "highlightLines": [33]}, "category": "code", "location": {"file": "client/src/reducers/playerReducer.js", "line": 33, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "822f4d45b187", "fix": {"template": null, "available": false}, "title": "Secret/token logged to console - remove in production (CWE-532)", "ruleId": "rules.js-console-log-secret", "snippet": {"code": "    // console.log(`CACHE PLAYER`, key, data)", "highlightLines": [76]}, "category": "code", "location": {"file": "client/src/reducers/playerReducer.js", "line": 76, "column": 8}, "severity": "high", "references": [], "description": ""}, {"id": "a422884023d0", "fix": {"template": null, "available": false}, "title": "Secret/token logged to console - remove in production (CWE-532)", "ruleId": "rules.js-console-log-secret", "snippet": {"code": "  //  console.log(`RESTORE PLAYER`, key, data)", "highlightLines": [84]}, "category": "code", "location": {"file": "client/src/reducers/playerReducer.js", "line": 84, "column": 7}, "severity": "high", "references": [], "description": ""}, {"id": "b9e6fd2a5f23", "fix": {"template": null, "available": false}, "title": "Reading location.href - DOM XSS source if rendered without sanitization (CWE-79)", "ruleId": "rules.dom-xss-location-href", "snippet": {"code": "    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);", "highlightLines": [26]}, "category": "code", "location": {"file": "client/src/serviceWorker.js", "line": 26, "column": 55}, "severity": "info", "references": [], "description": ""}, {"id": "aabb2018035c", "fix": {"template": null, "available": false}, "title": "Use === instead of == for comparison to avoid type coercion issues", "ruleId": "rules.double-equals-undefined", "snippet": {"code": "        if (installingWorker == null) {", "highlightLines": [63]}, "category": "code", "location": {"file": "client/src/serviceWorker.js", "line": 63, "column": 30}, "severity": "info", "references": [], "description": ""}, {"id": "fa4056649db2", "fix": {"template": null, "available": false}, "title": "Console error logging - ensure not exposed to users in production (CWE-209)", "ruleId": "rules.nodejs-console-error-production", "snippet": {"code": "      console.error('Error during service worker registration:', error);", "highlightLines": [97]}, "category": "code", "location": {"file": "client/src/serviceWorker.js", "line": 97, "column": 7}, "severity": "info", "references": [], "description": ""}, {"id": "d54f0fa36835", "fix": {"template": null, "available": false}, "title": "Fetch API with potentially user-controlled URL - validate to prevent SSRF", "ruleId": "rules.fetch-ssrf-user-url-v2", "snippet": {"code": "  fetch(swUrl)", "highlightLines": [103]}, "category": "code", "location": {"file": "client/src/serviceWorker.js", "line": 103, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "a3d03d9c1de2", "fix": {"template": null, "available": false}, "title": "Fetch with variable URL - potential SSRF if URL is user-controlled", "ruleId": "rules.js-fetch-variable-url", "snippet": {"code": "  fetch(swUrl)", "highlightLines": [103]}, "category": "code", "location": {"file": "client/src/serviceWorker.js", "line": 103, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "30eb47c10968", "fix": {"template": null, "available": false}, "title": "Pug unescaped output - XSS risk if variable contains user input", "ruleId": "rules.pug-render-unescaped", "snippet": {"code": "        (contentType != null && contentType.indexOf('javascript') === -1)", "highlightLines": [109]}, "category": "code", "location": {"file": "client/src/serviceWorker.js", "line": 109, "column": 22}, "severity": "medium", "references": [], "description": ""}, {"id": "f25530b3a45a", "fix": {"template": null, "available": false}, "title": "Security/linting suppression comment - verify this is justified", "ruleId": "rules._shared.shared-comment-disable-security", "snippet": {"code": "/* eslint-disable no-underscore-dangle */", "highlightLines": [1]}, "category": "code", "location": {"file": "client/src/store.js", "line": 1, "column": 1}, "severity": "medium", "references": [], "description": ""}, {"id": "ba280ab6682f", "fix": {"template": null, "available": false}, "title": "Object.assign with user input - prototype pollution risk (CWE-1321)", "ruleId": "rules.prototype-pollution-object-assign", "snippet": {"code": "  const logger = Object.assign({}, console);", "highlightLines": [12]}, "category": "code", "location": {"file": "client/src/utils/^^.js", "line": 12, "column": 18}, "severity": "medium", "references": [], "description": ""}, {"id": "4791c6824b2c", "fix": {"template": null, "available": false}, "title": "Dynamic property assignment - prototype pollution if key is user-controlled", "ruleId": "rules.bracket-notation-user-input", "snippet": {"code": "        args[i] = arg", "highlightLines": [166]}, "category": "code", "location": {"file": "client/src/utils/^^.js", "line": 166, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "3d426e47863d", "fix": {"template": null, "available": false}, "title": "Math.random() is not cryptographically secure - use crypto.randomBytes()", "ruleId": "rules.js-math-random", "snippet": {"code": "export function randInt(min, max) { return Math.floor((max - min) * Math.random()) + min }", "highlightLines": [322]}, "category": "code", "location": {"file": "client/src/utils/^^.js", "line": 322, "column": 69}, "severity": "info", "references": [], "description": ""}, {"id": "95d07446093c", "fix": {"template": null, "available": false}, "title": "Math.random() is not cryptographically secure - use crypto.randomBytes", "ruleId": "rules.math-random-security", "snippet": {"code": "export function randInt(min, max) { return Math.floor((max - min) * Math.random()) + min }", "highlightLines": [322]}, "category": "code", "location": {"file": "client/src/utils/^^.js", "line": 322, "column": 69}, "severity": "medium", "references": [], "description": ""}, {"id": "ec0f0da9a88d", "fix": {"template": null, "available": false}, "title": "Math.random() is not cryptographically secure - use crypto.randomBytes() for security", "ruleId": "rules.math-random-security-v2", "snippet": {"code": "export function randInt(min, max) { return Math.floor((max - min) * Math.random()) + min }", "highlightLines": [322]}, "category": "code", "location": {"file": "client/src/utils/^^.js", "line": 322, "column": 69}, "severity": "info", "references": [], "description": ""}, {"id": "b83743165b14", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "import * as LocalFactoryABI from \"contracts/build/contracts/factory/LocalFactory.sol/Factory.json\";", "highlightLines": [4]}, "category": "code", "location": {"file": "client/src/utils/contractutil.js", "line": 4, "column": 35}, "severity": "medium", "references": [], "description": ""}, {"id": "797e00a3250c", "fix": {"template": null, "available": false}, "title": "Secret/token logged to console - remove in production (CWE-532)", "ruleId": "rules.js-console-log-secret", "snippet": {"code": "  // console.log(`CACHE CONTRACT`, key, data)", "highlightLines": [12]}, "category": "code", "location": {"file": "client/src/utils/contractutil.js", "line": 12, "column": 6}, "severity": "high", "references": [], "description": ""}, {"id": "ce0e46c46881", "fix": {"template": null, "available": false}, "title": "Secret/token logged to console - remove in production (CWE-532)", "ruleId": "rules.js-console-log-secret", "snippet": {"code": "  // console.log(`RESTORE CONTRACT`, key, data)", "highlightLines": [19]}, "category": "code", "location": {"file": "client/src/utils/contractutil.js", "line": 19, "column": 6}, "severity": "high", "references": [], "description": ""}, {"id": "61cc2d0e46f4", "fix": {"template": null, "available": false}, "title": "Dynamic property assignment - prototype pollution if key is user-controlled", "ruleId": "rules.bracket-notation-user-input", "snippet": {"code": "  data[key] = value;", "highlightLines": [25]}, "category": "code", "location": {"file": "client/src/utils/contractutil.js", "line": 25, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "8ebc73213354", "fix": {"template": null, "available": false}, "title": "Fetch API with potentially user-controlled URL - validate to prevent SSRF", "ruleId": "rules.fetch-ssrf-user-url-v2", "snippet": {"code": "  const contractFile = await fetch(`contracts/levels/${level.instanceContract}`);", "highlightLines": [178]}, "category": "code", "location": {"file": "client/src/utils/contractutil.js", "line": 178, "column": 30}, "severity": "medium", "references": [], "description": ""}, {"id": "65b1c051d4e6", "fix": {"template": null, "available": false}, "title": "URLSearchParams usage - ensure query data is sanitized before rendering (CWE-79)", "ruleId": "rules.dom-xss-url-params", "snippet": {"code": "  const urlencoded = new URLSearchParams();", "highlightLines": [184]}, "category": "code", "location": {"file": "client/src/utils/contractutil.js", "line": 184, "column": 22}, "severity": "info", "references": [], "description": ""}, {"id": "268d164bae0c", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "import * as LocalFactoryABI from \"contracts/build/contracts/factory/LocalFactory.sol/Factory.json\";", "highlightLines": [3]}, "category": "code", "location": {"file": "client/src/utils/deploycontract.js", "line": 3, "column": 35}, "severity": "medium", "references": [], "description": ""}, {"id": "2293456a816f", "fix": {"template": null, "available": false}, "title": "Error logged to console - may expose sensitive information in production. Use proper error handling", "ruleId": "rules.console-log-in-catch", "snippet": {"code": "  } catch (err) {\n    console.log(err);\n    return false;\n    // alert(err.message);\n  }", "highlightLines": [77]}, "category": "code", "location": {"file": "client/src/utils/deploycontract.js", "line": 77, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "e5836c054b75", "fix": {"template": null, "available": false}, "title": "Dynamic property assignment - prototype pollution if key is user-controlled", "ruleId": "rules.bracket-notation-user-input", "snippet": {"code": "      (key, index) => (gameData[key] = deployedCoreContracts[index])", "highlightLines": [114]}, "category": "code", "location": {"file": "client/src/utils/deploycontract.js", "line": 114, "column": 23}, "severity": "medium", "references": [], "description": ""}, {"id": "8ebf26a19aef", "fix": {"template": null, "available": false}, "title": "Error logged to console - may expose sensitive information in production. Use proper error handling", "ruleId": "rules.console-log-in-catch", "snippet": {"code": "  } catch (err) {\n    // TODO maybe refresh the page if they fail to deploy the contracts\n    console.log(err);\n    // alert(err.message); //todo show a notification prompting the user to click something to restart the process\n    return false;\n  } finally {", "highlightLines": [127]}, "category": "code", "location": {"file": "client/src/utils/deploycontract.js", "line": 127, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "439dfcdde45d", "fix": {"template": null, "available": false}, "title": "Specific error for missing user enables username enumeration (CWE-204)", "ruleId": "rules.auth-username-enumeration", "snippet": {"code": "    // alert(err.message); //todo show a notification prompting the user to click something to restart the process", "highlightLines": [130]}, "category": "code", "location": {"file": "client/src/utils/deploycontract.js", "line": 130, "column": 42}, "severity": "medium", "references": [], "description": ""}, {"id": "bb6cb041dda4", "fix": {"template": null, "available": false}, "title": "HACK comment found - technical debt or workaround", "ruleId": "rules._shared.shared-hack-comment", "snippet": {"code": "  // // HACK: Doing this here instead of `import` so that the project uses the web3.js version", "highlightLines": [16]}, "category": "code", "location": {"file": "client/src/utils/ethutil.js", "line": 16, "column": 6}, "severity": "info", "references": [], "description": ""}, {"id": "7e305dbf6bd0", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "  if (address === '0x0000000000000000000000000000000000000000') return false;", "highlightLines": [129]}, "category": "code", "location": {"file": "client/src/utils/ethutil.js", "line": 129, "column": 20}, "severity": "medium", "references": [], "description": ""}, {"id": "c37015c25265", "fix": {"template": null, "available": false}, "title": "HACK comment found - technical debt or workaround", "ruleId": "rules._shared.shared-hack-comment", "snippet": {"code": "    // HACK: do not log known error when setting event log filters", "highlightLines": [190]}, "category": "code", "location": {"file": "client/src/utils/ethutil.js", "line": 190, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "86d89ec94e13", "fix": {"template": null, "available": false}, "title": "Console error logging - ensure not exposed to users in production (CWE-209)", "ruleId": "rules.nodejs-console-error-production", "snippet": {"code": "      console.error('Error in RPC response:\\n', res.error.message);", "highlightLines": [192]}, "category": "code", "location": {"file": "client/src/utils/ethutil.js", "line": 192, "column": 7}, "severity": "info", "references": [], "description": ""}, {"id": "88f4671d12d3", "fix": {"template": null, "available": false}, "title": "Use === instead of == for comparison to avoid type coercion issues", "ruleId": "rules.double-equals-undefined", "snippet": {"code": "        if (value === undefined) {", "highlightLines": [25]}, "category": "code", "location": {"file": "client/src/utils/github.js", "line": 25, "column": 20}, "severity": "info", "references": [], "description": ""}, {"id": "5c7f04aca4ee", "fix": {"template": null, "available": false}, "title": "Dynamic property assignment - prototype pollution if key is user-controlled", "ruleId": "rules.bracket-notation-user-input", "snippet": {"code": "            levelAddresses[key] = deployedNetworkData[key];", "highlightLines": [149]}, "category": "code", "location": {"file": "client/src/utils/statsContract.js", "line": 149, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "bff0a53479c8", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "    const statsABI = require(\"contracts/build/contracts/metrics/Statistics.sol/Statistics.json\");", "highlightLines": [161]}, "category": "code", "location": {"file": "client/src/utils/statsContract.js", "line": 161, "column": 31}, "severity": "medium", "references": [], "description": ""}, {"id": "02b6405f0c3a", "fix": {"template": null, "available": false}, "title": "Security/linting suppression comment - verify this is justified", "ruleId": "rules._shared.shared-comment-disable-security", "snippet": {"code": "  // eslint-disable-next-line", "highlightLines": [2]}, "category": "code", "location": {"file": "client/src/utils/stringutil.js", "line": 2, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "35013b67bf04", "fix": {"template": null, "available": false}, "title": "Regex .test() on variable - if user-controlled and regex has nested quantifiers, ReDoS is possible", "ruleId": "rules.redos-test-user-input", "snippet": {"code": "  const regex = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n  return regex.test(email);", "highlightLines": [3]}, "category": "code", "location": {"file": "client/src/utils/stringutil.js", "line": 3, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "fc05cf39dfe3", "fix": {"template": null, "available": false}, "title": "Regex literal with nested quantifiers - potential ReDoS vulnerability", "ruleId": "rules.regex-redos-literal", "snippet": {"code": "  const regex = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;", "highlightLines": [3]}, "category": "code", "location": {"file": "client/src/utils/stringutil.js", "line": 3, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "27ff620930b4", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "    // https://codepen.io/sosuke/pen/Pjoqqp?__cf_chl_jschl_tk__=ecc0b72797ae71bc009d6322e3e470773936b386-1604211766-0-ASpz720gXnc6Ej0vzlgY9-KLmlPkldgcOx1wAmGTUCjLZLOxkArNxpRzZ9m8woL-NGmP9LBGVPws8UxMJZrR7O1qFH6QkKtrGVPw6StRnXiK1XTQR_nY905r0XobAG2nOmyC6Zq8mdyPDp1MyHD7JLodJUXCRViXhtmLmRVE_-JGarVJRlxs6k3DzAOQQEJewfp00DjhlD0mxr8ZKpk2yq6IPTZZQ52XYxh26FC5MxLHhs7LuAwhtolmDZyp4_IuwRg8I5m-2--MmvGE8CCqjRWrkE85zgkMXPlOqcZtppRpZhn6Uz9DZAuKheHwVBb0ySIhFYG92bvQOgiKX0TTswB1SHgOLIeqktuyUaAgxI_h", "highlightLines": [3]}, "category": "code", "location": {"file": "client/src/utils/svg.js", "line": 3, "column": 65}, "severity": "medium", "references": [], "description": ""}, {"id": "8a73f8e80b38", "fix": {"template": null, "available": false}, "title": "Fetch API with potentially user-controlled URL - validate to prevent SSRF", "ruleId": "rules.fetch-ssrf-user-url-v2", "snippet": {"code": "      fetch(data)", "highlightLines": [5]}, "category": "code", "location": {"file": "client/src/utils/textloader.js", "line": 5, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "57784ed240cd", "fix": {"template": null, "available": false}, "title": "Fetch with variable URL - potential SSRF if URL is user-controlled", "ruleId": "rules.js-fetch-variable-url", "snippet": {"code": "      fetch(data)", "highlightLines": [5]}, "category": "code", "location": {"file": "client/src/utils/textloader.js", "line": 5, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "e056394c25da", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "contracts/contracts/Ethernaut.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "2eb08c7a80dc", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function saveNewLevel(address level) external;", "highlightLines": [9]}, "category": "code", "location": {"file": "contracts/contracts/Ethernaut.sol", "line": 9, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "8e417df806d1", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function saveNewLevel(address level) external;\n\n    function createNewInstance(\n        address instance,\n        address level,\n        address player\n    ) external;\n\n    function submitFailure(\n        address instance,\n        address level,\n        address player\n    ) external;\n\n    function submitSuccess(\n        address instance,\n        address level,\n        address player\n    ) external;\n}\n\ncontract Ethernaut is Ownable {\n    IStatistics public statistics;\n\n    // ----------------------------------\n    // Owner interaction\n    // ----------------------------------\n\n    mapping(address => bool) public registeredLevels;", "highlightLines": [9]}, "category": "code", "location": {"file": "contracts/contracts/Ethernaut.sol", "line": 9, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "19351fbd5eb2", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function createNewInstance(\n        address instance,\n        address level,\n        address player\n    ) external;", "highlightLines": [11]}, "category": "code", "location": {"file": "contracts/contracts/Ethernaut.sol", "line": 11, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "5497a1e25059", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function submitFailure(\n        address instance,\n        address level,\n        address player\n    ) external;", "highlightLines": [17]}, "category": "code", "location": {"file": "contracts/contracts/Ethernaut.sol", "line": 17, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "95ca0873b918", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function submitSuccess(\n        address instance,\n        address level,\n        address player\n    ) external;", "highlightLines": [23]}, "category": "code", "location": {"file": "contracts/contracts/Ethernaut.sol", "line": 23, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "9a4e701f7f73", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function registerLevel(Level _level) public onlyOwner {", "highlightLines": [40]}, "category": "code", "location": {"file": "contracts/contracts/Ethernaut.sol", "line": 40, "column": 49}, "severity": "info", "references": [], "description": ""}, {"id": "faa0b78b1dce", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function setStatistics(address _statProxy) external onlyOwner {", "highlightLines": [45]}, "category": "code", "location": {"file": "contracts/contracts/Ethernaut.sol", "line": 45, "column": 57}, "severity": "info", "references": [], "description": ""}, {"id": "9ddbb45ea21b", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address player;", "highlightLines": [54]}, "category": "code", "location": {"file": "contracts/contracts/Ethernaut.sol", "line": 54, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8cf7f1f13ce7", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool completed;", "highlightLines": [56]}, "category": "code", "location": {"file": "contracts/contracts/Ethernaut.sol", "line": 56, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3677e92a46f2", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event LevelInstanceCreatedLog(\n        address indexed player,\n        address indexed instance,\n        address indexed level\n    );", "highlightLines": [61]}, "category": "code", "location": {"file": "contracts/contracts/Ethernaut.sol", "line": 61, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "72cbb4ac262e", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event LevelInstanceCreatedLog(\n        address indexed player,\n        address indexed instance,\n        address indexed level\n    );", "highlightLines": [61]}, "category": "code", "location": {"file": "contracts/contracts/Ethernaut.sol", "line": 61, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "6188f08ea88e", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event LevelCompletedLog(\n        address indexed player,\n        address indexed instance,\n        address indexed level\n    );", "highlightLines": [66]}, "category": "code", "location": {"file": "contracts/contracts/Ethernaut.sol", "line": 66, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "e51167b75a64", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event LevelCompletedLog(\n        address indexed player,\n        address indexed instance,\n        address indexed level\n    );", "highlightLines": [66]}, "category": "code", "location": {"file": "contracts/contracts/Ethernaut.sol", "line": 66, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "02a86b4b5cb2", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address instance = _level.createInstance{value: msg.value}(msg.sender);", "highlightLines": [77]}, "category": "code", "location": {"file": "contracts/contracts/Ethernaut.sol", "line": 77, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "5ca46b0a31ee", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address instance = _level.createInstance{value: msg.value}(msg.sender);\n\n        // Store emitted instance relationship with player and level.\n        emittedInstances[instance] = EmittedInstanceData(\n            msg.sender,\n            _level,\n            false\n        );", "highlightLines": [77]}, "category": "code", "location": {"file": "contracts/contracts/Ethernaut.sol", "line": 77, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "4d9d62d09e9a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        EmittedInstanceData storage data = emittedInstances[_instance];\n        require(\n            data.player == msg.sender,\n            \"This instance doesn't belong to the current user\"\n        ); // instance was emitted for this player\n        require(data.completed == false, \"Level has been completed already\"); // not already submitted\n\n        // Have the level check the instance.\n        if (data.level.validateInstance(_instance, msg.sender)) {\n            // Register instance as completed.\n            data.completed = true;\n\n            statistics.submitSuccess(\n                _instance,\n                address(data.level),\n                msg.sender\n            );\n            // Notify success via logs.\n            emit LevelCompletedLog(msg.sender, _instance, address(data.level));\n        } else {\n            statistics.submitFailure(\n                _instance,\n                address(data.level),\n                msg.sender\n            );\n        }", "highlightLines": [94]}, "category": "code", "location": {"file": "contracts/contracts/Ethernaut.sol", "line": 94, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "2a0f0c020a0e", "fix": {"template": null, "available": false}, "title": "Unnecessary comparison to boolean constant - use variable directly", "ruleId": "rules.sol-boolean-constant-comparison", "snippet": {"code": "        require(data.completed == false, \"Level has been completed already\"); // not already submitted", "highlightLines": [99]}, "category": "code", "location": {"file": "contracts/contracts/Ethernaut.sol", "line": 99, "column": 32}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#boolean-equality"], "description": ""}, {"id": "ceb81e451136", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.5.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "contracts/contracts/attacks/AlienCodexAttack.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "cf94fd4d9d63", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "    target.record(bytes32(0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff));", "highlightLines": [18]}, "category": "code", "location": {"file": "contracts/contracts/attacks/AlienCodexAttack.sol", "line": 18, "column": 27}, "severity": "high", "references": [], "description": ""}, {"id": "0b94c38353fe", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "    // Array[0] is in slot H(0x0000000000000000000000000000000000000000000000000000000000000001) = 0xb10e2d527612073b26eecdfd717e6a320cf44b4afac2b0732d9fcbe2b7fa0cf6", "highlightLines": [27]}, "category": "code", "location": {"file": "contracts/contracts/attacks/AlienCodexAttack.sol", "line": 27, "column": 30}, "severity": "high", "references": [], "description": ""}, {"id": "8386fb10d5e0", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "    // where offset = 0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff - 0xb10e2d527612073b26eecdfd717e6a320cf44b4afac2b0732d9fcbe2b7fa0cf6 + 0x0000000000000000000000000000000000000000000000000000000000000001", "highlightLines": [29]}, "category": "code", "location": {"file": "contracts/contracts/attacks/AlienCodexAttack.sol", "line": 29, "column": 23}, "severity": "high", "references": [], "description": ""}, {"id": "3d4cadea14a8", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 offset =", "highlightLines": [30]}, "category": "code", "location": {"file": "contracts/contracts/attacks/AlienCodexAttack.sol", "line": 30, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0825dbc49c2e", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "      uint256(0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff)", "highlightLines": [32]}, "category": "code", "location": {"file": "contracts/contracts/attacks/AlienCodexAttack.sol", "line": 32, "column": 15}, "severity": "high", "references": [], "description": ""}, {"id": "4a9f905fe056", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "      - uint256(0xb10e2d527612073b26eecdfd717e6a320cf44b4afac2b0732d9fcbe2b7fa0cf6)", "highlightLines": [33]}, "category": "code", "location": {"file": "contracts/contracts/attacks/AlienCodexAttack.sol", "line": 33, "column": 17}, "severity": "high", "references": [], "description": ""}, {"id": "d1b393c417db", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "      + uint256(0x0000000000000000000000000000000000000000000000000000000000000001);", "highlightLines": [34]}, "category": "code", "location": {"file": "contracts/contracts/attacks/AlienCodexAttack.sol", "line": 34, "column": 17}, "severity": "high", "references": [], "description": ""}, {"id": "a41af3e21acc", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "contracts/contracts/attacks/CoinFlipAttack.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "c1d33722c533", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "  uint256 FACTOR = 57896044618658097711785492504343953926634992332820282019728792003956564819968;", "highlightLines": [8]}, "category": "code", "location": {"file": "contracts/contracts/attacks/CoinFlipAttack.sol", "line": 8, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "1bd4e681d003", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    CoinFlip coinflip = CoinFlip(_victim);\n    uint256 blockValue = uint256(blockhash(block.number - 1));", "highlightLines": [11]}, "category": "code", "location": {"file": "contracts/contracts/attacks/CoinFlipAttack.sol", "line": 11, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "2d46c8e76708", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 blockValue = uint256(blockhash(block.number - 1));", "highlightLines": [12]}, "category": "code", "location": {"file": "contracts/contracts/attacks/CoinFlipAttack.sol", "line": 12, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b4dd606c10cf", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 blockValue = uint256(blockhash(block.number - 1));\n    uint256 coinFlip = uint256(uint256(blockValue) / FACTOR);", "highlightLines": [12]}, "category": "code", "location": {"file": "contracts/contracts/attacks/CoinFlipAttack.sol", "line": 12, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "2886de3d105e", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - predictable by miners, 0 after 256 blocks", "ruleId": "rules.sol-blockhash-randomness", "snippet": {"code": "    uint256 blockValue = uint256(blockhash(block.number - 1));", "highlightLines": [12]}, "category": "code", "location": {"file": "contracts/contracts/attacks/CoinFlipAttack.sol", "line": 12, "column": 34}, "severity": "high", "references": [], "description": ""}, {"id": "541433faa114", "fix": {"template": null, "available": false}, "title": "blockhash only works for last 256 blocks - older blocks return 0 (PredictTheBlockHash pattern)", "ruleId": "rules.sol-blockhash-256-limit", "snippet": {"code": "    uint256 blockValue = uint256(blockhash(block.number - 1));", "highlightLines": [12]}, "category": "code", "location": {"file": "contracts/contracts/attacks/CoinFlipAttack.sol", "line": 12, "column": 34}, "severity": "medium", "references": ["https://capturetheether.com/challenges/lottery/predict-block-hash/"], "description": ""}, {"id": "ec17c5f4cf3e", "fix": {"template": null, "available": false}, "title": "blockhash(block.number - 1) used for randomness - miners can manipulate", "ruleId": "rules.sol-blockhash-previous-block", "snippet": {"code": "    uint256 blockValue = uint256(blockhash(block.number - 1));", "highlightLines": [12]}, "category": "code", "location": {"file": "contracts/contracts/attacks/CoinFlipAttack.sol", "line": 12, "column": 34}, "severity": "medium", "references": [], "description": ""}, {"id": "e8c4d6818a19", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "    uint256 blockValue = uint256(blockhash(block.number - 1));", "highlightLines": [12]}, "category": "code", "location": {"file": "contracts/contracts/attacks/CoinFlipAttack.sol", "line": 12, "column": 34}, "severity": "medium", "references": [], "description": ""}, {"id": "012b0304580d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 coinFlip = uint256(uint256(blockValue) / FACTOR);", "highlightLines": [13]}, "category": "code", "location": {"file": "contracts/contracts/attacks/CoinFlipAttack.sol", "line": 13, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b8475d9ba20a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 coinFlip = uint256(uint256(blockValue) / FACTOR);\n    bool side = coinFlip == 1 ? true : false;", "highlightLines": [13]}, "category": "code", "location": {"file": "contracts/contracts/attacks/CoinFlipAttack.sol", "line": 13, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "ce415d0d446b", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    bool side = coinFlip == 1 ? true : false;", "highlightLines": [14]}, "category": "code", "location": {"file": "contracts/contracts/attacks/CoinFlipAttack.sol", "line": 14, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "fbacf33a0826", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "contracts/contracts/attacks/DenialAttack.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "500b3e10cf50", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "  fallback() external payable {", "highlightLines": [7]}, "category": "code", "location": {"file": "contracts/contracts/attacks/DenialAttack.sol", "line": 7, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "8e39114dab9c", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "contracts/contracts/attacks/DetectionBot.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "7d14eb1b6e5a", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function handleTransaction(address user, bytes calldata msgData) external;", "highlightLines": [5]}, "category": "code", "location": {"file": "contracts/contracts/attacks/DetectionBot.sol", "line": 5, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "c3c6e6b15e48", "fix": {"template": null, "available": false}, "title": "Forta detection bot pattern - monitors for suspicious transactions (DoubleEntryPoint defense)", "ruleId": "rules.sol-forta-detection-bot", "snippet": {"code": "    function handleTransaction(address user, bytes calldata msgData) external;\n}\n\ninterface IForta {\n    function setDetectionBot(address detectionBotAddress) external;\n    function notify(address user, bytes calldata msgData) external;\n    function raiseAlert(address user) external;", "highlightLines": [5]}, "category": "code", "location": {"file": "contracts/contracts/attacks/DetectionBot.sol", "line": 5, "column": 5}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/26"], "description": ""}, {"id": "afac9868faac", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function setDetectionBot(address detectionBotAddress) external;", "highlightLines": [9]}, "category": "code", "location": {"file": "contracts/contracts/attacks/DetectionBot.sol", "line": 9, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "64829502ea4f", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function notify(address user, bytes calldata msgData) external;", "highlightLines": [10]}, "category": "code", "location": {"file": "contracts/contracts/attacks/DetectionBot.sol", "line": 10, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "6ef1ee2994eb", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function raiseAlert(address user) external;", "highlightLines": [11]}, "category": "code", "location": {"file": "contracts/contracts/attacks/DetectionBot.sol", "line": 11, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "9a00c6312a87", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "contract DetectionBot is IDetectionBot {", "highlightLines": [14]}, "category": "code", "location": {"file": "contracts/contracts/attacks/DetectionBot.sol", "line": 14, "column": 1}, "severity": "medium", "references": [], "description": ""}, {"id": "93d22d4dd92d", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  constructor(address forta) {\n    fortaContract = IForta(forta);\n  }", "highlightLines": [18]}, "category": "code", "location": {"file": "contracts/contracts/attacks/DetectionBot.sol", "line": 18, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "3de138f3b214", "fix": {"template": null, "available": false}, "title": "Forta detection bot pattern - monitors for suspicious transactions (DoubleEntryPoint defense)", "ruleId": "rules.sol-forta-detection-bot", "snippet": {"code": "  function handleTransaction(address user, bytes calldata msgData) public override {\n    // Only the Forta contract can call this method\n    require(msg.sender == address(fortaContract), \"Unauthorized\");\n    fortaContract.raiseAlert(user);", "highlightLines": [22]}, "category": "code", "location": {"file": "contracts/contracts/attacks/DetectionBot.sol", "line": 22, "column": 3}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/26"], "description": ""}, {"id": "1ce3eb0bce45", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    msgData;", "highlightLines": [26]}, "category": "code", "location": {"file": "contracts/contracts/attacks/DetectionBot.sol", "line": 26, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "8f7706b9d538", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "contracts/contracts/attacks/DexTwoAttack.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "27204bfd340b", "fix": {"template": null, "available": false}, "title": "ERC20 transferFrom without payload size validation - consider adding onlyPayloadSize modifier", "ruleId": "rules.sol-erc20-missing-payload-modifier", "snippet": {"code": "    function transferFrom(\n        address,\n        address,\n        uint256\n    ) external pure returns (bool) {", "highlightLines": [9]}, "category": "code", "location": {"file": "contracts/contracts/attacks/DexTwoAttack.sol", "line": 9, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address"], "description": ""}, {"id": "a1d143248823", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function transferFrom(\n        address,\n        address,\n        uint256\n    ) external pure returns (bool) {", "highlightLines": [9]}, "category": "code", "location": {"file": "contracts/contracts/attacks/DexTwoAttack.sol", "line": 9, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "f2386c86d53d", "fix": {"template": null, "available": false}, "title": "NFT transfer without approval/ownership check - add _isApprovedOrOwner validation", "ruleId": "rules.sol-nft-transfer-no-approval-check", "snippet": {"code": "    function transferFrom(\n        address,\n        address,\n        uint256\n    ) external pure returns (bool) {", "highlightLines": [9]}, "category": "code", "location": {"file": "contracts/contracts/attacks/DexTwoAttack.sol", "line": 9, "column": 5}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/NFT-transfer.sol"], "description": ""}, {"id": "9cf0b3b069c3", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "contracts/contracts/attacks/ElevatorAttack.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "021e0ce169c0", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "contracts/contracts/attacks/ForceAttack.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "9c9a65a9175f", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  constructor() payable {}", "highlightLines": [7]}, "category": "code", "location": {"file": "contracts/contracts/attacks/ForceAttack.sol", "line": 7, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "f7e95e5e2245", "fix": {"template": null, "available": false}, "title": "Empty constructor or constructor with no effect - may indicate incomplete implementation", "ruleId": "rules.sol-void-constructor", "snippet": {"code": "  constructor() payable {}", "highlightLines": [7]}, "category": "code", "location": {"file": "contracts/contracts/attacks/ForceAttack.sol", "line": 7, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "c28457ed0cbf", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "  receive() external payable {}", "highlightLines": [8]}, "category": "code", "location": {"file": "contracts/contracts/attacks/ForceAttack.sol", "line": 8, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "b85f2b50bb15", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "  receive() external payable {}", "highlightLines": [8]}, "category": "code", "location": {"file": "contracts/contracts/attacks/ForceAttack.sol", "line": 8, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "3f007b74a3c3", "fix": {"template": null, "available": false}, "title": "Contract can be destructed by anyone - missing access control on selfdestruct", "ruleId": "rules.sol-accessible-selfdestruct", "snippet": {"code": "    selfdestruct(target);", "highlightLines": [11]}, "category": "code", "location": {"file": "contracts/contracts/attacks/ForceAttack.sol", "line": 11, "column": 5}, "severity": "high", "references": ["https://www.parity.io/blog/a-postmortem-on-the-parity-multi-sig-library-self-destruct/"], "description": ""}, {"id": "57b063adf14c", "fix": {"template": null, "available": false}, "title": "Selfdestruct with user-controlled recipient - funds can be sent anywhere", "ruleId": "rules.sol-selfdestruct-arbitrary", "snippet": {"code": "    selfdestruct(target);", "highlightLines": [11]}, "category": "code", "location": {"file": "contracts/contracts/attacks/ForceAttack.sol", "line": 11, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "b22ad7d91262", "fix": {"template": null, "available": false}, "title": "selfdestruct can force ETH to any address - contracts cannot prevent receiving ETH this way (Force pattern)", "ruleId": "rules.sol-selfdestruct-force-eth", "snippet": {"code": "    selfdestruct(target);", "highlightLines": [11]}, "category": "code", "location": {"file": "contracts/contracts/attacks/ForceAttack.sol", "line": 11, "column": 5}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/7"], "description": ""}, {"id": "5f1906203fc6", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "contracts/contracts/attacks/GatekeeperOneAttack.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "67a04906fdb9", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  constructor(address GatekeeperOneContractAddress) {\n    bytes8 key = bytes8(uint64(uint16(uint160(tx.origin))) + 2 ** 32);\n    \n    // NOTE: the proper gas offset to use will vary depending on the compiler\n    // version and optimization settings used to deploy the factory contract.\n    // To migitage, brute-force a range of possible values of gas to forward.\n    // Using call (vs. an abstract interface) prevents reverts from propagating.\n    bytes memory encodedParams = abi.encodeWithSignature((\"enter(bytes8)\"),\n      key\n    );\n\n    // gas offset usually comes in around 210, give a buffer of 60 on each side\n    for (uint256 i = 0; i < 120; i++) {\n      (bool result, ) = address(GatekeeperOneContractAddress).call{gas: i + 150 + 8191 * 3}(encodedParams);\n      if(result)\n        {\n        break;\n      }\n    }\n  }", "highlightLines": [7]}, "category": "code", "location": {"file": "contracts/contracts/attacks/GatekeeperOneAttack.sol", "line": 7, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "9dc3acc59bbd", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    bytes8 key = bytes8(uint64(uint16(uint160(tx.origin))) + 2 ** 32);", "highlightLines": [8]}, "category": "code", "location": {"file": "contracts/contracts/attacks/GatekeeperOneAttack.sol", "line": 8, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a4733a7171c8", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    bytes8 key = bytes8(uint64(uint16(uint160(tx.origin))) + 2 ** 32);\n    \n    // NOTE: the proper gas offset to use will vary depending on the compiler\n    // version and optimization settings used to deploy the factory contract.\n    // To migitage, brute-force a range of possible values of gas to forward.\n    // Using call (vs. an abstract interface) prevents reverts from propagating.\n    bytes memory encodedParams = abi.encodeWithSignature((\"enter(bytes8)\"),\n      key\n    );", "highlightLines": [8]}, "category": "code", "location": {"file": "contracts/contracts/attacks/GatekeeperOneAttack.sol", "line": 8, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "8343c8579e88", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "    bytes8 key = bytes8(uint64(uint16(uint160(tx.origin))) + 2 ** 32);", "highlightLines": [8]}, "category": "code", "location": {"file": "contracts/contracts/attacks/GatekeeperOneAttack.sol", "line": 8, "column": 25}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "7869e6fcca8e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    bytes memory encodedParams = abi.encodeWithSignature((\"enter(bytes8)\"),\n      key\n    );\n\n    // gas offset usually comes in around 210, give a buffer of 60 on each side\n    for (uint256 i = 0; i < 120; i++) {\n      (bool result, ) = address(GatekeeperOneContractAddress).call{gas: i + 150 + 8191 * 3}(encodedParams);\n      if(result)\n        {\n        break;\n      }\n    }", "highlightLines": [14]}, "category": "code", "location": {"file": "contracts/contracts/attacks/GatekeeperOneAttack.sol", "line": 14, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "ceb0faf38b33", "fix": {"template": null, "available": false}, "title": "Low-level call without checking return value - silent failure possible", "ruleId": "rules.sol-unchecked-call-return", "snippet": {"code": "      (bool result, ) = address(GatekeeperOneContractAddress).call{gas: i + 150 + 8191 * 3}(encodedParams);", "highlightLines": [20]}, "category": "code", "location": {"file": "contracts/contracts/attacks/GatekeeperOneAttack.sol", "line": 20, "column": 62}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-104/", "https://blocksecteam.medium.com/li-fi-attack"], "description": ""}, {"id": "798f3dd8d114", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        break;", "highlightLines": [23]}, "category": "code", "location": {"file": "contracts/contracts/attacks/GatekeeperOneAttack.sol", "line": 23, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "3ef1d52f3341", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "contracts/contracts/attacks/GatekeeperThreeAttack.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "eb0518aa428b", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor (address payable _gatekeeperThree) payable {\n        gatekeeperThree = GatekeeperThree(_gatekeeperThree);\n    }", "highlightLines": [9]}, "category": "code", "location": {"file": "contracts/contracts/attacks/GatekeeperThreeAttack.sol", "line": 9, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "5cfb634198c1", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        gatekeeperThree.getAllowance(block.timestamp);", "highlightLines": [19]}, "category": "code", "location": {"file": "contracts/contracts/attacks/GatekeeperThreeAttack.sol", "line": 19, "column": 38}, "severity": "medium", "references": [], "description": ""}, {"id": "09a3be901114", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        payable(address(gatekeeperThree)).transfer(0.0011 ether);", "highlightLines": [21]}, "category": "code", "location": {"file": "contracts/contracts/attacks/GatekeeperThreeAttack.sol", "line": 21, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "b36e4157dc37", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "contracts/contracts/attacks/GatekeeperTwoAttack.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "a7fab1a600eb", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  constructor(address GatekeeperTwoContractAddress) {\n    gatekeeper = GatekeeperTwoInterface(GatekeeperTwoContractAddress);\n    bytes8 key = bytes8(uint64(bytes8(keccak256(abi.encodePacked(address(this))))) ^ type(uint64).max);\n    gatekeeper.enter{gas:50000}(key);\n  }", "highlightLines": [13]}, "category": "code", "location": {"file": "contracts/contracts/attacks/GatekeeperTwoAttack.sol", "line": 13, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "109d2ea6af3d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    gatekeeper = GatekeeperTwoInterface(GatekeeperTwoContractAddress);\n    bytes8 key = bytes8(uint64(bytes8(keccak256(abi.encodePacked(address(this))))) ^ type(uint64).max);", "highlightLines": [14]}, "category": "code", "location": {"file": "contracts/contracts/attacks/GatekeeperTwoAttack.sol", "line": 14, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "a693538dde09", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    bytes8 key = bytes8(uint64(bytes8(keccak256(abi.encodePacked(address(this))))) ^ type(uint64).max);", "highlightLines": [15]}, "category": "code", "location": {"file": "contracts/contracts/attacks/GatekeeperTwoAttack.sol", "line": 15, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ae264dbaa003", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "    bytes8 key = bytes8(uint64(bytes8(keccak256(abi.encodePacked(address(this))))) ^ type(uint64).max);", "highlightLines": [15]}, "category": "code", "location": {"file": "contracts/contracts/attacks/GatekeeperTwoAttack.sol", "line": 15, "column": 25}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "67bfdf515c28", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "    bytes8 key = bytes8(uint64(bytes8(keccak256(abi.encodePacked(address(this))))) ^ type(uint64).max);", "highlightLines": [15]}, "category": "code", "location": {"file": "contracts/contracts/attacks/GatekeeperTwoAttack.sol", "line": 15, "column": 39}, "severity": "high", "references": [], "description": ""}, {"id": "2485a8578721", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "contracts/contracts/attacks/GoodSamaritanAttack.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "69ed81934dce", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  constructor(address goodSamaritan_) {\n    _goodSamaritan = goodSamaritan_;\n  }", "highlightLines": [12]}, "category": "code", "location": {"file": "contracts/contracts/attacks/GoodSamaritanAttack.sol", "line": 12, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "a85d7d88442f", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "contracts/contracts/attacks/KingAttack.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "4eca7a0f8d37", "fix": {"template": null, "available": false}, "title": "Low-level transfer without success check - funds may be lost silently", "ruleId": "rules.sol-unchecked-transfer-return", "snippet": {"code": "    (bool result,) = _target.call{value:msg.value}(\"\");", "highlightLines": [8]}, "category": "code", "location": {"file": "contracts/contracts/attacks/KingAttack.sol", "line": 8, "column": 5}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "f122301e6f28", "fix": {"template": null, "available": false}, "title": "Low-level call without checking return value - silent failure possible", "ruleId": "rules.sol-unchecked-call-return", "snippet": {"code": "    (bool result,) = _target.call{value:msg.value}(\"\");", "highlightLines": [8]}, "category": "code", "location": {"file": "contracts/contracts/attacks/KingAttack.sol", "line": 8, "column": 29}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-104/", "https://blocksecteam.medium.com/li-fi-attack"], "description": ""}, {"id": "f386387ad864", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "contracts/contracts/attacks/MagicNumBadSolver.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "d0d490cced93", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "    return bytes4(uint32(42));", "highlightLines": [8]}, "category": "code", "location": {"file": "contracts/contracts/attacks/MagicNumBadSolver.sol", "line": 8, "column": 19}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "f13a8c27514f", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "contracts/contracts/attacks/MagicNumSolver.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "e21ff4121a6f", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  constructor() {\n    assembly {\n\n      // This is the bytecode we want the program to have:\n      // 00 PUSH1 2a /* push dec 42 (hex 0x2a) onto the stack */\n      // 03 PUSH1  0 /* store 42 at memory position 0 */\n      // 05 MSTORE\n      // 06 PUSH1 20 /* return 32 bytes in memory */\n      // 08 PUSH1 0\n      // 10 RETURN\n      // Bytecode: 0x602a60005260206000f3 (length 0x0a or 10)\n      // Bytecode within a 32 byte word:\n      // 0x00000000000000000000000000000000000000000000604260005260206000f3 (length 0x20 or 32)\n      //                                               ^ (offset 0x16 or 22)\n      \n      mstore(0, 0x602a60005260206000f3)\n      return(0x16, 0x0a)\n    }\n  }", "highlightLines": [6]}, "category": "code", "location": {"file": "contracts/contracts/attacks/MagicNumSolver.sol", "line": 6, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "09deef19a4ab", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "    assembly {", "highlightLines": [7]}, "category": "code", "location": {"file": "contracts/contracts/attacks/MagicNumSolver.sol", "line": 7, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "4168a3d6d869", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "      // 0x00000000000000000000000000000000000000000000604260005260206000f3 (length 0x20 or 32)", "highlightLines": [18]}, "category": "code", "location": {"file": "contracts/contracts/attacks/MagicNumSolver.sol", "line": 18, "column": 10}, "severity": "high", "references": [], "description": ""}, {"id": "915a455fa3bf", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "contracts/contracts/attacks/Manufactured.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "d39ea96d1cbe", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event Check(bool result);", "highlightLines": [11]}, "category": "code", "location": {"file": "contracts/contracts/attacks/MotorbikeAttack.sol", "line": 11, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "1320f676dd70", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        Exploit exploit = new Exploit();", "highlightLines": [24]}, "category": "code", "location": {"file": "contracts/contracts/attacks/MotorbikeAttack.sol", "line": 24, "column": 27}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "075a85dbd9c4", "fix": {"template": null, "available": false}, "title": "Initialization function can be front-run - use initializer modifier or constructor", "ruleId": "rules.sol-initialization-frontrun", "snippet": {"code": "    function initialize() external {", "highlightLines": [44]}, "category": "code", "location": {"file": "contracts/contracts/attacks/MotorbikeAttack.sol", "line": 44, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "8a19a08e6180", "fix": {"template": null, "available": false}, "title": "Clone/minimal proxy initializer without protection - can be front-run and hijacked", "ruleId": "rules.sol-unprotected-clone-initializer", "snippet": {"code": "    function initialize() external {", "highlightLines": [44]}, "category": "code", "location": {"file": "contracts/contracts/attacks/MotorbikeAttack.sol", "line": 44, "column": 5}, "severity": "high", "references": ["https://blog.openzeppelin.com/security-advisory-initialize-uups-implementation-contracts"], "description": ""}, {"id": "65c7b8e25204", "fix": {"template": null, "available": false}, "title": "Initializer function not protected - can be called multiple times", "ruleId": "rules.sol-initializer-not-protected", "snippet": {"code": "    function initialize() external {", "highlightLines": [44]}, "category": "code", "location": {"file": "contracts/contracts/attacks/MotorbikeAttack.sol", "line": 44, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "bd69d8d1091d", "fix": {"template": null, "available": false}, "title": "Contract can be destructed by anyone - missing access control on selfdestruct", "ruleId": "rules.sol-accessible-selfdestruct", "snippet": {"code": "        selfdestruct(msg.sender);", "highlightLines": [45]}, "category": "code", "location": {"file": "contracts/contracts/attacks/MotorbikeAttack.sol", "line": 45, "column": 9}, "severity": "high", "references": ["https://www.parity.io/blog/a-postmortem-on-the-parity-multi-sig-library-self-destruct/"], "description": ""}, {"id": "778e695d3a83", "fix": {"template": null, "available": false}, "title": "Selfdestruct with user-controlled recipient - funds can be sent anywhere", "ruleId": "rules.sol-selfdestruct-arbitrary", "snippet": {"code": "        selfdestruct(msg.sender);", "highlightLines": [45]}, "category": "code", "location": {"file": "contracts/contracts/attacks/MotorbikeAttack.sol", "line": 45, "column": 9}, "severity": "high", "references": [], "description": ""}, {"id": "e400d281aba5", "fix": {"template": null, "available": false}, "title": "selfdestruct can force ETH to any address - contracts cannot prevent receiving ETH this way (Force pattern)", "ruleId": "rules.sol-selfdestruct-force-eth", "snippet": {"code": "        selfdestruct(msg.sender);", "highlightLines": [45]}, "category": "code", "location": {"file": "contracts/contracts/attacks/MotorbikeAttack.sol", "line": 45, "column": 9}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/7"], "description": ""}, {"id": "7d70838c8dfc", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "contracts/contracts/attacks/NaughtCoinAttack.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "ceb5c4832047", "fix": {"template": null, "available": false}, "title": "ERC721/ERC20 transferFrom with user-controlled from address - potential unauthorized transfer", "ruleId": "rules.sol-arbitrary-transferfrom", "snippet": {"code": "    naughtCoin.transferFrom(_player, address(this), naughtCoin.balanceOf(_player));", "highlightLines": [11]}, "category": "code", "location": {"file": "contracts/contracts/attacks/NaughtCoinAttack.sol", "line": 11, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "fb920a1b8b64", "fix": {"template": null, "available": false}, "title": "Token transfer without checking actual received amount - deflationary tokens may transfer less", "ruleId": "rules.sol-deflationary-token-transfer", "snippet": {"code": "    naughtCoin.transferFrom(_player, address(this), naughtCoin.balanceOf(_player));", "highlightLines": [11]}, "category": "code", "location": {"file": "contracts/contracts/attacks/NaughtCoinAttack.sol", "line": 11, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "bda533d5c6b4", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "    naughtCoin.transferFrom(_player, address(this), naughtCoin.balanceOf(_player));", "highlightLines": [11]}, "category": "code", "location": {"file": "contracts/contracts/attacks/NaughtCoinAttack.sol", "line": 11, "column": 5}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "fdf5cd375434", "fix": {"template": null, "available": false}, "title": "Token amount after transfer may differ - check actual received amount", "ruleId": "rules.sol-fee-on-transfer-token", "snippet": {"code": "    naughtCoin.transferFrom(_player, address(this), naughtCoin.balanceOf(_player));", "highlightLines": [11]}, "category": "code", "location": {"file": "contracts/contracts/attacks/NaughtCoinAttack.sol", "line": 11, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "4c260a426f44", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "contracts/contracts/attacks/PreservationAttack.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "b6a1fe6585f4", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n  address slot0;", "highlightLines": [6]}, "category": "code", "location": {"file": "contracts/contracts/attacks/PreservationAttack.sol", "line": 6, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "18b5ad334469", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "  address slot1;", "highlightLines": [8]}, "category": "code", "location": {"file": "contracts/contracts/attacks/PreservationAttack.sol", "line": 8, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0736fbf7364c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "  address ownerSlot;", "highlightLines": [9]}, "category": "code", "location": {"file": "contracts/contracts/attacks/PreservationAttack.sol", "line": 9, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ad48741aeecb", "fix": {"template": null, "available": false}, "title": "Casting to enum without bounds check - invalid values cause revert in Solidity 0.8+", "ruleId": "rules.sol-out-of-range-enum", "snippet": {"code": "    ownerSlot = address(uint160(addressAsUint));", "highlightLines": [13]}, "category": "code", "location": {"file": "contracts/contracts/attacks/PreservationAttack.sol", "line": 13, "column": 5}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-133"], "description": ""}, {"id": "60fe96300ce5", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.6.12;", "highlightLines": [3]}, "category": "code", "location": {"file": "contracts/contracts/attacks/ReentranceAttack.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "061eae11ef24", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "  receive() external payable {", "highlightLines": [24]}, "category": "code", "location": {"file": "contracts/contracts/attacks/ReentranceAttack.sol", "line": 24, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "59a1bf2ca234", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "contracts/contracts/attacks/ShopAttack.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "80a450328670", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "contracts/contracts/attacks/TelephoneAttack.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "1a99736d7209", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "contracts/contracts/attacks/VaultAttack.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "94c7c1dd77f3", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "contracts/contracts/factory/LocalFactory.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "2b8b764363b5", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor() {\n        // deploy the four core contracts\n        ethernaut = new Ethernaut();\n        proxyAdmin = new ProxyAdmin();\n        implementation = new Statistics();\n        proxyStats = new ProxyStats(\n            address(implementation),\n            address(proxyAdmin),\n            address(ethernaut)\n        );\n        // initialise the ethernaut contract with the proxystats method\n        ethernaut.setStatistics(address(proxyStats));\n        // here is where statistics seats behind the proxy\n        implementation = Statistics(address(proxyStats));\n    }", "highlightLines": [18]}, "category": "code", "location": {"file": "contracts/contracts/factory/LocalFactory.sol", "line": 18, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "452c982dd707", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        ethernaut = new Ethernaut();\n        proxyAdmin = new ProxyAdmin();", "highlightLines": [20]}, "category": "code", "location": {"file": "contracts/contracts/factory/LocalFactory.sol", "line": 20, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d04a8daf889b", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        ethernaut = new Ethernaut();", "highlightLines": [20]}, "category": "code", "location": {"file": "contracts/contracts/factory/LocalFactory.sol", "line": 20, "column": 21}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "c6ac4ea7e793", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        proxyAdmin = new ProxyAdmin();\n        implementation = new Statistics();", "highlightLines": [21]}, "category": "code", "location": {"file": "contracts/contracts/factory/LocalFactory.sol", "line": 21, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "25b64fa49c47", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        proxyAdmin = new ProxyAdmin();", "highlightLines": [21]}, "category": "code", "location": {"file": "contracts/contracts/factory/LocalFactory.sol", "line": 21, "column": 22}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "d7dd364fcfd7", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        implementation = new Statistics();\n        proxyStats = new ProxyStats(\n            address(implementation),\n            address(proxyAdmin),\n            address(ethernaut)\n        );", "highlightLines": [22]}, "category": "code", "location": {"file": "contracts/contracts/factory/LocalFactory.sol", "line": 22, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "4880e3133a24", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        implementation = new Statistics();", "highlightLines": [22]}, "category": "code", "location": {"file": "contracts/contracts/factory/LocalFactory.sol", "line": 22, "column": 26}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "8d4be0c5bf2f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        proxyStats = new ProxyStats(\n            address(implementation),\n            address(proxyAdmin),\n            address(ethernaut)\n        );\n        // initialise the ethernaut contract with the proxystats method\n        ethernaut.setStatistics(address(proxyStats));\n        // here is where statistics seats behind the proxy\n        implementation = Statistics(address(proxyStats));", "highlightLines": [23]}, "category": "code", "location": {"file": "contracts/contracts/factory/LocalFactory.sol", "line": 23, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e487a0372303", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        proxyStats = new ProxyStats(\n            address(implementation),\n            address(proxyAdmin),\n            address(ethernaut)\n        );", "highlightLines": [23]}, "category": "code", "location": {"file": "contracts/contracts/factory/LocalFactory.sol", "line": 23, "column": 22}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "447f58ebc75c", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function registerLevel(Level _level) public onlyOwner {", "highlightLines": [35]}, "category": "code", "location": {"file": "contracts/contracts/factory/LocalFactory.sol", "line": 35, "column": 49}, "severity": "info", "references": [], "description": ""}, {"id": "d37da6ea2d18", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function transferContractsOwnership(address _newOwner) public onlyOwner {", "highlightLines": [40]}, "category": "code", "location": {"file": "contracts/contracts/factory/LocalFactory.sol", "line": 40, "column": 67}, "severity": "info", "references": [], "description": ""}, {"id": "a50a2a7bcd0f", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.5.0;", "highlightLines": [1]}, "category": "code", "location": {"file": "contracts/contracts/helpers/Ownable-05.sol", "line": 1, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "0c64039fd271", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event OwnershipTransferred(address indexed previousOwner, address indexed newOwner);", "highlightLines": [15]}, "category": "code", "location": {"file": "contracts/contracts/helpers/Ownable-05.sol", "line": 15, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "99c55751e474", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor () internal {\n        _owner = msg.sender;\n    }", "highlightLines": [20]}, "category": "code", "location": {"file": "contracts/contracts/helpers/Ownable-05.sol", "line": 20, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "251d3818dc6e", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyOwner() {\n        require(isOwner(), \"Ownable: caller is not the owner\");\n        _;\n    }", "highlightLines": [34]}, "category": "code", "location": {"file": "contracts/contracts/helpers/Ownable-05.sol", "line": 34, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "08f93a9e30f0", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "    modifier onlyOwner() {\n        require(isOwner(), \"Ownable: caller is not the owner\");\n        _;\n    }", "highlightLines": [34]}, "category": "code", "location": {"file": "contracts/contracts/helpers/Ownable-05.sol", "line": 34, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "2c70d25c2c1d", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [36]}, "category": "code", "location": {"file": "contracts/contracts/helpers/Ownable-05.sol", "line": 36, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "77b248278e45", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function renounceOwnership() public onlyOwner {", "highlightLines": [53]}, "category": "code", "location": {"file": "contracts/contracts/helpers/Ownable-05.sol", "line": 53, "column": 41}, "severity": "info", "references": [], "description": ""}, {"id": "e4e9f28f7cfc", "fix": {"template": null, "available": false}, "title": "Access control change without event emission - harder to monitor and audit", "ruleId": "rules.sol-missing-events-access-control", "snippet": {"code": "    function transferOwnership(address newOwner) public onlyOwner {", "highlightLines": [62]}, "category": "code", "location": {"file": "contracts/contracts/helpers/Ownable-05.sol", "line": 62, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-access-control"], "description": ""}, {"id": "73aa8a49731c", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function transferOwnership(address newOwner) public onlyOwner {", "highlightLines": [62]}, "category": "code", "location": {"file": "contracts/contracts/helpers/Ownable-05.sol", "line": 62, "column": 57}, "severity": "info", "references": [], "description": ""}, {"id": "b5610bda0b3e", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "contracts/contracts/helpers/UpgradeableProxy-08.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "7f93148712dd", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(address _logic, bytes memory _data) {\n        assert(_IMPLEMENTATION_SLOT == bytes32(uint256(keccak256(\"eip1967.proxy.implementation\")) - 1));\n        _setImplementation(_logic);\n        if(_data.length > 0) {\n            // solhint-disable-next-line avoid-low-level-calls\n            (bool success,) = _logic.delegatecall(_data);\n            require(success);\n        }\n    }", "highlightLines": [25]}, "category": "code", "location": {"file": "contracts/contracts/helpers/UpgradeableProxy-08.sol", "line": 25, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "48b0290e7384", "fix": {"template": null, "available": false}, "title": "SWC-110: assert() used for input validation - use require() instead, assert is for invariants", "ruleId": "rules.sol-swc-110-assert-user-input", "snippet": {"code": "        assert(_IMPLEMENTATION_SLOT == bytes32(uint256(keccak256(\"eip1967.proxy.implementation\")) - 1));", "highlightLines": [26]}, "category": "code", "location": {"file": "contracts/contracts/helpers/UpgradeableProxy-08.sol", "line": 26, "column": 9}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-110"], "description": ""}, {"id": "835a86fc6b03", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "            (bool success,) = _logic.delegatecall(_data);", "highlightLines": [30]}, "category": "code", "location": {"file": "contracts/contracts/helpers/UpgradeableProxy-08.sol", "line": 30, "column": 31}, "severity": "medium", "references": [], "description": ""}, {"id": "ab0d4a0b6379", "fix": {"template": null, "available": false}, "title": "Delegatecall with user-controlled data - storage slot collision possible", "ruleId": "rules.sol-arbitrary-delegatecall-data", "snippet": {"code": "            (bool success,) = _logic.delegatecall(_data);", "highlightLines": [30]}, "category": "code", "location": {"file": "contracts/contracts/helpers/UpgradeableProxy-08.sol", "line": 30, "column": 37}, "severity": "high", "references": [], "description": ""}, {"id": "7200e7c03169", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "            require(success);", "highlightLines": [31]}, "category": "code", "location": {"file": "contracts/contracts/helpers/UpgradeableProxy-08.sol", "line": 31, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "2d8332c04e17", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Upgraded(address indexed implementation);", "highlightLines": [38]}, "category": "code", "location": {"file": "contracts/contracts/helpers/UpgradeableProxy-08.sol", "line": 38, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "d58ea78e5f46", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "    bytes32 private constant _IMPLEMENTATION_SLOT = 0x360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc;", "highlightLines": [45]}, "category": "code", "location": {"file": "contracts/contracts/helpers/UpgradeableProxy-08.sol", "line": 45, "column": 53}, "severity": "high", "references": [], "description": ""}, {"id": "08062a1fa7ac", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function _implementation() internal override view returns (address impl) {\n        bytes32 slot = _IMPLEMENTATION_SLOT;", "highlightLines": [50]}, "category": "code", "location": {"file": "contracts/contracts/helpers/UpgradeableProxy-08.sol", "line": 50, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "02ddae07b560", "fix": {"template": null, "available": false}, "title": "View/pure function uses assembly - may modify state unexpectedly", "ruleId": "rules.sol-constant-function-assembly", "snippet": {"code": "    function _implementation() internal override view returns (address impl) {\n        bytes32 slot = _IMPLEMENTATION_SLOT;\n        // solhint-disable-next-line no-inline-assembly\n        assembly {", "highlightLines": [50]}, "category": "code", "location": {"file": "contracts/contracts/helpers/UpgradeableProxy-08.sol", "line": 50, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-using-assembly-code"], "description": ""}, {"id": "86692f5bdf22", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 slot = _IMPLEMENTATION_SLOT;", "highlightLines": [51]}, "category": "code", "location": {"file": "contracts/contracts/helpers/UpgradeableProxy-08.sol", "line": 51, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c80f4e85b408", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes32 slot = _IMPLEMENTATION_SLOT;\n        // solhint-disable-next-line no-inline-assembly\n        assembly {\n            impl := sload(slot)\n        }", "highlightLines": [51]}, "category": "code", "location": {"file": "contracts/contracts/helpers/UpgradeableProxy-08.sol", "line": 51, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "aecea34fe321", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [53]}, "category": "code", "location": {"file": "contracts/contracts/helpers/UpgradeableProxy-08.sol", "line": 53, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "93a9b9688c22", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        bytes32 slot = _IMPLEMENTATION_SLOT;", "highlightLines": [73]}, "category": "code", "location": {"file": "contracts/contracts/helpers/UpgradeableProxy-08.sol", "line": 73, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d2a9116b15da", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [77]}, "category": "code", "location": {"file": "contracts/contracts/helpers/UpgradeableProxy-08.sol", "line": 77, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "3e0ff1a3228e", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.5.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "contracts/contracts/levels/AlienCodex.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "424cc9300f7d", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract AlienCodex is Ownable {\n\n  bool public contact;", "highlightLines": [6]}, "category": "code", "location": {"file": "contracts/contracts/levels/AlienCodex.sol", "line": 6, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "e4f8a537da69", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  modifier contacted() {\n    assert(contact);\n    _;\n  }", "highlightLines": [11]}, "category": "code", "location": {"file": "contracts/contracts/levels/AlienCodex.sol", "line": 11, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "701bdde15e82", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "  modifier contacted() {\n    assert(contact);\n    _;\n  }", "highlightLines": [11]}, "category": "code", "location": {"file": "contracts/contracts/levels/AlienCodex.sol", "line": 11, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "e944ea2db077", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    _;", "highlightLines": [13]}, "category": "code", "location": {"file": "contracts/contracts/levels/AlienCodex.sol", "line": 13, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "ee8834e05adf", "fix": {"template": null, "available": false}, "title": "Array length can be manipulated - potential storage slot overflow attack (AlienCodex pattern)", "ruleId": "rules.sol-array-length-manipulation", "snippet": {"code": "    codex.length--;", "highlightLines": [25]}, "category": "code", "location": {"file": "contracts/contracts/levels/AlienCodex.sol", "line": 25, "column": 5}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/level/19"], "description": ""}, {"id": "77b8e2542981", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.5.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "contracts/contracts/levels/AlienCodexFactory.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "65248ea9ea45", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    _player;", "highlightLines": [11]}, "category": "code", "location": {"file": "contracts/contracts/levels/AlienCodexFactory.sol", "line": 11, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "75bf0efac47a", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    return address(new AlienCodex());", "highlightLines": [12]}, "category": "code", "location": {"file": "contracts/contracts/levels/AlienCodexFactory.sol", "line": 12, "column": 20}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "488e6e1e318f", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "contracts/contracts/levels/CoinFlip.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "b5625e5f3d1f", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "  uint256 lastHash;", "highlightLines": [7]}, "category": "code", "location": {"file": "contracts/contracts/levels/CoinFlip.sol", "line": 7, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c62d36313227", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "  uint256 FACTOR = 57896044618658097711785492504343953926634992332820282019728792003956564819968;", "highlightLines": [8]}, "category": "code", "location": {"file": "contracts/contracts/levels/CoinFlip.sol", "line": 8, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4c7b8f9349ee", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  constructor() {\n    consecutiveWins = 0;\n  }", "highlightLines": [10]}, "category": "code", "location": {"file": "contracts/contracts/levels/CoinFlip.sol", "line": 10, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "9e790a599e4b", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "  function flip(bool _guess) public returns (bool) {\n    uint256 blockValue = uint256(blockhash(block.number - 1));\n\n    if (lastHash == blockValue) {\n      revert();", "highlightLines": [14]}, "category": "code", "location": {"file": "contracts/contracts/levels/CoinFlip.sol", "line": 14, "column": 3}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "164fcf5547f9", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 blockValue = uint256(blockhash(block.number - 1));", "highlightLines": [15]}, "category": "code", "location": {"file": "contracts/contracts/levels/CoinFlip.sol", "line": 15, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8958052b0695", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 blockValue = uint256(blockhash(block.number - 1));\n\n    if (lastHash == blockValue) {\n      revert();\n    }\n\n    lastHash = blockValue;", "highlightLines": [15]}, "category": "code", "location": {"file": "contracts/contracts/levels/CoinFlip.sol", "line": 15, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "739943007a1b", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - predictable by miners, 0 after 256 blocks", "ruleId": "rules.sol-blockhash-randomness", "snippet": {"code": "    uint256 blockValue = uint256(blockhash(block.number - 1));", "highlightLines": [15]}, "category": "code", "location": {"file": "contracts/contracts/levels/CoinFlip.sol", "line": 15, "column": 34}, "severity": "high", "references": [], "description": ""}, {"id": "5bdb1ea48044", "fix": {"template": null, "available": false}, "title": "blockhash only works for last 256 blocks - older blocks return 0 (PredictTheBlockHash pattern)", "ruleId": "rules.sol-blockhash-256-limit", "snippet": {"code": "    uint256 blockValue = uint256(blockhash(block.number - 1));", "highlightLines": [15]}, "category": "code", "location": {"file": "contracts/contracts/levels/CoinFlip.sol", "line": 15, "column": 34}, "severity": "medium", "references": ["https://capturetheether.com/challenges/lottery/predict-block-hash/"], "description": ""}, {"id": "0d96043ace41", "fix": {"template": null, "available": false}, "title": "blockhash(block.number - 1) used for randomness - miners can manipulate", "ruleId": "rules.sol-blockhash-previous-block", "snippet": {"code": "    uint256 blockValue = uint256(blockhash(block.number - 1));", "highlightLines": [15]}, "category": "code", "location": {"file": "contracts/contracts/levels/CoinFlip.sol", "line": 15, "column": 34}, "severity": "medium", "references": [], "description": ""}, {"id": "d94d266a2e41", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "    uint256 blockValue = uint256(blockhash(block.number - 1));", "highlightLines": [15]}, "category": "code", "location": {"file": "contracts/contracts/levels/CoinFlip.sol", "line": 15, "column": 34}, "severity": "medium", "references": [], "description": ""}, {"id": "afc9000ebdd0", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "    if (lastHash == blockValue) {\n      revert();\n    }", "highlightLines": [17]}, "category": "code", "location": {"file": "contracts/contracts/levels/CoinFlip.sol", "line": 17, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "1a7898db148a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    lastHash = blockValue;\n    uint256 coinFlip = blockValue / FACTOR;", "highlightLines": [21]}, "category": "code", "location": {"file": "contracts/contracts/levels/CoinFlip.sol", "line": 21, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "6d617a779208", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 coinFlip = blockValue / FACTOR;", "highlightLines": [22]}, "category": "code", "location": {"file": "contracts/contracts/levels/CoinFlip.sol", "line": 22, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "76f455e8e7cf", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 coinFlip = blockValue / FACTOR;\n    bool side = coinFlip == 1 ? true : false;", "highlightLines": [22]}, "category": "code", "location": {"file": "contracts/contracts/levels/CoinFlip.sol", "line": 22, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "30b436e88c47", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    bool side = coinFlip == 1 ? true : false;", "highlightLines": [23]}, "category": "code", "location": {"file": "contracts/contracts/levels/CoinFlip.sol", "line": 23, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "663282aea27b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    bool side = coinFlip == 1 ? true : false;\n\n    if (side == _guess) {\n      consecutiveWins++;\n      return true;\n    } else {\n      consecutiveWins = 0;\n      return false;\n    }", "highlightLines": [23]}, "category": "code", "location": {"file": "contracts/contracts/levels/CoinFlip.sol", "line": 23, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "98cf789bf40b", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "contracts/contracts/levels/CoinFlipFactory.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "622b1f3ab0ea", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    _player;", "highlightLines": [11]}, "category": "code", "location": {"file": "contracts/contracts/levels/CoinFlipFactory.sol", "line": 11, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "f447e6c2d2db", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    return address(new CoinFlip());", "highlightLines": [12]}, "category": "code", "location": {"file": "contracts/contracts/levels/CoinFlipFactory.sol", "line": 12, "column": 20}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "ca971c96577a", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "  function validateInstance(address payable _instance, address) override public view returns (bool) {\n    CoinFlip instance = CoinFlip(_instance);", "highlightLines": [15]}, "category": "code", "location": {"file": "contracts/contracts/levels/CoinFlipFactory.sol", "line": 15, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "b0a2b4ed93b6", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "contracts/contracts/levels/Delegation.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "0cae039a242a", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  constructor(address _owner) {\n    owner = _owner;\n  }", "highlightLines": [8]}, "category": "code", "location": {"file": "contracts/contracts/levels/Delegation.sol", "line": 8, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "655be3a7ec06", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "    owner = _owner;", "highlightLines": [9]}, "category": "code", "location": {"file": "contracts/contracts/levels/Delegation.sol", "line": 9, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "250686732b05", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "    owner = msg.sender;", "highlightLines": [13]}, "category": "code", "location": {"file": "contracts/contracts/levels/Delegation.sol", "line": 13, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "081a155e31c4", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  constructor(address _delegateAddress) {\n    delegate = Delegate(_delegateAddress);\n    owner = msg.sender;\n  }", "highlightLines": [22]}, "category": "code", "location": {"file": "contracts/contracts/levels/Delegation.sol", "line": 22, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "75ad7e383418", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    delegate = Delegate(_delegateAddress);\n    owner = msg.sender;", "highlightLines": [23]}, "category": "code", "location": {"file": "contracts/contracts/levels/Delegation.sol", "line": 23, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "3a0e40846264", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "    owner = msg.sender;", "highlightLines": [24]}, "category": "code", "location": {"file": "contracts/contracts/levels/Delegation.sol", "line": 24, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "f0795b9e1437", "fix": {"template": null, "available": false}, "title": "Delegatecall in fallback executes external code in caller's context - storage/owner can be hijacked (Delegation pattern)", "ruleId": "rules.sol-delegatecall-preserves-context", "snippet": {"code": "  fallback() external {\n    (bool result,) = address(delegate).delegatecall(msg.data);", "highlightLines": [27]}, "category": "code", "location": {"file": "contracts/contracts/levels/Delegation.sol", "line": 27, "column": 3}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/level/6"], "description": ""}, {"id": "43be02fa0256", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "      this;", "highlightLines": [30]}, "category": "code", "location": {"file": "contracts/contracts/levels/Delegation.sol", "line": 30, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "a48cb27635ea", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "contracts/contracts/levels/DelegationFactory.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "263ea158121d", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract DelegationFactory is Level {\n\n  address delegateAddress;", "highlightLines": [8]}, "category": "code", "location": {"file": "contracts/contracts/levels/DelegationFactory.sol", "line": 8, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "a6275e78f68d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n  address delegateAddress;", "highlightLines": [9]}, "category": "code", "location": {"file": "contracts/contracts/levels/DelegationFactory.sol", "line": 9, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c5bf7de95401", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  constructor() {\n    Delegate newDelegate = new Delegate(address(0));\n    delegateAddress = address(newDelegate);\n  }", "highlightLines": [12]}, "category": "code", "location": {"file": "contracts/contracts/levels/DelegationFactory.sol", "line": 12, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "6093deaa42d7", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    Delegate newDelegate = new Delegate(address(0));\n    delegateAddress = address(newDelegate);", "highlightLines": [13]}, "category": "code", "location": {"file": "contracts/contracts/levels/DelegationFactory.sol", "line": 13, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "56df141a8af1", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    Delegate newDelegate = new Delegate(address(0));", "highlightLines": [13]}, "category": "code", "location": {"file": "contracts/contracts/levels/DelegationFactory.sol", "line": 13, "column": 28}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "b43b8a0ecf8b", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    _player;", "highlightLines": [18]}, "category": "code", "location": {"file": "contracts/contracts/levels/DelegationFactory.sol", "line": 18, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "48042d09d166", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    Delegation parity = new Delegation(delegateAddress);", "highlightLines": [19]}, "category": "code", "location": {"file": "contracts/contracts/levels/DelegationFactory.sol", "line": 19, "column": 25}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "940b2a77b74f", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "  function validateInstance(address payable _instance, address _player) override public view returns (bool) {\n    Delegation parity = Delegation(_instance);", "highlightLines": [23]}, "category": "code", "location": {"file": "contracts/contracts/levels/DelegationFactory.sol", "line": 23, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "f2b55bd03857", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "contracts/contracts/levels/Denial.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "86b90e596868", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "    address public constant owner = address(0xA9E);", "highlightLines": [6]}, "category": "code", "location": {"file": "contracts/contracts/levels/Denial.sol", "line": 6, "column": 29}, "severity": "info", "references": [], "description": ""}, {"id": "ce34d0d8f93e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint timeLastWithdrawn;", "highlightLines": [7]}, "category": "code", "location": {"file": "contracts/contracts/levels/Denial.sol", "line": 7, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "84df0eaf8154", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function withdraw() public {", "highlightLines": [15]}, "category": "code", "location": {"file": "contracts/contracts/levels/Denial.sol", "line": 15, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "70ea10dd968a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint amountToSend = address(this).balance / 100;", "highlightLines": [16]}, "category": "code", "location": {"file": "contracts/contracts/levels/Denial.sol", "line": 16, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "de10970ff10f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint amountToSend = address(this).balance / 100;\n        // perform a call without checking return\n        // The recipient can revert, the owner will still get their share\n        partner.call{value:amountToSend}(\"\");\n        payable(owner).transfer(amountToSend);\n        // keep track of last withdrawal time\n        timeLastWithdrawn = block.timestamp;", "highlightLines": [16]}, "category": "code", "location": {"file": "contracts/contracts/levels/Denial.sol", "line": 16, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "0f32895277a7", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "        // perform a call without checking return\n        // The recipient can revert, the owner will still get their share\n        partner.call{value:amountToSend}(\"\");\n        payable(owner).transfer(amountToSend);", "highlightLines": [17]}, "category": "code", "location": {"file": "contracts/contracts/levels/Denial.sol", "line": 17, "column": 44}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "cec93a7da142", "fix": {"template": null, "available": false}, "title": "Low-level call without checking return value - silent failure possible", "ruleId": "rules.sol-unchecked-call-return", "snippet": {"code": "        partner.call{value:amountToSend}(\"\");", "highlightLines": [19]}, "category": "code", "location": {"file": "contracts/contracts/levels/Denial.sol", "line": 19, "column": 16}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-104/", "https://blocksecteam.medium.com/li-fi-attack"], "description": ""}, {"id": "2953a56b8f57", "fix": {"template": null, "available": false}, "title": "State change after external call - potential reentrancy vulnerability", "ruleId": "rules.sol-external-call-state-change", "snippet": {"code": "        partner.call{value:amountToSend}(\"\");\n        payable(owner).transfer(amountToSend);\n        // keep track of last withdrawal time\n        timeLastWithdrawn = block.timestamp;", "highlightLines": [19]}, "category": "code", "location": {"file": "contracts/contracts/levels/Denial.sol", "line": 19, "column": 16}, "severity": "high", "references": ["https://consensys.github.io/smart-contract-best-practices/attacks/reentrancy/"], "description": ""}, {"id": "899266dedddb", "fix": {"template": null, "available": false}, "title": "payable.transfer() has 2300 gas limit - fails for contracts with receive logic", "ruleId": "rules.sol-payable-transfer-gas-limit", "snippet": {"code": "        payable(owner).transfer(amountToSend);", "highlightLines": [20]}, "category": "code", "location": {"file": "contracts/contracts/levels/Denial.sol", "line": 20, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/payable-transfer.sol"], "description": ""}, {"id": "6f5c8cc2ad70", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        payable(owner).transfer(amountToSend);", "highlightLines": [20]}, "category": "code", "location": {"file": "contracts/contracts/levels/Denial.sol", "line": 20, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "39d2e3ddb2bf", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        timeLastWithdrawn = block.timestamp;", "highlightLines": [22]}, "category": "code", "location": {"file": "contracts/contracts/levels/Denial.sol", "line": 22, "column": 29}, "severity": "medium", "references": [], "description": ""}, {"id": "56e20102b55a", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "    receive() external payable {}", "highlightLines": [27]}, "category": "code", "location": {"file": "contracts/contracts/levels/Denial.sol", "line": 27, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "77fd857b3cfd", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "    receive() external payable {}", "highlightLines": [27]}, "category": "code", "location": {"file": "contracts/contracts/levels/Denial.sol", "line": 27, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "dac13c0acd04", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "contracts/contracts/levels/DenialFactory.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "d9bd1841fdac", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract DenialFactory is Level {\n\n  uint public initialDeposit = 0.001 ether;", "highlightLines": [8]}, "category": "code", "location": {"file": "contracts/contracts/levels/DenialFactory.sol", "line": 8, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "8a2a7da617cc", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    _player;", "highlightLines": [13]}, "category": "code", "location": {"file": "contracts/contracts/levels/DenialFactory.sol", "line": 13, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "8186959310c9", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(msg.value >= initialDeposit);", "highlightLines": [14]}, "category": "code", "location": {"file": "contracts/contracts/levels/DenialFactory.sol", "line": 14, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "5d094a78bb7a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    Denial instance = new Denial();\n    (bool result,) = address(instance).call{value:msg.value}(\"\");", "highlightLines": [15]}, "category": "code", "location": {"file": "contracts/contracts/levels/DenialFactory.sol", "line": 15, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "147ee1c98294", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    Denial instance = new Denial();", "highlightLines": [15]}, "category": "code", "location": {"file": "contracts/contracts/levels/DenialFactory.sol", "line": 15, "column": 23}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "a880dcd8b05c", "fix": {"template": null, "available": false}, "title": "Low-level call without checking return value - silent failure possible", "ruleId": "rules.sol-unchecked-call-return", "snippet": {"code": "    (bool result,) = address(instance).call{value:msg.value}(\"\");", "highlightLines": [16]}, "category": "code", "location": {"file": "contracts/contracts/levels/DenialFactory.sol", "line": 16, "column": 39}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-104/", "https://blocksecteam.medium.com/li-fi-attack"], "description": ""}, {"id": "b1e6662805d8", "fix": {"template": null, "available": false}, "title": "State change after external call - potential reentrancy vulnerability", "ruleId": "rules.sol-external-call-state-change", "snippet": {"code": "    (bool result,) = address(instance).call{value:msg.value}(\"\");\n    require(result);\n    return address(instance);\n  }\n\n  function validateInstance(address payable _instance, address _player) override public returns (bool) {\n    _player;\n    Denial instance = Denial(_instance);", "highlightLines": [16]}, "category": "code", "location": {"file": "contracts/contracts/levels/DenialFactory.sol", "line": 16, "column": 39}, "severity": "high", "references": ["https://consensys.github.io/smart-contract-best-practices/attacks/reentrancy/"], "description": ""}, {"id": "509028650a1b", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(result);", "highlightLines": [17]}, "category": "code", "location": {"file": "contracts/contracts/levels/DenialFactory.sol", "line": 17, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "c0b3549aceb1", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    _player;", "highlightLines": [22]}, "category": "code", "location": {"file": "contracts/contracts/levels/DenialFactory.sol", "line": 22, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "4dbfdaae7ee9", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    Denial instance = Denial(_instance);\n    if (address(instance).balance <= 100 wei) { // cheating otherwise\n        return false;\n    }\n    // fix the gas limit for this call\n    (bool result,) = address(instance).call{gas:1000000}(abi.encodeWithSignature(\"withdraw()\")); // Must revert", "highlightLines": [23]}, "category": "code", "location": {"file": "contracts/contracts/levels/DenialFactory.sol", "line": 23, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "7333a3bea82d", "fix": {"template": null, "available": false}, "title": "SWC-134: Hardcoded gas amount - may break after EVM gas cost changes", "ruleId": "rules.sol-swc-134-hardcoded-gas", "snippet": {"code": "    (bool result,) = address(instance).call{gas:1000000}(abi.encodeWithSignature(\"withdraw()\")); // Must revert", "highlightLines": [28]}, "category": "code", "location": {"file": "contracts/contracts/levels/DenialFactory.sol", "line": 28, "column": 39}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-134"], "description": ""}, {"id": "38116bee203f", "fix": {"template": null, "available": false}, "title": "External call with limited gas - may fail due to gas griefing if recipient uses all gas", "ruleId": "rules.sol-insufficient-gas-griefing", "snippet": {"code": "    (bool result,) = address(instance).call{gas:1000000}(abi.encodeWithSignature(\"withdraw()\")); // Must revert", "highlightLines": [28]}, "category": "code", "location": {"file": "contracts/contracts/levels/DenialFactory.sol", "line": 28, "column": 39}, "severity": "medium", "references": ["https://consensys.github.io/smart-contract-best-practices/attacks/griefing/"], "description": ""}, {"id": "ace835e5550a", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "  receive() external payable {}", "highlightLines": [32]}, "category": "code", "location": {"file": "contracts/contracts/levels/DenialFactory.sol", "line": 32, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "3855765ef45a", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "  receive() external payable {}", "highlightLines": [32]}, "category": "code", "location": {"file": "contracts/contracts/levels/DenialFactory.sol", "line": 32, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "51b42d18aa58", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "contracts/contracts/levels/Dex.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "a8a09fa3055b", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract Dex is Ownable {\n  address public token1;\n  address public token2;", "highlightLines": [8]}, "category": "code", "location": {"file": "contracts/contracts/levels/Dex.sol", "line": 8, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "1631353e8a21", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  constructor() {}", "highlightLines": [11]}, "category": "code", "location": {"file": "contracts/contracts/levels/Dex.sol", "line": 11, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "dcddc4780432", "fix": {"template": null, "available": false}, "title": "Empty constructor or constructor with no effect - may indicate incomplete implementation", "ruleId": "rules.sol-void-constructor", "snippet": {"code": "  constructor() {}", "highlightLines": [11]}, "category": "code", "location": {"file": "contracts/contracts/levels/Dex.sol", "line": 11, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "b4e63ea02f93", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "  function setTokens(address _token1, address _token2) public onlyOwner {", "highlightLines": [13]}, "category": "code", "location": {"file": "contracts/contracts/levels/Dex.sol", "line": 13, "column": 63}, "severity": "info", "references": [], "description": ""}, {"id": "1edeab1faeec", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    token1 = _token1;\n    token2 = _token2;", "highlightLines": [14]}, "category": "code", "location": {"file": "contracts/contracts/levels/Dex.sol", "line": 14, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "0926f0ba7721", "fix": {"template": null, "available": false}, "title": "Swap/liquidity operation without deadline parameter - transaction can be delayed indefinitely", "ruleId": "rules.sol-missing-deadline-check", "snippet": {"code": "  function addLiquidity(address token_address, uint amount) public onlyOwner {", "highlightLines": [18]}, "category": "code", "location": {"file": "contracts/contracts/levels/Dex.sol", "line": 18, "column": 3}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "fd92ed9ced2c", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "  function addLiquidity(address token_address, uint amount) public onlyOwner {", "highlightLines": [18]}, "category": "code", "location": {"file": "contracts/contracts/levels/Dex.sol", "line": 18, "column": 68}, "severity": "info", "references": [], "description": ""}, {"id": "07eec3dfe1e3", "fix": {"template": null, "available": false}, "title": "Token transfer without checking actual received amount - deflationary tokens may transfer less", "ruleId": "rules.sol-deflationary-token-transfer", "snippet": {"code": "    IERC20(token_address).transferFrom(msg.sender, address(this), amount);", "highlightLines": [19]}, "category": "code", "location": {"file": "contracts/contracts/levels/Dex.sol", "line": 19, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "17b3b7478afd", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "    IERC20(token_address).transferFrom(msg.sender, address(this), amount);", "highlightLines": [19]}, "category": "code", "location": {"file": "contracts/contracts/levels/Dex.sol", "line": 19, "column": 5}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "e71a87dc8922", "fix": {"template": null, "available": false}, "title": "Token amount after transfer may differ - check actual received amount", "ruleId": "rules.sol-fee-on-transfer-token", "snippet": {"code": "    IERC20(token_address).transferFrom(msg.sender, address(this), amount);", "highlightLines": [19]}, "category": "code", "location": {"file": "contracts/contracts/levels/Dex.sol", "line": 19, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "1bf496c0f196", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "    IERC20(token_address).transferFrom(msg.sender, address(this), amount);", "highlightLines": [19]}, "category": "code", "location": {"file": "contracts/contracts/levels/Dex.sol", "line": 19, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "d8c671a167b7", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without SafeERC20 - some tokens dont return bool", "ruleId": "rules.sol-unsafe-erc20-transfer", "snippet": {"code": "    IERC20(token_address).transferFrom(msg.sender, address(this), amount);", "highlightLines": [19]}, "category": "code", "location": {"file": "contracts/contracts/levels/Dex.sol", "line": 19, "column": 5}, "severity": "medium", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/token/ERC20/utils/SafeERC20.sol"], "description": ""}, {"id": "96ab252eec3b", "fix": {"template": null, "available": false}, "title": "Swap/liquidity operation without deadline parameter - transaction can be delayed indefinitely", "ruleId": "rules.sol-missing-deadline-check", "snippet": {"code": "  function swap(address from, address to, uint amount) public {", "highlightLines": [22]}, "category": "code", "location": {"file": "contracts/contracts/levels/Dex.sol", "line": 22, "column": 3}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "d1977dfef0fb", "fix": {"template": null, "available": false}, "title": "Token swap/buy without slippage protection - MEV/sandwich attack risk", "ruleId": "rules.sol-missing-slippage-protection", "snippet": {"code": "  function swap(address from, address to, uint amount) public {", "highlightLines": [22]}, "category": "code", "location": {"file": "contracts/contracts/levels/Dex.sol", "line": 22, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "c81aaa7cdfc9", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "  function swap(address from, address to, uint amount) public {\n    require((from == token1 && to == token2) || (from == token2 && to == token1), \"Invalid tokens\");", "highlightLines": [22]}, "category": "code", "location": {"file": "contracts/contracts/levels/Dex.sol", "line": 22, "column": 3}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "c678af4f5e54", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "    require(IERC20(from).balanceOf(msg.sender) >= amount, \"Not enough to swap\");", "highlightLines": [24]}, "category": "code", "location": {"file": "contracts/contracts/levels/Dex.sol", "line": 24, "column": 13}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "d15a3feb9703", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint swapAmount = getSwapPrice(from, to, amount);", "highlightLines": [25]}, "category": "code", "location": {"file": "contracts/contracts/levels/Dex.sol", "line": 25, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "5cd51fb8a1b3", "fix": {"template": null, "available": false}, "title": "Token transfer without checking actual received amount - deflationary tokens may transfer less", "ruleId": "rules.sol-deflationary-token-transfer", "snippet": {"code": "    IERC20(from).transferFrom(msg.sender, address(this), amount);", "highlightLines": [26]}, "category": "code", "location": {"file": "contracts/contracts/levels/Dex.sol", "line": 26, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "cdb7fb061c86", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "    IERC20(from).transferFrom(msg.sender, address(this), amount);", "highlightLines": [26]}, "category": "code", "location": {"file": "contracts/contracts/levels/Dex.sol", "line": 26, "column": 5}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "6c7e5939c34c", "fix": {"template": null, "available": false}, "title": "Token amount after transfer may differ - check actual received amount", "ruleId": "rules.sol-fee-on-transfer-token", "snippet": {"code": "    IERC20(from).transferFrom(msg.sender, address(this), amount);", "highlightLines": [26]}, "category": "code", "location": {"file": "contracts/contracts/levels/Dex.sol", "line": 26, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "492c380aea72", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "    IERC20(from).transferFrom(msg.sender, address(this), amount);", "highlightLines": [26]}, "category": "code", "location": {"file": "contracts/contracts/levels/Dex.sol", "line": 26, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "b87aa5ec3ea2", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without SafeERC20 - some tokens dont return bool", "ruleId": "rules.sol-unsafe-erc20-transfer", "snippet": {"code": "    IERC20(from).transferFrom(msg.sender, address(this), amount);", "highlightLines": [26]}, "category": "code", "location": {"file": "contracts/contracts/levels/Dex.sol", "line": 26, "column": 5}, "severity": "medium", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/token/ERC20/utils/SafeERC20.sol"], "description": ""}, {"id": "ff9fa5974ec1", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "    IERC20(to).approve(address(this), swapAmount);", "highlightLines": [27]}, "category": "code", "location": {"file": "contracts/contracts/levels/Dex.sol", "line": 27, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "668531caeded", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without SafeERC20 - some tokens dont return bool", "ruleId": "rules.sol-unsafe-erc20-transfer", "snippet": {"code": "    IERC20(to).approve(address(this), swapAmount);", "highlightLines": [27]}, "category": "code", "location": {"file": "contracts/contracts/levels/Dex.sol", "line": 27, "column": 5}, "severity": "medium", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/token/ERC20/utils/SafeERC20.sol"], "description": ""}, {"id": "6b4fe3f1f389", "fix": {"template": null, "available": false}, "title": "Token transfer without checking actual received amount - deflationary tokens may transfer less", "ruleId": "rules.sol-deflationary-token-transfer", "snippet": {"code": "    IERC20(to).transferFrom(address(this), msg.sender, swapAmount);", "highlightLines": [28]}, "category": "code", "location": {"file": "contracts/contracts/levels/Dex.sol", "line": 28, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "b5c53efb0ee9", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "    IERC20(to).transferFrom(address(this), msg.sender, swapAmount);", "highlightLines": [28]}, "category": "code", "location": {"file": "contracts/contracts/levels/Dex.sol", "line": 28, "column": 5}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "9aea6e8d1650", "fix": {"template": null, "available": false}, "title": "Token amount after transfer may differ - check actual received amount", "ruleId": "rules.sol-fee-on-transfer-token", "snippet": {"code": "    IERC20(to).transferFrom(address(this), msg.sender, swapAmount);", "highlightLines": [28]}, "category": "code", "location": {"file": "contracts/contracts/levels/Dex.sol", "line": 28, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "f3e5e7c41e20", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "    IERC20(to).transferFrom(address(this), msg.sender, swapAmount);", "highlightLines": [28]}, "category": "code", "location": {"file": "contracts/contracts/levels/Dex.sol", "line": 28, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "99302b4fafe8", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without SafeERC20 - some tokens dont return bool", "ruleId": "rules.sol-unsafe-erc20-transfer", "snippet": {"code": "    IERC20(to).transferFrom(address(this), msg.sender, swapAmount);", "highlightLines": [28]}, "category": "code", "location": {"file": "contracts/contracts/levels/Dex.sol", "line": 28, "column": 5}, "severity": "medium", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/token/ERC20/utils/SafeERC20.sol"], "description": ""}, {"id": "0cf433a8d062", "fix": {"template": null, "available": false}, "title": "View function reads state that may be stale during callback - read-only reentrancy risk", "ruleId": "rules.sol-read-only-reentrancy", "snippet": {"code": "  function getSwapPrice(address from, address to, uint amount) public view returns(uint){\n    return((amount * IERC20(to).balanceOf(address(this)))/IERC20(from).balanceOf(address(this)));", "highlightLines": [31]}, "category": "code", "location": {"file": "contracts/contracts/levels/Dex.sol", "line": 31, "column": 3}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs", "https://chainsecurity.com/curve-lp-oracle-manipulation-post-mortem/"], "description": ""}, {"id": "9dd60347d454", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "    return((amount * IERC20(to).balanceOf(address(this)))/IERC20(from).balanceOf(address(this)));", "highlightLines": [32]}, "category": "code", "location": {"file": "contracts/contracts/levels/Dex.sol", "line": 32, "column": 13}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "2eaf3e9de80a", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "  function approve(address spender, uint amount) public {", "highlightLines": [35]}, "category": "code", "location": {"file": "contracts/contracts/levels/Dex.sol", "line": 35, "column": 3}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "9e0f4001970e", "fix": {"template": null, "available": false}, "title": "View function reads state that may be stale during callback - read-only reentrancy risk", "ruleId": "rules.sol-read-only-reentrancy", "snippet": {"code": "  function balanceOf(address token, address account) public view returns (uint){\n    return IERC20(token).balanceOf(account);", "highlightLines": [40]}, "category": "code", "location": {"file": "contracts/contracts/levels/Dex.sol", "line": 40, "column": 3}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs", "https://chainsecurity.com/curve-lp-oracle-manipulation-post-mortem/"], "description": ""}, {"id": "b392706c2fed", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "    return IERC20(token).balanceOf(account);", "highlightLines": [41]}, "category": "code", "location": {"file": "contracts/contracts/levels/Dex.sol", "line": 41, "column": 12}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "0009088e88fa", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract SwappableToken is ERC20 {\n  address private _dex;", "highlightLines": [45]}, "category": "code", "location": {"file": "contracts/contracts/levels/Dex.sol", "line": 45, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "7fbd554751fb", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  constructor(address dexInstance, string memory name, string memory symbol, uint256 initialSupply) ERC20(name, symbol) {\n        _mint(msg.sender, initialSupply);\n        _dex = dexInstance;\n  }", "highlightLines": [47]}, "category": "code", "location": {"file": "contracts/contracts/levels/Dex.sol", "line": 47, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "4dd6b6c2e8d9", "fix": {"template": null, "available": false}, "title": "NFT mint without supply check - potential overflow in tokenId", "ruleId": "rules.sol-nft-overflow-mint", "snippet": {"code": "        _mint(msg.sender, initialSupply);", "highlightLines": [48]}, "category": "code", "location": {"file": "contracts/contracts/levels/Dex.sol", "line": 48, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "cb3ed1d891c8", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "  function approve(address owner, address spender, uint256 amount) public {", "highlightLines": [52]}, "category": "code", "location": {"file": "contracts/contracts/levels/Dex.sol", "line": 52, "column": 3}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "b3bdee0cfbee", "fix": {"template": null, "available": false}, "title": "Using approve() without increaseAllowance/decreaseAllowance - vulnerable to front-running race condition", "ruleId": "rules.sol-erc20-approve-frontrun", "snippet": {"code": "  function approve(address owner, address spender, uint256 amount) public {\n    require(owner != _dex, \"InvalidApprover\");\n    super._approve(owner, spender, amount);\n  }", "highlightLines": [52]}, "category": "code", "location": {"file": "contracts/contracts/levels/Dex.sol", "line": 52, "column": 3}, "severity": "info", "references": ["https://docs.google.com/document/d/1YLPtQxZu1UAvO9cZ1O2RPXBbT0mooh4DYKjA_jp-RLM"], "description": ""}, {"id": "caa39ac0697d", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexFactory.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "91078fb13d25", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract DexFactory is Level {\n\n  function createInstance(address _player) override public payable returns (address) {\n    Dex instance = new Dex();\n    address instanceAddress = address(instance);\n    \n    SwappableToken tokenInstance = new SwappableToken(instanceAddress, \"Token 1\", \"TKN1\", 110);\n    SwappableToken tokenInstanceTwo = new SwappableToken(instanceAddress, \"Token 2\", \"TKN2\", 110);\n    \n    address tokenInstanceAddress = address(tokenInstance);\n    address tokenInstanceTwoAddress = address(tokenInstanceTwo);", "highlightLines": [10]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexFactory.sol", "line": 10, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "e78de1285ab7", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    Dex instance = new Dex();\n    address instanceAddress = address(instance);", "highlightLines": [13]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexFactory.sol", "line": 13, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "7bd08dd4d700", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    Dex instance = new Dex();", "highlightLines": [13]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexFactory.sol", "line": 13, "column": 20}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "ade968b50693", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address instanceAddress = address(instance);", "highlightLines": [14]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexFactory.sol", "line": 14, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "edb14dc986b2", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    address instanceAddress = address(instance);\n    \n    SwappableToken tokenInstance = new SwappableToken(instanceAddress, \"Token 1\", \"TKN1\", 110);", "highlightLines": [14]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexFactory.sol", "line": 14, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "6deb7f91edf7", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    SwappableToken tokenInstance = new SwappableToken(instanceAddress, \"Token 1\", \"TKN1\", 110);\n    SwappableToken tokenInstanceTwo = new SwappableToken(instanceAddress, \"Token 2\", \"TKN2\", 110);", "highlightLines": [16]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexFactory.sol", "line": 16, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "1a4ab992d289", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    SwappableToken tokenInstance = new SwappableToken(instanceAddress, \"Token 1\", \"TKN1\", 110);", "highlightLines": [16]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexFactory.sol", "line": 16, "column": 36}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "d0d71f4fb316", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    SwappableToken tokenInstanceTwo = new SwappableToken(instanceAddress, \"Token 2\", \"TKN2\", 110);\n    \n    address tokenInstanceAddress = address(tokenInstance);", "highlightLines": [17]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexFactory.sol", "line": 17, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "6ac63c2012dc", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    SwappableToken tokenInstanceTwo = new SwappableToken(instanceAddress, \"Token 2\", \"TKN2\", 110);", "highlightLines": [17]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexFactory.sol", "line": 17, "column": 39}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "2ebd120a0a90", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    \n    address tokenInstanceAddress = address(tokenInstance);", "highlightLines": [18]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexFactory.sol", "line": 18, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "5d2e695e99f0", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    address tokenInstanceAddress = address(tokenInstance);\n    address tokenInstanceTwoAddress = address(tokenInstanceTwo);", "highlightLines": [19]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexFactory.sol", "line": 19, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "89e090bc06e0", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address tokenInstanceTwoAddress = address(tokenInstanceTwo);", "highlightLines": [20]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexFactory.sol", "line": 20, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "fc9aad03ddb1", "fix": {"template": null, "available": false}, "title": "ERC20 approve() return value not checked - some tokens return false instead of revert", "ruleId": "rules.sol-erc20-approve-no-return-check", "snippet": {"code": "    tokenInstance.approve(instanceAddress, 100);", "highlightLines": [24]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexFactory.sol", "line": 24, "column": 5}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#no-revert-on-failure"], "description": ""}, {"id": "b86868edc0e9", "fix": {"template": null, "available": false}, "title": "ERC20 approve without setting to 0 first - frontrunning double-spend possible", "ruleId": "rules.sol-frontrunnable-approval", "snippet": {"code": "    tokenInstance.approve(instanceAddress, 100);", "highlightLines": [24]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexFactory.sol", "line": 24, "column": 18}, "severity": "medium", "references": ["https://github.com/ethereum/EIPs/issues/20#issuecomment-263524729"], "description": ""}, {"id": "67be7e0b1dc5", "fix": {"template": null, "available": false}, "title": "ERC20 approve() return value not checked - some tokens return false instead of revert", "ruleId": "rules.sol-erc20-approve-no-return-check", "snippet": {"code": "    tokenInstanceTwo.approve(instanceAddress, 100);", "highlightLines": [25]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexFactory.sol", "line": 25, "column": 5}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#no-revert-on-failure"], "description": ""}, {"id": "4cd1ad4689c7", "fix": {"template": null, "available": false}, "title": "ERC20 approve without setting to 0 first - frontrunning double-spend possible", "ruleId": "rules.sol-frontrunnable-approval", "snippet": {"code": "    tokenInstanceTwo.approve(instanceAddress, 100);", "highlightLines": [25]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexFactory.sol", "line": 25, "column": 21}, "severity": "medium", "references": ["https://github.com/ethereum/EIPs/issues/20#issuecomment-263524729"], "description": ""}, {"id": "9a0803240e97", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "    tokenInstance.transfer(_player, 10);", "highlightLines": [30]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexFactory.sol", "line": 30, "column": 5}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "776f17cca86a", "fix": {"template": null, "available": false}, "title": "Missing zero address validation - tokens/ETH could be lost", "ruleId": "rules.sol-missing-zero-address-check", "snippet": {"code": "    tokenInstance.transfer(_player, 10);", "highlightLines": [30]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexFactory.sol", "line": 30, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "9ff7efe65d00", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "    tokenInstance.transfer(_player, 10);", "highlightLines": [30]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexFactory.sol", "line": 30, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "925675296616", "fix": {"template": null, "available": false}, "title": "ERC20 transfer() return value not checked - tokens like USDT don't return bool", "ruleId": "rules.sol-erc20-transfer-no-return-check", "snippet": {"code": "    tokenInstance.transfer(_player, 10);", "highlightLines": [30]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexFactory.sol", "line": 30, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "f3b18821eda0", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "    tokenInstanceTwo.transfer(_player, 10);", "highlightLines": [31]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexFactory.sol", "line": 31, "column": 5}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "817e38997484", "fix": {"template": null, "available": false}, "title": "Missing zero address validation - tokens/ETH could be lost", "ruleId": "rules.sol-missing-zero-address-check", "snippet": {"code": "    tokenInstanceTwo.transfer(_player, 10);", "highlightLines": [31]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexFactory.sol", "line": 31, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "1c3dc53a831e", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "    tokenInstanceTwo.transfer(_player, 10);", "highlightLines": [31]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexFactory.sol", "line": 31, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "a61c494e5c53", "fix": {"template": null, "available": false}, "title": "ERC20 transfer() return value not checked - tokens like USDT don't return bool", "ruleId": "rules.sol-erc20-transfer-no-return-check", "snippet": {"code": "    tokenInstanceTwo.transfer(_player, 10);", "highlightLines": [31]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexFactory.sol", "line": 31, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "548d192fe77b", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "  function validateInstance(address payable _instance, address) override public view returns (bool) {\n    address token1 = Dex(_instance).token1();\n    address token2 = Dex(_instance).token2();", "highlightLines": [36]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexFactory.sol", "line": 36, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "fde69a45d5ed", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address token1 = Dex(_instance).token1();", "highlightLines": [37]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexFactory.sol", "line": 37, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "bc5e460141c0", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "    address token1 = Dex(_instance).token1();\n    address token2 = Dex(_instance).token2();", "highlightLines": [37]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexFactory.sol", "line": 37, "column": 5}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "4e5c2d8c1044", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    address token1 = Dex(_instance).token1();\n    address token2 = Dex(_instance).token2();", "highlightLines": [37]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexFactory.sol", "line": 37, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "44de1a480079", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address token2 = Dex(_instance).token2();", "highlightLines": [38]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexFactory.sol", "line": 38, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "43412fa5d246", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwo.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "6306f40d9b08", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract DexTwo is Ownable {\n  address public token1;\n  address public token2;", "highlightLines": [8]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwo.sol", "line": 8, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "a92b1dd95265", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  constructor() {}", "highlightLines": [11]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwo.sol", "line": 11, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "a089cd9d5f6b", "fix": {"template": null, "available": false}, "title": "Empty constructor or constructor with no effect - may indicate incomplete implementation", "ruleId": "rules.sol-void-constructor", "snippet": {"code": "  constructor() {}", "highlightLines": [11]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwo.sol", "line": 11, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "af6e09702865", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "  function setTokens(address _token1, address _token2) public onlyOwner {", "highlightLines": [13]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwo.sol", "line": 13, "column": 63}, "severity": "info", "references": [], "description": ""}, {"id": "72b4b66b45b0", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    token1 = _token1;\n    token2 = _token2;", "highlightLines": [14]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwo.sol", "line": 14, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "61a0fc86f65f", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "  function add_liquidity(address token_address, uint amount) public onlyOwner {", "highlightLines": [18]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwo.sol", "line": 18, "column": 69}, "severity": "info", "references": [], "description": ""}, {"id": "95a8b323b71d", "fix": {"template": null, "available": false}, "title": "Token transfer without checking actual received amount - deflationary tokens may transfer less", "ruleId": "rules.sol-deflationary-token-transfer", "snippet": {"code": "    IERC20(token_address).transferFrom(msg.sender, address(this), amount);", "highlightLines": [19]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwo.sol", "line": 19, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "ad8fe7835964", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "    IERC20(token_address).transferFrom(msg.sender, address(this), amount);", "highlightLines": [19]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwo.sol", "line": 19, "column": 5}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "418ac522f501", "fix": {"template": null, "available": false}, "title": "Token amount after transfer may differ - check actual received amount", "ruleId": "rules.sol-fee-on-transfer-token", "snippet": {"code": "    IERC20(token_address).transferFrom(msg.sender, address(this), amount);", "highlightLines": [19]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwo.sol", "line": 19, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "676f8b4cb5a5", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "    IERC20(token_address).transferFrom(msg.sender, address(this), amount);", "highlightLines": [19]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwo.sol", "line": 19, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "515f97b131ad", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without SafeERC20 - some tokens dont return bool", "ruleId": "rules.sol-unsafe-erc20-transfer", "snippet": {"code": "    IERC20(token_address).transferFrom(msg.sender, address(this), amount);", "highlightLines": [19]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwo.sol", "line": 19, "column": 5}, "severity": "medium", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/token/ERC20/utils/SafeERC20.sol"], "description": ""}, {"id": "ba535b6d1415", "fix": {"template": null, "available": false}, "title": "DEX swap accepts any token address - attacker can use fake tokens to drain real ones (DexTwo pattern)", "ruleId": "rules.sol-dex-token-validation", "snippet": {"code": "  function swap(address from, address to, uint amount) public {", "highlightLines": [22]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwo.sol", "line": 22, "column": 3}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/level/23"], "description": ""}, {"id": "bd5bc2648ed5", "fix": {"template": null, "available": false}, "title": "Swap/liquidity operation without deadline parameter - transaction can be delayed indefinitely", "ruleId": "rules.sol-missing-deadline-check", "snippet": {"code": "  function swap(address from, address to, uint amount) public {", "highlightLines": [22]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwo.sol", "line": 22, "column": 3}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "14464298398b", "fix": {"template": null, "available": false}, "title": "Token swap/buy without slippage protection - MEV/sandwich attack risk", "ruleId": "rules.sol-missing-slippage-protection", "snippet": {"code": "  function swap(address from, address to, uint amount) public {", "highlightLines": [22]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwo.sol", "line": 22, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "c34e08f9b833", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "    require(IERC20(from).balanceOf(msg.sender) >= amount, \"Not enough to swap\");", "highlightLines": [23]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwo.sol", "line": 23, "column": 13}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "ff2219cdfc19", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint swapAmount = getSwapAmount(from, to, amount);", "highlightLines": [24]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwo.sol", "line": 24, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e8df9b57e8ce", "fix": {"template": null, "available": false}, "title": "Token transfer without checking actual received amount - deflationary tokens may transfer less", "ruleId": "rules.sol-deflationary-token-transfer", "snippet": {"code": "    IERC20(from).transferFrom(msg.sender, address(this), amount);", "highlightLines": [25]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwo.sol", "line": 25, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "18606b8c7a01", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "    IERC20(from).transferFrom(msg.sender, address(this), amount);", "highlightLines": [25]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwo.sol", "line": 25, "column": 5}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "3352c271f341", "fix": {"template": null, "available": false}, "title": "Token amount after transfer may differ - check actual received amount", "ruleId": "rules.sol-fee-on-transfer-token", "snippet": {"code": "    IERC20(from).transferFrom(msg.sender, address(this), amount);", "highlightLines": [25]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwo.sol", "line": 25, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "bd0a6f3da98e", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "    IERC20(from).transferFrom(msg.sender, address(this), amount);", "highlightLines": [25]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwo.sol", "line": 25, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "624ffe94ed32", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without SafeERC20 - some tokens dont return bool", "ruleId": "rules.sol-unsafe-erc20-transfer", "snippet": {"code": "    IERC20(from).transferFrom(msg.sender, address(this), amount);", "highlightLines": [25]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwo.sol", "line": 25, "column": 5}, "severity": "medium", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/token/ERC20/utils/SafeERC20.sol"], "description": ""}, {"id": "8fb19ba56f3c", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "    IERC20(to).approve(address(this), swapAmount);", "highlightLines": [26]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwo.sol", "line": 26, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "c93f9cc1485d", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without SafeERC20 - some tokens dont return bool", "ruleId": "rules.sol-unsafe-erc20-transfer", "snippet": {"code": "    IERC20(to).approve(address(this), swapAmount);", "highlightLines": [26]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwo.sol", "line": 26, "column": 5}, "severity": "medium", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/token/ERC20/utils/SafeERC20.sol"], "description": ""}, {"id": "9da7a56db1fb", "fix": {"template": null, "available": false}, "title": "Token transfer without checking actual received amount - deflationary tokens may transfer less", "ruleId": "rules.sol-deflationary-token-transfer", "snippet": {"code": "    IERC20(to).transferFrom(address(this), msg.sender, swapAmount);", "highlightLines": [27]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwo.sol", "line": 27, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "9872bd1a46ab", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "    IERC20(to).transferFrom(address(this), msg.sender, swapAmount);", "highlightLines": [27]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwo.sol", "line": 27, "column": 5}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "79a58764361d", "fix": {"template": null, "available": false}, "title": "Token amount after transfer may differ - check actual received amount", "ruleId": "rules.sol-fee-on-transfer-token", "snippet": {"code": "    IERC20(to).transferFrom(address(this), msg.sender, swapAmount);", "highlightLines": [27]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwo.sol", "line": 27, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "35b3e6546fcb", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "    IERC20(to).transferFrom(address(this), msg.sender, swapAmount);", "highlightLines": [27]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwo.sol", "line": 27, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "059af1b1ecb0", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without SafeERC20 - some tokens dont return bool", "ruleId": "rules.sol-unsafe-erc20-transfer", "snippet": {"code": "    IERC20(to).transferFrom(address(this), msg.sender, swapAmount);", "highlightLines": [27]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwo.sol", "line": 27, "column": 5}, "severity": "medium", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/token/ERC20/utils/SafeERC20.sol"], "description": ""}, {"id": "c1956e637542", "fix": {"template": null, "available": false}, "title": "View function reads state that may be stale during callback - read-only reentrancy risk", "ruleId": "rules.sol-read-only-reentrancy", "snippet": {"code": "  function getSwapAmount(address from, address to, uint amount) public view returns(uint){\n    return((amount * IERC20(to).balanceOf(address(this)))/IERC20(from).balanceOf(address(this)));", "highlightLines": [30]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwo.sol", "line": 30, "column": 3}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs", "https://chainsecurity.com/curve-lp-oracle-manipulation-post-mortem/"], "description": ""}, {"id": "74eb67837235", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "    return((amount * IERC20(to).balanceOf(address(this)))/IERC20(from).balanceOf(address(this)));", "highlightLines": [31]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwo.sol", "line": 31, "column": 13}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "00a62c0cdf8d", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "  function approve(address spender, uint amount) public {", "highlightLines": [34]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwo.sol", "line": 34, "column": 3}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "26a2d6f895da", "fix": {"template": null, "available": false}, "title": "View function reads state that may be stale during callback - read-only reentrancy risk", "ruleId": "rules.sol-read-only-reentrancy", "snippet": {"code": "  function balanceOf(address token, address account) public view returns (uint){\n    return IERC20(token).balanceOf(account);", "highlightLines": [39]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwo.sol", "line": 39, "column": 3}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs", "https://chainsecurity.com/curve-lp-oracle-manipulation-post-mortem/"], "description": ""}, {"id": "5169b701790f", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "    return IERC20(token).balanceOf(account);", "highlightLines": [40]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwo.sol", "line": 40, "column": 12}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "9a43eb004119", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract SwappableTokenTwo is ERC20 {\n  address private _dex;", "highlightLines": [44]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwo.sol", "line": 44, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "1092dffcab38", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  constructor(address dexInstance, string memory name, string memory symbol, uint initialSupply) ERC20(name, symbol) {\n        _mint(msg.sender, initialSupply);\n        _dex = dexInstance;\n  }", "highlightLines": [46]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwo.sol", "line": 46, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "aafe9e2c67ef", "fix": {"template": null, "available": false}, "title": "NFT mint without supply check - potential overflow in tokenId", "ruleId": "rules.sol-nft-overflow-mint", "snippet": {"code": "        _mint(msg.sender, initialSupply);", "highlightLines": [47]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwo.sol", "line": 47, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "9c4f649f82fb", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "  function approve(address owner, address spender, uint256 amount) public {", "highlightLines": [51]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwo.sol", "line": 51, "column": 3}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "ab7481956d3f", "fix": {"template": null, "available": false}, "title": "Using approve() without increaseAllowance/decreaseAllowance - vulnerable to front-running race condition", "ruleId": "rules.sol-erc20-approve-frontrun", "snippet": {"code": "  function approve(address owner, address spender, uint256 amount) public {\n    require(owner != _dex, \"InvalidApprover\");\n    super._approve(owner, spender, amount);\n  }", "highlightLines": [51]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwo.sol", "line": 51, "column": 3}, "severity": "info", "references": ["https://docs.google.com/document/d/1YLPtQxZu1UAvO9cZ1O2RPXBbT0mooh4DYKjA_jp-RLM"], "description": ""}, {"id": "3684ac0964ba", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwoFactory.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "be6e5760256f", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract DexTwoFactory is Level {\n\n  function createInstance(address _player) override public payable returns (address) {\n    DexTwo instance = new DexTwo();\n    address instanceAddress = address(instance);\n\n    SwappableTokenTwo tokenInstance = new SwappableTokenTwo(instanceAddress, \"Token 1\", \"TKN1\", 110);\n    SwappableTokenTwo tokenInstanceTwo = new SwappableTokenTwo(instanceAddress, \"Token 2\", \"TKN2\", 110);\n    \n    address tokenInstanceAddress = address(tokenInstance);\n    address tokenInstanceTwoAddress = address(tokenInstanceTwo);", "highlightLines": [10]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwoFactory.sol", "line": 10, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "d7d7ca6eb812", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    DexTwo instance = new DexTwo();\n    address instanceAddress = address(instance);", "highlightLines": [13]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwoFactory.sol", "line": 13, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "e95a2f738119", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    DexTwo instance = new DexTwo();", "highlightLines": [13]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwoFactory.sol", "line": 13, "column": 23}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "ba63e8af7e7a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address instanceAddress = address(instance);", "highlightLines": [14]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwoFactory.sol", "line": 14, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c13aa82574cc", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    address instanceAddress = address(instance);\n\n    SwappableTokenTwo tokenInstance = new SwappableTokenTwo(instanceAddress, \"Token 1\", \"TKN1\", 110);", "highlightLines": [14]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwoFactory.sol", "line": 14, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "947ba0abb85a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    SwappableTokenTwo tokenInstance = new SwappableTokenTwo(instanceAddress, \"Token 1\", \"TKN1\", 110);\n    SwappableTokenTwo tokenInstanceTwo = new SwappableTokenTwo(instanceAddress, \"Token 2\", \"TKN2\", 110);", "highlightLines": [16]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwoFactory.sol", "line": 16, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "637f2f8a51ee", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    SwappableTokenTwo tokenInstance = new SwappableTokenTwo(instanceAddress, \"Token 1\", \"TKN1\", 110);", "highlightLines": [16]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwoFactory.sol", "line": 16, "column": 39}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "378d30b05d04", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    SwappableTokenTwo tokenInstanceTwo = new SwappableTokenTwo(instanceAddress, \"Token 2\", \"TKN2\", 110);\n    \n    address tokenInstanceAddress = address(tokenInstance);", "highlightLines": [17]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwoFactory.sol", "line": 17, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "0a55d1f66318", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    SwappableTokenTwo tokenInstanceTwo = new SwappableTokenTwo(instanceAddress, \"Token 2\", \"TKN2\", 110);", "highlightLines": [17]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwoFactory.sol", "line": 17, "column": 42}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "8b451645d73d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    \n    address tokenInstanceAddress = address(tokenInstance);", "highlightLines": [18]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwoFactory.sol", "line": 18, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d6bf0fc590a6", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    address tokenInstanceAddress = address(tokenInstance);\n    address tokenInstanceTwoAddress = address(tokenInstanceTwo);", "highlightLines": [19]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwoFactory.sol", "line": 19, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "6b2a3476104f", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address tokenInstanceTwoAddress = address(tokenInstanceTwo);", "highlightLines": [20]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwoFactory.sol", "line": 20, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "bb43bc146483", "fix": {"template": null, "available": false}, "title": "ERC20 approve() return value not checked - some tokens return false instead of revert", "ruleId": "rules.sol-erc20-approve-no-return-check", "snippet": {"code": "    tokenInstance.approve(instanceAddress, 100);", "highlightLines": [24]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwoFactory.sol", "line": 24, "column": 5}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#no-revert-on-failure"], "description": ""}, {"id": "9e7909086fdd", "fix": {"template": null, "available": false}, "title": "ERC20 approve without setting to 0 first - frontrunning double-spend possible", "ruleId": "rules.sol-frontrunnable-approval", "snippet": {"code": "    tokenInstance.approve(instanceAddress, 100);", "highlightLines": [24]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwoFactory.sol", "line": 24, "column": 18}, "severity": "medium", "references": ["https://github.com/ethereum/EIPs/issues/20#issuecomment-263524729"], "description": ""}, {"id": "9d004f5072ac", "fix": {"template": null, "available": false}, "title": "ERC20 approve() return value not checked - some tokens return false instead of revert", "ruleId": "rules.sol-erc20-approve-no-return-check", "snippet": {"code": "    tokenInstanceTwo.approve(instanceAddress, 100);", "highlightLines": [25]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwoFactory.sol", "line": 25, "column": 5}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#no-revert-on-failure"], "description": ""}, {"id": "22cdcc77096c", "fix": {"template": null, "available": false}, "title": "ERC20 approve without setting to 0 first - frontrunning double-spend possible", "ruleId": "rules.sol-frontrunnable-approval", "snippet": {"code": "    tokenInstanceTwo.approve(instanceAddress, 100);", "highlightLines": [25]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwoFactory.sol", "line": 25, "column": 21}, "severity": "medium", "references": ["https://github.com/ethereum/EIPs/issues/20#issuecomment-263524729"], "description": ""}, {"id": "2b464555d048", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "    tokenInstance.transfer(_player, 10);", "highlightLines": [30]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwoFactory.sol", "line": 30, "column": 5}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "d3fd95469668", "fix": {"template": null, "available": false}, "title": "Missing zero address validation - tokens/ETH could be lost", "ruleId": "rules.sol-missing-zero-address-check", "snippet": {"code": "    tokenInstance.transfer(_player, 10);", "highlightLines": [30]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwoFactory.sol", "line": 30, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "ee11cd02f56e", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "    tokenInstance.transfer(_player, 10);", "highlightLines": [30]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwoFactory.sol", "line": 30, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "b6307a0c00f0", "fix": {"template": null, "available": false}, "title": "ERC20 transfer() return value not checked - tokens like USDT don't return bool", "ruleId": "rules.sol-erc20-transfer-no-return-check", "snippet": {"code": "    tokenInstance.transfer(_player, 10);", "highlightLines": [30]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwoFactory.sol", "line": 30, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "f69d60582f68", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "    tokenInstanceTwo.transfer(_player, 10);", "highlightLines": [31]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwoFactory.sol", "line": 31, "column": 5}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "c9ce8c5f7212", "fix": {"template": null, "available": false}, "title": "Missing zero address validation - tokens/ETH could be lost", "ruleId": "rules.sol-missing-zero-address-check", "snippet": {"code": "    tokenInstanceTwo.transfer(_player, 10);", "highlightLines": [31]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwoFactory.sol", "line": 31, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "8401295c3d90", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "    tokenInstanceTwo.transfer(_player, 10);", "highlightLines": [31]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwoFactory.sol", "line": 31, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "4a6efb6be3a0", "fix": {"template": null, "available": false}, "title": "ERC20 transfer() return value not checked - tokens like USDT don't return bool", "ruleId": "rules.sol-erc20-transfer-no-return-check", "snippet": {"code": "    tokenInstanceTwo.transfer(_player, 10);", "highlightLines": [31]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwoFactory.sol", "line": 31, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "a18eb7a109cf", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "  function validateInstance(address payable _instance, address) override public view returns (bool) {\n    address token1 = DexTwo(_instance).token1();\n    address token2 = DexTwo(_instance).token2();", "highlightLines": [36]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwoFactory.sol", "line": 36, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "83121aa4052c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address token1 = DexTwo(_instance).token1();", "highlightLines": [37]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwoFactory.sol", "line": 37, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "02f662d3de7f", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "    address token1 = DexTwo(_instance).token1();\n    address token2 = DexTwo(_instance).token2();", "highlightLines": [37]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwoFactory.sol", "line": 37, "column": 5}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "d73c09ecc56f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    address token1 = DexTwo(_instance).token1();\n    address token2 = DexTwo(_instance).token2();", "highlightLines": [37]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwoFactory.sol", "line": 37, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "1e6f3b9fc6ff", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address token2 = DexTwo(_instance).token2();", "highlightLines": [38]}, "category": "code", "location": {"file": "contracts/contracts/levels/DexTwoFactory.sol", "line": 38, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ba75a3677da1", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPoint.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "1f005490b8a0", "fix": {"template": null, "available": false}, "title": "delegateTransfer function enables proxy attacks - callers may unknowingly trigger different token transfers", "ruleId": "rules.sol-delegate-transfer-function", "snippet": {"code": "  function delegateTransfer(address to, uint256 value, address origSender) external returns (bool);", "highlightLines": [8]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPoint.sol", "line": 8, "column": 3}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/level/26"], "description": ""}, {"id": "fe724a15c11a", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function delegateTransfer(address to, uint256 value, address origSender) external returns (bool);", "highlightLines": [8]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPoint.sol", "line": 8, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "d1bebb7cb6e0", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function handleTransaction(address user, bytes calldata msgData) external;", "highlightLines": [12]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPoint.sol", "line": 12, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "e82ac61b0563", "fix": {"template": null, "available": false}, "title": "Forta detection bot pattern - monitors for suspicious transactions (DoubleEntryPoint defense)", "ruleId": "rules.sol-forta-detection-bot", "snippet": {"code": "    function handleTransaction(address user, bytes calldata msgData) external;\n}\n\ninterface IForta {\n    function setDetectionBot(address detectionBotAddress) external;\n    function notify(address user, bytes calldata msgData) external;\n    function raiseAlert(address user) external;", "highlightLines": [12]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPoint.sol", "line": 12, "column": 5}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/26"], "description": ""}, {"id": "acd09876f1ec", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function setDetectionBot(address detectionBotAddress) external;", "highlightLines": [16]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPoint.sol", "line": 16, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "be389d3ce2f7", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function setDetectionBot(address detectionBotAddress) external;\n    function notify(address user, bytes calldata msgData) external;\n    function raiseAlert(address user) external;\n}\n\ncontract Forta is IForta {\n  mapping(address => IDetectionBot) public usersDetectionBots;\n  mapping(address => uint256) public botRaisedAlerts;", "highlightLines": [16]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPoint.sol", "line": 16, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "5df71f5e3f28", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function notify(address user, bytes calldata msgData) external;", "highlightLines": [17]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPoint.sol", "line": 17, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "8e1fa6afe53f", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function raiseAlert(address user) external;", "highlightLines": [18]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPoint.sol", "line": 18, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "b5c8d53eac11", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "contract Forta is IForta {", "highlightLines": [21]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPoint.sol", "line": 21, "column": 1}, "severity": "medium", "references": [], "description": ""}, {"id": "8b6980ec7091", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        return;", "highlightLines": [32]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPoint.sol", "line": 32, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "8bb13c02db20", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(address recipient) {\n        sweptTokensRecipient = recipient;\n    }", "highlightLines": [46]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPoint.sol", "line": 46, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "dbeb12cbf0df", "fix": {"template": null, "available": false}, "title": "Sweep function doesn't check for token delegation - tokens may delegate to protected underlying (DoubleEntryPoint pattern)", "ruleId": "rules.sol-sweep-token-no-delegation-check", "snippet": {"code": "    function sweepToken(IERC20 token) public {\n        require(token != underlying, \"Can't transfer underlying token\");\n        token.transfer(sweptTokensRecipient, token.balanceOf(address(this)));", "highlightLines": [59]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPoint.sol", "line": 59, "column": 5}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/level/26"], "description": ""}, {"id": "eb8489e9b612", "fix": {"template": null, "available": false}, "title": "Token identity check may be bypassed via delegation - compare actual underlying, not wrapper address", "ruleId": "rules.sol-token-identity-check-bypass", "snippet": {"code": "        require(token != underlying, \"Can't transfer underlying token\");", "highlightLines": [60]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPoint.sol", "line": 60, "column": 9}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/26"], "description": ""}, {"id": "b201f55f2d79", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        token.transfer(sweptTokensRecipient, token.balanceOf(address(this)));", "highlightLines": [61]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPoint.sol", "line": 61, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "161ea43e77c6", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "        token.transfer(sweptTokensRecipient, token.balanceOf(address(this)));", "highlightLines": [61]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPoint.sol", "line": 61, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "9fdf7d5e54c7", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function mint(address to, uint256 amount) public onlyOwner {", "highlightLines": [68]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPoint.sol", "line": 68, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "f6be09314347", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function mint(address to, uint256 amount) public onlyOwner {", "highlightLines": [68]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPoint.sol", "line": 68, "column": 54}, "severity": "info", "references": [], "description": ""}, {"id": "a2b3d55c5601", "fix": {"template": null, "available": false}, "title": "Owner has excessive privileges - single account controls critical functions without checks", "ruleId": "rules.sol-owner-privilege-escalation", "snippet": {"code": "    function mint(address to, uint256 amount) public onlyOwner {\n        _mint(to, amount);", "highlightLines": [68]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPoint.sol", "line": 68, "column": 54}, "severity": "medium", "references": [], "description": ""}, {"id": "b81c782d3612", "fix": {"template": null, "available": false}, "title": "NFT mint without supply check - potential overflow in tokenId", "ruleId": "rules.sol-nft-overflow-mint", "snippet": {"code": "        _mint(to, amount);", "highlightLines": [69]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPoint.sol", "line": 69, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "6171009d1c70", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function delegateToNewContract(DelegateERC20 newContract) public onlyOwner {", "highlightLines": [72]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPoint.sol", "line": 72, "column": 70}, "severity": "info", "references": [], "description": ""}, {"id": "31bcc748f223", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function transfer(address to, uint256 value) public override returns (bool) {", "highlightLines": [76]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPoint.sol", "line": 76, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "037784b4dd17", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without msg.data.length validation - vulnerable to short address attack padding", "ruleId": "rules.sol-short-address-no-payload-check", "snippet": {"code": "    function transfer(address to, uint256 value) public override returns (bool) {", "highlightLines": [76]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPoint.sol", "line": 76, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address", "https://vessenes.com/the-erc20-short-address-attack-explained/"], "description": ""}, {"id": "21ba7139acd3", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "        if (address(delegate) == address(0)) {\n            return super.transfer(to, value);\n        } else {\n            return delegate.delegateTransfer(to, value, msg.sender);\n        }", "highlightLines": [77]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPoint.sol", "line": 77, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "298443bde346", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "            return super.transfer(to, value);", "highlightLines": [78]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPoint.sol", "line": 78, "column": 20}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "a5efecb21628", "fix": {"template": null, "available": false}, "title": "Missing zero address validation - tokens/ETH could be lost", "ruleId": "rules.sol-missing-zero-address-check", "snippet": {"code": "            return super.transfer(to, value);", "highlightLines": [78]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPoint.sol", "line": 78, "column": 20}, "severity": "info", "references": [], "description": ""}, {"id": "3aeb9f9116ed", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "            return super.transfer(to, value);", "highlightLines": [78]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPoint.sol", "line": 78, "column": 20}, "severity": "medium", "references": [], "description": ""}, {"id": "686fbff767b4", "fix": {"template": null, "available": false}, "title": "ERC20 transfer() return value not checked - tokens like USDT don't return bool", "ruleId": "rules.sol-erc20-transfer-no-return-check", "snippet": {"code": "            return super.transfer(to, value);", "highlightLines": [78]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPoint.sol", "line": 78, "column": 20}, "severity": "medium", "references": [], "description": ""}, {"id": "ff9fef7fda81", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract DoubleEntryPoint is ERC20(\"DoubleEntryPointToken\", \"DET\"), DelegateERC20, Ownable {\n    address public cryptoVault;\n    address public player;\n    address public delegatedFrom;", "highlightLines": [85]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPoint.sol", "line": 85, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "39bc22755de6", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(address legacyToken, address vaultAddress, address fortaAddress, address playerAddress) {\n        delegatedFrom = legacyToken;\n        forta = Forta(fortaAddress);\n        player = playerAddress;\n        cryptoVault = vaultAddress;\n        _mint(cryptoVault, 100 ether);\n    }", "highlightLines": [91]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPoint.sol", "line": 91, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "27fa12b118d3", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        delegatedFrom = legacyToken;\n        forta = Forta(fortaAddress);", "highlightLines": [92]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPoint.sol", "line": 92, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "a1a45c70ae10", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        forta = Forta(fortaAddress);\n        player = playerAddress;", "highlightLines": [93]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPoint.sol", "line": 93, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e696f06262cf", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        player = playerAddress;\n        cryptoVault = vaultAddress;", "highlightLines": [94]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPoint.sol", "line": 94, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "1eb4b3fe505c", "fix": {"template": null, "available": false}, "title": "NFT mint without supply check - potential overflow in tokenId", "ruleId": "rules.sol-nft-overflow-mint", "snippet": {"code": "        _mint(cryptoVault, 100 ether);", "highlightLines": [96]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPoint.sol", "line": 96, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "2f7e4f60b68c", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyDelegateFrom() {\n        require(msg.sender == delegatedFrom, \"Not legacy contract\");\n        _;\n    }", "highlightLines": [99]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPoint.sol", "line": 99, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "5061c8f8161a", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [101]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPoint.sol", "line": 101, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "65f687499946", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier fortaNotify() {\n        address detectionBot = address(forta.usersDetectionBots(player));\n\n        // Cache old number of bot alerts\n        uint256 previousValue = forta.botRaisedAlerts(detectionBot);\n\n        // Notify Forta\n        forta.notify(player, msg.data);\n\n        // Continue execution\n        _;\n\n        // Check if alarms have been raised\n        if(forta.botRaisedAlerts(detectionBot) > previousValue) revert(\"Alert has been triggered, reverting\");\n    }", "highlightLines": [104]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPoint.sol", "line": 104, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "a045aef004b6", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "    modifier fortaNotify() {\n        address detectionBot = address(forta.usersDetectionBots(player));\n\n        // Cache old number of bot alerts\n        uint256 previousValue = forta.botRaisedAlerts(detectionBot);\n\n        // Notify Forta\n        forta.notify(player, msg.data);\n\n        // Continue execution\n        _;\n\n        // Check if alarms have been raised\n        if(forta.botRaisedAlerts(detectionBot) > previousValue) revert(\"Alert has been triggered, reverting\");\n    }", "highlightLines": [104]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPoint.sol", "line": 104, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "d70b67f3b1c9", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address detectionBot = address(forta.usersDetectionBots(player));", "highlightLines": [105]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPoint.sol", "line": 105, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "eaa9c992cb33", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "        address detectionBot = address(forta.usersDetectionBots(player));\n\n        // Cache old number of bot alerts\n        uint256 previousValue = forta.botRaisedAlerts(detectionBot);", "highlightLines": [105]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPoint.sol", "line": 105, "column": 9}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "418a50863abd", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address detectionBot = address(forta.usersDetectionBots(player));\n\n        // Cache old number of bot alerts\n        uint256 previousValue = forta.botRaisedAlerts(detectionBot);", "highlightLines": [105]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPoint.sol", "line": 105, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "8c1f5abd86e9", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 previousValue = forta.botRaisedAlerts(detectionBot);", "highlightLines": [108]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPoint.sol", "line": 108, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7e2438fea5f5", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [114]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPoint.sol", "line": 114, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "982c0a95def4", "fix": {"template": null, "available": false}, "title": "delegateTransfer function enables proxy attacks - callers may unknowingly trigger different token transfers", "ruleId": "rules.sol-delegate-transfer-function", "snippet": {"code": "    function delegateTransfer(\n        address to,\n        uint256 value,\n        address origSender\n    ) public override onlyDelegateFrom fortaNotify returns (bool) {", "highlightLines": [120]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPoint.sol", "line": 120, "column": 5}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/level/26"], "description": ""}, {"id": "546ccc6f6df0", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPointFactory.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "73ba0cc1e45b", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract DoubleEntryPointFactory is Level {\n\n  function createInstance(address _player) override public payable returns (address) {\n    // Create legacy token\n    LegacyToken oldToken = new LegacyToken();\n    // Create a new Forta contract\n    Forta forta = new Forta();\n    // Create a new CryptoVault\n    CryptoVault vault = new CryptoVault(_player);\n    // Create latest token\n    DoubleEntryPoint newToken = new DoubleEntryPoint(address(oldToken), address(vault), address(forta), _player);", "highlightLines": [8]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPointFactory.sol", "line": 8, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "97bf0440532f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    LegacyToken oldToken = new LegacyToken();\n    // Create a new Forta contract\n    Forta forta = new Forta();", "highlightLines": [12]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPointFactory.sol", "line": 12, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "7345491c796d", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    LegacyToken oldToken = new LegacyToken();", "highlightLines": [12]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPointFactory.sol", "line": 12, "column": 28}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "2f6e57204775", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    Forta forta = new Forta();\n    // Create a new CryptoVault\n    CryptoVault vault = new CryptoVault(_player);", "highlightLines": [14]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPointFactory.sol", "line": 14, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "860f654d6079", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    Forta forta = new Forta();", "highlightLines": [14]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPointFactory.sol", "line": 14, "column": 19}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "346a8c830270", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    CryptoVault vault = new CryptoVault(_player);\n    // Create latest token\n    DoubleEntryPoint newToken = new DoubleEntryPoint(address(oldToken), address(vault), address(forta), _player);", "highlightLines": [16]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPointFactory.sol", "line": 16, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "9ee723e9b798", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    CryptoVault vault = new CryptoVault(_player);", "highlightLines": [16]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPointFactory.sol", "line": 16, "column": 25}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "2de703a03fa4", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    DoubleEntryPoint newToken = new DoubleEntryPoint(address(oldToken), address(vault), address(forta), _player);", "highlightLines": [18]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPointFactory.sol", "line": 18, "column": 33}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "be0d1b97e427", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "  function validateInstance(address payable _instance, address _player) override public returns (bool) {\n    DoubleEntryPoint instance = DoubleEntryPoint(_instance);\n    Forta forta = instance.forta();\n\n    // If user didn't set an DetectionBot, level failed.\n    address usersDetectionBot = address(forta.usersDetectionBots(_player));\n    if(usersDetectionBot == address(0)) return false;\n\n    address vault = instance.cryptoVault();\n    CryptoVault cryptoVault = CryptoVault(vault);\n    \n    (bool ok, bytes memory data) = this.__trySweep(cryptoVault, instance);\n    \n    require(!ok, \"Sweep succeded\");", "highlightLines": [31]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPointFactory.sol", "line": 31, "column": 3}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "3b94dcc660f9", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    DoubleEntryPoint instance = DoubleEntryPoint(_instance);\n    Forta forta = instance.forta();", "highlightLines": [32]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPointFactory.sol", "line": 32, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "cbf237b95dcf", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    Forta forta = instance.forta();\n\n    // If user didn't set an DetectionBot, level failed.\n    address usersDetectionBot = address(forta.usersDetectionBots(_player));", "highlightLines": [33]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPointFactory.sol", "line": 33, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "36c8b6ebc603", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "    Forta forta = instance.forta();\n\n    // If user didn't set an DetectionBot, level failed.\n    address usersDetectionBot = address(forta.usersDetectionBots(_player));\n    if(usersDetectionBot == address(0)) return false;\n\n    address vault = instance.cryptoVault();", "highlightLines": [33]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPointFactory.sol", "line": 33, "column": 5}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "8b91eeacf9d4", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address usersDetectionBot = address(forta.usersDetectionBots(_player));", "highlightLines": [36]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPointFactory.sol", "line": 36, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c53238c809a1", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    address usersDetectionBot = address(forta.usersDetectionBots(_player));\n    if(usersDetectionBot == address(0)) return false;\n\n    address vault = instance.cryptoVault();", "highlightLines": [36]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPointFactory.sol", "line": 36, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "35e360b27d39", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "    if(usersDetectionBot == address(0)) return false;\n\n    address vault = instance.cryptoVault();", "highlightLines": [37]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPointFactory.sol", "line": 37, "column": 41}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "a594ad46bc5b", "fix": {"template": null, "available": false}, "title": "Function mixes 'return false' with require() - inconsistent error handling pattern", "ruleId": "rules.sol-mixed-return-false-require", "snippet": {"code": "    if(usersDetectionBot == address(0)) return false;\n\n    address vault = instance.cryptoVault();\n    CryptoVault cryptoVault = CryptoVault(vault);\n    \n    (bool ok, bytes memory data) = this.__trySweep(cryptoVault, instance);\n    \n    require(!ok, \"Sweep succeded\");", "highlightLines": [37]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPointFactory.sol", "line": 37, "column": 41}, "severity": "medium", "references": [], "description": ""}, {"id": "1fed827e4778", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    address vault = instance.cryptoVault();", "highlightLines": [38]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPointFactory.sol", "line": 38, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0de8c111d974", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    address vault = instance.cryptoVault();\n    CryptoVault cryptoVault = CryptoVault(vault);", "highlightLines": [39]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPointFactory.sol", "line": 39, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "23bf3ff63c20", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    CryptoVault cryptoVault = CryptoVault(vault);\n    \n    (bool ok, bytes memory data) = this.__trySweep(cryptoVault, instance);", "highlightLines": [40]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPointFactory.sol", "line": 40, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "a92961e8b961", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    (bool ok, bytes memory data) = this.__trySweep(cryptoVault, instance);\n    \n    require(!ok, \"Sweep succeded\");\n\n    bool swept = abi.decode(data, (bool));", "highlightLines": [42]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPointFactory.sol", "line": 42, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "7975beaa00fb", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    bool swept = abi.decode(data, (bool));", "highlightLines": [45]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPointFactory.sol", "line": 45, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "721cc812f8b4", "fix": {"template": null, "available": false}, "title": "External call in try-catch without reentrancy guard - state can be corrupted", "ruleId": "rules.sol-reentrancy-try-catch", "snippet": {"code": "    try cryptoVault.sweepToken(IERC20(instance.delegatedFrom())) {\n      return(true, abi.encode(false));\n    } catch {", "highlightLines": [51]}, "category": "code", "location": {"file": "contracts/contracts/levels/DoubleEntryPointFactory.sol", "line": 51, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "2e4ead863ef7", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "contracts/contracts/levels/Dummy.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "bc1071e682a1", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "contracts/contracts/levels/DummyFactory.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "172165fe354c", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    _player;", "highlightLines": [10]}, "category": "code", "location": {"file": "contracts/contracts/levels/DummyFactory.sol", "line": 10, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "ef0ee81f4559", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    return address(new Dummy());", "highlightLines": [11]}, "category": "code", "location": {"file": "contracts/contracts/levels/DummyFactory.sol", "line": 11, "column": 20}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "28143582428c", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "  function validateInstance(address payable _instance, address _player) override public view returns (bool) {\n    _player;\n    Dummy instance = Dummy(_instance);", "highlightLines": [14]}, "category": "code", "location": {"file": "contracts/contracts/levels/DummyFactory.sol", "line": 14, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "ed97da0c0db4", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    _player;", "highlightLines": [15]}, "category": "code", "location": {"file": "contracts/contracts/levels/DummyFactory.sol", "line": 15, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "a2c2875a90f3", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "contracts/contracts/levels/Elevator.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "15ba804d62b0", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    Building building = Building(msg.sender);\n\n    if (! building.isLastFloor(_floor)) {\n      floor = _floor;\n      top = building.isLastFloor(floor);\n    }", "highlightLines": [14]}, "category": "code", "location": {"file": "contracts/contracts/levels/Elevator.sol", "line": 14, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "63d60bd0bd52", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "      floor = _floor;\n      top = building.isLastFloor(floor);", "highlightLines": [17]}, "category": "code", "location": {"file": "contracts/contracts/levels/Elevator.sol", "line": 17, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "4f51e287ad45", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "contracts/contracts/levels/ElevatorFactory.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "7725d1bd38c4", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    _player;", "highlightLines": [11]}, "category": "code", "location": {"file": "contracts/contracts/levels/ElevatorFactory.sol", "line": 11, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "05c87ac298b0", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    Elevator instance = new Elevator();", "highlightLines": [12]}, "category": "code", "location": {"file": "contracts/contracts/levels/ElevatorFactory.sol", "line": 12, "column": 25}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "0b4219553314", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "  function validateInstance(address payable _instance, address) override public view returns (bool) {\n    Elevator elevator = Elevator(_instance);", "highlightLines": [16]}, "category": "code", "location": {"file": "contracts/contracts/levels/ElevatorFactory.sol", "line": 16, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "9c2f5a356076", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "contracts/contracts/levels/Fallback.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "9ae77ac98851", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  constructor() {\n    owner = msg.sender;\n    contributions[msg.sender] = 1000 * (1 ether);\n  }", "highlightLines": [9]}, "category": "code", "location": {"file": "contracts/contracts/levels/Fallback.sol", "line": 9, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "efcbdfefb1ab", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "    owner = msg.sender;", "highlightLines": [10]}, "category": "code", "location": {"file": "contracts/contracts/levels/Fallback.sol", "line": 10, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "79337d2cc331", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    owner = msg.sender;\n    contributions[msg.sender] = 1000 * (1 ether);", "highlightLines": [10]}, "category": "code", "location": {"file": "contracts/contracts/levels/Fallback.sol", "line": 10, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "2d10585b4d5a", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  modifier onlyOwner {\n        require(\n            msg.sender == owner,\n            \"caller is not the owner\"\n        );\n        _;\n    }", "highlightLines": [14]}, "category": "code", "location": {"file": "contracts/contracts/levels/Fallback.sol", "line": 14, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "a42e5f5ef3c3", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "        require(\n            msg.sender == owner,\n            \"caller is not the owner\"\n        );", "highlightLines": [15]}, "category": "code", "location": {"file": "contracts/contracts/levels/Fallback.sol", "line": 15, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "89b8953d8cfc", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [19]}, "category": "code", "location": {"file": "contracts/contracts/levels/Fallback.sol", "line": 19, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "63a5f740fd0c", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(msg.value < 0.001 ether);", "highlightLines": [23]}, "category": "code", "location": {"file": "contracts/contracts/levels/Fallback.sol", "line": 23, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "c174fafc4156", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "      owner = msg.sender;", "highlightLines": [26]}, "category": "code", "location": {"file": "contracts/contracts/levels/Fallback.sol", "line": 26, "column": 7}, "severity": "info", "references": [], "description": ""}, {"id": "481186e0740c", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "  function withdraw() public onlyOwner {", "highlightLines": [34]}, "category": "code", "location": {"file": "contracts/contracts/levels/Fallback.sol", "line": 34, "column": 3}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "452ba137a0cc", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "  function withdraw() public onlyOwner {", "highlightLines": [34]}, "category": "code", "location": {"file": "contracts/contracts/levels/Fallback.sol", "line": 34, "column": 30}, "severity": "info", "references": [], "description": ""}, {"id": "74ffa9239571", "fix": {"template": null, "available": false}, "title": "payable.transfer() has 2300 gas limit - fails for contracts with receive logic", "ruleId": "rules.sol-payable-transfer-gas-limit", "snippet": {"code": "    payable(owner).transfer(address(this).balance);", "highlightLines": [35]}, "category": "code", "location": {"file": "contracts/contracts/levels/Fallback.sol", "line": 35, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/payable-transfer.sol"], "description": ""}, {"id": "cf4d3b6db663", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "    payable(owner).transfer(address(this).balance);", "highlightLines": [35]}, "category": "code", "location": {"file": "contracts/contracts/levels/Fallback.sol", "line": 35, "column": 5}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "8127f4b95b2d", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "    payable(owner).transfer(address(this).balance);", "highlightLines": [35]}, "category": "code", "location": {"file": "contracts/contracts/levels/Fallback.sol", "line": 35, "column": 19}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "390c2b1134fd", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "  receive() external payable {", "highlightLines": [38]}, "category": "code", "location": {"file": "contracts/contracts/levels/Fallback.sol", "line": 38, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "3753264a2ecc", "fix": {"template": null, "available": false}, "title": "Fallback/receive with require can cause DoS - callers cannot send ETH if condition fails (King pattern)", "ruleId": "rules.sol-reverting-fallback-dos", "snippet": {"code": "  receive() external payable {\n    require(msg.value > 0 && contributions[msg.sender] > 0);", "highlightLines": [38]}, "category": "code", "location": {"file": "contracts/contracts/levels/Fallback.sol", "line": 38, "column": 3}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/9"], "description": ""}, {"id": "a201df1928cc", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(msg.value > 0 && contributions[msg.sender] > 0);", "highlightLines": [39]}, "category": "code", "location": {"file": "contracts/contracts/levels/Fallback.sol", "line": 39, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "2867d5ba924f", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "    owner = msg.sender;", "highlightLines": [40]}, "category": "code", "location": {"file": "contracts/contracts/levels/Fallback.sol", "line": 40, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "d0a9d7c1ae3e", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "contracts/contracts/levels/FallbackFactory.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "e256dee0121b", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    _player;", "highlightLines": [11]}, "category": "code", "location": {"file": "contracts/contracts/levels/FallbackFactory.sol", "line": 11, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "b6ed64a53f6e", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    Fallback instance = new Fallback();", "highlightLines": [12]}, "category": "code", "location": {"file": "contracts/contracts/levels/FallbackFactory.sol", "line": 12, "column": 25}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "d9812ae2e168", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "  function validateInstance(address payable _instance, address _player) override public view returns (bool) {\n    Fallback instance = Fallback(_instance);", "highlightLines": [16]}, "category": "code", "location": {"file": "contracts/contracts/levels/FallbackFactory.sol", "line": 16, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "0168d0ca4441", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.6.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "contracts/contracts/levels/Fallout.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "5c7d86a035e2", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "    owner = msg.sender;", "highlightLines": [15]}, "category": "code", "location": {"file": "contracts/contracts/levels/Fallout.sol", "line": 15, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "4b1882322dec", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    owner = msg.sender;\n    allocations[owner] = msg.value;", "highlightLines": [15]}, "category": "code", "location": {"file": "contracts/contracts/levels/Fallout.sol", "line": 15, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "efc14b64402f", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  modifier onlyOwner {\n\t        require(\n\t            msg.sender == owner,\n\t            \"caller is not the owner\"\n\t        );\n\t        _;\n\t    }", "highlightLines": [19]}, "category": "code", "location": {"file": "contracts/contracts/levels/Fallout.sol", "line": 19, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "7b57ec03b574", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "\t        require(\n\t            msg.sender == owner,\n\t            \"caller is not the owner\"\n\t        );", "highlightLines": [20]}, "category": "code", "location": {"file": "contracts/contracts/levels/Fallout.sol", "line": 20, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "0c8f772d2d27", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "\t        _;", "highlightLines": [24]}, "category": "code", "location": {"file": "contracts/contracts/levels/Fallout.sol", "line": 24, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "b3c042dd13f0", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(allocations[allocator] > 0);", "highlightLines": [32]}, "category": "code", "location": {"file": "contracts/contracts/levels/Fallout.sol", "line": 32, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "325d9a20fd71", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "    allocator.transfer(allocations[allocator]);", "highlightLines": [33]}, "category": "code", "location": {"file": "contracts/contracts/levels/Fallout.sol", "line": 33, "column": 5}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "f5cf6facb089", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "  function collectAllocations() public onlyOwner {", "highlightLines": [36]}, "category": "code", "location": {"file": "contracts/contracts/levels/Fallout.sol", "line": 36, "column": 40}, "severity": "info", "references": [], "description": ""}, {"id": "d42bc2444ca8", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "    msg.sender.transfer(address(this).balance);", "highlightLines": [37]}, "category": "code", "location": {"file": "contracts/contracts/levels/Fallout.sol", "line": 37, "column": 5}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "9002d127c95d", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "    msg.sender.transfer(address(this).balance);", "highlightLines": [37]}, "category": "code", "location": {"file": "contracts/contracts/levels/Fallout.sol", "line": 37, "column": 15}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "e32f5db72f0f", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.6.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "contracts/contracts/levels/FalloutFactory.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "7b4036acff49", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    _player;", "highlightLines": [11]}, "category": "code", "location": {"file": "contracts/contracts/levels/FalloutFactory.sol", "line": 11, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "fbad7fcbf463", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    Fallout instance = new Fallout();", "highlightLines": [12]}, "category": "code", "location": {"file": "contracts/contracts/levels/FalloutFactory.sol", "line": 12, "column": 24}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "c6d9608a7018", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "contracts/contracts/levels/Force.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "107479def16f", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "contracts/contracts/levels/ForceFactory.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "0fe82f876fe1", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    _player;", "highlightLines": [11]}, "category": "code", "location": {"file": "contracts/contracts/levels/ForceFactory.sol", "line": 11, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "f003fc946547", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    return address(new Force());", "highlightLines": [12]}, "category": "code", "location": {"file": "contracts/contracts/levels/ForceFactory.sol", "line": 12, "column": 20}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "8cb17d679a68", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "  function validateInstance(address payable _instance, address _player) override public view returns (bool) {\n    _player;\n    Force instance = Force(_instance);", "highlightLines": [15]}, "category": "code", "location": {"file": "contracts/contracts/levels/ForceFactory.sol", "line": 15, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "00a79e09979a", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    _player;", "highlightLines": [16]}, "category": "code", "location": {"file": "contracts/contracts/levels/ForceFactory.sol", "line": 16, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "301ca51fc698", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperOne.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "823d4e76b5f3", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  modifier gateOne() {\n    require(msg.sender != tx.origin);\n    _;\n  }", "highlightLines": [8]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperOne.sol", "line": 8, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "3a60d6de9f7d", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(msg.sender != tx.origin);", "highlightLines": [9]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperOne.sol", "line": 9, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "4d2f235524b1", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    _;", "highlightLines": [10]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperOne.sol", "line": 10, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "e31c39b97413", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  modifier gateTwo() {\n    require(gasleft() % 8191 == 0);\n    _;\n  }", "highlightLines": [13]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperOne.sol", "line": 13, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "ac6e4617f4b7", "fix": {"template": null, "available": false}, "title": "gasleft() used for access control - can be manipulated by attacker (GatekeeperOne pattern)", "ruleId": "rules.sol-gasleft-manipulation", "snippet": {"code": "    require(gasleft() % 8191 == 0);", "highlightLines": [14]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperOne.sol", "line": 14, "column": 5}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/13"], "description": ""}, {"id": "ec151737ab0d", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(gasleft() % 8191 == 0);", "highlightLines": [14]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperOne.sol", "line": 14, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "bd6a1e219746", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    _;", "highlightLines": [15]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperOne.sol", "line": 15, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "5dd098714050", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  modifier gateThree(bytes8 _gateKey) {\n      require(uint32(uint64(_gateKey)) == uint16(uint64(_gateKey)), \"GatekeeperOne: invalid gateThree part one\");\n      require(uint32(uint64(_gateKey)) != uint64(_gateKey), \"GatekeeperOne: invalid gateThree part two\");\n      require(uint32(uint64(_gateKey)) == uint16(uint160(tx.origin)), \"GatekeeperOne: invalid gateThree part three\");\n    _;\n  }", "highlightLines": [18]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperOne.sol", "line": 18, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "246259abbf0e", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "  modifier gateThree(bytes8 _gateKey) {\n      require(uint32(uint64(_gateKey)) == uint16(uint64(_gateKey)), \"GatekeeperOne: invalid gateThree part one\");\n      require(uint32(uint64(_gateKey)) != uint64(_gateKey), \"GatekeeperOne: invalid gateThree part two\");\n      require(uint32(uint64(_gateKey)) == uint16(uint160(tx.origin)), \"GatekeeperOne: invalid gateThree part three\");\n    _;\n  }", "highlightLines": [18]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperOne.sol", "line": 18, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "e66302ec1022", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "      require(uint32(uint64(_gateKey)) == uint16(uint64(_gateKey)), \"GatekeeperOne: invalid gateThree part one\");", "highlightLines": [19]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperOne.sol", "line": 19, "column": 15}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "9b9dc51e3991", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "      require(uint32(uint64(_gateKey)) != uint64(_gateKey), \"GatekeeperOne: invalid gateThree part two\");", "highlightLines": [20]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperOne.sol", "line": 20, "column": 15}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "2f9b42fb5a4d", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "      require(uint32(uint64(_gateKey)) == uint16(uint160(tx.origin)), \"GatekeeperOne: invalid gateThree part three\");", "highlightLines": [21]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperOne.sol", "line": 21, "column": 15}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "3a283b907963", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    _;", "highlightLines": [22]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperOne.sol", "line": 22, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "6d780e72b8be", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperOneFactory.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "8f0ce0721355", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    _player;", "highlightLines": [11]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperOneFactory.sol", "line": 11, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "112d4fea9d6b", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    GatekeeperOne instance = new GatekeeperOne();", "highlightLines": [12]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperOneFactory.sol", "line": 12, "column": 30}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "519f16689d79", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "  function validateInstance(address payable _instance, address _player) override public view returns (bool) {\n    GatekeeperOne instance = GatekeeperOne(_instance);", "highlightLines": [16]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperOneFactory.sol", "line": 16, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "61d4ea87ea27", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperThree.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "3b64be3d450a", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "  uint private password = block.timestamp;", "highlightLines": [7]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperThree.sol", "line": 7, "column": 27}, "severity": "medium", "references": [], "description": ""}, {"id": "4cb23dfa3ed1", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  constructor (address payable _target) {\n    target = GatekeeperThree(_target);\n  }", "highlightLines": [9]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperThree.sol", "line": 9, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "5de2ce25a6d0", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "  function checkPassword(uint _password) public returns (bool) {\n    if (_password == password) {", "highlightLines": [13]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperThree.sol", "line": 13, "column": 3}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "d373a5e2cdee", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "    password = block.timestamp;", "highlightLines": [17]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperThree.sol", "line": 17, "column": 16}, "severity": "medium", "references": [], "description": ""}, {"id": "0303fcfe0045", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "      owner = msg.sender;", "highlightLines": [40]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperThree.sol", "line": 40, "column": 7}, "severity": "info", "references": [], "description": ""}, {"id": "b2af41fc39a6", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  modifier gateOne() {\n    require(msg.sender == owner);\n    require(tx.origin != owner);\n    _;\n  }", "highlightLines": [43]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperThree.sol", "line": 43, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "6a6b42090301", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    require(msg.sender == owner);", "highlightLines": [44]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperThree.sol", "line": 44, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "a900567be514", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(msg.sender == owner);", "highlightLines": [44]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperThree.sol", "line": 44, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "89fc23748f4d", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(tx.origin != owner);", "highlightLines": [45]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperThree.sol", "line": 45, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "0a6c6790a813", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    _;", "highlightLines": [46]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperThree.sol", "line": 46, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "07be70d071a5", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  modifier gateTwo() {\n    require(allowEntrance == true);\n    _;\n  }", "highlightLines": [49]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperThree.sol", "line": 49, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "c82580d68f6d", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(allowEntrance == true);", "highlightLines": [50]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperThree.sol", "line": 50, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "ef61167cbb53", "fix": {"template": null, "available": false}, "title": "Unnecessary comparison to boolean constant - use variable directly", "ruleId": "rules.sol-boolean-constant-comparison", "snippet": {"code": "    require(allowEntrance == true);", "highlightLines": [50]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperThree.sol", "line": 50, "column": 27}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#boolean-equality"], "description": ""}, {"id": "2d21f78405f9", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    _;", "highlightLines": [51]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperThree.sol", "line": 51, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "fe60005dca50", "fix": {"template": null, "available": false}, "title": "Modifier makes external call - can introduce reentrancy or unexpected state changes", "ruleId": "rules.sol-modifier-external-call", "snippet": {"code": "  modifier gateThree() {\n    if (address(this).balance > 0.001 ether && payable(owner).send(0.001 ether) == false) {", "highlightLines": [54]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperThree.sol", "line": 54, "column": 3}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#reentrancy-vulnerabilities-4"], "description": ""}, {"id": "caa777b9fad2", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "  modifier gateThree() {\n    if (address(this).balance > 0.001 ether && payable(owner).send(0.001 ether) == false) {\n      _;\n    }", "highlightLines": [54]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperThree.sol", "line": 54, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "bdaead3737e1", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  modifier gateThree() {\n    if (address(this).balance > 0.001 ether && payable(owner).send(0.001 ether) == false) {\n      _;\n    }\n  }", "highlightLines": [54]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperThree.sol", "line": 54, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "c42026968350", "fix": {"template": null, "available": false}, "title": "ETH balance check without accounting for selfdestruct donations - can be manipulated", "ruleId": "rules.sol-eth-balance-accounting", "snippet": {"code": "    if (address(this).balance > 0.001 ether && payable(owner).send(0.001 ether) == false) {", "highlightLines": [55]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperThree.sol", "line": 55, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "1e1ac4cb2f11", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "    if (address(this).balance > 0.001 ether && payable(owner).send(0.001 ether) == false) {", "highlightLines": [55]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperThree.sol", "line": 55, "column": 9}, "severity": "high", "references": [], "description": ""}, {"id": "3a220a916247", "fix": {"template": null, "available": false}, "title": "Unnecessary comparison to boolean constant - use variable directly", "ruleId": "rules.sol-boolean-constant-comparison", "snippet": {"code": "    if (address(this).balance > 0.001 ether && payable(owner).send(0.001 ether) == false) {", "highlightLines": [55]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperThree.sol", "line": 55, "column": 81}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#boolean-equality"], "description": ""}, {"id": "681fc7fa0ed4", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "      _;", "highlightLines": [56]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperThree.sol", "line": 56, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "0ba8e543c484", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    trick = new SimpleTrick(payable(address(this)));", "highlightLines": [67]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperThree.sol", "line": 67, "column": 13}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "6b9e5d1a77f7", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "  receive () external payable {}", "highlightLines": [75]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperThree.sol", "line": 75, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "773ed1d96a98", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "  receive () external payable {}", "highlightLines": [75]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperThree.sol", "line": 75, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "ba39341cc4d8", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperThreeFactory.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "9a00cc4dc556", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    _player;", "highlightLines": [9]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperThreeFactory.sol", "line": 9, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "a8bbafa3b87f", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    GatekeeperThree instance = new GatekeeperThree();", "highlightLines": [10]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperThreeFactory.sol", "line": 10, "column": 32}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "119b9db297ce", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "  function validateInstance(address payable _instance, address _player) override public view returns (bool) {\n    GatekeeperThree instance = GatekeeperThree(_instance);", "highlightLines": [14]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperThreeFactory.sol", "line": 14, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "fa70d8e7c7df", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperTwo.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "2ccd81dc8068", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  modifier gateOne() {\n    require(msg.sender != tx.origin);\n    _;\n  }", "highlightLines": [8]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperTwo.sol", "line": 8, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "99d63e031c0b", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "  modifier gateOne() {\n    require(msg.sender != tx.origin);\n    _;\n  }", "highlightLines": [8]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperTwo.sol", "line": 8, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "9cf77785f538", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(msg.sender != tx.origin);", "highlightLines": [9]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperTwo.sol", "line": 9, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "fb55e5e76ee1", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    _;", "highlightLines": [10]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperTwo.sol", "line": 10, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "e690cbb88de0", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  modifier gateTwo() {\n    uint x;\n    assembly { x := extcodesize(caller()) }\n    require(x == 0);\n    _;\n  }", "highlightLines": [13]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperTwo.sol", "line": 13, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "1c59d3eab929", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint x;", "highlightLines": [14]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperTwo.sol", "line": 14, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "946562aee08d", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "    assembly { x := extcodesize(caller()) }", "highlightLines": [15]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperTwo.sol", "line": 15, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "15a70184784e", "fix": {"template": null, "available": false}, "title": "isContract check can be bypassed by calling from constructor - extcodesize is 0 during construction", "ruleId": "rules.sol-ethernaut-iscontract-bypass", "snippet": {"code": "    assembly { x := extcodesize(caller()) }", "highlightLines": [15]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperTwo.sol", "line": 15, "column": 5}, "severity": "high", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2943"], "description": ""}, {"id": "120006ca140a", "fix": {"template": null, "available": false}, "title": "extcodesize check can be bypassed during constructor - contracts have size 0 while being created", "ruleId": "rules.sol-extcodesize-check", "snippet": {"code": "    assembly { x := extcodesize(caller()) }", "highlightLines": [15]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperTwo.sol", "line": 15, "column": 21}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/18"], "description": ""}, {"id": "eaf6a23eb205", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(x == 0);", "highlightLines": [16]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperTwo.sol", "line": 16, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "4125c4a997a0", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    _;", "highlightLines": [17]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperTwo.sol", "line": 17, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "55cec8d29f6c", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  modifier gateThree(bytes8 _gateKey) {\n    require(uint64(bytes8(keccak256(abi.encodePacked(msg.sender)))) ^ uint64(_gateKey) == type(uint64).max);\n    _;\n  }", "highlightLines": [20]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperTwo.sol", "line": 20, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "bb68b83a8366", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "  modifier gateThree(bytes8 _gateKey) {\n    require(uint64(bytes8(keccak256(abi.encodePacked(msg.sender)))) ^ uint64(_gateKey) == type(uint64).max);\n    _;\n  }", "highlightLines": [20]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperTwo.sol", "line": 20, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "ce464f200e78", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(uint64(bytes8(keccak256(abi.encodePacked(msg.sender)))) ^ uint64(_gateKey) == type(uint64).max);", "highlightLines": [21]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperTwo.sol", "line": 21, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "51ef7615f107", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "    require(uint64(bytes8(keccak256(abi.encodePacked(msg.sender)))) ^ uint64(_gateKey) == type(uint64).max);", "highlightLines": [21]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperTwo.sol", "line": 21, "column": 13}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "1a6c64aaf4cc", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "    require(uint64(bytes8(keccak256(abi.encodePacked(msg.sender)))) ^ uint64(_gateKey) == type(uint64).max);", "highlightLines": [21]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperTwo.sol", "line": 21, "column": 27}, "severity": "high", "references": [], "description": ""}, {"id": "5523860529f2", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    _;", "highlightLines": [22]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperTwo.sol", "line": 22, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "8ee923d4d6ef", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperTwoFactory.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "2bbfbc1c68d2", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    _player;", "highlightLines": [11]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperTwoFactory.sol", "line": 11, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "35203605467e", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    GatekeeperTwo instance = new GatekeeperTwo();", "highlightLines": [12]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperTwoFactory.sol", "line": 12, "column": 30}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "d5eb1c530081", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "  function validateInstance(address payable _instance, address _player) override public view returns (bool) {\n    GatekeeperTwo instance = GatekeeperTwo(_instance);", "highlightLines": [16]}, "category": "code", "location": {"file": "contracts/contracts/levels/GatekeeperTwoFactory.sol", "line": 16, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "35a531888798", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor() {\n        wallet = new Wallet();\n        coin = new Coin(address(wallet));\n\n        wallet.setCoin(coin);\n    }", "highlightLines": [10]}, "category": "code", "location": {"file": "contracts/contracts/levels/GoodSamaritan.sol", "line": 10, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "7d59451af1a3", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        wallet = new Wallet();\n        coin = new Coin(address(wallet));", "highlightLines": [11]}, "category": "code", "location": {"file": "contracts/contracts/levels/GoodSamaritan.sol", "line": 11, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "06b10dd66737", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        wallet = new Wallet();", "highlightLines": [11]}, "category": "code", "location": {"file": "contracts/contracts/levels/GoodSamaritan.sol", "line": 11, "column": 18}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "eaaefc322b93", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        coin = new Coin(address(wallet));", "highlightLines": [12]}, "category": "code", "location": {"file": "contracts/contracts/levels/GoodSamaritan.sol", "line": 12, "column": 16}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "11444d912902", "fix": {"template": null, "available": false}, "title": "External call in try-catch without reentrancy guard - state can be corrupted", "ruleId": "rules.sol-reentrancy-try-catch", "snippet": {"code": "        try wallet.donate10(msg.sender) {\n            return true;\n        } catch (bytes memory err) {", "highlightLines": [19]}, "category": "code", "location": {"file": "contracts/contracts/levels/GoodSamaritan.sol", "line": 19, "column": 9}, "severity": "high", "references": [], "description": ""}, {"id": "0ecb7d3f5eb4", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(address wallet_) {\n        // one million coins for Good Samaritan initially\n        balances[wallet_] = 10**6;\n    }", "highlightLines": [38]}, "category": "code", "location": {"file": "contracts/contracts/levels/GoodSamaritan.sol", "line": 38, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "cba13ae63159", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function transfer(address dest_, uint256 amount_) external {", "highlightLines": [43]}, "category": "code", "location": {"file": "contracts/contracts/levels/GoodSamaritan.sol", "line": 43, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "bebd4307df90", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without msg.data.length validation - vulnerable to short address attack padding", "ruleId": "rules.sol-short-address-no-payload-check", "snippet": {"code": "    function transfer(address dest_, uint256 amount_) external {", "highlightLines": [43]}, "category": "code", "location": {"file": "contracts/contracts/levels/GoodSamaritan.sol", "line": 43, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address", "https://vessenes.com/the-erc20-short-address-attack-explained/"], "description": ""}, {"id": "8f7223038710", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 currentBalance = balances[msg.sender];", "highlightLines": [44]}, "category": "code", "location": {"file": "contracts/contracts/levels/GoodSamaritan.sol", "line": 44, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7385fdd161ec", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "                INotifyable(dest_).notify(amount_);", "highlightLines": [53]}, "category": "code", "location": {"file": "contracts/contracts/levels/GoodSamaritan.sol", "line": 53, "column": 17}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "63a590a10290", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyOwner() {\n        if(msg.sender != owner) {\n            revert OnlyOwner();\n        }\n        _;\n    }", "highlightLines": [70]}, "category": "code", "location": {"file": "contracts/contracts/levels/GoodSamaritan.sol", "line": 70, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "f8dac2d37c3f", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [74]}, "category": "code", "location": {"file": "contracts/contracts/levels/GoodSamaritan.sol", "line": 74, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "d184a4cc0a11", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor() {\n        owner = msg.sender;\n    }", "highlightLines": [77]}, "category": "code", "location": {"file": "contracts/contracts/levels/GoodSamaritan.sol", "line": 77, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "8026cae22bab", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        owner = msg.sender;", "highlightLines": [78]}, "category": "code", "location": {"file": "contracts/contracts/levels/GoodSamaritan.sol", "line": 78, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "e1bd549fae0c", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function donate10(address dest_) external onlyOwner {", "highlightLines": [81]}, "category": "code", "location": {"file": "contracts/contracts/levels/GoodSamaritan.sol", "line": 81, "column": 47}, "severity": "info", "references": [], "description": ""}, {"id": "9870230c7eac", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "            coin.transfer(dest_, 10);", "highlightLines": [87]}, "category": "code", "location": {"file": "contracts/contracts/levels/GoodSamaritan.sol", "line": 87, "column": 13}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "95a75d7fff5d", "fix": {"template": null, "available": false}, "title": "Missing zero address validation - tokens/ETH could be lost", "ruleId": "rules.sol-missing-zero-address-check", "snippet": {"code": "            coin.transfer(dest_, 10);", "highlightLines": [87]}, "category": "code", "location": {"file": "contracts/contracts/levels/GoodSamaritan.sol", "line": 87, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "389cb09db927", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "            coin.transfer(dest_, 10);", "highlightLines": [87]}, "category": "code", "location": {"file": "contracts/contracts/levels/GoodSamaritan.sol", "line": 87, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "e0e2b24a3856", "fix": {"template": null, "available": false}, "title": "ERC20 transfer() return value not checked - tokens like USDT don't return bool", "ruleId": "rules.sol-erc20-transfer-no-return-check", "snippet": {"code": "            coin.transfer(dest_, 10);", "highlightLines": [87]}, "category": "code", "location": {"file": "contracts/contracts/levels/GoodSamaritan.sol", "line": 87, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "06a6c9754303", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function transferRemainder(address dest_) external onlyOwner {", "highlightLines": [91]}, "category": "code", "location": {"file": "contracts/contracts/levels/GoodSamaritan.sol", "line": 91, "column": 56}, "severity": "info", "references": [], "description": ""}, {"id": "ae004a528354", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        coin.transfer(dest_, coin.balances(address(this)));", "highlightLines": [93]}, "category": "code", "location": {"file": "contracts/contracts/levels/GoodSamaritan.sol", "line": 93, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "8c37e5930fc0", "fix": {"template": null, "available": false}, "title": "Missing zero address validation - tokens/ETH could be lost", "ruleId": "rules.sol-missing-zero-address-check", "snippet": {"code": "        coin.transfer(dest_, coin.balances(address(this)));", "highlightLines": [93]}, "category": "code", "location": {"file": "contracts/contracts/levels/GoodSamaritan.sol", "line": 93, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "d34136a2ce01", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "        coin.transfer(dest_, coin.balances(address(this)));", "highlightLines": [93]}, "category": "code", "location": {"file": "contracts/contracts/levels/GoodSamaritan.sol", "line": 93, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "c2cc22f3ddf0", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function setCoin(Coin coin_) external onlyOwner {", "highlightLines": [96]}, "category": "code", "location": {"file": "contracts/contracts/levels/GoodSamaritan.sol", "line": 96, "column": 43}, "severity": "info", "references": [], "description": ""}, {"id": "dbe6da7ffc96", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "contracts/contracts/levels/GoodSamaritanFactory.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "5a486a86b1c6", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    _player;", "highlightLines": [10]}, "category": "code", "location": {"file": "contracts/contracts/levels/GoodSamaritanFactory.sol", "line": 10, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "47dda9b5c67d", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    return address(new GoodSamaritan());", "highlightLines": [11]}, "category": "code", "location": {"file": "contracts/contracts/levels/GoodSamaritanFactory.sol", "line": 11, "column": 20}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "931790cd613e", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "  function validateInstance(address payable _instance, address _player) override public view returns (bool) {\n    _player;\n    GoodSamaritan instance = GoodSamaritan(_instance);", "highlightLines": [14]}, "category": "code", "location": {"file": "contracts/contracts/levels/GoodSamaritanFactory.sol", "line": 14, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "1038fd51eecc", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    _player;", "highlightLines": [15]}, "category": "code", "location": {"file": "contracts/contracts/levels/GoodSamaritanFactory.sol", "line": 15, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "49515aec8f4a", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "contracts/contracts/levels/Instance.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "bd69ad02e0a9", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  constructor(string memory _password) {\n    password = _password;\n  }", "highlightLines": [12]}, "category": "code", "location": {"file": "contracts/contracts/levels/Instance.sol", "line": 12, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "a5c42ec0cec1", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "    if(keccak256(abi.encodePacked(param)) == keccak256(abi.encodePacked('hello'))) {", "highlightLines": [25]}, "category": "code", "location": {"file": "contracts/contracts/levels/Instance.sol", "line": 25, "column": 8}, "severity": "high", "references": [], "description": ""}, {"id": "b3155903c6b4", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "    if(keccak256(abi.encodePacked(passkey)) == keccak256(abi.encodePacked(password))) {", "highlightLines": [40]}, "category": "code", "location": {"file": "contracts/contracts/levels/Instance.sol", "line": 40, "column": 8}, "severity": "high", "references": [], "description": ""}, {"id": "1c45db5d778d", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "contracts/contracts/levels/InstanceFactory.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "abd5b3288fd5", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    _player;", "highlightLines": [11]}, "category": "code", "location": {"file": "contracts/contracts/levels/InstanceFactory.sol", "line": 11, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "023f63a5553b", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    return address(new Instance('ethernaut0'));", "highlightLines": [12]}, "category": "code", "location": {"file": "contracts/contracts/levels/InstanceFactory.sol", "line": 12, "column": 20}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "d382251b7062", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "  function validateInstance(address payable _instance, address _player) override public view returns (bool) {\n    _player;\n    Instance instance = Instance(_instance);", "highlightLines": [15]}, "category": "code", "location": {"file": "contracts/contracts/levels/InstanceFactory.sol", "line": 15, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "6194f2e7947d", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    _player;", "highlightLines": [16]}, "category": "code", "location": {"file": "contracts/contracts/levels/InstanceFactory.sol", "line": 16, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "7f97c5394db0", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "contracts/contracts/levels/King.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "d29d927a3abe", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n  address king;", "highlightLines": [5]}, "category": "code", "location": {"file": "contracts/contracts/levels/King.sol", "line": 5, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b5686bb3d0c8", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  constructor() payable {\n    owner = msg.sender;  \n    king = msg.sender;\n    prize = msg.value;\n  }", "highlightLines": [10]}, "category": "code", "location": {"file": "contracts/contracts/levels/King.sol", "line": 10, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "f42da6956fa8", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "    owner = msg.sender;", "highlightLines": [11]}, "category": "code", "location": {"file": "contracts/contracts/levels/King.sol", "line": 11, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "675d039575b0", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    owner = msg.sender;  \n    king = msg.sender;", "highlightLines": [11]}, "category": "code", "location": {"file": "contracts/contracts/levels/King.sol", "line": 11, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "1c2e5fe77745", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    king = msg.sender;\n    prize = msg.value;", "highlightLines": [12]}, "category": "code", "location": {"file": "contracts/contracts/levels/King.sol", "line": 12, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "e43d9b7bcea3", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "  receive() external payable {", "highlightLines": [16]}, "category": "code", "location": {"file": "contracts/contracts/levels/King.sol", "line": 16, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "a7210710ea94", "fix": {"template": null, "available": false}, "title": "Fallback/receive with require can cause DoS - callers cannot send ETH if condition fails (King pattern)", "ruleId": "rules.sol-reverting-fallback-dos", "snippet": {"code": "  receive() external payable {\n    require(msg.value >= prize || msg.sender == owner);", "highlightLines": [16]}, "category": "code", "location": {"file": "contracts/contracts/levels/King.sol", "line": 16, "column": 3}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/9"], "description": ""}, {"id": "b1ee8bfdffd0", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(msg.value >= prize || msg.sender == owner);", "highlightLines": [17]}, "category": "code", "location": {"file": "contracts/contracts/levels/King.sol", "line": 17, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "235f47c74776", "fix": {"template": null, "available": false}, "title": "payable.transfer() has 2300 gas limit - fails for contracts with receive logic", "ruleId": "rules.sol-payable-transfer-gas-limit", "snippet": {"code": "    payable(king).transfer(msg.value);", "highlightLines": [18]}, "category": "code", "location": {"file": "contracts/contracts/levels/King.sol", "line": 18, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/payable-transfer.sol"], "description": ""}, {"id": "9dc1d7fa0042", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "    payable(king).transfer(msg.value);", "highlightLines": [18]}, "category": "code", "location": {"file": "contracts/contracts/levels/King.sol", "line": 18, "column": 5}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "476ac92f8927", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    king = msg.sender;\n    prize = msg.value;", "highlightLines": [19]}, "category": "code", "location": {"file": "contracts/contracts/levels/King.sol", "line": 19, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "97a85dffe904", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "contracts/contracts/levels/KingFactory.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "d7feacdc5e19", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract KingFactory is Level {\n\n  uint public insertCoin = 0.001 ether;", "highlightLines": [8]}, "category": "code", "location": {"file": "contracts/contracts/levels/KingFactory.sol", "line": 8, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "9c11bd83ceb6", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    _player;", "highlightLines": [13]}, "category": "code", "location": {"file": "contracts/contracts/levels/KingFactory.sol", "line": 13, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "148b76e60eff", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    _player;", "highlightLines": [19]}, "category": "code", "location": {"file": "contracts/contracts/levels/KingFactory.sol", "line": 19, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "0bd28f371e58", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    King instance = King(_instance);\n    (bool result,) = address(instance).call{value:0}(\"\");", "highlightLines": [20]}, "category": "code", "location": {"file": "contracts/contracts/levels/KingFactory.sol", "line": 20, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "0dae0b6f8fe9", "fix": {"template": null, "available": false}, "title": "Low-level call without checking return value - silent failure possible", "ruleId": "rules.sol-unchecked-call-return", "snippet": {"code": "    (bool result,) = address(instance).call{value:0}(\"\");", "highlightLines": [21]}, "category": "code", "location": {"file": "contracts/contracts/levels/KingFactory.sol", "line": 21, "column": 39}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-104/", "https://blocksecteam.medium.com/li-fi-attack"], "description": ""}, {"id": "21dcb4028705", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "  receive() external payable {}", "highlightLines": [26]}, "category": "code", "location": {"file": "contracts/contracts/levels/KingFactory.sol", "line": 26, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "9cd34fcd05cb", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "  receive() external payable {}", "highlightLines": [26]}, "category": "code", "location": {"file": "contracts/contracts/levels/KingFactory.sol", "line": 26, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "ec242a55142b", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "contracts/contracts/levels/MagicNum.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "39507c49423b", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  constructor() {}", "highlightLines": [8]}, "category": "code", "location": {"file": "contracts/contracts/levels/MagicNum.sol", "line": 8, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "c83b020a9067", "fix": {"template": null, "available": false}, "title": "Empty constructor or constructor with no effect - may indicate incomplete implementation", "ruleId": "rules.sol-void-constructor", "snippet": {"code": "  constructor() {}", "highlightLines": [8]}, "category": "code", "location": {"file": "contracts/contracts/levels/MagicNum.sol", "line": 8, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "010bfc2fceab", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "contracts/contracts/levels/MagicNumFactory.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "53c912a233c5", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    return address(new MagicNum());", "highlightLines": [15]}, "category": "code", "location": {"file": "contracts/contracts/levels/MagicNumFactory.sol", "line": 15, "column": 20}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "d1f18c329bdd", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "  function validateInstance(address payable _instance, address) override public view returns (bool) {\n\n    // Retrieve the instance.\n    MagicNum instance = MagicNum(_instance);\n\n    // Retrieve the solver from the instance.\n    Solver solver = Solver(instance.solver());\n    \n    // Query the solver for the magic number.\n    bytes32 magic = solver.whatIsTheMeaningOfLife();", "highlightLines": [18]}, "category": "code", "location": {"file": "contracts/contracts/levels/MagicNumFactory.sol", "line": 18, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "b8313e8eec83", "fix": {"template": null, "available": false}, "title": "View/pure function uses assembly - may modify state unexpectedly", "ruleId": "rules.sol-constant-function-assembly", "snippet": {"code": "  function validateInstance(address payable _instance, address) override public view returns (bool) {\n\n    // Retrieve the instance.\n    MagicNum instance = MagicNum(_instance);\n\n    // Retrieve the solver from the instance.\n    Solver solver = Solver(instance.solver());\n    \n    // Query the solver for the magic number.\n    bytes32 magic = solver.whatIsTheMeaningOfLife();\n    if(magic != 0x000000000000000000000000000000000000000000000000000000000000002a) return false;\n    \n    // Require the solver to have at most 10 opcodes.\n    uint256 size;\n    assembly {", "highlightLines": [18]}, "category": "code", "location": {"file": "contracts/contracts/levels/MagicNumFactory.sol", "line": 18, "column": 3}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-using-assembly-code"], "description": ""}, {"id": "fdcb62f7fffb", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    MagicNum instance = MagicNum(_instance);\n\n    // Retrieve the solver from the instance.\n    Solver solver = Solver(instance.solver());", "highlightLines": [21]}, "category": "code", "location": {"file": "contracts/contracts/levels/MagicNumFactory.sol", "line": 21, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "15831b3a18f1", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    Solver solver = Solver(instance.solver());\n    \n    // Query the solver for the magic number.\n    bytes32 magic = solver.whatIsTheMeaningOfLife();", "highlightLines": [24]}, "category": "code", "location": {"file": "contracts/contracts/levels/MagicNumFactory.sol", "line": 24, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "0bb0a32ec0fb", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    bytes32 magic = solver.whatIsTheMeaningOfLife();", "highlightLines": [27]}, "category": "code", "location": {"file": "contracts/contracts/levels/MagicNumFactory.sol", "line": 27, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "1cee8917cc3c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    bytes32 magic = solver.whatIsTheMeaningOfLife();\n    if(magic != 0x000000000000000000000000000000000000000000000000000000000000002a) return false;\n    \n    // Require the solver to have at most 10 opcodes.\n    uint256 size;\n    assembly {\n      size := extcodesize(solver)\n    }", "highlightLines": [27]}, "category": "code", "location": {"file": "contracts/contracts/levels/MagicNumFactory.sol", "line": 27, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "7535a76f5055", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "    if(magic != 0x000000000000000000000000000000000000000000000000000000000000002a) return false;", "highlightLines": [28]}, "category": "code", "location": {"file": "contracts/contracts/levels/MagicNumFactory.sol", "line": 28, "column": 17}, "severity": "high", "references": [], "description": ""}, {"id": "347611c1f395", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 size;", "highlightLines": [31]}, "category": "code", "location": {"file": "contracts/contracts/levels/MagicNumFactory.sol", "line": 31, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "fc8f4d01f1c0", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "    assembly {", "highlightLines": [32]}, "category": "code", "location": {"file": "contracts/contracts/levels/MagicNumFactory.sol", "line": 32, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "216214e5e63e", "fix": {"template": null, "available": false}, "title": "isContract check can be bypassed by calling from constructor - extcodesize is 0 during construction", "ruleId": "rules.sol-ethernaut-iscontract-bypass", "snippet": {"code": "    assembly {\n      size := extcodesize(solver)\n    }", "highlightLines": [32]}, "category": "code", "location": {"file": "contracts/contracts/levels/MagicNumFactory.sol", "line": 32, "column": 5}, "severity": "high", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2943"], "description": ""}, {"id": "ab482101c54a", "fix": {"template": null, "available": false}, "title": "extcodesize check can be bypassed during constructor - contracts have size 0 while being created", "ruleId": "rules.sol-extcodesize-check", "snippet": {"code": "      size := extcodesize(solver)", "highlightLines": [33]}, "category": "code", "location": {"file": "contracts/contracts/levels/MagicNumFactory.sol", "line": 33, "column": 15}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/18"], "description": ""}, {"id": "a9d1d41f44cd", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "    if(size > 10) return false;\n    \n    return true;", "highlightLines": [35]}, "category": "code", "location": {"file": "contracts/contracts/levels/MagicNumFactory.sol", "line": 35, "column": 19}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "f2c4ff26daae", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "    bytes32 internal constant _IMPLEMENTATION_SLOT = 0x360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc;", "highlightLines": [10]}, "category": "code", "location": {"file": "contracts/contracts/levels/Motorbike.sol", "line": 10, "column": 54}, "severity": "high", "references": [], "description": ""}, {"id": "17291a39c00f", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address value;", "highlightLines": [13]}, "category": "code", "location": {"file": "contracts/contracts/levels/Motorbike.sol", "line": 13, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f9ec1da91493", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        _getAddressSlot(_IMPLEMENTATION_SLOT).value = _logic;\n        (bool success,) = _logic.delegatecall(\n            abi.encodeWithSignature(\"initialize()\")\n        );", "highlightLines": [19]}, "category": "code", "location": {"file": "contracts/contracts/levels/Motorbike.sol", "line": 19, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "04c905ede1d7", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "        (bool success,) = _logic.delegatecall(\n            abi.encodeWithSignature(\"initialize()\")", "highlightLines": [20]}, "category": "code", "location": {"file": "contracts/contracts/levels/Motorbike.sol", "line": 20, "column": 27}, "severity": "medium", "references": [], "description": ""}, {"id": "2c252792b6af", "fix": {"template": null, "available": false}, "title": "Delegatecall to user-controlled address - attacker can execute arbitrary code in contract context", "ruleId": "rules.sol-delegatecall-to-arbitrary-address", "snippet": {"code": "        (bool success,) = _logic.delegatecall(\n            abi.encodeWithSignature(\"initialize()\")\n        );", "highlightLines": [20]}, "category": "code", "location": {"file": "contracts/contracts/levels/Motorbike.sol", "line": 20, "column": 27}, "severity": "high", "references": ["https://entethalliance.org/specs/ethtrust-sl/v1/#req-1-delegatecall"], "description": ""}, {"id": "607f2ecf2670", "fix": {"template": null, "available": false}, "title": "Delegatecall with user-controlled data - storage slot collision possible", "ruleId": "rules.sol-arbitrary-delegatecall-data", "snippet": {"code": "        (bool success,) = _logic.delegatecall(\n            abi.encodeWithSignature(\"initialize()\")", "highlightLines": [20]}, "category": "code", "location": {"file": "contracts/contracts/levels/Motorbike.sol", "line": 20, "column": 33}, "severity": "high", "references": [], "description": ""}, {"id": "9eab664ad989", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [29]}, "category": "code", "location": {"file": "contracts/contracts/levels/Motorbike.sol", "line": 29, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "717a387492f2", "fix": {"template": null, "available": false}, "title": "View/pure function uses assembly - may modify state unexpectedly", "ruleId": "rules.sol-constant-function-assembly", "snippet": {"code": "    function _getAddressSlot(bytes32 slot) internal pure returns (AddressSlot storage r) {\n        assembly {", "highlightLines": [46]}, "category": "code", "location": {"file": "contracts/contracts/levels/Motorbike.sol", "line": 46, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-using-assembly-code"], "description": ""}, {"id": "0f1ae23c5da8", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [47]}, "category": "code", "location": {"file": "contracts/contracts/levels/Motorbike.sol", "line": 47, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "593b6d1ba27b", "fix": {"template": null, "available": false}, "title": "Upgradeable contract without storage gap - future upgrade collision risk", "ruleId": "rules.sol-no-gap-storage", "snippet": {"code": "contract Engine is Initializable {", "highlightLines": [53]}, "category": "code", "location": {"file": "contracts/contracts/levels/Motorbike.sol", "line": 53, "column": 1}, "severity": "info", "references": ["https://docs.openzeppelin.com/contracts/4.x/upgradeable#storage_gaps"], "description": ""}, {"id": "d88b0ac0e54a", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract Engine is Initializable {\n    // keccak-256 hash of \"eip1967.proxy.implementation\" subtracted by 1\n    bytes32 internal constant _IMPLEMENTATION_SLOT = 0x360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc;\n\n    address public upgrader;\n    uint256 public horsePower;\n\n    struct AddressSlot {\n        address value;", "highlightLines": [53]}, "category": "code", "location": {"file": "contracts/contracts/levels/Motorbike.sol", "line": 53, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "cf0894883717", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "    bytes32 internal constant _IMPLEMENTATION_SLOT = 0x360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc;", "highlightLines": [55]}, "category": "code", "location": {"file": "contracts/contracts/levels/Motorbike.sol", "line": 55, "column": 54}, "severity": "high", "references": [], "description": ""}, {"id": "effbd90a6509", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address value;", "highlightLines": [61]}, "category": "code", "location": {"file": "contracts/contracts/levels/Motorbike.sol", "line": 61, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "db4e382c1ad8", "fix": {"template": null, "available": false}, "title": "Initializer function not protected - can be called multiple times", "ruleId": "rules.sol-initializer-not-protected", "snippet": {"code": "    function initialize() external initializer {", "highlightLines": [64]}, "category": "code", "location": {"file": "contracts/contracts/levels/Motorbike.sol", "line": 64, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "2d53ab9d5fd4", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        horsePower = 1000;\n        upgrader = msg.sender;", "highlightLines": [65]}, "category": "code", "location": {"file": "contracts/contracts/levels/Motorbike.sol", "line": 65, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "2cbb08d755df", "fix": {"template": null, "available": false}, "title": "Proxy upgrade executable immediately - malicious upgrade can drain funds before users react", "ruleId": "rules.sol-proxy-upgrade-no-delay", "snippet": {"code": "    function upgradeToAndCall(address newImplementation, bytes memory data) external payable {", "highlightLines": [71]}, "category": "code", "location": {"file": "contracts/contracts/levels/Motorbike.sol", "line": 71, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "c672dc4a1973", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "            (bool success,) = newImplementation.delegatecall(data);", "highlightLines": [89]}, "category": "code", "location": {"file": "contracts/contracts/levels/Motorbike.sol", "line": 89, "column": 31}, "severity": "medium", "references": [], "description": ""}, {"id": "2f701a805ce7", "fix": {"template": null, "available": false}, "title": "Delegatecall with user-controlled data - storage slot collision possible", "ruleId": "rules.sol-arbitrary-delegatecall-data", "snippet": {"code": "            (bool success,) = newImplementation.delegatecall(data);", "highlightLines": [89]}, "category": "code", "location": {"file": "contracts/contracts/levels/Motorbike.sol", "line": 89, "column": 48}, "severity": "high", "references": [], "description": ""}, {"id": "f33c76159652", "fix": {"template": null, "available": false}, "title": "Uninitialized storage pointer defaults to slot 0 - can overwrite critical state (FiftyYears pattern)", "ruleId": "rules.sol-uninitialized-storage-pointer", "snippet": {"code": "        AddressSlot storage r;", "highlightLines": [98]}, "category": "code", "location": {"file": "contracts/contracts/levels/Motorbike.sol", "line": 98, "column": 9}, "severity": "high", "references": ["https://capturetheether.com/challenges/math/fifty-years/"], "description": ""}, {"id": "9eab524fe734", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [99]}, "category": "code", "location": {"file": "contracts/contracts/levels/Motorbike.sol", "line": 99, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "fd3c18640e39", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    _player;", "highlightLines": [14]}, "category": "code", "location": {"file": "contracts/contracts/levels/MotorbikeFactory.sol", "line": 14, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "8710b7e4a61c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    Engine engine = new Engine();\n    Motorbike motorbike = new Motorbike(address(engine));", "highlightLines": [16]}, "category": "code", "location": {"file": "contracts/contracts/levels/MotorbikeFactory.sol", "line": 16, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "e5216c2b3926", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    Engine engine = new Engine();", "highlightLines": [16]}, "category": "code", "location": {"file": "contracts/contracts/levels/MotorbikeFactory.sol", "line": 16, "column": 21}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "1602c2fa6d30", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    Motorbike motorbike = new Motorbike(address(engine));\n    engines[address(motorbike)] = address(engine);", "highlightLines": [17]}, "category": "code", "location": {"file": "contracts/contracts/levels/MotorbikeFactory.sol", "line": 17, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "0092df56b99d", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    Motorbike motorbike = new Motorbike(address(engine));", "highlightLines": [17]}, "category": "code", "location": {"file": "contracts/contracts/levels/MotorbikeFactory.sol", "line": 17, "column": 27}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "66ee74b02a75", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    _player;", "highlightLines": [40]}, "category": "code", "location": {"file": "contracts/contracts/levels/MotorbikeFactory.sol", "line": 40, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "e2a05e168e56", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "contracts/contracts/levels/NaughtCoin.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "c3babf27ee62", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": " contract NaughtCoin is ERC20 {\n\n  // string public constant name = 'NaughtCoin';\n  // string public constant symbol = '0x0';\n  // uint public constant decimals = 18;\n  uint public timeLock = block.timestamp + 10 * 365 days;\n  uint256 public INITIAL_SUPPLY;\n  address public player;", "highlightLines": [6]}, "category": "code", "location": {"file": "contracts/contracts/levels/NaughtCoin.sol", "line": 6, "column": 2}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "65eb68038ea0", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "  uint public timeLock = block.timestamp + 10 * 365 days;", "highlightLines": [11]}, "category": "code", "location": {"file": "contracts/contracts/levels/NaughtCoin.sol", "line": 11, "column": 26}, "severity": "medium", "references": [], "description": ""}, {"id": "04baa8298133", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  constructor(address _player) \n  ERC20('NaughtCoin', '0x0') {\n    player = _player;\n    INITIAL_SUPPLY = 1000000 * (10**uint256(decimals()));\n    // _totalSupply = INITIAL_SUPPLY;\n    // _balances[player] = INITIAL_SUPPLY;\n    _mint(player, INITIAL_SUPPLY);\n    emit Transfer(address(0), player, INITIAL_SUPPLY);\n  }", "highlightLines": [15]}, "category": "code", "location": {"file": "contracts/contracts/levels/NaughtCoin.sol", "line": 15, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "cc330d9a34b4", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    player = _player;\n    INITIAL_SUPPLY = 1000000 * (10**uint256(decimals()));", "highlightLines": [17]}, "category": "code", "location": {"file": "contracts/contracts/levels/NaughtCoin.sol", "line": 17, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "190a45d97e32", "fix": {"template": null, "available": false}, "title": "NFT mint without supply check - potential overflow in tokenId", "ruleId": "rules.sol-nft-overflow-mint", "snippet": {"code": "    _mint(player, INITIAL_SUPPLY);", "highlightLines": [21]}, "category": "code", "location": {"file": "contracts/contracts/levels/NaughtCoin.sol", "line": 21, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "2760ef6fd8a0", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without msg.data.length validation - vulnerable to short address attack padding", "ruleId": "rules.sol-short-address-no-payload-check", "snippet": {"code": "  function transfer(address _to, uint256 _value) override public lockTokens returns(bool) {", "highlightLines": [25]}, "category": "code", "location": {"file": "contracts/contracts/levels/NaughtCoin.sol", "line": 25, "column": 3}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address", "https://vessenes.com/the-erc20-short-address-attack-explained/"], "description": ""}, {"id": "4ba2ffa5ee72", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "    super.transfer(_to, _value);", "highlightLines": [26]}, "category": "code", "location": {"file": "contracts/contracts/levels/NaughtCoin.sol", "line": 26, "column": 5}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "87cd5d5d8f62", "fix": {"template": null, "available": false}, "title": "Missing zero address validation - tokens/ETH could be lost", "ruleId": "rules.sol-missing-zero-address-check", "snippet": {"code": "    super.transfer(_to, _value);", "highlightLines": [26]}, "category": "code", "location": {"file": "contracts/contracts/levels/NaughtCoin.sol", "line": 26, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "b3905f52d3c4", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "    super.transfer(_to, _value);", "highlightLines": [26]}, "category": "code", "location": {"file": "contracts/contracts/levels/NaughtCoin.sol", "line": 26, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "afa807d1e2f9", "fix": {"template": null, "available": false}, "title": "ERC20 transfer() return value not checked - tokens like USDT don't return bool", "ruleId": "rules.sol-erc20-transfer-no-return-check", "snippet": {"code": "    super.transfer(_to, _value);", "highlightLines": [26]}, "category": "code", "location": {"file": "contracts/contracts/levels/NaughtCoin.sol", "line": 26, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "0d31208e3302", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  modifier lockTokens() {\n    if (msg.sender == player) {\n      require(block.timestamp > timeLock);\n      _;\n    } else {\n     _;\n    }\n  }", "highlightLines": [30]}, "category": "code", "location": {"file": "contracts/contracts/levels/NaughtCoin.sol", "line": 30, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "ceaa8bac96fa", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "      require(block.timestamp > timeLock);", "highlightLines": [32]}, "category": "code", "location": {"file": "contracts/contracts/levels/NaughtCoin.sol", "line": 32, "column": 7}, "severity": "info", "references": [], "description": ""}, {"id": "61116168ac9b", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "      require(block.timestamp > timeLock);", "highlightLines": [32]}, "category": "code", "location": {"file": "contracts/contracts/levels/NaughtCoin.sol", "line": 32, "column": 15}, "severity": "medium", "references": [], "description": ""}, {"id": "92d25ba8eece", "fix": {"template": null, "available": false}, "title": "Block timestamp used for critical logic - miners can manipulate within ~15 second window", "ruleId": "rules.sol-block-timestamp-manipulation", "snippet": {"code": "      require(block.timestamp > timeLock);", "highlightLines": [32]}, "category": "code", "location": {"file": "contracts/contracts/levels/NaughtCoin.sol", "line": 32, "column": 15}, "severity": "medium", "references": ["https://consensys.github.io/smart-contract-best-practices/development-recommendations/solidity-specific/timestamp-dependence/"], "description": ""}, {"id": "9a6f7bf8752a", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "      _;", "highlightLines": [33]}, "category": "code", "location": {"file": "contracts/contracts/levels/NaughtCoin.sol", "line": 33, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "fbf6be09460f", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "     _;", "highlightLines": [35]}, "category": "code", "location": {"file": "contracts/contracts/levels/NaughtCoin.sol", "line": 35, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "dac600bbdf67", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "contracts/contracts/levels/NaughtCoinFactory.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "2a0a5b5aa8fd", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    return address(new NaughtCoin(_player));", "highlightLines": [11]}, "category": "code", "location": {"file": "contracts/contracts/levels/NaughtCoinFactory.sol", "line": 11, "column": 20}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "9bf349a3815b", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "  function validateInstance(address payable _instance, address _player) override public view returns (bool) {\n    NaughtCoin instance = NaughtCoin(_instance);", "highlightLines": [14]}, "category": "code", "location": {"file": "contracts/contracts/levels/NaughtCoinFactory.sol", "line": 14, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "24c1852a5f49", "fix": {"template": null, "available": false}, "title": "Strict equality on balance - can be manipulated via selfdestruct or direct transfer", "ruleId": "rules.sol-dangerous-strict-equality", "snippet": {"code": "    return instance.balanceOf(_player) == 0;", "highlightLines": [16]}, "category": "code", "location": {"file": "contracts/contracts/levels/NaughtCoinFactory.sol", "line": 16, "column": 12}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dangerous-strict-equalities"], "description": ""}, {"id": "1f234d65b770", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "contracts/contracts/levels/Preservation.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "deccaab316ce", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "  uint storedTime;", "highlightLines": [10]}, "category": "code", "location": {"file": "contracts/contracts/levels/Preservation.sol", "line": 10, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "cef0dc83b22a", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  constructor(address _timeZone1LibraryAddress, address _timeZone2LibraryAddress) {\n    timeZone1Library = _timeZone1LibraryAddress; \n    timeZone2Library = _timeZone2LibraryAddress; \n    owner = msg.sender;\n  }", "highlightLines": [14]}, "category": "code", "location": {"file": "contracts/contracts/levels/Preservation.sol", "line": 14, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "aa28319ac5d1", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    timeZone1Library = _timeZone1LibraryAddress; \n    timeZone2Library = _timeZone2LibraryAddress;", "highlightLines": [15]}, "category": "code", "location": {"file": "contracts/contracts/levels/Preservation.sol", "line": 15, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "53931eba9dec", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    timeZone2Library = _timeZone2LibraryAddress; \n    owner = msg.sender;", "highlightLines": [16]}, "category": "code", "location": {"file": "contracts/contracts/levels/Preservation.sol", "line": 16, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "73ee7d42fd10", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "    owner = msg.sender;", "highlightLines": [17]}, "category": "code", "location": {"file": "contracts/contracts/levels/Preservation.sol", "line": 17, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "a25ba99a40b3", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "    timeZone1Library.delegatecall(abi.encodePacked(setTimeSignature, _timeStamp));", "highlightLines": [22]}, "category": "code", "location": {"file": "contracts/contracts/levels/Preservation.sol", "line": 22, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "556f3b306269", "fix": {"template": null, "available": false}, "title": "Delegatecall with user-controlled data - storage slot collision possible", "ruleId": "rules.sol-arbitrary-delegatecall-data", "snippet": {"code": "    timeZone1Library.delegatecall(abi.encodePacked(setTimeSignature, _timeStamp));", "highlightLines": [22]}, "category": "code", "location": {"file": "contracts/contracts/levels/Preservation.sol", "line": 22, "column": 21}, "severity": "high", "references": [], "description": ""}, {"id": "8f6394283ad9", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "    timeZone1Library.delegatecall(abi.encodePacked(setTimeSignature, _timeStamp));", "highlightLines": [22]}, "category": "code", "location": {"file": "contracts/contracts/levels/Preservation.sol", "line": 22, "column": 35}, "severity": "medium", "references": [], "description": ""}, {"id": "f0cf7d7aab7a", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "    timeZone2Library.delegatecall(abi.encodePacked(setTimeSignature, _timeStamp));", "highlightLines": [27]}, "category": "code", "location": {"file": "contracts/contracts/levels/Preservation.sol", "line": 27, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "ee426f57a518", "fix": {"template": null, "available": false}, "title": "Delegatecall with user-controlled data - storage slot collision possible", "ruleId": "rules.sol-arbitrary-delegatecall-data", "snippet": {"code": "    timeZone2Library.delegatecall(abi.encodePacked(setTimeSignature, _timeStamp));", "highlightLines": [27]}, "category": "code", "location": {"file": "contracts/contracts/levels/Preservation.sol", "line": 27, "column": 21}, "severity": "high", "references": [], "description": ""}, {"id": "c8217c717d3a", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "    timeZone2Library.delegatecall(abi.encodePacked(setTimeSignature, _timeStamp));", "highlightLines": [27]}, "category": "code", "location": {"file": "contracts/contracts/levels/Preservation.sol", "line": 27, "column": 35}, "severity": "medium", "references": [], "description": ""}, {"id": "06a80158024a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "  uint storedTime;", "highlightLines": [35]}, "category": "code", "location": {"file": "contracts/contracts/levels/Preservation.sol", "line": 35, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e6e9b3fadd34", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "contracts/contracts/levels/PreservationFactory.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "c46d37346ec7", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract PreservationFactory is Level {\n\n  address timeZone1LibraryAddress;\n  address timeZone2LibraryAddress;", "highlightLines": [8]}, "category": "code", "location": {"file": "contracts/contracts/levels/PreservationFactory.sol", "line": 8, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "a68a52ca53fb", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n  address timeZone1LibraryAddress;", "highlightLines": [9]}, "category": "code", "location": {"file": "contracts/contracts/levels/PreservationFactory.sol", "line": 9, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4f567b2dbf26", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "  address timeZone2LibraryAddress;", "highlightLines": [11]}, "category": "code", "location": {"file": "contracts/contracts/levels/PreservationFactory.sol", "line": 11, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f39d7b089a00", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  constructor() {\n    timeZone1LibraryAddress = address(new LibraryContract());\n    timeZone2LibraryAddress = address(new LibraryContract());\n  }", "highlightLines": [13]}, "category": "code", "location": {"file": "contracts/contracts/levels/PreservationFactory.sol", "line": 13, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "c52a3a61d751", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    timeZone1LibraryAddress = address(new LibraryContract());\n    timeZone2LibraryAddress = address(new LibraryContract());", "highlightLines": [14]}, "category": "code", "location": {"file": "contracts/contracts/levels/PreservationFactory.sol", "line": 14, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "8c29690a2943", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    timeZone1LibraryAddress = address(new LibraryContract());", "highlightLines": [14]}, "category": "code", "location": {"file": "contracts/contracts/levels/PreservationFactory.sol", "line": 14, "column": 39}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "48542e31d24c", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    timeZone2LibraryAddress = address(new LibraryContract());", "highlightLines": [15]}, "category": "code", "location": {"file": "contracts/contracts/levels/PreservationFactory.sol", "line": 15, "column": 39}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "3f63e5271a5a", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    _player;", "highlightLines": [19]}, "category": "code", "location": {"file": "contracts/contracts/levels/PreservationFactory.sol", "line": 19, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "53b68f0c209b", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    return address(new Preservation(timeZone1LibraryAddress, timeZone2LibraryAddress));", "highlightLines": [20]}, "category": "code", "location": {"file": "contracts/contracts/levels/PreservationFactory.sol", "line": 20, "column": 20}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "5bee48447bf1", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "  function validateInstance(address payable _instance, address _player) override public view returns (bool) {\n    Preservation preservation = Preservation(_instance);", "highlightLines": [23]}, "category": "code", "location": {"file": "contracts/contracts/levels/PreservationFactory.sol", "line": 23, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "45ae328c713d", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "contracts/contracts/levels/Privacy.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "9261c1225be5", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "  uint256 public ID = block.timestamp;", "highlightLines": [7]}, "category": "code", "location": {"file": "contracts/contracts/levels/Privacy.sol", "line": 7, "column": 23}, "severity": "medium", "references": [], "description": ""}, {"id": "d19dddb38aa8", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "  uint16 private awkwardness = uint16(block.timestamp);", "highlightLines": [10]}, "category": "code", "location": {"file": "contracts/contracts/levels/Privacy.sol", "line": 10, "column": 32}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "411604731a09", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "  uint16 private awkwardness = uint16(block.timestamp);", "highlightLines": [10]}, "category": "code", "location": {"file": "contracts/contracts/levels/Privacy.sol", "line": 10, "column": 39}, "severity": "medium", "references": [], "description": ""}, {"id": "73c254e7e0b0", "fix": {"template": null, "available": false}, "title": "Private arrays/mappings are readable on-chain - storage slots can be computed and read (Privacy pattern)", "ruleId": "rules.sol-private-array-exposure", "snippet": {"code": "  bytes32[3] private data;", "highlightLines": [11]}, "category": "code", "location": {"file": "contracts/contracts/levels/Privacy.sol", "line": 11, "column": 3}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/12"], "description": ""}, {"id": "fadca2de8330", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  constructor(bytes32[3] memory _data) {\n    data = _data;\n  }", "highlightLines": [13]}, "category": "code", "location": {"file": "contracts/contracts/levels/Privacy.sol", "line": 13, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "3eefdda85747", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "  function unlock(bytes16 _key) public {\n    require(_key == bytes16(data[2]));", "highlightLines": [17]}, "category": "code", "location": {"file": "contracts/contracts/levels/Privacy.sol", "line": 17, "column": 3}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "6294000fa506", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(_key == bytes16(data[2]));", "highlightLines": [18]}, "category": "code", "location": {"file": "contracts/contracts/levels/Privacy.sol", "line": 18, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "1389208645fe", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "contracts/contracts/levels/PrivacyFactory.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "5a26ae40b145", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    data[0] = keccak256(abi.encodePacked(tx.origin,\"0\"));\n    data[1] = keccak256(abi.encodePacked(tx.origin,\"1\"));", "highlightLines": [12]}, "category": "code", "location": {"file": "contracts/contracts/levels/PrivacyFactory.sol", "line": 12, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "c87792abd656", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "    data[0] = keccak256(abi.encodePacked(tx.origin,\"0\"));", "highlightLines": [12]}, "category": "code", "location": {"file": "contracts/contracts/levels/PrivacyFactory.sol", "line": 12, "column": 15}, "severity": "high", "references": [], "description": ""}, {"id": "1a1d710ade8b", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "    data[0] = keccak256(abi.encodePacked(tx.origin,\"0\"));", "highlightLines": [12]}, "category": "code", "location": {"file": "contracts/contracts/levels/PrivacyFactory.sol", "line": 12, "column": 25}, "severity": "medium", "references": [], "description": ""}, {"id": "beee1270fe6b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    data[1] = keccak256(abi.encodePacked(tx.origin,\"1\"));\n    data[2] = keccak256(abi.encodePacked(tx.origin,\"2\"));", "highlightLines": [13]}, "category": "code", "location": {"file": "contracts/contracts/levels/PrivacyFactory.sol", "line": 13, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "2a80e6ecb0b4", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "    data[1] = keccak256(abi.encodePacked(tx.origin,\"1\"));", "highlightLines": [13]}, "category": "code", "location": {"file": "contracts/contracts/levels/PrivacyFactory.sol", "line": 13, "column": 15}, "severity": "high", "references": [], "description": ""}, {"id": "83ba4ae502bd", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "    data[1] = keccak256(abi.encodePacked(tx.origin,\"1\"));", "highlightLines": [13]}, "category": "code", "location": {"file": "contracts/contracts/levels/PrivacyFactory.sol", "line": 13, "column": 25}, "severity": "medium", "references": [], "description": ""}, {"id": "4a7bc1bcd116", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    data[2] = keccak256(abi.encodePacked(tx.origin,\"2\"));\n    Privacy instance = new Privacy(data);", "highlightLines": [14]}, "category": "code", "location": {"file": "contracts/contracts/levels/PrivacyFactory.sol", "line": 14, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "726a2cb9fa11", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "    data[2] = keccak256(abi.encodePacked(tx.origin,\"2\"));", "highlightLines": [14]}, "category": "code", "location": {"file": "contracts/contracts/levels/PrivacyFactory.sol", "line": 14, "column": 15}, "severity": "high", "references": [], "description": ""}, {"id": "c95303d0b697", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "    data[2] = keccak256(abi.encodePacked(tx.origin,\"2\"));", "highlightLines": [14]}, "category": "code", "location": {"file": "contracts/contracts/levels/PrivacyFactory.sol", "line": 14, "column": 25}, "severity": "medium", "references": [], "description": ""}, {"id": "9708cf05ecd2", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    Privacy instance = new Privacy(data);", "highlightLines": [15]}, "category": "code", "location": {"file": "contracts/contracts/levels/PrivacyFactory.sol", "line": 15, "column": 24}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "9733361ba0cc", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "  function validateInstance(address payable _instance, address) override public view returns (bool) {\n    Privacy instance = Privacy(_instance);", "highlightLines": [19]}, "category": "code", "location": {"file": "contracts/contracts/levels/PrivacyFactory.sol", "line": 19, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "329437b79ff1", "fix": {"template": null, "available": false}, "title": "Unnecessary comparison to boolean constant - use variable directly", "ruleId": "rules.sol-boolean-constant-comparison", "snippet": {"code": "    return instance.locked() == false;", "highlightLines": [21]}, "category": "code", "location": {"file": "contracts/contracts/levels/PrivacyFactory.sol", "line": 21, "column": 30}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#boolean-equality"], "description": ""}, {"id": "d7f963d1586b", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "contracts/contracts/levels/PuzzleWallet.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "81ce62315215", "fix": {"template": null, "available": false}, "title": "ABIEncoderV2 is experimental and has had 20+ high-severity bugs - avoid in production", "ruleId": "rules.sol-abiencoderv2-experimental", "snippet": {"code": "pragma experimental ABIEncoderV2;", "highlightLines": [3]}, "category": "code", "location": {"file": "contracts/contracts/levels/PuzzleWallet.sol", "line": 3, "column": 1}, "severity": "medium", "references": [], "description": ""}, {"id": "aa7afc3e0335", "fix": {"template": null, "available": false}, "title": "Upgradeable contract without storage gap - adding variables in parent will corrupt child storage", "ruleId": "rules.sol-missing-storage-gap", "snippet": {"code": "contract PuzzleProxy is UpgradeableProxy {", "highlightLines": [7]}, "category": "code", "location": {"file": "contracts/contracts/levels/PuzzleWallet.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://docs.openzeppelin.com/upgrades-plugins/writing-upgradeable"], "description": ""}, {"id": "97f27cd76b29", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract PuzzleProxy is UpgradeableProxy {\n    address public pendingAdmin;\n    address public admin;", "highlightLines": [7]}, "category": "code", "location": {"file": "contracts/contracts/levels/PuzzleWallet.sol", "line": 7, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "211d3e6d8afd", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(address _admin, address _implementation, bytes memory _initData) UpgradeableProxy(_implementation, _initData) {\n        admin = _admin;\n    }", "highlightLines": [11]}, "category": "code", "location": {"file": "contracts/contracts/levels/PuzzleWallet.sol", "line": 11, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "defefb247dd7", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyAdmin {\n      require(msg.sender == admin, \"Caller is not the admin\");\n      _;\n    }", "highlightLines": [15]}, "category": "code", "location": {"file": "contracts/contracts/levels/PuzzleWallet.sol", "line": 15, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "4f00cdfe06d3", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "      _;", "highlightLines": [17]}, "category": "code", "location": {"file": "contracts/contracts/levels/PuzzleWallet.sol", "line": 17, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "7b851cfb08da", "fix": {"template": null, "available": false}, "title": "Diamond upgrade function without timelock - instant rug pull possible", "ruleId": "rules.sol-diamond-upgrade-no-timelock", "snippet": {"code": "    function upgradeTo(address _newImplementation) external onlyAdmin {", "highlightLines": [29]}, "category": "code", "location": {"file": "contracts/contracts/levels/PuzzleWallet.sol", "line": 29, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "1db2a71171e1", "fix": {"template": null, "available": false}, "title": "Proxy upgrade executable immediately - malicious upgrade can drain funds before users react", "ruleId": "rules.sol-proxy-upgrade-no-delay", "snippet": {"code": "    function upgradeTo(address _newImplementation) external onlyAdmin {", "highlightLines": [29]}, "category": "code", "location": {"file": "contracts/contracts/levels/PuzzleWallet.sol", "line": 29, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "d31262d71988", "fix": {"template": null, "available": false}, "title": "Initialization function can be front-run - use initializer modifier or constructor", "ruleId": "rules.sol-initialization-frontrun", "snippet": {"code": "    function init(uint256 _maxBalance) public {", "highlightLines": [40]}, "category": "code", "location": {"file": "contracts/contracts/levels/PuzzleWallet.sol", "line": 40, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "7034fde61b56", "fix": {"template": null, "available": false}, "title": "Variable written twice without being read between - first write is dead store", "ruleId": "rules.sol-write-after-write", "snippet": {"code": "        require(maxBalance == 0, \"Already initialized\");\n        maxBalance = _maxBalance;", "highlightLines": [41]}, "category": "code", "location": {"file": "contracts/contracts/levels/PuzzleWallet.sol", "line": 41, "column": 17}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#write-after-write"], "description": ""}, {"id": "a90ee667a80d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        maxBalance = _maxBalance;\n        owner = msg.sender;", "highlightLines": [42]}, "category": "code", "location": {"file": "contracts/contracts/levels/PuzzleWallet.sol", "line": 42, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "fd5a692abe1f", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        owner = msg.sender;", "highlightLines": [43]}, "category": "code", "location": {"file": "contracts/contracts/levels/PuzzleWallet.sol", "line": 43, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "48685ab4026f", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyWhitelisted {\n        require(whitelisted[msg.sender], \"Not whitelisted\");\n        _;\n    }", "highlightLines": [46]}, "category": "code", "location": {"file": "contracts/contracts/levels/PuzzleWallet.sol", "line": 46, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "1abef35797c7", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [48]}, "category": "code", "location": {"file": "contracts/contracts/levels/PuzzleWallet.sol", "line": 48, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "85291cc0a17c", "fix": {"template": null, "available": false}, "title": "Strict ETH balance check - contract can receive ETH via selfdestruct bypassing this", "ruleId": "rules.sol-forced-ether-assumption", "snippet": {"code": "      require(address(this).balance == 0, \"Contract balance is not 0\");", "highlightLines": [52]}, "category": "code", "location": {"file": "contracts/contracts/levels/PuzzleWallet.sol", "line": 52, "column": 7}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/forced_ether_reception"], "description": ""}, {"id": "758d1ac525da", "fix": {"template": null, "available": false}, "title": "ETH balance check without accounting for selfdestruct donations - can be manipulated", "ruleId": "rules.sol-eth-balance-accounting", "snippet": {"code": "      require(address(this).balance == 0, \"Contract balance is not 0\");", "highlightLines": [52]}, "category": "code", "location": {"file": "contracts/contracts/levels/PuzzleWallet.sol", "line": 52, "column": 15}, "severity": "medium", "references": [], "description": ""}, {"id": "e455a43aa5bf", "fix": {"template": null, "available": false}, "title": "Strict equality on balance - can be manipulated via selfdestruct or direct transfer", "ruleId": "rules.sol-dangerous-strict-equality", "snippet": {"code": "      require(address(this).balance == 0, \"Contract balance is not 0\");", "highlightLines": [52]}, "category": "code", "location": {"file": "contracts/contracts/levels/PuzzleWallet.sol", "line": 52, "column": 15}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dangerous-strict-equalities"], "description": ""}, {"id": "098f672ac51c", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "        require(msg.sender == owner, \"Not the owner\");", "highlightLines": [57]}, "category": "code", "location": {"file": "contracts/contracts/levels/PuzzleWallet.sol", "line": 57, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "aac50a3a2c06", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function deposit() external payable onlyWhitelisted {", "highlightLines": [61]}, "category": "code", "location": {"file": "contracts/contracts/levels/PuzzleWallet.sol", "line": 61, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "013912256deb", "fix": {"template": null, "available": false}, "title": "ETH balance check without accounting for selfdestruct donations - can be manipulated", "ruleId": "rules.sol-eth-balance-accounting", "snippet": {"code": "      require(address(this).balance <= maxBalance, \"Max balance reached\");", "highlightLines": [62]}, "category": "code", "location": {"file": "contracts/contracts/levels/PuzzleWallet.sol", "line": 62, "column": 15}, "severity": "medium", "references": [], "description": ""}, {"id": "ffe40b439db5", "fix": {"template": null, "available": false}, "title": "Arbitrary address with controlled calldata in low-level call - potential code injection", "ruleId": "rules.sol-arbitrary-low-level-call", "snippet": {"code": "        (bool success, ) = to.call{ value: value }(data);", "highlightLines": [69]}, "category": "code", "location": {"file": "contracts/contracts/levels/PuzzleWallet.sol", "line": 69, "column": 28}, "severity": "high", "references": ["https://blocksecteam.medium.com/li-fi-attack-a-cross-chain-bridge-vulnerability-no-its-due-to-unchecked-external-call-c31e7dadf60f"], "description": ""}, {"id": "f36d83afefc6", "fix": {"template": null, "available": false}, "title": "Low-level call without checking return value - silent failure possible", "ruleId": "rules.sol-unchecked-call-return", "snippet": {"code": "        (bool success, ) = to.call{ value: value }(data);", "highlightLines": [69]}, "category": "code", "location": {"file": "contracts/contracts/levels/PuzzleWallet.sol", "line": 69, "column": 30}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-104/", "https://blocksecteam.medium.com/li-fi-attack"], "description": ""}, {"id": "9c53cb23093f", "fix": {"template": null, "available": false}, "title": "State change after external call - potential reentrancy vulnerability", "ruleId": "rules.sol-external-call-state-change", "snippet": {"code": "        (bool success, ) = to.call{ value: value }(data);\n        require(success, \"Execution failed\");\n    }\n\n    function multicall(bytes[] calldata data) external payable onlyWhitelisted {\n        bool depositCalled = false;", "highlightLines": [69]}, "category": "code", "location": {"file": "contracts/contracts/levels/PuzzleWallet.sol", "line": 69, "column": 30}, "severity": "high", "references": ["https://consensys.github.io/smart-contract-best-practices/attacks/reentrancy/"], "description": ""}, {"id": "5c9c0376b604", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool depositCalled = false;", "highlightLines": [74]}, "category": "code", "location": {"file": "contracts/contracts/levels/PuzzleWallet.sol", "line": 74, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a43212a06536", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bool depositCalled = false;\n        for (uint256 i = 0; i < data.length; i++) {\n            bytes memory _data = data[i];\n            bytes4 selector;\n            assembly {\n                selector := mload(add(_data, 32))\n            }\n            if (selector == this.deposit.selector) {\n                require(!depositCalled, \"Deposit can only be called once\");\n                // Protect against reusing msg.value\n                depositCalled = true;\n            }\n            (bool success, ) = address(this).delegatecall(data[i]);\n            require(success, \"Error while delegating call\");\n        }", "highlightLines": [74]}, "category": "code", "location": {"file": "contracts/contracts/levels/PuzzleWallet.sol", "line": 74, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "bf379b7753ee", "fix": {"template": null, "available": false}, "title": "Struct copied to memory from mapping - modifications won't persist to storage", "ruleId": "rules.sol-memory-struct-from-mapping", "snippet": {"code": "            bytes memory _data = data[i];", "highlightLines": [76]}, "category": "code", "location": {"file": "contracts/contracts/levels/PuzzleWallet.sol", "line": 76, "column": 13}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/DataLocation.sol"], "description": ""}, {"id": "49f7d287bd5c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            bytes memory _data = data[i];\n            bytes4 selector;\n            assembly {\n                selector := mload(add(_data, 32))\n            }", "highlightLines": [76]}, "category": "code", "location": {"file": "contracts/contracts/levels/PuzzleWallet.sol", "line": 76, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "5aab52836e09", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            bytes4 selector;", "highlightLines": [77]}, "category": "code", "location": {"file": "contracts/contracts/levels/PuzzleWallet.sol", "line": 77, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e9c66de8b2bb", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "            assembly {", "highlightLines": [78]}, "category": "code", "location": {"file": "contracts/contracts/levels/PuzzleWallet.sol", "line": 78, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "5120940bed49", "fix": {"template": null, "available": false}, "title": "Delegatecall with user-controlled data - storage slot collision possible", "ruleId": "rules.sol-arbitrary-delegatecall-data", "snippet": {"code": "            (bool success, ) = address(this).delegatecall(data[i]);", "highlightLines": [86]}, "category": "code", "location": {"file": "contracts/contracts/levels/PuzzleWallet.sol", "line": 86, "column": 45}, "severity": "high", "references": [], "description": ""}, {"id": "3846dcb4d39a", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "contracts/contracts/levels/PuzzleWalletFactory.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "bacd344d4f30", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    PuzzleWallet walletLogic = new PuzzleWallet();\n\n    // deploy proxy and initialize implementation contract\n    bytes memory data = abi.encodeWithSelector(PuzzleWallet.init.selector, 100 ether);", "highlightLines": [14]}, "category": "code", "location": {"file": "contracts/contracts/levels/PuzzleWalletFactory.sol", "line": 14, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "54f2529b38a8", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    PuzzleWallet walletLogic = new PuzzleWallet();", "highlightLines": [14]}, "category": "code", "location": {"file": "contracts/contracts/levels/PuzzleWalletFactory.sol", "line": 14, "column": 32}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "b7c2f5d8e03c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    bytes memory data = abi.encodeWithSelector(PuzzleWallet.init.selector, 100 ether);\n    PuzzleProxy proxy = new PuzzleProxy(address(this), address(walletLogic), data);", "highlightLines": [17]}, "category": "code", "location": {"file": "contracts/contracts/levels/PuzzleWalletFactory.sol", "line": 17, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "c7276f21253a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    PuzzleProxy proxy = new PuzzleProxy(address(this), address(walletLogic), data);\n    PuzzleWallet instance = PuzzleWallet(address(proxy));", "highlightLines": [18]}, "category": "code", "location": {"file": "contracts/contracts/levels/PuzzleWalletFactory.sol", "line": 18, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "7725d44f01b8", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    PuzzleProxy proxy = new PuzzleProxy(address(this), address(walletLogic), data);", "highlightLines": [18]}, "category": "code", "location": {"file": "contracts/contracts/levels/PuzzleWalletFactory.sol", "line": 18, "column": 25}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "b9263e6aa034", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "  function validateInstance(address payable _instance, address _player) override public view returns (bool) {\n    PuzzleProxy proxy = PuzzleProxy(_instance);", "highlightLines": [28]}, "category": "code", "location": {"file": "contracts/contracts/levels/PuzzleWalletFactory.sol", "line": 28, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "d7084822ccf1", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "contracts/contracts/levels/Recovery.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "c221c5ce1739", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    new SimpleToken(_name, msg.sender, _initialSupply);", "highlightLines": [8]}, "category": "code", "location": {"file": "contracts/contracts/levels/Recovery.sol", "line": 8, "column": 5}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "b89d5bff7b14", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  constructor(string memory _name, address _creator, uint256 _initialSupply) {\n    name = _name;\n    balances[_creator] = _initialSupply;\n  }", "highlightLines": [19]}, "category": "code", "location": {"file": "contracts/contracts/levels/Recovery.sol", "line": 19, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "1b49c1814f02", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    name = _name;\n    balances[_creator] = _initialSupply;", "highlightLines": [20]}, "category": "code", "location": {"file": "contracts/contracts/levels/Recovery.sol", "line": 20, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "25c34b261cb8", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "  receive() external payable {", "highlightLines": [25]}, "category": "code", "location": {"file": "contracts/contracts/levels/Recovery.sol", "line": 25, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "eaae5c5e5984", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "  function transfer(address _to, uint _amount) public {", "highlightLines": [30]}, "category": "code", "location": {"file": "contracts/contracts/levels/Recovery.sol", "line": 30, "column": 3}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "82b332747419", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without msg.data.length validation - vulnerable to short address attack padding", "ruleId": "rules.sol-short-address-no-payload-check", "snippet": {"code": "  function transfer(address _to, uint _amount) public {", "highlightLines": [30]}, "category": "code", "location": {"file": "contracts/contracts/levels/Recovery.sol", "line": 30, "column": 3}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address", "https://vessenes.com/the-erc20-short-address-attack-explained/"], "description": ""}, {"id": "00bd1013e062", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(balances[msg.sender] >= _amount);", "highlightLines": [31]}, "category": "code", "location": {"file": "contracts/contracts/levels/Recovery.sol", "line": 31, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "5594fda2ce98", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    balances[msg.sender] = balances[msg.sender] - _amount;\n    balances[_to] = _amount;", "highlightLines": [32]}, "category": "code", "location": {"file": "contracts/contracts/levels/Recovery.sol", "line": 32, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "c9bdddd4c4c5", "fix": {"template": null, "available": false}, "title": "Contract can be destructed by anyone - missing access control on selfdestruct", "ruleId": "rules.sol-accessible-selfdestruct", "snippet": {"code": "    selfdestruct(_to);", "highlightLines": [38]}, "category": "code", "location": {"file": "contracts/contracts/levels/Recovery.sol", "line": 38, "column": 5}, "severity": "high", "references": ["https://www.parity.io/blog/a-postmortem-on-the-parity-multi-sig-library-self-destruct/"], "description": ""}, {"id": "e9c3ba3f599e", "fix": {"template": null, "available": false}, "title": "Selfdestruct with user-controlled recipient - funds can be sent anywhere", "ruleId": "rules.sol-selfdestruct-arbitrary", "snippet": {"code": "    selfdestruct(_to);", "highlightLines": [38]}, "category": "code", "location": {"file": "contracts/contracts/levels/Recovery.sol", "line": 38, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "87e716aee72a", "fix": {"template": null, "available": false}, "title": "selfdestruct can force ETH to any address - contracts cannot prevent receiving ETH this way (Force pattern)", "ruleId": "rules.sol-selfdestruct-force-eth", "snippet": {"code": "    selfdestruct(_to);", "highlightLines": [38]}, "category": "code", "location": {"file": "contracts/contracts/levels/Recovery.sol", "line": 38, "column": 5}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/7"], "description": ""}, {"id": "8b790e2b983e", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "contracts/contracts/levels/RecoveryFactory.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "bc8faebdc1fb", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    recoveryInstance = new Recovery();\n    // create a simple token \n    recoveryInstance.generateToken(\"InitialToken\", uint(100000));\n    // the lost address\n    lostAddress[address(recoveryInstance)] = address(uint160(uint256(keccak256(abi.encodePacked(uint8(0xd6), uint8(0x94), recoveryInstance, uint8(0x01))))));", "highlightLines": [16]}, "category": "code", "location": {"file": "contracts/contracts/levels/RecoveryFactory.sol", "line": 16, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "99f09f773b32", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    recoveryInstance = new Recovery();", "highlightLines": [16]}, "category": "code", "location": {"file": "contracts/contracts/levels/RecoveryFactory.sol", "line": 16, "column": 24}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "b65306bee9a5", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "    recoveryInstance.generateToken(\"InitialToken\", uint(100000));", "highlightLines": [18]}, "category": "code", "location": {"file": "contracts/contracts/levels/RecoveryFactory.sol", "line": 18, "column": 52}, "severity": "info", "references": [], "description": ""}, {"id": "3958562fa2ed", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    lostAddress[address(recoveryInstance)] = address(uint160(uint256(keccak256(abi.encodePacked(uint8(0xd6), uint8(0x94), recoveryInstance, uint8(0x01))))));\n    // Send it some ether\n    (bool result,) = lostAddress[address(recoveryInstance)].call{value: msg.value}(\"\");", "highlightLines": [20]}, "category": "code", "location": {"file": "contracts/contracts/levels/RecoveryFactory.sol", "line": 20, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "71788f6f2819", "fix": {"template": null, "available": false}, "title": "keccak256 of uint8 has only 256 possibilities - trivially brute-forceable (GuessTheSecretNumber pattern)", "ruleId": "rules.sol-small-space-keccak", "snippet": {"code": "    lostAddress[address(recoveryInstance)] = address(uint160(uint256(keccak256(abi.encodePacked(uint8(0xd6), uint8(0x94), recoveryInstance, uint8(0x01))))));", "highlightLines": [20]}, "category": "code", "location": {"file": "contracts/contracts/levels/RecoveryFactory.sol", "line": 20, "column": 70}, "severity": "medium", "references": ["https://capturetheether.com/challenges/lottery/guess-secret-number/"], "description": ""}, {"id": "b40585a4bf36", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "    lostAddress[address(recoveryInstance)] = address(uint160(uint256(keccak256(abi.encodePacked(uint8(0xd6), uint8(0x94), recoveryInstance, uint8(0x01))))));", "highlightLines": [20]}, "category": "code", "location": {"file": "contracts/contracts/levels/RecoveryFactory.sol", "line": 20, "column": 70}, "severity": "high", "references": [], "description": ""}, {"id": "ae4175ba61f2", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "    lostAddress[address(recoveryInstance)] = address(uint160(uint256(keccak256(abi.encodePacked(uint8(0xd6), uint8(0x94), recoveryInstance, uint8(0x01))))));", "highlightLines": [20]}, "category": "code", "location": {"file": "contracts/contracts/levels/RecoveryFactory.sol", "line": 20, "column": 80}, "severity": "medium", "references": [], "description": ""}, {"id": "947035e17514", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "    lostAddress[address(recoveryInstance)] = address(uint160(uint256(keccak256(abi.encodePacked(uint8(0xd6), uint8(0x94), recoveryInstance, uint8(0x01))))));", "highlightLines": [20]}, "category": "code", "location": {"file": "contracts/contracts/levels/RecoveryFactory.sol", "line": 20, "column": 97}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "66c2db2f3fa8", "fix": {"template": null, "available": false}, "title": "Low-level call without checking return value - silent failure possible", "ruleId": "rules.sol-unchecked-call-return", "snippet": {"code": "    (bool result,) = lostAddress[address(recoveryInstance)].call{value: msg.value}(\"\");", "highlightLines": [22]}, "category": "code", "location": {"file": "contracts/contracts/levels/RecoveryFactory.sol", "line": 22, "column": 60}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-104/", "https://blocksecteam.medium.com/li-fi-attack"], "description": ""}, {"id": "82274fca78e0", "fix": {"template": null, "available": false}, "title": "State change after external call - potential reentrancy vulnerability", "ruleId": "rules.sol-external-call-state-change", "snippet": {"code": "    (bool result,) = lostAddress[address(recoveryInstance)].call{value: msg.value}(\"\");\n    require(result);\n\n    return address(recoveryInstance);\n  }\n\n  function validateInstance(address payable _instance, address) override public view returns (bool) {\n    return address(lostAddress[_instance]).balance == 0;", "highlightLines": [22]}, "category": "code", "location": {"file": "contracts/contracts/levels/RecoveryFactory.sol", "line": 22, "column": 60}, "severity": "high", "references": ["https://consensys.github.io/smart-contract-best-practices/attacks/reentrancy/"], "description": ""}, {"id": "3e2d0c3af7ca", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(result);", "highlightLines": [23]}, "category": "code", "location": {"file": "contracts/contracts/levels/RecoveryFactory.sol", "line": 23, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "993ad1fefb08", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "contracts/contracts/levels/RecoverySimpleToken.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "8567ebb3a789", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  constructor(string memory _name, address _creator, uint256 _initialSupply) {\n    name = _name;\n    balances[_creator] = _initialSupply;\n  }", "highlightLines": [11]}, "category": "code", "location": {"file": "contracts/contracts/levels/RecoverySimpleToken.sol", "line": 11, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "95ca43e05d1a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    name = _name;\n    balances[_creator] = _initialSupply;", "highlightLines": [12]}, "category": "code", "location": {"file": "contracts/contracts/levels/RecoverySimpleToken.sol", "line": 12, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "617b7aa512b8", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "  receive() external payable {", "highlightLines": [17]}, "category": "code", "location": {"file": "contracts/contracts/levels/RecoverySimpleToken.sol", "line": 17, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "6fb5b1a1b3f1", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "  function transfer(address _to, uint _amount) public {", "highlightLines": [22]}, "category": "code", "location": {"file": "contracts/contracts/levels/RecoverySimpleToken.sol", "line": 22, "column": 3}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "51ea992c400f", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without msg.data.length validation - vulnerable to short address attack padding", "ruleId": "rules.sol-short-address-no-payload-check", "snippet": {"code": "  function transfer(address _to, uint _amount) public {", "highlightLines": [22]}, "category": "code", "location": {"file": "contracts/contracts/levels/RecoverySimpleToken.sol", "line": 22, "column": 3}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address", "https://vessenes.com/the-erc20-short-address-attack-explained/"], "description": ""}, {"id": "2029d9493df3", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(balances[msg.sender] >= _amount);", "highlightLines": [23]}, "category": "code", "location": {"file": "contracts/contracts/levels/RecoverySimpleToken.sol", "line": 23, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "c4ed4d9d351b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    balances[msg.sender] = balances[msg.sender] - _amount;\n    balances[_to] = _amount;", "highlightLines": [24]}, "category": "code", "location": {"file": "contracts/contracts/levels/RecoverySimpleToken.sol", "line": 24, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "44398e59b558", "fix": {"template": null, "available": false}, "title": "Contract can be destructed by anyone - missing access control on selfdestruct", "ruleId": "rules.sol-accessible-selfdestruct", "snippet": {"code": "    selfdestruct(to);", "highlightLines": [30]}, "category": "code", "location": {"file": "contracts/contracts/levels/RecoverySimpleToken.sol", "line": 30, "column": 5}, "severity": "high", "references": ["https://www.parity.io/blog/a-postmortem-on-the-parity-multi-sig-library-self-destruct/"], "description": ""}, {"id": "c62cb6d6ea9c", "fix": {"template": null, "available": false}, "title": "Selfdestruct with user-controlled recipient - funds can be sent anywhere", "ruleId": "rules.sol-selfdestruct-arbitrary", "snippet": {"code": "    selfdestruct(to);", "highlightLines": [30]}, "category": "code", "location": {"file": "contracts/contracts/levels/RecoverySimpleToken.sol", "line": 30, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "e52cadcc755f", "fix": {"template": null, "available": false}, "title": "selfdestruct can force ETH to any address - contracts cannot prevent receiving ETH this way (Force pattern)", "ruleId": "rules.sol-selfdestruct-force-eth", "snippet": {"code": "    selfdestruct(to);", "highlightLines": [30]}, "category": "code", "location": {"file": "contracts/contracts/levels/RecoverySimpleToken.sol", "line": 30, "column": 5}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/7"], "description": ""}, {"id": "9213b034f4f5", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.6.12;", "highlightLines": [2]}, "category": "code", "location": {"file": "contracts/contracts/levels/Reentrance.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "1413eba642cc", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "  function withdraw(uint _amount) public {", "highlightLines": [19]}, "category": "code", "location": {"file": "contracts/contracts/levels/Reentrance.sol", "line": 19, "column": 3}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "db8364704c00", "fix": {"template": null, "available": false}, "title": "Low-level call without checking return value - silent failure possible", "ruleId": "rules.sol-unchecked-call-return", "snippet": {"code": "      (bool result,) = msg.sender.call{value:_amount}(\"\");", "highlightLines": [21]}, "category": "code", "location": {"file": "contracts/contracts/levels/Reentrance.sol", "line": 21, "column": 34}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-104/", "https://blocksecteam.medium.com/li-fi-attack"], "description": ""}, {"id": "8902b6cd3b60", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _amount;", "highlightLines": [23]}, "category": "code", "location": {"file": "contracts/contracts/levels/Reentrance.sol", "line": 23, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "0fe3ca1dc8dd", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "  receive() external payable {}", "highlightLines": [29]}, "category": "code", "location": {"file": "contracts/contracts/levels/Reentrance.sol", "line": 29, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "a71ca3e5ff40", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "  receive() external payable {}", "highlightLines": [29]}, "category": "code", "location": {"file": "contracts/contracts/levels/Reentrance.sol", "line": 29, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "6985360e19c9", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.6.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "contracts/contracts/levels/ReentranceFactory.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "f19a1cbedc78", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract ReentranceFactory is Level {\n\n  uint public insertCoin = 0.001 ether;", "highlightLines": [8]}, "category": "code", "location": {"file": "contracts/contracts/levels/ReentranceFactory.sol", "line": 8, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "d65053215049", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    _player;", "highlightLines": [13]}, "category": "code", "location": {"file": "contracts/contracts/levels/ReentranceFactory.sol", "line": 13, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "ebac3da27812", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(msg.value >= insertCoin);", "highlightLines": [14]}, "category": "code", "location": {"file": "contracts/contracts/levels/ReentranceFactory.sol", "line": 14, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "00c60d50b320", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    Reentrance instance = new Reentrance();", "highlightLines": [15]}, "category": "code", "location": {"file": "contracts/contracts/levels/ReentranceFactory.sol", "line": 15, "column": 27}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "5e40c7890f41", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(address(this).balance >= insertCoin);", "highlightLines": [16]}, "category": "code", "location": {"file": "contracts/contracts/levels/ReentranceFactory.sol", "line": 16, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "262ae1b45345", "fix": {"template": null, "available": false}, "title": "ETH balance check without accounting for selfdestruct donations - can be manipulated", "ruleId": "rules.sol-eth-balance-accounting", "snippet": {"code": "    require(address(this).balance >= insertCoin);", "highlightLines": [16]}, "category": "code", "location": {"file": "contracts/contracts/levels/ReentranceFactory.sol", "line": 16, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "4378303168d7", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "    address(instance).transfer(insertCoin);", "highlightLines": [17]}, "category": "code", "location": {"file": "contracts/contracts/levels/ReentranceFactory.sol", "line": 17, "column": 5}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "8fd7f88177e5", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    _player;", "highlightLines": [22]}, "category": "code", "location": {"file": "contracts/contracts/levels/ReentranceFactory.sol", "line": 22, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "b097d6cda583", "fix": {"template": null, "available": false}, "title": "Contract can receive ETH but has no withdraw function - funds may be permanently locked", "ruleId": "rules.sol-locked-ether", "snippet": {"code": "  receive() external payable {}", "highlightLines": [27]}, "category": "code", "location": {"file": "contracts/contracts/levels/ReentranceFactory.sol", "line": 27, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#contracts-that-lock-ether"], "description": ""}, {"id": "aada7f09f6ce", "fix": {"template": null, "available": false}, "title": "Contract has receive() but may lack withdrawal function - funds can get stuck", "ruleId": "rules.sol-receive-without-withdraw", "snippet": {"code": "  receive() external payable {}", "highlightLines": [27]}, "category": "code", "location": {"file": "contracts/contracts/levels/ReentranceFactory.sol", "line": 27, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "36aef46ded0b", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "contracts/contracts/levels/Shop.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "67568cca2df3", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "  function price() external view returns (uint);\n}\n\ncontract Shop {\n  uint public price = 100;\n  bool public isSold;\n\n  function buy() public {\n    Buyer _buyer = Buyer(msg.sender);\n\n    if (_buyer.price() >= price && !isSold) {\n      isSold = true;\n      price = _buyer.price();", "highlightLines": [5]}, "category": "code", "location": {"file": "contracts/contracts/levels/Shop.sol", "line": 5, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "b5279f7c780f", "fix": {"template": null, "available": false}, "title": "Token swap/buy without slippage protection - MEV/sandwich attack risk", "ruleId": "rules.sol-missing-slippage-protection", "snippet": {"code": "  function buy() public {", "highlightLines": [12]}, "category": "code", "location": {"file": "contracts/contracts/levels/Shop.sol", "line": 12, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "03474aabfc2a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    Buyer _buyer = Buyer(msg.sender);\n\n    if (_buyer.price() >= price && !isSold) {\n      isSold = true;\n      price = _buyer.price();\n    }", "highlightLines": [13]}, "category": "code", "location": {"file": "contracts/contracts/levels/Shop.sol", "line": 13, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "4706d177de3a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "      isSold = true;\n      price = _buyer.price();", "highlightLines": [16]}, "category": "code", "location": {"file": "contracts/contracts/levels/Shop.sol", "line": 16, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "3dfef1d219d8", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "contracts/contracts/levels/ShopFactory.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "9a2ae61dbeb2", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    _player;", "highlightLines": [11]}, "category": "code", "location": {"file": "contracts/contracts/levels/ShopFactory.sol", "line": 11, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "344eeeeead1d", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    Shop _shop = new Shop();", "highlightLines": [12]}, "category": "code", "location": {"file": "contracts/contracts/levels/ShopFactory.sol", "line": 12, "column": 18}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "ebc3e8acdceb", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "  function validateInstance(address payable _instance, address) override public view returns (bool) {\n    Shop _shop = Shop(_instance);", "highlightLines": [16]}, "category": "code", "location": {"file": "contracts/contracts/levels/ShopFactory.sol", "line": 16, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "897746313ba7", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "contracts/contracts/levels/Switch.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "2f6e473d71f2", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "     modifier onlyThis() {\n        require(msg.sender == address(this), \"Only the contract can call this\");\n        _;\n    }", "highlightLines": [8]}, "category": "code", "location": {"file": "contracts/contracts/levels/Switch.sol", "line": 8, "column": 6}, "severity": "medium", "references": [], "description": ""}, {"id": "6613e1bd6868", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "     modifier onlyThis() {\n        require(msg.sender == address(this), \"Only the contract can call this\");\n        _;\n    }", "highlightLines": [8]}, "category": "code", "location": {"file": "contracts/contracts/levels/Switch.sol", "line": 8, "column": 6}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "7fb6952b934f", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [10]}, "category": "code", "location": {"file": "contracts/contracts/levels/Switch.sol", "line": 10, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "fc8633ac9813", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyOff() {\n        // we use a complex data type to put in memory\n        bytes32[1] memory selector;\n        // check that the calldata at position 68 (location of _data)\n        assembly {\n            calldatacopy(selector, 68, 4) // grab function selector from calldata\n        }\n        require(\n            selector[0] == offSelector,\n            \"Can only call the turnOffSwitch function\"\n        );\n        _;\n    }", "highlightLines": [13]}, "category": "code", "location": {"file": "contracts/contracts/levels/Switch.sol", "line": 13, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "ecae055ea579", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [17]}, "category": "code", "location": {"file": "contracts/contracts/levels/Switch.sol", "line": 17, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "bc11fe633f9f", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [24]}, "category": "code", "location": {"file": "contracts/contracts/levels/Switch.sol", "line": 24, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "50fe301acfaf", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "contracts/contracts/levels/SwitchFactory.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "dd6abd7b40f1", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _player;", "highlightLines": [14]}, "category": "code", "location": {"file": "contracts/contracts/levels/SwitchFactory.sol", "line": 14, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "fce670792457", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        Switch _switch = new Switch();", "highlightLines": [15]}, "category": "code", "location": {"file": "contracts/contracts/levels/SwitchFactory.sol", "line": 15, "column": 26}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "9e6675297607", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function validateInstance(address payable _instance, address _player)\n        public\n        view\n        override\n        returns (bool)\n    {\n        _player;\n        Switch _switch = Switch(_instance);", "highlightLines": [19]}, "category": "code", "location": {"file": "contracts/contracts/levels/SwitchFactory.sol", "line": 19, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "7cd428adc619", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _player;", "highlightLines": [25]}, "category": "code", "location": {"file": "contracts/contracts/levels/SwitchFactory.sol", "line": 25, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "3c374cf702a6", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "contracts/contracts/levels/Telephone.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "b60fa7764869", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  constructor() {\n    owner = msg.sender;\n  }", "highlightLines": [8]}, "category": "code", "location": {"file": "contracts/contracts/levels/Telephone.sol", "line": 8, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "f0420a2763af", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "    owner = msg.sender;", "highlightLines": [9]}, "category": "code", "location": {"file": "contracts/contracts/levels/Telephone.sol", "line": 9, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "31653346474a", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "  function changeOwner(address _owner) public {", "highlightLines": [12]}, "category": "code", "location": {"file": "contracts/contracts/levels/Telephone.sol", "line": 12, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "5eb01e71c3c8", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "      owner = _owner;", "highlightLines": [14]}, "category": "code", "location": {"file": "contracts/contracts/levels/Telephone.sol", "line": 14, "column": 7}, "severity": "info", "references": [], "description": ""}, {"id": "b04de6b09d0b", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "contracts/contracts/levels/TelephoneFactory.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "a75807a892ad", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    _player;", "highlightLines": [11]}, "category": "code", "location": {"file": "contracts/contracts/levels/TelephoneFactory.sol", "line": 11, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "f6fb8a354f72", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    Telephone instance = new Telephone();", "highlightLines": [12]}, "category": "code", "location": {"file": "contracts/contracts/levels/TelephoneFactory.sol", "line": 12, "column": 26}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "e926565b4fb7", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "  function validateInstance(address payable _instance, address _player) override public view returns (bool) {\n    Telephone instance = Telephone(_instance);", "highlightLines": [16]}, "category": "code", "location": {"file": "contracts/contracts/levels/TelephoneFactory.sol", "line": 16, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "85ab1eeb3943", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.6.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "contracts/contracts/levels/Token.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "9391814730b0", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "  function transfer(address _to, uint _value) public returns (bool) {", "highlightLines": [13]}, "category": "code", "location": {"file": "contracts/contracts/levels/Token.sol", "line": 13, "column": 3}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "b1250270317a", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without msg.data.length validation - vulnerable to short address attack padding", "ruleId": "rules.sol-short-address-no-payload-check", "snippet": {"code": "  function transfer(address _to, uint _value) public returns (bool) {", "highlightLines": [13]}, "category": "code", "location": {"file": "contracts/contracts/levels/Token.sol", "line": 13, "column": 3}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address", "https://vessenes.com/the-erc20-short-address-attack-explained/"], "description": ""}, {"id": "6d64605dd659", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "  function transfer(address _to, uint _value) public returns (bool) {\n    require(balances[msg.sender] - _value >= 0);", "highlightLines": [13]}, "category": "code", "location": {"file": "contracts/contracts/levels/Token.sol", "line": 13, "column": 3}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "c9ab8b4d0cce", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - will never return false, only revert", "ruleId": "rules.sol-return-bool-always-reverts", "snippet": {"code": "  function transfer(address _to, uint _value) public returns (bool) {\n    require(balances[msg.sender] - _value >= 0);\n    balances[msg.sender] -= _value;\n    balances[_to] += _value;\n    return true;\n  }", "highlightLines": [13]}, "category": "code", "location": {"file": "contracts/contracts/levels/Token.sol", "line": 13, "column": 3}, "severity": "info", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "2e41b3669cec", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(balances[msg.sender] - _value >= 0);", "highlightLines": [14]}, "category": "code", "location": {"file": "contracts/contracts/levels/Token.sol", "line": 14, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "f06ff082d1bd", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.6.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "contracts/contracts/levels/TokenFactory.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "c68967b390e2", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract TokenFactory is Level {\n\n  uint supply = 21000000;\n  uint playerSupply = 20;", "highlightLines": [8]}, "category": "code", "location": {"file": "contracts/contracts/levels/TokenFactory.sol", "line": 8, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "2b121307f587", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n  uint supply = 21000000;", "highlightLines": [9]}, "category": "code", "location": {"file": "contracts/contracts/levels/TokenFactory.sol", "line": 9, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3119f33646cb", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "  uint playerSupply = 20;", "highlightLines": [11]}, "category": "code", "location": {"file": "contracts/contracts/levels/TokenFactory.sol", "line": 11, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4d82db316357", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    Token token = new Token(supply);", "highlightLines": [14]}, "category": "code", "location": {"file": "contracts/contracts/levels/TokenFactory.sol", "line": 14, "column": 19}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "ac5990f06857", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "    token.transfer(_player, playerSupply);", "highlightLines": [15]}, "category": "code", "location": {"file": "contracts/contracts/levels/TokenFactory.sol", "line": 15, "column": 5}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "cfa7d6b84472", "fix": {"template": null, "available": false}, "title": "Missing zero address validation - tokens/ETH could be lost", "ruleId": "rules.sol-missing-zero-address-check", "snippet": {"code": "    token.transfer(_player, playerSupply);", "highlightLines": [15]}, "category": "code", "location": {"file": "contracts/contracts/levels/TokenFactory.sol", "line": 15, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "b670ec785a45", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "    token.transfer(_player, playerSupply);", "highlightLines": [15]}, "category": "code", "location": {"file": "contracts/contracts/levels/TokenFactory.sol", "line": 15, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "da2b0c47b2ce", "fix": {"template": null, "available": false}, "title": "ERC20 transfer() return value not checked - tokens like USDT don't return bool", "ruleId": "rules.sol-erc20-transfer-no-return-check", "snippet": {"code": "    token.transfer(_player, playerSupply);", "highlightLines": [15]}, "category": "code", "location": {"file": "contracts/contracts/levels/TokenFactory.sol", "line": 15, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "d08e65595674", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "    token.transfer(_player, playerSupply);", "highlightLines": [15]}, "category": "code", "location": {"file": "contracts/contracts/levels/TokenFactory.sol", "line": 15, "column": 21}, "severity": "info", "references": [], "description": ""}, {"id": "56fca23fa9b4", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "contracts/contracts/levels/Vault.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "4890211dd5ec", "fix": {"template": null, "available": false}, "title": "Private variables are readable on-chain via eth_getStorageAt - do not store secrets (Vault pattern)", "ruleId": "rules.sol-private-not-hidden", "snippet": {"code": "  bytes32 private password;", "highlightLines": [6]}, "category": "code", "location": {"file": "contracts/contracts/levels/Vault.sol", "line": 6, "column": 3}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/8"], "description": ""}, {"id": "65cab66cf168", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  constructor(bytes32 _password) {\n    locked = true;\n    password = _password;\n  }", "highlightLines": [8]}, "category": "code", "location": {"file": "contracts/contracts/levels/Vault.sol", "line": 8, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "aaa0a5f7f9da", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    locked = true;\n    password = _password;", "highlightLines": [9]}, "category": "code", "location": {"file": "contracts/contracts/levels/Vault.sol", "line": 9, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "e82f1e3a5fa8", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "contracts/contracts/levels/VaultFactory.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "9c7a1b854f7a", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract VaultFactory is Level {\n\n  function createInstance(address _player) override public payable returns (address) {\n    _player;\n    bytes32 password = \"A very strong secret password :)\";", "highlightLines": [8]}, "category": "code", "location": {"file": "contracts/contracts/levels/VaultFactory.sol", "line": 8, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "9d92fb2c3fe4", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    _player;", "highlightLines": [11]}, "category": "code", "location": {"file": "contracts/contracts/levels/VaultFactory.sol", "line": 11, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "793dfe5c93bf", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    bytes32 password = \"A very strong secret password :)\";", "highlightLines": [12]}, "category": "code", "location": {"file": "contracts/contracts/levels/VaultFactory.sol", "line": 12, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "268d08f5385a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    bytes32 password = \"A very strong secret password :)\";\n    Vault instance = new Vault(password);", "highlightLines": [12]}, "category": "code", "location": {"file": "contracts/contracts/levels/VaultFactory.sol", "line": 12, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "b718034f3915", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    Vault instance = new Vault(password);", "highlightLines": [13]}, "category": "code", "location": {"file": "contracts/contracts/levels/VaultFactory.sol", "line": 13, "column": 22}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "56d02a80ae35", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "  function validateInstance(address payable _instance, address) override public view returns (bool) {\n    Vault instance = Vault(_instance);", "highlightLines": [17]}, "category": "code", "location": {"file": "contracts/contracts/levels/VaultFactory.sol", "line": 17, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "cdd92d97edd6", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.5.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "contracts/contracts/levels/base/Level-05.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "62953a6f4570", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function createInstance(address _player) public payable returns (address);", "highlightLines": [8]}, "category": "code", "location": {"file": "contracts/contracts/levels/base/Level-05.sol", "line": 8, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "ba86409aeea6", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.6.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "contracts/contracts/levels/base/Level-06.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "c96abb8f5176", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function createInstance(address _player) virtual public payable returns (address);", "highlightLines": [8]}, "category": "code", "location": {"file": "contracts/contracts/levels/base/Level-06.sol", "line": 8, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "7ff67a801c6e", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "contracts/contracts/levels/base/Level-08.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "1a88bfcbe257", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function createInstance(address _player) virtual public payable returns (address);", "highlightLines": [8]}, "category": "code", "location": {"file": "contracts/contracts/levels/base/Level-08.sol", "line": 8, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "b3fce1abf9f9", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "contracts/contracts/levels/base/Level.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "82f81a25b3d2", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function createInstance(address _player) virtual public payable returns (address);", "highlightLines": [8]}, "category": "code", "location": {"file": "contracts/contracts/levels/base/Level.sol", "line": 8, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "c78ed37da176", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "contracts/contracts/metrics/Statistics.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "7d08c3405e4a", "fix": {"template": null, "available": false}, "title": "Upgradeable contract without storage gap - future upgrade collision risk", "ruleId": "rules.sol-no-gap-storage", "snippet": {"code": "contract Statistics is Initializable {", "highlightLines": [4]}, "category": "code", "location": {"file": "contracts/contracts/metrics/Statistics.sol", "line": 4, "column": 1}, "severity": "info", "references": ["https://docs.openzeppelin.com/contracts/4.x/upgradeable#storage_gaps"], "description": ""}, {"id": "9eb935bce938", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract Statistics is Initializable {\n    address public ethernaut;\n    address[] public players;\n    address[] public levels;\n    uint256 private globalNoOfInstancesCreated;\n    uint256 private globalNoOfInstancesCompleted;\n    uint256 private globalNoOfFailedSubmissions;\n    struct LevelInstance {\n        address instance;\n        bool isCompleted;\n        uint256 timeCreated;\n        uint256 timeCompleted;", "highlightLines": [4]}, "category": "code", "location": {"file": "contracts/contracts/metrics/Statistics.sol", "line": 4, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "a2052c174384", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address instance;", "highlightLines": [12]}, "category": "code", "location": {"file": "contracts/contracts/metrics/Statistics.sol", "line": 12, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7bceda2ca870", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool isCompleted;", "highlightLines": [13]}, "category": "code", "location": {"file": "contracts/contracts/metrics/Statistics.sol", "line": 13, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "84565898a56b", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 timeCreated;", "highlightLines": [14]}, "category": "code", "location": {"file": "contracts/contracts/metrics/Statistics.sol", "line": 14, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4e6759b08c8c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 timeCompleted;", "highlightLines": [15]}, "category": "code", "location": {"file": "contracts/contracts/metrics/Statistics.sol", "line": 15, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "39d458f8e1c1", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 noOfInstancesCreated;", "highlightLines": [19]}, "category": "code", "location": {"file": "contracts/contracts/metrics/Statistics.sol", "line": 19, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a6cf5061058c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 noOfInstancesSubmitted_Success;", "highlightLines": [20]}, "category": "code", "location": {"file": "contracts/contracts/metrics/Statistics.sol", "line": 20, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8ea5e642b0df", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 noOfSubmissions_Failed;", "highlightLines": [21]}, "category": "code", "location": {"file": "contracts/contracts/metrics/Statistics.sol", "line": 21, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8be6ce5a11af", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event playerScoreProfile(address indexed player, uint256 indexed averageCompletionTime, uint256 indexed globalLevelsCompleted);", "highlightLines": [34]}, "category": "code", "location": {"file": "contracts/contracts/metrics/Statistics.sol", "line": 34, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "40dfaa3a0fbe", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier levelExistsCheck(address level) {\n        require(doesLevelExist(level), \"Level doesn't exist\");\n        _;\n    }", "highlightLines": [35]}, "category": "code", "location": {"file": "contracts/contracts/metrics/Statistics.sol", "line": 35, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "338d5921eac0", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [37]}, "category": "code", "location": {"file": "contracts/contracts/metrics/Statistics.sol", "line": 37, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "460edd4cf33e", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier levelDoesntExistCheck(address level) {\n        require(!doesLevelExist(level), \"Level already exists\");\n        _;\n    }", "highlightLines": [39]}, "category": "code", "location": {"file": "contracts/contracts/metrics/Statistics.sol", "line": 39, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "ce19c1a68fb6", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [41]}, "category": "code", "location": {"file": "contracts/contracts/metrics/Statistics.sol", "line": 41, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "bdbe2c99148e", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier playerExistsCheck(address player) {\n        require(doesPlayerExist(player), \"Player doesn't exist\");\n        _;\n    }", "highlightLines": [43]}, "category": "code", "location": {"file": "contracts/contracts/metrics/Statistics.sol", "line": 43, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "cf3f5dc22240", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [45]}, "category": "code", "location": {"file": "contracts/contracts/metrics/Statistics.sol", "line": 45, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "4c6891037ff5", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyEthernaut() {\n        require(\n            msg.sender == ethernaut,\n            \"Only Ethernaut can call this function\"\n        );\n        _;\n    }", "highlightLines": [47]}, "category": "code", "location": {"file": "contracts/contracts/metrics/Statistics.sol", "line": 47, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "3122fff81375", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "    modifier onlyEthernaut() {\n        require(\n            msg.sender == ethernaut,\n            \"Only Ethernaut can call this function\"\n        );\n        _;\n    }", "highlightLines": [47]}, "category": "code", "location": {"file": "contracts/contracts/metrics/Statistics.sol", "line": 47, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "0b8e915a5907", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [52]}, "category": "code", "location": {"file": "contracts/contracts/metrics/Statistics.sol", "line": 52, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "9320016877cd", "fix": {"template": null, "available": false}, "title": "Initializer function not protected - can be called multiple times", "ruleId": "rules.sol-initializer-not-protected", "snippet": {"code": "    function initialize(address _ethernautAddress) public initializer {", "highlightLines": [54]}, "category": "code", "location": {"file": "contracts/contracts/metrics/Statistics.sol", "line": 54, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "b9db050ee519", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "            levelFirstInstanceCreationTime[player][level] = block.timestamp;", "highlightLines": [69]}, "category": "code", "location": {"file": "contracts/contracts/metrics/Statistics.sol", "line": 69, "column": 61}, "severity": "medium", "references": [], "description": ""}, {"id": "ea879d12e237", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "            block.timestamp,", "highlightLines": [74]}, "category": "code", "location": {"file": "contracts/contracts/metrics/Statistics.sol", "line": 74, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "ce34197646bf", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function submitSuccess(\n        address instance,\n        address level,\n        address player\n    ) external onlyEthernaut levelExistsCheck(level) playerExistsCheck(player) {\n        require(\n            playerStats[player][level].instance != address(0),\n            \"Instance for the level is not created\"\n        );\n        require(\n            playerStats[player][level].instance == instance,", "highlightLines": [84]}, "category": "code", "location": {"file": "contracts/contracts/metrics/Statistics.sol", "line": 84, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "39a46c9da0c2", "fix": {"template": null, "available": false}, "title": "Unnecessary comparison to boolean constant - use variable directly", "ruleId": "rules.sol-boolean-constant-comparison", "snippet": {"code": "            playerStats[player][level].isCompleted == false,", "highlightLines": [98]}, "category": "code", "location": {"file": "contracts/contracts/metrics/Statistics.sol", "line": 98, "column": 52}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#boolean-equality"], "description": ""}, {"id": "5f6b591196bc", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            levelFirstCompletionTime[player][level] = block.timestamp;\n            uint256 totalNoOfLevelsCompletedByPlayer = globalNoOfLevelsCompletedByPlayer[player];", "highlightLines": [104]}, "category": "code", "location": {"file": "contracts/contracts/metrics/Statistics.sol", "line": 104, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "a9af8046760f", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "            levelFirstCompletionTime[player][level] = block.timestamp;", "highlightLines": [104]}, "category": "code", "location": {"file": "contracts/contracts/metrics/Statistics.sol", "line": 104, "column": 55}, "severity": "medium", "references": [], "description": ""}, {"id": "19ea349d8328", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint256 totalNoOfLevelsCompletedByPlayer = globalNoOfLevelsCompletedByPlayer[player];", "highlightLines": [105]}, "category": "code", "location": {"file": "contracts/contracts/metrics/Statistics.sol", "line": 105, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a8da7ae8be14", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "            uint256 totalNoOfLevelsCompletedByPlayer = globalNoOfLevelsCompletedByPlayer[player];", "highlightLines": [105]}, "category": "code", "location": {"file": "contracts/contracts/metrics/Statistics.sol", "line": 105, "column": 13}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "56c01173565e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            uint256 totalNoOfLevelsCompletedByPlayer = globalNoOfLevelsCompletedByPlayer[player];\n            uint256 newAverageTimeTakenToCompleteLevels = updateAverageTimeTakenToCompleteLevelsByPlayer(player, level, totalNoOfLevelsCompletedByPlayer);", "highlightLines": [105]}, "category": "code", "location": {"file": "contracts/contracts/metrics/Statistics.sol", "line": 105, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "c2c6589ea047", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint256 newAverageTimeTakenToCompleteLevels = updateAverageTimeTakenToCompleteLevelsByPlayer(player, level, totalNoOfLevelsCompletedByPlayer);", "highlightLines": [106]}, "category": "code", "location": {"file": "contracts/contracts/metrics/Statistics.sol", "line": 106, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d580b8feaba0", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        playerStats[player][level].timeSubmitted.push(block.timestamp);", "highlightLines": [113]}, "category": "code", "location": {"file": "contracts/contracts/metrics/Statistics.sol", "line": 113, "column": 55}, "severity": "medium", "references": [], "description": ""}, {"id": "0aa1199b74c6", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        playerStats[player][level].timeCompleted = block.timestamp;\n        playerStats[player][level].isCompleted = true;", "highlightLines": [114]}, "category": "code", "location": {"file": "contracts/contracts/metrics/Statistics.sol", "line": 114, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "dc850d084ae2", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        playerStats[player][level].timeCompleted = block.timestamp;", "highlightLines": [114]}, "category": "code", "location": {"file": "contracts/contracts/metrics/Statistics.sol", "line": 114, "column": 52}, "severity": "medium", "references": [], "description": ""}, {"id": "dfcc1ce0a57c", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function submitFailure(\n        address instance,\n        address level,\n        address player\n    ) external onlyEthernaut levelExistsCheck(level) playerExistsCheck(player) {\n        require(\n            playerStats[player][level].instance != address(0),\n            \"Instance for the level is not created\"\n        );\n        require(\n            playerStats[player][level].instance == instance,", "highlightLines": [120]}, "category": "code", "location": {"file": "contracts/contracts/metrics/Statistics.sol", "line": 120, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "b1f07f730bcc", "fix": {"template": null, "available": false}, "title": "Unnecessary comparison to boolean constant - use variable directly", "ruleId": "rules.sol-boolean-constant-comparison", "snippet": {"code": "            playerStats[player][level].isCompleted == false,", "highlightLines": [134]}, "category": "code", "location": {"file": "contracts/contracts/metrics/Statistics.sol", "line": 134, "column": 52}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#boolean-equality"], "description": ""}, {"id": "80d8b060e78b", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        playerStats[player][level].timeSubmitted.push(block.timestamp);", "highlightLines": [137]}, "category": "code", "location": {"file": "contracts/contracts/metrics/Statistics.sol", "line": 137, "column": 55}, "severity": "medium", "references": [], "description": ""}, {"id": "c02cc426ba05", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    // Percentage of total levels completed by player (1e18 = 100%)", "highlightLines": [243]}, "category": "code", "location": {"file": "contracts/contracts/metrics/Statistics.sol", "line": 243, "column": 56}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "f505c20ac126", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        // Changed from 100 to 1e18 otherwise when levels.length > 100 this will round to 0 always", "highlightLines": [250]}, "category": "code", "location": {"file": "contracts/contracts/metrics/Statistics.sol", "line": 250, "column": 32}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "7b40a1602c87", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimal assumption - tokens with >18 or <18 decimals will cause overflow/underflow", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "            (getTotalNoOfLevelsCompletedByPlayer(player) * 1e18) /", "highlightLines": [252]}, "category": "code", "location": {"file": "contracts/contracts/metrics/Statistics.sol", "line": 252, "column": 58}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20"], "description": ""}, {"id": "7aca5a42c5e9", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "            (getTotalNoOfLevelsCompletedByPlayer(player) * 1e18) /", "highlightLines": [252]}, "category": "code", "location": {"file": "contracts/contracts/metrics/Statistics.sol", "line": 252, "column": 60}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "d8f10de11fd5", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 lastAverageTime = averageTimeTakenToCompleteLevels[player];", "highlightLines": [257]}, "category": "code", "location": {"file": "contracts/contracts/metrics/Statistics.sol", "line": 257, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d5392f1193fe", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 lastAverageTime = averageTimeTakenToCompleteLevels[player];\n        uint256 newAverageTimeTakenToCompleteLevels;\n        uint256 timeTakenForThisSuccessfulSubmission;\n        timeTakenForThisSuccessfulSubmission = levelFirstCompletionTime[player][level] - levelFirstInstanceCreationTime[player][level];", "highlightLines": [257]}, "category": "code", "location": {"file": "contracts/contracts/metrics/Statistics.sol", "line": 257, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "6bf4381b2199", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 newAverageTimeTakenToCompleteLevels;", "highlightLines": [258]}, "category": "code", "location": {"file": "contracts/contracts/metrics/Statistics.sol", "line": 258, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "1378f32e8ba0", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 timeTakenForThisSuccessfulSubmission;", "highlightLines": [259]}, "category": "code", "location": {"file": "contracts/contracts/metrics/Statistics.sol", "line": 259, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "bb4e6d677480", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        timeTakenForThisSuccessfulSubmission = levelFirstCompletionTime[player][level] - levelFirstInstanceCreationTime[player][level];\n        //now, set the average time value in the mapping via evaluating its current value;\n        if (averageTimeTakenToCompleteLevels[player] == 0) {\n            averageTimeTakenToCompleteLevels[player] = timeTakenForThisSuccessfulSubmission;\n        } else {\n            newAverageTimeTakenToCompleteLevels = ((lastAverageTime * (totalNoOfLevelsCompletedByPlayer-1)) + timeTakenForThisSuccessfulSubmission)/totalNoOfLevelsCompletedByPlayer;\n            averageTimeTakenToCompleteLevels[player] = newAverageTimeTakenToCompleteLevels;\n        }", "highlightLines": [260]}, "category": "code", "location": {"file": "contracts/contracts/metrics/Statistics.sol", "line": 260, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "bc3751c6f7e3", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            newAverageTimeTakenToCompleteLevels = ((lastAverageTime * (totalNoOfLevelsCompletedByPlayer-1)) + timeTakenForThisSuccessfulSubmission)/totalNoOfLevelsCompletedByPlayer;\n            averageTimeTakenToCompleteLevels[player] = newAverageTimeTakenToCompleteLevels;", "highlightLines": [265]}, "category": "code", "location": {"file": "contracts/contracts/metrics/Statistics.sol", "line": 265, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "898246e2030c", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "cf2b28a5ca62", "fix": {"template": null, "available": false}, "title": "Consider using Ownable2Step instead of Ownable for safer ownership transfers", "ruleId": "rules.sol-use-ownable2step", "snippet": {"code": "import \"@openzeppelin/contracts/access/Ownable.sol\";", "highlightLines": [4]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 4, "column": 1}, "severity": "info", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/access/Ownable2Step.sol"], "description": ""}, {"id": "b60f3420812b", "fix": {"template": null, "available": false}, "title": "Upgradeable contract without storage gap - future upgrade collision risk", "ruleId": "rules.sol-no-gap-storage", "snippet": {"code": "contract StatisticsLevelSuperseder is Initializable {", "highlightLines": [7]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 7, "column": 1}, "severity": "info", "references": ["https://docs.openzeppelin.com/contracts/4.x/upgradeable#storage_gaps"], "description": ""}, {"id": "8114b794ab50", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract StatisticsLevelSuperseder is Initializable {\n    address public ethernaut;\n    address[] public players;\n    address[] public levels;\n    uint256 private globalNoOfInstancesCreated;\n    uint256 private globalNoOfInstancesCompleted;\n    uint256 private globalNoOfFailedSubmissions;\n    struct LevelInstance {\n        address instance;\n        bool isCompleted;\n        uint256 timeCreated;\n        uint256 timeCompleted;", "highlightLines": [7]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 7, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "b00d55543ff0", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address instance;", "highlightLines": [15]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 15, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "530cbdb15dfd", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool isCompleted;", "highlightLines": [16]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 16, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "078af613e747", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 timeCreated;", "highlightLines": [17]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 17, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7e0d323e02d1", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 timeCompleted;", "highlightLines": [18]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 18, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b4939178fa67", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 noOfInstancesCreated;", "highlightLines": [22]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 22, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "12d72f176587", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 noOfInstancesSubmitted_Success;", "highlightLines": [23]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 23, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d78ff8f9bcd2", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 noOfSubmissions_Failed;", "highlightLines": [24]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 24, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ba4126903147", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    bool onMaintenance;", "highlightLines": [39]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 39, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "2ec2c529ea66", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyOperator() {\n        require(\n            msg.sender == operator,\n            \"Only operator account can call this function\"\n        );\n        _;\n    }", "highlightLines": [58]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 58, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "2cb76e339518", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [63]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 63, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "3fd959986543", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event playerScoreProfile(address indexed player, uint256 indexed averageCompletionTime, uint256 indexed globalLevelsCompleted);", "highlightLines": [67]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 67, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "a99d20be7d10", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier levelExistsCheck(address level) {\n        require(doesLevelExist(level), \"Level doesn't exist\");\n        _;\n    }", "highlightLines": [69]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 69, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "22e9c3f356fa", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [71]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 71, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "d37b6650d138", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier levelDoesntExistCheck(address level) {\n        require(!doesLevelExist(level), \"Level already exists\");\n        _;\n    }", "highlightLines": [73]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 73, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "8ad7f207710b", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [75]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 75, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "d4c32365185e", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier playerExistsCheck(address player) {\n        require(doesPlayerExist(player), \"Player doesn't exist\");\n        _;\n    }", "highlightLines": [77]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 77, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "dd352cdefcc3", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [79]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 79, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "e9858e6ada58", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyEthernaut() {\n        require(\n            msg.sender == ethernaut,\n            \"Only Ethernaut can call this function\"\n        );\n        _;\n    }", "highlightLines": [81]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 81, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "4b166f2a20b6", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "    modifier onlyEthernaut() {\n        require(\n            msg.sender == ethernaut,\n            \"Only Ethernaut can call this function\"\n        );\n        _;\n    }", "highlightLines": [81]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 81, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "10edd369dd78", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [86]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 86, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "1fae9bf69a0e", "fix": {"template": null, "available": false}, "title": "Initializer function not protected - can be called multiple times", "ruleId": "rules.sol-initializer-not-protected", "snippet": {"code": "    function initialize(address _ethernautAddress, address _operator) public initializer {", "highlightLines": [88]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 88, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "d883d82bf771", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    // Percentage of total levels completed by player (1e18 = 100%)", "highlightLines": [214]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 214, "column": 56}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "12a0ad04ea65", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        // Changed from 100 to 1e18 otherwise when levels.length > 100 this will round to 0 always", "highlightLines": [221]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 221, "column": 32}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "0f34bc1127d9", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimal assumption - tokens with >18 or <18 decimals will cause overflow/underflow", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "            (getTotalNoOfLevelsCompletedByPlayer(player) * 1e18) /", "highlightLines": [223]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 223, "column": 58}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20"], "description": ""}, {"id": "f4d8eadd6f77", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "            (getTotalNoOfLevelsCompletedByPlayer(player) * 1e18) /", "highlightLines": [223]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 223, "column": 60}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "55ab13a77b12", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 lastAverageTime = averageTimeTakenToCompleteLevels[player];", "highlightLines": [228]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 228, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a9d289cbe5a3", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 lastAverageTime = averageTimeTakenToCompleteLevels[player];\n        uint256 newAverageTimeTakenToCompleteLevels;\n        uint256 timeTakenForThisSuccessfulSubmission;\n        timeTakenForThisSuccessfulSubmission = levelFirstCompletionTime[player][level] - levelFirstInstanceCreationTime[player][level];", "highlightLines": [228]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 228, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "3fdf188c56d5", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 newAverageTimeTakenToCompleteLevels;", "highlightLines": [229]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 229, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "27eb0ece0db3", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 timeTakenForThisSuccessfulSubmission;", "highlightLines": [230]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 230, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "692998bb2610", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        timeTakenForThisSuccessfulSubmission = levelFirstCompletionTime[player][level] - levelFirstInstanceCreationTime[player][level];\n        //now, set the average time value in the mapping via evaluating its current value;\n        if (averageTimeTakenToCompleteLevels[player] == 0) {\n            averageTimeTakenToCompleteLevels[player] = timeTakenForThisSuccessfulSubmission;\n        } else {\n            newAverageTimeTakenToCompleteLevels = ((lastAverageTime * (totalNoOfLevelsCompletedByPlayer-1)) + timeTakenForThisSuccessfulSubmission)/totalNoOfLevelsCompletedByPlayer;\n            averageTimeTakenToCompleteLevels[player] = newAverageTimeTakenToCompleteLevels;\n        }", "highlightLines": [231]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 231, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e30a81a7b3be", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            newAverageTimeTakenToCompleteLevels = ((lastAverageTime * (totalNoOfLevelsCompletedByPlayer-1)) + timeTakenForThisSuccessfulSubmission)/totalNoOfLevelsCompletedByPlayer;\n            averageTimeTakenToCompleteLevels[player] = newAverageTimeTakenToCompleteLevels;", "highlightLines": [236]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 236, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "1dc2d0543308", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        usersArrayIndex = 0;\n        operator = _operator;", "highlightLines": [295]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 295, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "430e01247463", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        operator = _operator;\n        onMaintenance = true;", "highlightLines": [296]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 296, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "7dedd050ca9c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        onMaintenance = true;\n        \n        dumpStage = DumpStage.SET_ADDRESSES;", "highlightLines": [297]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 297, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "0e6358739f7d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        oldLevelContractAddress = _oldLevelContractAddress;\n        newLevelContractAddress = _newLevelContractAddress;", "highlightLines": [309]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 309, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "fc9089ab92f8", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        address _oldLevelContractAddress = oldLevelContractAddress;", "highlightLines": [319]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 319, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3eafc07880b4", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address _oldLevelContractAddress = oldLevelContractAddress;\n        address _newLevelContractAddress = newLevelContractAddress;", "highlightLines": [320]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 320, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "2c8e13c5b30a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address _newLevelContractAddress = newLevelContractAddress;", "highlightLines": [321]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 321, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "780f74098857", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address _newLevelContractAddress = newLevelContractAddress;\n        uint256 _usersArrayIndex = usersArrayIndex;", "highlightLines": [321]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 321, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "450e9bf37cac", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 _usersArrayIndex = usersArrayIndex;", "highlightLines": [322]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 322, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "5475f5602a33", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 _usersArrayIndex = usersArrayIndex;\n\n        uint256 timestamp;\n\n        do {\n            timestamp = levelFirstInstanceCreationTime[players[_usersArrayIndex]][_oldLevelContractAddress];\n\n            if(timestamp > 0) {\n                levelFirstInstanceCreationTime[players[_usersArrayIndex]][_newLevelContractAddress] = timestamp;\n                levelFirstInstanceCreationTime[players[_usersArrayIndex]][_oldLevelContractAddress] = 0;\n            }\n\n            _usersArrayIndex++;\n        } while (gasleft() > 53000 && !(_usersArrayIndex == players.length));", "highlightLines": [322]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 322, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "3c896f0587c6", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 timestamp;", "highlightLines": [323]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 323, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "11d187ffd283", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            timestamp = levelFirstInstanceCreationTime[players[_usersArrayIndex]][_oldLevelContractAddress];\n\n            if(timestamp > 0) {\n                levelFirstInstanceCreationTime[players[_usersArrayIndex]][_newLevelContractAddress] = timestamp;\n                levelFirstInstanceCreationTime[players[_usersArrayIndex]][_oldLevelContractAddress] = 0;\n            }", "highlightLines": [327]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 327, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "c63bccb823c6", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "                levelFirstInstanceCreationTime[players[_usersArrayIndex]][_newLevelContractAddress] = timestamp;\n                levelFirstInstanceCreationTime[players[_usersArrayIndex]][_oldLevelContractAddress] = 0;", "highlightLines": [330]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 330, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "0f554152b1dd", "fix": {"template": null, "available": false}, "title": "Variable written twice without being read between - first write is dead store", "ruleId": "rules.sol-write-after-write", "snippet": {"code": "        if(_usersArrayIndex == players.length) {\n            dumpStage = DumpStage.LEVEL_FIRST_COMPLETION_TIME;\n            usersArrayIndex = 0;", "highlightLines": [338]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 338, "column": 13}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#write-after-write"], "description": ""}, {"id": "21c77e20b6d6", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            dumpStage = DumpStage.LEVEL_FIRST_COMPLETION_TIME;\n            usersArrayIndex = 0;", "highlightLines": [339]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 339, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "d8c72b04f1b5", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        address _oldLevelContractAddress = oldLevelContractAddress;", "highlightLines": [348]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 348, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "324ee78bc65b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address _oldLevelContractAddress = oldLevelContractAddress;\n        address _newLevelContractAddress = newLevelContractAddress;", "highlightLines": [349]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 349, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "4bca7a38e65b", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address _newLevelContractAddress = newLevelContractAddress;", "highlightLines": [350]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 350, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "9ebc802948f8", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address _newLevelContractAddress = newLevelContractAddress;\n        uint256 _usersArrayIndex = usersArrayIndex;", "highlightLines": [350]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 350, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "aa7aaf825583", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 _usersArrayIndex = usersArrayIndex;", "highlightLines": [351]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 351, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "9f52552cbd57", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 _usersArrayIndex = usersArrayIndex;\n        \n        uint256 timestamp;\n\n        do {\n            timestamp = levelFirstCompletionTime[players[_usersArrayIndex]][_oldLevelContractAddress];\n\n            if(timestamp > 0) {\n\n                levelFirstCompletionTime[players[_usersArrayIndex]][_newLevelContractAddress] = timestamp;\n                levelFirstCompletionTime[players[_usersArrayIndex]][_oldLevelContractAddress] = 0;\n            }\n            _usersArrayIndex++;\n        } while (gasleft() > 53000 && !(_usersArrayIndex == players.length));", "highlightLines": [351]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 351, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "361facc3231f", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        \n        uint256 timestamp;", "highlightLines": [352]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 352, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "cf231e66f69e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            timestamp = levelFirstCompletionTime[players[_usersArrayIndex]][_oldLevelContractAddress];\n\n            if(timestamp > 0) {\n\n                levelFirstCompletionTime[players[_usersArrayIndex]][_newLevelContractAddress] = timestamp;\n                levelFirstCompletionTime[players[_usersArrayIndex]][_oldLevelContractAddress] = 0;\n            }", "highlightLines": [356]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 356, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "dd1e857d5af3", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "                levelFirstCompletionTime[players[_usersArrayIndex]][_newLevelContractAddress] = timestamp;\n                levelFirstCompletionTime[players[_usersArrayIndex]][_oldLevelContractAddress] = 0;", "highlightLines": [360]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 360, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "d72edceaa347", "fix": {"template": null, "available": false}, "title": "Variable written twice without being read between - first write is dead store", "ruleId": "rules.sol-write-after-write", "snippet": {"code": "        if(_usersArrayIndex == players.length) {\n            dumpStage = DumpStage.PLAYER_STATS;\n            usersArrayIndex = 0;", "highlightLines": [367]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 367, "column": 13}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#write-after-write"], "description": ""}, {"id": "3f17f054dc37", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            dumpStage = DumpStage.PLAYER_STATS;\n            usersArrayIndex = 0;", "highlightLines": [368]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 368, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "4712612dcbf6", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        address _oldLevelContractAddress = oldLevelContractAddress;", "highlightLines": [377]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 377, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "818695f4ec6c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address _oldLevelContractAddress = oldLevelContractAddress;\n        address _newLevelContractAddress = newLevelContractAddress;", "highlightLines": [378]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 378, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "f624b33848d9", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address _newLevelContractAddress = newLevelContractAddress;", "highlightLines": [379]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 379, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "272b63ae134e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address _newLevelContractAddress = newLevelContractAddress;\n        uint256 _usersArrayIndex = usersArrayIndex;", "highlightLines": [379]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 379, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "8cccc3433fe6", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 _usersArrayIndex = usersArrayIndex;", "highlightLines": [380]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 380, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8ced712d04bb", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 _usersArrayIndex = usersArrayIndex;\n        LevelInstance memory levelInstanceEmpty;\n        LevelInstance memory actualInstance;\n        \n        do {\n            actualInstance = playerStats[players[_usersArrayIndex]][_oldLevelContractAddress];\n            if(actualInstance.instance != address(0)) {\n                playerStats[players[_usersArrayIndex]][_newLevelContractAddress].instance = actualInstance.instance;\n                playerStats[players[_usersArrayIndex]][_newLevelContractAddress].isCompleted = actualInstance.isCompleted;\n                playerStats[players[_usersArrayIndex]][_newLevelContractAddress].timeCreated = actualInstance.timeCreated;\n                playerStats[players[_usersArrayIndex]][_newLevelContractAddress].timeCompleted = actualInstance.timeCompleted;\n                playerStats[players[_usersArrayIndex]][_newLevelContractAddress].timeSubmitted = actualInstance.timeSubmitted;\n\n                playerStats[players[_usersArrayIndex]][_oldLevelContractAddress] = levelInstanceEmpty;\n            }\n\n            _usersArrayIndex++;\n        } while (gasleft() > 330000 && !(_usersArrayIndex == players.length));", "highlightLines": [380]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 380, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "f5a6dd9738ac", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            actualInstance = playerStats[players[_usersArrayIndex]][_oldLevelContractAddress];\n            if(actualInstance.instance != address(0)) {\n                playerStats[players[_usersArrayIndex]][_newLevelContractAddress].instance = actualInstance.instance;\n                playerStats[players[_usersArrayIndex]][_newLevelContractAddress].isCompleted = actualInstance.isCompleted;\n                playerStats[players[_usersArrayIndex]][_newLevelContractAddress].timeCreated = actualInstance.timeCreated;\n                playerStats[players[_usersArrayIndex]][_newLevelContractAddress].timeCompleted = actualInstance.timeCompleted;\n                playerStats[players[_usersArrayIndex]][_newLevelContractAddress].timeSubmitted = actualInstance.timeSubmitted;\n\n                playerStats[players[_usersArrayIndex]][_oldLevelContractAddress] = levelInstanceEmpty;\n            }", "highlightLines": [385]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 385, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "3e6935aa95ab", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "                playerStats[players[_usersArrayIndex]][_newLevelContractAddress].instance = actualInstance.instance;\n                playerStats[players[_usersArrayIndex]][_newLevelContractAddress].isCompleted = actualInstance.isCompleted;", "highlightLines": [387]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 387, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "4efba0dcf9f8", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "                playerStats[players[_usersArrayIndex]][_newLevelContractAddress].isCompleted = actualInstance.isCompleted;\n                playerStats[players[_usersArrayIndex]][_newLevelContractAddress].timeCreated = actualInstance.timeCreated;", "highlightLines": [388]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 388, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "1057e2b42b2b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "                playerStats[players[_usersArrayIndex]][_newLevelContractAddress].timeCreated = actualInstance.timeCreated;\n                playerStats[players[_usersArrayIndex]][_newLevelContractAddress].timeCompleted = actualInstance.timeCompleted;", "highlightLines": [389]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 389, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "36d83ea74906", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "                playerStats[players[_usersArrayIndex]][_newLevelContractAddress].timeCompleted = actualInstance.timeCompleted;\n                playerStats[players[_usersArrayIndex]][_newLevelContractAddress].timeSubmitted = actualInstance.timeSubmitted;", "highlightLines": [390]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 390, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "9397e1627ea5", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "                playerStats[players[_usersArrayIndex]][_newLevelContractAddress].timeSubmitted = actualInstance.timeSubmitted;\n\n                playerStats[players[_usersArrayIndex]][_oldLevelContractAddress] = levelInstanceEmpty;", "highlightLines": [391]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 391, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "233481b0c32b", "fix": {"template": null, "available": false}, "title": "Variable written twice without being read between - first write is dead store", "ruleId": "rules.sol-write-after-write", "snippet": {"code": "        if(_usersArrayIndex == players.length) {\n            dumpStage = DumpStage.LEVEL_STATS;\n            usersArrayIndex = 0;", "highlightLines": [400]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 400, "column": 13}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#write-after-write"], "description": ""}, {"id": "d861053476cd", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            dumpStage = DumpStage.LEVEL_STATS;\n            usersArrayIndex = 0;", "highlightLines": [401]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 401, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "9331e06e5e86", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        levelStats[newLevelContractAddress] = levelStats[oldLevelContractAddress];\n        levelStats[oldLevelContractAddress] = levelEmpty;", "highlightLines": [413]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 413, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "79a1e55c3ed5", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        levelStats[oldLevelContractAddress] = levelEmpty;      \n\n        dumpStage = DumpStage.LEVEL_EXISTS_AND_LEVELS_ARRAY_FIX;", "highlightLines": [414]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 414, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "3b424f22dca5", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        address _oldLevelContractAddress = oldLevelContractAddress;", "highlightLines": [421]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 421, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "101b63383a52", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address _oldLevelContractAddress = oldLevelContractAddress;\n\n        uint256 deployId = 0;", "highlightLines": [422]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 422, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "c7637268ce96", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 deployId = 0;", "highlightLines": [423]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 423, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0ecf27214904", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 deployId = 0;\n        while (levels[deployId] != _oldLevelContractAddress){\n            deployId++;\n        }\n        levels[deployId] = newLevelContractAddress;", "highlightLines": [424]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 424, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "68cba441e2e7", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        levels[deployId] = newLevelContractAddress;\n\n        levelExists[_oldLevelContractAddress] = false;", "highlightLines": [428]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 428, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "53d403f36b41", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        levelExists[_oldLevelContractAddress] = false;      \n        levels.pop();\n        \n\n        dumpStage = DumpStage.DUMP_DONE;", "highlightLines": [430]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 430, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "a7c75a3b0464", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        usersArrayIndex = 0;\n        oldLevelContractAddress = address(0);", "highlightLines": [439]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 439, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "77a4d304e3a8", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        oldLevelContractAddress = address(0);\n        newLevelContractAddress = address(0);", "highlightLines": [440]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 440, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "6bbcc2d36561", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        newLevelContractAddress = address(0);\n        operator = address(0);", "highlightLines": [441]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 441, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "ee02c65ebc2a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        operator = address(0);\n        onMaintenance = false;", "highlightLines": [442]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 442, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "b1070b26b4b3", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        onMaintenance = false;\n        dumpStage = DumpStage.INIT;", "highlightLines": [443]}, "category": "code", "location": {"file": "contracts/contracts/metrics/StatisticsLevelSuperseder.sol", "line": 443, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "84bd0553c1a3", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [4]}, "category": "code", "location": {"file": "contracts/contracts/proxy/ProxyAdmin.sol", "line": 4, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "568c7da2e78f", "fix": {"template": null, "available": false}, "title": "Consider using Ownable2Step instead of Ownable for safer ownership transfers", "ruleId": "rules.sol-use-ownable2step", "snippet": {"code": "import \"@openzeppelin/contracts/access/Ownable.sol\";", "highlightLines": [7]}, "category": "code", "location": {"file": "contracts/contracts/proxy/ProxyAdmin.sol", "line": 7, "column": 1}, "severity": "info", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/access/Ownable2Step.sol"], "description": ""}, {"id": "829217e3484f", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(success);", "highlightLines": [32]}, "category": "code", "location": {"file": "contracts/contracts/proxy/ProxyAdmin.sol", "line": 32, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "004e09967cec", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(success);", "highlightLines": [54]}, "category": "code", "location": {"file": "contracts/contracts/proxy/ProxyAdmin.sol", "line": 54, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "294cc3bbb86b", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    ) public virtual onlyOwner {", "highlightLines": [68]}, "category": "code", "location": {"file": "contracts/contracts/proxy/ProxyAdmin.sol", "line": 68, "column": 22}, "severity": "info", "references": [], "description": ""}, {"id": "5b0f5216d974", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "        onlyOwner", "highlightLines": [82]}, "category": "code", "location": {"file": "contracts/contracts/proxy/ProxyAdmin.sol", "line": 82, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "5d55fdc35931", "fix": {"template": null, "available": false}, "title": "Owner has excessive privileges - single account controls critical functions without checks", "ruleId": "rules.sol-owner-privilege-escalation", "snippet": {"code": "        onlyOwner\n    {\n        proxy.upgradeTo(implementation);", "highlightLines": [82]}, "category": "code", "location": {"file": "contracts/contracts/proxy/ProxyAdmin.sol", "line": 82, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "961a2de30694", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    ) public payable virtual onlyOwner {", "highlightLines": [99]}, "category": "code", "location": {"file": "contracts/contracts/proxy/ProxyAdmin.sol", "line": 99, "column": 30}, "severity": "info", "references": [], "description": ""}, {"id": "f57435d69e4a", "fix": {"template": null, "available": false}, "title": "Owner has excessive privileges - single account controls critical functions without checks", "ruleId": "rules.sol-owner-privilege-escalation", "snippet": {"code": "    ) public payable virtual onlyOwner {\n        proxy.upgradeToAndCall{value: msg.value}(implementation, data);", "highlightLines": [99]}, "category": "code", "location": {"file": "contracts/contracts/proxy/ProxyAdmin.sol", "line": 99, "column": 30}, "severity": "medium", "references": [], "description": ""}, {"id": "838ac154ba61", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "contracts/contracts/proxy/ProxyStats.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "9b6b0bceb4a6", "fix": {"template": null, "available": false}, "title": "Upgradeable contract without storage gap - adding variables in parent will corrupt child storage", "ruleId": "rules.sol-missing-storage-gap", "snippet": {"code": "contract ProxyStats is TransparentUpgradeableProxy {", "highlightLines": [5]}, "category": "code", "location": {"file": "contracts/contracts/proxy/ProxyStats.sol", "line": 5, "column": 1}, "severity": "medium", "references": ["https://docs.openzeppelin.com/upgrades-plugins/writing-upgradeable"], "description": ""}, {"id": "92ad900ac0fe", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(\n        address _impl,\n        address _admin,\n        address _ethernautAddress\n    )\n        TransparentUpgradeableProxy(\n            _impl,\n            _admin,\n            abi.encodeWithSignature(\"initialize(address)\", _ethernautAddress)\n        )\n    {}", "highlightLines": [6]}, "category": "code", "location": {"file": "contracts/contracts/proxy/ProxyStats.sol", "line": 6, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "ad143fa4bdb2", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [3]}, "category": "code", "location": {"file": "contracts/out/Ethernaut_flat.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "8fff4db5bbc9", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "abstract contract Ownable is Context {\n    address private _owner;", "highlightLines": [48]}, "category": "code", "location": {"file": "contracts/out/Ethernaut_flat.sol", "line": 48, "column": 10}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "e58b9fd2ca59", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event OwnershipTransferred(address indexed previousOwner, address indexed newOwner);", "highlightLines": [51]}, "category": "code", "location": {"file": "contracts/out/Ethernaut_flat.sol", "line": 51, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "aafa38b35986", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor() {\n        _transferOwnership(_msgSender());\n    }", "highlightLines": [56]}, "category": "code", "location": {"file": "contracts/out/Ethernaut_flat.sol", "line": 56, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "de4679d93902", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyOwner() {\n        _checkOwner();\n        _;\n    }", "highlightLines": [63]}, "category": "code", "location": {"file": "contracts/out/Ethernaut_flat.sol", "line": 63, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "1a43f45357f3", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "    modifier onlyOwner() {\n        _checkOwner();\n        _;\n    }", "highlightLines": [63]}, "category": "code", "location": {"file": "contracts/out/Ethernaut_flat.sol", "line": 63, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "4482630885c3", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [65]}, "category": "code", "location": {"file": "contracts/out/Ethernaut_flat.sol", "line": 65, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "686b9bbf869e", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function renounceOwnership() public virtual onlyOwner {", "highlightLines": [89]}, "category": "code", "location": {"file": "contracts/out/Ethernaut_flat.sol", "line": 89, "column": 49}, "severity": "info", "references": [], "description": ""}, {"id": "a853284d4471", "fix": {"template": null, "available": false}, "title": "Access control change without event emission - harder to monitor and audit", "ruleId": "rules.sol-missing-events-access-control", "snippet": {"code": "    function transferOwnership(address newOwner) public virtual onlyOwner {", "highlightLines": [97]}, "category": "code", "location": {"file": "contracts/out/Ethernaut_flat.sol", "line": 97, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-access-control"], "description": ""}, {"id": "2e65ca7e0204", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function transferOwnership(address newOwner) public virtual onlyOwner {", "highlightLines": [97]}, "category": "code", "location": {"file": "contracts/out/Ethernaut_flat.sol", "line": 97, "column": 65}, "severity": "info", "references": [], "description": ""}, {"id": "a0e94e7dfe07", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address oldOwner = _owner;", "highlightLines": [107]}, "category": "code", "location": {"file": "contracts/out/Ethernaut_flat.sol", "line": 107, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "1f76246db358", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address oldOwner = _owner;\n        _owner = newOwner;", "highlightLines": [107]}, "category": "code", "location": {"file": "contracts/out/Ethernaut_flat.sol", "line": 107, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "6160ed812b99", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function createInstance(address _player) virtual public payable returns (address);", "highlightLines": [115]}, "category": "code", "location": {"file": "contracts/out/Ethernaut_flat.sol", "line": 115, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "16c7f04e2988", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function saveNewLevel(address level) external;", "highlightLines": [120]}, "category": "code", "location": {"file": "contracts/out/Ethernaut_flat.sol", "line": 120, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "ac8e472b4cfa", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function saveNewLevel(address level) external;\n\n    function createNewInstance(\n        address instance,\n        address level,\n        address player\n    ) external;\n\n    function submitFailure(\n        address instance,\n        address level,\n        address player\n    ) external;\n\n    function submitSuccess(\n        address instance,\n        address level,\n        address player\n    ) external;\n}\n\ncontract Ethernaut is Ownable {\n    IStatistics public statistics;\n\n    // ----------------------------------\n    // Owner interaction\n    // ----------------------------------\n\n    mapping(address => bool) public registeredLevels;", "highlightLines": [120]}, "category": "code", "location": {"file": "contracts/out/Ethernaut_flat.sol", "line": 120, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "befc4af5b467", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function createNewInstance(\n        address instance,\n        address level,\n        address player\n    ) external;", "highlightLines": [122]}, "category": "code", "location": {"file": "contracts/out/Ethernaut_flat.sol", "line": 122, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "7ce29bc04b09", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function submitFailure(\n        address instance,\n        address level,\n        address player\n    ) external;", "highlightLines": [128]}, "category": "code", "location": {"file": "contracts/out/Ethernaut_flat.sol", "line": 128, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "c1b3e3fbcec3", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function submitSuccess(\n        address instance,\n        address level,\n        address player\n    ) external;", "highlightLines": [134]}, "category": "code", "location": {"file": "contracts/out/Ethernaut_flat.sol", "line": 134, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "8c29860be0b8", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function registerLevel(Level _level) public onlyOwner {", "highlightLines": [151]}, "category": "code", "location": {"file": "contracts/out/Ethernaut_flat.sol", "line": 151, "column": 49}, "severity": "info", "references": [], "description": ""}, {"id": "834c635af67a", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function setStatistics(address _statProxy) external onlyOwner {", "highlightLines": [156]}, "category": "code", "location": {"file": "contracts/out/Ethernaut_flat.sol", "line": 156, "column": 57}, "severity": "info", "references": [], "description": ""}, {"id": "413524599960", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address player;", "highlightLines": [165]}, "category": "code", "location": {"file": "contracts/out/Ethernaut_flat.sol", "line": 165, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "24cff59c6326", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool completed;", "highlightLines": [167]}, "category": "code", "location": {"file": "contracts/out/Ethernaut_flat.sol", "line": 167, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "90ed23c2b70f", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event LevelInstanceCreatedLog(\n        address indexed player,\n        address indexed instance,\n        address indexed level\n    );", "highlightLines": [172]}, "category": "code", "location": {"file": "contracts/out/Ethernaut_flat.sol", "line": 172, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "bfb6ece9508e", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event LevelInstanceCreatedLog(\n        address indexed player,\n        address indexed instance,\n        address indexed level\n    );", "highlightLines": [172]}, "category": "code", "location": {"file": "contracts/out/Ethernaut_flat.sol", "line": 172, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "3750922b3872", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event LevelCompletedLog(\n        address indexed player,\n        address indexed instance,\n        address indexed level\n    );", "highlightLines": [177]}, "category": "code", "location": {"file": "contracts/out/Ethernaut_flat.sol", "line": 177, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "491eb19adccd", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event LevelCompletedLog(\n        address indexed player,\n        address indexed instance,\n        address indexed level\n    );", "highlightLines": [177]}, "category": "code", "location": {"file": "contracts/out/Ethernaut_flat.sol", "line": 177, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "4b28f2ab945d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address instance = _level.createInstance{value: msg.value}(msg.sender);", "highlightLines": [188]}, "category": "code", "location": {"file": "contracts/out/Ethernaut_flat.sol", "line": 188, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "bd3692127b60", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address instance = _level.createInstance{value: msg.value}(msg.sender);\n\n        // Store emitted instance relationship with player and level.\n        emittedInstances[instance] = EmittedInstanceData(\n            msg.sender,\n            _level,\n            false\n        );", "highlightLines": [188]}, "category": "code", "location": {"file": "contracts/out/Ethernaut_flat.sol", "line": 188, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "c7f483bf6f95", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        EmittedInstanceData storage data = emittedInstances[_instance];\n        require(\n            data.player == msg.sender,\n            \"This instance doesn't belong to the current user\"\n        ); // instance was emitted for this player\n        require(data.completed == false, \"Level has been completed already\"); // not already submitted\n\n        // Have the level check the instance.\n        if (data.level.validateInstance(_instance, msg.sender)) {\n            // Register instance as completed.\n            data.completed = true;\n\n            statistics.submitSuccess(\n                _instance,\n                address(data.level),\n                msg.sender\n            );\n            // Notify success via logs.\n            emit LevelCompletedLog(msg.sender, _instance, address(data.level));\n        } else {\n            statistics.submitFailure(\n                _instance,\n                address(data.level),\n                msg.sender\n            );\n        }", "highlightLines": [205]}, "category": "code", "location": {"file": "contracts/out/Ethernaut_flat.sol", "line": 205, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "51ccfdc4bf3f", "fix": {"template": null, "available": false}, "title": "Unnecessary comparison to boolean constant - use variable directly", "ruleId": "rules.sol-boolean-constant-comparison", "snippet": {"code": "        require(data.completed == false, \"Level has been completed already\"); // not already submitted", "highlightLines": [210]}, "category": "code", "location": {"file": "contracts/out/Ethernaut_flat.sol", "line": 210, "column": 32}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#boolean-equality"], "description": ""}, {"id": "816fade9aba8", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "dfe35786e841", "fix": {"template": null, "available": false}, "title": "Potential mnemonic seed phrase detected - CRITICAL if real", "ruleId": "rules._shared.shared-mnemonic-phrase", "snippet": {"code": " * @dev This abstract contract provides a fallback function that delegates all calls to another contract using the EVM", "highlightLines": [19]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 19, "column": 14}, "severity": "high", "references": [], "description": ""}, {"id": "9c9b9b3f54f2", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [35]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 35, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "f1ca544b21b4", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "     * This function does not return to its internal call site, it will return directly to the external caller.\n     */\n    function _fallback() internal virtual {\n        _beforeFallback();\n        _delegate(_implementation());", "highlightLines": [68]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 68, "column": 31}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "220fc065311b", "fix": {"template": null, "available": false}, "title": "Contract inherits interface but may be missing function implementations", "ruleId": "rules.sol-missing-interface-implementation", "snippet": {"code": "     * @dev Returns the storage slot that the proxiable contract assumes is being used to store the implementation\n     * address.\n     *\n     * IMPORTANT: A proxy pointing at a proxiable contract should not be considered proxiable itself, because this risks", "highlightLines": [133]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 133, "column": 57}, "severity": "medium", "references": [], "description": ""}, {"id": "23ea02bfc5da", "fix": {"template": null, "available": false}, "title": "isContract check can be bypassed by calling from constructor - extcodesize is 0 during construction", "ruleId": "rules.sol-ethernaut-iscontract-bypass", "snippet": {"code": "        return account.code.length > 0;", "highlightLines": [183]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 183, "column": 16}, "severity": "high", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2943"], "description": ""}, {"id": "e1228d5ca2f7", "fix": {"template": null, "available": false}, "title": "ETH balance check without accounting for selfdestruct donations - can be manipulated", "ruleId": "rules.sol-eth-balance-accounting", "snippet": {"code": "        require(address(this).balance >= amount, \"Address: insufficient balance\");", "highlightLines": [203]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 203, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "c024720cb339", "fix": {"template": null, "available": false}, "title": "Low-level call without checking return value - silent failure possible", "ruleId": "rules.sol-unchecked-call-return", "snippet": {"code": "        (bool success, ) = recipient.call{value: amount}(\"\");", "highlightLines": [205]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 205, "column": 37}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-104/", "https://blocksecteam.medium.com/li-fi-attack"], "description": ""}, {"id": "614dee1bbf52", "fix": {"template": null, "available": false}, "title": "State change after external call - potential reentrancy vulnerability", "ruleId": "rules.sol-external-call-state-change", "snippet": {"code": "        (bool success, ) = recipient.call{value: amount}(\"\");\n        require(success, \"Address: unable to send value, recipient may have reverted\");\n    }\n\n    /**\n     * @dev Performs a Solidity function call using a low level `call`. A\n     * plain `call` is an unsafe replacement for a function call: use this\n     * function instead.\n     *\n     * If `target` reverts with a revert reason, it is bubbled up by this\n     * function (like regular Solidity function calls).\n     *\n     * Returns the raw returned data. To convert to the expected return value,\n     * use https://solidity.readthedocs.io/en/latest/units-and-global-variables.html?highlight=abi.decode#abi-encoding-and-decoding-functions[`abi.decode`].", "highlightLines": [205]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 205, "column": 37}, "severity": "high", "references": ["https://consensys.github.io/smart-contract-best-practices/attacks/reentrancy/"], "description": ""}, {"id": "a9d6ab8287a5", "fix": {"template": null, "available": false}, "title": "ETH balance check without accounting for selfdestruct donations - can be manipulated", "ruleId": "rules.sol-eth-balance-accounting", "snippet": {"code": "        require(address(this).balance >= value, \"Address: insufficient balance for call\");", "highlightLines": [276]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 276, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "4f6fae5b5c78", "fix": {"template": null, "available": false}, "title": "External call result copied to memory - malicious contract can return huge data (return bomb)", "ruleId": "rules.sol-return-bomb", "snippet": {"code": "        (bool success, bytes memory returndata) = target.call{value: value}(data);", "highlightLines": [279]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 279, "column": 9}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#return-bomb"], "description": ""}, {"id": "54f2de9f9e26", "fix": {"template": null, "available": false}, "title": "Call success variable declared but never checked - funds may be lost", "ruleId": "rules.sol-call-success-not-required", "snippet": {"code": "        (bool success, bytes memory returndata) = target.call{value: value}(data);", "highlightLines": [279]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 279, "column": 9}, "severity": "high", "references": [], "description": ""}, {"id": "e3009eefa79e", "fix": {"template": null, "available": false}, "title": "Low-level call without checking return value - silent failure possible", "ruleId": "rules.sol-unchecked-call-return", "snippet": {"code": "        (bool success, bytes memory returndata) = target.call{value: value}(data);", "highlightLines": [279]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 279, "column": 57}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-104/", "https://blocksecteam.medium.com/li-fi-attack"], "description": ""}, {"id": "7af7f0eb8a58", "fix": {"template": null, "available": false}, "title": "State change after external call - potential reentrancy vulnerability", "ruleId": "rules.sol-external-call-state-change", "snippet": {"code": "        (bool success, bytes memory returndata) = target.call{value: value}(data);\n        return verifyCallResult(success, returndata, errorMessage);\n    }\n\n    /**\n     * @dev Same as {xref-Address-functionCall-address-bytes-}[`functionCall`],\n     * but performing a static call.\n     *\n     * _Available since v3.3._\n     */\n    function functionStaticCall(address target, bytes memory data) internal view returns (bytes memory) {\n        return functionStaticCall(target, data, \"Address: low-level static call failed\");\n    }\n\n    /**\n     * @dev Same as {xref-Address-functionCall-address-bytes-string-}[`functionCall`],\n     * but performing a static call.\n     *\n     * _Available since v3.3._\n     */\n    function functionStaticCall(\n        address target,\n        bytes memory data,\n        string memory errorMessage\n    ) internal view returns (bytes memory) {\n        require(isContract(target), \"Address: static call to non-contract\");\n\n        (bool success, bytes memory returndata) = target.staticcall(data);\n        return verifyCallResult(success, returndata, errorMessage);\n    }\n\n    /**\n     * @dev Same as {xref-Address-functionCall-address-bytes-}[`functionCall`],\n     * but performing a delegate call.\n     *\n     * _Available since v3.4._\n     */\n    function functionDelegateCall(address target, bytes memory data) internal returns (bytes memory) {\n        return functionDelegateCall(target, data, \"Address: low-level delegate call failed\");\n    }\n\n    /**\n     * @dev Same as {xref-Address-functionCall-address-bytes-string-}[`functionCall`],\n     * but performing a delegate call.\n     *\n     * _Available since v3.4._\n     */\n    function functionDelegateCall(\n        address target,\n        bytes memory data,\n        string memory errorMessage\n    ) internal returns (bytes memory) {\n        require(isContract(target), \"Address: delegate call to non-contract\");\n\n        (bool success, bytes memory returndata) = target.delegatecall(data);\n        return verifyCallResult(success, returndata, errorMessage);\n    }\n\n    /**\n     * @dev Tool to verifies that a low level call was successful, and revert if it wasn't, either by bubbling the\n     * revert reason using the provided one.\n     *\n     * _Available since v4.3._\n     */\n    function verifyCallResult(\n        bool success,\n        bytes memory returndata,\n        string memory errorMessage\n    ) internal pure returns (bytes memory) {\n        if (success) {\n            return returndata;\n        } else {\n            // Look for revert reason and bubble it up if present\n            if (returndata.length > 0) {\n                // The easiest way to bubble the revert reason is using memory via assembly\n                /// @solidity memory-safe-assembly\n                assembly {\n                    let returndata_size := mload(returndata)\n                    revert(add(32, returndata), returndata_size)\n                }\n            } else {\n                revert(errorMessage);\n            }\n        }\n    }\n}\n\n\n// OpenZeppelin Contracts (last updated v4.7.0) (utils/StorageSlot.sol)\n\n\n\n/**\n * @dev Library for reading and writing primitive types to specific storage slots.\n *\n * Storage slots are often used to avoid storage conflict when dealing with upgradeable contracts.\n * This library helps with reading and writing to such slots without the need for inline assembly.\n *\n * The functions in this library return Slot structs that contain a `value` member that can be used to read or write.\n *\n * Example usage to set ERC1967 implementation slot:\n * ```\n * contract ERC1967 {\n *     bytes32 internal constant _IMPLEMENTATION_SLOT = 0x360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc;", "highlightLines": [279]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 279, "column": 57}, "severity": "high", "references": ["https://consensys.github.io/smart-contract-best-practices/attacks/reentrancy/"], "description": ""}, {"id": "a988560dd420", "fix": {"template": null, "available": false}, "title": "External call result copied to memory - malicious contract can return huge data (return bomb)", "ruleId": "rules.sol-return-bomb", "snippet": {"code": "        (bool success, bytes memory returndata) = target.staticcall(data);", "highlightLines": [306]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 306, "column": 9}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#return-bomb"], "description": ""}, {"id": "37e9f24e7557", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "        (bool success, bytes memory returndata) = target.staticcall(data);", "highlightLines": [306]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 306, "column": 51}, "severity": "medium", "references": [], "description": ""}, {"id": "92203578953c", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "        (bool success, bytes memory returndata) = target.delegatecall(data);", "highlightLines": [333]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 333, "column": 51}, "severity": "medium", "references": [], "description": ""}, {"id": "16b748668836", "fix": {"template": null, "available": false}, "title": "Delegatecall with user-controlled data - storage slot collision possible", "ruleId": "rules.sol-arbitrary-delegatecall-data", "snippet": {"code": "        (bool success, bytes memory returndata) = target.delegatecall(data);", "highlightLines": [333]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 333, "column": 57}, "severity": "high", "references": [], "description": ""}, {"id": "ac20a8be4e1b", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "                assembly {", "highlightLines": [355]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 355, "column": 17}, "severity": "info", "references": [], "description": ""}, {"id": "336749993dd4", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": " *     bytes32 internal constant _IMPLEMENTATION_SLOT = 0x360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc;", "highlightLines": [382]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 382, "column": 57}, "severity": "high", "references": [], "description": ""}, {"id": "b302e94cf5fb", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address value;", "highlightLines": [399]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 399, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "568eaeac5fae", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool value;", "highlightLines": [403]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 403, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "cb194cc8833b", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 value;", "highlightLines": [407]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 407, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3ace6eb8abaa", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 value;", "highlightLines": [411]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 411, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e4b600af7368", "fix": {"template": null, "available": false}, "title": "View/pure function uses assembly - may modify state unexpectedly", "ruleId": "rules.sol-constant-function-assembly", "snippet": {"code": "    function getAddressSlot(bytes32 slot) internal pure returns (AddressSlot storage r) {\n        /// @solidity memory-safe-assembly\n        assembly {", "highlightLines": [417]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 417, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-using-assembly-code"], "description": ""}, {"id": "949ded2af4f9", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [419]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 419, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "d40a6db00bdd", "fix": {"template": null, "available": false}, "title": "View/pure function uses assembly - may modify state unexpectedly", "ruleId": "rules.sol-constant-function-assembly", "snippet": {"code": "    function getBooleanSlot(bytes32 slot) internal pure returns (BooleanSlot storage r) {\n        /// @solidity memory-safe-assembly\n        assembly {", "highlightLines": [427]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 427, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-using-assembly-code"], "description": ""}, {"id": "1088c1ab3c41", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [429]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 429, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "3839af2a0151", "fix": {"template": null, "available": false}, "title": "View/pure function uses assembly - may modify state unexpectedly", "ruleId": "rules.sol-constant-function-assembly", "snippet": {"code": "    function getBytes32Slot(bytes32 slot) internal pure returns (Bytes32Slot storage r) {\n        /// @solidity memory-safe-assembly\n        assembly {", "highlightLines": [437]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 437, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-using-assembly-code"], "description": ""}, {"id": "16fe4d65ee1c", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [439]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 439, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "2af9a368cb39", "fix": {"template": null, "available": false}, "title": "View/pure function uses assembly - may modify state unexpectedly", "ruleId": "rules.sol-constant-function-assembly", "snippet": {"code": "    function getUint256Slot(bytes32 slot) internal pure returns (Uint256Slot storage r) {\n        /// @solidity memory-safe-assembly\n        assembly {", "highlightLines": [447]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 447, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-using-assembly-code"], "description": ""}, {"id": "deecbd011c5a", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [449]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 449, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "643354595b3e", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "    bytes32 private constant _ROLLBACK_SLOT = 0x4910fdfa16fed3260ed0e7147f7cc6da11a60208b5b9406d12a635614ffd9143;", "highlightLines": [466]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 466, "column": 47}, "severity": "high", "references": [], "description": ""}, {"id": "b2fb1ce6e38e", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "    bytes32 internal constant _IMPLEMENTATION_SLOT = 0x360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc;", "highlightLines": [473]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 473, "column": 54}, "severity": "high", "references": [], "description": ""}, {"id": "64c6d80d2a4d", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Upgraded(address indexed implementation);", "highlightLines": [478]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 478, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "58fb03dc3648", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "            try IERC1822Proxiable(newImplementation).proxiableUUID() returns (bytes32 slot) {", "highlightLines": [537]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 537, "column": 17}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "1b9076524645", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "    bytes32 internal constant _ADMIN_SLOT = 0xb53127684a568b3173ae13b9f8a6016e243e63b6e8ee1178d6a717850b5d6103;", "highlightLines": [551]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 551, "column": 45}, "severity": "high", "references": [], "description": ""}, {"id": "add382b2e003", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event AdminChanged(address previousAdmin, address newAdmin);", "highlightLines": [556]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 556, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "94b3bd11336d", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event AdminChanged(address previousAdmin, address newAdmin);", "highlightLines": [556]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 556, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "a07ce71f1cfa", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "    bytes32 internal constant _BEACON_SLOT = 0xa3f0ad74e5423aebfd80d3ef4346578335a9a72aeaee59ff6cb3582b35133d50;", "highlightLines": [587]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 587, "column": 46}, "severity": "high", "references": [], "description": ""}, {"id": "f0711a003b53", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event BeaconUpgraded(address indexed beacon);", "highlightLines": [592]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 592, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "b243e7ec0a7b", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "            Address.isContract(IBeacon(newBeacon).implementation()),", "highlightLines": [607]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 607, "column": 32}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "cc3b48f77a42", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "            Address.functionDelegateCall(IBeacon(newBeacon).implementation(), data);", "highlightLines": [627]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 627, "column": 42}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "b64f95a12b32", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(address _logic, bytes memory _data) payable {\n        _upgradeToAndCall(_logic, _data, false);\n    }", "highlightLines": [646]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 646, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "80f001521ce8", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(\n        address _logic,\n        address admin_,\n        bytes memory _data\n    ) payable ERC1967Proxy(_logic, _data) {\n        _changeAdmin(admin_);\n    }", "highlightLines": [685]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 685, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "231c3acf406d", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "    modifier ifAdmin() {\n        if (msg.sender == _getAdmin()) {\n            _;\n        } else {", "highlightLines": [696]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 696, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "9fba3d06eaaa", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier ifAdmin() {\n        if (msg.sender == _getAdmin()) {\n            _;\n        } else {\n            _fallback();\n        }\n    }", "highlightLines": [696]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 696, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "6619e33e8565", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "            _;", "highlightLines": [698]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 698, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "cccad8c39519", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "     * `0xb53127684a568b3173ae13b9f8a6016e243e63b6e8ee1178d6a717850b5d6103`", "highlightLines": [711]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 711, "column": 9}, "severity": "high", "references": [], "description": ""}, {"id": "fe40fbfb09a6", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "     * `0x360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc`", "highlightLines": [724]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 724, "column": 9}, "severity": "high", "references": [], "description": ""}, {"id": "5e398b41e13a", "fix": {"template": null, "available": false}, "title": "Diamond upgrade function without timelock - instant rug pull possible", "ruleId": "rules.sol-diamond-upgrade-no-timelock", "snippet": {"code": "    function upgradeTo(address newImplementation) external ifAdmin {", "highlightLines": [746]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 746, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "611e47d26b2f", "fix": {"template": null, "available": false}, "title": "Proxy upgrade executable immediately - malicious upgrade can drain funds before users react", "ruleId": "rules.sol-proxy-upgrade-no-delay", "snippet": {"code": "    function upgradeTo(address newImplementation) external ifAdmin {", "highlightLines": [746]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 746, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "363421fbee57", "fix": {"template": null, "available": false}, "title": "Proxy upgrade executable immediately - malicious upgrade can drain funds before users react", "ruleId": "rules.sol-proxy-upgrade-no-delay", "snippet": {"code": "    function upgradeToAndCall(address newImplementation, bytes calldata data) external payable ifAdmin {", "highlightLines": [757]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 757, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "bc17a047b2a3", "fix": {"template": null, "available": false}, "title": "Upgradeable contract without storage gap - adding variables in parent will corrupt child storage", "ruleId": "rules.sol-missing-storage-gap", "snippet": {"code": "contract ProxyStats is TransparentUpgradeableProxy {", "highlightLines": [778]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 778, "column": 1}, "severity": "medium", "references": ["https://docs.openzeppelin.com/upgrades-plugins/writing-upgradeable"], "description": ""}, {"id": "51b39c48fe5a", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor(\n        address _impl,\n        address _admin,\n        address _ethernautAddress\n    )\n        TransparentUpgradeableProxy(\n            _impl,\n            _admin,\n            abi.encodeWithSignature(\"initialize(address)\", _ethernautAddress)\n        )\n    {}", "highlightLines": [779]}, "category": "code", "location": {"file": "contracts/out/ProxyStats_flat.sol", "line": 779, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "3a65d3bc35fe", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.8.0;", "highlightLines": [2]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "bfcf1df9e888", "fix": {"template": null, "available": false}, "title": "Upgradeable contract without storage gap - adding variables in parent will corrupt child storage", "ruleId": "rules.sol-missing-storage-gap", "snippet": {"code": " * contract MyToken is ERC20Upgradeable {", "highlightLines": [21]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 21, "column": 4}, "severity": "medium", "references": ["https://docs.openzeppelin.com/upgrades-plugins/writing-upgradeable"], "description": ""}, {"id": "c4f5037dfa37", "fix": {"template": null, "available": false}, "title": "Initializer function not protected - can be called multiple times", "ruleId": "rules.sol-initializer-not-protected", "snippet": {"code": " *     function initialize() initializer public {", "highlightLines": [22]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 22, "column": 8}, "severity": "high", "references": [], "description": ""}, {"id": "bb232fbefbdb", "fix": {"template": null, "available": false}, "title": "Upgradeable contract without storage gap - adding variables in parent will corrupt child storage", "ruleId": "rules.sol-missing-storage-gap", "snippet": {"code": " * contract MyTokenV2 is MyToken, ERC20PermitUpgradeable {", "highlightLines": [26]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 26, "column": 4}, "severity": "medium", "references": ["https://docs.openzeppelin.com/upgrades-plugins/writing-upgradeable"], "description": ""}, {"id": "237ad19ac3ef", "fix": {"template": null, "available": false}, "title": "Initializer function not protected - can be called multiple times", "ruleId": "rules.sol-initializer-not-protected", "snippet": {"code": " *     function initializeV2() reinitializer(2) public {", "highlightLines": [27]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 27, "column": 8}, "severity": "high", "references": [], "description": ""}, {"id": "06b416ba4fe7", "fix": {"template": null, "available": false}, "title": "isContract check can be bypassed by calling from constructor - extcodesize is 0 during construction", "ruleId": "rules.sol-ethernaut-iscontract-bypass", "snippet": {"code": "        return account.code.length > 0;", "highlightLines": [63]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 63, "column": 16}, "severity": "high", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2943"], "description": ""}, {"id": "18e680096d14", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event Initialized(uint8 version);", "highlightLines": [79]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 79, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "b4e5d2189db2", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier initializer() {\n        bool isTopLevelCall = !_initializing;\n        require(\n            (isTopLevelCall && _initialized < 1) || (!isContract(address(this)) && _initialized == 1),\n            \"Initializable: contract is already initialized\"\n        );\n        _initialized = 1;\n        if (isTopLevelCall) {\n            _initializing = true;\n        }\n        _;\n        if (isTopLevelCall) {\n            _initializing = false;\n            emit Initialized(1);\n        }\n    }", "highlightLines": [90]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 90, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "85707a780da1", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool isTopLevelCall = !_initializing;", "highlightLines": [91]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 91, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "2786974b4bf3", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bool isTopLevelCall = !_initializing;\n        require(\n            (isTopLevelCall && _initialized < 1) || (!isContract(address(this)) && _initialized == 1),\n            \"Initializable: contract is already initialized\"\n        );\n        _initialized = 1;", "highlightLines": [91]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 91, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "3b7abbec5716", "fix": {"template": null, "available": false}, "title": "Variable written twice without being read between - first write is dead store", "ruleId": "rules.sol-write-after-write", "snippet": {"code": "            (isTopLevelCall && _initialized < 1) || (!isContract(address(this)) && _initialized == 1),\n            \"Initializable: contract is already initialized\"\n        );\n        _initialized = 1;", "highlightLines": [93]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 93, "column": 84}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#write-after-write"], "description": ""}, {"id": "c8e22e414cbf", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        _initialized = 1;\n        if (isTopLevelCall) {\n            _initializing = true;\n        }", "highlightLines": [96]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 96, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d354a3723b6e", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [100]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 100, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "2603057be9d7", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier reinitializer(uint8 version) {\n        require(!_initializing && _initialized < version, \"Initializable: contract is already initialized\");\n        _initialized = version;\n        _initializing = true;\n        _;\n        _initializing = false;\n        emit Initialized(version);\n    }", "highlightLines": [125]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 125, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "99183ac9bac5", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "    modifier reinitializer(uint8 version) {\n        require(!_initializing && _initialized < version, \"Initializable: contract is already initialized\");\n        _initialized = version;\n        _initializing = true;\n        _;\n        _initializing = false;\n        emit Initialized(version);\n    }", "highlightLines": [125]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 125, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "9d6fc4250bae", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        _initialized = version;\n        _initializing = true;", "highlightLines": [127]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 127, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "fdbee12adce8", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        _initializing = true;\n        _;\n        _initializing = false;", "highlightLines": [128]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 128, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e1e5c0311c5b", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [129]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 129, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "2aff8cd507d4", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyInitializing() {\n        require(_initializing, \"Initializable: contract is not initializing\");\n        _;\n    }", "highlightLines": [138]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 138, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "92c50c7979bd", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "    modifier onlyInitializing() {\n        require(_initializing, \"Initializable: contract is not initializing\");\n        _;\n    }", "highlightLines": [138]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 138, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "82a64a51e5f2", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [140]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 140, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "4abfdab950d4", "fix": {"template": null, "available": false}, "title": "Upgradeable contract without storage gap - future upgrade collision risk", "ruleId": "rules.sol-no-gap-storage", "snippet": {"code": "contract Statistics is Initializable {", "highlightLines": [175]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 175, "column": 1}, "severity": "info", "references": ["https://docs.openzeppelin.com/contracts/4.x/upgradeable#storage_gaps"], "description": ""}, {"id": "8b1bbde0604c", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract Statistics is Initializable {\n    address public ethernaut;\n    address[] public players;\n    address[] public levels;\n    uint256 private globalNoOfInstancesCreated;\n    uint256 private globalNoOfInstancesCompleted;\n    uint256 private globalNoOfFailedSubmissions;\n    struct LevelInstance {\n        address instance;\n        bool isCompleted;\n        uint256 timeCreated;\n        uint256 timeCompleted;", "highlightLines": [175]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 175, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "c2301412e90c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address instance;", "highlightLines": [183]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 183, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "2c3e26acf2f1", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool isCompleted;", "highlightLines": [184]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 184, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ddbe3c85e257", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 timeCreated;", "highlightLines": [185]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 185, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c3f062608ab8", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 timeCompleted;", "highlightLines": [186]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 186, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "50e14f02efaa", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 noOfInstancesCreated;", "highlightLines": [190]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 190, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3f7791009245", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 noOfInstancesSubmitted_Success;", "highlightLines": [191]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 191, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "cee011b17bf6", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 noOfSubmissions_Failed;", "highlightLines": [192]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 192, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3db142633ec6", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier levelExistsCheck(address level) {\n        require(doesLevelExist(level), \"Level doesn't exist\");\n        _;\n    }", "highlightLines": [204]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 204, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "d0242eedbe22", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [206]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 206, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "0ebfc4c248a0", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier levelDoesntExistCheck(address level) {\n        require(!doesLevelExist(level), \"Level already exists\");\n        _;\n    }", "highlightLines": [208]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 208, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "c0dd0d2cd246", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [210]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 210, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "2458af62938d", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier playerExistsCheck(address player) {\n        require(doesPlayerExist(player), \"Player doesn't exist\");\n        _;\n    }", "highlightLines": [212]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 212, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "5fa350ef2653", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [214]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 214, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "e2b0b36638e7", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyEthernaut() {\n        require(\n            msg.sender == ethernaut,\n            \"Only Ethernaut can call this function\"\n        );\n        _;\n    }", "highlightLines": [216]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 216, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "4a7e966b40f9", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "    modifier onlyEthernaut() {\n        require(\n            msg.sender == ethernaut,\n            \"Only Ethernaut can call this function\"\n        );\n        _;\n    }", "highlightLines": [216]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 216, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "277ed60da453", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [221]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 221, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "aeed2b6bc417", "fix": {"template": null, "available": false}, "title": "Initializer function not protected - can be called multiple times", "ruleId": "rules.sol-initializer-not-protected", "snippet": {"code": "    function initialize(address _ethernautAddress) public initializer {", "highlightLines": [224]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 224, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "40c26d4a76bc", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "            levelFirstInstanceCreationTime[player][level] = block.timestamp;", "highlightLines": [240]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 240, "column": 61}, "severity": "medium", "references": [], "description": ""}, {"id": "b9a27a9fa6bc", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "            block.timestamp,", "highlightLines": [245]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 245, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "285dc444c5fe", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function submitSuccess(\n        address instance,\n        address level,\n        address player\n    ) external onlyEthernaut levelExistsCheck(level) playerExistsCheck(player) {\n        require(\n            playerStats[player][level].instance != address(0),\n            \"Instance for the level is not created\"\n        );\n        require(\n            playerStats[player][level].instance == instance,", "highlightLines": [256]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 256, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "f11a75c3926c", "fix": {"template": null, "available": false}, "title": "Unnecessary comparison to boolean constant - use variable directly", "ruleId": "rules.sol-boolean-constant-comparison", "snippet": {"code": "            playerStats[player][level].isCompleted == false,", "highlightLines": [270]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 270, "column": 52}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#boolean-equality"], "description": ""}, {"id": "8391a85d202e", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "            levelFirstCompletionTime[player][level] = block.timestamp;", "highlightLines": [276]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 276, "column": 55}, "severity": "medium", "references": [], "description": ""}, {"id": "f61dc85ea0f7", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        playerStats[player][level].timeSubmitted.push(block.timestamp);", "highlightLines": [278]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 278, "column": 55}, "severity": "medium", "references": [], "description": ""}, {"id": "60d95bd84338", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        playerStats[player][level].timeCompleted = block.timestamp;\n        playerStats[player][level].isCompleted = true;", "highlightLines": [279]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 279, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "2a3de89cd3f5", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        playerStats[player][level].timeCompleted = block.timestamp;", "highlightLines": [279]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 279, "column": 52}, "severity": "medium", "references": [], "description": ""}, {"id": "eacfa3bfcc8c", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function submitFailure(\n        address instance,\n        address level,\n        address player\n    ) external onlyEthernaut levelExistsCheck(level) playerExistsCheck(player) {\n        require(\n            playerStats[player][level].instance != address(0),\n            \"Instance for the level is not created\"\n        );\n        require(\n            playerStats[player][level].instance == instance,", "highlightLines": [286]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 286, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "088aea45e27d", "fix": {"template": null, "available": false}, "title": "Unnecessary comparison to boolean constant - use variable directly", "ruleId": "rules.sol-boolean-constant-comparison", "snippet": {"code": "            playerStats[player][level].isCompleted == false,", "highlightLines": [300]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 300, "column": 52}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#boolean-equality"], "description": ""}, {"id": "9f6081370a45", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        playerStats[player][level].timeSubmitted.push(block.timestamp);", "highlightLines": [303]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 303, "column": 55}, "severity": "medium", "references": [], "description": ""}, {"id": "0a7e72da9728", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    // Percentage of total levels completed by player (1e18 = 100%)", "highlightLines": [419]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 419, "column": 56}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "85ca152c0581", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        // Changed from 100 to 1e18 otherwise when levels.length > 100 this will round to 0 always", "highlightLines": [426]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 426, "column": 32}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "7aebddae52fc", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimal assumption - tokens with >18 or <18 decimals will cause overflow/underflow", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "            (getTotalNoOfLevelsCompletedByPlayer(player) * 1e18) /", "highlightLines": [428]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 428, "column": 58}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20"], "description": ""}, {"id": "92c616140d21", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "            (getTotalNoOfLevelsCompletedByPlayer(player) * 1e18) /", "highlightLines": [428]}, "category": "code", "location": {"file": "contracts/out/Statistics_flat.sol", "line": 428, "column": 60}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "6a305139bb6f", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "        '0x4ef1d2ad89edf8c4d91132028e8195cdf30bb4b5053d4f8cd260341d4805f30a'; // location of owner ptr, offset by array's frame of reference", "highlightLines": [51]}, "category": "code", "location": {"file": "contracts/test/levels/AlienCodex.test.js", "line": 51, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "ddae253aa034", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "        '0x4ef1d2ad89edf8c4d91132028e8195cdf30bb4b5053d4f8cd260341d4805f30a'; // location of owner ptr, offset by array's frame of reference", "highlightLines": [51]}, "category": "code", "location": {"file": "contracts/test/levels/AlienCodex.test.js", "line": 51, "column": 10}, "severity": "high", "references": [], "description": ""}, {"id": "ac4e571075e3", "fix": {"template": null, "available": false}, "title": "Secret/token logged to console - remove in production (CWE-532)", "ruleId": "rules.js-console-log-secret", "snippet": {"code": "    //console.log(`init token balances are: ${token_one_balance} for token1 and ${token_two_balance} for token2`)", "highlightLines": [45]}, "category": "code", "location": {"file": "contracts/test/levels/Dex.test.js", "line": 45, "column": 7}, "severity": "high", "references": [], "description": ""}, {"id": "1da2ed6d900e", "fix": {"template": null, "available": false}, "title": "Logging potentially sensitive data - avoid logging credentials (CWE-532)", "ruleId": "rules.nodejs-console-log-sensitive", "snippet": {"code": "    //console.log(`init token balances are: ${token_one_balance} for token1 and ${token_two_balance} for token2`)", "highlightLines": [45]}, "category": "code", "location": {"file": "contracts/test/levels/Dex.test.js", "line": 45, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "6da1df77d59d", "fix": {"template": null, "available": false}, "title": "Secret/token logged to console - remove in production (CWE-532)", "ruleId": "rules.js-console-log-secret", "snippet": {"code": "    //console.log(`new token balances are: ${token_one_balance} for token1 and ${token_two_balance} for token2 after first swap`)", "highlightLines": [64]}, "category": "code", "location": {"file": "contracts/test/levels/Dex.test.js", "line": 64, "column": 7}, "severity": "high", "references": [], "description": ""}, {"id": "8e23fa799104", "fix": {"template": null, "available": false}, "title": "Logging potentially sensitive data - avoid logging credentials (CWE-532)", "ruleId": "rules.nodejs-console-log-sensitive", "snippet": {"code": "    //console.log(`new token balances are: ${token_one_balance} for token1 and ${token_two_balance} for token2 after first swap`)", "highlightLines": [64]}, "category": "code", "location": {"file": "contracts/test/levels/Dex.test.js", "line": 64, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "5b4f8d247ea7", "fix": {"template": null, "available": false}, "title": "Secret/token logged to console - remove in production (CWE-532)", "ruleId": "rules.js-console-log-secret", "snippet": {"code": "    //console.log(`new token balances are: ${token_one_balance} for token1 and ${token_two_balance} for token2`)", "highlightLines": [75]}, "category": "code", "location": {"file": "contracts/test/levels/Dex.test.js", "line": 75, "column": 7}, "severity": "high", "references": [], "description": ""}, {"id": "a33a42f56a99", "fix": {"template": null, "available": false}, "title": "Logging potentially sensitive data - avoid logging credentials (CWE-532)", "ruleId": "rules.nodejs-console-log-sensitive", "snippet": {"code": "    //console.log(`new token balances are: ${token_one_balance} for token1 and ${token_two_balance} for token2`)", "highlightLines": [75]}, "category": "code", "location": {"file": "contracts/test/levels/Dex.test.js", "line": 75, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "a1d088f6b03f", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "      '0x360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc'", "highlightLines": [56]}, "category": "code", "location": {"file": "contracts/test/levels/Motorbike.test.js", "line": 56, "column": 8}, "severity": "medium", "references": [], "description": ""}, {"id": "716926ae43c2", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "      '0x360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc'", "highlightLines": [56]}, "category": "code", "location": {"file": "contracts/test/levels/Motorbike.test.js", "line": 56, "column": 8}, "severity": "high", "references": [], "description": ""}, {"id": "efbda13e2b88", "fix": {"template": null, "available": false}, "title": "Pug unescaped output - XSS risk if variable contains user input", "ruleId": "rules.pug-render-unescaped", "snippet": {"code": "    assert(firstLibraryAddress != adjustedAddress);", "highlightLines": [59]}, "category": "code", "location": {"file": "contracts/test/levels/Preservation.test.js", "line": 59, "column": 32}, "severity": "medium", "references": [], "description": ""}, {"id": "bcc73f04f71d", "fix": {"template": null, "available": false}, "title": "Secret/token logged to console - remove in production (CWE-532)", "ruleId": "rules.js-console-log-secret", "snippet": {"code": "    //console.log('creating a new token...')", "highlightLines": [56]}, "category": "code", "location": {"file": "contracts/test/levels/Recovery.test.js", "line": 56, "column": 7}, "severity": "high", "references": [], "description": ""}, {"id": "4412b2f5fbe5", "fix": {"template": null, "available": false}, "title": "Logging potentially sensitive data - avoid logging credentials (CWE-532)", "ruleId": "rules.nodejs-console-log-sensitive", "snippet": {"code": "    //console.log('creating a new token...')", "highlightLines": [56]}, "category": "code", "location": {"file": "contracts/test/levels/Recovery.test.js", "line": 56, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "1ec14e0a1387", "fix": {"template": null, "available": false}, "title": "Secret/token logged to console - remove in production (CWE-532)", "ruleId": "rules.js-console-log-secret", "snippet": {"code": "    //console.log(`token supply: ${supply}`)", "highlightLines": [40]}, "category": "code", "location": {"file": "contracts/test/levels/Token.test.js", "line": 40, "column": 7}, "severity": "high", "references": [], "description": ""}, {"id": "e368f340e091", "fix": {"template": null, "available": false}, "title": "Logging potentially sensitive data - avoid logging credentials (CWE-532)", "ruleId": "rules.nodejs-console-log-sensitive", "snippet": {"code": "    //console.log(`token supply: ${supply}`)", "highlightLines": [40]}, "category": "code", "location": {"file": "contracts/test/levels/Token.test.js", "line": 40, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "5aa548170f1f", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "        const totalLevels = await statistics.getTotalNoOfLevelInstancesCreatedByPlayer(PLAYER_ADDRESS_1);", "highlightLines": [100]}, "category": "code", "location": {"file": "contracts/test/metrics/player.test.js", "line": 100, "column": 46}, "severity": "medium", "references": [], "description": ""}, {"id": "86607f63a477", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "        const totalLevels = await statistics.getTotalNoOfLevelInstancesCompletedByPlayer(PLAYER_ADDRESS_1);", "highlightLines": [105]}, "category": "code", "location": {"file": "contracts/test/metrics/player.test.js", "line": 105, "column": 46}, "severity": "medium", "references": [], "description": ""}, {"id": "CVE-2025-27789", "fix": {"template": "Update @babel/helpers to 7.26.10, 8.0.0-alpha.17", "available": true}, "title": "@babel/helpers: Babel has inefficient RegExp complexity in generated code with .replace when transpiling named capturing groups", "ruleId": "trivy-CVE-2025-27789", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "medium", "references": ["https://github.com/babel/babel", "https://github.com/babel/babel/commit/d5952e80c0faa5ec20e35085531b6e572d31dad4", "https://github.com/babel/babel/pull/17173"], "description": "Babel is a compiler for writing next generation JavaScript. When using versions of Babel prior to 7.26.10 and 8.0.0-alpha.17 to compile regular expression named capturing groups, Babel will generate a polyfill for the `.replace` method that has quadratic complexity on some specific replacement pattern strings (i.e. the second argument passed to `.replace`). Generated code is vulnerable if all the following conditions are true: Using Babel to compile regular expression named capturing groups, using the `.replace` method on a regular expression that contains named capturing groups, and the code using untrusted strings as the second argument of `.replace`. This problem has been fixed in `@babel/helpers` and `@babel/runtime` 7.26.10 and 8.0.0-alpha.17. It's likely that individual users do not directly depend on `@babel/helpers`, and instead depend on `@babel/core` (which itself depends on `@babel/helpers`). Upgrading to `@babel/core` 7.26.10 is not required, but it guarantees use of a new enough `@babel/helpers` version. Note that just updating Babel dependencies is not enough; one will also need to re-compile the code. No known workarounds are available."}, {"id": "CVE-2025-27789", "fix": {"template": "Update @babel/runtime to 7.26.10, 8.0.0-alpha.17", "available": true}, "title": "@babel/runtime: Babel has inefficient RegExp complexity in generated code with .replace when transpiling named capturing groups", "ruleId": "trivy-CVE-2025-27789", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "medium", "references": ["https://github.com/babel/babel", "https://github.com/babel/babel/commit/d5952e80c0faa5ec20e35085531b6e572d31dad4", "https://github.com/babel/babel/pull/17173"], "description": "Babel is a compiler for writing next generation JavaScript. When using versions of Babel prior to 7.26.10 and 8.0.0-alpha.17 to compile regular expression named capturing groups, Babel will generate a polyfill for the `.replace` method that has quadratic complexity on some specific replacement pattern strings (i.e. the second argument passed to `.replace`). Generated code is vulnerable if all the following conditions are true: Using Babel to compile regular expression named capturing groups, using the `.replace` method on a regular expression that contains named capturing groups, and the code using untrusted strings as the second argument of `.replace`. This problem has been fixed in `@babel/helpers` and `@babel/runtime` 7.26.10 and 8.0.0-alpha.17. It's likely that individual users do not directly depend on `@babel/helpers`, and instead depend on `@babel/core` (which itself depends on `@babel/helpers`). Upgrading to `@babel/core` 7.26.10 is not required, but it guarantees use of a new enough `@babel/helpers` version. Note that just updating Babel dependencies is not enough; one will also need to re-compile the code. No known workarounds are available."}, {"id": "CVE-2025-27789", "fix": {"template": "Update @babel/runtime-corejs3 to 7.26.10, 8.0.0-alpha.17", "available": true}, "title": "@babel/runtime-corejs3: Babel has inefficient RegExp complexity in generated code with .replace when transpiling named capturing groups", "ruleId": "trivy-CVE-2025-27789", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "medium", "references": ["https://github.com/babel/babel", "https://github.com/babel/babel/commit/d5952e80c0faa5ec20e35085531b6e572d31dad4", "https://github.com/babel/babel/pull/17173"], "description": "Babel is a compiler for writing next generation JavaScript. When using versions of Babel prior to 7.26.10 and 8.0.0-alpha.17 to compile regular expression named capturing groups, Babel will generate a polyfill for the `.replace` method that has quadratic complexity on some specific replacement pattern strings (i.e. the second argument passed to `.replace`). Generated code is vulnerable if all the following conditions are true: Using Babel to compile regular expression named capturing groups, using the `.replace` method on a regular expression that contains named capturing groups, and the code using untrusted strings as the second argument of `.replace`. This problem has been fixed in `@babel/helpers` and `@babel/runtime` 7.26.10 and 8.0.0-alpha.17. It's likely that individual users do not directly depend on `@babel/helpers`, and instead depend on `@babel/core` (which itself depends on `@babel/helpers`). Upgrading to `@babel/core` 7.26.10 is not required, but it guarantees use of a new enough `@babel/helpers` version. Note that just updating Babel dependencies is not enough; one will also need to re-compile the code. No known workarounds are available."}, {"id": "CVE-2023-45133", "fix": {"template": "Update @babel/traverse to 7.23.2, 8.0.0-alpha.4", "available": true}, "title": "@babel/traverse: babel: arbitrary code execution", "ruleId": "trivy-CVE-2023-45133", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "critical", "references": ["https://access.redhat.com/security/cve/CVE-2023-45133", "https://babeljs.io/blog/2023/10/16/cve-2023-45133", "https://github.com/babel/babel"], "description": "Babel is a compiler for writingJavaScript. In `@babel/traverse` prior to versions 7.23.2 and 8.0.0-alpha.4 and all versions of `babel-traverse`, using Babel to compile code that was specifically crafted by an attacker can lead to arbitrary code execution during compilation, when using plugins that rely on the `path.evaluate()`or `path.evaluateTruthy()` internal Babel methods. Known affected plugins are `@babel/plugin-transform-runtime`; `@babel/preset-env` when using its `useBuiltIns` option; and any \"polyfill provider\" plugin that depends on `@babel/helper-define-polyfill-provider`, such as `babel-plugin-polyfill-corejs3`, `babel-plugin-polyfill-corejs2`, `babel-plugin-polyfill-es-shims`, `babel-plugin-polyfill-regenerator`. No other plugins under the `@babel/` namespace are impacted, but third-party plugins might be. Users that only compile trusted code are not impacted. The vulnerability has been fixed in `@babel/traverse@7.23.2` and `@babel/traverse@8.0.0-alpha.4`. Those who cannot upgrade `@babel/traverse` and are using one of the affected packages mentioned above should upgrade them to their latest version to avoid triggering the vulnerable code path in affected `@babel/traverse` versions: `@babel/plugin-transform-runtime` v7.23.2, `@babel/preset-env` v7.23.2, `@babel/helper-define-polyfill-provider` v0.4.3, `babel-plugin-polyfill-corejs2` v0.4.6, `babel-plugin-polyfill-corejs3` v0.8.5, `babel-plugin-polyfill-es-shims` v0.10.0, `babel-plugin-polyfill-regenerator` v0.5.3."}, {"id": "CVE-2021-46320", "fix": {"template": "Update @openzeppelin/contracts to 4.4.1", "available": true}, "title": "@openzeppelin/contracts: Improper Initialization in OpenZeppelin", "ruleId": "trivy-CVE-2021-46320", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "high", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts", "https://github.com/OpenZeppelin/openzeppelin-contracts/pull/3006", "https://github.com/OpenZeppelin/openzeppelin-contracts/releases/tag/v4.4.1"], "description": "In OpenZeppelin <=v4.4.0, initializer functions that are invoked separate from contract creation (the most prominent example being minimal proxies) may be reentered if they make an untrusted non-view external call. Once an initializer has finished running it can never be re-executed. However, an exception put in place to support multiple inheritance made reentrancy possible, breaking the expectation that there is a single execution."}, {"id": "CVE-2022-35915", "fix": {"template": "Update @openzeppelin/contracts to 4.7.2", "available": true}, "title": "@openzeppelin/contracts: OpenZeppelin Contracts ERC165Checker unbounded gas consumption", "ruleId": "trivy-CVE-2022-35915", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "medium", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts", "https://github.com/OpenZeppelin/openzeppelin-contracts/pull/3587", "https://github.com/OpenZeppelin/openzeppelin-contracts/releases/tag/v4.7.2"], "description": "OpenZeppelin Contracts is a library for secure smart contract development. The target contract of an EIP-165 `supportsInterface` query can cause unbounded gas consumption by returning a lot of data, while it is generally assumed that this operation has a bounded cost. The issue has been fixed in v4.7.2. Users are advised to upgrade. There are no known workarounds for this issue."}, {"id": "CVE-2022-39384", "fix": {"template": "Update @openzeppelin/contracts to 4.4.1", "available": true}, "title": "@openzeppelin/contracts: OpenZeppelin Contracts initializer reentrancy may lead to double initialization", "ruleId": "trivy-CVE-2022-39384", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "medium", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts", "https://github.com/OpenZeppelin/openzeppelin-contracts/pull/3006", "https://github.com/OpenZeppelin/openzeppelin-contracts/security/advisories/GHSA-9c22-pwxw-p6hx"], "description": "OpenZeppelin Contracts is a library for secure smart contract development. Before version 4.4.1 but after 3.2.0, initializer functions that are invoked separate from contract creation (the most prominent example being minimal proxies) may be reentered if they make an untrusted non-view external call. Once an initializer has finished running it can never be re-executed. However, an exception put in place to support multiple inheritance made reentrancy possible in the scenario described above, breaking the expectation that there is a single execution. Note that upgradeable proxies are commonly initialized together with contract creation, where reentrancy is not feasible, so the impact of this issue is believed to be minor. This issue has been patched, please upgrade to version 4.4.1. As a workaround, avoid untrusted external calls during initialization."}, {"id": "CVE-2023-30541", "fix": {"template": "Update @openzeppelin/contracts to 4.8.3", "available": true}, "title": "@openzeppelin/contracts: OpenZeppelin Contracts TransparentUpgradeableProxy clashing selector calls may not be delegated", "ruleId": "trivy-CVE-2023-30541", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "medium", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts", "https://github.com/OpenZeppelin/openzeppelin-contracts-upgradeable/commit/58fa0f81c4036f1a3b616fdffad2fd27e5d5ce21", "https://github.com/OpenZeppelin/openzeppelin-contracts/pull/4154"], "description": "OpenZeppelin Contracts is a library for secure smart contract development. A function in the implementation contract may be inaccessible if its selector clashes with one of the proxy's own selectors. Specifically, if the clashing function has a different signature with incompatible ABI encoding, the proxy could revert while attempting to decode the arguments from calldata. The probability of an accidental clash is negligible, but one could be caused deliberately and could cause a reduction in availability. The issue has been fixed in version 4.8.3. As a workaround if a function appears to be inaccessible for this reason, it may be possible to craft the calldata such that ABI decoding does not fail at the proxy and the function is properly proxied through."}, {"id": "CVE-2023-30542", "fix": {"template": "Update @openzeppelin/contracts to 4.8.3", "available": true}, "title": "@openzeppelin/contracts: GovernorCompatibilityBravo may trim proposal calldata", "ruleId": "trivy-CVE-2023-30542", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "high", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts", "https://github.com/OpenZeppelin/openzeppelin-contracts/commit/8d633cb7d169f2f8595b273660b00b69e845c2fe", "https://github.com/OpenZeppelin/openzeppelin-contracts/releases/tag/v4.8.3"], "description": "OpenZeppelin Contracts is a library for secure smart contract development. The proposal creation entrypoint (`propose`) in `GovernorCompatibilityBravo` allows the creation of proposals with a `signatures` array shorter than the `calldatas` array. This causes the additional elements of the latter to be ignored, and if the proposal succeeds the corresponding actions would eventually execute without any calldata. The `ProposalCreated` event correctly represents what will eventually execute, but the proposal parameters as queried through `getActions` appear to respect the original intended calldata. This issue has been patched in 4.8.3. As a workaround, ensure that all proposals that pass through governance have equal length `signatures` and `calldatas` parameters."}, {"id": "CVE-2023-34234", "fix": {"template": "Update @openzeppelin/contracts to 4.9.1", "available": true}, "title": "@openzeppelin/contracts: OpenZeppelin Contracts's governor proposal creation may be blocked by frontrunning", "ruleId": "trivy-CVE-2023-34234", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "medium", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts", "https://github.com/OpenZeppelin/openzeppelin-contracts-upgradeable/commit/66f390fa516b550838e2c2f65132b5bc2afe1ced", "https://github.com/OpenZeppelin/openzeppelin-contracts/commit/d9474327a492f9f310f31bc53f38dbea56ed9a57"], "description": " OpenZeppelin Contracts is a library for smart contract development. By frontrunning the creation of a proposal, an attacker can become the proposer and gain the ability to cancel it. The attacker can do this repeatedly to try to prevent a proposal from being proposed at all. This impacts the `Governor` contract in v4.9.0 only, and the `GovernorCompatibilityBravo` contract since v4.3.0. This problem has been patched in 4.9.1 by introducing opt-in frontrunning protection. Users are advised to upgrade. Users unable to upgrade may submit the proposal creation transaction to an endpoint with frontrunning protection as a workaround."}, {"id": "CVE-2023-34459", "fix": {"template": "Update @openzeppelin/contracts to 4.9.2", "available": true}, "title": "@openzeppelin/contracts: OpenZeppelin Contracts using MerkleProof multiproofs may allow proving arbitrary leaves for specific trees", "ruleId": "trivy-CVE-2023-34459", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "medium", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts", "https://github.com/OpenZeppelin/openzeppelin-contracts/commit/4d2383e17186be3e8ccf5a442e9686ecc7de1c55", "https://github.com/OpenZeppelin/openzeppelin-contracts/releases/tag/v4.9.2"], "description": "OpenZeppelin Contracts is a library for smart contract development. Starting in version 4.7.0 and prior to version 4.9.2, when the `verifyMultiProof`, `verifyMultiProofCalldata`, `procesprocessMultiProof`, or `processMultiProofCalldat` functions are in use, it is possible to construct merkle trees that allow forging a valid multiproof for an arbitrary set of leaves.\n\nA contract may be vulnerable if it uses multiproofs for verification and the merkle tree that is processed includes a node with value 0 at depth 1 (just under the root). This could happen inadvertedly for balanced trees with 3 leaves or less, if the leaves are not hashed. This could happen deliberately if a malicious tree builder includes such a node in the tree.\n\nA contract is not vulnerable if it uses single-leaf proving (`verify`, `verifyCalldata`, `processProof`, or `processProofCalldata`), or if it uses multiproofs with a known tree that has hashed leaves. Standard merkle trees produced or validated with the @openzeppelin/merkle-tree library are safe.\n\nThe problem has been patched in version 4.9.2.\n\nSome workarounds are available. For those using multiproofs: When constructing merkle trees hash the leaves and do not insert empty nodes in your trees. Using the @openzeppelin/merkle-tree package eliminates this issue. Do not accept user-provided merkle roots without reconstructing at least the first level of the tree. Verify the merkle tree structure by reconstructing it from the leaves."}, {"id": "CVE-2023-40014", "fix": {"template": "Update @openzeppelin/contracts to 4.9.3", "available": true}, "title": "@openzeppelin/contracts: OpenZeppelin Contracts vulnerable to Improper Escaping of Output", "ruleId": "trivy-CVE-2023-40014", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "medium", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts", "https://github.com/OpenZeppelin/openzeppelin-contracts/blob/v4.9.3/CHANGELOG.md", "https://github.com/OpenZeppelin/openzeppelin-contracts/commit/9445f96223041abf2bf08daa56f8da50b674cbcd"], "description": "OpenZeppelin Contracts is a library for secure smart contract development. Starting in version 4.0.0 and prior to version 4.9.3, contracts using `ERC2771Context` along with a custom trusted forwarder may see `_msgSender` return `address(0)` in calls that originate from the forwarder with calldata shorter than 20 bytes. This combination of circumstances does not appear to be common, in particular it is not the case for `MinimalForwarder` from OpenZeppelin Contracts, or any deployed forwarder the team is aware of, given that the signer address is appended to all calls that originate from these forwarders. The problem has been patched in v4.9.3.\n"}, {"id": "CVE-2024-27094", "fix": {"template": "Update @openzeppelin/contracts to 4.9.6, 5.0.2", "available": true}, "title": "@openzeppelin/contracts: OpenZeppelin Contracts base64 encoding may read from potentially dirty memory", "ruleId": "trivy-CVE-2024-27094", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "medium", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts", "https://github.com/OpenZeppelin/openzeppelin-contracts-upgradeable/commit/2d081f24cac1a867f6f73d512f2022e1fa987854", "https://github.com/OpenZeppelin/openzeppelin-contracts-upgradeable/commit/723f8cab09cdae1aca9ec9cc1cfa040c2d4b06c1"], "description": "OpenZeppelin Contracts is a library for secure smart contract development. The `Base64.encode` function encodes a `bytes` input by iterating over it in chunks of 3 bytes. When this input is not a multiple of 3, the last iteration may read parts of the memory that are beyond the input buffer. The vulnerability is fixed in 5.0.2 and 4.9.6."}, {"id": "GHSA-593m-55hh-j8gv", "fix": {"template": "Update @sentry/browser to 8.33.0, 7.119.1", "available": true}, "title": "@sentry/browser: Sentry SDK Prototype Pollution gadget in JavaScript SDKs", "ruleId": "trivy-GHSA-593m-55hh-j8gv", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "medium", "references": ["https://github.com/getsentry/sentry-javascript", "https://github.com/getsentry/sentry-javascript/commit/35bdc87dee3498794e34c1ad35dd9927950c8766", "https://github.com/getsentry/sentry-javascript/pull/13838"], "description": "### Impact\nIn case a Prototype Pollution vulnerability is present in a user's application or bundled libraries, the Sentry SDK could potentially serve as a gadget to exploit that vulnerability. The exploitability depends on the specific details of the underlying Prototype Pollution issue.\n\n> [!NOTE]\n> This advisory does not indicate the presence of a Prototype Pollution within the Sentry SDK itself. Users are strongly advised to first address any Prototype Pollution vulnerabilities in their application, as they pose a more critical security risk.\n\n### Patches\nThe issue was patched in all Sentry JavaScript SDKs starting from the [8.33.0](https://github.com/getsentry/sentry-javascript/releases/tag/8.33.0) version.\nAlso, the fix was backported to SDK v7 in [7.119.1](https://github.com/getsentry/sentry-javascript/releases/tag/7.119.1).\n\n### References\n* [Prototype Pollution](https://portswigger.net/web-security/prototype-pollution)\n* [Prototype Pollution gadgets](https://portswigger.net/web-security/prototype-pollution#prototype-pollution-gadgets)\n* [sentry-javascript#13838](https://github.com/getsentry/sentry-javascript/pull/13838)"}, {"id": "CVE-2021-23424", "fix": {"template": "Update ansi-html to 0.0.8", "available": true}, "title": "ansi-html: nodejs-ansi-html: ReDoS via crafted string", "ruleId": "trivy-CVE-2021-23424", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "high", "references": ["https://access.redhat.com/security/cve/CVE-2021-23424", "https://github.com/Tjatse/ansi-html", "https://github.com/Tjatse/ansi-html/commit/8142b25bca3133ea060bcc1889277dc482327a63"], "description": "This affects all versions of package ansi-html. If an attacker provides a malicious string, it will get stuck processing the input for an extremely long time."}, {"id": "CVE-2025-27152", "fix": {"template": "Update axios to 1.8.2, 0.30.0", "available": true}, "title": "axios: axios: Possible SSRF and Credential Leakage via Absolute URL in axios Requests", "ruleId": "trivy-CVE-2025-27152", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "high", "references": ["https://access.redhat.com/security/cve/CVE-2025-27152", "https://github.com/axios/axios", "https://github.com/axios/axios/commit/02c3c69ced0f8fd86407c23203835892313d7fde"], "description": "axios is a promise based HTTP client for the browser and node.js. The issue occurs when passing absolute URLs rather than protocol-relative URLs to axios. Even if baseURL is set, axios sends the request to the specified absolute URL, potentially causing SSRF and credential leakage. This issue impacts both server-side and client-side usage of axios. This issue is fixed in 1.8.2."}, {"id": "CVE-2025-58754", "fix": {"template": "Update axios to 1.12.0, 0.30.2", "available": true}, "title": "axios: axios: Axios DoS via lack of data size check", "ruleId": "trivy-CVE-2025-58754", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "high", "references": ["https://access.redhat.com/security/cve/CVE-2025-58754", "https://github.com/axios/axios", "https://github.com/axios/axios/commit/945435fc51467303768202250debb8d4ae892593"], "description": "Axios is a promise based HTTP client for the browser and Node.js. When Axios prior to versions 0.30.2 and 1.12.0 runs on Node.js and is given a URL with the `data:` scheme, it does not perform HTTP. Instead, its Node http adapter decodes the entire payload into memory (`Buffer`/`Blob`) and returns a synthetic 200 response. This path ignores `maxContentLength` / `maxBodyLength` (which only protect HTTP responses), so an attacker can supply a very large `data:` URI and cause the process to allocate unbounded memory and crash (DoS), even if the caller requested `responseType: 'stream'`. Versions 0.30.2 and 1.12.0 contain a patch for the issue."}, {"id": "CVE-2023-45857", "fix": {"template": "Update axios to 1.6.0, 0.28.0", "available": true}, "title": "axios: axios: exposure of confidential data stored in cookies", "ruleId": "trivy-CVE-2023-45857", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "medium", "references": ["https://access.redhat.com/security/cve/CVE-2023-45857", "https://github.com/axios/axios", "https://github.com/axios/axios/commit/2755df562b9c194fba6d8b609a383443f6a6e967"], "description": "An issue discovered in Axios 1.5.1 inadvertently reveals the confidential XSRF-TOKEN stored in cookies by including it in the HTTP header X-XSRF-TOKEN for every request made to any host allowing attackers to view sensitive information."}, {"id": "CVE-2025-27611", "fix": {"template": "Update base-x to 5.0.1, 4.0.1, 3.0.11", "available": true}, "title": "base-x: base-x: base-x homograph attack allows Unicode lookalike characters to bypass validation.", "ruleId": "trivy-CVE-2025-27611", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "high", "references": ["https://access.redhat.com/security/cve/CVE-2025-27611", "https://github.com/cryptocoinjs/base-x", "https://github.com/cryptocoinjs/base-x/pull/86"], "description": "base-x is a base encoder and decoder of any given alphabet using bitcoin style leading zero compression. Versions 4.0.0, 5.0.0, and all prior to 3.0.11, are vulnerable to attackers potentially deceiving users into sending funds to an unintended address. This issue has been patched in versions 3.0.11, 4.0.1, and 5.0.1."}, {"id": "CVE-2024-45590", "fix": {"template": "Update body-parser to 1.20.3", "available": true}, "title": "body-parser: body-parser: Denial of Service Vulnerability in body-parser", "ruleId": "trivy-CVE-2024-45590", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "high", "references": ["https://access.redhat.com/security/cve/CVE-2024-45590", "https://github.com/expressjs/body-parser", "https://github.com/expressjs/body-parser/commit/b2695c4450f06ba3b0ccf48d872a229bb41c9bce"], "description": "body-parser is Node.js body parsing middleware. body-parser <1.20.3 is vulnerable to denial of service when url encoding is enabled. A malicious actor using a specially crafted payload could flood the server with a large number of requests, resulting in denial of service. This issue is patched in 1.20.3."}, {"id": "CVE-2025-5889", "fix": {"template": "Update brace-expansion to 2.0.2, 1.1.12, 3.0.1, 4.0.1", "available": true}, "title": "brace-expansion: brace-expansion: juliangruber brace-expansion index.js expand redos", "ruleId": "trivy-CVE-2025-5889", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "low", "references": ["https://access.redhat.com/security/cve/CVE-2025-5889", "https://gist.github.com/mmmsssttt404/37a40ce7d6e5ca604858fe30814d9466", "https://github.com/juliangruber/brace-expansion"], "description": "A vulnerability was found in juliangruber brace-expansion up to 1.1.11/2.0.1/3.0.0/4.0.0. It has been rated as problematic. Affected by this issue is the function expand of the file index.js. The manipulation leads to inefficient regular expression complexity. The attack may be launched remotely. The complexity of an attack is rather high. The exploitation is known to be difficult. The exploit has been disclosed to the public and may be used. Upgrading to version 1.1.12, 2.0.2, 3.0.1 and 4.0.1 is able to address this issue. The name of the patch is a5b98a4f30d7813266b221435e1eaaf25a1b0ac5. It is recommended to upgrade the affected component."}, {"id": "CVE-2024-4068", "fix": {"template": "Update braces to 3.0.3", "available": true}, "title": "braces: braces: fails to limit the number of characters it can handle", "ruleId": "trivy-CVE-2024-4068", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "high", "references": ["https://access.redhat.com/security/cve/CVE-2024-4068", "https://devhub.checkmarx.com/cve-details/CVE-2024-4068", "https://devhub.checkmarx.com/cve-details/CVE-2024-4068/"], "description": "The NPM package `braces`, versions prior to 3.0.3, fails to limit the number of characters it can handle, which could lead to Memory Exhaustion. In `lib/parse.js,` if a malicious user sends \"imbalanced braces\" as input, the parsing will enter a loop, which will cause the program to start allocating heap memory without freeing it at any moment of the loop. Eventually, the JavaScript heap limit is reached, and the program will crash."}, {"id": "CVE-2023-46234", "fix": {"template": "Update browserify-sign to 4.2.2", "available": true}, "title": "browserify-sign: browserify-sign: upper bound check issue in dsaVerify leads to a signature forgery attack", "ruleId": "trivy-CVE-2023-46234", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "high", "references": ["https://access.redhat.com/security/cve/CVE-2023-46234", "https://github.com/browserify/browserify-sign", "https://github.com/browserify/browserify-sign/commit/85994cd6348b50f2fd1b73c54e20881416f44a30"], "description": "browserify-sign is a package to duplicate the functionality of node's crypto public key functions, much of this is based on Fedor Indutny's work on indutny/tls.js. An upper bound check issue in `dsaVerify` function allows an attacker to construct signatures that can be successfully verified by any public key, thus leading to a signature forgery attack. All places in this project that involve DSA verification of user-input signatures will be affected by this vulnerability. This issue has been patched in version 4.2.2."}, {"id": "CVE-2021-23364", "fix": {"template": "Update browserslist to 4.16.5", "available": true}, "title": "browserslist: browserslist: parsing of invalid queries could result in Regular Expression Denial of Service (ReDoS)", "ruleId": "trivy-CVE-2021-23364", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "medium", "references": ["https://access.redhat.com/security/cve/CVE-2021-23364", "https://github.com/browserslist/browserslist/blob/e82f32d1d4100d6bc79ea0b6b6a2d281a561e33c/index.js%23L472-L474", "https://github.com/browserslist/browserslist/commit/c091916910dfe0b5fd61caad96083c6709b02d98"], "description": "The package browserslist from 4.0.0 and before 4.16.5 are vulnerable to Regular Expression Denial of Service (ReDoS) during parsing of queries."}, {"id": "CVE-2025-9287", "fix": {"template": "Update cipher-base to 1.0.5", "available": true}, "title": "cipher-base: cipher-base: Cipher-base hash manipulation", "ruleId": "trivy-CVE-2025-9287", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "critical", "references": ["https://access.redhat.com/security/cve/CVE-2025-9287", "https://github.com/browserify/cipher-base", "https://github.com/browserify/cipher-base/commit/8fd136432ca298a664f5637629cf2b42a6c7f294"], "description": "Improper Input Validation vulnerability in cipher-base allows Input Data Manipulation.This issue affects cipher-base: through 1.0.4."}, {"id": "CVE-2024-47764", "fix": {"template": "Update cookie to 0.7.0", "available": true}, "title": "cookie: cookie: cookie accepts cookie name, path, and domain with out of bounds characters", "ruleId": "trivy-CVE-2024-47764", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "low", "references": ["https://access.redhat.com/security/cve/CVE-2024-47764", "https://github.com/jshttp/cookie", "https://github.com/jshttp/cookie/commit/e10042845354fea83bd8f34af72475eed1dadf5c"], "description": "cookie is a basic HTTP cookie parser and serializer for HTTP servers. The cookie name could be used to set other fields of the cookie, resulting in an unexpected cookie value. A similar escape can be used for path and domain, which could be abused to alter other fields of the cookie. Upgrade to 0.7.0, which updates the validation for name, path, and domain."}, {"id": "CVE-2022-25901", "fix": {"template": "Update cookiejar to 2.1.4", "available": true}, "title": "cookiejar: cookiejar: Regular Expression Denial of Service (ReDoS)", "ruleId": "trivy-CVE-2022-25901", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "medium", "references": ["https://access.redhat.com/security/cve/CVE-2022-25901", "https://github.com/bmeck/node-cookiejar", "https://github.com/bmeck/node-cookiejar/blob/master/cookiejar.js#23L73"], "description": "Versions of the package cookiejar before 2.1.4 are vulnerable to Regular Expression Denial of Service (ReDoS) via the Cookie.parse function, which uses an insecure regular expression."}, {"id": "CVE-2024-21538", "fix": {"template": "Update cross-spawn to 7.0.5, 6.0.6", "available": true}, "title": "cross-spawn: cross-spawn: regular expression denial of service", "ruleId": "trivy-CVE-2024-21538", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "high", "references": ["https://access.redhat.com/security/cve/CVE-2024-21538", "https://github.com/moxystudio/node-cross-spawn", "https://github.com/moxystudio/node-cross-spawn/commit/5ff3a07d9add449021d806e45c4168203aa833ff"], "description": "Versions of the package cross-spawn before 6.0.6, from 7.0.0 and before 7.0.5 are vulnerable to Regular Expression Denial of Service (ReDoS) due to improper input sanitization. An attacker can increase the CPU usage and crash the program by crafting a very large and well crafted string."}, {"id": "CVE-2022-38900", "fix": {"template": "Update decode-uri-component to 0.2.1", "available": true}, "title": "decode-uri-component: decode-uri-component: improper input validation resulting in DoS", "ruleId": "trivy-CVE-2022-38900", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "high", "references": ["https://access.redhat.com/errata/RHSA-2023:6316", "https://access.redhat.com/security/cve/CVE-2022-38900", "https://bugzilla.redhat.com/2170644"], "description": "decode-uri-component 0.2.0 is vulnerable to Improper Input Validation resulting in DoS."}, {"id": "CVE-2022-29078", "fix": {"template": "Update ejs to 3.1.7", "available": true}, "title": "ejs: ejs: server-side template injection in outputFunctionName", "ruleId": "trivy-CVE-2022-29078", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "critical", "references": ["https://access.redhat.com/security/cve/CVE-2022-29078", "https://eslam.io/posts/ejs-server-side-template-injection-rce", "https://eslam.io/posts/ejs-server-side-template-injection-rce/"], "description": "The ejs (aka Embedded JavaScript templates) package 3.1.6 for Node.js allows server-side template injection in settings[view options][outputFunctionName]. This is parsed as an internal option, and overwrites the outputFunctionName option with an arbitrary OS command (which is executed upon template compilation)."}, {"id": "CVE-2024-33883", "fix": {"template": "Update ejs to 3.1.10", "available": true}, "title": "ejs: The ejs (aka Embedded JavaScript templates) package before 3.1.10 for  ...", "ruleId": "trivy-CVE-2024-33883", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "medium", "references": ["https://github.com/mde/ejs", "https://github.com/mde/ejs/commit/e469741dca7df2eb400199e1cdb74621e3f89aa5", "https://github.com/mde/ejs/commit/e469741dca7df2eb400199e1cdb74621e3f89aa5 (v3.1.10)"], "description": "The ejs (aka Embedded JavaScript templates) package before 3.1.10 for Node.js lacks certain pollution protection."}, {"id": "GHSA-vjh7-7g9h-fjfh", "fix": {"template": "Update elliptic to 6.6.1", "available": true}, "title": "elliptic: Elliptic's private key extraction in ECDSA upon signing a malformed input (e.g. a string)", "ruleId": "trivy-GHSA-vjh7-7g9h-fjfh", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "critical", "references": ["https://github.com/indutny/elliptic", "https://github.com/indutny/elliptic/commit/04cb6f54ce552b3ebde6be06d6050419e1c7333e", "https://github.com/indutny/elliptic/security/advisories/GHSA-vjh7-7g9h-fjfh"], "description": "### Summary\n\nPrivate key can be extracted from ECDSA signature upon signing a malformed input (e.g. a string or a number), which could e.g. come from JSON network input\n\nNote that `elliptic` by design accepts hex strings as one of the possible input types\n\n### Details\n\nIn this code: https://github.com/indutny/elliptic/blob/3e46a48fdd2ef2f89593e5e058d85530578c9761/lib/elliptic/ec/index.js#L100-L107\n\n`msg` is a BN instance after conversion, but `nonce` is an array, and different BN instances could generate equivalent arrays after conversion.\n\nMeaning that a same `nonce` could be generated for different messages used in signing process, leading to `k` reuse, leading to private key extraction from a pair of signatures\n\nSuch a message can be constructed for any already known message/signature pair, meaning that the attack needs only a single malicious message being signed for a full key extraction\n\nWhile signing unverified attacker-controlled messages would be problematic itself (and exploitation of this needs such a scenario), signing a single message still _should not_ leak the private key\n\nAlso, message validation could have the same bug (out of scope for this report, but could be possible in some situations), which makes this attack more likely when used in a chain\n\n### PoC\n\n#### `k` reuse example\n\n```js\nimport elliptic from 'elliptic'\n\nconst { ec: EC } = elliptic\n\nconst privateKey = crypto.getRandomValues(new Uint8Array(32))\nconst curve = 'ed25519' // or any other curve, e.g. secp256k1\nconst ec = new EC(curve)\nconst prettyprint = ({ r, s }) => `r: ${r}, s: ${s}`\nconst sig0 = prettyprint(ec.sign(Buffer.alloc(32, 1), privateKey)) // array of ones\nconst sig1 = prettyprint(ec.sign('01'.repeat(32), privateKey)) // same message in hex form\nconst sig2 = prettyprint(ec.sign('-' + '01'.repeat(32), privateKey)) // same `r`, different `s`\nconsole.log({ sig0, sig1, sig2 })\n```\n\n#### Full attack\n\nThis doesn't include code for generation/recovery on a purpose (bit it's rather trivial)\n\n```js\nimport elliptic from 'elliptic'\n\nconst { ec: EC } = elliptic\n\nconst privateKey = crypto.getRandomValues(new Uint8Array(32))\nconst curve = 'secp256k1' // or any other curve, e.g. ed25519\nconst ec = new EC(curve)\n\n// Any message, e.g. previously known signature\nconst msg0 = crypto.getRandomValues(new Uint8Array(32))\nconst sig0 = ec.sign(msg0, privateKey)\n\n// Attack\nconst msg1 = funny(msg0) // this is a string here, but can also be of other non-Uint8Array types\nconst sig1 = ec.sign(msg1, privateKey)\n\nconst something = extract(msg0, sig0, sig1, curve)\n\nconsole.log('Curve:', curve)\nconsole.log('Typeof:', typeof msg1)\nconsole.log('Keys equal?', Buffer.from(privateKey).toString('hex') === something)\nconst rnd = crypto.getRandomValues(new Uint8Array(32))\nconst st = (x) => JSON.stringify(x)\nconsole.log('Keys equivalent?', st(ec.sign(rnd, something).toDER()) === st(ec.sign(rnd, privateKey).toDER()))\nconsole.log('Orig key:', Buffer.from(privateKey).toString('hex'))\nconsole.log('Restored:', something)\n```\n\nOutput:\n```console\nCurve: secp256k1\nTypeof: string\nKeys equal? true\nKeys equivalent? true\nOrig key: c7870f7eb3e8fd5155d5c8cdfca61aa993eed1fbe5b41feef69a68303248c22a\nRestored: c7870f7eb3e8fd5155d5c8cdfca61aa993eed1fbe5b41feef69a68303248c22a\n```\n\nSimilar for `ed25519`, but due to low `n`, the key might not match precisely but is nevertheless equivalent for signing:\n```console\nCurve: ed25519\nTypeof: string\nKeys equal? false\nKeys equivalent? true\nOrig key: f1ce0e4395592f4de24f6423099e022925ad5d2d7039b614aaffdbb194a0d189\nRestored: 01ce0e4395592f4de24f6423099e0227ec9cb921e3b7858581ec0d26223966a6\n```\n`restored` is equal to `orig` mod `N`.\n\n### Impact\n\nFull private key extraction when signing a single malicious message (that passes `JSON.stringify`/`JSON.parse`)"}, {"id": "CVE-2024-42459", "fix": {"template": "Update elliptic to 6.5.7", "available": true}, "title": "elliptic: elliptic: nodejs/elliptic: EDDSA signature malleability due to missing signature length check", "ruleId": "trivy-CVE-2024-42459", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "low", "references": ["https://access.redhat.com/security/cve/CVE-2024-42459", "https://github.com/indutny/elliptic", "https://github.com/indutny/elliptic/commit/accb61e9c1a005e5c8ff96a8b33893100bb42d11"], "description": "In the Elliptic package 6.5.6 for Node.js, EDDSA signature malleability occurs because there is a missing signature length check, and thus zero-valued bytes can be removed or appended."}, {"id": "CVE-2024-42460", "fix": {"template": "Update elliptic to 6.5.7", "available": true}, "title": "elliptic: elliptic: nodejs/elliptic: ECDSA signature malleability due to missing checks", "ruleId": "trivy-CVE-2024-42460", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "low", "references": ["https://access.redhat.com/security/cve/CVE-2024-42460", "https://github.com/indutny/elliptic", "https://github.com/indutny/elliptic/commit/accb61e9c1a005e5c8ff96a8b33893100bb42d11"], "description": "In the Elliptic package 6.5.6 for Node.js, ECDSA signature malleability occurs because there is a missing check for whether the leading bit of r and s is zero."}, {"id": "CVE-2024-42461", "fix": {"template": "Update elliptic to 6.5.7", "available": true}, "title": "elliptic: elliptic: nodejs/elliptic: ECDSA implementation malleability due to BER-enconded signatures being allowed", "ruleId": "trivy-CVE-2024-42461", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "low", "references": ["https://access.redhat.com/security/cve/CVE-2024-42461", "https://github.com/indutny/elliptic", "https://github.com/indutny/elliptic/commit/accb61e9c1a005e5c8ff96a8b33893100bb42d11"], "description": "In the Elliptic package 6.5.6 for Node.js, ECDSA signature malleability occurs because BER-encoded signatures are allowed."}, {"id": "CVE-2024-48948", "fix": {"template": "Update elliptic to 6.6.0", "available": true}, "title": "elliptic: elliptic: ECDSA signature verification error may reject legitimate transactions", "ruleId": "trivy-CVE-2024-48948", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "low", "references": ["https://access.redhat.com/security/cve/CVE-2024-48948", "https://blog.trailofbits.com/2025/11/18/we-found-cryptography-bugs-in-the-elliptic-library-using-wycheproof", "https://blog.trailofbits.com/2025/11/18/we-found-cryptography-bugs-in-the-elliptic-library-using-wycheproof/"], "description": "The Elliptic package 6.5.7 for Node.js, in its for ECDSA implementation, does not correctly verify valid signatures if the hash contains at least four leading 0 bytes and when the order of the elliptic curve's base point is smaller than the hash, because of an _truncateToN anomaly. This leads to valid signatures being rejected. Legitimate transactions or communications may be incorrectly flagged as invalid."}, {"id": "CVE-2024-48949", "fix": {"template": "Update elliptic to 6.5.6", "available": true}, "title": "elliptic: elliptic: Missing Validation in Elliptic's EDDSA Signature Verification", "ruleId": "trivy-CVE-2024-48949", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "low", "references": ["https://access.redhat.com/security/cve/CVE-2024-48949", "https://blog.trailofbits.com/2025/11/18/we-found-cryptography-bugs-in-the-elliptic-library-using-wycheproof", "https://blog.trailofbits.com/2025/11/18/we-found-cryptography-bugs-in-the-elliptic-library-using-wycheproof/"], "description": "The verify function in lib/elliptic/eddsa/index.js in the Elliptic package before 6.5.6 for Node.js omits \"sig.S().gte(sig.eddsa.curve.n) || sig.S().isNeg()\" validation."}, {"id": "CVE-2024-27088", "fix": {"template": "Update es5-ext to 0.10.63", "available": true}, "title": "es5-ext: es5-ext contains ECMAScript 5 extensions. Passing functions with very  ...", "ruleId": "trivy-CVE-2024-27088", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "low", "references": ["https://github.com/medikoo/es5-ext", "https://github.com/medikoo/es5-ext/commit/3551cdd7b2db08b1632841f819d008757d28e8e2", "https://github.com/medikoo/es5-ext/commit/a52e95736690ad1d465ebcd9791d54570e294602"], "description": "es5-ext contains ECMAScript 5 extensions. Passing functions with very long names or complex default argument names into `function#copy` or `function#toStringTokens` may cause the script to stall. The vulnerability is patched in v0.10.63."}, {"id": "CVE-2024-29041", "fix": {"template": "Update express to 4.19.2, 5.0.0-beta.3", "available": true}, "title": "express: express: cause malformed URLs to be evaluated", "ruleId": "trivy-CVE-2024-29041", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "medium", "references": ["https://access.redhat.com/security/cve/CVE-2024-29041", "https://expressjs.com/en/4x/api.html#res.location", "https://github.com/expressjs/express"], "description": "Express.js minimalist web framework for node. Versions of Express.js prior to 4.19.0 and all pre-release alpha and beta versions of 5.0 are affected by an open redirect vulnerability using malformed URLs. When a user of Express performs a redirect using a user-provided URL Express performs an encode [using `encodeurl`](https://github.com/pillarjs/encodeurl) on the contents before passing it to the `location` header. This can cause malformed URLs to be evaluated in unexpected ways by common redirect allow list implementations in Express applications, leading to an Open Redirect via bypass of a properly implemented allow list. The main method impacted is `res.location()` but this is also called from within `res.redirect()`. The vulnerability is fixed in 4.19.2 and 5.0.0-beta.3."}, {"id": "CVE-2024-43796", "fix": {"template": "Update express to 4.20.0, 5.0.0", "available": true}, "title": "express: express: Improper Input Handling in Express Redirects", "ruleId": "trivy-CVE-2024-43796", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "low", "references": ["https://access.redhat.com/security/cve/CVE-2024-43796", "https://github.com/expressjs/express", "https://github.com/expressjs/express/commit/54271f69b511fea198471e6ff3400ab805d6b553"], "description": "Express.js minimalist web framework for node. In express < 4.20.0, passing untrusted user input - even after sanitizing it - to response.redirect() may execute untrusted code. This issue is patched in express 4.20.0."}, {"id": "CVE-2023-26159", "fix": {"template": "Update follow-redirects to 1.15.4", "available": true}, "title": "follow-redirects: follow-redirects: Improper Input Validation due to the improper handling of URLs by the url.parse()", "ruleId": "trivy-CVE-2023-26159", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "medium", "references": ["https://access.redhat.com/security/cve/CVE-2023-26159", "https://github.com/follow-redirects/follow-redirects", "https://github.com/follow-redirects/follow-redirects/commit/7a6567e16dfa9ad18a70bfe91784c28653fbf19d"], "description": "Versions of the package follow-redirects before 1.15.4 are vulnerable to Improper Input Validation due to the improper handling of URLs by the url.parse() function. When new URL() throws an error, it can be manipulated to misinterpret the hostname. An attacker could exploit this weakness to redirect traffic to a malicious site, potentially leading to information disclosure, phishing attacks, or other security breaches."}, {"id": "CVE-2024-28849", "fix": {"template": "Update follow-redirects to 1.15.6", "available": true}, "title": "follow-redirects: follow-redirects: Possible credential leak", "ruleId": "trivy-CVE-2024-28849", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "medium", "references": ["https://access.redhat.com/security/cve/CVE-2024-28849", "https://fetch.spec.whatwg.org/#authentication-entries", "https://github.com/follow-redirects/follow-redirects"], "description": "follow-redirects is an open source, drop-in replacement for Node's `http` and `https` modules that automatically follows redirects. In affected versions follow-redirects only clears authorization header during cross-domain redirect, but keep the proxy-authentication header which contains credentials too. This vulnerability may lead to credentials leak, but has been addressed in version 1.15.6. Users are advised to upgrade. There are no known workarounds for this vulnerability."}, {"id": "CVE-2025-7783", "fix": {"template": "Update form-data to 2.5.4, 3.0.4, 4.0.4", "available": true}, "title": "form-data: form-data: Unsafe random function in form-data", "ruleId": "trivy-CVE-2025-7783", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "critical", "references": ["https://access.redhat.com/security/cve/CVE-2025-7783", "https://github.com/benweissmann/CVE-2025-7783-poc", "https://github.com/form-data/form-data"], "description": "Use of Insufficiently Random Values vulnerability in form-data allows HTTP Parameter Pollution (HPP). This vulnerability is associated with program files lib/form_data.Js.\n\nThis issue affects form-data: < 2.5.4, 3.0.0 - 3.0.3, 4.0.0 - 4.0.3."}, {"id": "CVE-2022-33987", "fix": {"template": "Update got to 12.1.0, 11.8.5", "available": true}, "title": "got: nodejs-got: missing verification of requested URLs allows redirects to UNIX sockets", "ruleId": "trivy-CVE-2022-33987", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "medium", "references": ["https://access.redhat.com/errata/RHSA-2022:6595", "https://access.redhat.com/security/cve/CVE-2022-33987", "https://bugzilla.redhat.com/1907444"], "description": "The got package before 12.1.0 (also fixed in 11.8.5) for Node.js allows a redirect to a UNIX socket."}, {"id": "CVE-2022-25881", "fix": {"template": "Update http-cache-semantics to 4.1.1", "available": true}, "title": "http-cache-semantics: http-cache-semantics: Regular Expression Denial of Service (ReDoS) vulnerability", "ruleId": "trivy-CVE-2022-25881", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "high", "references": ["https://access.redhat.com/errata/RHSA-2023:2655", "https://access.redhat.com/security/cve/CVE-2022-25881", "https://bugzilla.redhat.com/2165824"], "description": "This affects versions of the package http-cache-semantics before 4.1.1. The issue can be exploited via malicious request header values sent to a server, when that server reads the cache policy from the request using this library."}, {"id": "CVE-2024-21536", "fix": {"template": "Update http-proxy-middleware to 2.0.7, 3.0.3", "available": true}, "title": "http-proxy-middleware: http-proxy-middleware: Denial of Service", "ruleId": "trivy-CVE-2024-21536", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "high", "references": ["https://access.redhat.com/security/cve/CVE-2024-21536", "https://gist.github.com/mhassan1/28be67266d82a53708ed59ce5dc3c94a", "https://github.com/chimurai/http-proxy-middleware"], "description": "Versions of the package http-proxy-middleware before 2.0.7, from 3.0.0 and before 3.0.3 are vulnerable to Denial of Service (DoS) due to an UnhandledPromiseRejection error thrown by micromatch. An attacker could kill the Node.js process and crash the server by making requests to certain paths."}, {"id": "CVE-2021-23436", "fix": {"template": "Update immer to 9.0.6", "available": true}, "title": "immer: immer: type confusion vulnerability can lead to a bypass of CVE-2020-28477", "ruleId": "trivy-CVE-2021-23436", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "critical", "references": ["https://access.redhat.com/security/cve/CVE-2021-23436", "https://github.com/immerjs/immer", "https://github.com/immerjs/immer/commit/fa671e55ee9bd42ae08cc239102b665a23958237"], "description": "This affects the package immer before 9.0.6. A type confusion vulnerability can lead to a bypass of CVE-2020-28477 when the user-provided keys used in the path parameter are arrays. In particular, this bypass is possible because the condition (p === \"__proto__\" || p === \"constructor\") in applyPatches_ returns false if p is ['__proto__'] (or ['constructor']). The === operator (strict equality operator) returns false if the operands have different type."}, {"id": "CVE-2021-3757", "fix": {"template": "Update immer to 9.0.6", "available": true}, "title": "immer: nodejs-immer: prototype pollution may lead to DoS or remote code execution", "ruleId": "trivy-CVE-2021-3757", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "high", "references": ["https://access.redhat.com/security/cve/CVE-2021-3757", "https://github.com/immerjs/immer", "https://github.com/immerjs/immer/commit/fa671e55ee9bd42ae08cc239102b665a23958237"], "description": "immer is vulnerable to Improperly Controlled Modification of Object Prototype Attributes ('Prototype Pollution')"}, {"id": "CVE-2024-29415", "fix": {"template": null, "available": false}, "title": "ip: node-ip: Incomplete fix for CVE-2023-42282", "ruleId": "trivy-CVE-2024-29415", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "high", "references": ["https://access.redhat.com/security/cve/CVE-2024-29415", "https://cosmosofcyberspace.github.io/npm_ip_cve/npm_ip_cve.html", "https://github.com/indutny/node-ip"], "description": "The ip package through 2.0.1 for Node.js might allow SSRF because some IP addresses (such as 127.1, 01200034567, 012.1.2.3, 000:0:0000::01, and ::fFFf:127.0.0.1) are improperly categorized as globally routable via isPublic. NOTE: this issue exists because of an incomplete fix for CVE-2023-42282."}, {"id": "CVE-2023-42282", "fix": {"template": "Update ip to 2.0.1, 1.1.9", "available": true}, "title": "ip: nodejs-ip: arbitrary code execution via the isPublic() function", "ruleId": "trivy-CVE-2023-42282", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "low", "references": ["https://access.redhat.com/security/cve/CVE-2023-42282", "https://cosmosofcyberspace.github.io/npm_ip_cve/npm_ip_cve.html", "https://github.com/JoshGlazebrook/socks/issues/93#issue-2128357447"], "description": "The ip package before 1.1.9 for Node.js might allow SSRF because some IP addresses (such as 0x7f.1) are improperly categorized as globally routable via isPublic."}, {"id": "CVE-2025-64718", "fix": {"template": "Update js-yaml to 4.1.1, 3.14.2", "available": true}, "title": "js-yaml: js-yaml: js-yaml prototype pollution in merge", "ruleId": "trivy-CVE-2025-64718", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "medium", "references": ["https://access.redhat.com/security/cve/CVE-2025-64718", "https://github.com/nodeca/js-yaml", "https://github.com/nodeca/js-yaml/commit/383665ff4248ec2192d1274e934462bb30426879"], "description": "js-yaml is a JavaScript YAML parser and dumper. In js-yaml 4.1.0 and below, it's possible for an attacker to modify the prototype of the result of a parsed yaml document via prototype pollution (`__proto__`). All users who parse untrusted yaml documents may be impacted. The problem is patched in js-yaml 4.1.1. Users can protect against this kind of attack on the server by using `node --disable-proto=delete` or `deno` (in Deno, pollution protection is on by default)."}, {"id": "CVE-2022-46175", "fix": {"template": "Update json5 to 2.2.2, 1.0.2", "available": true}, "title": "json5: json5: Prototype Pollution in JSON5 via Parse Method", "ruleId": "trivy-CVE-2022-46175", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "high", "references": ["https://access.redhat.com/security/cve/CVE-2022-46175", "https://github.com/json5/json5", "https://github.com/json5/json5/commit/62a65408408d40aeea14c7869ed327acead12972"], "description": "JSON5 is an extension to the popular JSON file format that aims to be easier to write and maintain by hand (e.g. for config files). The `parse` method of the JSON5 library before and including versions 1.0.1 and 2.2.1 does not restrict parsing of keys named `__proto__`, allowing specially crafted strings to pollute the prototype of the resulting object. This vulnerability pollutes the prototype of the object returned by `JSON5.parse` and not the global Object prototype, which is the commonly understood definition of Prototype Pollution. However, polluting the prototype of a single object can have significant security impact for an application if the object is later used in trusted operations. This vulnerability could allow an attacker to set arbitrary and unexpected keys on the object returned from `JSON5.parse`. The actual impact will depend on how applications utilize the returned object and how they filter unwanted keys, but could include denial of service, cross-site scripting, elevation of privilege, and in extreme cases, remote code execution. `JSON5.parse` should restrict parsing of `__proto__` keys when parsing JSON strings to objects. As a point of reference, the `JSON.parse` method included in JavaScript ignores `__proto__` keys. Simply changing `JSON5.parse` to `JSON.parse` in the examples above mitigates this vulnerability. This vulnerability is patched in json5 versions 1.0.2, 2.2.2, and later."}, {"id": "CVE-2022-37601", "fix": {"template": "Update loader-utils to 2.0.3, 1.4.1", "available": true}, "title": "loader-utils: loader-utils: prototype pollution in function parseQuery in parseQuery.js", "ruleId": "trivy-CVE-2022-37601", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "critical", "references": ["http://users.encs.concordia.ca/~mmannan/publications/JS-vulnerability-aisaccs2022.pdf", "https://access.redhat.com/security/cve/CVE-2022-37601", "https://dl.acm.org/doi/abs/10.1145/3488932.3497769"], "description": "Prototype pollution vulnerability in function parseQuery in parseQuery.js in webpack loader-utils via the name variable in parseQuery.js. This affects all versions prior to 1.4.1 and 2.0.3."}, {"id": "CVE-2022-37599", "fix": {"template": "Update loader-utils to 1.4.2, 2.0.4, 3.2.1", "available": true}, "title": "loader-utils: loader-utils: regular expression denial of service in interpolateName.js", "ruleId": "trivy-CVE-2022-37599", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "high", "references": ["https://access.redhat.com/security/cve/CVE-2022-37599", "https://github.com/advisories/GHSA-hhq3-ff78-jv3g", "https://github.com/webpack/loader-utils"], "description": "A Regular expression denial of service (ReDoS) flaw was found in Function interpolateName in interpolateName.js in webpack loader-utils 2.0.0 via the resourcePath variable in interpolateName.js."}, {"id": "CVE-2022-37603", "fix": {"template": "Update loader-utils to 1.4.2, 2.0.4, 3.2.1", "available": true}, "title": "loader-utils: loader-utils: Regular expression denial of service", "ruleId": "trivy-CVE-2022-37603", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "high", "references": ["https://access.redhat.com/security/cve/CVE-2022-37603", "https://github.com/webpack/loader-utils", "https://github.com/webpack/loader-utils/blob/d9f4e23cf411d8556f8bac2d3bf05a6e0103b568/lib/interpolateName.js#L107"], "description": "A Regular expression denial of service (ReDoS) flaw was found in Function interpolateName in interpolateName.js in webpack loader-utils 2.0.0 via the url variable in interpolateName.js."}, {"id": "CVE-2021-23337", "fix": {"template": null, "available": false}, "title": "lodash.template: nodejs-lodash: command injection via template", "ruleId": "trivy-CVE-2021-23337", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "high", "references": ["https://access.redhat.com/security/cve/CVE-2021-23337", "https://cert-portal.siemens.com/productcert/pdf/ssa-637483.pdf", "https://github.com/advisories/GHSA-35jh-r3h4-6jhm"], "description": "Lodash versions prior to 4.17.21 are vulnerable to Command Injection via the template function."}, {"id": "CVE-2024-4067", "fix": {"template": "Update micromatch to 4.0.8", "available": true}, "title": "micromatch: micromatch: vulnerable to Regular Expression Denial of Service", "ruleId": "trivy-CVE-2024-4067", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "medium", "references": ["https://access.redhat.com/security/cve/CVE-2024-4067", "https://advisory.checkmarx.net/advisory/CVE-2024-4067", "https://advisory.checkmarx.net/advisory/CVE-2024-4067/"], "description": "The NPM package `micromatch` prior to 4.0.8 is vulnerable to Regular Expression Denial of Service (ReDoS). The vulnerability occurs in `micromatch.braces()` in `index.js` because the pattern `.*` will greedily match anything. By passing a malicious payload, the pattern matching will keep backtracking to the input while it doesn't find the closing bracket. As the input size increases, the consumption time will also increase until it causes the application to hang or slow down. There was a merged fix but further testing shows the issue persists. This issue should be mitigated by using a safe pattern that won't start backtracking the regular expression due to greedy matching. This issue was fixed in version 4.0.8."}, {"id": "CVE-2025-57352", "fix": {"template": "Update min-document to 2.19.1", "available": true}, "title": "min-document: min-document: min-document prototype pollution", "ruleId": "trivy-CVE-2025-57352", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "low", "references": ["https://access.redhat.com/security/cve/CVE-2025-57352", "https://github.com/Raynos/min-document", "https://github.com/Raynos/min-document/commit/fe32e8da464cef622528725f647029a8fd7d95a6"], "description": "A vulnerability exists in the 'min-document' package prior to version 2.19.0, stemming from improper handling of namespace operations in the removeAttributeNS method. By processing malicious input involving the __proto__ property, an attacker can manipulate the prototype chain of JavaScript objects, leading to denial of service or arbitrary code execution. This issue arises from insufficient validation of attribute namespace removal operations, allowing unintended modification of critical object prototypes. The vulnerability remains unaddressed in the latest available version."}, {"id": "CVE-2022-3517", "fix": {"template": "Update minimatch to 3.0.5", "available": true}, "title": "minimatch: nodejs-minimatch: ReDoS via the braceExpand function", "ruleId": "trivy-CVE-2022-3517", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "high", "references": ["https://access.redhat.com/errata/RHSA-2023:0321", "https://access.redhat.com/security/cve/CVE-2022-3517", "https://bugzilla.redhat.com/2066009"], "description": "A vulnerability was found in the minimatch package. This flaw allows a Regular Expression Denial of Service (ReDoS) when calling the braceExpand function with specific arguments, resulting in a Denial of Service."}, {"id": "CVE-2024-55565", "fix": {"template": "Update nanoid to 5.0.9, 3.3.8", "available": true}, "title": "nanoid: nanoid: nanoid mishandles non-integer values", "ruleId": "trivy-CVE-2024-55565", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "medium", "references": ["https://access.redhat.com/security/cve/CVE-2024-55565", "https://github.com/ai/nanoid", "https://github.com/ai/nanoid/compare/3.3.7...3.3.8"], "description": "nanoid (aka Nano ID) before 5.0.9 mishandles non-integer values. 3.3.8 is also a fixed version."}, {"id": "CVE-2022-24771", "fix": {"template": "Update node-forge to 1.3.0", "available": true}, "title": "node-forge: node-forge: Signature verification leniency in checking `digestAlgorithm` structure can lead to signature forgery", "ruleId": "trivy-CVE-2022-24771", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "high", "references": ["https://access.redhat.com/security/cve/CVE-2022-24771", "https://github.com/digitalbazaar/forge", "https://github.com/digitalbazaar/forge/commit/3f0b49a0573ef1bb7af7f5673c0cfebf00424df1"], "description": "Forge (also called `node-forge`) is a native implementation of Transport Layer Security in JavaScript. Prior to version 1.3.0, RSA PKCS#1 v1.5 signature verification code is lenient in checking the digest algorithm structure. This can allow a crafted structure that steals padding bytes and uses unchecked portion of the PKCS#1 encoded message to forge a signature when a low public exponent is being used. The issue has been addressed in `node-forge` version 1.3.0. There are currently no known workarounds."}, {"id": "CVE-2022-24772", "fix": {"template": "Update node-forge to 1.3.0", "available": true}, "title": "node-forge: node-forge: Signature verification failing to check tailing garbage bytes can lead to signature forgery", "ruleId": "trivy-CVE-2022-24772", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "high", "references": ["https://access.redhat.com/security/cve/CVE-2022-24772", "https://github.com/digitalbazaar/forge", "https://github.com/digitalbazaar/forge/commit/3f0b49a0573ef1bb7af7f5673c0cfebf00424df1"], "description": "Forge (also called `node-forge`) is a native implementation of Transport Layer Security in JavaScript. Prior to version 1.3.0, RSA PKCS#1 v1.5 signature verification code does not check for tailing garbage bytes after decoding a `DigestInfo` ASN.1 structure. This can allow padding bytes to be removed and garbage data added to forge a signature when a low public exponent is being used. The issue has been addressed in `node-forge` version 1.3.0. There are currently no known workarounds."}, {"id": "CVE-2025-12816", "fix": {"template": "Update node-forge to 1.3.2", "available": true}, "title": "node-forge: node-forge: node-forge: Interpretation conflict vulnerability allows bypassing cryptographic verifications", "ruleId": "trivy-CVE-2025-12816", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "high", "references": ["https://access.redhat.com/security/cve/CVE-2025-12816", "https://github.com/digitalbazaar/forge", "https://github.com/digitalbazaar/forge/blob/2bb97afb5058285ef09bcf1d04d6bd6b87cffd58/lib/asn1.js#L1153"], "description": "An interpretation-conflict (CWE-436) vulnerability in node-forge versions 1.3.1 and earlier enables unauthenticated attackers to craft ASN.1 structures to desynchronize schema validations, yielding a semantic divergence that may bypass downstream cryptographic verifications and security decisions."}, {"id": "CVE-2025-66031", "fix": {"template": "Update node-forge to 1.3.2", "available": true}, "title": "node-forge: node-forge: node-forge ASN.1 Unbounded Recursion", "ruleId": "trivy-CVE-2025-66031", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "high", "references": ["https://access.redhat.com/security/cve/CVE-2025-66031", "https://github.com/digitalbazaar/forge", "https://github.com/digitalbazaar/forge/commit/260425c6167a38aae038697132483b5517b26451"], "description": "Forge (also called `node-forge`) is a native implementation of Transport Layer Security in JavaScript. An Uncontrolled Recursion vulnerability in node-forge versions 1.3.1 and below enables remote, unauthenticated attackers to craft deep ASN.1 structures that trigger unbounded recursive parsing. This leads to a Denial-of-Service (DoS) via stack exhaustion when parsing untrusted DER inputs. This issue has been patched in version 1.3.2."}, {"id": "CVE-2022-0122", "fix": {"template": "Update node-forge to 1.0.0", "available": true}, "title": "node-forge: Open Redirect in node-forge", "ruleId": "trivy-CVE-2022-0122", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "medium", "references": ["https://github.com/digitalbazaar/forge", "https://github.com/digitalbazaar/forge/commit/db8016c805371e72b06d8e2edfe0ace0df934a5e", "https://huntr.dev/bounties/41852c50-3c6d-4703-8c55-4db27164a4ae"], "description": "forge is vulnerable to URL Redirection to Untrusted Site"}, {"id": "CVE-2022-24773", "fix": {"template": "Update node-forge to 1.3.0", "available": true}, "title": "node-forge: node-forge: Signature verification leniency in checking `DigestInfo` structure", "ruleId": "trivy-CVE-2022-24773", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "medium", "references": ["https://access.redhat.com/security/cve/CVE-2022-24773", "https://github.com/digitalbazaar/forge", "https://github.com/digitalbazaar/forge/commit/3f0b49a0573ef1bb7af7f5673c0cfebf00424df1"], "description": "Forge (also called `node-forge`) is a native implementation of Transport Layer Security in JavaScript. Prior to version 1.3.0, RSA PKCS#1 v1.5 signature verification code does not properly check `DigestInfo` for a proper ASN.1 structure. This can lead to successful verification with signatures that contain invalid structures but a valid digest. The issue has been addressed in `node-forge` version 1.3.0. There are currently no known workarounds."}, {"id": "CVE-2025-66030", "fix": {"template": "Update node-forge to 1.3.2", "available": true}, "title": "node-forge: node-forge: node-forge: Integer Overflow allows OID-based security bypass", "ruleId": "trivy-CVE-2025-66030", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "medium", "references": ["https://access.redhat.com/security/cve/CVE-2025-66030", "https://github.com/digitalbazaar/forge", "https://github.com/digitalbazaar/forge/commit/3e0c35ace169cfca529a3e547a7848dc7bf57fdb"], "description": "Forge (also called `node-forge`) is a native implementation of Transport Layer Security in JavaScript. An Integer Overflow vulnerability in node-forge versions 1.3.1 and below enables remote, unauthenticated attackers to craft ASN.1 structures containing OIDs with oversized arcs. These arcs may be decoded as smaller, trusted OIDs due to 32-bit bitwise truncation, enabling the bypass of downstream OID-based security decisions. This issue has been patched in version 1.3.2."}, {"id": "GHSA-5rrq-pxf6-6jx5", "fix": {"template": "Update node-forge to 1.0.0", "available": true}, "title": "node-forge: Prototype Pollution in node-forge debug API.", "ruleId": "trivy-GHSA-5rrq-pxf6-6jx5", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "low", "references": ["https://github.com/digitalbazaar/forge", "https://github.com/digitalbazaar/forge/security/advisories/GHSA-5rrq-pxf6-6jx5"], "description": "### Impact\nThe `forge.debug` API had a potential prototype pollution issue if called with untrusted input. The API was only used for internal debug purposes in a safe way and never documented or advertised.  It is suspected that uses of this API, if any exist, would likely not have used untrusted inputs in a vulnerable way.\n\n### Patches\nThe `forge.debug` API and related functions were removed in 1.0.0.\n\n### Workarounds\nDon't use the `forge.debug` API directly or indirectly with untrusted input.\n\n### References\n- https://www.huntr.dev/bounties/1-npm-node-forge/\n\n### For more information\nIf you have any questions or comments about this advisory:\n* Open an issue in [forge](https://github.com/digitalbazaar/forge).\n* Email us at support@digitalbazaar.com."}, {"id": "GHSA-gf8q-jrpm-jvxq", "fix": {"template": "Update node-forge to 1.0.0", "available": true}, "title": "node-forge: URL parsing in node-forge could lead to undesired behavior.", "ruleId": "trivy-GHSA-gf8q-jrpm-jvxq", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "low", "references": ["https://github.com/digitalbazaar/forge", "https://github.com/digitalbazaar/forge/security/advisories/GHSA-gf8q-jrpm-jvxq", "https://nvd.nist.gov/vuln/detail/CVE-2022-0122"], "description": "### Impact\nThe regex used for the `forge.util.parseUrl` API would not properly parse certain inputs resulting in a parsed data structure that could lead to undesired behavior.\n\n### Patches\n`forge.util.parseUrl` and other very old related URL APIs were removed in 1.0.0 in favor of letting applications use the more modern WHATWG URL Standard API.\n\n### Workarounds\nEnsure code does not directly or indirectly call `forge.util.parseUrl` with untrusted input.\n\n### References\n- https://www.huntr.dev/bounties/41852c50-3c6d-4703-8c55-4db27164a4ae/\n\n### For more information\nIf you have any questions or comments about this advisory:\n* Open an issue in [forge](https://github.com/digitalbazaar/forge)\n* Email us at support@digitalbazaar.com\n"}, {"id": "CVE-2021-3803", "fix": {"template": "Update nth-check to 2.0.1", "available": true}, "title": "nth-check: nodejs-nth-check: inefficient regular expression complexity", "ruleId": "trivy-CVE-2021-3803", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "high", "references": ["https://access.redhat.com/security/cve/CVE-2021-3803", "https://github.com/advisories/GHSA-rp65-9cf3-cjxr", "https://github.com/fb55/nth-check"], "description": "nth-check is vulnerable to Inefficient Regular Expression Complexity"}, {"id": "CVE-2025-7339", "fix": {"template": "Update on-headers to 1.1.0", "available": true}, "title": "on-headers: on-headers: on-headers vulnerable to http response header manipulation", "ruleId": "trivy-CVE-2025-7339", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "low", "references": ["https://access.redhat.com/security/cve/CVE-2025-7339", "https://cna.openjsf.org/security-advisories.html", "https://github.com/expressjs/morgan/issues/315"], "description": "on-headers is a node.js middleware for listening to when a response writes headers. A bug in on-headers versions `<1.1.0` may result in response headers being inadvertently modified when an array is passed to `response.writeHead()`.Users should upgrade to version 1.1.0 to receive a patch.Uses are strongly encouraged to upgrade to `1.1.0`, but this issue can be worked around by passing an object to `response.writeHead()` rather than an array."}, {"id": "CVE-2024-45296", "fix": {"template": "Update path-to-regexp to 1.9.0, 0.1.10, 8.0.0, 3.3.0, 6.3.0", "available": true}, "title": "path-to-regexp: path-to-regexp: Backtracking regular expressions cause ReDoS", "ruleId": "trivy-CVE-2024-45296", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "high", "references": ["https://access.redhat.com/security/cve/CVE-2024-45296", "https://github.com/pillarjs/path-to-regexp", "https://github.com/pillarjs/path-to-regexp/commit/29b96b4a1de52824e1ca0f49a701183cc4ed476f"], "description": "path-to-regexp turns path strings into a regular expressions. In certain cases, path-to-regexp will output a regular expression that can be exploited to cause poor performance. Because JavaScript is single threaded and regex matching runs on the main thread, poor performance will block the event loop and lead to a DoS. The bad regular expression is generated any time you have two parameters within a single segment, separated by something that is not a period (.). For users of 0.1, upgrade to 0.1.10. All other users should upgrade to 8.0.0."}, {"id": "CVE-2024-52798", "fix": {"template": "Update path-to-regexp to 0.1.12", "available": true}, "title": "path-to-regexp: path-to-regexp: path-to-regexp Unpatched `path-to-regexp` ReDoS in 0.1.x", "ruleId": "trivy-CVE-2024-52798", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "high", "references": ["https://access.redhat.com/security/cve/CVE-2024-52798", "https://blakeembrey.com/posts/2024-09-web-redos", "https://github.com/pillarjs/path-to-regexp"], "description": "path-to-regexp turns path strings into a regular expressions. In certain cases, path-to-regexp will output a regular expression that can be exploited to cause poor performance. The regular expression that is vulnerable to backtracking can be generated in the 0.1.x release of path-to-regexp. Upgrade to 0.1.12. This vulnerability exists because of an incomplete fix for CVE-2024-45296."}, {"id": "CVE-2025-6545", "fix": {"template": "Update pbkdf2 to 3.1.3", "available": true}, "title": "pbkdf2: pbkdf2: pbkdf2 silently returns predictable key material", "ruleId": "trivy-CVE-2025-6545", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "critical", "references": ["https://access.redhat.com/security/cve/CVE-2025-6545", "https://github.com/browserify/pbkdf2", "https://github.com/browserify/pbkdf2/commit/9699045c37a07f8319cfb8d44e2ff4252d7a7078"], "description": "Improper Input Validation vulnerability in pbkdf2 allows Signature Spoofing by Improper Validation. This vulnerability is associated with program files lib/to-buffer.Js.\n\nThis issue affects pbkdf2: from 3.0.10 through 3.1.2."}, {"id": "CVE-2025-6547", "fix": {"template": "Update pbkdf2 to 3.1.3", "available": true}, "title": "pbkdf2: pbkdf2: pbkdf2 silently returns static keys", "ruleId": "trivy-CVE-2025-6547", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "critical", "references": ["https://access.redhat.com/security/cve/CVE-2025-6547", "https://github.com/browserify/pbkdf2", "https://github.com/browserify/pbkdf2/commit/e3102a8cd4830a3ac85cd0dd011cc002fdde33bb"], "description": "Improper Input Validation vulnerability in pbkdf2 allows Signature Spoofing by Improper Validation.This issue affects pbkdf2: <=3.1.2."}, {"id": "CVE-2023-44270", "fix": {"template": "Update postcss to 8.4.31", "available": true}, "title": "postcss: PostCSS: Improper input validation in PostCSS", "ruleId": "trivy-CVE-2023-44270", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "medium", "references": ["https://access.redhat.com/security/cve/CVE-2023-44270", "https://github.com/github/advisory-database/issues/2820", "https://github.com/postcss/postcss"], "description": "An issue was discovered in PostCSS before 8.4.31. The vulnerability affects linters using PostCSS to parse external untrusted CSS. An attacker can prepare CSS in such a way that it will contains parts parsed by PostCSS as a CSS comment. After processing by PostCSS, it will be included in the PostCSS output in CSS nodes (rules, properties) despite being included in a comment."}, {"id": "CVE-2023-28155", "fix": {"template": null, "available": false}, "title": "request: request: bypass of SSRF mitigations when following a cross-protocol redirect", "ruleId": "trivy-CVE-2023-28155", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "medium", "references": ["https://access.redhat.com/security/cve/CVE-2023-28155", "https://doyensec.com/resources/Doyensec_Advisory_RequestSSRF_Q12023.pdf", "https://github.com/cypress-io/request/blob/master/lib/redirect.js#L116"], "description": "The Request package through 2.88.1 for Node.js allows a bypass of SSRF mitigations via an attacker-controller server that does a cross-protocol redirect (HTTP to HTTPS, or HTTPS to HTTP). NOTE: This vulnerability only affects products that are no longer supported by the maintainer."}, {"id": "CVE-2024-47068", "fix": {"template": "Update rollup to 3.29.5, 4.22.4, 2.79.2", "available": true}, "title": "rollup: rollup: DOM Clobbering Gadget found in rollup bundled scripts that leads to XSS", "ruleId": "trivy-CVE-2024-47068", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "high", "references": ["https://access.redhat.com/security/cve/CVE-2024-47068", "https://github.com/rollup/rollup", "https://github.com/rollup/rollup/blob/b86ffd776cfa906573d36c3f019316d02445d9ef/src/ast/nodes/MetaProperty.ts#L157-L162"], "description": "Rollup is a module bundler for JavaScript. Versions prior to 2.79.2, 3.29.5, and 4.22.4 are susceptible to a DOM Clobbering vulnerability when bundling scripts with properties from `import.meta` (e.g., `import.meta.url`) in `cjs`/`umd`/`iife` format. The DOM Clobbering gadget can lead to cross-site scripting (XSS) in web pages where scriptless attacker-controlled HTML elements (e.g., an `img` tag with an unsanitized `name` attribute) are present. Versions 2.79.2, 3.29.5, and 4.22.4  contain a patch for the vulnerability."}, {"id": "CVE-2024-48930", "fix": {"template": "Update secp256k1 to 5.0.1, 4.0.4, 3.8.1", "available": true}, "title": "secp256k1: secp256k1-node allows private key extraction over ECDH", "ruleId": "trivy-CVE-2024-48930", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "high", "references": ["https://github.com/cryptocoinjs/secp256k1-node", "https://github.com/cryptocoinjs/secp256k1-node/blob/6d3474b81d073cc9c8cc8cfadb580c84f8df5248/lib/elliptic.js#L17-L19", "https://github.com/cryptocoinjs/secp256k1-node/blob/6d3474b81d073cc9c8cc8cfadb580c84f8df5248/lib/elliptic.js#L37-L39"], "description": "secp256k1-node is a Node.js binding for an Optimized C library for EC operations on curve secp256k1. In `elliptic`-based version, `loadUncompressedPublicKey` has a check that the public key is on the curve. Prior to versions 5.0.1, 4.0.4, and 3.8.1, however, `loadCompressedPublicKey` is missing that check. That allows the attacker to use public keys on low-cardinality curves to extract enough information to fully restore the private key from as little as 11 ECDH sessions, and very cheaply on compute power. Other operations on public keys are also affected, including e.g. `publicKeyVerify()` incorrectly returning `true` on those invalid keys, and e.g. `publicKeyTweakMul()` also returning predictable outcomes allowing to restore the tweak. Versions 5.0.1, 4.0.4, and 3.8.1 contain a fix for the issue."}, {"id": "CVE-2022-25883", "fix": {"template": "Update semver to 7.5.2, 6.3.1, 5.7.2", "available": true}, "title": "semver: nodejs-semver: Regular expression denial of service", "ruleId": "trivy-CVE-2022-25883", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "high", "references": ["https://access.redhat.com/errata/RHSA-2023:5363", "https://access.redhat.com/security/cve/CVE-2022-25883", "https://bugzilla.redhat.com/2216475"], "description": "Versions of the package semver before 7.5.2 are vulnerable to Regular Expression Denial of Service (ReDoS) via the function new Range, when untrusted user data is provided as a range.\r\r\r"}, {"id": "CVE-2024-43799", "fix": {"template": "Update send to 0.19.0", "available": true}, "title": "send: send: Code Execution Vulnerability in Send Library", "ruleId": "trivy-CVE-2024-43799", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "low", "references": ["https://access.redhat.com/security/cve/CVE-2024-43799", "https://github.com/pillarjs/send", "https://github.com/pillarjs/send/commit/ae4f2989491b392ae2ef3b0015a019770ae65d35"], "description": "Send is a library for streaming files from the file system as a http response. Send passes untrusted user input to SendStream.redirect() which executes untrusted code. This issue is patched in send 0.19.0."}, {"id": "CVE-2024-11831", "fix": {"template": "Update serialize-javascript to 6.0.2", "available": true}, "title": "serialize-javascript: npm-serialize-javascript: Cross-site Scripting (XSS) in serialize-javascript", "ruleId": "trivy-CVE-2024-11831", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "medium", "references": ["https://access.redhat.com/errata/RHBA-2025:0304", "https://access.redhat.com/errata/RHSA-2025:0381", "https://access.redhat.com/errata/RHSA-2025:10853"], "description": "A flaw was found in npm-serialize-javascript. The vulnerability occurs because the serialize-javascript module does not properly sanitize certain inputs, such as regex or other JavaScript object types, allowing an attacker to inject malicious code. This code could be executed when deserialized by a web browser, causing Cross-site scripting (XSS) attacks. This issue is critical in environments where serialized data is sent to web clients, potentially compromising the security of the website or web application using this package."}, {"id": "CVE-2024-43800", "fix": {"template": "Update serve-static to 1.16.0, 2.1.0", "available": true}, "title": "serve-static: serve-static: Improper Sanitization in serve-static", "ruleId": "trivy-CVE-2024-43800", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "low", "references": ["https://access.redhat.com/security/cve/CVE-2024-43800", "https://github.com/expressjs/serve-static", "https://github.com/expressjs/serve-static/commit/0c11fad159898cdc69fd9ab63269b72468ecaf6b"], "description": "serve-static serves static files. serve-static passes untrusted user input - even after sanitizing it - to redirect() may execute untrusted code. This issue is patched in serve-static 1.16.0."}, {"id": "CVE-2025-9288", "fix": {"template": "Update sha.js to 2.4.12", "available": true}, "title": "sha.js: sha.js: Missing type checks leading to hash rewind and passing on crafted data", "ruleId": "trivy-CVE-2025-9288", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "critical", "references": ["https://access.redhat.com/security/cve/CVE-2025-9288", "https://github.com/browserify/sha.js", "https://github.com/browserify/sha.js/commit/f2a258e9f2d0fcd113bfbaa49706e1ac0d979ba5"], "description": "Improper Input Validation vulnerability in sha.js allows Input Data Manipulation.This issue affects sha.js: through 2.4.11."}, {"id": "CVE-2021-42740", "fix": {"template": "Update shell-quote to 1.7.3", "available": true}, "title": "shell-quote: The shell-quote package before 1.7.3 for Node.js allows command inject ...", "ruleId": "trivy-CVE-2021-42740", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "critical", "references": ["https://github.com/ljharb/shell-quote", "https://github.com/ljharb/shell-quote/blob/master/CHANGELOG.md#173", "https://github.com/ljharb/shell-quote/commit/5799416ed454aa4ec9afafc895b4e31760ea1abe"], "description": "The shell-quote package before 1.7.3 for Node.js allows command injection. An attacker can inject unescaped shell metacharacters through a regex designed to support Windows drive letters. If the output of this package is passed to a real shell as a quoted argument to a command with exec(), an attacker can inject arbitrary commands. This is because the Windows drive letter regex character class is {A-z] instead of the correct {A-Za-z]. Several shell metacharacters exist in the space between capital letter Z and lower case letter a, such as the backtick character."}, {"id": "CVE-2024-28863", "fix": {"template": "Update tar to 6.2.1", "available": true}, "title": "tar: node-tar: denial of service while parsing a tar file due to lack of folders depth validation", "ruleId": "trivy-CVE-2024-28863", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "medium", "references": ["https://access.redhat.com/errata/RHSA-2024:6147", "https://access.redhat.com/security/cve/CVE-2024-28863", "https://bugzilla.redhat.com/2293200"], "description": "node-tar is a Tar for Node.js. node-tar prior to version 6.2.1 has no limit on the number of sub-folders created in the folder creation process. An attacker who generates a large number of sub-folders can consume memory on the system running node-tar and even crash the Node.js client within few seconds of running it using a path with too many sub-folders inside. Version 6.2.1 fixes this issue by preventing extraction in excessively deep sub-folders."}, {"id": "CVE-2025-54798", "fix": {"template": "Update tmp to 0.2.4", "available": true}, "title": "tmp: tmp: tmp Symbolic Link Write Vulnerability", "ruleId": "trivy-CVE-2025-54798", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "low", "references": ["https://access.redhat.com/security/cve/CVE-2025-54798", "https://github.com/raszi/node-tmp", "https://github.com/raszi/node-tmp/commit/188b25e529496e37adaf1a1d9dccb40019a08b1b"], "description": "tmp is a temporary file and directory creator for node.js. In versions 0.2.3 and below, tmp is vulnerable to an arbitrary temporary file / directory write via symbolic link dir parameter. This is fixed in version 0.2.4."}, {"id": "CVE-2023-26136", "fix": {"template": "Update tough-cookie to 4.1.3", "available": true}, "title": "tough-cookie: tough-cookie: prototype pollution in cookie memstore", "ruleId": "trivy-CVE-2023-26136", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "medium", "references": ["https://access.redhat.com/security/cve/CVE-2023-26136", "https://github.com/salesforce/tough-cookie", "https://github.com/salesforce/tough-cookie/commit/12d474791bb856004e858fdb1c47b7608d09cf6e"], "description": "Versions of the package tough-cookie before 4.1.3 are vulnerable to Prototype Pollution due to improper handling of Cookies when using CookieJar in rejectPublicSuffixes=false mode. This issue arises from the manner in which the objects are initialized."}, {"id": "CVE-2025-22150", "fix": {"template": "Update undici to 5.28.5, 6.21.1, 7.2.3", "available": true}, "title": "undici: undici: Undici Uses Insufficiently Random Values", "ruleId": "trivy-CVE-2025-22150", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "medium", "references": ["https://access.redhat.com/errata/RHSA-2025:1613", "https://access.redhat.com/security/cve/CVE-2025-22150", "https://blog.securityevaluators.com/hacking-the-javascript-lottery-80cc437e3b7f"], "description": "Undici is an HTTP/1.1 client. Starting in version 4.5.0 and prior to versions 5.28.5, 6.21.1, and 7.2.3, undici uses `Math.random()` to choose the boundary for a multipart/form-data request. It is known that the output of `Math.random()` can be predicted if several of its generated values are known. If there is a mechanism in an app that sends multipart requests to an attacker-controlled website, they can use this to leak the necessary values. Therefore, an attacker can tamper with the requests going to the backend APIs if certain conditions are met. This is fixed in versions 5.28.5, 6.21.1, and 7.2.3. As a workaround, do not issue multipart requests to attacker controlled servers."}, {"id": "CVE-2023-45143", "fix": {"template": "Update undici to 5.26.2", "available": true}, "title": "undici: node-undici: cookie leakage", "ruleId": "trivy-CVE-2023-45143", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "low", "references": ["https://access.redhat.com/errata/RHSA-2023:5849", "https://access.redhat.com/security/cve/CVE-2023-45143", "https://bugzilla.redhat.com/2242803"], "description": "Undici is an HTTP/1.1 client written from scratch for Node.js. Prior to version 5.26.2, Undici already cleared Authorization headers on cross-origin redirects, but did not clear `Cookie` headers. By design, `cookie` headers are forbidden request headers, disallowing them to be set in RequestInit.headers in browser environments. Since undici handles headers more liberally than the spec, there was a disconnect from the assumptions the spec made, and undici's implementation of fetch. As such this may lead to accidental leakage of cookie to a third-party site or a malicious attacker who can control the redirection target (ie. an open redirector) to leak the cookie to the third party site. This was patched in version 5.26.2. There are no known workarounds."}, {"id": "CVE-2024-24758", "fix": {"template": "Update undici to 5.28.3, 6.6.1", "available": true}, "title": "undici: undici: sensitive information exposure", "ruleId": "trivy-CVE-2024-24758", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "low", "references": ["http://www.openwall.com/lists/oss-security/2024/03/11/1", "https://access.redhat.com/security/cve/CVE-2024-24758", "https://github.com/nodejs/undici"], "description": "Undici is an HTTP/1.1 client, written from scratch for Node.js. Undici already cleared Authorization headers on cross-origin redirects, but did not clear `Proxy-Authentication` headers. This issue has been patched in versions 5.28.3 and 6.6.1. Users are advised to upgrade. There are no known workarounds for this vulnerability."}, {"id": "CVE-2024-30260", "fix": {"template": "Update undici to 5.28.4, 6.11.1", "available": true}, "title": "undici: nodejs-undici: proxy-authorization header not cleared on cross-origin redirect for dispatch, request, stream, pipeline", "ruleId": "trivy-CVE-2024-30260", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "low", "references": ["https://access.redhat.com/security/cve/CVE-2024-30260", "https://github.com/nodejs/undici", "https://github.com/nodejs/undici/commit/64e3402da4e032e68de46acb52800c9a06aaea3f"], "description": "Undici is an HTTP/1.1 client, written from scratch for Node.js. Undici cleared Authorization and Proxy-Authorization headers for `fetch()`, but did not clear them for `undici.request()`. This vulnerability was patched in version(s) 5.28.4 and 6.11.1."}, {"id": "CVE-2024-30261", "fix": {"template": "Update undici to 5.28.4, 6.11.1", "available": true}, "title": "undici: nodejs-undici: fetch() with integrity option is too lax when algorithm is specified but hash value is in incorrect", "ruleId": "trivy-CVE-2024-30261", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "low", "references": ["https://access.redhat.com/security/cve/CVE-2024-30261", "https://github.com/nodejs/undici", "https://github.com/nodejs/undici/commit/2b39440bd9ded841c93dd72138f3b1763ae26055"], "description": "Undici is an HTTP/1.1 client, written from scratch for Node.js. An attacker can alter the `integrity` option passed to `fetch()`, allowing `fetch()` to accept requests as valid even if they have been tampered. This vulnerability was patched in version(s) 5.28.4 and 6.11.1."}, {"id": "CVE-2025-47279", "fix": {"template": "Update undici to 5.29.0, 6.21.2, 7.5.0", "available": true}, "title": "undici: undici: Undici Memory Leak with Invalid Certificates", "ruleId": "trivy-CVE-2025-47279", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "low", "references": ["https://access.redhat.com/security/cve/CVE-2025-47279", "https://github.com/nodejs/undici", "https://github.com/nodejs/undici/issues/3895"], "description": "Undici is an HTTP/1.1 client for Node.js. Prior to versions 5.29.0, 6.21.2, and 7.5.0, applications that use undici to implement a webhook-like system are vulnerable. If the attacker set up a server with an invalid certificate, and they can force the application to call the webhook repeatedly, then they can cause a memory leak. This has been patched in versions 5.29.0, 6.21.2, and 7.5.0. As a workaound, avoid calling a webhook repeatedly if the webhook fails."}, {"id": "CVE-2025-57329", "fix": {"template": null, "available": false}, "title": "web3-core-method: web3-core-method is vulnerable to prototype pollution", "ruleId": "trivy-CVE-2025-57329", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "low", "references": ["https://github.com/VulnSageAgent/PoCs/blob/main/JavaScript/prototype-pollution/web3-core-method%401.10.4/index.js", "https://github.com/VulnSageAgent/PoCs/tree/main/JavaScript/prototype-pollution/CVE-2025-57329", "https://github.com/web3/web3.js/tree/1.x"], "description": "web3-core-method is a package designed to creates the methods on the web3 modules. A Prototype Pollution vulnerability in the attachToObject function of web3-core-method version 1.10.4 and before allows attackers to inject properties on Object.prototype via supplying a crafted payload, causing denial of service (DoS) as the minimum consequence."}, {"id": "CVE-2025-57330", "fix": {"template": null, "available": false}, "title": "web3-core-subscriptions: web3-core-subscriptions has a Prototype Pollution vulnerability", "ruleId": "trivy-CVE-2025-57330", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "low", "references": ["https://github.com/VulnSageAgent/PoCs/blob/main/JavaScript/prototype-pollution/web3-core-subscriptions%401.10.4/index.js", "https://github.com/VulnSageAgent/PoCs/tree/main/JavaScript/prototype-pollution/CVE-2025-57330", "https://github.com/web3/web3.js"], "description": "The web3-core-subscriptions is a package designed to manages web3 subscriptions. A Prototype Pollution vulnerability in the attachToObject function of web3-core-subscriptions version 1.10.4 and before allows attackers to inject properties on Object.prototype via supplying a crafted payload, causing denial of service (DoS) as the minimum consequence."}, {"id": "CVE-2024-29180", "fix": {"template": "Update webpack-dev-middleware to 7.1.0, 6.1.2, 5.3.4", "available": true}, "title": "webpack-dev-middleware: webpack-dev-middleware: lack of URL validation may lead to file leak", "ruleId": "trivy-CVE-2024-29180", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "high", "references": ["https://access.redhat.com/security/cve/CVE-2024-29180", "https://github.com/webpack/webpack-dev-middleware", "https://github.com/webpack/webpack-dev-middleware/blob/7ed24e0b9f53ad1562343f9f517f0f0ad2a70377/src/utils/getFilenameFromUrl.js#L82"], "description": "Prior to versions 7.1.0, 6.1.2, and 5.3.4, the webpack-dev-middleware development middleware for devpack does not validate the supplied URL address sufficiently before returning the local file. It is possible to access any file on the developer's machine. The middleware can either work with the physical filesystem when reading the files or it can use a virtualized in-memory `memfs` filesystem. If `writeToDisk` configuration option is set to `true`, the physical filesystem is used. The `getFilenameFromUrl` method is used to parse URL and build the local file path. The public path prefix is stripped from the URL, and the `unsecaped` path suffix is appended to the `outputPath`. As the URL is not unescaped and normalized automatically before calling the midlleware, it is possible to use `%2e` and `%2f` sequences to perform path traversal attack.\n\nDevelopers using `webpack-dev-server` or `webpack-dev-middleware` are affected by the issue. When the project is started, an attacker might access any file on the developer's machine and exfiltrate the content. If the development server is listening on a public IP address (or `0.0.0.0`), an attacker on the local network can access the local files without any interaction from the victim (direct connection to the port). If the server allows access from third-party domains, an attacker can send a malicious link to the victim. When visited, the client side script can connect to the local server and exfiltrate the local files. Starting with fixed versions 7.1.0, 6.1.2, and 5.3.4, the URL is unescaped and normalized before any further processing."}, {"id": "CVE-2025-30359", "fix": {"template": "Update webpack-dev-server to 5.2.1", "available": true}, "title": "webpack-dev-server: webpack-dev-server: webpack-dev-server information exposure", "ruleId": "trivy-CVE-2025-30359", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "medium", "references": ["https://access.redhat.com/security/cve/CVE-2025-30359", "https://github.com/webpack/webpack-dev-server", "https://github.com/webpack/webpack-dev-server/commit/5c9378bb01276357d7af208a0856ca2163db188e"], "description": "webpack-dev-server allows users to use webpack with a development server that provides live reloading. Prior to version 5.2.1, webpack-dev-server users' source code may be stolen when they access a malicious web site. Because the request for classic script by a script tag is not subject to same origin policy, an attacker can inject a malicious script in their site and run the script. Note that the attacker has to know the port and the output entrypoint script path. Combined with prototype pollution, the attacker can get a reference to the webpack runtime variables. By using `Function::toString` against the values in `__webpack_modules__`, the attacker can get the source code. Version 5.2.1 contains a patch for the issue."}, {"id": "CVE-2023-26115", "fix": {"template": "Update word-wrap to 1.2.4", "available": true}, "title": "word-wrap: word-wrap: ReDoS", "ruleId": "trivy-CVE-2023-26115", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "medium", "references": ["https://access.redhat.com/security/cve/CVE-2023-26115", "https://github.com/jonschlinkert/word-wrap", "https://github.com/jonschlinkert/word-wrap/blob/master/index.js#L39"], "description": "All versions of the package word-wrap are vulnerable to Regular Expression Denial of Service (ReDoS) due to the usage of an insecure regular expression within the result variable."}, {"id": "CVE-2024-37890", "fix": {"template": "Update ws to 5.2.4, 6.2.3, 7.5.10, 8.17.1", "available": true}, "title": "ws: nodejs-ws: denial of service when handling a request with many HTTP headers", "ruleId": "trivy-CVE-2024-37890", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "high", "references": ["https://access.redhat.com/security/cve/CVE-2024-37890", "https://github.com/websockets/ws", "https://github.com/websockets/ws/commit/22c28763234aa75a7e1b76f5c01c181260d7917f"], "description": "ws is an open source WebSocket client and server for Node.js. A request with a number of headers exceeding theserver.maxHeadersCount threshold could be used to crash a ws server. The vulnerability was fixed in ws@8.17.1 (e55e510) and backported to ws@7.5.10 (22c2876), ws@6.2.3 (eeb76d3), and ws@5.2.4 (4abd8f6). In vulnerable versions of ws, the issue can be mitigated in the following ways: 1. Reduce the maximum allowed length of the request headers using the --max-http-header-size=size and/or the maxHeaderSize options so that no more headers than the server.maxHeadersCount limit can be sent. 2. Set server.maxHeadersCount to 0 so that no limit is applied."}, {"id": "CVE-2020-7608", "fix": {"template": "Update yargs-parser to 13.1.2, 15.0.1, 18.1.1, 5.0.1", "available": true}, "title": "yargs-parser: nodejs-yargs-parser: prototype pollution vulnerability", "ruleId": "trivy-CVE-2020-7608", "category": "dependencies", "location": {"file": "yarn.lock", "line": 0}, "severity": "medium", "references": ["https://access.redhat.com/security/cve/CVE-2020-7608", "https://errata.almalinux.org/8/ALSA-2021-0548.html", "https://github.com/yargs/yargs-parser"], "description": "yargs-parser could be tricked into adding or modifying properties of Object.prototype using a \"__proto__\" payload."}, {"id": "0b335667417d", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "API_KEY=\n\nGOERLI_HOST=", "highlightLines": [2]}, "category": "secrets", "location": {"file": ".env-sample", "line": 2}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "aa6a5bab1617", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "API_KEY=\n\nMUMBAI_HOST=", "highlightLines": [5]}, "category": "secrets", "location": {"file": ".env-sample", "line": 5}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "1cd44089c749", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "API_KEY=\n\nOPTIMISM_GOERLI_HOST=", "highlightLines": [8]}, "category": "secrets", "location": {"file": ".env-sample", "line": 8}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "591fb1f2da61", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "API_KEY=\n\nARBITRUM_GOERLI_HOST=", "highlightLines": [11]}, "category": "secrets", "location": {"file": ".env-sample", "line": 11}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "a711fee59961", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "API_KEY=\n\nPRIV_KEY=", "highlightLines": [14]}, "category": "secrets", "location": {"file": ".env-sample", "line": 14}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "2f00768d4144", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "secret = function", "highlightLines": [110]}, "category": "secrets", "location": {"file": "client/src/utils/^^.js", "line": 110}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "83915b6d22bc", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "password = block.timestamp;", "highlightLines": [7]}, "category": "secrets", "location": {"file": "contracts/contracts/levels/GatekeeperThree.sol", "line": 7}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "fab7d164c4df", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "password = block.timestamp;", "highlightLines": [17]}, "category": "secrets", "location": {"file": "contracts/contracts/levels/GatekeeperThree.sol", "line": 17}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "23376d9bae50", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "password = _password;", "highlightLines": [13]}, "category": "secrets", "location": {"file": "contracts/contracts/levels/Instance.sol", "line": 13}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "41730364d3cb", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "token = Token(_instance);", "highlightLines": [20]}, "category": "secrets", "location": {"file": "contracts/contracts/levels/TokenFactory.sol", "line": 20}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "3387a53ac196", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "password = _password;", "highlightLines": [10]}, "category": "secrets", "location": {"file": "contracts/contracts/levels/Vault.sol", "line": 10}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}]}]