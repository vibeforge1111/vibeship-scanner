[{"findings":[{"id": "b0b5e4ee4879", "fix": {"template": null, "available": false}, "title": "Potential AWS Secret Access Key - verify and rotate if exposed", "ruleId": "rules._shared.shared-aws-secret-key", "snippet": {"code": "background-image: url(\"http://2.bp.blogspot.com/_pIX0Yrfc96k/TGbCp67f8rI/AAAAAAAADpc/ZYotXRwkT2M/s1600/ind43v.jpg\");", "highlightLines": [16]}, "category": "code", "location": {"file": "www/sql_connect.php", "line": 16, "column": 50}, "severity": "medium", "references": [], "description": ""}, {"id": "872e2763827f", "fix": {"template": null, "available": false}, "title": "PHP include with variable - file inclusion risk", "ruleId": "rules.php-include-var", "snippet": {"code": "include('head.php');", "highlightLines": [3]}, "category": "code", "location": {"file": "www/dns-spoofing.php", "line": 3, "column": 1}, "severity": "high", "references": [], "description": ""}, {"id": "7e1f6aab32c6", "fix": {"template": null, "available": false}, "title": "PHP loose comparison - use === for security comparisons", "ruleId": "rules.php-loose-comparison", "snippet": {"code": "\t\t\tif(filter_var($host, FILTER_VALIDATE_IP, FILTER_FLAG_IPV4 | FILTER_FLAG_NO_PRIV_RANGE |  FILTER_FLAG_NO_RES_RANGE)== false)", "highlightLines": [53]}, "category": "code", "location": {"file": "www/dns-spoofing.php", "line": 53, "column": 4}, "severity": "high", "references": [], "description": ""}, {"id": "d7023079b2f6", "fix": {"template": null, "available": false}, "title": "PHP password - use password_verify() instead", "ruleId": "rules.php-password-plain-compare", "snippet": {"code": "\t\t\tif(filter_var($host, FILTER_VALIDATE_IP, FILTER_FLAG_IPV4 | FILTER_FLAG_NO_PRIV_RANGE |  FILTER_FLAG_NO_RES_RANGE)== false)", "highlightLines": [53]}, "category": "code", "location": {"file": "www/dns-spoofing.php", "line": 53, "column": 4}, "severity": "high", "references": [], "description": ""}, {"id": "0c888571de87", "fix": {"template": null, "available": false}, "title": "PHP file_get_contents with URL - potential SSRF", "ruleId": "rules.php-file-get-contents-url", "snippet": {"code": "\t\t\t\t\techo '<textarea rows=20 cols=60>'.file_get_contents($file).\"</textarea>\";", "highlightLines": [66]}, "category": "code", "location": {"file": "www/dns-spoofing.php", "line": 66, "column": 40}, "severity": "medium", "references": [], "description": ""}, {"id": "02adb5d9b56f", "fix": {"template": null, "available": false}, "title": "PHP file_get_contents with URL - potential SSRF", "ruleId": "rules.php-file-get-contents-url", "snippet": {"code": "\t\t\techo '<textarea rows=20 cols=60>'.file_get_contents($file).\"</textarea>\";", "highlightLines": [71]}, "category": "code", "location": {"file": "www/dns-spoofing.php", "line": 71, "column": 38}, "severity": "medium", "references": [], "description": ""}, {"id": "ed18ceddcf94", "fix": {"template": null, "available": false}, "title": "PHP file_get_contents with URL - potential SSRF", "ruleId": "rules.php-file-get-contents-url", "snippet": {"code": "\t\techo '<textarea rows=20 cols=60>'.file_get_contents($file).\"</textarea>\";", "highlightLines": [89]}, "category": "code", "location": {"file": "www/dns-spoofing.php", "line": 89, "column": 37}, "severity": "medium", "references": [], "description": ""}, {"id": "67eb8414fe46", "fix": {"template": null, "available": false}, "title": "PHP file_get_contents with URL - potential SSRF", "ruleId": "rules.php-file-get-contents-url", "snippet": {"code": "\t\techo \"<br><textarea rows=10 cols=50>\".file_get_contents($url).\"</textarea>\";", "highlightLines": [32]}, "category": "code", "location": {"file": "www/dns_rebinding.php", "line": 32, "column": 41}, "severity": "medium", "references": [], "description": ""}, {"id": "71a1740772d7", "fix": {"template": null, "available": false}, "title": "PHP include with variable - file inclusion risk", "ruleId": "rules.php-include-var", "snippet": {"code": "include('head.php');", "highlightLines": [39]}, "category": "code", "location": {"file": "www/download.php", "line": 39, "column": 1}, "severity": "high", "references": [], "description": ""}, {"id": "bd189d8034e3", "fix": {"template": null, "available": false}, "title": "PHP include with variable - file inclusion risk", "ruleId": "rules.php-include-var", "snippet": {"code": "include('head.php');", "highlightLines": [3]}, "category": "code", "location": {"file": "www/file_get_content.php", "line": 3, "column": 1}, "severity": "high", "references": [], "description": ""}, {"id": "d6c0f75ee5ba", "fix": {"template": null, "available": false}, "title": "PHP file_get_contents with URL - potential SSRF", "ruleId": "rules.php-file-get-contents-url", "snippet": {"code": "echo htmlentities(file_get_contents($file));", "highlightLines": [45]}, "category": "code", "location": {"file": "www/file_get_content.php", "line": 45, "column": 19}, "severity": "medium", "references": [], "description": ""}, {"id": "05994dd93924", "fix": {"template": null, "available": false}, "title": "PHP passthru() - command injection risk", "ruleId": "rules.php-passthru", "snippet": {"code": " passthru('weasyprint sample10.html output.pdf 2>&1');", "highlightLines": [272]}, "category": "code", "location": {"file": "www/pdf_ssrf_weasyprint.php", "line": 272, "column": 2}, "severity": "high", "references": [], "description": ""}, {"id": "8297b741bbe8", "fix": {"template": null, "available": false}, "title": "PHP passthru() - command injection risk", "ruleId": "rules.php-passthru", "snippet": {"code": " passthru('xvfb-run wkhtmltopdf -T 0 -R 0 -B 0 -L 0 --orientation Portrait --page-size A4 --quiet sample.html output4.pdf 2>&1'); //comment this line if you want to use code on Windows", "highlightLines": [273]}, "category": "code", "location": {"file": "www/pdf_ssrf_wkhtmltopdf.php", "line": 273, "column": 2}, "severity": "high", "references": [], "description": ""}, {"id": "37059f4a1512", "fix": {"template": null, "available": false}, "title": "PHP XXE - libxml_disable_entity_loader(false) enables external entities (CWE-611)", "ruleId": "rules.php-xxe-libxml-disable-entity-false", "snippet": {"code": "libxml_disable_entity_loader (false);", "highlightLines": [88]}, "category": "code", "location": {"file": "www/xml_ssrf.php", "line": 88, "column": 1}, "severity": "high", "references": [], "description": ""}, {"id": "bf2e2645bc8e", "fix": {"template": null, "available": false}, "title": "PHP XXE - LIBXML_NOENT substitutes entities, enabling XXE attacks (CWE-611)", "ruleId": "rules.php-xxe-libxml-noent", "snippet": {"code": "$crew= simplexml_load_file($xmlfile, 'SimpleXMLElement', LIBXML_NOENT) or die(\"Cannot create XML object\");", "highlightLines": [90]}, "category": "code", "location": {"file": "www/xml_ssrf.php", "line": 90, "column": 58}, "severity": "high", "references": [], "description": ""}, {"id": "6715278628dd", "fix": {"template": null, "available": false}, "title": "open() with variable path - path traversal if user-controlled (CWE-22)", "ruleId": "rules.py-path-open-var", "snippet": {"code": "    data = open(fn, 'rb').read()", "highlightLines": [4]}, "category": "code", "location": {"file": "www/pdf_generator/weasy.py", "line": 4, "column": 11}, "severity": "medium", "references": [], "description": ""}, {"id": "2a9fc691c3dc", "fix": {"template": null, "available": false}, "title": "File open with user input - potential path traversal", "ruleId": "rules.py-open-user-input", "snippet": {"code": "    data = open(fn, 'rb').read()", "highlightLines": [4]}, "category": "code", "location": {"file": "www/pdf_generator/weasy.py", "line": 4, "column": 12}, "severity": "medium", "references": [], "description": ""}, {"id": "451d71e20b7f", "fix": {"template": null, "available": false}, "title": "Potential path traversal - validate file path is not user-controlled (CWE-22)", "ruleId": "rules.py-path-traversal-open", "snippet": {"code": "    data = open(fn, 'rb').read()", "highlightLines": [4]}, "category": "code", "location": {"file": "www/pdf_generator/weasy.py", "line": 4, "column": 12}, "severity": "medium", "references": [], "description": ""}, {"id": "ea1875041616", "fix": {"template": null, "available": false}, "title": "File open with variable path - validate path to prevent path traversal (CWE-22)", "ruleId": "rules.py-path-traversal-open-var", "snippet": {"code": "    data = open(fn, 'rb').read()", "highlightLines": [4]}, "category": "code", "location": {"file": "www/pdf_generator/weasy.py", "line": 4, "column": 12}, "severity": "medium", "references": [], "description": ""}, {"id": "9ccb1b35680d", "fix": {"template": null, "available": false}, "title": "Bare except clause - catch specific exceptions", "ruleId": "rules.py-bare-except", "snippet": {"code": "        try:\n            last = cdata = zlib.decompress(data[i:])\n            if first:\n                first = False\n            else:\n                pass#print cdata\n        except:\n            pass", "highlightLines": [13]}, "category": "code", "location": {"file": "www/pdf_generator/weasy.py", "line": 13, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "1e51653ac20f", "fix": {"template": null, "available": false}, "title": "Bare except catches all exceptions including KeyboardInterrupt - be specific (CWE-396)", "ruleId": "rules.py-bare-exception", "snippet": {"code": "        except:", "highlightLines": [19]}, "category": "code", "location": {"file": "www/pdf_generator/weasy.py", "line": 19, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "e5da5033f449", "fix": {"template": null, "available": false}, "title": "Print statement found - consider using logging", "ruleId": "rules.py-print-statement", "snippet": {"code": "    print(last.decode('utf-8'))", "highlightLines": [21]}, "category": "code", "location": {"file": "www/pdf_generator/weasy.py", "line": 21, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "5ad89f3e51a3", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "Password: </td><td", "highlightLines": [121]}, "category": "secrets", "location": {"file": "www/sql_connect.php", "line": 121}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}]}]