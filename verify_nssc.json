[{"findings":[{"id": "4e0ab89b0384", "fix": {"template": null, "available": false}, "title": "SWC-118: Function name matches contract name - likely intended as constructor (pre-0.4.22)", "ruleId": "rules.sol-swc-118-constructor-mismatch", "snippet": {"code": "contract theRun {\n        uint private Balance = 0;\n        uint private Payout_id = 0;\n        uint private Last_Payout = 0;\n        uint private WinningPot = 0;\n        uint private Min_multiplier = 1100; //110%\n        \n\n        //Fees are necessary and set very low, to maintain the website. The fees will decrease each time they are collected.\n        //Fees are just here to maintain the website at beginning, and will progressively go to 0% :)\n        uint private fees = 0;\n        uint private feeFrac = 20; //Fraction for fees in per\"thousand\", not percent, so 20 is 2%\n        \n        uint private PotFrac = 30; //For the WinningPot ,30=> 3% are collected. This is fixed.\n        \n        \n        address private admin;\n        \n        function theRun() {", "highlightLines": [1]}, "category": "code", "location": {"file": "bad_randomness/theRun_source_code/theRun.sol", "line": 1, "column": 1}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-118"], "description": ""}, {"id": "8c873b04f619", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "        function theRun() {\n            admin = msg.sender;\n        }", "highlightLines": [19]}, "category": "code", "location": {"file": "bad_randomness/theRun_source_code/theRun.sol", "line": 19, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "77599c630c7f", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "        modifier onlyowner {if (msg.sender == admin) _;  }", "highlightLines": [23]}, "category": "code", "location": {"file": "bad_randomness/theRun_source_code/theRun.sol", "line": 23, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "fc9f29325568", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            address addr;", "highlightLines": [26]}, "category": "code", "location": {"file": "bad_randomness/theRun_source_code/theRun.sol", "line": 26, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "800805ec8523", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint payout;", "highlightLines": [27]}, "category": "code", "location": {"file": "bad_randomness/theRun_source_code/theRun.sol", "line": 27, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7689c3dd8b55", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            bool paid;", "highlightLines": [28]}, "category": "code", "location": {"file": "bad_randomness/theRun_source_code/theRun.sol", "line": 28, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ed57a575bc3b", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "        function() {\n            init();\n        }", "highlightLines": [34]}, "category": "code", "location": {"file": "bad_randomness/theRun_source_code/theRun.sol", "line": 34, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "1ba5ad870d50", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint deposit=msg.value;", "highlightLines": [40]}, "category": "code", "location": {"file": "bad_randomness/theRun_source_code/theRun.sol", "line": 40, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "af2aae2b30ae", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            uint deposit=msg.value;\n            if (msg.value < 500 finney) { //only participation with >1 ether accepted\n                    msg.sender.send(msg.value);\n                    return;\n            }\n            if (msg.value > 20 ether) { //only participation with <20 ether accepted\n                    msg.sender.send(msg.value- (20 ether));\n                    deposit=20 ether;\n            }", "highlightLines": [40]}, "category": "code", "location": {"file": "bad_randomness/theRun_source_code/theRun.sol", "line": 40, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "58934a17d0bc", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "                    msg.sender.send(msg.value);", "highlightLines": [42]}, "category": "code", "location": {"file": "bad_randomness/theRun_source_code/theRun.sol", "line": 42, "column": 21}, "severity": "high", "references": [], "description": ""}, {"id": "bdd6c225ce27", "fix": {"template": null, "available": false}, "title": "send() return value not checked - Ether may be stuck if recipient reverts", "ruleId": "rules.sol-unchecked-send-return", "snippet": {"code": "                    msg.sender.send(msg.value);", "highlightLines": [42]}, "category": "code", "location": {"file": "bad_randomness/theRun_source_code/theRun.sol", "line": 42, "column": 31}, "severity": "high", "references": [], "description": ""}, {"id": "116dcf806704", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "                    return;", "highlightLines": [43]}, "category": "code", "location": {"file": "bad_randomness/theRun_source_code/theRun.sol", "line": 43, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "eb3c3cabdd21", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "                    msg.sender.send(msg.value- (20 ether));", "highlightLines": [46]}, "category": "code", "location": {"file": "bad_randomness/theRun_source_code/theRun.sol", "line": 46, "column": 21}, "severity": "high", "references": [], "description": ""}, {"id": "042f6b88e84d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "                \n\n                uint total_multiplier=Min_multiplier; //initiate total_multiplier", "highlightLines": [55]}, "category": "code", "location": {"file": "bad_randomness/theRun_source_code/theRun.sol", "line": 55, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c277929271da", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "                uint total_multiplier=Min_multiplier; //initiate total_multiplier", "highlightLines": [57]}, "category": "code", "location": {"file": "bad_randomness/theRun_source_code/theRun.sol", "line": 57, "column": 17}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "04f1d6b0838f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "                uint total_multiplier=Min_multiplier; //initiate total_multiplier\n                if(Balance < 1 ether && players.length>1){\n                    total_multiplier+=100; // + 10 %\n                }\n                if( (players.length % 10)==0 && players.length>1 ){ //Every 10th participant gets a 10% bonus, play smart !\n                    total_multiplier+=100; // + 10 %\n                }\n                \n                //add new player in the queue !\n                players.push(Player(msg.sender, (deposit * total_multiplier) / 1000, false));\n                \n                //--- UPDATING CONTRACT STATS ----\n                WinningPot += (deposit * PotFrac) / 1000; // take some 3% to add for the winning pot !\n                fees += (deposit * feeFrac) / 1000; // collect maintenance fees 2%\n                Balance += (deposit * (1000 - ( feeFrac + PotFrac ))) / 1000; // update balance\n\n                // Winning the Pot :) Condition : paying at least 1 people with deposit > 2 ether and having luck !\n                if(  ( deposit > 1 ether ) && (deposit > players[Payout_id].payout) ){ \n                    uint roll = random(100); //take a random number between 1 & 100\n                    if( roll % 10 == 0 ){ //if lucky : Chances : 1 out of 10 ! \n                        msg.sender.send(WinningPot); // Bravo !\n                        WinningPot=0;\n                    }\n                    \n                }", "highlightLines": [57]}, "category": "code", "location": {"file": "bad_randomness/theRun_source_code/theRun.sol", "line": 57, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "ad5e1048ac09", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "                    uint roll = random(100); //take a random number between 1 & 100", "highlightLines": [75]}, "category": "code", "location": {"file": "bad_randomness/theRun_source_code/theRun.sol", "line": 75, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "1de14cd2affa", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "                    uint roll = random(100); //take a random number between 1 & 100\n                    if( roll % 10 == 0 ){ //if lucky : Chances : 1 out of 10 ! \n                        msg.sender.send(WinningPot); // Bravo !\n                        WinningPot=0;\n                    }", "highlightLines": [75]}, "category": "code", "location": {"file": "bad_randomness/theRun_source_code/theRun.sol", "line": 75, "column": 21}, "severity": "medium", "references": [], "description": ""}, {"id": "4f06fcc929fb", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "                        msg.sender.send(WinningPot); // Bravo !", "highlightLines": [77]}, "category": "code", "location": {"file": "bad_randomness/theRun_source_code/theRun.sol", "line": 77, "column": 25}, "severity": "high", "references": [], "description": ""}, {"id": "1fb30f44bb82", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "                    Last_Payout = players[Payout_id].payout;\n                    players[Payout_id].addr.send(Last_Payout); //pay the man, please !\n                    Balance -= players[Payout_id].payout; //update the balance\n                    players[Payout_id].paid=true;", "highlightLines": [85]}, "category": "code", "location": {"file": "bad_randomness/theRun_source_code/theRun.sol", "line": 85, "column": 21}, "severity": "medium", "references": [], "description": ""}, {"id": "3693490da287", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "                    players[Payout_id].addr.send(Last_Payout); //pay the man, please !", "highlightLines": [86]}, "category": "code", "location": {"file": "bad_randomness/theRun_source_code/theRun.sol", "line": 86, "column": 21}, "severity": "high", "references": [], "description": ""}, {"id": "cc7341fd3a72", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "    uint256 constant private salt =  block.timestamp;", "highlightLines": [96]}, "category": "code", "location": {"file": "bad_randomness/theRun_source_code/theRun.sol", "line": 96, "column": 38}, "severity": "medium", "references": [], "description": ""}, {"id": "fb0a3adbeea2", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 x = salt * 100 / Max;", "highlightLines": [100]}, "category": "code", "location": {"file": "bad_randomness/theRun_source_code/theRun.sol", "line": 100, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "cb76ff33fc68", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 x = salt * 100 / Max;\n        uint256 y = salt * block.number / (salt % 5) ;", "highlightLines": [100]}, "category": "code", "location": {"file": "bad_randomness/theRun_source_code/theRun.sol", "line": 100, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "c069c4010a59", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 y = salt * block.number / (salt % 5) ;", "highlightLines": [101]}, "category": "code", "location": {"file": "bad_randomness/theRun_source_code/theRun.sol", "line": 101, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "00fd65b69f46", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 y = salt * block.number / (salt % 5) ;\n        uint256 seed = block.number/3 + (salt % 300) + Last_Payout +y;", "highlightLines": [101]}, "category": "code", "location": {"file": "bad_randomness/theRun_source_code/theRun.sol", "line": 101, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "38e138a43683", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 seed = block.number/3 + (salt % 300) + Last_Payout +y;", "highlightLines": [102]}, "category": "code", "location": {"file": "bad_randomness/theRun_source_code/theRun.sol", "line": 102, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "5a03c0ea9964", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 seed = block.number/3 + (salt % 300) + Last_Payout +y; \n        uint256 h = uint256(block.blockhash(seed));", "highlightLines": [102]}, "category": "code", "location": {"file": "bad_randomness/theRun_source_code/theRun.sol", "line": 102, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "930b8157f40a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 h = uint256(block.blockhash(seed));", "highlightLines": [103]}, "category": "code", "location": {"file": "bad_randomness/theRun_source_code/theRun.sol", "line": 103, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "082556322f35", "fix": {"template": null, "available": false}, "title": "blockhash only works for last 256 blocks - older blocks return 0 (PredictTheBlockHash pattern)", "ruleId": "rules.sol-blockhash-256-limit", "snippet": {"code": "        uint256 h = uint256(block.blockhash(seed));", "highlightLines": [103]}, "category": "code", "location": {"file": "bad_randomness/theRun_source_code/theRun.sol", "line": 103, "column": 29}, "severity": "medium", "references": ["https://capturetheether.com/challenges/lottery/predict-block-hash/"], "description": ""}, {"id": "c18e91221a0e", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function ChangeOwnership(address _owner) onlyowner {\n        admin = _owner;\n    }", "highlightLines": [111]}, "category": "code", "location": {"file": "bad_randomness/theRun_source_code/theRun.sol", "line": 111, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "5746f0b968b3", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function WatchBalance() constant returns(uint TotalBalance) {\n        TotalBalance = Balance /  1 wei;\n    }", "highlightLines": [114]}, "category": "code", "location": {"file": "bad_randomness/theRun_source_code/theRun.sol", "line": 114, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "1d6391b70f4c", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function WatchBalanceInEther() constant returns(uint TotalBalanceInEther) {\n        TotalBalanceInEther = Balance /  1 ether;\n    }", "highlightLines": [118]}, "category": "code", "location": {"file": "bad_randomness/theRun_source_code/theRun.sol", "line": 118, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "c563868be79d", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function CollectAllFees() onlyowner {\n        if (fees == 0) throw;\n        admin.send(fees);\n        feeFrac-=1;\n        fees = 0;\n    }", "highlightLines": [124]}, "category": "code", "location": {"file": "bad_randomness/theRun_source_code/theRun.sol", "line": 124, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "8010214ad61f", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "        if (fees == 0) throw;\n        admin.send(fees);", "highlightLines": [125]}, "category": "code", "location": {"file": "bad_randomness/theRun_source_code/theRun.sol", "line": 125, "column": 24}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "8f1b3010a374", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "        admin.send(fees);", "highlightLines": [126]}, "category": "code", "location": {"file": "bad_randomness/theRun_source_code/theRun.sol", "line": 126, "column": 9}, "severity": "high", "references": [], "description": ""}, {"id": "265d4cc9ae40", "fix": {"template": null, "available": false}, "title": "send() return value not checked - Ether may be stuck if recipient reverts", "ruleId": "rules.sol-unchecked-send-return", "snippet": {"code": "        admin.send(fees);", "highlightLines": [126]}, "category": "code", "location": {"file": "bad_randomness/theRun_source_code/theRun.sol", "line": 126, "column": 14}, "severity": "high", "references": [], "description": ""}, {"id": "6bc8e607c4d5", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function GetAndReduceFeesByFraction(uint p) onlyowner {\n        if (fees == 0) feeFrac-=1; //Reduce fees.\n        admin.send(fees / 1000 * p);//send a percent of fees\n        fees -= fees / 1000 * p;\n    }", "highlightLines": [131]}, "category": "code", "location": {"file": "bad_randomness/theRun_source_code/theRun.sol", "line": 131, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "4d53467d6829", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "        admin.send(fees / 1000 * p);//send a percent of fees", "highlightLines": [133]}, "category": "code", "location": {"file": "bad_randomness/theRun_source_code/theRun.sol", "line": 133, "column": 9}, "severity": "high", "references": [], "description": ""}, {"id": "6cf9072a57a1", "fix": {"template": null, "available": false}, "title": "Division before multiplication causes precision loss", "ruleId": "rules.sol-division-before-multiplication", "snippet": {"code": "        admin.send(fees / 1000 * p);//send a percent of fees", "highlightLines": [133]}, "category": "code", "location": {"file": "bad_randomness/theRun_source_code/theRun.sol", "line": 133, "column": 20}, "severity": "medium", "references": [], "description": ""}, {"id": "248d8aecacf7", "fix": {"template": null, "available": false}, "title": "Division before multiplication causes precision loss", "ruleId": "rules.sol-division-before-multiplication", "snippet": {"code": "        fees -= fees / 1000 * p;", "highlightLines": [134]}, "category": "code", "location": {"file": "bad_randomness/theRun_source_code/theRun.sol", "line": 134, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "f64d7573dbcb", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "function NextPayout() constant returns(uint NextPayout) {\n    NextPayout = players[Payout_id].payout /  1 wei;\n}", "highlightLines": [139]}, "category": "code", "location": {"file": "bad_randomness/theRun_source_code/theRun.sol", "line": 139, "column": 1}, "severity": "medium", "references": [], "description": ""}, {"id": "15569b656434", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "function WatchFees() constant returns(uint CollectedFees) {\n    CollectedFees = fees / 1 wei;\n}", "highlightLines": [143]}, "category": "code", "location": {"file": "bad_randomness/theRun_source_code/theRun.sol", "line": 143, "column": 1}, "severity": "medium", "references": [], "description": ""}, {"id": "f7987a4607a4", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "function WatchWinningPot() constant returns(uint WinningPot) {\n    WinningPot = WinningPot / 1 wei;\n}", "highlightLines": [148]}, "category": "code", "location": {"file": "bad_randomness/theRun_source_code/theRun.sol", "line": 148, "column": 1}, "severity": "medium", "references": [], "description": ""}, {"id": "8d7c21916c0f", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "function WatchLastPayout() constant returns(uint payout) {\n    payout = Last_Payout;\n}", "highlightLines": [152]}, "category": "code", "location": {"file": "bad_randomness/theRun_source_code/theRun.sol", "line": 152, "column": 1}, "severity": "medium", "references": [], "description": ""}, {"id": "0970f4adf43b", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "function Total_of_Players() constant returns(uint NumberOfPlayers) {\n    NumberOfPlayers = players.length;\n}", "highlightLines": [156]}, "category": "code", "location": {"file": "bad_randomness/theRun_source_code/theRun.sol", "line": 156, "column": 1}, "severity": "medium", "references": [], "description": ""}, {"id": "7f1d52297f3c", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "function PlayerInfo(uint id) constant returns(address Address, uint Payout, bool UserPaid) {\n    if (id <= players.length) {\n        Address = players[id].addr;\n        Payout = players[id].payout / 1 wei;\n        UserPaid=players[id].paid;\n    }\n}", "highlightLines": [160]}, "category": "code", "location": {"file": "bad_randomness/theRun_source_code/theRun.sol", "line": 160, "column": 1}, "severity": "medium", "references": [], "description": ""}, {"id": "2a4d6941693e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        Address = players[id].addr;\n        Payout = players[id].payout / 1 wei;", "highlightLines": [162]}, "category": "code", "location": {"file": "bad_randomness/theRun_source_code/theRun.sol", "line": 162, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "529c04d38fbb", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        Payout = players[id].payout / 1 wei;\n        UserPaid=players[id].paid;", "highlightLines": [163]}, "category": "code", "location": {"file": "bad_randomness/theRun_source_code/theRun.sol", "line": 163, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "cc7a9e1d0cae", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "function PayoutQueueSize() constant returns(uint QueueSize) {\n    QueueSize = players.length - Payout_id;\n}", "highlightLines": [168]}, "category": "code", "location": {"file": "bad_randomness/theRun_source_code/theRun.sol", "line": 168, "column": 1}, "severity": "medium", "references": [], "description": ""}, {"id": "305868d8b27f", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.15;", "highlightLines": [1]}, "category": "code", "location": {"file": "denial_of_service/auction.sol", "line": 1, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "106bdfb8e383", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.15;", "highlightLines": [1]}, "category": "code", "location": {"file": "denial_of_service/auction.sol", "line": 1, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "8c96d7501694", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "  address currentFrontrunner;", "highlightLines": [5]}, "category": "code", "location": {"file": "denial_of_service/auction.sol", "line": 5, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d39a7fd21c38", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "  uint currentBid;", "highlightLines": [6]}, "category": "code", "location": {"file": "denial_of_service/auction.sol", "line": 6, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d098dca93c4f", "fix": {"template": null, "available": false}, "title": "SWC-114: Transaction order dependence - vulnerable to front-running/sandwich attacks", "ruleId": "rules.sol-swc-114-front-running", "snippet": {"code": "  function bid() payable {\n    require(msg.value > currentBid);", "highlightLines": [9]}, "category": "code", "location": {"file": "denial_of_service/auction.sol", "line": 9, "column": 3}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-114"], "description": ""}, {"id": "cacbd58e7f9d", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function bid() payable {\n    require(msg.value > currentBid);\n\n    //If the refund fails, the entire transaction reverts.\n    //Therefore a frontrunner who always fails will win\n    if (currentFrontrunner != 0) {\n      //E.g. if recipients fallback function is just revert()\n      require(currentFrontrunner.send(currentBid));\n    }\n\n    currentFrontrunner = msg.sender;\n    currentBid         = msg.value;\n  }", "highlightLines": [9]}, "category": "code", "location": {"file": "denial_of_service/auction.sol", "line": 9, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "b111c7108b55", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(msg.value > currentBid);", "highlightLines": [10]}, "category": "code", "location": {"file": "denial_of_service/auction.sol", "line": 10, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "6b31090604d7", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "      require(currentFrontrunner.send(currentBid));", "highlightLines": [16]}, "category": "code", "location": {"file": "denial_of_service/auction.sol", "line": 16, "column": 7}, "severity": "info", "references": [], "description": ""}, {"id": "249c49cbe21d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    currentFrontrunner = msg.sender;\n    currentBid         = msg.value;", "highlightLines": [19]}, "category": "code", "location": {"file": "denial_of_service/auction.sol", "line": 19, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "1a6622b66782", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "  address currentFrontrunner;", "highlightLines": [27]}, "category": "code", "location": {"file": "denial_of_service/auction.sol", "line": 27, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "dd7c2ab13da6", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "  uint    currentBid;", "highlightLines": [28]}, "category": "code", "location": {"file": "denial_of_service/auction.sol", "line": 28, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f63f30098a48", "fix": {"template": null, "available": false}, "title": "SWC-114: Transaction order dependence - vulnerable to front-running/sandwich attacks", "ruleId": "rules.sol-swc-114-front-running", "snippet": {"code": "  function bid() payable external {\n    require(msg.value > currentBid);", "highlightLines": [33]}, "category": "code", "location": {"file": "denial_of_service/auction.sol", "line": 33, "column": 3}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-114"], "description": ""}, {"id": "c5f951a506ae", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(msg.value > currentBid);", "highlightLines": [34]}, "category": "code", "location": {"file": "denial_of_service/auction.sol", "line": 34, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "40281cf77ead", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    currentFrontrunner = msg.sender;\n    currentBid         = msg.value;", "highlightLines": [40]}, "category": "code", "location": {"file": "denial_of_service/auction.sol", "line": 40, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "0224f3daf62d", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "  function withdraw() external {", "highlightLines": [45]}, "category": "code", "location": {"file": "denial_of_service/auction.sol", "line": 45, "column": 3}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "c50585908167", "fix": {"template": null, "available": false}, "title": "SWC-105: Ether withdrawal without access control - anyone can drain funds", "ruleId": "rules.sol-swc-105-unprotected-withdrawal", "snippet": {"code": "  function withdraw() external {\n    //Do all state manipulation before external call to\n    //avoid reentrancy attack\n    uint refund = refunds[msg.sender];\n    refunds[msg.sender] = 0;\n\n    msg.sender.send(refund);", "highlightLines": [45]}, "category": "code", "location": {"file": "denial_of_service/auction.sol", "line": 45, "column": 3}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-105"], "description": ""}, {"id": "dc1f9e69630c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint refund = refunds[msg.sender];", "highlightLines": [48]}, "category": "code", "location": {"file": "denial_of_service/auction.sol", "line": 48, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "56eb51a6bad3", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint refund = refunds[msg.sender];\n    refunds[msg.sender] = 0;", "highlightLines": [48]}, "category": "code", "location": {"file": "denial_of_service/auction.sol", "line": 48, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "75219be9d4bd", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "    msg.sender.send(refund);", "highlightLines": [51]}, "category": "code", "location": {"file": "denial_of_service/auction.sol", "line": 51, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "8f5a76ab55d6", "fix": {"template": null, "available": false}, "title": "send() return value not checked - Ether may be stuck if recipient reverts", "ruleId": "rules.sol-unchecked-send-return", "snippet": {"code": "    msg.sender.send(refund);", "highlightLines": [51]}, "category": "code", "location": {"file": "denial_of_service/auction.sol", "line": 51, "column": 15}, "severity": "high", "references": [], "description": ""}, {"id": "431bc8673110", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.15;", "highlightLines": [1]}, "category": "code", "location": {"file": "denial_of_service/list_dos.sol", "line": 1, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "8a75289ab9bb", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.15;", "highlightLines": [1]}, "category": "code", "location": {"file": "denial_of_service/list_dos.sol", "line": 1, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "11f5038ad566", "fix": {"template": null, "available": false}, "title": "Unbounded loop iterating over dynamic array - can cause out-of-gas DoS", "ruleId": "rules.sol-unbounded-loop-dos", "snippet": {"code": "    for(uint i; i < refundAddresses.length; i++) {\n      require(refundAddresses[i].transfer(refundAmount[refundAddresses[i]]));", "highlightLines": [8]}, "category": "code", "location": {"file": "denial_of_service/list_dos.sol", "line": 8, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "147f40cadabf", "fix": {"template": null, "available": false}, "title": "Unbounded loop over dynamic array - can cause DoS if array grows large", "ruleId": "rules.sol-unbounded-protocol-loop", "snippet": {"code": "    for(uint i; i < refundAddresses.length; i++) {\n      require(refundAddresses[i].transfer(refundAmount[refundAddresses[i]]));", "highlightLines": [8]}, "category": "code", "location": {"file": "denial_of_service/list_dos.sol", "line": 8, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "778e00addda3", "fix": {"template": null, "available": false}, "title": "Loop with external transfers - one failing recipient blocks all others", "ruleId": "rules.sol-denial-of-service-loop-transfer", "snippet": {"code": "    for(uint i; i < refundAddresses.length; i++) {\n      require(refundAddresses[i].transfer(refundAmount[refundAddresses[i]]));", "highlightLines": [8]}, "category": "code", "location": {"file": "denial_of_service/list_dos.sol", "line": 8, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "43bc5acb2b14", "fix": {"template": null, "available": false}, "title": "ETH transfer inside loop - single failed transfer blocks all others (DoS pattern)", "ruleId": "rules.sol-loop-with-transfer", "snippet": {"code": "    for(uint i; i < refundAddresses.length; i++) {\n      require(refundAddresses[i].transfer(refundAmount[refundAddresses[i]]));", "highlightLines": [8]}, "category": "code", "location": {"file": "denial_of_service/list_dos.sol", "line": 8, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "78093522587e", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "      require(refundAddresses[i].transfer(refundAmount[refundAddresses[i]]));", "highlightLines": [9]}, "category": "code", "location": {"file": "denial_of_service/list_dos.sol", "line": 9, "column": 7}, "severity": "info", "references": [], "description": ""}, {"id": "5986a30817d6", "fix": {"template": null, "available": false}, "title": "External call in loop - gas griefing and DOS risk", "ruleId": "rules.sol-external-call-in-loop", "snippet": {"code": "      require(refundAddresses[i].transfer(refundAmount[refundAddresses[i]]));", "highlightLines": [9]}, "category": "code", "location": {"file": "denial_of_service/list_dos.sol", "line": 9, "column": 15}, "severity": "high", "references": [], "description": ""}, {"id": "23ef388450ea", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "  function withdraw() external {", "highlightLines": [18]}, "category": "code", "location": {"file": "denial_of_service/list_dos.sol", "line": 18, "column": 3}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "65f259f012e4", "fix": {"template": null, "available": false}, "title": "SWC-105: Ether withdrawal without access control - anyone can drain funds", "ruleId": "rules.sol-swc-105-unprotected-withdrawal", "snippet": {"code": "  function withdraw() external {\n    uint refund = refundAmount[msg.sender];\n    refundAmount[msg.sender] = 0;\n    msg.sender.transfer(refund);", "highlightLines": [18]}, "category": "code", "location": {"file": "denial_of_service/list_dos.sol", "line": 18, "column": 3}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-105"], "description": ""}, {"id": "11aff55cb7ef", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint refund = refundAmount[msg.sender];", "highlightLines": [19]}, "category": "code", "location": {"file": "denial_of_service/list_dos.sol", "line": 19, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "49f8cde717f3", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint refund = refundAmount[msg.sender];\n    refundAmount[msg.sender] = 0;", "highlightLines": [19]}, "category": "code", "location": {"file": "denial_of_service/list_dos.sol", "line": 19, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "9160a2651f74", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "    msg.sender.transfer(refund);", "highlightLines": [21]}, "category": "code", "location": {"file": "denial_of_service/list_dos.sol", "line": 21, "column": 5}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "c79230d2928a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "  uint256 nextIdx;", "highlightLines": [31]}, "category": "code", "location": {"file": "denial_of_service/list_dos.sol", "line": 31, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "6f2c43914144", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 i = nextIdx;", "highlightLines": [34]}, "category": "code", "location": {"file": "denial_of_service/list_dos.sol", "line": 34, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "205b80f03ad1", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 i = nextIdx;\n    while(i < refundAddresses.length && msg.gas > 200000) {\n      refundAddresses[i].transfer(refundAmount[i]);\n      i++;\n    }\n    nextIdx = i;", "highlightLines": [34]}, "category": "code", "location": {"file": "denial_of_service/list_dos.sol", "line": 34, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "1ed1160c8849", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "      refundAddresses[i].transfer(refundAmount[i]);", "highlightLines": [36]}, "category": "code", "location": {"file": "denial_of_service/list_dos.sol", "line": 36, "column": 7}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "d395ba4a6fec", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.16;", "highlightLines": [3]}, "category": "code", "location": {"file": "forced_ether_reception/coin.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "2ff053c65f6f", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.16;", "highlightLines": [3]}, "category": "code", "location": {"file": "forced_ether_reception/coin.sol", "line": 3, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "b465500bab81", "fix": {"template": null, "available": false}, "title": "SWC-118: Function name matches contract name - likely intended as constructor (pre-0.4.22)", "ruleId": "rules.sol-swc-118-constructor-mismatch", "snippet": {"code": "contract owned {\n    address public owner;\n\n    function owned() public {", "highlightLines": [5]}, "category": "code", "location": {"file": "forced_ether_reception/coin.sol", "line": 5, "column": 1}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-118"], "description": ""}, {"id": "14d9b3eda180", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        owner = msg.sender;", "highlightLines": [9]}, "category": "code", "location": {"file": "forced_ether_reception/coin.sol", "line": 9, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "42eca7b05d97", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyOwner {\n        require(msg.sender == owner);\n        _;\n    }", "highlightLines": [12]}, "category": "code", "location": {"file": "forced_ether_reception/coin.sol", "line": 12, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "001e95e17fe5", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "        require(msg.sender == owner);", "highlightLines": [13]}, "category": "code", "location": {"file": "forced_ether_reception/coin.sol", "line": 13, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "cc469a447346", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender == owner);", "highlightLines": [13]}, "category": "code", "location": {"file": "forced_ether_reception/coin.sol", "line": 13, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "20414b746465", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [14]}, "category": "code", "location": {"file": "forced_ether_reception/coin.sol", "line": 14, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "d409a22d386a", "fix": {"template": null, "available": false}, "title": "Access control change without event emission - harder to monitor and audit", "ruleId": "rules.sol-missing-events-access-control", "snippet": {"code": "    function transferOwnership(address newOwner) onlyOwner public {", "highlightLines": [17]}, "category": "code", "location": {"file": "forced_ether_reception/coin.sol", "line": 17, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-access-control"], "description": ""}, {"id": "5139233c9793", "fix": {"template": null, "available": false}, "title": "Critical ownership transfer in single step - use two-step transfer with pending owner acceptance", "ruleId": "rules.sol-two-step-ownership", "snippet": {"code": "    function transferOwnership(address newOwner) onlyOwner public {\n        owner = newOwner;\n    }", "highlightLines": [17]}, "category": "code", "location": {"file": "forced_ether_reception/coin.sol", "line": 17, "column": 5}, "severity": "info", "references": ["https://docs.openzeppelin.com/contracts/access-control"], "description": ""}, {"id": "93afbc816412", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function transferOwnership(address newOwner) onlyOwner public {", "highlightLines": [17]}, "category": "code", "location": {"file": "forced_ether_reception/coin.sol", "line": 17, "column": 50}, "severity": "info", "references": [], "description": ""}, {"id": "dc70dca007aa", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        owner = newOwner;", "highlightLines": [18]}, "category": "code", "location": {"file": "forced_ether_reception/coin.sol", "line": 18, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "b3b85e08b194", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "interface tokenRecipient { function receiveApproval(address _from, uint256 _value, address _token, bytes _extraData) external; }", "highlightLines": [22]}, "category": "code", "location": {"file": "forced_ether_reception/coin.sol", "line": 22, "column": 28}, "severity": "info", "references": [], "description": ""}, {"id": "32cb6c00ce60", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "interface tokenRecipient { function receiveApproval(address _from, uint256 _value, address _token, bytes _extraData) external; }\n\ncontract TokenERC20 {\n    // Public variables of the token\n    string public name;\n    string public symbol;\n    uint8 public decimals = 18;\n    // 18 decimals is the strongly suggested default, avoid changing it\n    uint256 public totalSupply;\n\n    // This creates an array with all balances\n    mapping (address => uint256) public balanceOf;\n    mapping (address => mapping (address => uint256)) public allowance;", "highlightLines": [22]}, "category": "code", "location": {"file": "forced_ether_reception/coin.sol", "line": 22, "column": 28}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "1fddc77261a5", "fix": {"template": null, "available": false}, "title": "SWC-118: Function name matches contract name - likely intended as constructor (pre-0.4.22)", "ruleId": "rules.sol-swc-118-constructor-mismatch", "snippet": {"code": "contract TokenERC20 {\n    // Public variables of the token\n    string public name;\n    string public symbol;\n    uint8 public decimals = 18;\n    // 18 decimals is the strongly suggested default, avoid changing it\n    uint256 public totalSupply;\n\n    // This creates an array with all balances\n    mapping (address => uint256) public balanceOf;\n    mapping (address => mapping (address => uint256)) public allowance;\n\n    // This generates a public event on the blockchain that will notify clients\n    event Transfer(address indexed from, address indexed to, uint256 value);\n    \n    // This generates a public event on the blockchain that will notify clients\n    event Approval(address indexed _owner, address indexed _spender, uint256 _value);\n\n    /**\n     * Constrctor function\n     *\n     * Initializes contract with initial supply tokens to the creator of the contract\n     */\n    function TokenERC20(", "highlightLines": [24]}, "category": "code", "location": {"file": "forced_ether_reception/coin.sol", "line": 24, "column": 1}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-118"], "description": ""}, {"id": "2d59bbaf1684", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Transfer(address indexed from, address indexed to, uint256 value);", "highlightLines": [37]}, "category": "code", "location": {"file": "forced_ether_reception/coin.sol", "line": 37, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "b391f4d1b6e7", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Approval(address indexed _owner, address indexed _spender, uint256 _value);", "highlightLines": [40]}, "category": "code", "location": {"file": "forced_ether_reception/coin.sol", "line": 40, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "eb67d6510973", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        name = tokenName;                                   // Set the name for display purposes\n        symbol = tokenSymbol;                               // Set the symbol for display purposes", "highlightLines": [51]}, "category": "code", "location": {"file": "forced_ether_reception/coin.sol", "line": 51, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "ae1210cfd3de", "fix": {"template": null, "available": false}, "title": "Self transfer not checked - can cause balance corruption with from == to", "ruleId": "rules.sol-self-transfer-unchecked", "snippet": {"code": "    function _transfer(address _from, address _to, uint _value) internal {", "highlightLines": [58]}, "category": "code", "location": {"file": "forced_ether_reception/coin.sol", "line": 58, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/self-transfer.sol"], "description": ""}, {"id": "3dd27a23e24f", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_to != 0x0);", "highlightLines": [60]}, "category": "code", "location": {"file": "forced_ether_reception/coin.sol", "line": 60, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "2d5f43957a81", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(balanceOf[_from] >= _value);", "highlightLines": [62]}, "category": "code", "location": {"file": "forced_ether_reception/coin.sol", "line": 62, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "3199624f809d", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(balanceOf[_to] + _value > balanceOf[_to]);", "highlightLines": [64]}, "category": "code", "location": {"file": "forced_ether_reception/coin.sol", "line": 64, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "29b413d4d0c1", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint previousBalances = balanceOf[_from] + balanceOf[_to];", "highlightLines": [66]}, "category": "code", "location": {"file": "forced_ether_reception/coin.sol", "line": 66, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c7bd0ee1ce49", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function transfer(address _to, uint256 _value) public returns (bool success) {", "highlightLines": [84]}, "category": "code", "location": {"file": "forced_ether_reception/coin.sol", "line": 84, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "58caa8426389", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without msg.data.length validation - vulnerable to short address attack padding", "ruleId": "rules.sol-short-address-no-payload-check", "snippet": {"code": "    function transfer(address _to, uint256 _value) public returns (bool success) {", "highlightLines": [84]}, "category": "code", "location": {"file": "forced_ether_reception/coin.sol", "line": 84, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address", "https://vessenes.com/the-erc20-short-address-attack-explained/"], "description": ""}, {"id": "db9c34af7aee", "fix": {"template": null, "available": false}, "title": "ERC20 transferFrom without payload size validation - consider adding onlyPayloadSize modifier", "ruleId": "rules.sol-erc20-missing-payload-modifier", "snippet": {"code": "    function transferFrom(address _from, address _to, uint256 _value) public returns (bool success) {", "highlightLines": [98]}, "category": "code", "location": {"file": "forced_ether_reception/coin.sol", "line": 98, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address"], "description": ""}, {"id": "9853f3dec59a", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function transferFrom(address _from, address _to, uint256 _value) public returns (bool success) {", "highlightLines": [98]}, "category": "code", "location": {"file": "forced_ether_reception/coin.sol", "line": 98, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "f1600019746c", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "    function transferFrom(address _from, address _to, uint256 _value) public returns (bool success) {\n        require(_value <= allowance[_from][msg.sender]);     // Check allowance", "highlightLines": [98]}, "category": "code", "location": {"file": "forced_ether_reception/coin.sol", "line": 98, "column": 5}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "3ffe1f91b926", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - will never return false, only revert", "ruleId": "rules.sol-return-bool-always-reverts", "snippet": {"code": "    function transferFrom(address _from, address _to, uint256 _value) public returns (bool success) {\n        require(_value <= allowance[_from][msg.sender]);     // Check allowance\n        allowance[_from][msg.sender] -= _value;\n        _transfer(_from, _to, _value);\n        return true;\n    }", "highlightLines": [98]}, "category": "code", "location": {"file": "forced_ether_reception/coin.sol", "line": 98, "column": 5}, "severity": "info", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "49ef13a2c85c", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_value <= allowance[_from][msg.sender]);     // Check allowance", "highlightLines": [99]}, "category": "code", "location": {"file": "forced_ether_reception/coin.sol", "line": 99, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "656594f25ded", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function approve(address _spender, uint256 _value) public\n        returns (bool success) {", "highlightLines": [113]}, "category": "code", "location": {"file": "forced_ether_reception/coin.sol", "line": 113, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "985354518b1f", "fix": {"template": null, "available": false}, "title": "approveAndCall pattern enables callback attacks - verify callback target", "ruleId": "rules.sol-approve-and-call-callback", "snippet": {"code": "    function approveAndCall(address _spender, uint256 _value, bytes _extraData)", "highlightLines": [129]}, "category": "code", "location": {"file": "forced_ether_reception/coin.sol", "line": 129, "column": 14}, "severity": "medium", "references": [], "description": ""}, {"id": "6939558ea38c", "fix": {"template": null, "available": false}, "title": "ERC20 approve race condition - use increaseAllowance instead", "ruleId": "rules.sol-erc20-double-approve", "snippet": {"code": "        if (approve(_spender, _value)) {", "highlightLines": [133]}, "category": "code", "location": {"file": "forced_ether_reception/coin.sol", "line": 133, "column": 13}, "severity": "info", "references": ["https://github.com/ethereum/EIPs/issues/20#issuecomment-263524729"], "description": ""}, {"id": "d368fec47ec7", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event FrozenFunds(address target, bool frozen);", "highlightLines": [150]}, "category": "code", "location": {"file": "forced_ether_reception/coin.sol", "line": 150, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "83881eb76b4b", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event FrozenFunds(address target, bool frozen);", "highlightLines": [150]}, "category": "code", "location": {"file": "forced_ether_reception/coin.sol", "line": 150, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "d88334047957", "fix": {"template": null, "available": false}, "title": "Self transfer not checked - can cause balance corruption with from == to", "ruleId": "rules.sol-self-transfer-unchecked", "snippet": {"code": "    function _transfer(address _from, address _to, uint _value) internal {", "highlightLines": [159]}, "category": "code", "location": {"file": "forced_ether_reception/coin.sol", "line": 159, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/self-transfer.sol"], "description": ""}, {"id": "0f70d303caa2", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require (_to != 0x0);                               // Prevent transfer to 0x0 address.", "highlightLines": [160]}, "category": "code", "location": {"file": "forced_ether_reception/coin.sol", "line": 160, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "d0f3a3256561", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require (balanceOf[_from] >= _value);               // Check if the sender has enough", "highlightLines": [161]}, "category": "code", "location": {"file": "forced_ether_reception/coin.sol", "line": 161, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "673837a74367", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require (balanceOf[_to] + _value >= balanceOf[_to]); // Check for overflows", "highlightLines": [162]}, "category": "code", "location": {"file": "forced_ether_reception/coin.sol", "line": 162, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "b6c949154f87", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(!frozenAccount[_from]);                     // Check if sender is frozen", "highlightLines": [163]}, "category": "code", "location": {"file": "forced_ether_reception/coin.sol", "line": 163, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "cd49c94ddf97", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(!frozenAccount[_to]);                       // Check if recipient is frozen", "highlightLines": [164]}, "category": "code", "location": {"file": "forced_ether_reception/coin.sol", "line": 164, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "b560547221d0", "fix": {"template": null, "available": false}, "title": "Token swap/buy without slippage protection - MEV/sandwich attack risk", "ruleId": "rules.sol-missing-slippage-protection", "snippet": {"code": "    function buy() payable public {", "highlightLines": [171]}, "category": "code", "location": {"file": "forced_ether_reception/coin.sol", "line": 171, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "3ccdbd7ebc1a", "fix": {"template": null, "available": false}, "title": "SWC-114: Transaction order dependence - vulnerable to front-running/sandwich attacks", "ruleId": "rules.sol-swc-114-front-running", "snippet": {"code": "    function buy() payable public {\n        uint amount = msg.value;                          // calculates the amount", "highlightLines": [171]}, "category": "code", "location": {"file": "forced_ether_reception/coin.sol", "line": 171, "column": 5}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-114"], "description": ""}, {"id": "982d0742e0bc", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint amount = msg.value;                          // calculates the amount", "highlightLines": [172]}, "category": "code", "location": {"file": "forced_ether_reception/coin.sol", "line": 172, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f6d72aa0ff6b", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function migrate_and_destroy() onlyOwner {\n\tassert(this.balance == totalSupply);                 // consistency check                                    \n\tsuicide(owner);                                      // transfer the ether to the owner and kill the contract\n    }", "highlightLines": [179]}, "category": "code", "location": {"file": "forced_ether_reception/coin.sol", "line": 179, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "c31b83d04ce9", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function migrate_and_destroy() onlyOwner {", "highlightLines": [179]}, "category": "code", "location": {"file": "forced_ether_reception/coin.sol", "line": 179, "column": 36}, "severity": "info", "references": [], "description": ""}, {"id": "d9048d4b14df", "fix": {"template": null, "available": false}, "title": "Strict equality on balance - can be manipulated via selfdestruct or direct transfer", "ruleId": "rules.sol-dangerous-strict-equality", "snippet": {"code": "\tassert(this.balance == totalSupply);                 // consistency check", "highlightLines": [180]}, "category": "code", "location": {"file": "forced_ether_reception/coin.sol", "line": 180, "column": 9}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dangerous-strict-equalities"], "description": ""}, {"id": "113b0f43608e", "fix": {"template": null, "available": false}, "title": "suicide() is deprecated - use selfdestruct() instead", "ruleId": "rules.sol-deprecated-suicide", "snippet": {"code": "\tsuicide(owner);                                      // transfer the ether to the owner and kill the contract", "highlightLines": [181]}, "category": "code", "location": {"file": "forced_ether_reception/coin.sol", "line": 181, "column": 2}, "severity": "info", "references": [], "description": ""}, {"id": "52099d8f9d78", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [1]}, "category": "code", "location": {"file": "honeypots/GiftBox/GiftBox.sol", "line": 1, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "40816deaabf2", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [1]}, "category": "code", "location": {"file": "honeypots/GiftBox/GiftBox.sol", "line": 1, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "06468a2bfdd3", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    string message;", "highlightLines": [5]}, "category": "code", "location": {"file": "honeypots/GiftBox/GiftBox.sol", "line": 5, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b29ae6bcebbb", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    \n    bool passHasBeenSet = false;", "highlightLines": [6]}, "category": "code", "location": {"file": "honeypots/GiftBox/GiftBox.sol", "line": 6, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d1dc31791b91", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    \n    address sender;", "highlightLines": [8]}, "category": "code", "location": {"file": "honeypots/GiftBox/GiftBox.sol", "line": 8, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f32189667c57", "fix": {"template": null, "available": false}, "title": "sha3() is deprecated - use keccak256() instead", "ruleId": "rules.sol-deprecated-sha3", "snippet": {"code": "    function GetHash(bytes pass) public constant returns (bytes32) {return sha3(pass);}", "highlightLines": [15]}, "category": "code", "location": {"file": "honeypots/GiftBox/GiftBox.sol", "line": 15, "column": 76}, "severity": "info", "references": [], "description": ""}, {"id": "e7bcfba4771c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            hashPass = hash;\n            sender = msg.sender;", "highlightLines": [23]}, "category": "code", "location": {"file": "honeypots/GiftBox/GiftBox.sol", "line": 23, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "742ef3daac73", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "            msg.sender.transfer(this.balance);", "highlightLines": [44]}, "category": "code", "location": {"file": "honeypots/GiftBox/GiftBox.sol", "line": 44, "column": 13}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "613409b4297b", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "            msg.sender.transfer(this.balance);", "highlightLines": [44]}, "category": "code", "location": {"file": "honeypots/GiftBox/GiftBox.sol", "line": 44, "column": 23}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "6d3e216bb5b7", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "            sender.transfer(this.balance);", "highlightLines": [55]}, "category": "code", "location": {"file": "honeypots/GiftBox/GiftBox.sol", "line": 55, "column": 13}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "df4b5041c009", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "            sender.transfer(this.balance);", "highlightLines": [55]}, "category": "code", "location": {"file": "honeypots/GiftBox/GiftBox.sol", "line": 55, "column": 19}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "059a87312b7b", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function PassHasBeenSet(bytes32 hash)\n    public\n    {\n        if(msg.sender==sender&&hash==hashPass)", "highlightLines": [60]}, "category": "code", "location": {"file": "honeypots/GiftBox/GiftBox.sol", "line": 60, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "a68f166009d8", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [1]}, "category": "code", "location": {"file": "honeypots/KOTH/KOTH.sol", "line": 1, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "50544f6a9ddb", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [1]}, "category": "code", "location": {"file": "honeypots/KOTH/KOTH.sol", "line": 1, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "948ea23f6aa8", "fix": {"template": null, "available": false}, "title": "SWC-118: Function name matches contract name - likely intended as constructor (pre-0.4.22)", "ruleId": "rules.sol-swc-118-constructor-mismatch", "snippet": {"code": "contract Ownable {\n    address public owner;\n    function Ownable() public {owner = msg.sender;}", "highlightLines": [5]}, "category": "code", "location": {"file": "honeypots/KOTH/KOTH.sol", "line": 5, "column": 1}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-118"], "description": ""}, {"id": "d58e7a49566c", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "    function Ownable() public {owner = msg.sender;}", "highlightLines": [7]}, "category": "code", "location": {"file": "honeypots/KOTH/KOTH.sol", "line": 7, "column": 32}, "severity": "info", "references": [], "description": ""}, {"id": "95a461872452", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyOwner() {require(msg.sender == owner); _;\n    }", "highlightLines": [8]}, "category": "code", "location": {"file": "honeypots/KOTH/KOTH.sol", "line": 8, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "130b004c9684", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "    modifier onlyOwner() {require(msg.sender == owner); _;\n    }", "highlightLines": [8]}, "category": "code", "location": {"file": "honeypots/KOTH/KOTH.sol", "line": 8, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "3ff72654b153", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    modifier onlyOwner() {require(msg.sender == owner); _;", "highlightLines": [8]}, "category": "code", "location": {"file": "honeypots/KOTH/KOTH.sol", "line": 8, "column": 27}, "severity": "info", "references": [], "description": ""}, {"id": "5b5f0f9c0743", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    modifier onlyOwner() {require(msg.sender == owner); _;", "highlightLines": [8]}, "category": "code", "location": {"file": "honeypots/KOTH/KOTH.sol", "line": 8, "column": 27}, "severity": "info", "references": [], "description": ""}, {"id": "04e936cf3394", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract CEOThrone is Ownable {\n    address public owner;\n    uint public largestStake;", "highlightLines": [14]}, "category": "code", "location": {"file": "honeypots/KOTH/KOTH.sol", "line": 14, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "cc0ad56e4458", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "            owner = msg.sender;", "highlightLines": [22]}, "category": "code", "location": {"file": "honeypots/KOTH/KOTH.sol", "line": 22, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "10a5eef81c04", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            owner = msg.sender;\n            largestStake = msg.value;", "highlightLines": [22]}, "category": "code", "location": {"file": "honeypots/KOTH/KOTH.sol", "line": 22, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "69399ddb0831", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function withdraw() public onlyOwner {", "highlightLines": [27]}, "category": "code", "location": {"file": "honeypots/KOTH/KOTH.sol", "line": 27, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "79bbc4db57f5", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function withdraw() public onlyOwner {", "highlightLines": [27]}, "category": "code", "location": {"file": "honeypots/KOTH/KOTH.sol", "line": 27, "column": 32}, "severity": "info", "references": [], "description": ""}, {"id": "03a1c65d471f", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        msg.sender.transfer(this.balance);", "highlightLines": [29]}, "category": "code", "location": {"file": "honeypots/KOTH/KOTH.sol", "line": 29, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "cd2f7f1fe1fb", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "        msg.sender.transfer(this.balance);", "highlightLines": [29]}, "category": "code", "location": {"file": "honeypots/KOTH/KOTH.sol", "line": 29, "column": 19}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "4e7294a1e38a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint component1;", "highlightLines": [20]}, "category": "code", "location": {"file": "honeypots/Lottery/Lottery.sol", "line": 20, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "1fc1c1ac4fae", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint component2;", "highlightLines": [21]}, "category": "code", "location": {"file": "honeypots/Lottery/Lottery.sol", "line": 21, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "66c6893fde5b", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint component3;", "highlightLines": [22]}, "category": "code", "location": {"file": "honeypots/Lottery/Lottery.sol", "line": 22, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d98b542fe0c3", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint component4;", "highlightLines": [23]}, "category": "code", "location": {"file": "honeypots/Lottery/Lottery.sol", "line": 23, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "fd60c88b4dbc", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    \n    address owner; //address of the owner", "highlightLines": [25]}, "category": "code", "location": {"file": "honeypots/Lottery/Lottery.sol", "line": 25, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "81e16f97eff4", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "    address owner; //address of the owner", "highlightLines": [26]}, "category": "code", "location": {"file": "honeypots/Lottery/Lottery.sol", "line": 26, "column": 5}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "4e1f3e2003d8", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint LuckyNumber = 7; //if the number of an address equals 7, it wins", "highlightLines": [29]}, "category": "code", "location": {"file": "honeypots/Lottery/Lottery.sol", "line": 29, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "500fd6f83c83", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function OpenAddressLottery() {\n        owner = msg.sender;\n        reseed(SeedComponents((uint)(block.coinbase), block.difficulty, block.gaslimit, block.timestamp)); //generate a quality random seed\n    }", "highlightLines": [33]}, "category": "code", "location": {"file": "honeypots/Lottery/Lottery.sol", "line": 33, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "4b0e269368e0", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        owner = msg.sender;", "highlightLines": [34]}, "category": "code", "location": {"file": "honeypots/Lottery/Lottery.sol", "line": 34, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "5417323d97b8", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        reseed(SeedComponents((uint)(block.coinbase), block.difficulty, block.gaslimit, block.timestamp)); //generate a quality random seed", "highlightLines": [35]}, "category": "code", "location": {"file": "honeypots/Lottery/Lottery.sol", "line": 35, "column": 55}, "severity": "medium", "references": [], "description": ""}, {"id": "0a1b44052b3f", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function participate() payable {\n        if(msg.value<0.1 ether)\n            return; //verify ticket price\n        \n        // make sure he hasn't won already\n        require(winner[msg.sender] == false);\n        \n        if(luckyNumberOfAddress(msg.sender) == LuckyNumber){ //check if it equals 7\n            winner[msg.sender] = true; // every address can only win once\n            \n            uint win=msg.value*7; //win = 7 times the ticket price\n            \n            if(win>this.balance) //if the balance isnt sufficient...\n                win=this.balance; //...send everything we've got\n            msg.sender.transfer(win);\n        }\n        \n        if(block.number-lastReseed>1000) //reseed if needed\n            reseed(SeedComponents((uint)(block.coinbase), block.difficulty, block.gaslimit, block.timestamp)); //generate a quality random seed\n    }", "highlightLines": [38]}, "category": "code", "location": {"file": "honeypots/Lottery/Lottery.sol", "line": 38, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "d9dd167a7f49", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(winner[msg.sender] == false);", "highlightLines": [43]}, "category": "code", "location": {"file": "honeypots/Lottery/Lottery.sol", "line": 43, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "5c2babffd0a4", "fix": {"template": null, "available": false}, "title": "Unnecessary comparison to boolean constant - use variable directly", "ruleId": "rules.sol-boolean-constant-comparison", "snippet": {"code": "        require(winner[msg.sender] == false);", "highlightLines": [43]}, "category": "code", "location": {"file": "honeypots/Lottery/Lottery.sol", "line": 43, "column": 36}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#boolean-equality"], "description": ""}, {"id": "7559eb71957f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            winner[msg.sender] = true; // every address can only win once\n            \n            uint win=msg.value*7; //win = 7 times the ticket price", "highlightLines": [46]}, "category": "code", "location": {"file": "honeypots/Lottery/Lottery.sol", "line": 46, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "d62a5e5a8358", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            \n            uint win=msg.value*7; //win = 7 times the ticket price", "highlightLines": [47]}, "category": "code", "location": {"file": "honeypots/Lottery/Lottery.sol", "line": 47, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0ac9084ce675", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            uint win=msg.value*7; //win = 7 times the ticket price\n            \n            if(win>this.balance) //if the balance isnt sufficient...\n                win=this.balance; //...send everything we've got", "highlightLines": [48]}, "category": "code", "location": {"file": "honeypots/Lottery/Lottery.sol", "line": 48, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "4c5ee57b6f2e", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "            msg.sender.transfer(win);", "highlightLines": [52]}, "category": "code", "location": {"file": "honeypots/Lottery/Lottery.sol", "line": 52, "column": 13}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "eaf66ee9772a", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "            reseed(SeedComponents((uint)(block.coinbase), block.difficulty, block.gaslimit, block.timestamp)); //generate a quality random seed", "highlightLines": [56]}, "category": "code", "location": {"file": "honeypots/Lottery/Lottery.sol", "line": 56, "column": 59}, "severity": "medium", "references": [], "description": ""}, {"id": "436918737ee1", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function luckyNumberOfAddress(address addr) constant returns(uint n){\n        // calculate the number of current address - 1 in 8 chance\n        n = uint(keccak256(uint(addr), secretSeed)[0]) % 8;\n    }", "highlightLines": [59]}, "category": "code", "location": {"file": "honeypots/Lottery/Lottery.sol", "line": 59, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "839830241c37", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "        n = uint(keccak256(uint(addr), secretSeed)[0]) % 8;", "highlightLines": [61]}, "category": "code", "location": {"file": "honeypots/Lottery/Lottery.sol", "line": 61, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "14dee823760d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        secretSeed = uint256(keccak256(\n            components.component1,\n            components.component2,\n            components.component3,\n            components.component4\n        )); //hash the incoming parameters and use the hash to (re)initialize the seed\n        lastReseed = block.number;", "highlightLines": [65]}, "category": "code", "location": {"file": "honeypots/Lottery/Lottery.sol", "line": 65, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "0e2773f0a5be", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function kill() {\n        require(msg.sender==owner);\n        \n        selfdestruct(msg.sender);\n    }", "highlightLines": [74]}, "category": "code", "location": {"file": "honeypots/Lottery/Lottery.sol", "line": 74, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "5d7fbaee7b5d", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "        require(msg.sender==owner);", "highlightLines": [75]}, "category": "code", "location": {"file": "honeypots/Lottery/Lottery.sol", "line": 75, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "f14c9535fa0a", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender==owner);", "highlightLines": [75]}, "category": "code", "location": {"file": "honeypots/Lottery/Lottery.sol", "line": 75, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "7529b94cf0e1", "fix": {"template": null, "available": false}, "title": "Selfdestruct with user-controlled recipient - funds can be sent anywhere", "ruleId": "rules.sol-selfdestruct-arbitrary", "snippet": {"code": "        selfdestruct(msg.sender);", "highlightLines": [77]}, "category": "code", "location": {"file": "honeypots/Lottery/Lottery.sol", "line": 77, "column": 9}, "severity": "high", "references": [], "description": ""}, {"id": "603093a843ca", "fix": {"template": null, "available": false}, "title": "selfdestruct can force ETH to any address - contracts cannot prevent receiving ETH this way (Force pattern)", "ruleId": "rules.sol-selfdestruct-force-eth", "snippet": {"code": "        selfdestruct(msg.sender);", "highlightLines": [77]}, "category": "code", "location": {"file": "honeypots/Lottery/Lottery.sol", "line": 77, "column": 9}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/7"], "description": ""}, {"id": "f88b82e08786", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function forceReseed() { //reseed initiated by the owner - for testing purposes\n        require(msg.sender==owner);\n        \n        SeedComponents s;\n        s.component1 = uint(msg.sender);\n        s.component2 = uint256(block.blockhash(block.number - 1));\n        s.component3 = block.difficulty*(uint)(block.coinbase);\n        s.component4 = tx.gasprice * 7;\n        \n        reseed(s); //reseed\n    }", "highlightLines": [80]}, "category": "code", "location": {"file": "honeypots/Lottery/Lottery.sol", "line": 80, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "55f0e8f85ee7", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "        require(msg.sender==owner);", "highlightLines": [81]}, "category": "code", "location": {"file": "honeypots/Lottery/Lottery.sol", "line": 81, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "0777c4d965d6", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender==owner);", "highlightLines": [81]}, "category": "code", "location": {"file": "honeypots/Lottery/Lottery.sol", "line": 81, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "5b1736d0d077", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        s.component1 = uint(msg.sender);\n        s.component2 = uint256(block.blockhash(block.number - 1));", "highlightLines": [84]}, "category": "code", "location": {"file": "honeypots/Lottery/Lottery.sol", "line": 84, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "8194453ed3b0", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "        s.component1 = uint(msg.sender);", "highlightLines": [84]}, "category": "code", "location": {"file": "honeypots/Lottery/Lottery.sol", "line": 84, "column": 24}, "severity": "info", "references": [], "description": ""}, {"id": "cb84a6429b82", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        s.component2 = uint256(block.blockhash(block.number - 1));\n        s.component3 = block.difficulty*(uint)(block.coinbase);", "highlightLines": [85]}, "category": "code", "location": {"file": "honeypots/Lottery/Lottery.sol", "line": 85, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "5be9c61ede31", "fix": {"template": null, "available": false}, "title": "blockhash only works for last 256 blocks - older blocks return 0 (PredictTheBlockHash pattern)", "ruleId": "rules.sol-blockhash-256-limit", "snippet": {"code": "        s.component2 = uint256(block.blockhash(block.number - 1));", "highlightLines": [85]}, "category": "code", "location": {"file": "honeypots/Lottery/Lottery.sol", "line": 85, "column": 32}, "severity": "medium", "references": ["https://capturetheether.com/challenges/lottery/predict-block-hash/"], "description": ""}, {"id": "d6909f684b0c", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - predictable by miners, 0 after 256 blocks", "ruleId": "rules.sol-blockhash-randomness", "snippet": {"code": "        s.component2 = uint256(block.blockhash(block.number - 1));", "highlightLines": [85]}, "category": "code", "location": {"file": "honeypots/Lottery/Lottery.sol", "line": 85, "column": 38}, "severity": "high", "references": [], "description": ""}, {"id": "a7bd33b51b46", "fix": {"template": null, "available": false}, "title": "blockhash(block.number - 1) used for randomness - miners can manipulate", "ruleId": "rules.sol-blockhash-previous-block", "snippet": {"code": "        s.component2 = uint256(block.blockhash(block.number - 1));", "highlightLines": [85]}, "category": "code", "location": {"file": "honeypots/Lottery/Lottery.sol", "line": 85, "column": 38}, "severity": "medium", "references": [], "description": ""}, {"id": "c778dc4a415d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        s.component3 = block.difficulty*(uint)(block.coinbase);\n        s.component4 = tx.gasprice * 7;", "highlightLines": [86]}, "category": "code", "location": {"file": "honeypots/Lottery/Lottery.sol", "line": 86, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "1c0e738e26f5", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        s.component3 = block.difficulty*(uint)(block.coinbase);", "highlightLines": [86]}, "category": "code", "location": {"file": "honeypots/Lottery/Lottery.sol", "line": 86, "column": 24}, "severity": "medium", "references": [], "description": ""}, {"id": "7f4ef1b9efd1", "fix": {"template": null, "available": false}, "title": "tx.gasprice can be manipulated by miners - avoid using for financial calculations", "ruleId": "rules.sol-tx-gasprice-manipulation", "snippet": {"code": "        s.component4 = tx.gasprice * 7;", "highlightLines": [87]}, "category": "code", "location": {"file": "honeypots/Lottery/Lottery.sol", "line": 87, "column": 24}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/gas-price.sol"], "description": ""}, {"id": "8adc63474484", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function () payable { //if someone sends money without any function call, just assume he wanted to participate\n        if(msg.value>=0.1 ether && msg.sender!=owner) //owner can't participate, he can only fund the jackpot\n            participate();\n    }", "highlightLines": [92]}, "category": "code", "location": {"file": "honeypots/Lottery/Lottery.sol", "line": 92, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "f51c19136509", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.18;", "highlightLines": [1]}, "category": "code", "location": {"file": "honeypots/Multiplicator/Multiplicator.sol", "line": 1, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "39dab2a2d7be", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.18;", "highlightLines": [1]}, "category": "code", "location": {"file": "honeypots/Multiplicator/Multiplicator.sol", "line": 1, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "6ea81cf27d5f", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function()payable{}", "highlightLines": [7]}, "category": "code", "location": {"file": "honeypots/Multiplicator/Multiplicator.sol", "line": 7, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "6f611bd99bb8", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function withdraw()\n    payable\n    public\n    {", "highlightLines": [9]}, "category": "code", "location": {"file": "honeypots/Multiplicator/Multiplicator.sol", "line": 9, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "2494849c03f8", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender == Owner);", "highlightLines": [13]}, "category": "code", "location": {"file": "honeypots/Multiplicator/Multiplicator.sol", "line": 13, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "46d44c253dc9", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        Owner.transfer(this.balance);", "highlightLines": [14]}, "category": "code", "location": {"file": "honeypots/Multiplicator/Multiplicator.sol", "line": 14, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "67a65bcb5ea9", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "        Owner.transfer(this.balance);", "highlightLines": [14]}, "category": "code", "location": {"file": "honeypots/Multiplicator/Multiplicator.sol", "line": 14, "column": 14}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "6b99877ece0e", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function multiplicate(address adr)\n    payable\n    {\n        if(msg.value>=this.balance)\n        {        \n            adr.transfer(this.balance+msg.value);\n        }\n    }", "highlightLines": [17]}, "category": "code", "location": {"file": "honeypots/Multiplicator/Multiplicator.sol", "line": 17, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "9acd024433d3", "fix": {"template": null, "available": false}, "title": "Logic error: this.balance already includes msg.value - condition may always fail (Honeypot pattern)", "ruleId": "rules.sol-balance-includes-msgvalue", "snippet": {"code": "        if(msg.value>=this.balance)", "highlightLines": [20]}, "category": "code", "location": {"file": "honeypots/Multiplicator/Multiplicator.sol", "line": 20, "column": 9}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/honeypots"], "description": ""}, {"id": "0104a41a22b1", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "            adr.transfer(this.balance+msg.value);", "highlightLines": [22]}, "category": "code", "location": {"file": "honeypots/Multiplicator/Multiplicator.sol", "line": 22, "column": 13}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "d73e8a87aaa5", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "            adr.transfer(this.balance+msg.value);", "highlightLines": [22]}, "category": "code", "location": {"file": "honeypots/Multiplicator/Multiplicator.sol", "line": 22, "column": 16}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "0644fd674a6f", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [1]}, "category": "code", "location": {"file": "honeypots/PrivateBank/PrivateBank.sol", "line": 1, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "93d42912a69d", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [1]}, "category": "code", "location": {"file": "honeypots/PrivateBank/PrivateBank.sol", "line": 1, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "c8d291ccc891", "fix": {"template": null, "available": false}, "title": "SWC-118: Function name matches contract name - likely intended as constructor (pre-0.4.22)", "ruleId": "rules.sol-swc-118-constructor-mismatch", "snippet": {"code": "contract Private_Bank\n{\n    mapping (address => uint) public balances;\n    \n    uint public MinDeposit = 1 ether;\n    \n    Log TransferLog;\n    \n    function Private_Bank(address _log)", "highlightLines": [3]}, "category": "code", "location": {"file": "honeypots/PrivateBank/PrivateBank.sol", "line": 3, "column": 1}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-118"], "description": ""}, {"id": "549d35f2cf30", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function Private_Bank(address _log)\n    {\n        TransferLog = Log(_log);\n    }", "highlightLines": [11]}, "category": "code", "location": {"file": "honeypots/PrivateBank/PrivateBank.sol", "line": 11, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "d52586bf507e", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function CashOut(uint _am)\n    {\n        if(_am<=balances[msg.sender])\n        {\n            \n            if(msg.sender.call.value(_am)())\n            {\n                balances[msg.sender]-=_am;\n                TransferLog.AddMessage(msg.sender,_am,\"CashOut\");\n            }\n        }\n    }", "highlightLines": [27]}, "category": "code", "location": {"file": "honeypots/PrivateBank/PrivateBank.sol", "line": 27, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "774ed87e8a0e", "fix": {"template": null, "available": false}, "title": "Function pointer stored in state variable - potential hijack target", "ruleId": "rules.sol-function-pointer-state", "snippet": {"code": "    function() public payable{}    \n    \n}\n\ncontract Log \n{\n   \n    struct Message\n    {\n        address Sender;", "highlightLines": [40]}, "category": "code", "location": {"file": "honeypots/PrivateBank/PrivateBank.sol", "line": 40, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "072db7cde0c5", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address Sender;", "highlightLines": [49]}, "category": "code", "location": {"file": "honeypots/PrivateBank/PrivateBank.sol", "line": 49, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "152f8ba7cfdd", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        string  Data;", "highlightLines": [50]}, "category": "code", "location": {"file": "honeypots/PrivateBank/PrivateBank.sol", "line": 50, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f99f5d7e3412", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint Val;", "highlightLines": [51]}, "category": "code", "location": {"file": "honeypots/PrivateBank/PrivateBank.sol", "line": 51, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ccbf32d29a90", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint  Time;", "highlightLines": [52]}, "category": "code", "location": {"file": "honeypots/PrivateBank/PrivateBank.sol", "line": 52, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "023558f0ab1d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Sender = _adr;\n        LastMsg.Time = now;", "highlightLines": [62]}, "category": "code", "location": {"file": "honeypots/PrivateBank/PrivateBank.sol", "line": 62, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d4cef9c8ed15", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Time = now;\n        LastMsg.Val = _val;", "highlightLines": [63]}, "category": "code", "location": {"file": "honeypots/PrivateBank/PrivateBank.sol", "line": 63, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "0e696151758f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Val = _val;\n        LastMsg.Data = _data;", "highlightLines": [64]}, "category": "code", "location": {"file": "honeypots/PrivateBank/PrivateBank.sol", "line": 64, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "2acecf92c28e", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.18;", "highlightLines": [1]}, "category": "code", "location": {"file": "honeypots/VarLoop/VarLoop.sol", "line": 1, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "e2019caa7ab3", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.18;", "highlightLines": [1]}, "category": "code", "location": {"file": "honeypots/VarLoop/VarLoop.sol", "line": 1, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "401f6e702e3f", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address owner = msg.sender;", "highlightLines": [5]}, "category": "code", "location": {"file": "honeypots/VarLoop/VarLoop.sol", "line": 5, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "5417a45c17c1", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "    address owner = msg.sender;", "highlightLines": [5]}, "category": "code", "location": {"file": "honeypots/VarLoop/VarLoop.sol", "line": 5, "column": 5}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "b7289a828933", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "    address owner = msg.sender;", "highlightLines": [5]}, "category": "code", "location": {"file": "honeypots/VarLoop/VarLoop.sol", "line": 5, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "26c36e54ed5c", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function withdraw()\n    payable\n    public\n    {", "highlightLines": [7]}, "category": "code", "location": {"file": "honeypots/VarLoop/VarLoop.sol", "line": 7, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "b7335881c6bf", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "        require(msg.sender==owner);", "highlightLines": [11]}, "category": "code", "location": {"file": "honeypots/VarLoop/VarLoop.sol", "line": 11, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "b2c8136652de", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender==owner);", "highlightLines": [11]}, "category": "code", "location": {"file": "honeypots/VarLoop/VarLoop.sol", "line": 11, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "3a508ae13e5a", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        owner.transfer(this.balance);", "highlightLines": [12]}, "category": "code", "location": {"file": "honeypots/VarLoop/VarLoop.sol", "line": 12, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "c918b9e18375", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "        owner.transfer(this.balance);", "highlightLines": [12]}, "category": "code", "location": {"file": "honeypots/VarLoop/VarLoop.sol", "line": 12, "column": 14}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "3014d3d27c73", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function() payable {}", "highlightLines": [15]}, "category": "code", "location": {"file": "honeypots/VarLoop/VarLoop.sol", "line": 15, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "41923391de54", "fix": {"template": null, "available": false}, "title": "Deprecated 'var' keyword can cause type confusion - resolves to smallest type (e.g., uint8 in loops)", "ruleId": "rules.sol-deprecated-var-keyword", "snippet": {"code": "            var i1 = 1;", "highlightLines": [24]}, "category": "code", "location": {"file": "honeypots/VarLoop/VarLoop.sol", "line": 24, "column": 13}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/honeypots"], "description": ""}, {"id": "5abc919d8c4e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            var i1 = 1;\n            var i2 = 0;", "highlightLines": [24]}, "category": "code", "location": {"file": "honeypots/VarLoop/VarLoop.sol", "line": 24, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "2b94cf607501", "fix": {"template": null, "available": false}, "title": "Deprecated 'var' keyword can cause type confusion - resolves to smallest type (e.g., uint8 in loops)", "ruleId": "rules.sol-deprecated-var-keyword", "snippet": {"code": "            var i2 = 0;", "highlightLines": [25]}, "category": "code", "location": {"file": "honeypots/VarLoop/VarLoop.sol", "line": 25, "column": 13}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/honeypots"], "description": ""}, {"id": "d73adf7c46d8", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            var i2 = 0;\n            var amX2 = msg.value*2;", "highlightLines": [25]}, "category": "code", "location": {"file": "honeypots/VarLoop/VarLoop.sol", "line": 25, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "02dc4278c144", "fix": {"template": null, "available": false}, "title": "Deprecated 'var' keyword can cause type confusion - resolves to smallest type (e.g., uint8 in loops)", "ruleId": "rules.sol-deprecated-var-keyword", "snippet": {"code": "            var amX2 = msg.value*2;", "highlightLines": [26]}, "category": "code", "location": {"file": "honeypots/VarLoop/VarLoop.sol", "line": 26, "column": 13}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/honeypots"], "description": ""}, {"id": "9e992918dc53", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            var amX2 = msg.value*2;\n            \n            while(true)\n            {\n                if(i1<i2)break;\n                if(i1>amX2)break;\n                \n                i2=i1;\n                i1++;\n            }", "highlightLines": [26]}, "category": "code", "location": {"file": "honeypots/VarLoop/VarLoop.sol", "line": 26, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "cf189901d58e", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "            msg.sender.transfer(i2);", "highlightLines": [36]}, "category": "code", "location": {"file": "honeypots/VarLoop/VarLoop.sol", "line": 36, "column": 13}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "aa80e87ad473", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.15;", "highlightLines": [2]}, "category": "code", "location": {"file": "incorrect_interface/Alice.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "3505e041a583", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.15;", "highlightLines": [2]}, "category": "code", "location": {"file": "incorrect_interface/Alice.sol", "line": 2, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "7b29cfa4ec5f", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function set(int new_val){\n        val = new_val;\n    }", "highlightLines": [7]}, "category": "code", "location": {"file": "incorrect_interface/Alice.sol", "line": 7, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "3ac9786f162a", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function set_fixed(int new_val){\n        val = new_val;\n    }", "highlightLines": [11]}, "category": "code", "location": {"file": "incorrect_interface/Alice.sol", "line": 11, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "9ce4aa6108f1", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function(){\n        val = 1;\n    }", "highlightLines": [15]}, "category": "code", "location": {"file": "incorrect_interface/Alice.sol", "line": 15, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "5f9cdd30959c", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.15;", "highlightLines": [2]}, "category": "code", "location": {"file": "incorrect_interface/Bob.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "afb5d0a6519b", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.15;", "highlightLines": [2]}, "category": "code", "location": {"file": "incorrect_interface/Bob.sol", "line": 2, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "d10b7a924ae5", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function set(Alice c){ \n        c.set(42); \n    }", "highlightLines": [10]}, "category": "code", "location": {"file": "incorrect_interface/Bob.sol", "line": 10, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "2a96e3d21454", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function set_fixed(Alice c){ \n        c.set_fixed(42); \n    }", "highlightLines": [14]}, "category": "code", "location": {"file": "incorrect_interface/Bob.sol", "line": 14, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "a99cc1b4a4f0", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.15;", "highlightLines": [1]}, "category": "code", "location": {"file": "integer_overflow/integer_overflow_1.sol", "line": 1, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "a432f6f1331c", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.15;", "highlightLines": [1]}, "category": "code", "location": {"file": "integer_overflow/integer_overflow_1.sol", "line": 1, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "c2e8ca4272eb", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function add(uint value) returns (bool){\n        sellerBalance += value; // possible overflow\n\n        // possible auditor assert\n        // assert(sellerBalance >= value); \n    }", "highlightLines": [6]}, "category": "code", "location": {"file": "integer_overflow/integer_overflow_1.sol", "line": 6, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "905dd3abb579", "fix": {"template": null, "available": false}, "title": "SWC-110: assert() used for input validation - use require() instead, assert is for invariants", "ruleId": "rules.sol-swc-110-assert-user-input", "snippet": {"code": "        // assert(sellerBalance >= value);", "highlightLines": [10]}, "category": "code", "location": {"file": "integer_overflow/integer_overflow_1.sol", "line": 10, "column": 12}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-110"], "description": ""}, {"id": "5c51c9a8b517", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "    function safe_add(uint value) returns (bool){\n        require(value + sellerBalance >= sellerBalance);", "highlightLines": [13]}, "category": "code", "location": {"file": "integer_overflow/integer_overflow_1.sol", "line": 13, "column": 5}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "94068a9a09a8", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function safe_add(uint value) returns (bool){\n        require(value + sellerBalance >= sellerBalance);\n        sellerBalance += value; \n    }", "highlightLines": [13]}, "category": "code", "location": {"file": "integer_overflow/integer_overflow_1.sol", "line": 13, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "88816dcfde1e", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(value + sellerBalance >= sellerBalance);", "highlightLines": [14]}, "category": "code", "location": {"file": "integer_overflow/integer_overflow_1.sol", "line": 14, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "414a77891319", "fix": {"template": null, "available": false}, "title": "Tautological overflow check (a + b >= a) is always true - provides no protection (TokenBank pattern)", "ruleId": "rules.sol-tautological-overflow-check", "snippet": {"code": "        require(value + sellerBalance >= sellerBalance);", "highlightLines": [14]}, "category": "code", "location": {"file": "integer_overflow/integer_overflow_1.sol", "line": 14, "column": 9}, "severity": "high", "references": ["https://capturetheether.com/challenges/miscellaneous/token-bank/"], "description": ""}, {"id": "0ba578f67657", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.16;", "highlightLines": [1]}, "category": "code", "location": {"file": "race_condition/RaceCondition.sol", "line": 1, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "c7309c37539c", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.16;", "highlightLines": [1]}, "category": "code", "location": {"file": "race_condition/RaceCondition.sol", "line": 1, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "833b0453d185", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function balanceOf(address _owner) constant returns (uint balance);", "highlightLines": [6]}, "category": "code", "location": {"file": "race_condition/RaceCondition.sol", "line": 6, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "da94489cf5e1", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function transfer(address _to, uint _value) returns (bool success);", "highlightLines": [7]}, "category": "code", "location": {"file": "race_condition/RaceCondition.sol", "line": 7, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "ab4dead91efe", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without msg.data.length validation - vulnerable to short address attack padding", "ruleId": "rules.sol-short-address-no-payload-check", "snippet": {"code": "    function transfer(address _to, uint _value) returns (bool success);\n    function transferFrom(address _from, address _to, uint _value) returns (bool success);\n    function approve(address _spender, uint _value) returns (bool success);\n    function allowance(address _owner, address _spender) constant returns (uint remaining);\n    event Transfer(address indexed _from, address indexed _to, uint _value);\n    event Approval(address indexed _owner, address indexed _spender, uint _value);\n}\n\ncontract RaceCondition{", "highlightLines": [7]}, "category": "code", "location": {"file": "race_condition/RaceCondition.sol", "line": 7, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address", "https://vessenes.com/the-erc20-short-address-attack-explained/"], "description": ""}, {"id": "af52d6817bc1", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function transferFrom(address _from, address _to, uint _value) returns (bool success);", "highlightLines": [8]}, "category": "code", "location": {"file": "race_condition/RaceCondition.sol", "line": 8, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "ab22a72d3eea", "fix": {"template": null, "available": false}, "title": "ERC20 transferFrom without payload size validation - consider adding onlyPayloadSize modifier", "ruleId": "rules.sol-erc20-missing-payload-modifier", "snippet": {"code": "    function transferFrom(address _from, address _to, uint _value) returns (bool success);\n    function approve(address _spender, uint _value) returns (bool success);\n    function allowance(address _owner, address _spender) constant returns (uint remaining);\n    event Transfer(address indexed _from, address indexed _to, uint _value);\n    event Approval(address indexed _owner, address indexed _spender, uint _value);\n}\n\ncontract RaceCondition{", "highlightLines": [8]}, "category": "code", "location": {"file": "race_condition/RaceCondition.sol", "line": 8, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address"], "description": ""}, {"id": "84db28bc3e3f", "fix": {"template": null, "available": false}, "title": "NFT transfer without approval/ownership check - add _isApprovedOrOwner validation", "ruleId": "rules.sol-nft-transfer-no-approval-check", "snippet": {"code": "    function transferFrom(address _from, address _to, uint _value) returns (bool success);\n    function approve(address _spender, uint _value) returns (bool success);\n    function allowance(address _owner, address _spender) constant returns (uint remaining);\n    event Transfer(address indexed _from, address indexed _to, uint _value);\n    event Approval(address indexed _owner, address indexed _spender, uint _value);\n}\n\ncontract RaceCondition{", "highlightLines": [8]}, "category": "code", "location": {"file": "race_condition/RaceCondition.sol", "line": 8, "column": 5}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/NFT-transfer.sol"], "description": ""}, {"id": "1642411c8bd3", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function approve(address _spender, uint _value) returns (bool success);", "highlightLines": [9]}, "category": "code", "location": {"file": "race_condition/RaceCondition.sol", "line": 9, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "cdfd920fcc0e", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function allowance(address _owner, address _spender) constant returns (uint remaining);", "highlightLines": [10]}, "category": "code", "location": {"file": "race_condition/RaceCondition.sol", "line": 10, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "ff0e7d47463d", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Transfer(address indexed _from, address indexed _to, uint _value);", "highlightLines": [11]}, "category": "code", "location": {"file": "race_condition/RaceCondition.sol", "line": 11, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "694564b775ca", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Approval(address indexed _owner, address indexed _spender, uint _value);", "highlightLines": [12]}, "category": "code", "location": {"file": "race_condition/RaceCondition.sol", "line": 12, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "e06e1c836843", "fix": {"template": null, "available": false}, "title": "SWC-118: Function name matches contract name - likely intended as constructor (pre-0.4.22)", "ruleId": "rules.sol-swc-118-constructor-mismatch", "snippet": {"code": "contract RaceCondition{\n    address private owner;\n    uint public price;\n    ERC20 token;\n\n    function RaceCondition(uint _price, ERC20 _token)", "highlightLines": [15]}, "category": "code", "location": {"file": "race_condition/RaceCondition.sol", "line": 15, "column": 1}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-118"], "description": ""}, {"id": "31665b119654", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        owner = msg.sender;", "highlightLines": [23]}, "category": "code", "location": {"file": "race_condition/RaceCondition.sol", "line": 23, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "a6ec00afab42", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        owner = msg.sender;\n        price = _price;", "highlightLines": [23]}, "category": "code", "location": {"file": "race_condition/RaceCondition.sol", "line": 23, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "bf1bb24981a6", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        price = _price;\n        token = _token;", "highlightLines": [24]}, "category": "code", "location": {"file": "race_condition/RaceCondition.sol", "line": 24, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "9f5f5dc1c590", "fix": {"template": null, "available": false}, "title": "Token swap/buy without slippage protection - MEV/sandwich attack risk", "ruleId": "rules.sol-missing-slippage-protection", "snippet": {"code": "    function buy(uint new_price) payable\n        public\n    {", "highlightLines": [32]}, "category": "code", "location": {"file": "race_condition/RaceCondition.sol", "line": 32, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "c60a53a744c8", "fix": {"template": null, "available": false}, "title": "SWC-114: Transaction order dependence - vulnerable to front-running/sandwich attacks", "ruleId": "rules.sol-swc-114-front-running", "snippet": {"code": "    function buy(uint new_price) payable\n        public\n    {\n        require(msg.value >= price);", "highlightLines": [32]}, "category": "code", "location": {"file": "race_condition/RaceCondition.sol", "line": 32, "column": 5}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-114"], "description": ""}, {"id": "c06f88fe6f24", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.value >= price);", "highlightLines": [35]}, "category": "code", "location": {"file": "race_condition/RaceCondition.sol", "line": 35, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "efd0217acca0", "fix": {"template": null, "available": false}, "title": "Token transfer without checking actual received amount - deflationary tokens may transfer less", "ruleId": "rules.sol-deflationary-token-transfer", "snippet": {"code": "        token.transferFrom(msg.sender, owner, price);", "highlightLines": [39]}, "category": "code", "location": {"file": "race_condition/RaceCondition.sol", "line": 39, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "abb06bc5e99f", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        token.transferFrom(msg.sender, owner, price);", "highlightLines": [39]}, "category": "code", "location": {"file": "race_condition/RaceCondition.sol", "line": 39, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "ab1d408064e4", "fix": {"template": null, "available": false}, "title": "Token amount after transfer may differ - check actual received amount", "ruleId": "rules.sol-fee-on-transfer-token", "snippet": {"code": "        token.transferFrom(msg.sender, owner, price);", "highlightLines": [39]}, "category": "code", "location": {"file": "race_condition/RaceCondition.sol", "line": 39, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "5c5961c16191", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        price = new_price;\n        owner = msg.sender;", "highlightLines": [41]}, "category": "code", "location": {"file": "race_condition/RaceCondition.sol", "line": 41, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "638946b7e3da", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        owner = msg.sender;", "highlightLines": [42]}, "category": "code", "location": {"file": "race_condition/RaceCondition.sol", "line": 42, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "23591fa16ac4", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function changePrice(uint new_price){\n        require(msg.sender == owner);\n        price = new_price; \n    }", "highlightLines": [45]}, "category": "code", "location": {"file": "race_condition/RaceCondition.sol", "line": 45, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "b7df4e3112cc", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "        require(msg.sender == owner);", "highlightLines": [46]}, "category": "code", "location": {"file": "race_condition/RaceCondition.sol", "line": 46, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "63e32bd5d75d", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender == owner);", "highlightLines": [46]}, "category": "code", "location": {"file": "race_condition/RaceCondition.sol", "line": 46, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "84fecc4790e7", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function balanceOf(address _owner) constant returns (uint256 balance);", "highlightLines": [47]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 47, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "27f18ad3300a", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function transfer(address _to, uint256 _amount) returns (bool success);", "highlightLines": [53]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 53, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "a72f7af56c1f", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without msg.data.length validation - vulnerable to short address attack padding", "ruleId": "rules.sol-short-address-no-payload-check", "snippet": {"code": "    function transfer(address _to, uint256 _amount) returns (bool success);\n\n    /// @notice Send `_amount` tokens to `_to` from `_from` on the condition it\n    /// is approved by `_from`\n    /// @param _from The address of the origin of the transfer\n    /// @param _to The address of the recipient\n    /// @param _amount The amount of tokens to be transferred\n    /// @return Whether the transfer was successful or not\n    function transferFrom(address _from, address _to, uint256 _amount) returns (bool success);\n\n    /// @notice `msg.sender` approves `_spender` to spend `_amount` tokens on\n    /// its behalf\n    /// @param _spender The address of the account able to transfer the tokens\n    /// @param _amount The amount of tokens to be approved for transfer\n    /// @return Whether the approval was successful or not\n    function approve(address _spender, uint256 _amount) returns (bool success);\n\n    /// @param _owner The address of the account owning tokens\n    /// @param _spender The address of the account able to transfer the tokens\n    /// @return Amount of remaining tokens of _owner that _spender is allowed\n    /// to spend\n    function allowance(\n        address _owner,\n        address _spender\n    ) constant returns (uint256 remaining);\n\n    event Transfer(address indexed _from, address indexed _to, uint256 _amount);\n    event Approval(\n        address indexed _owner,\n        address indexed _spender,\n        uint256 _amount\n    );\n}\n\n\ncontract Token is TokenInterface {", "highlightLines": [53]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 53, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address", "https://vessenes.com/the-erc20-short-address-attack-explained/"], "description": ""}, {"id": "b020558ae438", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function transferFrom(address _from, address _to, uint256 _amount) returns (bool success);", "highlightLines": [61]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 61, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "7491070839cc", "fix": {"template": null, "available": false}, "title": "ERC20 transferFrom without payload size validation - consider adding onlyPayloadSize modifier", "ruleId": "rules.sol-erc20-missing-payload-modifier", "snippet": {"code": "    function transferFrom(address _from, address _to, uint256 _amount) returns (bool success);\n\n    /// @notice `msg.sender` approves `_spender` to spend `_amount` tokens on\n    /// its behalf\n    /// @param _spender The address of the account able to transfer the tokens\n    /// @param _amount The amount of tokens to be approved for transfer\n    /// @return Whether the approval was successful or not\n    function approve(address _spender, uint256 _amount) returns (bool success);\n\n    /// @param _owner The address of the account owning tokens\n    /// @param _spender The address of the account able to transfer the tokens\n    /// @return Amount of remaining tokens of _owner that _spender is allowed\n    /// to spend\n    function allowance(\n        address _owner,\n        address _spender\n    ) constant returns (uint256 remaining);\n\n    event Transfer(address indexed _from, address indexed _to, uint256 _amount);\n    event Approval(\n        address indexed _owner,\n        address indexed _spender,\n        uint256 _amount\n    );\n}\n\n\ncontract Token is TokenInterface {", "highlightLines": [61]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 61, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address"], "description": ""}, {"id": "d36388e61a8d", "fix": {"template": null, "available": false}, "title": "NFT transfer without approval/ownership check - add _isApprovedOrOwner validation", "ruleId": "rules.sol-nft-transfer-no-approval-check", "snippet": {"code": "    function transferFrom(address _from, address _to, uint256 _amount) returns (bool success);\n\n    /// @notice `msg.sender` approves `_spender` to spend `_amount` tokens on\n    /// its behalf\n    /// @param _spender The address of the account able to transfer the tokens\n    /// @param _amount The amount of tokens to be approved for transfer\n    /// @return Whether the approval was successful or not\n    function approve(address _spender, uint256 _amount) returns (bool success);\n\n    /// @param _owner The address of the account owning tokens\n    /// @param _spender The address of the account able to transfer the tokens\n    /// @return Amount of remaining tokens of _owner that _spender is allowed\n    /// to spend\n    function allowance(\n        address _owner,\n        address _spender\n    ) constant returns (uint256 remaining);\n\n    event Transfer(address indexed _from, address indexed _to, uint256 _amount);\n    event Approval(\n        address indexed _owner,\n        address indexed _spender,\n        uint256 _amount\n    );\n}\n\n\ncontract Token is TokenInterface {", "highlightLines": [61]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 61, "column": 5}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/NFT-transfer.sol"], "description": ""}, {"id": "88fe4cf828da", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function approve(address _spender, uint256 _amount) returns (bool success);", "highlightLines": [68]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 68, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "62a2d60be338", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "    /// @return Amount of remaining tokens of _owner that _spender is allowed\n    /// to spend\n    function allowance(\n        address _owner,\n        address _spender\n    ) constant returns (uint256 remaining);\n\n    event Transfer(address indexed _from, address indexed _to, uint256 _amount);", "highlightLines": [72]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 72, "column": 10}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "870edba0225d", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function allowance(\n        address _owner,\n        address _spender\n    ) constant returns (uint256 remaining);", "highlightLines": [74]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 74, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "90ee131821fd", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Transfer(address indexed _from, address indexed _to, uint256 _amount);", "highlightLines": [79]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 79, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "63852e18297e", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event Approval(\n        address indexed _owner,\n        address indexed _spender,\n        uint256 _amount\n    );", "highlightLines": [80]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 80, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "883c52e136f6", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Approval(\n        address indexed _owner,\n        address indexed _spender,\n        uint256 _amount\n    );", "highlightLines": [80]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 80, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "4cfb59321b66", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier noEther() {if (msg.value > 0) throw; _}", "highlightLines": [91]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 91, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "bd54e8f0f3f2", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "    modifier noEther() {if (msg.value > 0) throw; _}", "highlightLines": [91]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 91, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "e4317fb38a5c", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function balanceOf(address _owner) constant returns (uint256 balance) {\n        return balances[_owner];\n    }", "highlightLines": [93]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 93, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "09ec628508f1", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without msg.data.length validation - vulnerable to short address attack padding", "ruleId": "rules.sol-short-address-no-payload-check", "snippet": {"code": "    function transfer(address _to, uint256 _amount) noEther returns (bool success) {", "highlightLines": [97]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 97, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address", "https://vessenes.com/the-erc20-short-address-attack-explained/"], "description": ""}, {"id": "4e4d16cd423b", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function transfer(address _to, uint256 _amount) noEther returns (bool success) {\n        if (balances[msg.sender] >= _amount && _amount > 0) {\n            balances[msg.sender] -= _amount;\n            balances[_to] += _amount;\n            Transfer(msg.sender, _to, _amount);\n            return true;\n        } else {\n           return false;\n        }\n    }", "highlightLines": [97]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 97, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "eac41ba7ed66", "fix": {"template": null, "available": false}, "title": "ERC20 transferFrom without payload size validation - consider adding onlyPayloadSize modifier", "ruleId": "rules.sol-erc20-missing-payload-modifier", "snippet": {"code": "    function transferFrom(\n        address _from,\n        address _to,\n        uint256 _amount\n    ) noEther returns (bool success) {", "highlightLines": [108]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 108, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address"], "description": ""}, {"id": "cbf149da025a", "fix": {"template": null, "available": false}, "title": "NFT transfer without approval/ownership check - add _isApprovedOrOwner validation", "ruleId": "rules.sol-nft-transfer-no-approval-check", "snippet": {"code": "    function transferFrom(\n        address _from,\n        address _to,\n        uint256 _amount\n    ) noEther returns (bool success) {", "highlightLines": [108]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 108, "column": 5}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/NFT-transfer.sol"], "description": ""}, {"id": "567d5eb2999d", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function transferFrom(\n        address _from,\n        address _to,\n        uint256 _amount\n    ) noEther returns (bool success) {\n\n        if (balances[_from] >= _amount\n            && allowed[_from][msg.sender] >= _amount\n            && _amount > 0) {\n\n            balances[_to] += _amount;\n            balances[_from] -= _amount;\n            allowed[_from][msg.sender] -= _amount;\n            Transfer(_from, _to, _amount);\n            return true;\n        } else {\n            return false;\n        }\n    }", "highlightLines": [108]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 108, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "6767768f4697", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function approve(address _spender, uint256 _amount) returns (bool success) {\n        allowed[msg.sender][_spender] = _amount;\n        Approval(msg.sender, _spender, _amount);\n        return true;\n    }", "highlightLines": [128]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 128, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "897dd6ff21a5", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function allowance(address _owner, address _spender) constant returns (uint256 remaining) {\n        return allowed[_owner][_spender];\n    }", "highlightLines": [134]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 134, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "cf4b26861c0c", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "    /// @return True if the send completed\n    function payOut(address _recipient, uint _amount) returns (bool);\n\n    event PayOut(address indexed _recipient, uint _amount);", "highlightLines": [174]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 174, "column": 10}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "57cb8685f715", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function payOut(address _recipient, uint _amount) returns (bool);", "highlightLines": [175]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 175, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "c29d1c5934fc", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event PayOut(address indexed _recipient, uint _amount);", "highlightLines": [177]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 177, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "4f37c0c88e9b", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function ManagedAccount(address _owner, bool _payOwnerOnly) {\n        owner = _owner;\n        payOwnerOnly = _payOwnerOnly;\n    }", "highlightLines": [184]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 184, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "06cd18d1888f", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        owner = _owner;", "highlightLines": [185]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 185, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "bbde194ce66a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        owner = _owner;\n        payOwnerOnly = _payOwnerOnly;", "highlightLines": [185]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 185, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "f4aa2beb828a", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function() {\n        accumulatedInput += msg.value;\n    }", "highlightLines": [192]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 192, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "1ef2fdd65298", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function payOut(address _recipient, uint _amount) returns (bool) {\n        if (msg.sender != owner || msg.value > 0 || (payOwnerOnly && _recipient != owner))\n            throw;\n        if (_recipient.call.value(_amount)()) {\n            PayOut(_recipient, _amount);\n            return true;\n        } else {\n            return false;\n        }\n    }", "highlightLines": [196]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 196, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "acef9ee62513", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "            throw;", "highlightLines": [198]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 198, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "d4a6ab287cf0", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "            throw;\n        if (_recipient.call.value(_amount)()) {", "highlightLines": [198]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 198, "column": 13}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "084fb60ec9de", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function createTokenProxy(address _tokenHolder) returns (bool success);", "highlightLines": [269]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 269, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "66040f97aea9", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "    /// @return The divisor used to calculate the token creation rate during\n    /// the creation phase\n    function divisor() constant returns (uint divisor);\n\n    event FuelingToDate(uint value);", "highlightLines": [275]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 275, "column": 10}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "65b14b8794b4", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event FuelingToDate(uint value);", "highlightLines": [279]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 279, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "0456e8f8629a", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event CreatedToken(address indexed to, uint amount);", "highlightLines": [280]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 280, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "ffd71e8a13e9", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Refund(address indexed to, uint value);", "highlightLines": [281]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 281, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "6f1f68e67cfd", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function TokenCreation(\n        uint _minTokensToCreate,\n        uint _closingTime,\n        address _privateCreation) {\n\n        closingTime = _closingTime;\n        minTokensToCreate = _minTokensToCreate;\n        privateCreation = _privateCreation;\n        extraBalance = new ManagedAccount(address(this), true);\n    }", "highlightLines": [286]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 286, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "ab802999e22d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        closingTime = _closingTime;\n        minTokensToCreate = _minTokensToCreate;", "highlightLines": [291]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 291, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "922cf59adbd6", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        minTokensToCreate = _minTokensToCreate;\n        privateCreation = _privateCreation;", "highlightLines": [292]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 292, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d736a5424e88", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        privateCreation = _privateCreation;\n        extraBalance = new ManagedAccount(address(this), true);", "highlightLines": [293]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 293, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "89f3b7a4d9bc", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        extraBalance = new ManagedAccount(address(this), true);", "highlightLines": [294]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 294, "column": 24}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "4c6930073d74", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function createTokenProxy(address _tokenHolder) returns (bool success) {\n        if (now < closingTime && msg.value > 0\n            && (privateCreation == 0 || privateCreation == msg.sender)) {\n\n            uint token = (msg.value * 20) / divisor();\n            extraBalance.call.value(msg.value - token)();\n            balances[_tokenHolder] += token;\n            totalSupply += token;\n            weiGiven[_tokenHolder] += msg.value;\n            CreatedToken(_tokenHolder, token);\n            if (totalSupply >= minTokensToCreate && !isFueled) {\n                isFueled = true;\n                FuelingToDate(totalSupply);\n            }\n            return true;\n        }\n        throw;\n    }", "highlightLines": [297]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 297, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "0b7f4b415b47", "fix": {"template": null, "available": false}, "title": "Block timestamp used for critical logic - miners can manipulate within ~15 second window", "ruleId": "rules.sol-block-timestamp-manipulation", "snippet": {"code": "        if (now < closingTime && msg.value > 0", "highlightLines": [298]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 298, "column": 13}, "severity": "medium", "references": ["https://consensys.github.io/smart-contract-best-practices/development-recommendations/solidity-specific/timestamp-dependence/"], "description": ""}, {"id": "1268abaa7fea", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n            uint token = (msg.value * 20) / divisor();", "highlightLines": [300]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 300, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e48fc9d0af24", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            uint token = (msg.value * 20) / divisor();\n            extraBalance.call.value(msg.value - token)();\n            balances[_tokenHolder] += token;\n            totalSupply += token;\n            weiGiven[_tokenHolder] += msg.value;\n            CreatedToken(_tokenHolder, token);\n            if (totalSupply >= minTokensToCreate && !isFueled) {\n                isFueled = true;\n                FuelingToDate(totalSupply);\n            }", "highlightLines": [301]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 301, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "e36a78663bf1", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        throw;", "highlightLines": [313]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 313, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "6a01be983a44", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function refund() noEther {\n        if (now > closingTime && !isFueled) {\n            // Get extraBalance - will only succeed when called for the first time\n            if (extraBalance.balance >= extraBalance.accumulatedInput())\n                extraBalance.payOut(address(this), extraBalance.accumulatedInput());\n\n            // Execute refund\n            if (msg.sender.call.value(weiGiven[msg.sender])()) {\n                Refund(msg.sender, weiGiven[msg.sender]);\n                totalSupply -= balances[msg.sender];\n                balances[msg.sender] = 0;\n                weiGiven[msg.sender] = 0;\n            }\n        }\n    }", "highlightLines": [316]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 316, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "0c4be7ed19a6", "fix": {"template": null, "available": false}, "title": "Block timestamp used for critical logic - miners can manipulate within ~15 second window", "ruleId": "rules.sol-block-timestamp-manipulation", "snippet": {"code": "        if (now > closingTime && !isFueled) {", "highlightLines": [317]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 317, "column": 13}, "severity": "medium", "references": ["https://consensys.github.io/smart-contract-best-practices/development-recommendations/solidity-specific/timestamp-dependence/"], "description": ""}, {"id": "61ba6125a6dc", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "                balances[msg.sender] = 0;\n                weiGiven[msg.sender] = 0;", "highlightLines": [326]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 326, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "f051fbb08ec7", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function divisor() constant returns (uint divisor) {\n        // The number of (base unit) tokens per wei is calculated\n        // as `msg.value` * 20 / `divisor`\n        // The fueling period starts with a 1:1 ratio\n        if (closingTime - 2 weeks > now) {\n            return 20;\n        // Followed by 10 days with a daily creation rate increase of 5%\n        } else if (closingTime - 4 days > now) {\n            return (20 + (now - (closingTime - 2 weeks)) / (1 days));\n        // The last 4 days there is a constant creation rate ratio of 1:1.5\n        } else {\n            return 30;\n        }\n    }", "highlightLines": [332]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 332, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "4351789c03f3", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint sumOfProposalDeposits;", "highlightLines": [434]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 434, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "75d3a292785a", "fix": {"template": null, "available": false}, "title": "Unnecessary comparison to boolean constant - use variable directly", "ruleId": "rules.sol-boolean-constant-comparison", "snippet": {"code": "    // A proposal with `newCurator == false` represents a transaction", "highlightLines": [440]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 440, "column": 36}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#boolean-equality"], "description": ""}, {"id": "371939298535", "fix": {"template": null, "available": false}, "title": "Unnecessary comparison to boolean constant - use variable directly", "ruleId": "rules.sol-boolean-constant-comparison", "snippet": {"code": "    // A proposal with `newCurator == true` represents a DAO split", "highlightLines": [442]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 442, "column": 36}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#boolean-equality"], "description": ""}, {"id": "d3a7f0973693", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address recipient;", "highlightLines": [447]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 447, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "db401b400bd3", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint amount;", "highlightLines": [449]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 449, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0989848b6e44", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        string description;", "highlightLines": [451]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 451, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ca2fd78f319f", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint votingDeadline;", "highlightLines": [453]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 453, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "dcd1fe550ba0", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool open;", "highlightLines": [455]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 455, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "afc92d15e949", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool proposalPassed;", "highlightLines": [458]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 458, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "57739717487c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 proposalHash;", "highlightLines": [460]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 460, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "1aad3d47058b", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint proposalDeposit;", "highlightLines": [463]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 463, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7c9778229d0e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool newCurator;", "highlightLines": [465]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 465, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "28cfa5210dac", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint yea;", "highlightLines": [469]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 469, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "becf40c486e5", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint nay;", "highlightLines": [471]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 471, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d4543b880cd8", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address creator;", "highlightLines": [477]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 477, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "64f83990e007", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint splitBalance;", "highlightLines": [483]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 483, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "63dc65c2601e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint totalSupply;", "highlightLines": [485]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 485, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8c3ca64b7905", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "        uint totalSupply;", "highlightLines": [485]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 485, "column": 9}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "4149f8248853", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint rewardToken;", "highlightLines": [487]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 487, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "676406de59e0", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyTokenholders {}", "highlightLines": [493]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 493, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "a485146e35c7", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function newProposal(\n        address _recipient,\n        uint _amount,\n        string _description,\n        bytes _transactionData,\n        uint _debatingPeriod,\n        bool _newCurator\n    ) onlyTokenholders returns (uint _proposalID);", "highlightLines": [540]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 540, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "a256b2ed248c", "fix": {"template": null, "available": false}, "title": "Handler returns bool but never returns false - caller can't detect failures", "ruleId": "rules.sol-handler-return-bool-no-false", "snippet": {"code": "    function executeProposal(\n        uint _proposalID,\n        bytes _transactionData\n    ) returns (bool _success);\n\n    /// @notice ATTENTION! I confirm to move my remaining ether to a new DAO\n    /// with `_newCurator` as the new Curator, as has been\n    /// proposed in proposal `_proposalID`. This will burn my tokens. This can\n    /// not be undone and will split the DAO into two DAO's, with two\n    /// different underlying tokens.\n    /// @param _proposalID The proposal ID\n    /// @param _newCurator The new Curator of the new DAO\n    /// @dev This function, when called for the first time for this proposal,\n    /// will create a new DAO and send the sender's portion of the remaining\n    /// ether and Reward Tokens to the new DAO. It will also burn the DAO Tokens\n    /// of the sender.\n    function splitDAO(\n        uint _proposalID,\n        address _newCurator\n    ) returns (bool _success);\n\n    /// @dev can only be called by the DAO itself through a proposal\n    /// updates the contract of the DAO by sending all ether and rewardTokens\n    /// to the new DAO. The new DAO needs to be approved by the Curator\n    /// @param _newContract the address of the new contract\n    function newContract(address _newContract);\n\n\n    /// @notice Add a new possible recipient `_recipient` to the whitelist so\n    /// that the DAO can send transactions to them (using proposals)\n    /// @param _recipient New recipient address\n    /// @dev Can only be called by the current Curator\n    /// @return Whether successful or not\n    function changeAllowedRecipients(address _recipient, bool _allowed) external returns (bool _success);\n\n\n    /// @notice Change the minimum deposit required to submit a proposal\n    /// @param _proposalDeposit The new proposal deposit\n    /// @dev Can only be called by this DAO (through proposals with the\n    /// recipient being this DAO itself)\n    function changeProposalDeposit(uint _proposalDeposit) external;\n\n    /// @notice Move rewards from the DAORewards managed account\n    /// @param _toMembers If true rewards are moved to the actual reward account\n    ///                   for the DAO. If not then it's moved to the DAO itself\n    /// @return Whether the call was successful\n    function retrieveDAOReward(bool _toMembers) external returns (bool _success);\n\n    /// @notice Get my portion of the reward that was sent to `rewardAccount`\n    /// @return Whether the call was successful\n    function getMyReward() returns(bool _success);\n\n    /// @notice Withdraw `_account`'s portion of the reward from `rewardAccount`\n    /// to `_account`'s balance\n    /// @return Whether the call was successful\n    function withdrawRewardFor(address _account) internal returns (bool _success);\n\n    /// @notice Send `_amount` tokens to `_to` from `msg.sender`. Prior to this\n    /// getMyReward() is called.\n    /// @param _to The address of the recipient\n    /// @param _amount The amount of tokens to be transfered\n    /// @return Whether the transfer was successful or not\n    function transferWithoutReward(address _to, uint256 _amount) returns (bool success);\n\n    /// @notice Send `_amount` tokens to `_to` from `_from` on the condition it\n    /// is approved by `_from`. Prior to this getMyReward() is called.\n    /// @param _from The address of the sender\n    /// @param _to The address of the recipient\n    /// @param _amount The amount of tokens to be transfered\n    /// @return Whether the transfer was successful or not\n    function transferFromWithoutReward(\n        address _from,\n        address _to,\n        uint256 _amount\n    ) returns (bool success);\n\n    /// @notice Doubles the 'minQuorumDivisor' in the case quorum has not been\n    /// achieved in 52 weeks\n    /// @return Whether the change was successful or not\n    function halveMinQuorum() returns (bool _success);\n\n    /// @return total number of proposals ever created\n    function numberOfProposals() constant returns (uint _numberOfProposals);\n\n    /// @param _proposalID Id of the new curator proposal\n    /// @return Address of the new DAO\n    function getNewDAOAddress(uint _proposalID) constant returns (address _newDAO);\n\n    /// @param _account The address of the account which is checked.\n    /// @return Whether the account is blocked (not allowed to transfer tokens) or not.\n    function isBlocked(address _account) internal returns (bool);\n\n    /// @notice If the caller is blocked by a proposal whose voting deadline\n    /// has exprired then unblock him.\n    /// @return Whether the account is blocked (not allowed to transfer tokens) or not.\n    function unblockMe() returns (bool);\n\n    event ProposalAdded(\n        uint indexed proposalID,\n        address recipient,\n        uint amount,\n        bool newCurator,\n        string description\n    );\n    event Voted(uint indexed proposalID, bool position, address indexed voter);\n    event ProposalTallied(uint indexed proposalID, bool result, uint quorum);\n    event NewCurator(address indexed _newCurator);\n    event AllowedRecipientChanged(address indexed _recipient, bool _allowed);\n}\n\n// The DAO contract itself\ncontract DAO is DAOInterface, Token, TokenCreation {", "highlightLines": [579]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 579, "column": 5}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "ed4a00bc4537", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function newContract(address _newContract);", "highlightLines": [604]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 604, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "36dbd0efd2eb", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function changeAllowedRecipients(address _recipient, bool _allowed) external returns (bool _success);", "highlightLines": [612]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 612, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "be7124549644", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function withdrawRewardFor(address _account) internal returns (bool _success);", "highlightLines": [634]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 634, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "d402803e6f14", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function transferWithoutReward(address _to, uint256 _amount) returns (bool success);", "highlightLines": [641]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 641, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "ac5b45c9c4c9", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function transferFromWithoutReward(\n        address _from,\n        address _to,\n        uint256 _amount\n    ) returns (bool success);", "highlightLines": [649]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 649, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "78053bb350c4", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function isBlocked(address _account) internal returns (bool);", "highlightLines": [669]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 669, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "964825af4a7a", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "    /// @return Whether the account is blocked (not allowed to transfer tokens) or not.\n    function unblockMe() returns (bool);\n\n    event ProposalAdded(", "highlightLines": [673]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 673, "column": 10}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "c2e5bef3ec3e", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event ProposalAdded(\n        uint indexed proposalID,\n        address recipient,\n        uint amount,\n        bool newCurator,\n        string description\n    );", "highlightLines": [676]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 676, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "2994ac3d9772", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event NewCurator(address indexed _newCurator);", "highlightLines": [685]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 685, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "91eaa795a795", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event AllowedRecipientChanged(address indexed _recipient, bool _allowed);", "highlightLines": [686]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 686, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "b26b8b2daf5d", "fix": {"template": null, "available": false}, "title": "Base constructor called multiple times through diamond inheritance - may initialize twice", "ruleId": "rules.sol-reused-constructor", "snippet": {"code": "contract DAO is DAOInterface, Token, TokenCreation {", "highlightLines": [690]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 690, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#reused-base-constructor"], "description": ""}, {"id": "03a5e4e3276c", "fix": {"template": null, "available": false}, "title": "SWC-125: Multiple inheritance may cause incorrect function resolution - check C3 linearization", "ruleId": "rules.sol-swc-125-inheritance-order", "snippet": {"code": "contract DAO is DAOInterface, Token, TokenCreation {", "highlightLines": [690]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 690, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-125"], "description": ""}, {"id": "7c959d7a526c", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "contract DAO is DAOInterface, Token, TokenCreation {", "highlightLines": [690]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 690, "column": 31}, "severity": "info", "references": [], "description": ""}, {"id": "46dd031d9d6d", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyTokenholders {\n        if (balanceOf(msg.sender) == 0) throw;\n            _\n    }", "highlightLines": [693]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 693, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "138b5d0e3253", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "        if (balanceOf(msg.sender) == 0) throw;\n            _", "highlightLines": [694]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 694, "column": 41}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "7252b6bb5431", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function DAO(\n        address _curator,\n        DAO_Creator _daoCreator,\n        uint _proposalDeposit,\n        uint _minTokensToCreate,\n        uint _closingTime,\n        address _privateCreation\n    ) TokenCreation(_minTokensToCreate, _closingTime, _privateCreation) {\n\n        curator = _curator;\n        daoCreator = _daoCreator;\n        proposalDeposit = _proposalDeposit;\n        rewardAccount = new ManagedAccount(address(this), false);\n        DAOrewardAccount = new ManagedAccount(address(this), false);\n        if (address(rewardAccount) == 0)\n            throw;\n        if (address(DAOrewardAccount) == 0)\n            throw;\n        lastTimeMinQuorumMet = now;\n        minQuorumDivisor = 5; // sets the minimal quorum to 20%\n        proposals.length = 1; // avoids a proposal with ID 0 because it is used\n\n        allowedRecipients[address(this)] = true;\n        allowedRecipients[curator] = true;\n    }", "highlightLines": [698]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 698, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "df05564aa997", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        curator = _curator;\n        daoCreator = _daoCreator;", "highlightLines": [707]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 707, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "dde3a436a976", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        daoCreator = _daoCreator;\n        proposalDeposit = _proposalDeposit;", "highlightLines": [708]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 708, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "2a918d070057", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        proposalDeposit = _proposalDeposit;\n        rewardAccount = new ManagedAccount(address(this), false);", "highlightLines": [709]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 709, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "0de17912597a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        rewardAccount = new ManagedAccount(address(this), false);\n        DAOrewardAccount = new ManagedAccount(address(this), false);", "highlightLines": [710]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 710, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d1e0386330f3", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        rewardAccount = new ManagedAccount(address(this), false);", "highlightLines": [710]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 710, "column": 25}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "8845e2362365", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        DAOrewardAccount = new ManagedAccount(address(this), false);\n        if (address(rewardAccount) == 0)\n            throw;\n        if (address(DAOrewardAccount) == 0)\n            throw;\n        lastTimeMinQuorumMet = now;", "highlightLines": [711]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 711, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "08bf45d55eb9", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        DAOrewardAccount = new ManagedAccount(address(this), false);", "highlightLines": [711]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 711, "column": 28}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "199b35e7e60a", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "            throw;", "highlightLines": [713]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 713, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "7fb833ca5f3c", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "            throw;\n        if (address(DAOrewardAccount) == 0)", "highlightLines": [713]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 713, "column": 13}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "e512b0be055f", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "            throw;", "highlightLines": [715]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 715, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "f0cf31aff908", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "            throw;\n        lastTimeMinQuorumMet = now;", "highlightLines": [715]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 715, "column": 13}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "a02f425bf621", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        lastTimeMinQuorumMet = now;\n        minQuorumDivisor = 5; // sets the minimal quorum to 20%", "highlightLines": [716]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 716, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d507c623f542", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        minQuorumDivisor = 5; // sets the minimal quorum to 20%\n        proposals.length = 1; // avoids a proposal with ID 0 because it is used", "highlightLines": [717]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 717, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "9932a4f32168", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        proposals.length = 1; // avoids a proposal with ID 0 because it is used\n\n        allowedRecipients[address(this)] = true;", "highlightLines": [718]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 718, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "c763ba2c3db7", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        allowedRecipients[address(this)] = true;\n        allowedRecipients[curator] = true;", "highlightLines": [720]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 720, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d4e2c6c510cb", "fix": {"template": null, "available": false}, "title": "Block timestamp used for critical logic - miners can manipulate within ~15 second window", "ruleId": "rules.sol-block-timestamp-manipulation", "snippet": {"code": "        if (now < closingTime + creationGracePeriod && msg.sender != address(extraBalance))", "highlightLines": [725]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 725, "column": 13}, "severity": "medium", "references": ["https://consensys.github.io/smart-contract-best-practices/development-recommendations/solidity-specific/timestamp-dependence/"], "description": ""}, {"id": "ac35ac3ebdf7", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "            return createTokenProxy(msg.sender);\n        else", "highlightLines": [726]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 726, "column": 13}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "bbdbcf9bb26c", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function receiveEther() returns (bool) {\n        return true;\n    }", "highlightLines": [732]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 732, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "eb3ebbf778ab", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function newProposal(\n        address _recipient,\n        uint _amount,\n        string _description,\n        bytes _transactionData,\n        uint _debatingPeriod,\n        bool _newCurator\n    ) onlyTokenholders returns (uint _proposalID) {\n\n        // Sanity check\n        if (_newCurator && (\n            _amount != 0\n            || _transactionData.length != 0\n            || _recipient == curator", "highlightLines": [737]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 737, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "14963f64668c", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function newProposal(\n        address _recipient,\n        uint _amount,\n        string _description,\n        bytes _transactionData,\n        uint _debatingPeriod,\n        bool _newCurator\n    ) onlyTokenholders returns (uint _proposalID) {\n\n        // Sanity check\n        if (_newCurator && (\n            _amount != 0\n            || _transactionData.length != 0\n            || _recipient == curator\n            || msg.value > 0\n            || _debatingPeriod < minSplitDebatePeriod)) {\n            throw;\n        } else if (\n            !_newCurator\n            && (!isRecipientAllowed(_recipient) || (_debatingPeriod <  minProposalDebatePeriod))\n        ) {\n            throw;\n        }\n\n        if (_debatingPeriod > 8 weeks)\n            throw;\n\n        if (!isFueled\n            || now < closingTime\n            || (msg.value < proposalDeposit && !_newCurator)) {\n\n            throw;\n        }\n\n        if (now + _debatingPeriod < now) // prevents overflow\n            throw;\n\n        // to prevent a 51% attacker to convert the ether into deposit\n        if (msg.sender == address(this))\n            throw;\n\n        _proposalID = proposals.length++;\n        Proposal p = proposals[_proposalID];\n        p.recipient = _recipient;\n        p.amount = _amount;\n        p.description = _description;\n        p.proposalHash = sha3(_recipient, _amount, _transactionData);\n        p.votingDeadline = now + _debatingPeriod;\n        p.open = true;\n        //p.proposalPassed = False; // that's default\n        p.newCurator = _newCurator;\n        if (_newCurator)\n            p.splitData.length++;\n        p.creator = msg.sender;\n        p.proposalDeposit = msg.value;\n\n        sumOfProposalDeposits += msg.value;\n\n        ProposalAdded(\n            _proposalID,\n            _recipient,\n            _amount,\n            _newCurator,\n            _description\n        );\n    }", "highlightLines": [737]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 737, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "c1bff98ba80e", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "            throw;", "highlightLines": [753]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 753, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "07b47f140e81", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "            throw;", "highlightLines": [758]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 758, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "a9fa459855a5", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "            throw;", "highlightLines": [762]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 762, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "05cb5fad1764", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "            throw;\n\n        if (!isFueled", "highlightLines": [762]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 762, "column": 13}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "9ce8c782a5f0", "fix": {"template": null, "available": false}, "title": "Block timestamp used for critical logic - miners can manipulate within ~15 second window", "ruleId": "rules.sol-block-timestamp-manipulation", "snippet": {"code": "            || now < closingTime", "highlightLines": [765]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 765, "column": 16}, "severity": "medium", "references": ["https://consensys.github.io/smart-contract-best-practices/development-recommendations/solidity-specific/timestamp-dependence/"], "description": ""}, {"id": "aa26856fb17a", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "\n            throw;", "highlightLines": [767]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 767, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "f1765331899f", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "            throw;", "highlightLines": [772]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 772, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "636e51ffcd16", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "            throw;", "highlightLines": [776]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 776, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "488564933895", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "            throw;\n\n        _proposalID = proposals.length++;", "highlightLines": [776]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 776, "column": 13}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "4cb9a2556d9a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        _proposalID = proposals.length++;\n        Proposal p = proposals[_proposalID];", "highlightLines": [778]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 778, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "99faf74f69d6", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        Proposal p = proposals[_proposalID];\n        p.recipient = _recipient;", "highlightLines": [779]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 779, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "1c321740404c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        p.recipient = _recipient;\n        p.amount = _amount;", "highlightLines": [780]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 780, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d18e5689ec9d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        p.amount = _amount;\n        p.description = _description;", "highlightLines": [781]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 781, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "f568b2a324bc", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        p.description = _description;\n        p.proposalHash = sha3(_recipient, _amount, _transactionData);", "highlightLines": [782]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 782, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "3c2f683bebcd", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        p.proposalHash = sha3(_recipient, _amount, _transactionData);\n        p.votingDeadline = now + _debatingPeriod;", "highlightLines": [783]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 783, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "c934eec32d78", "fix": {"template": null, "available": false}, "title": "sha3() is deprecated - use keccak256() instead", "ruleId": "rules.sol-deprecated-sha3", "snippet": {"code": "        p.proposalHash = sha3(_recipient, _amount, _transactionData);", "highlightLines": [783]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 783, "column": 26}, "severity": "info", "references": [], "description": ""}, {"id": "45aca43a2fc5", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        p.votingDeadline = now + _debatingPeriod;\n        p.open = true;", "highlightLines": [784]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 784, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "10848c5a55c1", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        p.open = true;\n        //p.proposalPassed = False; // that's default\n        p.newCurator = _newCurator;", "highlightLines": [785]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 785, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "3bb97667c6cc", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        p.newCurator = _newCurator;\n        if (_newCurator)\n            p.splitData.length++;\n        p.creator = msg.sender;", "highlightLines": [787]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 787, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "881c42b86eb5", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        p.creator = msg.sender;\n        p.proposalDeposit = msg.value;", "highlightLines": [790]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 790, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "84d8e8ad0398", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function checkProposalCode(\n        uint _proposalID,\n        address _recipient,\n        uint _amount,\n        bytes _transactionData\n    ) noEther constant returns (bool _codeChecksOut) {\n        Proposal p = proposals[_proposalID];\n        return p.proposalHash == sha3(_recipient, _amount, _transactionData);\n    }", "highlightLines": [805]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 805, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "328f11314574", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function vote(\n        uint _proposalID,\n        bool _supportsProposal\n    ) onlyTokenholders noEther returns (uint _voteID) {\n\n        Proposal p = proposals[_proposalID];\n        if (p.votedYes[msg.sender]\n            || p.votedNo[msg.sender]\n            || now >= p.votingDeadline) {\n\n            throw;\n        }\n\n        if (_supportsProposal) {\n            p.yea += balances[msg.sender];\n            p.votedYes[msg.sender] = true;\n        } else {\n            p.nay += balances[msg.sender];\n            p.votedNo[msg.sender] = true;\n        }\n\n        if (blocked[msg.sender] == 0) {\n            blocked[msg.sender] = _proposalID;\n        } else if (p.votingDeadline > proposals[blocked[msg.sender]].votingDeadline) {\n            // this proposal's voting deadline is further into the future than\n            // the proposal that blocks the sender so make it the blocker\n            blocked[msg.sender] = _proposalID;\n        }\n\n        Voted(_proposalID, _supportsProposal, msg.sender);\n    }", "highlightLines": [816]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 816, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "7ad9a1c61b72", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        Proposal p = proposals[_proposalID];\n        if (p.votedYes[msg.sender]\n            || p.votedNo[msg.sender]\n            || now >= p.votingDeadline) {\n\n            throw;\n        }\n\n        if (_supportsProposal) {\n            p.yea += balances[msg.sender];\n            p.votedYes[msg.sender] = true;\n        } else {\n            p.nay += balances[msg.sender];\n            p.votedNo[msg.sender] = true;\n        }", "highlightLines": [821]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 821, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e77d009ffbbf", "fix": {"template": null, "available": false}, "title": "Block timestamp used for critical logic - miners can manipulate within ~15 second window", "ruleId": "rules.sol-block-timestamp-manipulation", "snippet": {"code": "            || now >= p.votingDeadline) {", "highlightLines": [824]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 824, "column": 16}, "severity": "medium", "references": ["https://consensys.github.io/smart-contract-best-practices/development-recommendations/solidity-specific/timestamp-dependence/"], "description": ""}, {"id": "b600f9860562", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "\n            throw;", "highlightLines": [825]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 825, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "7a6e40fe8de9", "fix": {"template": null, "available": false}, "title": "Handler returns bool but never returns false - caller can't detect failures", "ruleId": "rules.sol-handler-return-bool-no-false", "snippet": {"code": "    function executeProposal(\n        uint _proposalID,\n        bytes _transactionData\n    ) noEther returns (bool _success) {", "highlightLines": [849]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 849, "column": 5}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "1619c6696bfc", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function executeProposal(\n        uint _proposalID,\n        bytes _transactionData\n    ) noEther returns (bool _success) {\n\n        Proposal p = proposals[_proposalID];\n\n        uint waitPeriod = p.newCurator\n            ? splitExecutionPeriod\n            : executeProposalPeriod;\n        // If we are over deadline and waiting period, assert proposal is closed\n        if (p.open && now > p.votingDeadline + waitPeriod) {\n            closeProposal(_proposalID);\n            return;\n        }\n\n        // Check if the proposal can be executed\n        if (now < p.votingDeadline  // has the voting deadline arrived?\n            // Have the votes been counted?\n            || !p.open\n            // Does the transaction code match the proposal?\n            || p.proposalHash != sha3(p.recipient, p.amount, _transactionData)) {\n\n            throw;\n        }\n\n        // If the curator removed the recipient from the whitelist, close the proposal\n        // in order to free the deposit and allow unblocking of voters\n        if (!isRecipientAllowed(p.recipient)) {\n            closeProposal(_proposalID);\n            p.creator.send(p.proposalDeposit);\n            return;\n        }\n\n        bool proposalCheck = true;\n\n        if (p.amount > actualBalance())\n            proposalCheck = false;\n\n        uint quorum = p.yea + p.nay;\n\n        // require 53% for calling newContract()\n        if (_transactionData.length >= 4 && _transactionData[0] == 0x68\n            && _transactionData[1] == 0x37 && _transactionData[2] == 0xff\n            && _transactionData[3] == 0x1e\n            && quorum < minQuorum(actualBalance() + rewardToken[address(this)])) {\n\n                proposalCheck = false;\n        }\n\n        if (quorum >= minQuorum(p.amount)) {\n            if (!p.creator.send(p.proposalDeposit))\n                throw;\n\n            lastTimeMinQuorumMet = now;\n            // set the minQuorum to 20% again, in the case it has been reached\n            if (quorum > totalSupply / 5)\n                minQuorumDivisor = 5;\n        }\n\n        // Execute result\n        if (quorum >= minQuorum(p.amount) && p.yea > p.nay && proposalCheck) {\n            if (!p.recipient.call.value(p.amount)(_transactionData))\n                throw;\n\n            p.proposalPassed = true;\n            _success = true;\n\n            // only create reward tokens when ether is not sent to the DAO itself and\n            // related addresses. Proxy addresses should be forbidden by the curator.\n            if (p.recipient != address(this) && p.recipient != address(rewardAccount)\n                && p.recipient != address(DAOrewardAccount)\n                && p.recipient != address(extraBalance)\n                && p.recipient != address(curator)) {\n\n                rewardToken[address(this)] += p.amount;\n                totalRewardToken += p.amount;\n            }\n        }\n\n        closeProposal(_proposalID);\n\n        // Initiate event\n        ProposalTallied(_proposalID, _success, quorum);\n    }", "highlightLines": [849]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 849, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "ca3323d31d9b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        Proposal p = proposals[_proposalID];\n\n        uint waitPeriod = p.newCurator\n            ? splitExecutionPeriod\n            : executeProposalPeriod;", "highlightLines": [854]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 854, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "9a910b23b50e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint waitPeriod = p.newCurator", "highlightLines": [855]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 855, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c89885181ea3", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint waitPeriod = p.newCurator\n            ? splitExecutionPeriod\n            : executeProposalPeriod;\n        // If we are over deadline and waiting period, assert proposal is closed\n        if (p.open && now > p.votingDeadline + waitPeriod) {\n            closeProposal(_proposalID);\n            return;\n        }\n\n        // Check if the proposal can be executed\n        if (now < p.votingDeadline  // has the voting deadline arrived?\n            // Have the votes been counted?\n            || !p.open\n            // Does the transaction code match the proposal?\n            || p.proposalHash != sha3(p.recipient, p.amount, _transactionData)) {\n\n            throw;\n        }\n\n        // If the curator removed the recipient from the whitelist, close the proposal\n        // in order to free the deposit and allow unblocking of voters\n        if (!isRecipientAllowed(p.recipient)) {\n            closeProposal(_proposalID);\n            p.creator.send(p.proposalDeposit);\n            return;\n        }\n\n        bool proposalCheck = true;", "highlightLines": [856]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 856, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "048c4eef9bfd", "fix": {"template": null, "available": false}, "title": "Block timestamp used for critical logic - miners can manipulate within ~15 second window", "ruleId": "rules.sol-block-timestamp-manipulation", "snippet": {"code": "        if (p.open && now > p.votingDeadline + waitPeriod) {", "highlightLines": [860]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 860, "column": 23}, "severity": "medium", "references": ["https://consensys.github.io/smart-contract-best-practices/development-recommendations/solidity-specific/timestamp-dependence/"], "description": ""}, {"id": "d5923012576d", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "            return;", "highlightLines": [862]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 862, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "b74a6d057c56", "fix": {"template": null, "available": false}, "title": "Block timestamp used for critical logic - miners can manipulate within ~15 second window", "ruleId": "rules.sol-block-timestamp-manipulation", "snippet": {"code": "        if (now < p.votingDeadline  // has the voting deadline arrived?", "highlightLines": [866]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 866, "column": 13}, "severity": "medium", "references": ["https://consensys.github.io/smart-contract-best-practices/development-recommendations/solidity-specific/timestamp-dependence/"], "description": ""}, {"id": "ffcdbc2c7fa4", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "\n            throw;", "highlightLines": [871]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 871, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "0947790ce146", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "            p.creator.send(p.proposalDeposit);", "highlightLines": [879]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 879, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "8a377e5ed96e", "fix": {"template": null, "available": false}, "title": "send() return value not checked - Ether may be stuck if recipient reverts", "ruleId": "rules.sol-unchecked-send-return", "snippet": {"code": "            p.creator.send(p.proposalDeposit);", "highlightLines": [879]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 879, "column": 22}, "severity": "high", "references": [], "description": ""}, {"id": "dc0c02937ab5", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "            return;", "highlightLines": [880]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 880, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "d407ba53e1f1", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        bool proposalCheck = true;", "highlightLines": [882]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 882, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0f10960f68b8", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bool proposalCheck = true;\n\n        if (p.amount > actualBalance())\n            proposalCheck = false;", "highlightLines": [883]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 883, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "2fd8b30a850d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint quorum = p.yea + p.nay;", "highlightLines": [887]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 887, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ec59735dac44", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint quorum = p.yea + p.nay;\n\n        // require 53% for calling newContract()\n        if (_transactionData.length >= 4 && _transactionData[0] == 0x68\n            && _transactionData[1] == 0x37 && _transactionData[2] == 0xff\n            && _transactionData[3] == 0x1e\n            && quorum < minQuorum(actualBalance() + rewardToken[address(this)])) {\n\n                proposalCheck = false;\n        }", "highlightLines": [888]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 888, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "16c7f8c61a40", "fix": {"template": null, "available": false}, "title": "address(this) stored in mapping - contracts often confuse handler address with token address", "ruleId": "rules.sol-address-this-in-mapping-storage", "snippet": {"code": "        if (_transactionData.length >= 4 && _transactionData[0] == 0x68\n            && _transactionData[1] == 0x37 && _transactionData[2] == 0xff\n            && _transactionData[3] == 0x1e\n            && quorum < minQuorum(actualBalance() + rewardToken[address(this)])) {", "highlightLines": [891]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 891, "column": 45}, "severity": "medium", "references": [], "description": ""}, {"id": "3cb515dfdd2d", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "                throw;", "highlightLines": [901]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 901, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "7f47e7fd160b", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "                throw;\n\n            lastTimeMinQuorumMet = now;", "highlightLines": [901]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 901, "column": 17}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "64a7edcce878", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            lastTimeMinQuorumMet = now;\n            // set the minQuorum to 20% again, in the case it has been reached\n            if (quorum > totalSupply / 5)\n                minQuorumDivisor = 5;", "highlightLines": [903]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 903, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "adb748b35259", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "                throw;", "highlightLines": [912]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 912, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "106f08fc7bfa", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "                throw;\n\n            p.proposalPassed = true;", "highlightLines": [912]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 912, "column": 17}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "68e889551ffd", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            p.proposalPassed = true;\n            _success = true;", "highlightLines": [914]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 914, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "d053780a792a", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "        // Initiate event\n        ProposalTallied(_proposalID, _success, quorum);", "highlightLines": [931]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 931, "column": 21}, "severity": "info", "references": [], "description": ""}, {"id": "d4234910876e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        Proposal p = proposals[_proposalID];\n        if (p.open)\n            sumOfProposalDeposits -= p.proposalDeposit;\n        p.open = false;", "highlightLines": [937]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 937, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "95351e81fd9e", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function splitDAO(\n        uint _proposalID,\n        address _newCurator\n    ) noEther onlyTokenholders returns (bool _success) {\n\n        Proposal p = proposals[_proposalID];\n\n        // Sanity check\n\n        if (now < p.votingDeadline  // has the voting deadline arrived?\n            //The request for a split expires XX days after the voting deadline\n            || now > p.votingDeadline + splitExecutionPeriod\n            // Does the new Curator address match?\n            || p.recipient != _newCurator\n            // Is it a new curator proposal?\n            || !p.newCurator\n            // Have you voted for this split?\n            || !p.votedYes[msg.sender]\n            // Did you already vote on another proposal?\n            || (blocked[msg.sender] != _proposalID && blocked[msg.sender] != 0) )  {\n\n            throw;\n        }\n\n        // If the new DAO doesn't exist yet, create the new DAO and store the\n        // current split data\n        if (address(p.splitData[0].newDAO) == 0) {\n            p.splitData[0].newDAO = createNewDAO(_newCurator);\n            // Call depth limit reached, etc.\n            if (address(p.splitData[0].newDAO) == 0)\n                throw;\n            // should never happen\n            if (this.balance < sumOfProposalDeposits)\n                throw;\n            p.splitData[0].splitBalance = actualBalance();\n            p.splitData[0].rewardToken = rewardToken[address(this)];\n            p.splitData[0].totalSupply = totalSupply;\n            p.proposalPassed = true;\n        }\n\n        // Move ether and assign new Tokens\n        uint fundsToBeMoved =\n            (balances[msg.sender] * p.splitData[0].splitBalance) /\n            p.splitData[0].totalSupply;\n        if (p.splitData[0].newDAO.createTokenProxy.value(fundsToBeMoved)(msg.sender) == false)\n            throw;\n\n\n        // Assign reward rights to new DAO\n        uint rewardTokenToBeMoved =\n            (balances[msg.sender] * p.splitData[0].rewardToken) /\n            p.splitData[0].totalSupply;\n\n        uint paidOutToBeMoved = DAOpaidOut[address(this)] * rewardTokenToBeMoved /\n            rewardToken[address(this)];\n\n        rewardToken[address(p.splitData[0].newDAO)] += rewardTokenToBeMoved;\n        if (rewardToken[address(this)] < rewardTokenToBeMoved)\n            throw;\n        rewardToken[address(this)] -= rewardTokenToBeMoved;\n\n        DAOpaidOut[address(p.splitData[0].newDAO)] += paidOutToBeMoved;\n        if (DAOpaidOut[address(this)] < paidOutToBeMoved)\n            throw;\n        DAOpaidOut[address(this)] -= paidOutToBeMoved;\n\n        // Burn DAO Tokens\n        Transfer(msg.sender, 0, balances[msg.sender]);\n        withdrawRewardFor(msg.sender); // be nice, and get his rewards\n        totalSupply -= balances[msg.sender];\n        balances[msg.sender] = 0;\n        paidOut[msg.sender] = 0;\n        return true;\n    }", "highlightLines": [943]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 943, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "f47224851cb4", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        Proposal p = proposals[_proposalID];\n\n        // Sanity check\n\n        if (now < p.votingDeadline  // has the voting deadline arrived?\n            //The request for a split expires XX days after the voting deadline\n            || now > p.votingDeadline + splitExecutionPeriod\n            // Does the new Curator address match?\n            || p.recipient != _newCurator\n            // Is it a new curator proposal?\n            || !p.newCurator\n            // Have you voted for this split?\n            || !p.votedYes[msg.sender]\n            // Did you already vote on another proposal?\n            || (blocked[msg.sender] != _proposalID && blocked[msg.sender] != 0) )  {\n\n            throw;\n        }\n\n        // If the new DAO doesn't exist yet, create the new DAO and store the\n        // current split data\n        if (address(p.splitData[0].newDAO) == 0) {\n            p.splitData[0].newDAO = createNewDAO(_newCurator);\n            // Call depth limit reached, etc.\n            if (address(p.splitData[0].newDAO) == 0)\n                throw;\n            // should never happen\n            if (this.balance < sumOfProposalDeposits)\n                throw;\n            p.splitData[0].splitBalance = actualBalance();\n            p.splitData[0].rewardToken = rewardToken[address(this)];\n            p.splitData[0].totalSupply = totalSupply;\n            p.proposalPassed = true;\n        }", "highlightLines": [948]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 948, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "8267b2fbee30", "fix": {"template": null, "available": false}, "title": "Block timestamp used for critical logic - miners can manipulate within ~15 second window", "ruleId": "rules.sol-block-timestamp-manipulation", "snippet": {"code": "        if (now < p.votingDeadline  // has the voting deadline arrived?", "highlightLines": [952]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 952, "column": 13}, "severity": "medium", "references": ["https://consensys.github.io/smart-contract-best-practices/development-recommendations/solidity-specific/timestamp-dependence/"], "description": ""}, {"id": "8786c5d196ec", "fix": {"template": null, "available": false}, "title": "Block timestamp used for critical logic - miners can manipulate within ~15 second window", "ruleId": "rules.sol-block-timestamp-manipulation", "snippet": {"code": "            || now > p.votingDeadline + splitExecutionPeriod", "highlightLines": [954]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 954, "column": 16}, "severity": "medium", "references": ["https://consensys.github.io/smart-contract-best-practices/development-recommendations/solidity-specific/timestamp-dependence/"], "description": ""}, {"id": "aa65087c5cae", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "\n            throw;", "highlightLines": [963]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 963, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "db631d6f7cf6", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            p.splitData[0].newDAO = createNewDAO(_newCurator);\n            // Call depth limit reached, etc.\n            if (address(p.splitData[0].newDAO) == 0)\n                throw;\n            // should never happen\n            if (this.balance < sumOfProposalDeposits)\n                throw;\n            p.splitData[0].splitBalance = actualBalance();", "highlightLines": [970]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 970, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "2a0435f14c96", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "                throw;", "highlightLines": [973]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 973, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "bc09a6d6cf97", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "                throw;", "highlightLines": [976]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 976, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "44691b4ddc2f", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "                throw;\n            p.splitData[0].splitBalance = actualBalance();", "highlightLines": [976]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 976, "column": 17}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "4afc4009be56", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            p.splitData[0].splitBalance = actualBalance();\n            p.splitData[0].rewardToken = rewardToken[address(this)];", "highlightLines": [977]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 977, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "b129d41c7e4b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            p.splitData[0].rewardToken = rewardToken[address(this)];\n            p.splitData[0].totalSupply = totalSupply;", "highlightLines": [978]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 978, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "b3b8abfe9c4c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            p.splitData[0].totalSupply = totalSupply;\n            p.proposalPassed = true;", "highlightLines": [979]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 979, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "7702e3518cdb", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint fundsToBeMoved =", "highlightLines": [984]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 984, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8d2d4f2a19af", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint fundsToBeMoved =\n            (balances[msg.sender] * p.splitData[0].splitBalance) /\n            p.splitData[0].totalSupply;\n        if (p.splitData[0].newDAO.createTokenProxy.value(fundsToBeMoved)(msg.sender) == false)\n            throw;\n\n\n        // Assign reward rights to new DAO\n        uint rewardTokenToBeMoved =\n            (balances[msg.sender] * p.splitData[0].rewardToken) /\n            p.splitData[0].totalSupply;", "highlightLines": [984]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 984, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "59b06d70685d", "fix": {"template": null, "available": false}, "title": "Unnecessary comparison to boolean constant - use variable directly", "ruleId": "rules.sol-boolean-constant-comparison", "snippet": {"code": "        if (p.splitData[0].newDAO.createTokenProxy.value(fundsToBeMoved)(msg.sender) == false)", "highlightLines": [987]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 987, "column": 86}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#boolean-equality"], "description": ""}, {"id": "1c614caaec15", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "            throw;", "highlightLines": [988]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 988, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "ccbd5c754b1d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint rewardTokenToBeMoved =", "highlightLines": [992]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 992, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "9b032df8e6a2", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint rewardTokenToBeMoved =\n            (balances[msg.sender] * p.splitData[0].rewardToken) /\n            p.splitData[0].totalSupply;\n\n        uint paidOutToBeMoved = DAOpaidOut[address(this)] * rewardTokenToBeMoved /\n            rewardToken[address(this)];", "highlightLines": [992]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 992, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "dad052aa07cb", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint paidOutToBeMoved = DAOpaidOut[address(this)] * rewardTokenToBeMoved /", "highlightLines": [995]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 995, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f97235c77c35", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint paidOutToBeMoved = DAOpaidOut[address(this)] * rewardTokenToBeMoved /\n            rewardToken[address(this)];\n\n        rewardToken[address(p.splitData[0].newDAO)] += rewardTokenToBeMoved;\n        if (rewardToken[address(this)] < rewardTokenToBeMoved)\n            throw;\n        rewardToken[address(this)] -= rewardTokenToBeMoved;\n\n        DAOpaidOut[address(p.splitData[0].newDAO)] += paidOutToBeMoved;\n        if (DAOpaidOut[address(this)] < paidOutToBeMoved)\n            throw;\n        DAOpaidOut[address(this)] -= paidOutToBeMoved;\n\n        // Burn DAO Tokens\n        Transfer(msg.sender, 0, balances[msg.sender]);\n        withdrawRewardFor(msg.sender); // be nice, and get his rewards\n        totalSupply -= balances[msg.sender];\n        balances[msg.sender] = 0;", "highlightLines": [996]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 996, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "8b97849c75ca", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "            throw;", "highlightLines": [1001]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1001, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "db3b34bfcb20", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "            throw;\n        rewardToken[address(this)] -= rewardTokenToBeMoved;", "highlightLines": [1001]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1001, "column": 13}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "bb643e3cee3b", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "            throw;", "highlightLines": [1006]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1006, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "d29841fd109d", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "            throw;\n        DAOpaidOut[address(this)] -= paidOutToBeMoved;", "highlightLines": [1006]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1006, "column": 13}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "e3d18ca64027", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        balances[msg.sender] = 0;\n        paidOut[msg.sender] = 0;", "highlightLines": [1013]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1013, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "8663cfaaffd5", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function newContract(address _newContract){\n        if (msg.sender != address(this) || !allowedRecipients[_newContract]) return;\n        // move all ether\n        if (!_newContract.call.value(address(this).balance)()) {\n            throw;\n        }\n\n        //move all reward tokens\n        rewardToken[_newContract] += rewardToken[address(this)];\n        rewardToken[address(this)] = 0;\n        DAOpaidOut[_newContract] += DAOpaidOut[address(this)];\n        DAOpaidOut[address(this)] = 0;\n    }", "highlightLines": [1018]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1018, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "a1792f837850", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "            throw;", "highlightLines": [1022]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1022, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "8a8e6002bab9", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        rewardToken[address(this)] = 0;\n        DAOpaidOut[_newContract] += DAOpaidOut[address(this)];\n        DAOpaidOut[address(this)] = 0;", "highlightLines": [1027]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1027, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "b1234f4b76ec", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        DAO dao = DAO(msg.sender);\n\n        if ((rewardToken[msg.sender] * DAOrewardAccount.accumulatedInput()) /\n            totalRewardToken < DAOpaidOut[msg.sender])\n            throw;\n\n        uint reward =\n            (rewardToken[msg.sender] * DAOrewardAccount.accumulatedInput()) /\n            totalRewardToken - DAOpaidOut[msg.sender];", "highlightLines": [1034]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1034, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "104751ad6490", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "            throw;", "highlightLines": [1038]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1038, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "2a1c372c2118", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "            throw;\n\n        uint reward =", "highlightLines": [1038]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1038, "column": 13}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "530f79a3554b", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint reward =", "highlightLines": [1039]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1039, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "267225d6fe8f", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "                throw;", "highlightLines": [1045]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1045, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "911149b67dec", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "                throw;", "highlightLines": [1049]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1049, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "957625cbc5ca", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function getMyReward() noEther returns (bool _success) {\n        return withdrawRewardFor(msg.sender);\n    }", "highlightLines": [1055]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1055, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "d026aef0b1c0", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "            throw;", "highlightLines": [1062]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1062, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "03e63140885f", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "            throw;\n\n        uint reward =", "highlightLines": [1062]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1062, "column": 13}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "e4701dcff177", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint reward =", "highlightLines": [1063]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1063, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "9f0ad31baa85", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "            throw;", "highlightLines": [1067]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1067, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "1c183bebc1f6", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "            throw;\n        paidOut[_account] += reward;", "highlightLines": [1067]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1067, "column": 13}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "08128c1f2d72", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without msg.data.length validation - vulnerable to short address attack padding", "ruleId": "rules.sol-short-address-no-payload-check", "snippet": {"code": "    function transfer(address _to, uint256 _value) returns (bool success) {", "highlightLines": [1073]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1073, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address", "https://vessenes.com/the-erc20-short-address-attack-explained/"], "description": ""}, {"id": "bbfd4767904e", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function transfer(address _to, uint256 _value) returns (bool success) {\n        if (isFueled\n            && now > closingTime\n            && !isBlocked(msg.sender)\n            && transferPaidOut(msg.sender, _to, _value)\n            && super.transfer(_to, _value)) {\n\n            return true;\n        } else {\n            throw;\n        }\n    }", "highlightLines": [1073]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1073, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "1c89194a34ab", "fix": {"template": null, "available": false}, "title": "Block timestamp used for critical logic - miners can manipulate within ~15 second window", "ruleId": "rules.sol-block-timestamp-manipulation", "snippet": {"code": "            && now > closingTime", "highlightLines": [1075]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1075, "column": 16}, "severity": "medium", "references": ["https://consensys.github.io/smart-contract-best-practices/development-recommendations/solidity-specific/timestamp-dependence/"], "description": ""}, {"id": "6ebfbc7683f9", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "            throw;", "highlightLines": [1082]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1082, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "c127cfb24ad0", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function transferWithoutReward(address _to, uint256 _value) returns (bool success) {\n        if (!getMyReward())\n            throw;\n        return transfer(_to, _value);\n    }", "highlightLines": [1087]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1087, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "18f0c937a309", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "            throw;", "highlightLines": [1089]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1089, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "366c805a2cc5", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "            throw;\n        return transfer(_to, _value);", "highlightLines": [1089]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1089, "column": 13}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "e7b158de073c", "fix": {"template": null, "available": false}, "title": "ERC20 transferFrom without payload size validation - consider adding onlyPayloadSize modifier", "ruleId": "rules.sol-erc20-missing-payload-modifier", "snippet": {"code": "    function transferFrom(address _from, address _to, uint256 _value) returns (bool success) {", "highlightLines": [1094]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1094, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address"], "description": ""}, {"id": "d38201547e8d", "fix": {"template": null, "available": false}, "title": "NFT transfer without approval/ownership check - add _isApprovedOrOwner validation", "ruleId": "rules.sol-nft-transfer-no-approval-check", "snippet": {"code": "    function transferFrom(address _from, address _to, uint256 _value) returns (bool success) {", "highlightLines": [1094]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1094, "column": 5}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/NFT-transfer.sol"], "description": ""}, {"id": "8b4de255674e", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function transferFrom(address _from, address _to, uint256 _value) returns (bool success) {\n        if (isFueled\n            && now > closingTime\n            && !isBlocked(_from)\n            && transferPaidOut(_from, _to, _value)\n            && super.transferFrom(_from, _to, _value)) {\n\n            return true;\n        } else {\n            throw;\n        }\n    }", "highlightLines": [1094]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1094, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "5043402f3015", "fix": {"template": null, "available": false}, "title": "Block timestamp used for critical logic - miners can manipulate within ~15 second window", "ruleId": "rules.sol-block-timestamp-manipulation", "snippet": {"code": "            && now > closingTime", "highlightLines": [1096]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1096, "column": 16}, "severity": "medium", "references": ["https://consensys.github.io/smart-contract-best-practices/development-recommendations/solidity-specific/timestamp-dependence/"], "description": ""}, {"id": "cb5ec9f2ead1", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "            throw;", "highlightLines": [1103]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1103, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "7cc7d2dfe3b2", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function transferFromWithoutReward(\n        address _from,\n        address _to,\n        uint256 _value\n    ) returns (bool success) {\n\n        if (!withdrawRewardFor(_from))\n            throw;\n        return transferFrom(_from, _to, _value);\n    }", "highlightLines": [1108]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1108, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "c6f051fe2bf3", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "            throw;", "highlightLines": [1115]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1115, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "a2239d7f6dd7", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "            throw;\n        return transferFrom(_from, _to, _value);", "highlightLines": [1115]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1115, "column": 13}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "e55e52250878", "fix": {"template": null, "available": false}, "title": "NFT transfer without royalty enforcement - use ERC2981", "ruleId": "rules.sol-nft-royalty-bypass", "snippet": {"code": "        return transferFrom(_from, _to, _value);", "highlightLines": [1116]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1116, "column": 16}, "severity": "info", "references": [], "description": ""}, {"id": "2da46f4567ef", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint transferPaidOut = paidOut[_from] * _value / balanceOf(_from);", "highlightLines": [1125]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1125, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "11f477def67e", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "            throw;", "highlightLines": [1128]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1128, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "91de35527124", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "            throw;\n        paidOut[_from] -= transferPaidOut;", "highlightLines": [1128]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1128, "column": 13}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "73c8edbde12e", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "\n            throw;", "highlightLines": [1138]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1138, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "4115e05eb7d3", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "            throw;", "highlightLines": [1147]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1147, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "b39f6ec4f3eb", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "            throw;\n        allowedRecipients[_recipient] = _allowed;", "highlightLines": [1147]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1147, "column": 13}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "80f57c4dfb9c", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function isRecipientAllowed(address _recipient) internal returns (bool _isAllowed) {\n        if (allowedRecipients[_recipient]\n            || (_recipient == address(extraBalance)", "highlightLines": [1154]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1154, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "13f3045f5a02", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "            return true;\n        else", "highlightLines": [1160]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1160, "column": 13}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "9afa43812753", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function actualBalance() constant returns (uint _actualBalance) {\n        return this.balance - sumOfProposalDeposits;\n    }", "highlightLines": [1165]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1165, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "ecab0824dd86", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function halveMinQuorum() returns (bool _success) {\n        // this can only be called after `quorumHalvingPeriod` has passed or at anytime\n        // by the curator with a delay of at least `minProposalDebatePeriod` between the calls\n        if ((lastTimeMinQuorumMet < (now - quorumHalvingPeriod) || msg.sender == curator)\n            && lastTimeMinQuorumMet < (now - minProposalDebatePeriod)) {\n            lastTimeMinQuorumMet = now;\n            minQuorumDivisor *= 2;\n            return true;\n        } else {\n            return false;\n        }\n    }", "highlightLines": [1177]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1177, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "7ebeb0bfe2f5", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function numberOfProposals() constant returns (uint _numberOfProposals) {\n        // Don't count index 0. It's used by isBlocked() and exists from start\n        return proposals.length - 1;\n    }", "highlightLines": [1195]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1195, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "e9605c39ba74", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function getNewDAOAddress(uint _proposalID) constant returns (address _newDAO) {\n        return proposals[_proposalID].splitData[0].newDAO;\n    }", "highlightLines": [1200]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1200, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "778cdcbd3ed0", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "            return false;\n        Proposal p = proposals[blocked[_account]];", "highlightLines": [1206]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1206, "column": 13}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "a05de76a7cd4", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        Proposal p = proposals[blocked[_account]];\n        if (now > p.votingDeadline) {\n            blocked[_account] = 0;\n            return false;\n        } else {\n            return true;\n        }", "highlightLines": [1207]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1207, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "fbd44dc3d4fb", "fix": {"template": null, "available": false}, "title": "Block timestamp used for critical logic - miners can manipulate within ~15 second window", "ruleId": "rules.sol-block-timestamp-manipulation", "snippet": {"code": "        if (now > p.votingDeadline) {", "highlightLines": [1208]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1208, "column": 13}, "severity": "medium", "references": ["https://consensys.github.io/smart-contract-best-practices/development-recommendations/solidity-specific/timestamp-dependence/"], "description": ""}, {"id": "7dc6ff3bb4c6", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function unblockMe() returns (bool) {\n        return isBlocked(msg.sender);\n    }", "highlightLines": [1216]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1216, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "e232d5a5d17b", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function createDAO(\n        address _curator,\n        uint _proposalDeposit,\n        uint _minTokensToCreate,\n        uint _closingTime\n    ) returns (DAO _newDAO) {\n\n        return new DAO(\n            _curator,\n            DAO_Creator(this),\n            _proposalDeposit,\n            _minTokensToCreate,\n            _closingTime,\n            msg.sender\n        );\n    }", "highlightLines": [1222]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1222, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "bdba448aa117", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        return new DAO(\n            _curator,\n            DAO_Creator(this),\n            _proposalDeposit,\n            _minTokensToCreate,\n            _closingTime,\n            msg.sender\n        );", "highlightLines": [1229]}, "category": "code", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 1229, "column": 16}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "615a2f160176", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.15;", "highlightLines": [1]}, "category": "code", "location": {"file": "reentrancy/Reentrancy.sol", "line": 1, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "f21d0c8f6cc7", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.15;", "highlightLines": [1]}, "category": "code", "location": {"file": "reentrancy/Reentrancy.sol", "line": 1, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "1cd20181c070", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function getBalance(address u) constant returns(uint){\n        return userBalance[u];\n    }", "highlightLines": [6]}, "category": "code", "location": {"file": "reentrancy/Reentrancy.sol", "line": 6, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "51253c767f91", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function addToBalance() payable{\n        userBalance[msg.sender] += msg.value;\n    }", "highlightLines": [10]}, "category": "code", "location": {"file": "reentrancy/Reentrancy.sol", "line": 10, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "4b6c8a2eaede", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function withdrawBalance(){\n        // send userBalance[msg.sender] ethers to msg.sender\n        // if mgs.sender is a contract, it will call its fallback function\n        if( ! (msg.sender.call.value(userBalance[msg.sender])() ) ){\n            throw;\n        }\n        userBalance[msg.sender] = 0;\n    }", "highlightLines": [14]}, "category": "code", "location": {"file": "reentrancy/Reentrancy.sol", "line": 14, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "64edeaa35e8c", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "            throw;", "highlightLines": [18]}, "category": "code", "location": {"file": "reentrancy/Reentrancy.sol", "line": 18, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "cfc738753c26", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function withdrawBalance_fixed(){\n        // to protect against re-entrancy, the state variable\n        // has to be change before the call\n        uint amount = userBalance[msg.sender];\n        userBalance[msg.sender] = 0;\n        if( ! (msg.sender.call.value(amount)() ) ){\n            throw;\n        }\n    }", "highlightLines": [23]}, "category": "code", "location": {"file": "reentrancy/Reentrancy.sol", "line": 23, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "c87122ea22c2", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint amount = userBalance[msg.sender];", "highlightLines": [26]}, "category": "code", "location": {"file": "reentrancy/Reentrancy.sol", "line": 26, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "035c1d4ea955", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint amount = userBalance[msg.sender];\n        userBalance[msg.sender] = 0;", "highlightLines": [26]}, "category": "code", "location": {"file": "reentrancy/Reentrancy.sol", "line": 26, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "0738fe46952c", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "            throw;", "highlightLines": [29]}, "category": "code", "location": {"file": "reentrancy/Reentrancy.sol", "line": 29, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "48d2e80c7b2c", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function withdrawBalance_fixed_2(){\n        // send() and transfer() are safe against reentrancy\n        // they do not transfer the remaining gas\n        // and they give just enough gas to execute few instructions    \n        // in the fallback function (no further call possible)\n        msg.sender.transfer(userBalance[msg.sender]);\n        userBalance[msg.sender] = 0;\n    }", "highlightLines": [33]}, "category": "code", "location": {"file": "reentrancy/Reentrancy.sol", "line": 33, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "83b1f050f14d", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        msg.sender.transfer(userBalance[msg.sender]);", "highlightLines": [38]}, "category": "code", "location": {"file": "reentrancy/Reentrancy.sol", "line": 38, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "9f9a5fcae9d5", "fix": {"template": null, "available": false}, "title": "Claim bitmap updated after token transfer - reentrancy can bypass claim tracking", "ruleId": "rules.sol-claim-bitmap-after-transfer", "snippet": {"code": "        msg.sender.transfer(userBalance[msg.sender]);\n        userBalance[msg.sender] = 0;", "highlightLines": [38]}, "category": "code", "location": {"file": "reentrancy/Reentrancy.sol", "line": 38, "column": 9}, "severity": "high", "references": [], "description": ""}, {"id": "5f9847708532", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.15;", "highlightLines": [1]}, "category": "code", "location": {"file": "reentrancy/ReentrancyExploit.sol", "line": 1, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "1bdc5e2861ce", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.15;", "highlightLines": [1]}, "category": "code", "location": {"file": "reentrancy/ReentrancyExploit.sol", "line": 1, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "d4ce80eacae1", "fix": {"template": null, "available": false}, "title": "SWC-118: Function name matches contract name - likely intended as constructor (pre-0.4.22)", "ruleId": "rules.sol-swc-118-constructor-mismatch", "snippet": {"code": "contract ReentranceExploit {\n    bool public attackModeIsOn=false; \n    address public vulnerable_contract;\n    address public owner;\n\n    function ReentranceExploit() public{", "highlightLines": [3]}, "category": "code", "location": {"file": "reentrancy/ReentrancyExploit.sol", "line": 3, "column": 1}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-118"], "description": ""}, {"id": "fa1e6ea1f15e", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        owner = msg.sender;", "highlightLines": [9]}, "category": "code", "location": {"file": "reentrancy/ReentrancyExploit.sol", "line": 9, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "a521401f465b", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function deposit(address _vulnerable_contract) public payable{", "highlightLines": [12]}, "category": "code", "location": {"file": "reentrancy/ReentrancyExploit.sol", "line": 12, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "a39e00356d09", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(vulnerable_contract.call.value(msg.value)(bytes4(sha3(\"addToBalance()\"))));", "highlightLines": [15]}, "category": "code", "location": {"file": "reentrancy/ReentrancyExploit.sol", "line": 15, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "f3ffc1701582", "fix": {"template": null, "available": false}, "title": "sha3() is deprecated - use keccak256() instead", "ruleId": "rules.sol-deprecated-sha3", "snippet": {"code": "        require(vulnerable_contract.call.value(msg.value)(bytes4(sha3(\"addToBalance()\"))));", "highlightLines": [15]}, "category": "code", "location": {"file": "reentrancy/ReentrancyExploit.sol", "line": 15, "column": 66}, "severity": "info", "references": [], "description": ""}, {"id": "639f6bb67e02", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(vulnerable_contract.call(bytes4(sha3(\"withdrawBalance()\"))));", "highlightLines": [22]}, "category": "code", "location": {"file": "reentrancy/ReentrancyExploit.sol", "line": 22, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "3afbe14ab903", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "        require(vulnerable_contract.call(bytes4(sha3(\"withdrawBalance()\"))));", "highlightLines": [22]}, "category": "code", "location": {"file": "reentrancy/ReentrancyExploit.sol", "line": 22, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "2e50d2e796c0", "fix": {"template": null, "available": false}, "title": "sha3() is deprecated - use keccak256() instead", "ruleId": "rules.sol-deprecated-sha3", "snippet": {"code": "        require(vulnerable_contract.call(bytes4(sha3(\"withdrawBalance()\"))));", "highlightLines": [22]}, "category": "code", "location": {"file": "reentrancy/ReentrancyExploit.sol", "line": 22, "column": 49}, "severity": "info", "references": [], "description": ""}, {"id": "549f212fe986", "fix": {"template": null, "available": false}, "title": "Function pointer stored in state variable - potential hijack target", "ruleId": "rules.sol-function-pointer-state", "snippet": {"code": "    function () public payable{\n        // atackModeIsOn is used to execute the attack only once\n        // otherwise there is a loop between withdrawBalance and the fallback function\n        if (attackModeIsOn){\n            attackModeIsOn = false;", "highlightLines": [26]}, "category": "code", "location": {"file": "reentrancy/ReentrancyExploit.sol", "line": 26, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "4b2684b5cddc", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "        // otherwise there is a loop between withdrawBalance and the fallback function\n        if (attackModeIsOn){\n            attackModeIsOn = false;", "highlightLines": [28]}, "category": "code", "location": {"file": "reentrancy/ReentrancyExploit.sol", "line": 28, "column": 79}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "e6ae3613f828", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "                require(vulnerable_contract.call(bytes4(sha3(\"withdrawBalance()\"))));", "highlightLines": [31]}, "category": "code", "location": {"file": "reentrancy/ReentrancyExploit.sol", "line": 31, "column": 17}, "severity": "info", "references": [], "description": ""}, {"id": "e54f8343a6b4", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "                require(vulnerable_contract.call(bytes4(sha3(\"withdrawBalance()\"))));", "highlightLines": [31]}, "category": "code", "location": {"file": "reentrancy/ReentrancyExploit.sol", "line": 31, "column": 25}, "severity": "medium", "references": [], "description": ""}, {"id": "3e84e63da613", "fix": {"template": null, "available": false}, "title": "sha3() is deprecated - use keccak256() instead", "ruleId": "rules.sol-deprecated-sha3", "snippet": {"code": "                require(vulnerable_contract.call(bytes4(sha3(\"withdrawBalance()\"))));", "highlightLines": [31]}, "category": "code", "location": {"file": "reentrancy/ReentrancyExploit.sol", "line": 31, "column": 57}, "severity": "info", "references": [], "description": ""}, {"id": "582202ace44d", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function get_money(){\n        suicide(owner);\n    }", "highlightLines": [35]}, "category": "code", "location": {"file": "reentrancy/ReentrancyExploit.sol", "line": 35, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "f99ca95f035e", "fix": {"template": null, "available": false}, "title": "Contract can be destructed by anyone - missing access control on selfdestruct", "ruleId": "rules.sol-accessible-selfdestruct", "snippet": {"code": "        suicide(owner);", "highlightLines": [36]}, "category": "code", "location": {"file": "reentrancy/ReentrancyExploit.sol", "line": 36, "column": 9}, "severity": "high", "references": ["https://www.parity.io/blog/a-postmortem-on-the-parity-multi-sig-library-self-destruct/"], "description": ""}, {"id": "0420494076a3", "fix": {"template": null, "available": false}, "title": "suicide() is deprecated - use selfdestruct() instead", "ruleId": "rules.sol-deprecated-suicide", "snippet": {"code": "        suicide(owner);", "highlightLines": [36]}, "category": "code", "location": {"file": "reentrancy/ReentrancyExploit.sol", "line": 36, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "65ddd20aaa66", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity 0.4.15;", "highlightLines": [5]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain.sol", "line": 5, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "5d3798859cf4", "fix": {"template": null, "available": false}, "title": "Unchecked subtraction can underflow in Solidity <0.8.0 - use SafeMath (Token pattern)", "ruleId": "rules.sol-integer-underflow-pre-080", "snippet": {"code": "pragma solidity 0.4.15;\n\ncontract Token {\n    /* This is a slight change to the ERC20 base standard.\n    function totalSupply() constant returns (uint256 supply);\n    is replaced with:\n    uint256 public totalSupply;\n    This automatically creates a getter function for the totalSupply.\n    This is moved to the base contract since public getter functions are not\n    currently recognised as an implementation of the matching abstract\n    function by the compiler.\n    */\n    /// total amount of tokens\n    uint256 public totalSupply;\n\n    /// @param _owner The address from which the balance will be retrieved\n    /// @return The balance\n    function balanceOf(address _owner) constant returns (uint256 balance);\n\n    /// @notice send `_value` token to `_to` from `msg.sender`\n    /// @param _to The address of the recipient\n    /// @param _value The amount of token to be transferred\n    /// @return Whether the transfer was successful or not\n    function transfer(address _to, uint256 _value) returns (bool success);\n\n    /// @notice send `_value` token to `_to` from `_from` on the condition it is approved by `_from`\n    /// @param _from The address of the sender\n    /// @param _to The address of the recipient\n    /// @param _value The amount of token to be transferred\n    /// @return Whether the transfer was successful or not\n    function transferFrom(address _from, address _to, uint256 _value) returns (bool success);\n\n    /// @notice `msg.sender` approves `_spender` to spend `_value` tokens\n    /// @param _spender The address of the account able to transfer the tokens\n    /// @param _value The amount of tokens to be approved for transfer\n    /// @return Whether the approval was successful or not\n    function approve(address _spender, uint256 _value) returns (bool success);\n\n    /// @param _owner The address of the account owning tokens\n    /// @param _spender The address of the account able to transfer the tokens\n    /// @return Amount of remaining tokens allowed to spent\n    function allowance(address _owner, address _spender) constant returns (uint256 remaining);\n\n    event Transfer(address indexed _from, address indexed _to, uint256 _value);\n    event Approval(address indexed _owner, address indexed _spender, uint256 _value);\n}\n\n\n/*\nYou should inherit from StandardToken or, for a token like you would want to\ndeploy in something like Mist, see HumanStandardToken.sol.\n(This implements ONLY the standard functions and NOTHING else.\nIf you deploy this, you won't have anything useful.)\n\nImplements ERC 20 Token standard: https://github.com/ethereum/EIPs/issues/20\n.*/\ncontract StandardToken is Token {\n\n    function transfer(address _to, uint256 _value) returns (bool success) {\n        //Default assumes totalSupply can't be over max (2^256 - 1).\n        //If your token leaves out totalSupply and can issue more tokens as time goes on, you need to check if it doesn't wrap.\n        //Replace the if with this one instead.\n        //require(balances[msg.sender] >= _value && balances[_to] + _value > balances[_to]);\n        require(balances[msg.sender] >= _value);\n        balances[msg.sender] -= _value;\n        balances[_to] += _value;\n        Transfer(msg.sender, _to, _value);\n        return true;\n    }\n\n    function transferFrom(address _from, address _to, uint256 _value) returns (bool success) {\n        //same as above. Replace this line with the following if you want to protect against wrapping uints.\n        //require(balances[_from] >= _value && allowed[_from][msg.sender] >= _value && balances[_to] + _value > balances[_to]);\n        require(balances[_from] >= _value && allowed[_from][msg.sender] >= _value);\n        balances[_to] += _value;\n        balances[_from] -= _value;", "highlightLines": [5]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain.sol", "line": 5, "column": 1}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/level/5"], "description": ""}, {"id": "fead1646c361", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function balanceOf(address _owner) constant returns (uint256 balance);", "highlightLines": [22]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain.sol", "line": 22, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "49f89f8e6d38", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function transfer(address _to, uint256 _value) returns (bool success);", "highlightLines": [28]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain.sol", "line": 28, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "50646e8465aa", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without msg.data.length validation - vulnerable to short address attack padding", "ruleId": "rules.sol-short-address-no-payload-check", "snippet": {"code": "    function transfer(address _to, uint256 _value) returns (bool success);\n\n    /// @notice send `_value` token to `_to` from `_from` on the condition it is approved by `_from`\n    /// @param _from The address of the sender\n    /// @param _to The address of the recipient\n    /// @param _value The amount of token to be transferred\n    /// @return Whether the transfer was successful or not\n    function transferFrom(address _from, address _to, uint256 _value) returns (bool success);\n\n    /// @notice `msg.sender` approves `_spender` to spend `_value` tokens\n    /// @param _spender The address of the account able to transfer the tokens\n    /// @param _value The amount of tokens to be approved for transfer\n    /// @return Whether the approval was successful or not\n    function approve(address _spender, uint256 _value) returns (bool success);\n\n    /// @param _owner The address of the account owning tokens\n    /// @param _spender The address of the account able to transfer the tokens\n    /// @return Amount of remaining tokens allowed to spent\n    function allowance(address _owner, address _spender) constant returns (uint256 remaining);\n\n    event Transfer(address indexed _from, address indexed _to, uint256 _value);\n    event Approval(address indexed _owner, address indexed _spender, uint256 _value);\n}\n\n\n/*\nYou should inherit from StandardToken or, for a token like you would want to\ndeploy in something like Mist, see HumanStandardToken.sol.\n(This implements ONLY the standard functions and NOTHING else.\nIf you deploy this, you won't have anything useful.)\n\nImplements ERC 20 Token standard: https://github.com/ethereum/EIPs/issues/20\n.*/\ncontract StandardToken is Token {", "highlightLines": [28]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain.sol", "line": 28, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address", "https://vessenes.com/the-erc20-short-address-attack-explained/"], "description": ""}, {"id": "9e041bebcf4c", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function transferFrom(address _from, address _to, uint256 _value) returns (bool success);", "highlightLines": [35]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain.sol", "line": 35, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "2b4b7f869aaa", "fix": {"template": null, "available": false}, "title": "ERC20 transferFrom without payload size validation - consider adding onlyPayloadSize modifier", "ruleId": "rules.sol-erc20-missing-payload-modifier", "snippet": {"code": "    function transferFrom(address _from, address _to, uint256 _value) returns (bool success);\n\n    /// @notice `msg.sender` approves `_spender` to spend `_value` tokens\n    /// @param _spender The address of the account able to transfer the tokens\n    /// @param _value The amount of tokens to be approved for transfer\n    /// @return Whether the approval was successful or not\n    function approve(address _spender, uint256 _value) returns (bool success);\n\n    /// @param _owner The address of the account owning tokens\n    /// @param _spender The address of the account able to transfer the tokens\n    /// @return Amount of remaining tokens allowed to spent\n    function allowance(address _owner, address _spender) constant returns (uint256 remaining);\n\n    event Transfer(address indexed _from, address indexed _to, uint256 _value);\n    event Approval(address indexed _owner, address indexed _spender, uint256 _value);\n}\n\n\n/*\nYou should inherit from StandardToken or, for a token like you would want to\ndeploy in something like Mist, see HumanStandardToken.sol.\n(This implements ONLY the standard functions and NOTHING else.\nIf you deploy this, you won't have anything useful.)\n\nImplements ERC 20 Token standard: https://github.com/ethereum/EIPs/issues/20\n.*/\ncontract StandardToken is Token {", "highlightLines": [35]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain.sol", "line": 35, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address"], "description": ""}, {"id": "8b61a2150770", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function approve(address _spender, uint256 _value) returns (bool success);", "highlightLines": [41]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain.sol", "line": 41, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "9b28f4f4d3d5", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "    /// @return Amount of remaining tokens allowed to spent\n    function allowance(address _owner, address _spender) constant returns (uint256 remaining);\n\n    event Transfer(address indexed _from, address indexed _to, uint256 _value);", "highlightLines": [45]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain.sol", "line": 45, "column": 10}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "a2b5dcf215d6", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function allowance(address _owner, address _spender) constant returns (uint256 remaining);", "highlightLines": [46]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain.sol", "line": 46, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "5a519ba41283", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Transfer(address indexed _from, address indexed _to, uint256 _value);", "highlightLines": [48]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain.sol", "line": 48, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "d9668b3836d7", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Approval(address indexed _owner, address indexed _spender, uint256 _value);", "highlightLines": [49]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain.sol", "line": 49, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "c75bdcc5ebe7", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without msg.data.length validation - vulnerable to short address attack padding", "ruleId": "rules.sol-short-address-no-payload-check", "snippet": {"code": "    function transfer(address _to, uint256 _value) returns (bool success) {", "highlightLines": [63]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain.sol", "line": 63, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address", "https://vessenes.com/the-erc20-short-address-attack-explained/"], "description": ""}, {"id": "1963dd7ff0e5", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "    function transfer(address _to, uint256 _value) returns (bool success) {\n        //Default assumes totalSupply can't be over max (2^256 - 1).\n        //If your token leaves out totalSupply and can issue more tokens as time goes on, you need to check if it doesn't wrap.\n        //Replace the if with this one instead.\n        //require(balances[msg.sender] >= _value && balances[_to] + _value > balances[_to]);\n        require(balances[msg.sender] >= _value);", "highlightLines": [63]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain.sol", "line": 63, "column": 5}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "1b2982b4258e", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function transfer(address _to, uint256 _value) returns (bool success) {\n        //Default assumes totalSupply can't be over max (2^256 - 1).\n        //If your token leaves out totalSupply and can issue more tokens as time goes on, you need to check if it doesn't wrap.\n        //Replace the if with this one instead.\n        //require(balances[msg.sender] >= _value && balances[_to] + _value > balances[_to]);\n        require(balances[msg.sender] >= _value);\n        balances[msg.sender] -= _value;\n        balances[_to] += _value;\n        Transfer(msg.sender, _to, _value);\n        return true;\n    }", "highlightLines": [63]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain.sol", "line": 63, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "5fa10ebed443", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - will never return false, only revert", "ruleId": "rules.sol-return-bool-always-reverts", "snippet": {"code": "    function transfer(address _to, uint256 _value) returns (bool success) {\n        //Default assumes totalSupply can't be over max (2^256 - 1).\n        //If your token leaves out totalSupply and can issue more tokens as time goes on, you need to check if it doesn't wrap.\n        //Replace the if with this one instead.\n        //require(balances[msg.sender] >= _value && balances[_to] + _value > balances[_to]);\n        require(balances[msg.sender] >= _value);\n        balances[msg.sender] -= _value;\n        balances[_to] += _value;\n        Transfer(msg.sender, _to, _value);\n        return true;\n    }", "highlightLines": [63]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain.sol", "line": 63, "column": 5}, "severity": "info", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "11777859f7a4", "fix": {"template": null, "available": false}, "title": "Possible incorrect exponentiation - ^ is XOR in Solidity, use ** for power", "ruleId": "rules.sol-incorrect-exponentiation", "snippet": {"code": "        //Default assumes totalSupply can't be over max (2^256 - 1).", "highlightLines": [64]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain.sol", "line": 64, "column": 58}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-exponentiation"], "description": ""}, {"id": "507dc2aff1fb", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(balances[msg.sender] >= _value);", "highlightLines": [68]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain.sol", "line": 68, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "5cee878c5118", "fix": {"template": null, "available": false}, "title": "ERC20 transferFrom without payload size validation - consider adding onlyPayloadSize modifier", "ruleId": "rules.sol-erc20-missing-payload-modifier", "snippet": {"code": "    function transferFrom(address _from, address _to, uint256 _value) returns (bool success) {", "highlightLines": [75]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain.sol", "line": 75, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address"], "description": ""}, {"id": "9568fc279f02", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "    function transferFrom(address _from, address _to, uint256 _value) returns (bool success) {\n        //same as above. Replace this line with the following if you want to protect against wrapping uints.\n        //require(balances[_from] >= _value && allowed[_from][msg.sender] >= _value && balances[_to] + _value > balances[_to]);\n        require(balances[_from] >= _value && allowed[_from][msg.sender] >= _value);", "highlightLines": [75]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain.sol", "line": 75, "column": 5}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "e671d5e44153", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function transferFrom(address _from, address _to, uint256 _value) returns (bool success) {\n        //same as above. Replace this line with the following if you want to protect against wrapping uints.\n        //require(balances[_from] >= _value && allowed[_from][msg.sender] >= _value && balances[_to] + _value > balances[_to]);\n        require(balances[_from] >= _value && allowed[_from][msg.sender] >= _value);\n        balances[_to] += _value;\n        balances[_from] -= _value;\n        allowed[_from][msg.sender] -= _value;\n        Transfer(_from, _to, _value);\n        return true;\n    }", "highlightLines": [75]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain.sol", "line": 75, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "3d726199044a", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - will never return false, only revert", "ruleId": "rules.sol-return-bool-always-reverts", "snippet": {"code": "    function transferFrom(address _from, address _to, uint256 _value) returns (bool success) {\n        //same as above. Replace this line with the following if you want to protect against wrapping uints.\n        //require(balances[_from] >= _value && allowed[_from][msg.sender] >= _value && balances[_to] + _value > balances[_to]);\n        require(balances[_from] >= _value && allowed[_from][msg.sender] >= _value);\n        balances[_to] += _value;\n        balances[_from] -= _value;\n        allowed[_from][msg.sender] -= _value;\n        Transfer(_from, _to, _value);\n        return true;\n    }", "highlightLines": [75]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain.sol", "line": 75, "column": 5}, "severity": "info", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "52e459fff28c", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(balances[_from] >= _value && allowed[_from][msg.sender] >= _value);", "highlightLines": [78]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain.sol", "line": 78, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "55b80b6e7191", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function balanceOf(address _owner) constant returns (uint256 balance) {\n        return balances[_owner];\n    }", "highlightLines": [86]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain.sol", "line": 86, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "5e8c000c014f", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function approve(address _spender, uint256 _value) returns (bool success) {\n        allowed[msg.sender][_spender] = _value;\n        Approval(msg.sender, _spender, _value);\n        return true;\n    }", "highlightLines": [90]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain.sol", "line": 90, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "9f30bedd5279", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function allowance(address _owner, address _spender) constant returns (uint256 remaining) {\n      return allowed[_owner][_spender];\n    }", "highlightLines": [96]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain.sol", "line": 96, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "16a771ec95f1", "fix": {"template": null, "available": false}, "title": "approveAndCall pattern enables callback attacks - verify callback target", "ruleId": "rules.sol-approve-and-call-callback", "snippet": {"code": "3) Optional approveAndCall() functionality to notify a contract if an approval() has occurred.", "highlightLines": [113]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain.sol", "line": 113, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "67a70ddbc605", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract HumanStandardToken is StandardToken {\n\n    /* Public variables of the token */\n\n    /*\n    NOTE:\n    The following variables are OPTIONAL vanities. One does not have to include them.\n    They allow one to customise the token contract & in no way influences the core functionality.\n    Some wallets/interfaces might not even bother to look at this information.\n    */\n    string public name;                   //fancy name: eg Simon Bucks\n    uint8 public decimals;                //How many decimals to show. ie. There could 1000 base units with 3 decimals. Meaning 0.980 SBX = 980 base units. It's like comparing 1 wei to 1 ether.\n    string public symbol;                 //An identifier: eg SBX\n    string public version = 'H0.1';       //human 0.1 standard. Just an arbitrary versioning scheme.", "highlightLines": [116]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain.sol", "line": 116, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "3991d72ff0c7", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function HumanStandardToken(\n        uint256 _initialAmount,\n        string _tokenName,\n        uint8 _decimalUnits,\n        string _tokenSymbol\n        ) {\n        balances[msg.sender] = _initialAmount;               // Give the creator all initial tokens\n        totalSupply = _initialAmount;                        // Update total supply\n        name = _tokenName;                                   // Set the name for display purposes\n        decimals = _decimalUnits;                            // Amount of decimals for display purposes\n        symbol = _tokenSymbol;                               // Set the symbol for display purposes\n    }", "highlightLines": [131]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain.sol", "line": 131, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "aa8f8b40700b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        balances[msg.sender] = _initialAmount;               // Give the creator all initial tokens\n        totalSupply = _initialAmount;                        // Update total supply", "highlightLines": [137]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain.sol", "line": 137, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "a9ba5d67b1bd", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        totalSupply = _initialAmount;                        // Update total supply\n        name = _tokenName;                                   // Set the name for display purposes", "highlightLines": [138]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain.sol", "line": 138, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "68fcef6a182c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        name = _tokenName;                                   // Set the name for display purposes\n        decimals = _decimalUnits;                            // Amount of decimals for display purposes", "highlightLines": [139]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain.sol", "line": 139, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "04e8673bcf8c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        decimals = _decimalUnits;                            // Amount of decimals for display purposes\n        symbol = _tokenSymbol;                               // Set the symbol for display purposes", "highlightLines": [140]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain.sol", "line": 140, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "1a87fe4c9e21", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "    function approveAndCall(address _spender, uint256 _value, bytes _extraData) returns (bool success) {\n        allowed[msg.sender][_spender] = _value;\n        Approval(msg.sender, _spender, _value);\n\n        //call the receiveApproval function on the contract you want to be notified. This crafts the function signature manually so one doesn't have to include a contract in here just for this.\n        //receiveApproval(address _from, uint256 _value, address _tokenContract, bytes _extraData)\n        //it is assumed that when does this that the call *should* succeed, otherwise one would use vanilla approve instead.\n        require(_spender.call(bytes4(bytes32(sha3(\"receiveApproval(address,uint256,address,bytes)\"))), msg.sender, _value, this, _extraData));", "highlightLines": [145]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain.sol", "line": 145, "column": 5}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "7f06f8b919e5", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function approveAndCall(address _spender, uint256 _value, bytes _extraData) returns (bool success) {\n        allowed[msg.sender][_spender] = _value;\n        Approval(msg.sender, _spender, _value);\n\n        //call the receiveApproval function on the contract you want to be notified. This crafts the function signature manually so one doesn't have to include a contract in here just for this.\n        //receiveApproval(address _from, uint256 _value, address _tokenContract, bytes _extraData)\n        //it is assumed that when does this that the call *should* succeed, otherwise one would use vanilla approve instead.\n        require(_spender.call(bytes4(bytes32(sha3(\"receiveApproval(address,uint256,address,bytes)\"))), msg.sender, _value, this, _extraData));\n        return true;\n    }", "highlightLines": [145]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain.sol", "line": 145, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "cbd612da54e3", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - will never return false, only revert", "ruleId": "rules.sol-return-bool-always-reverts", "snippet": {"code": "    function approveAndCall(address _spender, uint256 _value, bytes _extraData) returns (bool success) {\n        allowed[msg.sender][_spender] = _value;\n        Approval(msg.sender, _spender, _value);\n\n        //call the receiveApproval function on the contract you want to be notified. This crafts the function signature manually so one doesn't have to include a contract in here just for this.\n        //receiveApproval(address _from, uint256 _value, address _tokenContract, bytes _extraData)\n        //it is assumed that when does this that the call *should* succeed, otherwise one would use vanilla approve instead.\n        require(_spender.call(bytes4(bytes32(sha3(\"receiveApproval(address,uint256,address,bytes)\"))), msg.sender, _value, this, _extraData));\n        return true;\n    }", "highlightLines": [145]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain.sol", "line": 145, "column": 5}, "severity": "info", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "b512213cf587", "fix": {"template": null, "available": false}, "title": "approveAndCall pattern enables callback attacks - verify callback target", "ruleId": "rules.sol-approve-and-call-callback", "snippet": {"code": "    function approveAndCall(address _spender, uint256 _value, bytes _extraData) returns (bool success) {", "highlightLines": [145]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain.sol", "line": 145, "column": 14}, "severity": "medium", "references": [], "description": ""}, {"id": "f561414fabfa", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_spender.call(bytes4(bytes32(sha3(\"receiveApproval(address,uint256,address,bytes)\"))), msg.sender, _value, this, _extraData));", "highlightLines": [152]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain.sol", "line": 152, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "4ab66aef8d61", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "        require(_spender.call(bytes4(bytes32(sha3(\"receiveApproval(address,uint256,address,bytes)\"))), msg.sender, _value, this, _extraData));", "highlightLines": [152]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain.sol", "line": 152, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "11713dcfadca", "fix": {"template": null, "available": false}, "title": "sha3() is deprecated - use keccak256() instead", "ruleId": "rules.sol-deprecated-sha3", "snippet": {"code": "        require(_spender.call(bytes4(bytes32(sha3(\"receiveApproval(address,uint256,address,bytes)\"))), msg.sender, _value, this, _extraData));", "highlightLines": [152]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain.sol", "line": 152, "column": 46}, "severity": "info", "references": [], "description": ""}, {"id": "c5f71017c3d3", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.23;", "highlightLines": [3]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 3, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "dcaeff0c4811", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.23;", "highlightLines": [3]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 3, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "b83eac7f291b", "fix": {"template": null, "available": false}, "title": "Unchecked subtraction can underflow in Solidity <0.8.0 - use SafeMath (Token pattern)", "ruleId": "rules.sol-integer-underflow-pre-080", "snippet": {"code": "pragma solidity ^0.4.23;\n// produced by the Solididy File Flattener (c) David Appleton 2018\n// contact : dave@akomba.com\n// released under Apache 2.0 licence\ncontract Token {\n    /* This is a slight change to the ERC20 base standard.\n    function totalSupply() constant returns (uint256 supply);\n    is replaced with:\n    uint256 public totalSupply;\n    This automatically creates a getter function for the totalSupply.\n    This is moved to the base contract since public getter functions are not\n    currently recognised as an implementation of the matching abstract\n    function by the compiler.\n    */\n    /// total amount of tokens\n    uint256 public totalSupply;\n\n    /// @param _owner The address from which the balance will be retrieved\n    /// @return The balance\n    function balanceOf(address _owner) public constant returns (uint256 balance);\n\n    /// @notice send `_value` token to `_to` from `msg.sender`\n    /// @param _to The address of the recipient\n    /// @param _value The amount of token to be transferred\n    /// @return Whether the transfer was successful or not\n    function transfer(address _to, uint256 _value) public returns (bool success);\n\n    /// @notice send `_value` token to `_to` from `_from` on the condition it is approved by `_from`\n    /// @param _from The address of the sender\n    /// @param _to The address of the recipient\n    /// @param _value The amount of token to be transferred\n    /// @return Whether the transfer was successful or not\n    function transferFrom(address _from, address _to, uint256 _value) public returns (bool success);\n\n    /// @notice `msg.sender` approves `_spender` to spend `_value` tokens\n    /// @param _spender The address of the account able to transfer the tokens\n    /// @param _value The amount of tokens to be approved for transfer\n    /// @return Whether the approval was successful or not\n    function approve(address _spender, uint256 _value) public returns (bool success);\n\n    /// @param _owner The address of the account owning tokens\n    /// @param _spender The address of the account able to transfer the tokens\n    /// @return Amount of remaining tokens allowed to spent\n    function allowance(address _owner, address _spender) public constant returns (uint256 remaining);\n\n    event Transfer(address indexed _from, address indexed _to, uint256 _value);\n    event Approval(address indexed _owner, address indexed _spender, uint256 _value);\n}\n\nlibrary ECTools {\n\n    // @dev Recovers the address which has signed a message\n    // @thanks https://gist.github.com/axic/5b33912c6f61ae6fd96d6c4a47afde6d\n    function recoverSigner(bytes32 _hashedMsg, string _sig) public pure returns (address) {\n        require(_hashedMsg != 0x00);\n\n        // need this for test RPC\n        bytes memory prefix = \"\\x19Ethereum Signed Message:\\n32\";\n        bytes32 prefixedHash = keccak256(abi.encodePacked(prefix, _hashedMsg));\n\n        if (bytes(_sig).length != 132) {\n            return 0x0;\n        }\n        bytes32 r;\n        bytes32 s;\n        uint8 v;\n        bytes memory sig = hexstrToBytes(substring(_sig, 2, 132));\n        assembly {\n            r := mload(add(sig, 32))\n            s := mload(add(sig, 64))\n            v := byte(0, mload(add(sig, 96)))\n        }\n        if (v < 27) {\n            v += 27;\n        }\n        if (v < 27 || v > 28) {\n            return 0x0;\n        }\n        return ecrecover(prefixedHash, v, r, s);\n    }\n\n    // @dev Verifies if the message is signed by an address\n    function isSignedBy(bytes32 _hashedMsg, string _sig, address _addr) public pure returns (bool) {\n        require(_addr != 0x0);\n\n        return _addr == recoverSigner(_hashedMsg, _sig);\n    }\n\n    // @dev Converts an hexstring to bytes\n    function hexstrToBytes(string _hexstr) public pure returns (bytes) {\n        uint len = bytes(_hexstr).length;\n        require(len % 2 == 0);\n\n        bytes memory bstr = bytes(new string(len / 2));\n        uint k = 0;\n        string memory s;\n        string memory r;\n        for (uint i = 0; i < len; i += 2) {\n            s = substring(_hexstr, i, i + 1);\n            r = substring(_hexstr, i + 1, i + 2);\n            uint p = parseInt16Char(s) * 16 + parseInt16Char(r);\n            bstr[k++] = uintToBytes32(p)[31];\n        }\n        return bstr;\n    }\n\n    // @dev Parses a hexchar, like 'a', and returns its hex value, in this case 10\n    function parseInt16Char(string _char) public pure returns (uint) {\n        bytes memory bresult = bytes(_char);\n        // bool decimals = false;\n        if ((bresult[0] >= 48) && (bresult[0] <= 57)) {\n            return uint(bresult[0]) - 48;\n        } else if ((bresult[0] >= 65) && (bresult[0] <= 70)) {\n            return uint(bresult[0]) - 55;\n        } else if ((bresult[0] >= 97) && (bresult[0] <= 102)) {\n            return uint(bresult[0]) - 87;\n        } else {\n            revert();\n        }\n    }\n\n    // @dev Converts a uint to a bytes32\n    // @thanks https://ethereum.stackexchange.com/questions/4170/how-to-convert-a-uint-to-bytes-in-solidity\n    function uintToBytes32(uint _uint) public pure returns (bytes b) {\n        b = new bytes(32);\n        assembly {mstore(add(b, 32), _uint)}\n    }\n\n    // @dev Hashes the signed message\n    // @ref https://github.com/ethereum/go-ethereum/issues/3731#issuecomment-293866868\n    function toEthereumSignedMessage(string _msg) public pure returns (bytes32) {\n        uint len = bytes(_msg).length;\n        require(len > 0);\n        bytes memory prefix = \"\\x19Ethereum Signed Message:\\n\";\n        return keccak256(abi.encodePacked(prefix, uintToString(len), _msg));\n    }\n\n    // @dev Converts a uint in a string\n    function uintToString(uint _uint) public pure returns (string str) {\n        uint len = 0;\n        uint m = _uint + 0;\n        while (m != 0) {\n            len++;\n            m /= 10;\n        }\n        bytes memory b = new bytes(len);\n        uint i = len - 1;\n        while (_uint != 0) {\n            uint remainder = _uint % 10;\n            _uint = _uint / 10;\n            b[i--] = byte(48 + remainder);\n        }\n        str = string(b);\n    }\n\n\n    // @dev extract a substring\n    // @thanks https://ethereum.stackexchange.com/questions/31457/substring-in-solidity\n    function substring(string _str, uint _startIndex, uint _endIndex) public pure returns (string) {\n        bytes memory strBytes = bytes(_str);\n        require(_startIndex <= _endIndex);\n        require(_startIndex >= 0);\n        require(_endIndex <= strBytes.length);\n\n        bytes memory result = new bytes(_endIndex - _startIndex);\n        for (uint i = _startIndex; i < _endIndex; i++) {\n            result[i - _startIndex] = strBytes[i];\n        }\n        return string(result);\n    }\n}\ncontract StandardToken is Token {\n\n    function transfer(address _to, uint256 _value) public returns (bool success) {\n        //Default assumes totalSupply can't be over max (2^256 - 1).\n        //If your token leaves out totalSupply and can issue more tokens as time goes on, you need to check if it doesn't wrap.\n        //Replace the if with this one instead.\n        //require(balances[msg.sender] >= _value && balances[_to] + _value > balances[_to]);\n        require(balances[msg.sender] >= _value);\n        balances[msg.sender] -= _value;\n        balances[_to] += _value;\n        emit Transfer(msg.sender, _to, _value);\n        return true;\n    }\n\n    function transferFrom(address _from, address _to, uint256 _value) public returns (bool success) {\n        //same as above. Replace this line with the following if you want to protect against wrapping uints.\n        //require(balances[_from] >= _value && allowed[_from][msg.sender] >= _value && balances[_to] + _value > balances[_to]);\n        require(balances[_from] >= _value && allowed[_from][msg.sender] >= _value);\n        balances[_to] += _value;\n        balances[_from] -= _value;", "highlightLines": [3]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 3, "column": 1}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/level/5"], "description": ""}, {"id": "7f6af4b2286f", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function balanceOf(address _owner) public constant returns (uint256 balance);", "highlightLines": [22]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 22, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "6e96647316f2", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function transfer(address _to, uint256 _value) public returns (bool success);", "highlightLines": [28]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 28, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "f200a10db086", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function transfer(address _to, uint256 _value) public returns (bool success);\n\n    /// @notice send `_value` token to `_to` from `_from` on the condition it is approved by `_from`\n    /// @param _from The address of the sender\n    /// @param _to The address of the recipient\n    /// @param _value The amount of token to be transferred\n    /// @return Whether the transfer was successful or not\n    function transferFrom(address _from, address _to, uint256 _value) public returns (bool success);\n\n    /// @notice `msg.sender` approves `_spender` to spend `_value` tokens\n    /// @param _spender The address of the account able to transfer the tokens\n    /// @param _value The amount of tokens to be approved for transfer\n    /// @return Whether the approval was successful or not\n    function approve(address _spender, uint256 _value) public returns (bool success);\n\n    /// @param _owner The address of the account owning tokens\n    /// @param _spender The address of the account able to transfer the tokens\n    /// @return Amount of remaining tokens allowed to spent\n    function allowance(address _owner, address _spender) public constant returns (uint256 remaining);\n\n    event Transfer(address indexed _from, address indexed _to, uint256 _value);\n    event Approval(address indexed _owner, address indexed _spender, uint256 _value);\n}\n\nlibrary ECTools {", "highlightLines": [28]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 28, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "d0f4e4fe6d00", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without msg.data.length validation - vulnerable to short address attack padding", "ruleId": "rules.sol-short-address-no-payload-check", "snippet": {"code": "    function transfer(address _to, uint256 _value) public returns (bool success);\n\n    /// @notice send `_value` token to `_to` from `_from` on the condition it is approved by `_from`\n    /// @param _from The address of the sender\n    /// @param _to The address of the recipient\n    /// @param _value The amount of token to be transferred\n    /// @return Whether the transfer was successful or not\n    function transferFrom(address _from, address _to, uint256 _value) public returns (bool success);\n\n    /// @notice `msg.sender` approves `_spender` to spend `_value` tokens\n    /// @param _spender The address of the account able to transfer the tokens\n    /// @param _value The amount of tokens to be approved for transfer\n    /// @return Whether the approval was successful or not\n    function approve(address _spender, uint256 _value) public returns (bool success);\n\n    /// @param _owner The address of the account owning tokens\n    /// @param _spender The address of the account able to transfer the tokens\n    /// @return Amount of remaining tokens allowed to spent\n    function allowance(address _owner, address _spender) public constant returns (uint256 remaining);\n\n    event Transfer(address indexed _from, address indexed _to, uint256 _value);\n    event Approval(address indexed _owner, address indexed _spender, uint256 _value);\n}\n\nlibrary ECTools {", "highlightLines": [28]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 28, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address", "https://vessenes.com/the-erc20-short-address-attack-explained/"], "description": ""}, {"id": "99446d937fea", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function transferFrom(address _from, address _to, uint256 _value) public returns (bool success);", "highlightLines": [35]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 35, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "58ca5cf612b8", "fix": {"template": null, "available": false}, "title": "ERC20 transferFrom without payload size validation - consider adding onlyPayloadSize modifier", "ruleId": "rules.sol-erc20-missing-payload-modifier", "snippet": {"code": "    function transferFrom(address _from, address _to, uint256 _value) public returns (bool success);\n\n    /// @notice `msg.sender` approves `_spender` to spend `_value` tokens\n    /// @param _spender The address of the account able to transfer the tokens\n    /// @param _value The amount of tokens to be approved for transfer\n    /// @return Whether the approval was successful or not\n    function approve(address _spender, uint256 _value) public returns (bool success);\n\n    /// @param _owner The address of the account owning tokens\n    /// @param _spender The address of the account able to transfer the tokens\n    /// @return Amount of remaining tokens allowed to spent\n    function allowance(address _owner, address _spender) public constant returns (uint256 remaining);\n\n    event Transfer(address indexed _from, address indexed _to, uint256 _value);\n    event Approval(address indexed _owner, address indexed _spender, uint256 _value);\n}\n\nlibrary ECTools {", "highlightLines": [35]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 35, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address"], "description": ""}, {"id": "ed37d006b293", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function approve(address _spender, uint256 _value) public returns (bool success);", "highlightLines": [41]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 41, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "c294ecc0146e", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "    /// @return Amount of remaining tokens allowed to spent\n    function allowance(address _owner, address _spender) public constant returns (uint256 remaining);\n\n    event Transfer(address indexed _from, address indexed _to, uint256 _value);", "highlightLines": [45]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 45, "column": 10}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "61578c46e601", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function allowance(address _owner, address _spender) public constant returns (uint256 remaining);", "highlightLines": [46]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 46, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "f22613793a84", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Transfer(address indexed _from, address indexed _to, uint256 _value);", "highlightLines": [48]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 48, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "5ede5b98c3da", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Approval(address indexed _owner, address indexed _spender, uint256 _value);", "highlightLines": [49]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 49, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "644f6a18b790", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function recoverSigner(bytes32 _hashedMsg, string _sig) public pure returns (address) {\n        require(_hashedMsg != 0x00);\n\n        // need this for test RPC\n        bytes memory prefix = \"\\x19Ethereum Signed Message:\\n32\";\n        bytes32 prefixedHash = keccak256(abi.encodePacked(prefix, _hashedMsg));", "highlightLines": [56]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 56, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "30c1cefbc615", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_hashedMsg != 0x00);", "highlightLines": [57]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 57, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "d2933ded01aa", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes memory prefix = \"\\x19Ethereum Signed Message:\\n32\";\n        bytes32 prefixedHash = keccak256(abi.encodePacked(prefix, _hashedMsg));", "highlightLines": [60]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 60, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "dc3898347824", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 prefixedHash = keccak256(abi.encodePacked(prefix, _hashedMsg));", "highlightLines": [61]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 61, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "18015d0a8d78", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes32 prefixedHash = keccak256(abi.encodePacked(prefix, _hashedMsg));\n\n        if (bytes(_sig).length != 132) {\n            return 0x0;\n        }\n        bytes32 r;\n        bytes32 s;\n        uint8 v;\n        bytes memory sig = hexstrToBytes(substring(_sig, 2, 132));", "highlightLines": [61]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 61, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "92ddb2814ea3", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        bytes32 prefixedHash = keccak256(abi.encodePacked(prefix, _hashedMsg));", "highlightLines": [61]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 61, "column": 32}, "severity": "high", "references": [], "description": ""}, {"id": "2822a6ed0755", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "        bytes32 prefixedHash = keccak256(abi.encodePacked(prefix, _hashedMsg));", "highlightLines": [61]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 61, "column": 42}, "severity": "medium", "references": [], "description": ""}, {"id": "e771323e3d2f", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 r;", "highlightLines": [66]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 66, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "557fa588dc22", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 s;", "highlightLines": [67]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 67, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "326e564ac5eb", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint8 v;", "highlightLines": [68]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 68, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e3db68c9f576", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes memory sig = hexstrToBytes(substring(_sig, 2, 132));\n        assembly {\n            r := mload(add(sig, 32))\n            s := mload(add(sig, 64))\n            v := byte(0, mload(add(sig, 96)))\n        }", "highlightLines": [69]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 69, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "4dd1141edf7d", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [70]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 70, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "f41e4c75d099", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            r := mload(add(sig, 32))\n            s := mload(add(sig, 64))", "highlightLines": [71]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 71, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "4b2d9ee717fc", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            s := mload(add(sig, 64))\n            v := byte(0, mload(add(sig, 96)))", "highlightLines": [72]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 72, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "24dde49ef5a7", "fix": {"template": null, "available": false}, "title": "ecrecover is vulnerable to signature malleability - use OpenZeppelin ECDSA", "ruleId": "rules.sol-ecrecover-malleable", "snippet": {"code": "        return ecrecover(prefixedHash, v, r, s);", "highlightLines": [81]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 81, "column": 16}, "severity": "medium", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/utils/cryptography/ECDSA.sol"], "description": ""}, {"id": "781034461fb6", "fix": {"template": null, "available": false}, "title": "ecrecover result not checked for zero address - invalid signatures return address(0)", "ruleId": "rules.sol-ethernaut-ecrecover-no-zero-check", "snippet": {"code": "        return ecrecover(prefixedHash, v, r, s);", "highlightLines": [81]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 81, "column": 16}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-117", "https://swcregistry.io/docs/SWC-122"], "description": ""}, {"id": "18d8db625c6c", "fix": {"template": null, "available": false}, "title": "Signature verification without s-value malleability check - signatures can be replayed with modified s", "ruleId": "rules.sol-ethernaut-signature-malleability", "snippet": {"code": "        return ecrecover(prefixedHash, v, r, s);", "highlightLines": [81]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 81, "column": 16}, "severity": "medium", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/utils/cryptography/ECDSA.sol"], "description": ""}, {"id": "7f30daa9dc7d", "fix": {"template": null, "available": false}, "title": "ECDSA signature without s-value check - signature malleability possible", "ruleId": "rules.sol-signature-malleability", "snippet": {"code": "        return ecrecover(prefixedHash, v, r, s);", "highlightLines": [81]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 81, "column": 16}, "severity": "medium", "references": [], "description": ""}, {"id": "ec0dbcc2340f", "fix": {"template": null, "available": false}, "title": "Signature verification without domain separator - cross-contract replay possible", "ruleId": "rules.sol-signature-no-domain-separator", "snippet": {"code": "        return ecrecover(prefixedHash, v, r, s);", "highlightLines": [81]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 81, "column": 16}, "severity": "medium", "references": [], "description": ""}, {"id": "a548ef26992a", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "    function isSignedBy(bytes32 _hashedMsg, string _sig, address _addr) public pure returns (bool) {\n        require(_addr != 0x0);", "highlightLines": [85]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 85, "column": 5}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "3d09db4614e1", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function isSignedBy(bytes32 _hashedMsg, string _sig, address _addr) public pure returns (bool) {\n        require(_addr != 0x0);\n\n        return _addr == recoverSigner(_hashedMsg, _sig);", "highlightLines": [85]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 85, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "bd94889f33e0", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_addr != 0x0);", "highlightLines": [86]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 86, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "0d807b90c94f", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function hexstrToBytes(string _hexstr) public pure returns (bytes) {\n        uint len = bytes(_hexstr).length;\n        require(len % 2 == 0);\n\n        bytes memory bstr = bytes(new string(len / 2));\n        uint k = 0;\n        string memory s;\n        string memory r;\n        for (uint i = 0; i < len; i += 2) {\n            s = substring(_hexstr, i, i + 1);\n            r = substring(_hexstr, i + 1, i + 2);\n            uint p = parseInt16Char(s) * 16 + parseInt16Char(r);", "highlightLines": [92]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 92, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "182fe87e5c60", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint len = bytes(_hexstr).length;", "highlightLines": [93]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 93, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c2470b66eb8a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint len = bytes(_hexstr).length;\n        require(len % 2 == 0);\n\n        bytes memory bstr = bytes(new string(len / 2));", "highlightLines": [93]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 93, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "dd324ff99dd1", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(len % 2 == 0);", "highlightLines": [94]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 94, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "b6c1836012b5", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes memory bstr = bytes(new string(len / 2));\n        uint k = 0;", "highlightLines": [96]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 96, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "df4e374148c1", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        bytes memory bstr = bytes(new string(len / 2));", "highlightLines": [96]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 96, "column": 35}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "6582d4a5e595", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint k = 0;", "highlightLines": [97]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 97, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7915f9257e81", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint k = 0;\n        string memory s;\n        string memory r;\n        for (uint i = 0; i < len; i += 2) {\n            s = substring(_hexstr, i, i + 1);\n            r = substring(_hexstr, i + 1, i + 2);\n            uint p = parseInt16Char(s) * 16 + parseInt16Char(r);\n            bstr[k++] = uintToBytes32(p)[31];\n        }", "highlightLines": [97]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 97, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "f2342a0d1455", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            s = substring(_hexstr, i, i + 1);\n            r = substring(_hexstr, i + 1, i + 2);", "highlightLines": [101]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 101, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "bc715ed2f220", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            r = substring(_hexstr, i + 1, i + 2);\n            uint p = parseInt16Char(s) * 16 + parseInt16Char(r);", "highlightLines": [102]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 102, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "f6fd613316bc", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint p = parseInt16Char(s) * 16 + parseInt16Char(r);", "highlightLines": [103]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 103, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "39637edc3ede", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            uint p = parseInt16Char(s) * 16 + parseInt16Char(r);\n            bstr[k++] = uintToBytes32(p)[31];", "highlightLines": [103]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 103, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "417f09ce7262", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function parseInt16Char(string _char) public pure returns (uint) {\n        bytes memory bresult = bytes(_char);\n        // bool decimals = false;", "highlightLines": [110]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 110, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "33aa85445e7c", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "            return uint(bresult[0]) - 48;", "highlightLines": [114]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 114, "column": 20}, "severity": "info", "references": [], "description": ""}, {"id": "b55a6692edec", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "            return uint(bresult[0]) - 55;", "highlightLines": [116]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 116, "column": 20}, "severity": "info", "references": [], "description": ""}, {"id": "2bb705391f0f", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "            return uint(bresult[0]) - 87;", "highlightLines": [118]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 118, "column": 20}, "severity": "info", "references": [], "description": ""}, {"id": "a45d522346b7", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function uintToBytes32(uint _uint) public pure returns (bytes b) {\n        b = new bytes(32);", "highlightLines": [126]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 126, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "7c6d52b6dc93", "fix": {"template": null, "available": false}, "title": "View/pure function uses assembly - may modify state unexpectedly", "ruleId": "rules.sol-constant-function-assembly", "snippet": {"code": "    function uintToBytes32(uint _uint) public pure returns (bytes b) {\n        b = new bytes(32);\n        assembly {mstore(add(b, 32), _uint)}", "highlightLines": [126]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 126, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-using-assembly-code"], "description": ""}, {"id": "f0dc5dbc5a72", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        b = new bytes(32);", "highlightLines": [127]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 127, "column": 13}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "9abb1970eebb", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {mstore(add(b, 32), _uint)}", "highlightLines": [128]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 128, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "9b2808a4e6b6", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function toEthereumSignedMessage(string _msg) public pure returns (bytes32) {\n        uint len = bytes(_msg).length;\n        require(len > 0);\n        bytes memory prefix = \"\\x19Ethereum Signed Message:\\n\";", "highlightLines": [133]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 133, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "b19e828f7a12", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint len = bytes(_msg).length;", "highlightLines": [134]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 134, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "496ba13e1af1", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint len = bytes(_msg).length;\n        require(len > 0);\n        bytes memory prefix = \"\\x19Ethereum Signed Message:\\n\";", "highlightLines": [134]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 134, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "de8edee509bb", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(len > 0);", "highlightLines": [135]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 135, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "8233cbfd9ce1", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        return keccak256(abi.encodePacked(prefix, uintToString(len), _msg));", "highlightLines": [137]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 137, "column": 16}, "severity": "high", "references": [], "description": ""}, {"id": "f70946f870b4", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "        return keccak256(abi.encodePacked(prefix, uintToString(len), _msg));", "highlightLines": [137]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 137, "column": 26}, "severity": "medium", "references": [], "description": ""}, {"id": "4eb7a0f5a5e3", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function uintToString(uint _uint) public pure returns (string str) {\n        uint len = 0;\n        uint m = _uint + 0;", "highlightLines": [141]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 141, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "918c5eb857a9", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint len = 0;", "highlightLines": [142]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 142, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "39893aa5758a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint len = 0;\n        uint m = _uint + 0;", "highlightLines": [142]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 142, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "fb2b281a0a85", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint m = _uint + 0;", "highlightLines": [143]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 143, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e670db90aa00", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint m = _uint + 0;\n        while (m != 0) {\n            len++;\n            m /= 10;\n        }\n        bytes memory b = new bytes(len);", "highlightLines": [143]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 143, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "8d9b5820a6c9", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes memory b = new bytes(len);\n        uint i = len - 1;", "highlightLines": [148]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 148, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "1bc6abfed867", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        bytes memory b = new bytes(len);", "highlightLines": [148]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 148, "column": 26}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "7105900906a9", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint i = len - 1;", "highlightLines": [149]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 149, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "1cb480aa2c0f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint i = len - 1;\n        while (_uint != 0) {\n            uint remainder = _uint % 10;\n            _uint = _uint / 10;\n            b[i--] = byte(48 + remainder);\n        }", "highlightLines": [149]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 149, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "5338d5ac35fb", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint remainder = _uint % 10;", "highlightLines": [151]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 151, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "79803b717a85", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            uint remainder = _uint % 10;\n            _uint = _uint / 10;", "highlightLines": [151]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 151, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "6aa29e7f056f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            _uint = _uint / 10;\n            b[i--] = byte(48 + remainder);", "highlightLines": [152]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 152, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "8c0e99745e80", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function substring(string _str, uint _startIndex, uint _endIndex) public pure returns (string) {\n        bytes memory strBytes = bytes(_str);\n        require(_startIndex <= _endIndex);\n        require(_startIndex >= 0);\n        require(_endIndex <= strBytes.length);\n\n        bytes memory result = new bytes(_endIndex - _startIndex);\n        for (uint i = _startIndex; i < _endIndex; i++) {", "highlightLines": [161]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 161, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "64074232f71f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes memory strBytes = bytes(_str);\n        require(_startIndex <= _endIndex);\n        require(_startIndex >= 0);\n        require(_endIndex <= strBytes.length);\n\n        bytes memory result = new bytes(_endIndex - _startIndex);", "highlightLines": [162]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 162, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "47d2e2dd8676", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_startIndex <= _endIndex);", "highlightLines": [163]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 163, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "d59195785183", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_startIndex >= 0);", "highlightLines": [164]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 164, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "0d8405bef6e5", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_endIndex <= strBytes.length);", "highlightLines": [165]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 165, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "dedb490f0eac", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes memory result = new bytes(_endIndex - _startIndex);\n        for (uint i = _startIndex; i < _endIndex; i++) {\n            result[i - _startIndex] = strBytes[i];\n        }", "highlightLines": [167]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 167, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "942274503990", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        bytes memory result = new bytes(_endIndex - _startIndex);", "highlightLines": [167]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 167, "column": 31}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "06dee1d15bb6", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function transfer(address _to, uint256 _value) public returns (bool success) {", "highlightLines": [176]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 176, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "cf210a76192a", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without msg.data.length validation - vulnerable to short address attack padding", "ruleId": "rules.sol-short-address-no-payload-check", "snippet": {"code": "    function transfer(address _to, uint256 _value) public returns (bool success) {", "highlightLines": [176]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 176, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address", "https://vessenes.com/the-erc20-short-address-attack-explained/"], "description": ""}, {"id": "c5d18410eea2", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "    function transfer(address _to, uint256 _value) public returns (bool success) {\n        //Default assumes totalSupply can't be over max (2^256 - 1).\n        //If your token leaves out totalSupply and can issue more tokens as time goes on, you need to check if it doesn't wrap.\n        //Replace the if with this one instead.\n        //require(balances[msg.sender] >= _value && balances[_to] + _value > balances[_to]);\n        require(balances[msg.sender] >= _value);", "highlightLines": [176]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 176, "column": 5}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "101ef7f20d86", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - will never return false, only revert", "ruleId": "rules.sol-return-bool-always-reverts", "snippet": {"code": "    function transfer(address _to, uint256 _value) public returns (bool success) {\n        //Default assumes totalSupply can't be over max (2^256 - 1).\n        //If your token leaves out totalSupply and can issue more tokens as time goes on, you need to check if it doesn't wrap.\n        //Replace the if with this one instead.\n        //require(balances[msg.sender] >= _value && balances[_to] + _value > balances[_to]);\n        require(balances[msg.sender] >= _value);\n        balances[msg.sender] -= _value;\n        balances[_to] += _value;\n        emit Transfer(msg.sender, _to, _value);\n        return true;\n    }", "highlightLines": [176]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 176, "column": 5}, "severity": "info", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "3ec4dabbbeb4", "fix": {"template": null, "available": false}, "title": "Possible incorrect exponentiation - ^ is XOR in Solidity, use ** for power", "ruleId": "rules.sol-incorrect-exponentiation", "snippet": {"code": "        //Default assumes totalSupply can't be over max (2^256 - 1).", "highlightLines": [177]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 177, "column": 58}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-exponentiation"], "description": ""}, {"id": "d7e1a0a51ba6", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(balances[msg.sender] >= _value);", "highlightLines": [181]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 181, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "53d369e793ae", "fix": {"template": null, "available": false}, "title": "ERC20 transferFrom without payload size validation - consider adding onlyPayloadSize modifier", "ruleId": "rules.sol-erc20-missing-payload-modifier", "snippet": {"code": "    function transferFrom(address _from, address _to, uint256 _value) public returns (bool success) {", "highlightLines": [188]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 188, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address"], "description": ""}, {"id": "276ed8ff4221", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function transferFrom(address _from, address _to, uint256 _value) public returns (bool success) {", "highlightLines": [188]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 188, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "41816c0f5041", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "    function transferFrom(address _from, address _to, uint256 _value) public returns (bool success) {\n        //same as above. Replace this line with the following if you want to protect against wrapping uints.\n        //require(balances[_from] >= _value && allowed[_from][msg.sender] >= _value && balances[_to] + _value > balances[_to]);\n        require(balances[_from] >= _value && allowed[_from][msg.sender] >= _value);", "highlightLines": [188]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 188, "column": 5}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "1826052eab3e", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - will never return false, only revert", "ruleId": "rules.sol-return-bool-always-reverts", "snippet": {"code": "    function transferFrom(address _from, address _to, uint256 _value) public returns (bool success) {\n        //same as above. Replace this line with the following if you want to protect against wrapping uints.\n        //require(balances[_from] >= _value && allowed[_from][msg.sender] >= _value && balances[_to] + _value > balances[_to]);\n        require(balances[_from] >= _value && allowed[_from][msg.sender] >= _value);\n        balances[_to] += _value;\n        balances[_from] -= _value;\n        allowed[_from][msg.sender] -= _value;\n        emit Transfer(_from, _to, _value);\n        return true;\n    }", "highlightLines": [188]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 188, "column": 5}, "severity": "info", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "13d2ea34f8b6", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(balances[_from] >= _value && allowed[_from][msg.sender] >= _value);", "highlightLines": [191]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 191, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "e5a2d7254cd9", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function approve(address _spender, uint256 _value) public returns (bool success) {", "highlightLines": [203]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 203, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "4ab195e6c8c8", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract HumanStandardToken is StandardToken {\n\n    /* Public variables of the token */\n\n    /*\n    NOTE:\n    The following variables are OPTIONAL vanities. One does not have to include them.\n    They allow one to customise the token contract & in no way influences the core functionality.\n    Some wallets/interfaces might not even bother to look at this information.\n    */\n    string public name;                   //fancy name: eg Simon Bucks\n    uint8 public decimals;                //How many decimals to show. ie. There could 1000 base units with 3 decimals. Meaning 0.980 SBX = 980 base units. It's like comparing 1 wei to 1 ether.\n    string public symbol;                 //An identifier: eg SBX\n    string public version = 'H0.1';       //human 0.1 standard. Just an arbitrary versioning scheme.", "highlightLines": [217]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 217, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "c04b5c54ddde", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        balances[msg.sender] = _initialAmount;               // Give the creator all initial tokens\n        totalSupply = _initialAmount;                        // Update total supply", "highlightLines": [238]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 238, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "5becccd60c65", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        totalSupply = _initialAmount;                        // Update total supply\n        name = _tokenName;                                   // Set the name for display purposes", "highlightLines": [239]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 239, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "33b3fd34afd5", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        name = _tokenName;                                   // Set the name for display purposes\n        decimals = _decimalUnits;                            // Amount of decimals for display purposes", "highlightLines": [240]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 240, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "fc69a4dbb412", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        decimals = _decimalUnits;                            // Amount of decimals for display purposes\n        symbol = _tokenSymbol;                               // Set the symbol for display purposes", "highlightLines": [241]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 241, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "4e286f6005ae", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "    function approveAndCall(address _spender, uint256 _value, bytes _extraData) public returns (bool success) {\n        allowed[msg.sender][_spender] = _value;\n        emit Approval(msg.sender, _spender, _value);\n\n        //call the receiveApproval function on the contract you want to be notified. This crafts the function signature manually so one doesn't have to include a contract in here just for this.\n        //receiveApproval(address _from, uint256 _value, address _tokenContract, bytes _extraData)\n        //it is assumed that when does this that the call *should* succeed, otherwise one would use vanilla approve instead.\n        require(_spender.call(bytes4(bytes32(keccak256(\"receiveApproval(address,uint256,address,bytes)\"))), msg.sender, _value, this, _extraData));", "highlightLines": [246]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 246, "column": 5}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "7819c9b85b81", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - will never return false, only revert", "ruleId": "rules.sol-return-bool-always-reverts", "snippet": {"code": "    function approveAndCall(address _spender, uint256 _value, bytes _extraData) public returns (bool success) {\n        allowed[msg.sender][_spender] = _value;\n        emit Approval(msg.sender, _spender, _value);\n\n        //call the receiveApproval function on the contract you want to be notified. This crafts the function signature manually so one doesn't have to include a contract in here just for this.\n        //receiveApproval(address _from, uint256 _value, address _tokenContract, bytes _extraData)\n        //it is assumed that when does this that the call *should* succeed, otherwise one would use vanilla approve instead.\n        require(_spender.call(bytes4(bytes32(keccak256(\"receiveApproval(address,uint256,address,bytes)\"))), msg.sender, _value, this, _extraData));\n        return true;\n    }", "highlightLines": [246]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 246, "column": 5}, "severity": "info", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "5722236c0feb", "fix": {"template": null, "available": false}, "title": "approveAndCall pattern enables callback attacks - verify callback target", "ruleId": "rules.sol-approve-and-call-callback", "snippet": {"code": "    function approveAndCall(address _spender, uint256 _value, bytes _extraData) public returns (bool success) {", "highlightLines": [246]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 246, "column": 14}, "severity": "medium", "references": [], "description": ""}, {"id": "876ecc9fe194", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_spender.call(bytes4(bytes32(keccak256(\"receiveApproval(address,uint256,address,bytes)\"))), msg.sender, _value, this, _extraData));", "highlightLines": [253]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 253, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "548076e5eabe", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "        require(_spender.call(bytes4(bytes32(keccak256(\"receiveApproval(address,uint256,address,bytes)\"))), msg.sender, _value, this, _extraData));", "highlightLines": [253]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 253, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "161737bc38c6", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event DidLCOpen (\n        bytes32 indexed channelId,\n        address indexed partyA,\n        address indexed partyI,\n        uint256 ethBalanceA,\n        address token,\n        uint256 tokenBalanceA,\n        uint256 LCopenTimeout\n    );", "highlightLines": [265]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 265, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "ee47123ea87b", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event DidLCJoin (\n        bytes32 indexed channelId,\n        uint256 ethBalanceI,\n        uint256 tokenBalanceI\n    );", "highlightLines": [275]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 275, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "f80bfd40b3c5", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event DidLCDeposit (\n        bytes32 indexed channelId,\n        address indexed recipient,\n        uint256 deposit,\n        bool isToken\n    );", "highlightLines": [281]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 281, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "4b3f07cb9b44", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event DidLCUpdateState (\n        bytes32 indexed channelId, \n        uint256 sequence, \n        uint256 numOpenVc, \n        uint256 ethBalanceA,\n        uint256 tokenBalanceA,\n        uint256 ethBalanceI,\n        uint256 tokenBalanceI,\n        bytes32 vcRoot,\n        uint256 updateLCtimeout\n    );", "highlightLines": [288]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 288, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "64499e219b23", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event DidLCClose (\n        bytes32 indexed channelId,\n        uint256 sequence,\n        uint256 ethBalanceA,\n        uint256 tokenBalanceA,\n        uint256 ethBalanceI,\n        uint256 tokenBalanceI\n    );", "highlightLines": [300]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 300, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "13fc8cbdf182", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event DidVCInit (\n        bytes32 indexed lcId, \n        bytes32 indexed vcId, \n        bytes proof, \n        uint256 sequence, \n        address partyA, \n        address partyB, \n        uint256 balanceA, \n        uint256 balanceB \n    );", "highlightLines": [309]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 309, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "20e9986b7e1b", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event DidVCSettle (\n        bytes32 indexed lcId, \n        bytes32 indexed vcId,\n        uint256 updateSeq, \n        uint256 updateBalA, \n        uint256 updateBalB,\n        address challenger,\n        uint256 updateVCtimeout\n    );", "highlightLines": [320]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 320, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "f33c2570b53e", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event DidVCClose(\n        bytes32 indexed lcId, \n        bytes32 indexed vcId, \n        uint256 balanceA, \n        uint256 balanceB\n    );", "highlightLines": [330]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 330, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "387500b998be", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 sequence;", "highlightLines": [343]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 343, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "1d4e73ec2edb", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 confirmTime;", "highlightLines": [344]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 344, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d651ccd9be28", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 VCrootHash;", "highlightLines": [345]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 345, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b425faa1997f", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 LCopenTimeout;", "highlightLines": [346]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 346, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "edc8e0cda966", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 updateLCtimeout; // when update LC times out", "highlightLines": [347]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 347, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "164ea278547c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool isOpen; // true when both parties have joined", "highlightLines": [348]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 348, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "de2ed8473607", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool isUpdateLCSettling;", "highlightLines": [349]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 349, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "899d1bb3242f", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 numOpenVC;", "highlightLines": [350]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 350, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "94718bbe2921", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool isClose;", "highlightLines": [356]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 356, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "02c474590cdd", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool isInSettlementState;", "highlightLines": [357]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 357, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "2049762dfa4a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 sequence;", "highlightLines": [358]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 358, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d55f431b82aa", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address challenger; // Initiator of challenge", "highlightLines": [359]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 359, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "061880e5a16e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 updateVCtimeout; // when update VC times out", "highlightLines": [360]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 360, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "86e0473255a6", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address partyA; // VC participant A", "highlightLines": [362]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 362, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "046f0971f909", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address partyB; // VC participant B", "highlightLines": [363]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 363, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0915d33a2ca2", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address partyI; // LC hub", "highlightLines": [364]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 364, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b0f2a36e2da1", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        Channels[_lcID].partyAddresses[0] = msg.sender;\n        Channels[_lcID].partyAddresses[1] = _partyI;", "highlightLines": [391]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 391, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "4bfd86ddd784", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        Channels[_lcID].partyAddresses[1] = _partyI;\n\n        if(_balances[0] != 0) {\n            require(msg.value == _balances[0], \"Eth balance does not match sent value\");\n            Channels[_lcID].ethBalances[0] = msg.value;\n        }", "highlightLines": [392]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 392, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e27ab1353d17", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            Channels[_lcID].token = HumanStandardToken(_token);\n            require(Channels[_lcID].token.transferFrom(msg.sender, this, _balances[1]),\"CreateChannel: token transfer failure\");\n            Channels[_lcID].erc20Balances[0] = _balances[1];", "highlightLines": [399]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 399, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "af2c77e3689c", "fix": {"template": null, "available": false}, "title": "Token transfer without checking actual received amount - deflationary tokens may transfer less", "ruleId": "rules.sol-deflationary-token-transfer", "snippet": {"code": "            require(Channels[_lcID].token.transferFrom(msg.sender, this, _balances[1]),\"CreateChannel: token transfer failure\");", "highlightLines": [400]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 400, "column": 21}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "41ea1a910087", "fix": {"template": null, "available": false}, "title": "Token amount after transfer may differ - check actual received amount", "ruleId": "rules.sol-fee-on-transfer-token", "snippet": {"code": "            require(Channels[_lcID].token.transferFrom(msg.sender, this, _balances[1]),\"CreateChannel: token transfer failure\");", "highlightLines": [400]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 400, "column": 21}, "severity": "info", "references": [], "description": ""}, {"id": "0141c8d1a92e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        Channels[_lcID].sequence = 0;\n        Channels[_lcID].confirmTime = _confirmTime;", "highlightLines": [404]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 404, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "77dac58e92d9", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        Channels[_lcID].confirmTime = _confirmTime;\n        // is close flag, lc state sequence, number open vc, vc root hash, partyA... \n        //Channels[_lcID].stateHash = keccak256(uint256(0), uint256(0), uint256(0), bytes32(0x0), bytes32(msg.sender), bytes32(_partyI), balanceA, balanceI);\n        Channels[_lcID].LCopenTimeout = now + _confirmTime;", "highlightLines": [405]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 405, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "cefe99420c11", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        Channels[_lcID].LCopenTimeout = now + _confirmTime;\n        Channels[_lcID].initialDeposit = _balances;", "highlightLines": [408]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 408, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "921a5ca9538e", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender == Channels[_lcID].partyAddresses[0] && Channels[_lcID].isOpen == false);", "highlightLines": [415]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 415, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "a2406aebdd53", "fix": {"template": null, "available": false}, "title": "Unnecessary comparison to boolean constant - use variable directly", "ruleId": "rules.sol-boolean-constant-comparison", "snippet": {"code": "        require(msg.sender == Channels[_lcID].partyAddresses[0] && Channels[_lcID].isOpen == false);", "highlightLines": [415]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 415, "column": 91}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#boolean-equality"], "description": ""}, {"id": "644181c775b2", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(now > Channels[_lcID].LCopenTimeout);", "highlightLines": [416]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 416, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "7e61243f62ce", "fix": {"template": null, "available": false}, "title": "Block timestamp used for critical logic - miners can manipulate within ~15 second window", "ruleId": "rules.sol-block-timestamp-manipulation", "snippet": {"code": "        require(now > Channels[_lcID].LCopenTimeout);", "highlightLines": [416]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 416, "column": 17}, "severity": "medium", "references": ["https://consensys.github.io/smart-contract-best-practices/development-recommendations/solidity-specific/timestamp-dependence/"], "description": ""}, {"id": "52dbdeb69e0e", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "            Channels[_lcID].partyAddresses[0].transfer(Channels[_lcID].ethBalances[0]);", "highlightLines": [419]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 419, "column": 13}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "b4e64bef1bd9", "fix": {"template": null, "available": false}, "title": "Deleting mapping inside struct leaves nested data - use separate mapping deletion", "ruleId": "rules.sol-mapping-deletion", "snippet": {"code": "        delete Channels[_lcID];", "highlightLines": [428]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 428, "column": 9}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#deletion-on-mapping-containing-a-structure"], "description": ""}, {"id": "bc6bccdfb53d", "fix": {"template": null, "available": false}, "title": "delete array[i] leaves gap with zero value - use swap-and-pop pattern instead", "ruleId": "rules.sol-array-element-delete", "snippet": {"code": "        delete Channels[_lcID];", "highlightLines": [428]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 428, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/Array-deletion.sol"], "description": ""}, {"id": "3a65de8bd4a5", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(Channels[_lcID].isOpen == false);", "highlightLines": [433]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 433, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "d95bb9bef134", "fix": {"template": null, "available": false}, "title": "Unnecessary comparison to boolean constant - use variable directly", "ruleId": "rules.sol-boolean-constant-comparison", "snippet": {"code": "        require(Channels[_lcID].isOpen == false);", "highlightLines": [433]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 433, "column": 40}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#boolean-equality"], "description": ""}, {"id": "246dfd4f578a", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender == Channels[_lcID].partyAddresses[1]);", "highlightLines": [434]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 434, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "16246a04b12e", "fix": {"template": null, "available": false}, "title": "Token transfer without checking actual received amount - deflationary tokens may transfer less", "ruleId": "rules.sol-deflationary-token-transfer", "snippet": {"code": "            require(Channels[_lcID].token.transferFrom(msg.sender, this, _balances[1]),\"joinChannel: token transfer failure\");", "highlightLines": [441]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 441, "column": 21}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "0979118c3479", "fix": {"template": null, "available": false}, "title": "Token amount after transfer may differ - check actual received amount", "ruleId": "rules.sol-fee-on-transfer-token", "snippet": {"code": "            require(Channels[_lcID].token.transferFrom(msg.sender, this, _balances[1]),\"joinChannel: token transfer failure\");", "highlightLines": [441]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 441, "column": 21}, "severity": "info", "references": [], "description": ""}, {"id": "24547eac3084", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function deposit(bytes32 _lcID, address recipient, uint256 _balance, bool isToken) public payable {", "highlightLines": [457]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 457, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "6595e8665a28", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function deposit(bytes32 _lcID, address recipient, uint256 _balance, bool isToken) public payable {\n        require(Channels[_lcID].isOpen == true, \"Tried adding funds to a closed channel\");\n        require(recipient == Channels[_lcID].partyAddresses[0] || recipient == Channels[_lcID].partyAddresses[1]);", "highlightLines": [457]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 457, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "51790aed83be", "fix": {"template": null, "available": false}, "title": "Token transfer without before/after balance comparison - rebasing/fee tokens may transfer different amounts", "ruleId": "rules.sol-no-balance-before-after", "snippet": {"code": "    function deposit(bytes32 _lcID, address recipient, uint256 _balance, bool isToken) public payable {\n        require(Channels[_lcID].isOpen == true, \"Tried adding funds to a closed channel\");\n        require(recipient == Channels[_lcID].partyAddresses[0] || recipient == Channels[_lcID].partyAddresses[1]);\n\n        //if(Channels[_lcID].token)\n\n        if (Channels[_lcID].partyAddresses[0] == recipient) {\n            if(isToken) {\n                require(Channels[_lcID].token.transferFrom(msg.sender, this, _balance),\"deposit: token transfer failure\");", "highlightLines": [457]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 457, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "fc3adcaba603", "fix": {"template": null, "available": false}, "title": "ERC777 token interaction without reentrancy guard - token hooks can reenter", "ruleId": "rules.sol-erc777-without-reentrancy-guard", "snippet": {"code": "    function deposit(bytes32 _lcID, address recipient, uint256 _balance, bool isToken) public payable {\n        require(Channels[_lcID].isOpen == true, \"Tried adding funds to a closed channel\");\n        require(recipient == Channels[_lcID].partyAddresses[0] || recipient == Channels[_lcID].partyAddresses[1]);\n\n        //if(Channels[_lcID].token)\n\n        if (Channels[_lcID].partyAddresses[0] == recipient) {\n            if(isToken) {\n                require(Channels[_lcID].token.transferFrom(msg.sender, this, _balance),\"deposit: token transfer failure\");", "highlightLines": [457]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 457, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "19622935e809", "fix": {"template": null, "available": false}, "title": "Unnecessary comparison to boolean constant - use variable directly", "ruleId": "rules.sol-boolean-constant-comparison", "snippet": {"code": "        require(Channels[_lcID].isOpen == true, \"Tried adding funds to a closed channel\");", "highlightLines": [458]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 458, "column": 40}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#boolean-equality"], "description": ""}, {"id": "c942bf6fb992", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(recipient == Channels[_lcID].partyAddresses[0] || recipient == Channels[_lcID].partyAddresses[1]);", "highlightLines": [459]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 459, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "69e8a39ed61d", "fix": {"template": null, "available": false}, "title": "Token transfer without checking actual received amount - deflationary tokens may transfer less", "ruleId": "rules.sol-deflationary-token-transfer", "snippet": {"code": "                require(Channels[_lcID].token.transferFrom(msg.sender, this, _balance),\"deposit: token transfer failure\");", "highlightLines": [465]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 465, "column": 25}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "d5a7a443a9af", "fix": {"template": null, "available": false}, "title": "Token amount after transfer may differ - check actual received amount", "ruleId": "rules.sol-fee-on-transfer-token", "snippet": {"code": "                require(Channels[_lcID].token.transferFrom(msg.sender, this, _balance),\"deposit: token transfer failure\");", "highlightLines": [465]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 465, "column": 25}, "severity": "info", "references": [], "description": ""}, {"id": "c177a76b982c", "fix": {"template": null, "available": false}, "title": "Token transfer without checking actual received amount - deflationary tokens may transfer less", "ruleId": "rules.sol-deflationary-token-transfer", "snippet": {"code": "                require(Channels[_lcID].token.transferFrom(msg.sender, this, _balance),\"deposit: token transfer failure\");", "highlightLines": [475]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 475, "column": 25}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "459004447fc5", "fix": {"template": null, "available": false}, "title": "Token amount after transfer may differ - check actual received amount", "ruleId": "rules.sol-fee-on-transfer-token", "snippet": {"code": "                require(Channels[_lcID].token.transferFrom(msg.sender, this, _balance),\"deposit: token transfer failure\");", "highlightLines": [475]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 475, "column": 25}, "severity": "info", "references": [], "description": ""}, {"id": "b097e1563dae", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(Channels[_lcID].isOpen == true);", "highlightLines": [498]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 498, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "84d306831abb", "fix": {"template": null, "available": false}, "title": "Unnecessary comparison to boolean constant - use variable directly", "ruleId": "rules.sol-boolean-constant-comparison", "snippet": {"code": "        require(Channels[_lcID].isOpen == true);", "highlightLines": [498]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 498, "column": 40}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#boolean-equality"], "description": ""}, {"id": "57e07908d35d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 totalEthDeposit = Channels[_lcID].initialDeposit[0] + Channels[_lcID].ethBalances[2] + Channels[_lcID].ethBalances[3];", "highlightLines": [499]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 499, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "266555f3c5b5", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "        uint256 totalEthDeposit = Channels[_lcID].initialDeposit[0] + Channels[_lcID].ethBalances[2] + Channels[_lcID].ethBalances[3];", "highlightLines": [499]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 499, "column": 9}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "37cb356ce744", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 totalEthDeposit = Channels[_lcID].initialDeposit[0] + Channels[_lcID].ethBalances[2] + Channels[_lcID].ethBalances[3];\n        uint256 totalTokenDeposit = Channels[_lcID].initialDeposit[1] + Channels[_lcID].erc20Balances[2] + Channels[_lcID].erc20Balances[3];", "highlightLines": [499]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 499, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "6304b93a3d33", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 totalTokenDeposit = Channels[_lcID].initialDeposit[1] + Channels[_lcID].erc20Balances[2] + Channels[_lcID].erc20Balances[3];", "highlightLines": [500]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 500, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4d20e99a2d99", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "        uint256 totalTokenDeposit = Channels[_lcID].initialDeposit[1] + Channels[_lcID].erc20Balances[2] + Channels[_lcID].erc20Balances[3];", "highlightLines": [500]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 500, "column": 9}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "753e77b38e78", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 totalTokenDeposit = Channels[_lcID].initialDeposit[1] + Channels[_lcID].erc20Balances[2] + Channels[_lcID].erc20Balances[3];\n        require(totalEthDeposit == _balances[0] + _balances[1]);\n        require(totalTokenDeposit == _balances[2] + _balances[3]);\n\n        bytes32 _state = keccak256(\n            abi.encodePacked(\n                _lcID,\n                true,\n                _sequence,\n                uint256(0),\n                bytes32(0x0),\n                Channels[_lcID].partyAddresses[0], \n                Channels[_lcID].partyAddresses[1], \n                _balances[0], \n                _balances[1],\n                _balances[2],\n                _balances[3]\n            )\n        );", "highlightLines": [500]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 500, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "337cd214907d", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(totalEthDeposit == _balances[0] + _balances[1]);", "highlightLines": [501]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 501, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "be44ff9493b9", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(totalTokenDeposit == _balances[2] + _balances[3]);", "highlightLines": [502]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 502, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "cc87499e6141", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        bytes32 _state = keccak256(", "highlightLines": [503]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 503, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3acf7b023938", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes32 _state = keccak256(\n            abi.encodePacked(\n                _lcID,\n                true,\n                _sequence,\n                uint256(0),\n                bytes32(0x0),\n                Channels[_lcID].partyAddresses[0], \n                Channels[_lcID].partyAddresses[1], \n                _balances[0], \n                _balances[1],\n                _balances[2],\n                _balances[3]\n            )\n        );\n\n        require(Channels[_lcID].partyAddresses[0] == ECTools.recoverSigner(_state, _sigA));\n        require(Channels[_lcID].partyAddresses[1] == ECTools.recoverSigner(_state, _sigI));\n\n        Channels[_lcID].isOpen = false;", "highlightLines": [504]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 504, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e45ab85f667e", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        bytes32 _state = keccak256(\n            abi.encodePacked(\n                _lcID,\n                true,\n                _sequence,\n                uint256(0),\n                bytes32(0x0),\n                Channels[_lcID].partyAddresses[0], \n                Channels[_lcID].partyAddresses[1], \n                _balances[0], \n                _balances[1],\n                _balances[2],\n                _balances[3]\n            )\n        );", "highlightLines": [504]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 504, "column": 26}, "severity": "high", "references": [], "description": ""}, {"id": "44653711084e", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "            abi.encodePacked(\n                _lcID,\n                true,\n                _sequence,\n                uint256(0),\n                bytes32(0x0),\n                Channels[_lcID].partyAddresses[0], \n                Channels[_lcID].partyAddresses[1], \n                _balances[0], \n                _balances[1],\n                _balances[2],\n                _balances[3]\n            )", "highlightLines": [505]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 505, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "661972971911", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(Channels[_lcID].partyAddresses[0] == ECTools.recoverSigner(_state, _sigA));", "highlightLines": [520]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 520, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "362f7dcd503f", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(Channels[_lcID].partyAddresses[1] == ECTools.recoverSigner(_state, _sigI));", "highlightLines": [521]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 521, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "5c5ca3ae8c40", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "            Channels[_lcID].partyAddresses[0].transfer(_balances[0]);", "highlightLines": [526]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 526, "column": 13}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "bfac289a0153", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "            Channels[_lcID].partyAddresses[1].transfer(_balances[1]);", "highlightLines": [527]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 527, "column": 13}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "5d508ce1061d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        Channel storage channel = Channels[_lcID];\n        require(channel.isOpen);\n        require(channel.sequence < updateParams[0]); // do same as vc sequence check\n        require(channel.ethBalances[0] + channel.ethBalances[1] >= updateParams[2] + updateParams[3]);\n        require(channel.erc20Balances[0] + channel.erc20Balances[1] >= updateParams[4] + updateParams[5]);\n\n        if(channel.isUpdateLCSettling == true) { \n            require(channel.updateLCtimeout > now);\n        }\n      \n        bytes32 _state = keccak256(\n            abi.encodePacked(\n                _lcID,\n                false, \n                updateParams[0], \n                updateParams[1], \n                _VCroot, \n                channel.partyAddresses[0], \n                channel.partyAddresses[1], \n                updateParams[2], \n                updateParams[3],\n                updateParams[4], \n                updateParams[5]\n            )\n        );", "highlightLines": [551]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 551, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "8f8e2754a4d8", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(channel.isOpen);", "highlightLines": [552]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 552, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "21fe9ee386a9", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(channel.sequence < updateParams[0]); // do same as vc sequence check", "highlightLines": [553]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 553, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "81fe7ebbbeb9", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(channel.ethBalances[0] + channel.ethBalances[1] >= updateParams[2] + updateParams[3]);", "highlightLines": [554]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 554, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "b4d7a0f2fa64", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(channel.erc20Balances[0] + channel.erc20Balances[1] >= updateParams[4] + updateParams[5]);", "highlightLines": [555]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 555, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "a83c34a78b27", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "        if(channel.isUpdateLCSettling == true) { \n            require(channel.updateLCtimeout > now);\n        }", "highlightLines": [557]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 557, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e1216b744bb7", "fix": {"template": null, "available": false}, "title": "Unnecessary comparison to boolean constant - use variable directly", "ruleId": "rules.sol-boolean-constant-comparison", "snippet": {"code": "        if(channel.isUpdateLCSettling == true) {", "highlightLines": [557]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 557, "column": 39}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#boolean-equality"], "description": ""}, {"id": "5235109845de", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "            require(channel.updateLCtimeout > now);", "highlightLines": [558]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 558, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "de90f990b6d1", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "      \n        bytes32 _state = keccak256(", "highlightLines": [560]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 560, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "cafb7459cef6", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes32 _state = keccak256(\n            abi.encodePacked(\n                _lcID,\n                false, \n                updateParams[0], \n                updateParams[1], \n                _VCroot, \n                channel.partyAddresses[0], \n                channel.partyAddresses[1], \n                updateParams[2], \n                updateParams[3],\n                updateParams[4], \n                updateParams[5]\n            )\n        );\n\n        require(channel.partyAddresses[0] == ECTools.recoverSigner(_state, _sigA));\n        require(channel.partyAddresses[1] == ECTools.recoverSigner(_state, _sigI));\n\n        // update LC state\n        channel.sequence = updateParams[0];", "highlightLines": [561]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 561, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "f66148f2e0a2", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        bytes32 _state = keccak256(\n            abi.encodePacked(\n                _lcID,\n                false, \n                updateParams[0], \n                updateParams[1], \n                _VCroot, \n                channel.partyAddresses[0], \n                channel.partyAddresses[1], \n                updateParams[2], \n                updateParams[3],\n                updateParams[4], \n                updateParams[5]\n            )\n        );", "highlightLines": [561]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 561, "column": 26}, "severity": "high", "references": [], "description": ""}, {"id": "a20f50d7d953", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "            abi.encodePacked(\n                _lcID,\n                false, \n                updateParams[0], \n                updateParams[1], \n                _VCroot, \n                channel.partyAddresses[0], \n                channel.partyAddresses[1], \n                updateParams[2], \n                updateParams[3],\n                updateParams[4], \n                updateParams[5]\n            )", "highlightLines": [562]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 562, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "4f92639fc4f6", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(channel.partyAddresses[0] == ECTools.recoverSigner(_state, _sigA));", "highlightLines": [577]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 577, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "9e85113017bf", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(channel.partyAddresses[1] == ECTools.recoverSigner(_state, _sigI));", "highlightLines": [578]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 578, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "09f26ec62a4e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        channel.sequence = updateParams[0];\n        channel.numOpenVC = updateParams[1];", "highlightLines": [581]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 581, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "bbc6a798d6b2", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        channel.numOpenVC = updateParams[1];\n        channel.ethBalances[0] = updateParams[2];", "highlightLines": [582]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 582, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "5924de585348", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        channel.ethBalances[0] = updateParams[2];\n        channel.ethBalances[1] = updateParams[3];", "highlightLines": [583]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 583, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "70a1c8edbbf4", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        channel.ethBalances[1] = updateParams[3];\n        channel.erc20Balances[0] = updateParams[4];", "highlightLines": [584]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 584, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "a20e60e4598d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        channel.erc20Balances[0] = updateParams[4];\n        channel.erc20Balances[1] = updateParams[5];", "highlightLines": [585]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 585, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "9841bb3f81bb", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        channel.erc20Balances[1] = updateParams[5];\n        channel.VCrootHash = _VCroot;", "highlightLines": [586]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 586, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "82b4369856a9", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        channel.VCrootHash = _VCroot;\n        channel.isUpdateLCSettling = true;", "highlightLines": [587]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 587, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "cbfeccf99c37", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        channel.isUpdateLCSettling = true;\n        channel.updateLCtimeout = now + channel.confirmTime;", "highlightLines": [588]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 588, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "35c9803ce318", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function initVCstate(\n        bytes32 _lcID, \n        bytes32 _vcID, \n        bytes _proof, \n        address _partyA, \n        address _partyB, \n        uint256[2] _bond,\n        uint256[4] _balances, // 0: ethBalanceA 1:ethBalanceI 2:tokenBalanceA 3:tokenBalanceI\n        string sigA\n    ) \n        public \n    {\n        require(Channels[_lcID].isOpen, \"LC is closed.\");\n        // sub-channel must be open\n        require(!virtualChannels[_vcID].isClose, \"VC is closed.\");\n        // Check time has passed on updateLCtimeout and has not passed the time to store a vc state\n        require(Channels[_lcID].updateLCtimeout < now, \"LC timeout not over.\");\n        // prevent rentry of initializing vc state\n        require(virtualChannels[_vcID].updateVCtimeout == 0);\n        // partyB is now Ingrid\n        bytes32 _initState = keccak256(\n            abi.encodePacked(_vcID, uint256(0), _partyA, _partyB, _bond[0], _bond[1], _balances[0], _balances[1], _balances[2], _balances[3])\n        );\n\n        // Make sure Alice has signed initial vc state (A/B in oldState)\n        require(_partyA == ECTools.recoverSigner(_initState, sigA));", "highlightLines": [607]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 607, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "3c53ffd27799", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(virtualChannels[_vcID].updateVCtimeout == 0);", "highlightLines": [625]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 625, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "a92e5dc561fe", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 _initState = keccak256(", "highlightLines": [627]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 627, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "659469e5abc2", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes32 _initState = keccak256(\n            abi.encodePacked(_vcID, uint256(0), _partyA, _partyB, _bond[0], _bond[1], _balances[0], _balances[1], _balances[2], _balances[3])\n        );\n\n        // Make sure Alice has signed initial vc state (A/B in oldState)\n        require(_partyA == ECTools.recoverSigner(_initState, sigA));\n\n        // Check the oldState is in the root hash\n        require(_isContained(_initState, _proof, Channels[_lcID].VCrootHash) == true);\n\n        virtualChannels[_vcID].partyA = _partyA; // VC participant A", "highlightLines": [627]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 627, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "58f300ca71e4", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        bytes32 _initState = keccak256(\n            abi.encodePacked(_vcID, uint256(0), _partyA, _partyB, _bond[0], _bond[1], _balances[0], _balances[1], _balances[2], _balances[3])\n        );", "highlightLines": [627]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 627, "column": 30}, "severity": "high", "references": [], "description": ""}, {"id": "d1136353aaee", "fix": {"template": null, "available": false}, "title": "Signature verification without EIP-712 domain separator - vulnerable to cross-chain/cross-contract replay", "ruleId": "rules.sol-ethernaut-missing-eip712-domain", "snippet": {"code": "        bytes32 _initState = keccak256(\n            abi.encodePacked(_vcID, uint256(0), _partyA, _partyB, _bond[0], _bond[1], _balances[0], _balances[1], _balances[2], _balances[3])\n        );", "highlightLines": [627]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 627, "column": 30}, "severity": "high", "references": ["https://eips.ethereum.org/EIPS/eip-712", "https://ethernaut.openzeppelin.com/"], "description": ""}, {"id": "b53ebbab4c39", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "            abi.encodePacked(_vcID, uint256(0), _partyA, _partyB, _bond[0], _bond[1], _balances[0], _balances[1], _balances[2], _balances[3])", "highlightLines": [628]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 628, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "3b1a51873d6e", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_partyA == ECTools.recoverSigner(_initState, sigA));", "highlightLines": [632]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 632, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "c2fc7f6c609a", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_isContained(_initState, _proof, Channels[_lcID].VCrootHash) == true);", "highlightLines": [635]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 635, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "3fa857d0e629", "fix": {"template": null, "available": false}, "title": "Unnecessary comparison to boolean constant - use variable directly", "ruleId": "rules.sol-boolean-constant-comparison", "snippet": {"code": "        require(_isContained(_initState, _proof, Channels[_lcID].VCrootHash) == true);", "highlightLines": [635]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 635, "column": 78}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#boolean-equality"], "description": ""}, {"id": "f57242659ff0", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        virtualChannels[_vcID].partyA = _partyA; // VC participant A\n        virtualChannels[_vcID].partyB = _partyB; // VC participant B", "highlightLines": [637]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 637, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "4cb55dac12a6", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        virtualChannels[_vcID].partyB = _partyB; // VC participant B\n        virtualChannels[_vcID].sequence = uint256(0);", "highlightLines": [638]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 638, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "84ceda1c64b2", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        virtualChannels[_vcID].sequence = uint256(0);\n        virtualChannels[_vcID].ethBalances[0] = _balances[0];", "highlightLines": [639]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 639, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "42235fb6e880", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        virtualChannels[_vcID].ethBalances[0] = _balances[0];\n        virtualChannels[_vcID].ethBalances[1] = _balances[1];", "highlightLines": [640]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 640, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "127638128e80", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        virtualChannels[_vcID].ethBalances[1] = _balances[1];\n        virtualChannels[_vcID].erc20Balances[0] = _balances[2];", "highlightLines": [641]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 641, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "c53fd15d9b3f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        virtualChannels[_vcID].erc20Balances[0] = _balances[2];\n        virtualChannels[_vcID].erc20Balances[1] = _balances[3];", "highlightLines": [642]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 642, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "463c2ca2deb7", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        virtualChannels[_vcID].erc20Balances[1] = _balances[3];\n        virtualChannels[_vcID].bond = _bond;", "highlightLines": [643]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 643, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "21dc601c2477", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        virtualChannels[_vcID].bond = _bond;\n        virtualChannels[_vcID].updateVCtimeout = now + Channels[_lcID].confirmTime;", "highlightLines": [644]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 644, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "3e8307439035", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        virtualChannels[_vcID].updateVCtimeout = now + Channels[_lcID].confirmTime;\n        virtualChannels[_vcID].isInSettlementState = true;", "highlightLines": [645]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 645, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "9b9b58616140", "fix": {"template": null, "available": false}, "title": "Storage write without access control - arbitrary data manipulation", "ruleId": "rules.sol-unprotected-storage-write", "snippet": {"code": "    function settleVC(\n        bytes32 _lcID, \n        bytes32 _vcID, \n        uint256 updateSeq, \n        address _partyA, \n        address _partyB,\n        uint256[4] updateBal, // [ethupdateBalA, ethupdateBalB, tokenupdateBalA, tokenupdateBalB]\n        string sigA\n    ) \n        public \n    {", "highlightLines": [654]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 654, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "cc5dd674f06c", "fix": {"template": null, "available": false}, "title": "Block timestamp used for critical logic - miners can manipulate within ~15 second window", "ruleId": "rules.sol-block-timestamp-manipulation", "snippet": {"code": "        // require(Channels[_lcID].updateLCtimeout < now && now < virtualChannels[_vcID].updateVCtimeout);", "highlightLines": [680]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 680, "column": 61}, "severity": "medium", "references": ["https://consensys.github.io/smart-contract-best-practices/development-recommendations/solidity-specific/timestamp-dependence/"], "description": ""}, {"id": "4ead37a15b65", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(Channels[_lcID].updateLCtimeout < now); // for testing!", "highlightLines": [681]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 681, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "be14a3e134ca", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        bytes32 _updateState = keccak256(", "highlightLines": [682]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 682, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "9fd90cde3e12", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes32 _updateState = keccak256(\n            abi.encodePacked(\n                _vcID, \n                updateSeq, \n                _partyA, \n                _partyB, \n                virtualChannels[_vcID].bond[0], \n                virtualChannels[_vcID].bond[1], \n                updateBal[0], \n                updateBal[1], \n                updateBal[2], \n                updateBal[3]\n            )\n        );\n\n        // Make sure Alice has signed a higher sequence new state\n        require(virtualChannels[_vcID].partyA == ECTools.recoverSigner(_updateState, sigA));\n\n        // store VC data\n        // we may want to record who is initiating on-chain settles\n        virtualChannels[_vcID].challenger = msg.sender;", "highlightLines": [683]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 683, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "bcf351e1bd44", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        bytes32 _updateState = keccak256(\n            abi.encodePacked(\n                _vcID, \n                updateSeq, \n                _partyA, \n                _partyB, \n                virtualChannels[_vcID].bond[0], \n                virtualChannels[_vcID].bond[1], \n                updateBal[0], \n                updateBal[1], \n                updateBal[2], \n                updateBal[3]\n            )\n        );", "highlightLines": [683]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 683, "column": 32}, "severity": "high", "references": [], "description": ""}, {"id": "14c0b5aff74f", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "            abi.encodePacked(\n                _vcID, \n                updateSeq, \n                _partyA, \n                _partyB, \n                virtualChannels[_vcID].bond[0], \n                virtualChannels[_vcID].bond[1], \n                updateBal[0], \n                updateBal[1], \n                updateBal[2], \n                updateBal[3]\n            )", "highlightLines": [684]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 684, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "7959a7daa49a", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(virtualChannels[_vcID].partyA == ECTools.recoverSigner(_updateState, sigA));", "highlightLines": [699]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 699, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "7e6cfb8d5782", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        virtualChannels[_vcID].challenger = msg.sender;\n        virtualChannels[_vcID].sequence = updateSeq;", "highlightLines": [703]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 703, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "594dd593b960", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        virtualChannels[_vcID].sequence = updateSeq;\n\n        // channel state\n        virtualChannels[_vcID].ethBalances[0] = updateBal[0];", "highlightLines": [704]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 704, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "a76b5ab14630", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        virtualChannels[_vcID].ethBalances[0] = updateBal[0];\n        virtualChannels[_vcID].ethBalances[1] = updateBal[1];", "highlightLines": [707]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 707, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "10ea19613cd5", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        virtualChannels[_vcID].ethBalances[1] = updateBal[1];\n        virtualChannels[_vcID].erc20Balances[0] = updateBal[2];", "highlightLines": [708]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 708, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "8d93f83602e5", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        virtualChannels[_vcID].erc20Balances[0] = updateBal[2];\n        virtualChannels[_vcID].erc20Balances[1] = updateBal[3];", "highlightLines": [709]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 709, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "1a1b7960b8ec", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        virtualChannels[_vcID].erc20Balances[1] = updateBal[3];\n\n        virtualChannels[_vcID].updateVCtimeout = now + Channels[_lcID].confirmTime;", "highlightLines": [710]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 710, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "4812f9bec537", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        Channel storage channel = Channels[_lcID];\n\n        // check settlement flag\n        require(channel.isOpen, \"Channel is not open\");\n        require(channel.isUpdateLCSettling == true);\n        require(channel.numOpenVC == 0);\n        require(channel.updateLCtimeout < now, \"LC timeout over.\");\n\n        // if off chain state update didnt reblance deposits, just return to deposit owner\n        uint256 totalEthDeposit = channel.initialDeposit[0] + channel.ethBalances[2] + channel.ethBalances[3];", "highlightLines": [749]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 749, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "b6c86e61429f", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(channel.isUpdateLCSettling == true);", "highlightLines": [753]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 753, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "301dcf4468a9", "fix": {"template": null, "available": false}, "title": "Unnecessary comparison to boolean constant - use variable directly", "ruleId": "rules.sol-boolean-constant-comparison", "snippet": {"code": "        require(channel.isUpdateLCSettling == true);", "highlightLines": [753]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 753, "column": 44}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#boolean-equality"], "description": ""}, {"id": "8f2de474b720", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(channel.numOpenVC == 0);", "highlightLines": [754]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 754, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "6fea108b162a", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "        // if off chain state update didnt reblance deposits, just return to deposit owner\n        uint256 totalEthDeposit = channel.initialDeposit[0] + channel.ethBalances[2] + channel.ethBalances[3];\n        uint256 totalTokenDeposit = channel.initialDeposit[1] + channel.erc20Balances[2] + channel.erc20Balances[3];", "highlightLines": [757]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 757, "column": 68}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "3dad39f74ab1", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 totalEthDeposit = channel.initialDeposit[0] + channel.ethBalances[2] + channel.ethBalances[3];", "highlightLines": [758]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 758, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8e258428de0d", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "        uint256 totalEthDeposit = channel.initialDeposit[0] + channel.ethBalances[2] + channel.ethBalances[3];", "highlightLines": [758]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 758, "column": 9}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "843d3855df31", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 totalEthDeposit = channel.initialDeposit[0] + channel.ethBalances[2] + channel.ethBalances[3];\n        uint256 totalTokenDeposit = channel.initialDeposit[1] + channel.erc20Balances[2] + channel.erc20Balances[3];", "highlightLines": [758]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 758, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "0590f0267799", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 totalTokenDeposit = channel.initialDeposit[1] + channel.erc20Balances[2] + channel.erc20Balances[3];", "highlightLines": [759]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 759, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f31d9535ec9c", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "        uint256 totalTokenDeposit = channel.initialDeposit[1] + channel.erc20Balances[2] + channel.erc20Balances[3];", "highlightLines": [759]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 759, "column": 9}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "44b33534034e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 totalTokenDeposit = channel.initialDeposit[1] + channel.erc20Balances[2] + channel.erc20Balances[3];\n\n        uint256 possibleTotalEthBeforeDeposit = channel.ethBalances[0] + channel.ethBalances[1];", "highlightLines": [759]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 759, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "907f7782e804", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 possibleTotalEthBeforeDeposit = channel.ethBalances[0] + channel.ethBalances[1];", "highlightLines": [760]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 760, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d2c12c6fda5c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 possibleTotalEthBeforeDeposit = channel.ethBalances[0] + channel.ethBalances[1]; \n        uint256 possibleTotalTokenBeforeDeposit = channel.erc20Balances[0] + channel.erc20Balances[1];", "highlightLines": [761]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 761, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "bbe39e68763a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 possibleTotalTokenBeforeDeposit = channel.erc20Balances[0] + channel.erc20Balances[1];", "highlightLines": [762]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 762, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a16fac7c0c72", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 possibleTotalTokenBeforeDeposit = channel.erc20Balances[0] + channel.erc20Balances[1];\n\n        if(possibleTotalEthBeforeDeposit < totalEthDeposit) {\n            channel.ethBalances[0]+=channel.ethBalances[2];\n            channel.ethBalances[1]+=channel.ethBalances[3];\n        } else {\n            require(possibleTotalEthBeforeDeposit == totalEthDeposit);\n        }\n\n        if(possibleTotalTokenBeforeDeposit < totalTokenDeposit) {\n            channel.erc20Balances[0]+=channel.erc20Balances[2];\n            channel.erc20Balances[1]+=channel.erc20Balances[3];\n        } else {\n            require(possibleTotalTokenBeforeDeposit == totalTokenDeposit);\n        }\n\n        // reentrancy\n        uint256 ethbalanceA = channel.ethBalances[0];", "highlightLines": [762]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 762, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "1b07793f0cf2", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "            require(possibleTotalEthBeforeDeposit == totalEthDeposit);", "highlightLines": [768]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 768, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "3a863b8b3a72", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "            require(possibleTotalTokenBeforeDeposit == totalTokenDeposit);", "highlightLines": [775]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 775, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "c27af12a0ba2", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 ethbalanceA = channel.ethBalances[0];", "highlightLines": [779]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 779, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "fbc8d5d9748c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 ethbalanceA = channel.ethBalances[0];\n        uint256 ethbalanceI = channel.ethBalances[1];", "highlightLines": [779]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 779, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "66059f87c714", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 ethbalanceI = channel.ethBalances[1];", "highlightLines": [780]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 780, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "958e02a351d6", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 ethbalanceI = channel.ethBalances[1];\n        uint256 tokenbalanceA = channel.erc20Balances[0];", "highlightLines": [780]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 780, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "f5582de687fe", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 tokenbalanceA = channel.erc20Balances[0];", "highlightLines": [781]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 781, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e367da82bb0c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 tokenbalanceA = channel.erc20Balances[0];\n        uint256 tokenbalanceI = channel.erc20Balances[1];", "highlightLines": [781]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 781, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "8835ebf2f5eb", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 tokenbalanceI = channel.erc20Balances[1];", "highlightLines": [782]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 782, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "2d7ae7b4ff6b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 tokenbalanceI = channel.erc20Balances[1];\n\n        channel.ethBalances[0] = 0;", "highlightLines": [782]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 782, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "c47ed4230a9d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        channel.ethBalances[0] = 0;\n        channel.ethBalances[1] = 0;", "highlightLines": [784]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 784, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "2253e2275f07", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        channel.ethBalances[1] = 0;\n        channel.erc20Balances[0] = 0;", "highlightLines": [785]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 785, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "5e04ae1aa7f0", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        channel.erc20Balances[0] = 0;\n        channel.erc20Balances[1] = 0;", "highlightLines": [786]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 786, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "046c99f42187", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        channel.erc20Balances[1] = 0;\n\n        if(ethbalanceA != 0 || ethbalanceI != 0) {\n            channel.partyAddresses[0].transfer(ethbalanceA);\n            channel.partyAddresses[1].transfer(ethbalanceI);\n        }\n\n        if(tokenbalanceA != 0 || tokenbalanceI != 0) {\n            require(\n                channel.token.transfer(channel.partyAddresses[0], tokenbalanceA),\n                \"byzantineCloseChannel: token transfer failure\"\n            );\n            require(\n                channel.token.transfer(channel.partyAddresses[1], tokenbalanceI),\n                \"byzantineCloseChannel: token transfer failure\"\n            );          \n        }\n\n        channel.isOpen = false;", "highlightLines": [787]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 787, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "3f2246d8335c", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "            channel.partyAddresses[0].transfer(ethbalanceA);", "highlightLines": [790]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 790, "column": 13}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "8f4cef0552f0", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "            channel.partyAddresses[1].transfer(ethbalanceI);", "highlightLines": [791]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 791, "column": 13}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "88fd7baa8a61", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function _isContained(bytes32 _hash, bytes _proof, bytes32 _root) internal pure returns (bool) {\n        bytes32 cursor = _hash;\n        bytes32 proofElem;\n\n        for (uint256 i = 64; i <= _proof.length; i += 32) {", "highlightLines": [811]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 811, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "bd9ec73c2985", "fix": {"template": null, "available": false}, "title": "View/pure function uses assembly - may modify state unexpectedly", "ruleId": "rules.sol-constant-function-assembly", "snippet": {"code": "    function _isContained(bytes32 _hash, bytes _proof, bytes32 _root) internal pure returns (bool) {\n        bytes32 cursor = _hash;\n        bytes32 proofElem;\n\n        for (uint256 i = 64; i <= _proof.length; i += 32) {\n            assembly { proofElem := mload(add(_proof, i)) }", "highlightLines": [811]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 811, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-using-assembly-code"], "description": ""}, {"id": "bebab36fb93e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 cursor = _hash;", "highlightLines": [812]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 812, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "532feee560c5", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes32 cursor = _hash;\n        bytes32 proofElem;\n\n        for (uint256 i = 64; i <= _proof.length; i += 32) {\n            assembly { proofElem := mload(add(_proof, i)) }\n\n            if (cursor < proofElem) {\n                cursor = keccak256(abi.encodePacked(cursor, proofElem));\n            } else {\n                cursor = keccak256(abi.encodePacked(proofElem, cursor));\n            }\n        }", "highlightLines": [812]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 812, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "f62f4dec2789", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 proofElem;", "highlightLines": [813]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 813, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "546c6942f24f", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "            assembly { proofElem := mload(add(_proof, i)) }", "highlightLines": [816]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 816, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "255f18cb0bc4", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "                cursor = keccak256(abi.encodePacked(cursor, proofElem));", "highlightLines": [819]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 819, "column": 26}, "severity": "high", "references": [], "description": ""}, {"id": "4eaa4b754b3e", "fix": {"template": null, "available": false}, "title": "Signature verification without EIP-712 domain separator - vulnerable to cross-chain/cross-contract replay", "ruleId": "rules.sol-ethernaut-missing-eip712-domain", "snippet": {"code": "                cursor = keccak256(abi.encodePacked(cursor, proofElem));", "highlightLines": [819]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 819, "column": 26}, "severity": "high", "references": ["https://eips.ethereum.org/EIPS/eip-712", "https://ethernaut.openzeppelin.com/"], "description": ""}, {"id": "f747553543f8", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "                cursor = keccak256(abi.encodePacked(cursor, proofElem));", "highlightLines": [819]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 819, "column": 36}, "severity": "medium", "references": [], "description": ""}, {"id": "1d2a9ee04be3", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "                cursor = keccak256(abi.encodePacked(proofElem, cursor));", "highlightLines": [821]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 821, "column": 26}, "severity": "high", "references": [], "description": ""}, {"id": "de30c6c839de", "fix": {"template": null, "available": false}, "title": "Signature verification without EIP-712 domain separator - vulnerable to cross-chain/cross-contract replay", "ruleId": "rules.sol-ethernaut-missing-eip712-domain", "snippet": {"code": "                cursor = keccak256(abi.encodePacked(proofElem, cursor));", "highlightLines": [821]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 821, "column": 26}, "severity": "high", "references": ["https://eips.ethereum.org/EIPS/eip-712", "https://ethernaut.openzeppelin.com/"], "description": ""}, {"id": "ea7582e7de30", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "                cursor = keccak256(abi.encodePacked(proofElem, cursor));", "highlightLines": [821]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 821, "column": 36}, "severity": "medium", "references": [], "description": ""}, {"id": "14f27314721a", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function getChannel(bytes32 id) public view returns (\n        address[2],\n        uint256[4],\n        uint256[4],\n        uint256[2],\n        uint256,\n        uint256,\n        bytes32,\n        uint256,\n        uint256,\n        bool,\n        bool,\n        uint256\n    ) {\n        Channel memory channel = Channels[id];", "highlightLines": [829]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 829, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "7992d1123e9d", "fix": {"template": null, "available": false}, "title": "Struct copied to memory from mapping - modifications won't persist to storage", "ruleId": "rules.sol-memory-struct-from-mapping", "snippet": {"code": "        Channel memory channel = Channels[id];", "highlightLines": [843]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 843, "column": 9}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/DataLocation.sol"], "description": ""}, {"id": "904e92c25a3b", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function getVirtualChannel(bytes32 id) public view returns(\n        bool,\n        bool,\n        uint256,\n        address,\n        uint256,\n        address,\n        address,\n        address,\n        uint256[2],\n        uint256[2],\n        uint256[2]\n    ) {\n        VirtualChannel memory virtualChannel = virtualChannels[id];", "highlightLines": [860]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 860, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "2d01cd0c027c", "fix": {"template": null, "available": false}, "title": "Struct copied to memory from mapping - modifications won't persist to storage", "ruleId": "rules.sol-memory-struct-from-mapping", "snippet": {"code": "        VirtualChannel memory virtualChannel = virtualChannels[id];", "highlightLines": [873]}, "category": "code", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 873, "column": 9}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/DataLocation.sol"], "description": ""}, {"id": "c7a258398082", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "// TODO - maybe allow different return payment address?\npragma solidity ^0.4.19;\n\ncontract KingOfTheEtherThrone {", "highlightLines": [15]}, "category": "code", "location": {"file": "unchecked_external_call/KotET_source_code/KingOfTheEtherThrone.sol", "line": 15, "column": 33}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "6716334a0810", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [16]}, "category": "code", "location": {"file": "unchecked_external_call/KotET_source_code/KingOfTheEtherThrone.sol", "line": 16, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "1e79555c31cd", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [16]}, "category": "code", "location": {"file": "unchecked_external_call/KotET_source_code/KingOfTheEtherThrone.sol", "line": 16, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "56216478a469", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address etherAddress;", "highlightLines": [22]}, "category": "code", "location": {"file": "unchecked_external_call/KotET_source_code/KingOfTheEtherThrone.sol", "line": 22, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "db1a36f8831c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        string name;", "highlightLines": [25]}, "category": "code", "location": {"file": "unchecked_external_call/KotET_source_code/KingOfTheEtherThrone.sol", "line": 25, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d3c162e85431", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint claimPrice;", "highlightLines": [27]}, "category": "code", "location": {"file": "unchecked_external_call/KotET_source_code/KingOfTheEtherThrone.sol", "line": 27, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4e276b0769bf", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint coronationTimestamp;", "highlightLines": [29]}, "category": "code", "location": {"file": "unchecked_external_call/KotET_source_code/KingOfTheEtherThrone.sol", "line": 29, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7db6e2df0dce", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address wizardAddress;", "highlightLines": [34]}, "category": "code", "location": {"file": "unchecked_external_call/KotET_source_code/KingOfTheEtherThrone.sol", "line": 34, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "505621a78ea4", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlywizard { if (msg.sender == wizardAddress) _; }", "highlightLines": [37]}, "category": "code", "location": {"file": "unchecked_external_call/KotET_source_code/KingOfTheEtherThrone.sol", "line": 37, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "c6483280ea91", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function KingOfTheEtherThrone() {\n        wizardAddress = msg.sender;\n        currentClaimPrice = startingClaimPrice;\n        currentMonarch = Monarch(\n            wizardAddress,\n            \"[Vacant]\",\n            0,\n            block.timestamp\n        );\n    }", "highlightLines": [65]}, "category": "code", "location": {"file": "unchecked_external_call/KotET_source_code/KingOfTheEtherThrone.sol", "line": 65, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "c15d9bf530d4", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        wizardAddress = msg.sender;\n        currentClaimPrice = startingClaimPrice;", "highlightLines": [66]}, "category": "code", "location": {"file": "unchecked_external_call/KotET_source_code/KingOfTheEtherThrone.sol", "line": 66, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "df01050f7cff", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        currentClaimPrice = startingClaimPrice;\n        currentMonarch = Monarch(\n            wizardAddress,\n            \"[Vacant]\",\n            0,\n            block.timestamp\n        );", "highlightLines": [67]}, "category": "code", "location": {"file": "unchecked_external_call/KotET_source_code/KingOfTheEtherThrone.sol", "line": 67, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "a25522c2096b", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "            block.timestamp", "highlightLines": [72]}, "category": "code", "location": {"file": "unchecked_external_call/KotET_source_code/KingOfTheEtherThrone.sol", "line": 72, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "48800262d8a2", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function numberOfMonarchs() constant returns (uint n) {\n        return pastMonarchs.length;\n    }", "highlightLines": [76]}, "category": "code", "location": {"file": "unchecked_external_call/KotET_source_code/KingOfTheEtherThrone.sol", "line": 76, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "c40ec36b6749", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event ThroneClaimed(\n        address usurperEtherAddress,\n        string usurperName,\n        uint newClaimPrice\n    );", "highlightLines": [82]}, "category": "code", "location": {"file": "unchecked_external_call/KotET_source_code/KingOfTheEtherThrone.sol", "line": 82, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "04fba3416a6d", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event ThroneClaimed(\n        address usurperEtherAddress,\n        string usurperName,\n        uint newClaimPrice\n    );", "highlightLines": [82]}, "category": "code", "location": {"file": "unchecked_external_call/KotET_source_code/KingOfTheEtherThrone.sol", "line": 82, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "d7a135bc551c", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function() {\n        claimThrone(string(msg.data));\n    }", "highlightLines": [90]}, "category": "code", "location": {"file": "unchecked_external_call/KotET_source_code/KingOfTheEtherThrone.sol", "line": 90, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "06f81e357a36", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function claimThrone(string name) {\n\n        uint valuePaid = msg.value;\n\n        // If they paid too little, reject claim and refund their money.\n        if (valuePaid < currentClaimPrice) {\n            msg.sender.send(valuePaid);\n            return;\n        }\n\n        // If they paid too much, continue with claim but refund the excess.\n        if (valuePaid > currentClaimPrice) {\n            uint excessPaid = valuePaid - currentClaimPrice;\n            msg.sender.send(excessPaid);\n            valuePaid = valuePaid - excessPaid;\n        }\n\n        // The claim price payment goes to the current monarch as compensation\n        // (with a commission held back for the wizard). We let the wizard's\n        // payments accumulate to avoid wasting gas sending small fees.\n\n        uint wizardCommission = (valuePaid * wizardCommissionFractionNum) / wizardCommissionFractionDen;\n\n        uint compensation = valuePaid - wizardCommission;\n\n        if (currentMonarch.etherAddress != wizardAddress) {\n            currentMonarch.etherAddress.send(compensation);\n        } else {\n            // When the throne is vacant, the fee accumulates for the wizard.\n        }\n\n        // Usurp the current monarch, replacing them with the new one.\n        pastMonarchs.push(currentMonarch);\n        currentMonarch = Monarch(\n            msg.sender,\n            name,\n            valuePaid,\n            block.timestamp\n        );\n\n        // Increase the claim fee for next time.\n        // Stop number of trailing decimals getting silly - we round it a bit.\n        uint rawNewClaimPrice = currentClaimPrice * claimPriceAdjustNum / claimPriceAdjustDen;\n        if (rawNewClaimPrice < 10 finney) {\n            currentClaimPrice = rawNewClaimPrice;\n        } else if (rawNewClaimPrice < 100 finney) {\n            currentClaimPrice = 100 szabo * (rawNewClaimPrice / 100 szabo);\n        } else if (rawNewClaimPrice < 1 ether) {\n            currentClaimPrice = 1 finney * (rawNewClaimPrice / 1 finney);\n        } else if (rawNewClaimPrice < 10 ether) {\n            currentClaimPrice = 10 finney * (rawNewClaimPrice / 10 finney);\n        } else if (rawNewClaimPrice < 100 ether) {\n            currentClaimPrice = 100 finney * (rawNewClaimPrice / 100 finney);\n        } else if (rawNewClaimPrice < 1000 ether) {\n            currentClaimPrice = 1 ether * (rawNewClaimPrice / 1 ether);\n        } else if (rawNewClaimPrice < 10000 ether) {\n            currentClaimPrice = 10 ether * (rawNewClaimPrice / 10 ether);\n        } else {\n            currentClaimPrice = rawNewClaimPrice;\n        }\n\n        // Hail the new monarch!\n        ThroneClaimed(currentMonarch.etherAddress, currentMonarch.name, currentClaimPrice);\n    }", "highlightLines": [95]}, "category": "code", "location": {"file": "unchecked_external_call/KotET_source_code/KingOfTheEtherThrone.sol", "line": 95, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "19d2ee5834dd", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint valuePaid = msg.value;", "highlightLines": [96]}, "category": "code", "location": {"file": "unchecked_external_call/KotET_source_code/KingOfTheEtherThrone.sol", "line": 96, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "eca96d646692", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint valuePaid = msg.value;\n\n        // If they paid too little, reject claim and refund their money.\n        if (valuePaid < currentClaimPrice) {\n            msg.sender.send(valuePaid);\n            return;\n        }\n\n        // If they paid too much, continue with claim but refund the excess.\n        if (valuePaid > currentClaimPrice) {\n            uint excessPaid = valuePaid - currentClaimPrice;\n            msg.sender.send(excessPaid);\n            valuePaid = valuePaid - excessPaid;\n        }", "highlightLines": [97]}, "category": "code", "location": {"file": "unchecked_external_call/KotET_source_code/KingOfTheEtherThrone.sol", "line": 97, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "777028d908b0", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "            msg.sender.send(valuePaid);", "highlightLines": [101]}, "category": "code", "location": {"file": "unchecked_external_call/KotET_source_code/KingOfTheEtherThrone.sol", "line": 101, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "999865a5b62b", "fix": {"template": null, "available": false}, "title": "send() return value not checked - Ether may be stuck if recipient reverts", "ruleId": "rules.sol-unchecked-send-return", "snippet": {"code": "            msg.sender.send(valuePaid);", "highlightLines": [101]}, "category": "code", "location": {"file": "unchecked_external_call/KotET_source_code/KingOfTheEtherThrone.sol", "line": 101, "column": 23}, "severity": "high", "references": [], "description": ""}, {"id": "94b81aee2873", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "            return;", "highlightLines": [102]}, "category": "code", "location": {"file": "unchecked_external_call/KotET_source_code/KingOfTheEtherThrone.sol", "line": 102, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "bde39b2fc211", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint excessPaid = valuePaid - currentClaimPrice;", "highlightLines": [107]}, "category": "code", "location": {"file": "unchecked_external_call/KotET_source_code/KingOfTheEtherThrone.sol", "line": 107, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3715298586a5", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            uint excessPaid = valuePaid - currentClaimPrice;\n            msg.sender.send(excessPaid);\n            valuePaid = valuePaid - excessPaid;", "highlightLines": [107]}, "category": "code", "location": {"file": "unchecked_external_call/KotET_source_code/KingOfTheEtherThrone.sol", "line": 107, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "235e7d9db815", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "            msg.sender.send(excessPaid);", "highlightLines": [108]}, "category": "code", "location": {"file": "unchecked_external_call/KotET_source_code/KingOfTheEtherThrone.sol", "line": 108, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "5291bb1938bd", "fix": {"template": null, "available": false}, "title": "send() return value not checked - Ether may be stuck if recipient reverts", "ruleId": "rules.sol-unchecked-send-return", "snippet": {"code": "            msg.sender.send(excessPaid);", "highlightLines": [108]}, "category": "code", "location": {"file": "unchecked_external_call/KotET_source_code/KingOfTheEtherThrone.sol", "line": 108, "column": 23}, "severity": "high", "references": [], "description": ""}, {"id": "8350d388265c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint wizardCommission = (valuePaid * wizardCommissionFractionNum) / wizardCommissionFractionDen;", "highlightLines": [115]}, "category": "code", "location": {"file": "unchecked_external_call/KotET_source_code/KingOfTheEtherThrone.sol", "line": 115, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "77fbca38ae8c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint wizardCommission = (valuePaid * wizardCommissionFractionNum) / wizardCommissionFractionDen;\n\n        uint compensation = valuePaid - wizardCommission;", "highlightLines": [116]}, "category": "code", "location": {"file": "unchecked_external_call/KotET_source_code/KingOfTheEtherThrone.sol", "line": 116, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "14a22646548a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint compensation = valuePaid - wizardCommission;", "highlightLines": [117]}, "category": "code", "location": {"file": "unchecked_external_call/KotET_source_code/KingOfTheEtherThrone.sol", "line": 117, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b52c03e97c2f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint compensation = valuePaid - wizardCommission;\n\n        if (currentMonarch.etherAddress != wizardAddress) {\n            currentMonarch.etherAddress.send(compensation);\n        } else {\n            // When the throne is vacant, the fee accumulates for the wizard.\n        }\n\n        // Usurp the current monarch, replacing them with the new one.\n        pastMonarchs.push(currentMonarch);\n        currentMonarch = Monarch(\n            msg.sender,\n            name,\n            valuePaid,\n            block.timestamp\n        );", "highlightLines": [118]}, "category": "code", "location": {"file": "unchecked_external_call/KotET_source_code/KingOfTheEtherThrone.sol", "line": 118, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "bd9493ff33fe", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "            currentMonarch.etherAddress.send(compensation);", "highlightLines": [121]}, "category": "code", "location": {"file": "unchecked_external_call/KotET_source_code/KingOfTheEtherThrone.sol", "line": 121, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "dec162e324b5", "fix": {"template": null, "available": false}, "title": "send() return value not checked - Ether may be stuck if recipient reverts", "ruleId": "rules.sol-unchecked-send-return", "snippet": {"code": "            currentMonarch.etherAddress.send(compensation);", "highlightLines": [121]}, "category": "code", "location": {"file": "unchecked_external_call/KotET_source_code/KingOfTheEtherThrone.sol", "line": 121, "column": 40}, "severity": "high", "references": [], "description": ""}, {"id": "2af2c6dadeff", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        currentMonarch = Monarch(\n            msg.sender,\n            name,\n            valuePaid,\n            block.timestamp\n        );\n\n        // Increase the claim fee for next time.\n        // Stop number of trailing decimals getting silly - we round it a bit.\n        uint rawNewClaimPrice = currentClaimPrice * claimPriceAdjustNum / claimPriceAdjustDen;", "highlightLines": [128]}, "category": "code", "location": {"file": "unchecked_external_call/KotET_source_code/KingOfTheEtherThrone.sol", "line": 128, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "62ac0b72fd84", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "            block.timestamp", "highlightLines": [132]}, "category": "code", "location": {"file": "unchecked_external_call/KotET_source_code/KingOfTheEtherThrone.sol", "line": 132, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "b5e5551a0697", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint rawNewClaimPrice = currentClaimPrice * claimPriceAdjustNum / claimPriceAdjustDen;", "highlightLines": [137]}, "category": "code", "location": {"file": "unchecked_external_call/KotET_source_code/KingOfTheEtherThrone.sol", "line": 137, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "cfc0efe1d554", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint rawNewClaimPrice = currentClaimPrice * claimPriceAdjustNum / claimPriceAdjustDen;\n        if (rawNewClaimPrice < 10 finney) {\n            currentClaimPrice = rawNewClaimPrice;\n        } else if (rawNewClaimPrice < 100 finney) {\n            currentClaimPrice = 100 szabo * (rawNewClaimPrice / 100 szabo);\n        } else if (rawNewClaimPrice < 1 ether) {\n            currentClaimPrice = 1 finney * (rawNewClaimPrice / 1 finney);\n        } else if (rawNewClaimPrice < 10 ether) {\n            currentClaimPrice = 10 finney * (rawNewClaimPrice / 10 finney);\n        } else if (rawNewClaimPrice < 100 ether) {\n            currentClaimPrice = 100 finney * (rawNewClaimPrice / 100 finney);\n        } else if (rawNewClaimPrice < 1000 ether) {\n            currentClaimPrice = 1 ether * (rawNewClaimPrice / 1 ether);\n        } else if (rawNewClaimPrice < 10000 ether) {\n            currentClaimPrice = 10 ether * (rawNewClaimPrice / 10 ether);\n        } else {\n            currentClaimPrice = rawNewClaimPrice;\n        }", "highlightLines": [137]}, "category": "code", "location": {"file": "unchecked_external_call/KotET_source_code/KingOfTheEtherThrone.sol", "line": 137, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "7d37cb8b6790", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function sweepCommission(uint amount) onlywizard {\n        wizardAddress.send(amount);\n    }", "highlightLines": [161]}, "category": "code", "location": {"file": "unchecked_external_call/KotET_source_code/KingOfTheEtherThrone.sol", "line": 161, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "9d9a6caaed23", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "        wizardAddress.send(amount);", "highlightLines": [162]}, "category": "code", "location": {"file": "unchecked_external_call/KotET_source_code/KingOfTheEtherThrone.sol", "line": 162, "column": 9}, "severity": "high", "references": [], "description": ""}, {"id": "b2e9171d7a9a", "fix": {"template": null, "available": false}, "title": "send() return value not checked - Ether may be stuck if recipient reverts", "ruleId": "rules.sol-unchecked-send-return", "snippet": {"code": "        wizardAddress.send(amount);", "highlightLines": [162]}, "category": "code", "location": {"file": "unchecked_external_call/KotET_source_code/KingOfTheEtherThrone.sol", "line": 162, "column": 22}, "severity": "high", "references": [], "description": ""}, {"id": "4e65cb4ce10b", "fix": {"template": null, "available": false}, "title": "Access control change without event emission - harder to monitor and audit", "ruleId": "rules.sol-missing-events-access-control", "snippet": {"code": "    function transferOwnership(address newOwner) onlywizard {", "highlightLines": [166]}, "category": "code", "location": {"file": "unchecked_external_call/KotET_source_code/KingOfTheEtherThrone.sol", "line": 166, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-access-control"], "description": ""}, {"id": "f0e44f9865d3", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function transferOwnership(address newOwner) onlywizard {\n        wizardAddress = newOwner;\n    }", "highlightLines": [166]}, "category": "code", "location": {"file": "unchecked_external_call/KotET_source_code/KingOfTheEtherThrone.sol", "line": 166, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "b70c3ff3f146", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.15;", "highlightLines": [1]}, "category": "code", "location": {"file": "unprotected_function/Unprotected.sol", "line": 1, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "9baa484c5929", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.15;", "highlightLines": [1]}, "category": "code", "location": {"file": "unprotected_function/Unprotected.sol", "line": 1, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "7fe74230a060", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyowner {\n        require(msg.sender==owner);\n        _;\n    }", "highlightLines": [6]}, "category": "code", "location": {"file": "unprotected_function/Unprotected.sol", "line": 6, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "145ff13f1e12", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "        require(msg.sender==owner);", "highlightLines": [7]}, "category": "code", "location": {"file": "unprotected_function/Unprotected.sol", "line": 7, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "91c78d59d005", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender==owner);", "highlightLines": [7]}, "category": "code", "location": {"file": "unprotected_function/Unprotected.sol", "line": 7, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "503a7ccfe3e5", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [8]}, "category": "code", "location": {"file": "unprotected_function/Unprotected.sol", "line": 8, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "b5bf62845cfe", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        owner = msg.sender;", "highlightLines": [14]}, "category": "code", "location": {"file": "unprotected_function/Unprotected.sol", "line": 14, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "f300ef8d75ed", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function changeOwner(address _newOwner) \n        public", "highlightLines": [18]}, "category": "code", "location": {"file": "unprotected_function/Unprotected.sol", "line": 18, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "5537f0611177", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "       owner = _newOwner;", "highlightLines": [21]}, "category": "code", "location": {"file": "unprotected_function/Unprotected.sol", "line": 21, "column": 8}, "severity": "info", "references": [], "description": ""}, {"id": "3106df2ae472", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "       owner = _newOwner;", "highlightLines": [28]}, "category": "code", "location": {"file": "unprotected_function/Unprotected.sol", "line": 28, "column": 8}, "severity": "info", "references": [], "description": ""}, {"id": "b2ed274467cb", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.9;", "highlightLines": [13]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 13, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "adca1a7a64c8", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.9;", "highlightLines": [13]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 13, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "9c2ef6f9b2e9", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event Confirmation(address owner, bytes32 operation);", "highlightLines": [20]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 20, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "f5dc6ee25ca5", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event Confirmation(address owner, bytes32 operation);", "highlightLines": [20]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 20, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "5068fe08b0fe", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event Revoke(address owner, bytes32 operation);", "highlightLines": [21]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 21, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "de8f2b0b0d19", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event Revoke(address owner, bytes32 operation);", "highlightLines": [21]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 21, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "c2cd94e1209e", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event OwnerChanged(address oldOwner, address newOwner);", "highlightLines": [24]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 24, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "14cb532f8dcc", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event OwnerChanged(address oldOwner, address newOwner);", "highlightLines": [24]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 24, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "cb2fe9f5ea6a", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event OwnerAdded(address newOwner);", "highlightLines": [25]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 25, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "bd3f2755365b", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event OwnerAdded(address newOwner);", "highlightLines": [25]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 25, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "30e18b81df88", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event OwnerRemoved(address oldOwner);", "highlightLines": [26]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 26, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "9532a72b89c0", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event OwnerRemoved(address oldOwner);", "highlightLines": [26]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 26, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "c131e973af95", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event RequirementChanged(uint newRequirement);", "highlightLines": [29]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 29, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "9f1f5d813217", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event Deposit(address _from, uint value);", "highlightLines": [32]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 32, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "108444ed4c19", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event Deposit(address _from, uint value);", "highlightLines": [32]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 32, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "4622eea4a9ba", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event SingleTransact(address owner, uint value, address to, bytes data, address created);", "highlightLines": [34]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 34, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "2b3618219039", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event SingleTransact(address owner, uint value, address to, bytes data, address created);", "highlightLines": [34]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 34, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "8cd1019e4fa6", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event MultiTransact(address owner, bytes32 operation, uint value, address to, bytes data, address created);", "highlightLines": [36]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 36, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "964f33dec048", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event MultiTransact(address owner, bytes32 operation, uint value, address to, bytes data, address created);", "highlightLines": [36]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 36, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "87422cdf4ebb", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event ConfirmationNeeded(bytes32 operation, address initiator, uint value, address to, bytes data);", "highlightLines": [38]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 38, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "9252dff57bf4", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "  function changeOwner(address _from, address _to) external;", "highlightLines": [46]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 46, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "f6fdcd52a7a5", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function changeOwner(address _from, address _to) external;", "highlightLines": [46]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 46, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "6e8bce669715", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function addOwner(address _owner) external;", "highlightLines": [48]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 48, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "b3f6f6ccda4e", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function removeOwner(address _owner) external;", "highlightLines": [50]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 50, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "4df222897573", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function isOwner(address _addr) constant returns (bool);", "highlightLines": [54]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 54, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "7cf405fb80db", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function execute(address _to, uint _value, bytes _data) external returns (bytes32 o_hash);", "highlightLines": [61]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 61, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "1ca99502ee12", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract WalletLibrary is WalletEvents {\n  // TYPES\n\n  // struct for the status of a pending operation.\n  struct PendingState {\n    uint yetNeeded;\n    uint ownersDone;\n    uint index;", "highlightLines": [65]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 65, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "a994becdc4f8", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint yetNeeded;", "highlightLines": [70]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 70, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d672bb8f7a3a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint ownersDone;", "highlightLines": [71]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 71, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "08d9f840c57d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint index;", "highlightLines": [72]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 72, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a599d7ad374f", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address to;", "highlightLines": [77]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 77, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "956f8d836696", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint value;", "highlightLines": [78]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 78, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b2c31c3a41f9", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    bytes data;", "highlightLines": [79]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 79, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "fd3d91bb735e", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  modifier onlyowner {\n    if (isOwner(msg.sender))\n      _;\n  }", "highlightLines": [85]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 85, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "7ceed698c44a", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "      _;", "highlightLines": [87]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 87, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "f4f70ad47d88", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  modifier onlymanyowners(bytes32 _operation) {\n    if (confirmAndCheck(_operation))\n      _;\n  }", "highlightLines": [92]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 92, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "dea116830b32", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "  modifier onlymanyowners(bytes32 _operation) {\n    if (confirmAndCheck(_operation))\n      _;\n  }", "highlightLines": [92]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 92, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "bc8d55ccac19", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "      _;", "highlightLines": [94]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 94, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "0a42faf3a3f8", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function() payable {\n    // just being sent some cash?\n    if (msg.value > 0)\n      Deposit(msg.sender, msg.value);\n  }", "highlightLines": [100]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 100, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "75c87ce679f3", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function initMultiowned(address[] _owners, uint _required) {\n    m_numOwners = _owners.length + 1;\n    m_owners[1] = uint(msg.sender);\n    m_ownerIndex[uint(msg.sender)] = 1;\n    for (uint i = 0; i < _owners.length; ++i)\n    {\n      m_owners[2 + i] = uint(_owners[i]);\n      m_ownerIndex[uint(_owners[i])] = 2 + i;\n    }\n    m_required = _required;\n  }", "highlightLines": [108]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 108, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "1ce0f10e7407", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    m_numOwners = _owners.length + 1;\n    m_owners[1] = uint(msg.sender);", "highlightLines": [109]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 109, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "640144f49146", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    m_owners[1] = uint(msg.sender);\n    m_ownerIndex[uint(msg.sender)] = 1;", "highlightLines": [110]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 110, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "4a30988d62f8", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "    m_owners[1] = uint(msg.sender);", "highlightLines": [110]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 110, "column": 19}, "severity": "info", "references": [], "description": ""}, {"id": "6174931fd96a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    m_ownerIndex[uint(msg.sender)] = 1;\n    for (uint i = 0; i < _owners.length; ++i)\n    {\n      m_owners[2 + i] = uint(_owners[i]);\n      m_ownerIndex[uint(_owners[i])] = 2 + i;\n    }", "highlightLines": [111]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 111, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "a606d275e342", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "    m_ownerIndex[uint(msg.sender)] = 1;", "highlightLines": [111]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 111, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "1e057787c580", "fix": {"template": null, "available": false}, "title": "Empty array bypasses loop logic - add length check before loop", "ruleId": "rules.sol-empty-array-loop-bypass", "snippet": {"code": "    for (uint i = 0; i < _owners.length; ++i)\n    {", "highlightLines": [112]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 112, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/empty-loop.sol"], "description": ""}, {"id": "0ee2e978477e", "fix": {"template": null, "available": false}, "title": "Storage variable modified in loop - should cache in memory for gas savings", "ruleId": "rules.sol-memory-vs-storage-loop", "snippet": {"code": "    for (uint i = 0; i < _owners.length; ++i)\n    {\n      m_owners[2 + i] = uint(_owners[i]);", "highlightLines": [112]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 112, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "960418e46405", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "      m_owners[2 + i] = uint(_owners[i]);\n      m_ownerIndex[uint(_owners[i])] = 2 + i;", "highlightLines": [114]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 114, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "4ce33bc2c585", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "      m_owners[2 + i] = uint(_owners[i]);", "highlightLines": [114]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 114, "column": 25}, "severity": "info", "references": [], "description": ""}, {"id": "9ac32d66ac7c", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "      m_ownerIndex[uint(_owners[i])] = 2 + i;", "highlightLines": [115]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 115, "column": 20}, "severity": "info", "references": [], "description": ""}, {"id": "26150acdc696", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint ownerIndex = m_ownerIndex[uint(msg.sender)];", "highlightLines": [122]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 122, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ae3f40f696a4", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint ownerIndex = m_ownerIndex[uint(msg.sender)];\n    // make sure they're an owner\n    if (ownerIndex == 0) return;\n    uint ownerIndexBit = 2**ownerIndex;", "highlightLines": [122]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 122, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "d456ba4dfd87", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "    uint ownerIndex = m_ownerIndex[uint(msg.sender)];", "highlightLines": [122]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 122, "column": 36}, "severity": "info", "references": [], "description": ""}, {"id": "713dc1b602f4", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint ownerIndexBit = 2**ownerIndex;", "highlightLines": [125]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 125, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d78d2560203d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint ownerIndexBit = 2**ownerIndex;\n    var pending = m_pending[_operation];", "highlightLines": [125]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 125, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "97e23c042e12", "fix": {"template": null, "available": false}, "title": "Deprecated 'var' keyword can cause type confusion - resolves to smallest type (e.g., uint8 in loops)", "ruleId": "rules.sol-deprecated-var-keyword", "snippet": {"code": "    var pending = m_pending[_operation];", "highlightLines": [126]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 126, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/honeypots"], "description": ""}, {"id": "7801cdafb49a", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "    if (pending.ownersDone & ownerIndexBit > 0) {", "highlightLines": [127]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 127, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "53a2a7212042", "fix": {"template": null, "available": false}, "title": "sha3() is deprecated - use keccak256() instead", "ruleId": "rules.sol-deprecated-sha3", "snippet": {"code": "  function changeOwner(address _from, address _to) onlymanyowners(sha3(msg.data)) external {", "highlightLines": [135]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 135, "column": 67}, "severity": "info", "references": [], "description": ""}, {"id": "02cc94982a96", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint ownerIndex = m_ownerIndex[uint(_from)];", "highlightLines": [137]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 137, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8d5c5a69c743", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint ownerIndex = m_ownerIndex[uint(_from)];\n    if (ownerIndex == 0) return;\n\n    clearPending();\n    m_owners[ownerIndex] = uint(_to);", "highlightLines": [137]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 137, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "188bdaef831f", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "    uint ownerIndex = m_ownerIndex[uint(_from)];", "highlightLines": [137]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 137, "column": 36}, "severity": "info", "references": [], "description": ""}, {"id": "212636c4721d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    m_owners[ownerIndex] = uint(_to);\n    m_ownerIndex[uint(_from)] = 0;", "highlightLines": [141]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 141, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "aa4739269238", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "    m_owners[ownerIndex] = uint(_to);", "highlightLines": [141]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 141, "column": 28}, "severity": "info", "references": [], "description": ""}, {"id": "76c26fedc72d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    m_ownerIndex[uint(_from)] = 0;\n    m_ownerIndex[uint(_to)] = ownerIndex;", "highlightLines": [142]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 142, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "837bd72426be", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "    m_ownerIndex[uint(_from)] = 0;", "highlightLines": [142]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 142, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "953770db98b8", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "    m_ownerIndex[uint(_to)] = ownerIndex;", "highlightLines": [143]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 143, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "1420d7365581", "fix": {"template": null, "available": false}, "title": "sha3() is deprecated - use keccak256() instead", "ruleId": "rules.sol-deprecated-sha3", "snippet": {"code": "  function addOwner(address _owner) onlymanyowners(sha3(msg.data)) external {", "highlightLines": [147]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 147, "column": 52}, "severity": "info", "references": [], "description": ""}, {"id": "dd607313dc21", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "      return;", "highlightLines": [154]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 154, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "1cc56912aefe", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    m_owners[m_numOwners] = uint(_owner);\n    m_ownerIndex[uint(_owner)] = m_numOwners;", "highlightLines": [156]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 156, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "1ad5ec70b903", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "    m_owners[m_numOwners] = uint(_owner);", "highlightLines": [156]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 156, "column": 29}, "severity": "info", "references": [], "description": ""}, {"id": "234d71724dac", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "    m_ownerIndex[uint(_owner)] = m_numOwners;", "highlightLines": [157]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 157, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "e6657788e983", "fix": {"template": null, "available": false}, "title": "sha3() is deprecated - use keccak256() instead", "ruleId": "rules.sol-deprecated-sha3", "snippet": {"code": "  function removeOwner(address _owner) onlymanyowners(sha3(msg.data)) external {", "highlightLines": [161]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 161, "column": 55}, "severity": "info", "references": [], "description": ""}, {"id": "03e87393bf19", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint ownerIndex = m_ownerIndex[uint(_owner)];", "highlightLines": [162]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 162, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4db6dfa3a592", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint ownerIndex = m_ownerIndex[uint(_owner)];\n    if (ownerIndex == 0) return;\n    if (m_required > m_numOwners - 1) return;\n\n    m_owners[ownerIndex] = 0;", "highlightLines": [162]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 162, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "99ad678243bf", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "    uint ownerIndex = m_ownerIndex[uint(_owner)];", "highlightLines": [162]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 162, "column": 36}, "severity": "info", "references": [], "description": ""}, {"id": "781bd99634d6", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    m_owners[ownerIndex] = 0;\n    m_ownerIndex[uint(_owner)] = 0;", "highlightLines": [166]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 166, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "6fbc9aab8a6e", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "    m_ownerIndex[uint(_owner)] = 0;", "highlightLines": [167]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 167, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "d2f0a2b81f4f", "fix": {"template": null, "available": false}, "title": "sha3() is deprecated - use keccak256() instead", "ruleId": "rules.sol-deprecated-sha3", "snippet": {"code": "  function changeRequirement(uint _newRequired) onlymanyowners(sha3(msg.data)) external {", "highlightLines": [173]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 173, "column": 64}, "severity": "info", "references": [], "description": ""}, {"id": "0e5c6e4738d9", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function isOwner(address _addr) constant returns (bool) {\n    return m_ownerIndex[uint(_addr)] > 0;\n  }", "highlightLines": [185]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 185, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "fcb807761cf7", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "    return m_ownerIndex[uint(_addr)] > 0;", "highlightLines": [186]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 186, "column": 25}, "severity": "info", "references": [], "description": ""}, {"id": "e859d2e0699c", "fix": {"template": null, "available": false}, "title": "Deprecated 'var' keyword can cause type confusion - resolves to smallest type (e.g., uint8 in loops)", "ruleId": "rules.sol-deprecated-var-keyword", "snippet": {"code": "    var pending = m_pending[_operation];", "highlightLines": [190]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 190, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/honeypots"], "description": ""}, {"id": "e88732ea97e3", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    var pending = m_pending[_operation];\n    uint ownerIndex = m_ownerIndex[uint(_owner)];", "highlightLines": [190]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 190, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "936564f628e5", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint ownerIndex = m_ownerIndex[uint(_owner)];", "highlightLines": [191]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 191, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ee4119016919", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint ownerIndex = m_ownerIndex[uint(_owner)];\n\n    // make sure they're an owner\n    if (ownerIndex == 0) return false;\n\n    // determine the bit to set for this owner.\n    uint ownerIndexBit = 2**ownerIndex;", "highlightLines": [191]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 191, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "7740324c1371", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "    uint ownerIndex = m_ownerIndex[uint(_owner)];", "highlightLines": [191]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 191, "column": 36}, "severity": "info", "references": [], "description": ""}, {"id": "7c0845f40830", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint ownerIndexBit = 2**ownerIndex;", "highlightLines": [197]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 197, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "298aff434e6a", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "    return !(pending.ownersDone & ownerIndexBit == 0);", "highlightLines": [198]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 198, "column": 14}, "severity": "medium", "references": [], "description": ""}, {"id": "ecfaf5c10068", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function initDaylimit(uint _limit) {\n    m_dailyLimit = _limit;\n    m_lastDay = today();\n  }", "highlightLines": [202]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 202, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "f4167d10e516", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    m_dailyLimit = _limit;\n    m_lastDay = today();", "highlightLines": [203]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 203, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "afa9edaaf438", "fix": {"template": null, "available": false}, "title": "sha3() is deprecated - use keccak256() instead", "ruleId": "rules.sol-deprecated-sha3", "snippet": {"code": "  function setDailyLimit(uint _newLimit) onlymanyowners(sha3(msg.data)) external {", "highlightLines": [207]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 207, "column": 57}, "severity": "info", "references": [], "description": ""}, {"id": "496c3187621c", "fix": {"template": null, "available": false}, "title": "sha3() is deprecated - use keccak256() instead", "ruleId": "rules.sol-deprecated-sha3", "snippet": {"code": "  function resetSpentToday() onlymanyowners(sha3(msg.data)) external {", "highlightLines": [211]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 211, "column": 45}, "severity": "info", "references": [], "description": ""}, {"id": "98053ee474c0", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function initWallet(address[] _owners, uint _required, uint _daylimit) {\n    initDaylimit(_daylimit);\n    initMultiowned(_owners, _required);\n  }", "highlightLines": [217]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 217, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "68431ceb3545", "fix": {"template": null, "available": false}, "title": "sha3() is deprecated - use keccak256() instead", "ruleId": "rules.sol-deprecated-sha3", "snippet": {"code": "  function kill(address _to) onlymanyowners(sha3(msg.data)) external {", "highlightLines": [223]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 223, "column": 45}, "severity": "info", "references": [], "description": ""}, {"id": "be2d1e8a44f9", "fix": {"template": null, "available": false}, "title": "Contract can be destructed by anyone - missing access control on selfdestruct", "ruleId": "rules.sol-accessible-selfdestruct", "snippet": {"code": "    suicide(_to);", "highlightLines": [224]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 224, "column": 5}, "severity": "high", "references": ["https://www.parity.io/blog/a-postmortem-on-the-parity-multi-sig-library-self-destruct/"], "description": ""}, {"id": "fab920c6e138", "fix": {"template": null, "available": false}, "title": "suicide() is deprecated - use selfdestruct() instead", "ruleId": "rules.sol-deprecated-suicide", "snippet": {"code": "    suicide(_to);", "highlightLines": [224]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 224, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "7e6d0c9f08dc", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "  // If not, goes into multisig process. We provide a hash on return to allow the sender to provide\n  // shortcuts for the other confirmations (allowing them to avoid replicating the _to, _value\n  // and _data arguments). They still get the option of using them if they want, anyways.\n  function execute(address _to, uint _value, bytes _data) external onlyowner returns (bytes32 o_hash) {\n    // first, take the opportunity to check that we're under the daily limit.\n    if ((_data.length == 0 && underLimit(_value)) || m_required == 1) {\n      // yes - just execute the call.\n      address created;\n      if (_to == 0) {", "highlightLines": [228]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 228, "column": 63}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "9e32b8f1e914", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "  function execute(address _to, uint _value, bytes _data) external onlyowner returns (bytes32 o_hash) {\n    // first, take the opportunity to check that we're under the daily limit.\n    if ((_data.length == 0 && underLimit(_value)) || m_required == 1) {\n      // yes - just execute the call.\n      address created;\n      if (_to == 0) {", "highlightLines": [231]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 231, "column": 3}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "85c5c86f2bab", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "      address created;", "highlightLines": [235]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 235, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b26b03eb210b", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "      if (_to == 0) {\n        created = create(_value, _data);\n      } else {\n        if (!_to.call.value(_value)(_data))\n          throw;\n      }", "highlightLines": [236]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 236, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "14e5d18008cc", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "          throw;", "highlightLines": [240]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 240, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "8b88f944135a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "      o_hash = sha3(msg.data, block.number);\n      // store if it's new\n      if (m_txs[o_hash].to == 0 && m_txs[o_hash].value == 0 && m_txs[o_hash].data.length == 0) {\n        m_txs[o_hash].to = _to;\n        m_txs[o_hash].value = _value;\n        m_txs[o_hash].data = _data;\n      }", "highlightLines": [245]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 245, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "7098fe5f3465", "fix": {"template": null, "available": false}, "title": "sha3() is deprecated - use keccak256() instead", "ruleId": "rules.sol-deprecated-sha3", "snippet": {"code": "      o_hash = sha3(msg.data, block.number);", "highlightLines": [245]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 245, "column": 16}, "severity": "info", "references": [], "description": ""}, {"id": "e9fbef2745c4", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        m_txs[o_hash].to = _to;\n        m_txs[o_hash].value = _value;", "highlightLines": [248]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 248, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "6bb23b73cc1b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        m_txs[o_hash].value = _value;\n        m_txs[o_hash].data = _data;", "highlightLines": [249]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 249, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "765085daff02", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "    assembly {", "highlightLines": [259]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 259, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "43c766287ca7", "fix": {"template": null, "available": false}, "title": "Raw bytecode deployment via create/create2 - verify bytecode source and intent (MagicNumber pattern)", "ruleId": "rules.sol-raw-bytecode-create", "snippet": {"code": "      o_addr := create(_value, add(_code, 0x20), mload(_code))", "highlightLines": [260]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 260, "column": 17}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/18"], "description": ""}, {"id": "0dc147b12eca", "fix": {"template": null, "available": false}, "title": "extcodesize check can be bypassed during constructor - contracts have size 0 while being created", "ruleId": "rules.sol-extcodesize-check", "snippet": {"code": "      jumpi(invalidJumpLabel, iszero(extcodesize(o_addr)))", "highlightLines": [261]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 261, "column": 38}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/18"], "description": ""}, {"id": "11c7c7955d82", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function confirm(bytes32 _h) onlymanyowners(_h) returns (bool o_success) {\n    if (m_txs[_h].to != 0 || m_txs[_h].value != 0 || m_txs[_h].data.length != 0) {\n      address created;\n      if (m_txs[_h].to == 0) {\n        created = create(m_txs[_h].value, m_txs[_h].data);\n      } else {\n        if (!m_txs[_h].to.call.value(m_txs[_h].value)(m_txs[_h].data))\n          throw;\n      }\n\n      MultiTransact(msg.sender, _h, m_txs[_h].value, m_txs[_h].to, m_txs[_h].data, created);\n      delete m_txs[_h];\n      return true;\n    }\n  }", "highlightLines": [267]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 267, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "b1eb0f6df30a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "      address created;", "highlightLines": [269]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 269, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "08c4a0148153", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "      if (m_txs[_h].to == 0) {\n        created = create(m_txs[_h].value, m_txs[_h].data);\n      } else {\n        if (!m_txs[_h].to.call.value(m_txs[_h].value)(m_txs[_h].data))\n          throw;\n      }", "highlightLines": [270]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 270, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "6efe119d2bbf", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "          throw;", "highlightLines": [274]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 274, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "74683b0f043f", "fix": {"template": null, "available": false}, "title": "Deleting mapping inside struct leaves nested data - use separate mapping deletion", "ruleId": "rules.sol-mapping-deletion", "snippet": {"code": "      delete m_txs[_h];", "highlightLines": [278]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 278, "column": 7}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#deletion-on-mapping-containing-a-structure"], "description": ""}, {"id": "5bfbf787b067", "fix": {"template": null, "available": false}, "title": "delete array[i] leaves gap with zero value - use swap-and-pop pattern instead", "ruleId": "rules.sol-array-element-delete", "snippet": {"code": "      delete m_txs[_h];", "highlightLines": [278]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 278, "column": 7}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/Array-deletion.sol"], "description": ""}, {"id": "8e929ed065f0", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint ownerIndex = m_ownerIndex[uint(msg.sender)];", "highlightLines": [287]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 287, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d396571d9843", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint ownerIndex = m_ownerIndex[uint(msg.sender)];\n    // make sure they're an owner\n    if (ownerIndex == 0) return;\n\n    var pending = m_pending[_operation];", "highlightLines": [287]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 287, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "0f7629fccdb0", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "    uint ownerIndex = m_ownerIndex[uint(msg.sender)];", "highlightLines": [287]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 287, "column": 36}, "severity": "info", "references": [], "description": ""}, {"id": "8eacbde75b77", "fix": {"template": null, "available": false}, "title": "Deprecated 'var' keyword can cause type confusion - resolves to smallest type (e.g., uint8 in loops)", "ruleId": "rules.sol-deprecated-var-keyword", "snippet": {"code": "    var pending = m_pending[_operation];", "highlightLines": [291]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 291, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/honeypots"], "description": ""}, {"id": "b7f261c490bd", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    var pending = m_pending[_operation];\n    // if we're not yet working on this operation, switch over and reset the confirmation status.\n    if (pending.yetNeeded == 0) {\n      // reset count of confirmations needed.\n      pending.yetNeeded = m_required;\n      // reset which owners have confirmed (none) - set our bitmap to 0.\n      pending.ownersDone = 0;\n      pending.index = m_pendingIndex.length++;\n      m_pendingIndex[pending.index] = _operation;\n    }", "highlightLines": [291]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 291, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "dcd5668e07da", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "      pending.yetNeeded = m_required;\n      // reset which owners have confirmed (none) - set our bitmap to 0.\n      pending.ownersDone = 0;", "highlightLines": [295]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 295, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "62d651d59420", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "      pending.ownersDone = 0;\n      pending.index = m_pendingIndex.length++;", "highlightLines": [297]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 297, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "7389b920a5c7", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "      pending.index = m_pendingIndex.length++;\n      m_pendingIndex[pending.index] = _operation;", "highlightLines": [298]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 298, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "224d1a823bff", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint ownerIndexBit = 2**ownerIndex;", "highlightLines": [302]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 302, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "5714af2f69df", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "    if (pending.ownersDone & ownerIndexBit == 0) {", "highlightLines": [304]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 304, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e349395e199d", "fix": {"template": null, "available": false}, "title": "Deleting mapping inside struct leaves nested data - use separate mapping deletion", "ruleId": "rules.sol-mapping-deletion", "snippet": {"code": "        delete m_pending[_operation];", "highlightLines": [310]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 310, "column": 9}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#deletion-on-mapping-containing-a-structure"], "description": ""}, {"id": "1b52dd10d4e0", "fix": {"template": null, "available": false}, "title": "delete array[i] leaves gap with zero value - use swap-and-pop pattern instead", "ruleId": "rules.sol-array-element-delete", "snippet": {"code": "        delete m_pending[_operation];", "highlightLines": [310]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 310, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/Array-deletion.sol"], "description": ""}, {"id": "b09966a113d4", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint free = 1;", "highlightLines": [323]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 323, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d1bb0274d0f1", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint free = 1;\n    while (free < m_numOwners)\n    {\n      while (free < m_numOwners && m_owners[free] != 0) free++;\n      while (m_numOwners > 1 && m_owners[m_numOwners] == 0) m_numOwners--;\n      if (free < m_numOwners && m_owners[m_numOwners] != 0 && m_owners[free] == 0)\n      {\n        m_owners[free] = m_owners[m_numOwners];\n        m_ownerIndex[m_owners[free]] = free;\n        m_owners[m_numOwners] = 0;\n      }\n    }", "highlightLines": [323]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 323, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "b6a04d4383bc", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        m_owners[free] = m_owners[m_numOwners];\n        m_ownerIndex[m_owners[free]] = free;", "highlightLines": [330]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 330, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "0de246c14b5b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        m_ownerIndex[m_owners[free]] = free;\n        m_owners[m_numOwners] = 0;", "highlightLines": [331]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 331, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "6aa35e38d853", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "      m_spentToday = 0;\n      m_lastDay = today();", "highlightLines": [342]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 342, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "2fe5f093867a", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "    // check to see if there's enough left - if so, subtract and return true.\n    // overflow protection                    // dailyLimit check\n    if (m_spentToday + _value >= m_spentToday && m_spentToday + _value <= m_dailyLimit) {\n      m_spentToday += _value;\n      return true;", "highlightLines": [345]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 345, "column": 66}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "c3fd74d68627", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint length = m_pendingIndex.length;", "highlightLines": [358]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 358, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "01c69fb0c9ce", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract Wallet is WalletEvents {\n\n  // WALLET CONSTRUCTOR\n  //   calls the `initWallet` method of the Library in this context\n  function Wallet(address[] _owners, uint _required, uint _daylimit) {\n    // Signature of the Wallet Library's init function\n    bytes4 sig = bytes4(sha3(\"initWallet(address[],uint256,uint256)\"));\n    address target = _walletLibrary;\n\n    // Compute the size of the call data : arrays has 2\n    // 32bytes for offset and length, plus 32bytes per element ;\n    // plus 2 32bytes for each uint\n    uint argarraysize = (2 + _owners.length);\n    uint argsize = (2 + argarraysize) * 32;", "highlightLines": [396]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 396, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "8602d5029522", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function Wallet(address[] _owners, uint _required, uint _daylimit) {\n    // Signature of the Wallet Library's init function\n    bytes4 sig = bytes4(sha3(\"initWallet(address[],uint256,uint256)\"));\n    address target = _walletLibrary;\n\n    // Compute the size of the call data : arrays has 2\n    // 32bytes for offset and length, plus 32bytes per element ;\n    // plus 2 32bytes for each uint\n    uint argarraysize = (2 + _owners.length);\n    uint argsize = (2 + argarraysize) * 32;\n\n    assembly {\n      // Add the signature first to memory\n      mstore(0x0, sig)\n      // Add the call data, which is at the end of the\n      // code\n      codecopy(0x4,  sub(codesize, argsize), argsize)\n      // Delegate call to the library\n      delegatecall(sub(gas, 10000), target, 0x0, add(argsize, 0x4), 0x0, 0x0)\n    }\n  }", "highlightLines": [400]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 400, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "bc1ea5e79ee7", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    bytes4 sig = bytes4(sha3(\"initWallet(address[],uint256,uint256)\"));", "highlightLines": [402]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 402, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "416b952bc40f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    bytes4 sig = bytes4(sha3(\"initWallet(address[],uint256,uint256)\"));\n    address target = _walletLibrary;", "highlightLines": [402]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 402, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "3860da5f2a31", "fix": {"template": null, "available": false}, "title": "sha3() is deprecated - use keccak256() instead", "ruleId": "rules.sol-deprecated-sha3", "snippet": {"code": "    bytes4 sig = bytes4(sha3(\"initWallet(address[],uint256,uint256)\"));", "highlightLines": [402]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 402, "column": 25}, "severity": "info", "references": [], "description": ""}, {"id": "e9ca2a582f0b", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address target = _walletLibrary;", "highlightLines": [403]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 403, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7b4586913288", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    address target = _walletLibrary;\n\n    // Compute the size of the call data : arrays has 2\n    // 32bytes for offset and length, plus 32bytes per element ;\n    // plus 2 32bytes for each uint\n    uint argarraysize = (2 + _owners.length);", "highlightLines": [403]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 403, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "5cb16a3dac78", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint argarraysize = (2 + _owners.length);", "highlightLines": [408]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 408, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4266d77d443e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint argarraysize = (2 + _owners.length);\n    uint argsize = (2 + argarraysize) * 32;", "highlightLines": [408]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 408, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "1c42e230c81b", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint argsize = (2 + argarraysize) * 32;", "highlightLines": [409]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 409, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "bbdc13b48fb2", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "    assembly {", "highlightLines": [411]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 411, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "60256ca0810e", "fix": {"template": null, "available": false}, "title": "Assembly codecopy can deploy arbitrary bytecode - ensure code source is trusted (MagicNumber pattern)", "ruleId": "rules.sol-assembly-codecopy", "snippet": {"code": "      codecopy(0x4,  sub(codesize, argsize), argsize)", "highlightLines": [416]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 416, "column": 7}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/18"], "description": ""}, {"id": "622b8a992ce6", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function() payable {\n    // just being sent some cash?\n    if (msg.value > 0)\n      Deposit(msg.sender, msg.value);\n    else if (msg.data.length > 0)\n      _walletLibrary.delegatecall(msg.data);\n  }", "highlightLines": [425]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 425, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "47e308e1c002", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "      _walletLibrary.delegatecall(msg.data);", "highlightLines": [430]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 430, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "215f34b3d721", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function getOwner(uint ownerIndex) constant returns (address) {\n    return address(m_owners[ownerIndex + 1]);\n  }", "highlightLines": [434]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 434, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "bb9fba212a5d", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "    return _walletLibrary.delegatecall(msg.data);", "highlightLines": [441]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 441, "column": 12}, "severity": "medium", "references": [], "description": ""}, {"id": "4c94d460b2c3", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function isOwner(address _addr) constant returns (bool) {\n    return _walletLibrary.delegatecall(msg.data);\n  }", "highlightLines": [444]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 444, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "fd3dbb36d06f", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "    return _walletLibrary.delegatecall(msg.data);", "highlightLines": [445]}, "category": "code", "location": {"file": "unprotected_function/WalletLibrary_source_code/WalletLibrary.sol", "line": 445, "column": 12}, "severity": "medium", "references": [], "description": ""}, {"id": "b06b06aff9a6", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "  address owner;", "highlightLines": [2]}, "category": "code", "location": {"file": "variable shadowing/inherited_state.sol", "line": 2, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "dfbdd9339311", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "  address owner;", "highlightLines": [2]}, "category": "code", "location": {"file": "variable shadowing/inherited_state.sol", "line": 2, "column": 3}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "3ecb1c9f96c2", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(owner == msg.sender);", "highlightLines": [4]}, "category": "code", "location": {"file": "variable shadowing/inherited_state.sol", "line": 4, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "a29ee48301b2", "fix": {"template": null, "available": false}, "title": "Contract can be destructed by anyone - missing access control on selfdestruct", "ruleId": "rules.sol-accessible-selfdestruct", "snippet": {"code": "    selfdestruct(owner);", "highlightLines": [5]}, "category": "code", "location": {"file": "variable shadowing/inherited_state.sol", "line": 5, "column": 5}, "severity": "high", "references": ["https://www.parity.io/blog/a-postmortem-on-the-parity-multi-sig-library-self-destruct/"], "description": ""}, {"id": "ce2b3e06cf2a", "fix": {"template": null, "available": false}, "title": "Selfdestruct with user-controlled recipient - funds can be sent anywhere", "ruleId": "rules.sol-selfdestruct-arbitrary", "snippet": {"code": "    selfdestruct(owner);", "highlightLines": [5]}, "category": "code", "location": {"file": "variable shadowing/inherited_state.sol", "line": 5, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "5bd99100b4ad", "fix": {"template": null, "available": false}, "title": "selfdestruct can force ETH to any address - contracts cannot prevent receiving ETH this way (Force pattern)", "ruleId": "rules.sol-selfdestruct-force-eth", "snippet": {"code": "    selfdestruct(owner);", "highlightLines": [5]}, "category": "code", "location": {"file": "variable shadowing/inherited_state.sol", "line": 5, "column": 5}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/7"], "description": ""}, {"id": "a1b105f15b79", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract C is Suicidal {\n  address owner;", "highlightLines": [8]}, "category": "code", "location": {"file": "variable shadowing/inherited_state.sol", "line": 8, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "091620c888a6", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "  address owner;", "highlightLines": [9]}, "category": "code", "location": {"file": "variable shadowing/inherited_state.sol", "line": 9, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "5e85b3a682de", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "  address owner;", "highlightLines": [9]}, "category": "code", "location": {"file": "variable shadowing/inherited_state.sol", "line": 9, "column": 3}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "92d599d04e04", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function C() {\n    owner = msg.sender;\n  }", "highlightLines": [10]}, "category": "code", "location": {"file": "variable shadowing/inherited_state.sol", "line": 10, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "758e8133a02c", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "    owner = msg.sender;", "highlightLines": [11]}, "category": "code", "location": {"file": "variable shadowing/inherited_state.sol", "line": 11, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "113908494371", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.15;", "highlightLines": [2]}, "category": "code", "location": {"file": "wrong_constructor_name/Rubixi_source_code/Rubixi.sol", "line": 2, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "945b82de0724", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.15;", "highlightLines": [2]}, "category": "code", "location": {"file": "wrong_constructor_name/Rubixi_source_code/Rubixi.sol", "line": 2, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "26b1eb8a37b5", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "        function DynamicPyramid() {\n                creator = msg.sender;\n        }", "highlightLines": [16]}, "category": "code", "location": {"file": "wrong_constructor_name/Rubixi_source_code/Rubixi.sol", "line": 16, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e3d57e7b142c", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "        modifier onlyowner {\n                if (msg.sender == creator) _;\n        }", "highlightLines": [20]}, "category": "code", "location": {"file": "wrong_constructor_name/Rubixi_source_code/Rubixi.sol", "line": 20, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "9627c627f32c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "                address etherAddress;", "highlightLines": [25]}, "category": "code", "location": {"file": "wrong_constructor_name/Rubixi_source_code/Rubixi.sol", "line": 25, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a029d88c0e8d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "                uint payout;", "highlightLines": [26]}, "category": "code", "location": {"file": "wrong_constructor_name/Rubixi_source_code/Rubixi.sol", "line": 26, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "80c0e2a0420a", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "        function() {\n                init();\n        }", "highlightLines": [32]}, "category": "code", "location": {"file": "wrong_constructor_name/Rubixi_source_code/Rubixi.sol", "line": 32, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "403038279d48", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "                        return;", "highlightLines": [41]}, "category": "code", "location": {"file": "wrong_constructor_name/Rubixi_source_code/Rubixi.sol", "line": 41, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "35bb2bbcf2c0", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n                uint _fee = feePercent;", "highlightLines": [43]}, "category": "code", "location": {"file": "wrong_constructor_name/Rubixi_source_code/Rubixi.sol", "line": 43, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b37db9ac8a94", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "                        uint payoutToSend = participants[payoutOrder].payout;", "highlightLines": [66]}, "category": "code", "location": {"file": "wrong_constructor_name/Rubixi_source_code/Rubixi.sol", "line": 66, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "255ae604d884", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "                        participants[payoutOrder].etherAddress.send(payoutToSend);", "highlightLines": [67]}, "category": "code", "location": {"file": "wrong_constructor_name/Rubixi_source_code/Rubixi.sol", "line": 67, "column": 25}, "severity": "high", "references": [], "description": ""}, {"id": "79dded6e6f99", "fix": {"template": null, "available": false}, "title": "send() return value not checked - Ether may be stuck if recipient reverts", "ruleId": "rules.sol-unchecked-send-return", "snippet": {"code": "                        participants[payoutOrder].etherAddress.send(payoutToSend);", "highlightLines": [67]}, "category": "code", "location": {"file": "wrong_constructor_name/Rubixi_source_code/Rubixi.sol", "line": 67, "column": 63}, "severity": "high", "references": [], "description": ""}, {"id": "e902dc8852eb", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "        function collectAllFees() onlyowner {\n                if (collectedFees == 0) throw;\n\n                creator.send(collectedFees);\n                collectedFees = 0;\n        }", "highlightLines": [75]}, "category": "code", "location": {"file": "wrong_constructor_name/Rubixi_source_code/Rubixi.sol", "line": 75, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "ae7d415b5b4b", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "                if (collectedFees == 0) throw;\n\n                creator.send(collectedFees);", "highlightLines": [76]}, "category": "code", "location": {"file": "wrong_constructor_name/Rubixi_source_code/Rubixi.sol", "line": 76, "column": 41}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "4584fcfca0d4", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "                creator.send(collectedFees);", "highlightLines": [78]}, "category": "code", "location": {"file": "wrong_constructor_name/Rubixi_source_code/Rubixi.sol", "line": 78, "column": 17}, "severity": "high", "references": [], "description": ""}, {"id": "d75bc60989e8", "fix": {"template": null, "available": false}, "title": "send() return value not checked - Ether may be stuck if recipient reverts", "ruleId": "rules.sol-unchecked-send-return", "snippet": {"code": "                creator.send(collectedFees);", "highlightLines": [78]}, "category": "code", "location": {"file": "wrong_constructor_name/Rubixi_source_code/Rubixi.sol", "line": 78, "column": 24}, "severity": "high", "references": [], "description": ""}, {"id": "33185927690a", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "        function collectFeesInEther(uint _amt) onlyowner {\n                _amt *= 1 ether;\n                if (_amt > collectedFees) collectAllFees();\n\n                if (collectedFees == 0) throw;\n\n                creator.send(_amt);\n                collectedFees -= _amt;\n        }", "highlightLines": [82]}, "category": "code", "location": {"file": "wrong_constructor_name/Rubixi_source_code/Rubixi.sol", "line": 82, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d8c581a1efff", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "                if (collectedFees == 0) throw;\n\n                creator.send(_amt);", "highlightLines": [86]}, "category": "code", "location": {"file": "wrong_constructor_name/Rubixi_source_code/Rubixi.sol", "line": 86, "column": 41}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "87650dcf7e9e", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "                creator.send(_amt);", "highlightLines": [88]}, "category": "code", "location": {"file": "wrong_constructor_name/Rubixi_source_code/Rubixi.sol", "line": 88, "column": 17}, "severity": "high", "references": [], "description": ""}, {"id": "40208054531b", "fix": {"template": null, "available": false}, "title": "send() return value not checked - Ether may be stuck if recipient reverts", "ruleId": "rules.sol-unchecked-send-return", "snippet": {"code": "                creator.send(_amt);", "highlightLines": [88]}, "category": "code", "location": {"file": "wrong_constructor_name/Rubixi_source_code/Rubixi.sol", "line": 88, "column": 24}, "severity": "high", "references": [], "description": ""}, {"id": "e980fa8ebbf0", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "        function collectPercentOfFees(uint _pcent) onlyowner {\n                if (collectedFees == 0 || _pcent > 100) throw;\n\n                uint feesToCollect = collectedFees / 100 * _pcent;\n                creator.send(feesToCollect);\n                collectedFees -= feesToCollect;\n        }", "highlightLines": [92]}, "category": "code", "location": {"file": "wrong_constructor_name/Rubixi_source_code/Rubixi.sol", "line": 92, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "567458359720", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "                if (collectedFees == 0 || _pcent > 100) throw;\n\n                uint feesToCollect = collectedFees / 100 * _pcent;", "highlightLines": [93]}, "category": "code", "location": {"file": "wrong_constructor_name/Rubixi_source_code/Rubixi.sol", "line": 93, "column": 57}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "c40d8bb202db", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n                uint feesToCollect = collectedFees / 100 * _pcent;", "highlightLines": [94]}, "category": "code", "location": {"file": "wrong_constructor_name/Rubixi_source_code/Rubixi.sol", "line": 94, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3c67245a5685", "fix": {"template": null, "available": false}, "title": "Division before multiplication causes precision loss", "ruleId": "rules.sol-division-before-multiplication", "snippet": {"code": "                uint feesToCollect = collectedFees / 100 * _pcent;", "highlightLines": [95]}, "category": "code", "location": {"file": "wrong_constructor_name/Rubixi_source_code/Rubixi.sol", "line": 95, "column": 38}, "severity": "medium", "references": [], "description": ""}, {"id": "56f9f980a058", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "                creator.send(feesToCollect);", "highlightLines": [96]}, "category": "code", "location": {"file": "wrong_constructor_name/Rubixi_source_code/Rubixi.sol", "line": 96, "column": 17}, "severity": "high", "references": [], "description": ""}, {"id": "282c521af1d5", "fix": {"template": null, "available": false}, "title": "send() return value not checked - Ether may be stuck if recipient reverts", "ruleId": "rules.sol-unchecked-send-return", "snippet": {"code": "                creator.send(feesToCollect);", "highlightLines": [96]}, "category": "code", "location": {"file": "wrong_constructor_name/Rubixi_source_code/Rubixi.sol", "line": 96, "column": 24}, "severity": "high", "references": [], "description": ""}, {"id": "e2c258e4d42d", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "        function changeOwner(address _owner) onlyowner {\n                creator = _owner;\n        }", "highlightLines": [101]}, "category": "code", "location": {"file": "wrong_constructor_name/Rubixi_source_code/Rubixi.sol", "line": 101, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "668c622e5035", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "        function changeMultiplier(uint _mult) onlyowner {\n                if (_mult > 300 || _mult < 120) throw;\n\n                pyramidMultiplier = _mult;\n        }", "highlightLines": [105]}, "category": "code", "location": {"file": "wrong_constructor_name/Rubixi_source_code/Rubixi.sol", "line": 105, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "c26304c08668", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "                if (_mult > 300 || _mult < 120) throw;\n\n                pyramidMultiplier = _mult;", "highlightLines": [106]}, "category": "code", "location": {"file": "wrong_constructor_name/Rubixi_source_code/Rubixi.sol", "line": 106, "column": 49}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "ecba93ed0267", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "        function changeFeePercentage(uint _fee) onlyowner {\n                if (_fee > 10) throw;\n\n                feePercent = _fee;\n        }", "highlightLines": [111]}, "category": "code", "location": {"file": "wrong_constructor_name/Rubixi_source_code/Rubixi.sol", "line": 111, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "6da60fb9b99f", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "                if (_fee > 10) throw;\n\n                feePercent = _fee;", "highlightLines": [112]}, "category": "code", "location": {"file": "wrong_constructor_name/Rubixi_source_code/Rubixi.sol", "line": 112, "column": 32}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "9ab4189be771", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "        function currentMultiplier() constant returns(uint multiplier, string info) {\n                multiplier = pyramidMultiplier;\n                info = 'This multiplier applies to you as soon as transaction is received, may be lowered to hasten payouts or increased if payouts are fast enough. Due to no float or decimals, multiplier is x100 for a fractional multiplier e.g. 250 is actually a 2.5x multiplier. Capped at 3x max and 1.2x min.';\n        }", "highlightLines": [118]}, "category": "code", "location": {"file": "wrong_constructor_name/Rubixi_source_code/Rubixi.sol", "line": 118, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "6546fccc8e7f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "                multiplier = pyramidMultiplier;\n                info = 'This multiplier applies to you as soon as transaction is received, may be lowered to hasten payouts or increased if payouts are fast enough. Due to no float or decimals, multiplier is x100 for a fractional multiplier e.g. 250 is actually a 2.5x multiplier. Capped at 3x max and 1.2x min.';", "highlightLines": [119]}, "category": "code", "location": {"file": "wrong_constructor_name/Rubixi_source_code/Rubixi.sol", "line": 119, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "0c0591a24351", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "        function currentFeePercentage() constant returns(uint fee, string info) {\n                fee = feePercent;\n                info = 'Shown in % form. Fee is halved(50%) for amounts equal or greater than 50 ethers. (Fee may change, but is capped to a maximum of 10%)';\n        }", "highlightLines": [123]}, "category": "code", "location": {"file": "wrong_constructor_name/Rubixi_source_code/Rubixi.sol", "line": 123, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "1b7a29810e60", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "                fee = feePercent;\n                info = 'Shown in % form. Fee is halved(50%) for amounts equal or greater than 50 ethers. (Fee may change, but is capped to a maximum of 10%)';", "highlightLines": [124]}, "category": "code", "location": {"file": "wrong_constructor_name/Rubixi_source_code/Rubixi.sol", "line": 124, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "12c4e565f09e", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "        function currentPyramidBalanceApproximately() constant returns(uint pyramidBalance, string info) {\n                pyramidBalance = balance / 1 ether;\n                info = 'All balance values are measured in Ethers, note that due to no decimal placing, these values show up as integers only, within the contract itself you will get the exact decimal value you are supposed to';\n        }", "highlightLines": [128]}, "category": "code", "location": {"file": "wrong_constructor_name/Rubixi_source_code/Rubixi.sol", "line": 128, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "4be6ac6c3993", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "                pyramidBalance = balance / 1 ether;\n                info = 'All balance values are measured in Ethers, note that due to no decimal placing, these values show up as integers only, within the contract itself you will get the exact decimal value you are supposed to';", "highlightLines": [129]}, "category": "code", "location": {"file": "wrong_constructor_name/Rubixi_source_code/Rubixi.sol", "line": 129, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "24051982a0eb", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "        function nextPayoutWhenPyramidBalanceTotalsApproximately() constant returns(uint balancePayout) {\n                balancePayout = participants[payoutOrder].payout / 1 ether;\n        }", "highlightLines": [133]}, "category": "code", "location": {"file": "wrong_constructor_name/Rubixi_source_code/Rubixi.sol", "line": 133, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "c76bf2fcf45f", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "        function feesSeperateFromBalanceApproximately() constant returns(uint fees) {\n                fees = collectedFees / 1 ether;\n        }", "highlightLines": [137]}, "category": "code", "location": {"file": "wrong_constructor_name/Rubixi_source_code/Rubixi.sol", "line": 137, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "aae746b63e6a", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "        function totalParticipants() constant returns(uint count) {\n                count = participants.length;\n        }", "highlightLines": [141]}, "category": "code", "location": {"file": "wrong_constructor_name/Rubixi_source_code/Rubixi.sol", "line": 141, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d2e2f8d25a8c", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "        function numberOfParticipantsWaitingForPayout() constant returns(uint count) {\n                count = participants.length - payoutOrder;\n        }", "highlightLines": [145]}, "category": "code", "location": {"file": "wrong_constructor_name/Rubixi_source_code/Rubixi.sol", "line": 145, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "59ec1f27a64b", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "        function participantDetails(uint orderInPyramid) constant returns(address Address, uint Payout) {\n                if (orderInPyramid <= participants.length) {\n                        Address = participants[orderInPyramid].etherAddress;\n                        Payout = participants[orderInPyramid].payout / 1 ether;\n                }\n        }", "highlightLines": [149]}, "category": "code", "location": {"file": "wrong_constructor_name/Rubixi_source_code/Rubixi.sol", "line": 149, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "7b33ce35170c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "                        Address = participants[orderInPyramid].etherAddress;\n                        Payout = participants[orderInPyramid].payout / 1 ether;", "highlightLines": [151]}, "category": "code", "location": {"file": "wrong_constructor_name/Rubixi_source_code/Rubixi.sol", "line": 151, "column": 25}, "severity": "medium", "references": [], "description": ""}, {"id": "8c544e9cf685", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.15;", "highlightLines": [1]}, "category": "code", "location": {"file": "wrong_constructor_name/incorrect_constructor.sol", "line": 1, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "39613f173d44", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.15;", "highlightLines": [1]}, "category": "code", "location": {"file": "wrong_constructor_name/incorrect_constructor.sol", "line": 1, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "5b0517cee733", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyowner {\n        require(msg.sender==owner);\n        _;\n    }", "highlightLines": [6]}, "category": "code", "location": {"file": "wrong_constructor_name/incorrect_constructor.sol", "line": 6, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "1b6d13ad5b93", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "        require(msg.sender==owner);", "highlightLines": [7]}, "category": "code", "location": {"file": "wrong_constructor_name/incorrect_constructor.sol", "line": 7, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "adea7b07a135", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender==owner);", "highlightLines": [7]}, "category": "code", "location": {"file": "wrong_constructor_name/incorrect_constructor.sol", "line": 7, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "48af273a167a", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [8]}, "category": "code", "location": {"file": "wrong_constructor_name/incorrect_constructor.sol", "line": 8, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "8b033cc74411", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        owner = msg.sender;", "highlightLines": [16]}, "category": "code", "location": {"file": "wrong_constructor_name/incorrect_constructor.sol", "line": 16, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "d4d56837675e", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function withdraw() \n        public \n        onlyowner\n    {", "highlightLines": [19]}, "category": "code", "location": {"file": "wrong_constructor_name/incorrect_constructor.sol", "line": 19, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "0783aab5e217", "fix": {"template": null, "available": false}, "title": "SWC-105: Ether withdrawal without access control - anyone can drain funds", "ruleId": "rules.sol-swc-105-unprotected-withdrawal", "snippet": {"code": "    function withdraw() \n        public \n        onlyowner\n    {\n       owner.transfer(this.balance);", "highlightLines": [19]}, "category": "code", "location": {"file": "wrong_constructor_name/incorrect_constructor.sol", "line": 19, "column": 5}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-105"], "description": ""}, {"id": "dde610680d61", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "       owner.transfer(this.balance);", "highlightLines": [23]}, "category": "code", "location": {"file": "wrong_constructor_name/incorrect_constructor.sol", "line": 23, "column": 8}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "84d17054cf93", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "       owner.transfer(this.balance);", "highlightLines": [23]}, "category": "code", "location": {"file": "wrong_constructor_name/incorrect_constructor.sol", "line": 23, "column": 13}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "debbd2107e2c", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "token = (msg.value", "highlightLines": [301]}, "category": "secrets", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 301}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "b761190bdd84", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "token = HumanStandardToken(_token);", "highlightLines": [399]}, "category": "secrets", "location": {"file": "reentrancy/SpankChain_source_code/SpankChain_Payment.sol", "line": 399}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "ad0df2c16a13", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "Token = rewardToken[address(this)];", "highlightLines": [978]}, "category": "secrets", "location": {"file": "reentrancy/DAO_source_code/DAO.sol", "line": 978}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}]}]