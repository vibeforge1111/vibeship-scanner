[{"findings":[{"id": "b65d913d69a1", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.22;", "highlightLines": [8]}, "category": "code", "location": {"file": "dataset/access_control/FibonacciBalance.sol", "line": 8, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "f814cf5c51f0", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.22;", "highlightLines": [8]}, "category": "code", "location": {"file": "dataset/access_control/FibonacciBalance.sol", "line": 8, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "473b7ea10e38", "fix": {"template": null, "available": false}, "title": "sha3() is deprecated - use keccak256() instead", "ruleId": "rules.sol-deprecated-sha3", "snippet": {"code": "    bytes4 constant fibSig = bytes4(sha3(\"setFibonacci(uint256)\"));", "highlightLines": [19]}, "category": "code", "location": {"file": "dataset/access_control/FibonacciBalance.sol", "line": 19, "column": 37}, "severity": "info", "references": [], "description": ""}, {"id": "9e95fede6a04", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function withdraw() {", "highlightLines": [26]}, "category": "code", "location": {"file": "dataset/access_control/FibonacciBalance.sol", "line": 26, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "735745a80131", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function withdraw() {\n        withdrawalCounter += 1;\n        // calculate the fibonacci number for the current withdrawal user\n        // this sets calculatedFibNumber\n        // <yes> <report> ACCESS_CONTROL\n        require(fibonacciLibrary.delegatecall(fibSig, withdrawalCounter));\n        msg.sender.transfer(calculatedFibNumber * 1 ether);\n    }", "highlightLines": [26]}, "category": "code", "location": {"file": "dataset/access_control/FibonacciBalance.sol", "line": 26, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "6b81210aabb8", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(fibonacciLibrary.delegatecall(fibSig, withdrawalCounter));", "highlightLines": [31]}, "category": "code", "location": {"file": "dataset/access_control/FibonacciBalance.sol", "line": 31, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "6ffe824ee028", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "        require(fibonacciLibrary.delegatecall(fibSig, withdrawalCounter));", "highlightLines": [31]}, "category": "code", "location": {"file": "dataset/access_control/FibonacciBalance.sol", "line": 31, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "7503c832aef7", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        msg.sender.transfer(calculatedFibNumber * 1 ether);", "highlightLines": [32]}, "category": "code", "location": {"file": "dataset/access_control/FibonacciBalance.sol", "line": 32, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "8439cdb23dcf", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(fibonacciLibrary.delegatecall(msg.data));", "highlightLines": [38]}, "category": "code", "location": {"file": "dataset/access_control/FibonacciBalance.sol", "line": 38, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "01e2a2b2f855", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "        require(fibonacciLibrary.delegatecall(msg.data));", "highlightLines": [38]}, "category": "code", "location": {"file": "dataset/access_control/FibonacciBalance.sol", "line": 38, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "90f17fa54318", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function fibonacci(uint n) internal returns (uint) {\n        if (n == 0) return start;\n        else if (n == 1) return start + 1;", "highlightLines": [57]}, "category": "code", "location": {"file": "dataset/access_control/FibonacciBalance.sol", "line": 57, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "861db47b2a08", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "        if (n == 0) return start;\n        else if (n == 1) return start + 1;", "highlightLines": [58]}, "category": "code", "location": {"file": "dataset/access_control/FibonacciBalance.sol", "line": 58, "column": 21}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "516f2e2e8c92", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "        else if (n == 1) return start + 1;\n        else return fibonacci(n - 1) + fibonacci(n - 2);", "highlightLines": [59]}, "category": "code", "location": {"file": "dataset/access_control/FibonacciBalance.sol", "line": 59, "column": 26}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "7441f6ac4236", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": " pragma solidity ^0.4.25;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/access_control/arbitrary_location_write_simple.sol", "line": 7, "column": 2}, "severity": "info", "references": [], "description": ""}, {"id": "453856153ee3", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": " pragma solidity ^0.4.25;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/access_control/arbitrary_location_write_simple.sol", "line": 7, "column": 2}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "7d34983792b1", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         bonusCodes = new uint[](0);\n         owner = msg.sender;", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/access_control/arbitrary_location_write_simple.sol", "line": 14, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "b98d5185d313", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "         bonusCodes = new uint[](0);", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/access_control/arbitrary_location_write_simple.sol", "line": 14, "column": 23}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "c7b436ad5ab0", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "         owner = msg.sender;", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/access_control/arbitrary_location_write_simple.sol", "line": 15, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "06b006631f3e", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "         require(0 <= bonusCodes.length); // this condition is always true since array lengths are unsigned", "highlightLines": [27]}, "category": "code", "location": {"file": "dataset/access_control/arbitrary_location_write_simple.sol", "line": 27, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "720c9f4cd002", "fix": {"template": null, "available": false}, "title": "Array length can be manipulated - potential storage slot overflow attack (AlienCodex pattern)", "ruleId": "rules.sol-array-length-manipulation", "snippet": {"code": "         bonusCodes.length--; // an underflow can be caused here", "highlightLines": [28]}, "category": "code", "location": {"file": "dataset/access_control/arbitrary_location_write_simple.sol", "line": 28, "column": 10}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/level/19"], "description": ""}, {"id": "f29a504db532", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "         require(idx < bonusCodes.length);", "highlightLines": [32]}, "category": "code", "location": {"file": "dataset/access_control/arbitrary_location_write_simple.sol", "line": 32, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "39a8e9b5dc51", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "         require(msg.sender == owner);", "highlightLines": [37]}, "category": "code", "location": {"file": "dataset/access_control/arbitrary_location_write_simple.sol", "line": 37, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "b2d449cc4080", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "         require(msg.sender == owner);", "highlightLines": [37]}, "category": "code", "location": {"file": "dataset/access_control/arbitrary_location_write_simple.sol", "line": 37, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "34c2e1f2562f", "fix": {"template": null, "available": false}, "title": "Selfdestruct with user-controlled recipient - funds can be sent anywhere", "ruleId": "rules.sol-selfdestruct-arbitrary", "snippet": {"code": "         selfdestruct(msg.sender);", "highlightLines": [38]}, "category": "code", "location": {"file": "dataset/access_control/arbitrary_location_write_simple.sol", "line": 38, "column": 10}, "severity": "high", "references": [], "description": ""}, {"id": "86a9363f73d6", "fix": {"template": null, "available": false}, "title": "selfdestruct can force ETH to any address - contracts cannot prevent receiving ETH this way (Force pattern)", "ruleId": "rules.sol-selfdestruct-force-eth", "snippet": {"code": "         selfdestruct(msg.sender);", "highlightLines": [38]}, "category": "code", "location": {"file": "dataset/access_control/arbitrary_location_write_simple.sol", "line": 38, "column": 10}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/7"], "description": ""}, {"id": "12c67860e84f", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.24;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/access_control/incorrect_constructor_name1.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "0079bde12131", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.24;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/access_control/incorrect_constructor_name1.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "488511402bee", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyowner {\n        require(msg.sender==owner);\n        _;\n    }", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/access_control/incorrect_constructor_name1.sol", "line": 12, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "3bb94e0594e2", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "        require(msg.sender==owner);", "highlightLines": [13]}, "category": "code", "location": {"file": "dataset/access_control/incorrect_constructor_name1.sol", "line": 13, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "dbf9a5df6fb9", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender==owner);", "highlightLines": [13]}, "category": "code", "location": {"file": "dataset/access_control/incorrect_constructor_name1.sol", "line": 13, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "c0f394db28f9", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/access_control/incorrect_constructor_name1.sol", "line": 14, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "9f6ca253bc6d", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        owner = msg.sender;", "highlightLines": [23]}, "category": "code", "location": {"file": "dataset/access_control/incorrect_constructor_name1.sol", "line": 23, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "5a1903c74a93", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function () payable {}", "highlightLines": [26]}, "category": "code", "location": {"file": "dataset/access_control/incorrect_constructor_name1.sol", "line": 26, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "4686610eebb7", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function withdraw()\n        public\n        onlyowner\n    {", "highlightLines": [28]}, "category": "code", "location": {"file": "dataset/access_control/incorrect_constructor_name1.sol", "line": 28, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "becffc5113f4", "fix": {"template": null, "available": false}, "title": "SWC-105: Ether withdrawal without access control - anyone can drain funds", "ruleId": "rules.sol-swc-105-unprotected-withdrawal", "snippet": {"code": "    function withdraw()\n        public\n        onlyowner\n    {\n       owner.transfer(this.balance);", "highlightLines": [28]}, "category": "code", "location": {"file": "dataset/access_control/incorrect_constructor_name1.sol", "line": 28, "column": 5}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-105"], "description": ""}, {"id": "d27877e325d7", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "       owner.transfer(this.balance);", "highlightLines": [32]}, "category": "code", "location": {"file": "dataset/access_control/incorrect_constructor_name1.sol", "line": 32, "column": 8}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "02d51010ed13", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "       owner.transfer(this.balance);", "highlightLines": [32]}, "category": "code", "location": {"file": "dataset/access_control/incorrect_constructor_name1.sol", "line": 32, "column": 13}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "9861d5881b4e", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.24;", "highlightLines": [8]}, "category": "code", "location": {"file": "dataset/access_control/incorrect_constructor_name2.sol", "line": 8, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "f6d74ae50aa5", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.24;", "highlightLines": [8]}, "category": "code", "location": {"file": "dataset/access_control/incorrect_constructor_name2.sol", "line": 8, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "368e5c9d4dc2", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyowner {\n        require(msg.sender==owner);\n        _;\n    }", "highlightLines": [13]}, "category": "code", "location": {"file": "dataset/access_control/incorrect_constructor_name2.sol", "line": 13, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "85d5b90090c3", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "        require(msg.sender==owner);", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/access_control/incorrect_constructor_name2.sol", "line": 14, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "42056db1ddfc", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender==owner);", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/access_control/incorrect_constructor_name2.sol", "line": 14, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "7f403d1a4cbf", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/access_control/incorrect_constructor_name2.sol", "line": 15, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "d399964794c9", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        owner = msg.sender;", "highlightLines": [21]}, "category": "code", "location": {"file": "dataset/access_control/incorrect_constructor_name2.sol", "line": 21, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "33dcbaa4d86d", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function () payable {}", "highlightLines": [24]}, "category": "code", "location": {"file": "dataset/access_control/incorrect_constructor_name2.sol", "line": 24, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "5607615448a8", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function withdraw()\n        public\n        onlyowner\n    {", "highlightLines": [26]}, "category": "code", "location": {"file": "dataset/access_control/incorrect_constructor_name2.sol", "line": 26, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "d6a746f8fa4f", "fix": {"template": null, "available": false}, "title": "SWC-105: Ether withdrawal without access control - anyone can drain funds", "ruleId": "rules.sol-swc-105-unprotected-withdrawal", "snippet": {"code": "    function withdraw()\n        public\n        onlyowner\n    {\n       owner.transfer(this.balance);", "highlightLines": [26]}, "category": "code", "location": {"file": "dataset/access_control/incorrect_constructor_name2.sol", "line": 26, "column": 5}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-105"], "description": ""}, {"id": "8c928aa175f5", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "       owner.transfer(this.balance);", "highlightLines": [30]}, "category": "code", "location": {"file": "dataset/access_control/incorrect_constructor_name2.sol", "line": 30, "column": 8}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "adf33e09c2bd", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "       owner.transfer(this.balance);", "highlightLines": [30]}, "category": "code", "location": {"file": "dataset/access_control/incorrect_constructor_name2.sol", "line": 30, "column": 13}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "6a11c163ae5d", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.24;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/access_control/incorrect_constructor_name3.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "54ea92b3045e", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.24;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/access_control/incorrect_constructor_name3.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "92ab47fd1028", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyowner {\n        require(msg.sender==owner);\n        _;\n    }", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/access_control/incorrect_constructor_name3.sol", "line": 12, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "3183de3c875c", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "        require(msg.sender==owner);", "highlightLines": [13]}, "category": "code", "location": {"file": "dataset/access_control/incorrect_constructor_name3.sol", "line": 13, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "b377b92c1e80", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender==owner);", "highlightLines": [13]}, "category": "code", "location": {"file": "dataset/access_control/incorrect_constructor_name3.sol", "line": 13, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "b696493ac8ef", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/access_control/incorrect_constructor_name3.sol", "line": 14, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "12ccc8e24636", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        owner = msg.sender;", "highlightLines": [20]}, "category": "code", "location": {"file": "dataset/access_control/incorrect_constructor_name3.sol", "line": 20, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "ebecd6844221", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function () payable {}", "highlightLines": [23]}, "category": "code", "location": {"file": "dataset/access_control/incorrect_constructor_name3.sol", "line": 23, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "d1bdb233cf01", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function withdraw()\n        public\n        onlyowner\n    {", "highlightLines": [25]}, "category": "code", "location": {"file": "dataset/access_control/incorrect_constructor_name3.sol", "line": 25, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "00393cbdf35f", "fix": {"template": null, "available": false}, "title": "SWC-105: Ether withdrawal without access control - anyone can drain funds", "ruleId": "rules.sol-swc-105-unprotected-withdrawal", "snippet": {"code": "    function withdraw()\n        public\n        onlyowner\n    {\n       owner.transfer(this.balance);", "highlightLines": [25]}, "category": "code", "location": {"file": "dataset/access_control/incorrect_constructor_name3.sol", "line": 25, "column": 5}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-105"], "description": ""}, {"id": "8e0582d2ec6b", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "       owner.transfer(this.balance);", "highlightLines": [29]}, "category": "code", "location": {"file": "dataset/access_control/incorrect_constructor_name3.sol", "line": 29, "column": 8}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "5e788634ea49", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "       owner.transfer(this.balance);", "highlightLines": [29]}, "category": "code", "location": {"file": "dataset/access_control/incorrect_constructor_name3.sol", "line": 29, "column": 13}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "05a008b8888f", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": " pragma solidity ^0.4.24;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/access_control/mapping_write.sol", "line": 7, "column": 2}, "severity": "info", "references": [], "description": ""}, {"id": "e961249af5c2", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": " pragma solidity ^0.4.24;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/access_control/mapping_write.sol", "line": 7, "column": 2}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "83ee9d813417", "fix": {"template": null, "available": false}, "title": "Direct array length modification can corrupt adjacent storage slots (Mapping pattern)", "ruleId": "rules.sol-dynamic-array-length-write", "snippet": {"code": "             map.length = key + 1;", "highlightLines": [17]}, "category": "code", "location": {"file": "dataset/access_control/mapping_write.sol", "line": 17, "column": 14}, "severity": "high", "references": ["https://capturetheether.com/challenges/math/mapping/"], "description": ""}, {"id": "972c40be0f74", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "     function withdraw() public{", "highlightLines": [26]}, "category": "code", "location": {"file": "dataset/access_control/mapping_write.sol", "line": 26, "column": 6}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "e4921c6e5550", "fix": {"template": null, "available": false}, "title": "SWC-105: Ether withdrawal without access control - anyone can drain funds", "ruleId": "rules.sol-swc-105-unprotected-withdrawal", "snippet": {"code": "     function withdraw() public{\n       require(msg.sender == owner);\n       msg.sender.transfer(address(this).balance);", "highlightLines": [26]}, "category": "code", "location": {"file": "dataset/access_control/mapping_write.sol", "line": 26, "column": 6}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-105"], "description": ""}, {"id": "2084444ae7ea", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "       require(msg.sender == owner);", "highlightLines": [27]}, "category": "code", "location": {"file": "dataset/access_control/mapping_write.sol", "line": 27, "column": 8}, "severity": "info", "references": [], "description": ""}, {"id": "37d91068cd5e", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "       require(msg.sender == owner);", "highlightLines": [27]}, "category": "code", "location": {"file": "dataset/access_control/mapping_write.sol", "line": 27, "column": 8}, "severity": "info", "references": [], "description": ""}, {"id": "cea06f4e0c50", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "       msg.sender.transfer(address(this).balance);", "highlightLines": [28]}, "category": "code", "location": {"file": "dataset/access_control/mapping_write.sol", "line": 28, "column": 8}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "cea09f8f6608", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "       msg.sender.transfer(address(this).balance);", "highlightLines": [28]}, "category": "code", "location": {"file": "dataset/access_control/mapping_write.sol", "line": 28, "column": 18}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "0ff17cad424f", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.23;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/access_control/multiowned_vulnerable.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "bd972b2fbb22", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.23;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/access_control/multiowned_vulnerable.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "98f2cb5eeb24", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    root = msg.sender;\n    owners[root] = root;", "highlightLines": [21]}, "category": "code", "location": {"file": "dataset/access_control/multiowned_vulnerable.sol", "line": 21, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "88c8fa8850ac", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  modifier onlyOwner() {\n    require(owners[msg.sender] != 0);\n    _;\n  }", "highlightLines": [28]}, "category": "code", "location": {"file": "dataset/access_control/multiowned_vulnerable.sol", "line": 28, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "aa72d1b6d904", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "  modifier onlyOwner() {\n    require(owners[msg.sender] != 0);\n    _;\n  }", "highlightLines": [28]}, "category": "code", "location": {"file": "dataset/access_control/multiowned_vulnerable.sol", "line": 28, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "2776eb55ddc5", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(owners[msg.sender] != 0);", "highlightLines": [29]}, "category": "code", "location": {"file": "dataset/access_control/multiowned_vulnerable.sol", "line": 29, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "079f91167fe7", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    _;", "highlightLines": [30]}, "category": "code", "location": {"file": "dataset/access_control/multiowned_vulnerable.sol", "line": 30, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "c60bc0ee73bb", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "  function newOwner(address _owner) external returns (bool) {\n    require(_owner != 0);", "highlightLines": [38]}, "category": "code", "location": {"file": "dataset/access_control/multiowned_vulnerable.sol", "line": 38, "column": 3}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "986e193fb109", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - will never return false, only revert", "ruleId": "rules.sol-return-bool-always-reverts", "snippet": {"code": "  function newOwner(address _owner) external returns (bool) {\n    require(_owner != 0);\n    owners[_owner] = msg.sender;\n    return true;\n  }", "highlightLines": [38]}, "category": "code", "location": {"file": "dataset/access_control/multiowned_vulnerable.sol", "line": 38, "column": 3}, "severity": "info", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "523ef00b74f1", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(_owner != 0);", "highlightLines": [39]}, "category": "code", "location": {"file": "dataset/access_control/multiowned_vulnerable.sol", "line": 39, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "752e81223b55", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "  function deleteOwner(address _owner) onlyOwner external returns (bool) {\n    require(owners[_owner] == msg.sender || (owners[_owner] != 0 && msg.sender == root));", "highlightLines": [47]}, "category": "code", "location": {"file": "dataset/access_control/multiowned_vulnerable.sol", "line": 47, "column": 3}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "69206b5e39bd", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - will never return false, only revert", "ruleId": "rules.sol-return-bool-always-reverts", "snippet": {"code": "  function deleteOwner(address _owner) onlyOwner external returns (bool) {\n    require(owners[_owner] == msg.sender || (owners[_owner] != 0 && msg.sender == root));\n    owners[_owner] = 0;\n    return true;\n  }", "highlightLines": [47]}, "category": "code", "location": {"file": "dataset/access_control/multiowned_vulnerable.sol", "line": 47, "column": 3}, "severity": "info", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "d38157a57bfd", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "  function deleteOwner(address _owner) onlyOwner external returns (bool) {", "highlightLines": [47]}, "category": "code", "location": {"file": "dataset/access_control/multiowned_vulnerable.sol", "line": 47, "column": 40}, "severity": "info", "references": [], "description": ""}, {"id": "a09c2d9ec4cd", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(owners[_owner] == msg.sender || (owners[_owner] != 0 && msg.sender == root));", "highlightLines": [48]}, "category": "code", "location": {"file": "dataset/access_control/multiowned_vulnerable.sol", "line": 48, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "a5a18c78a19a", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function withdrawAll() onlyOwner {\n    msg.sender.transfer(this.balance);\n  }", "highlightLines": [56]}, "category": "code", "location": {"file": "dataset/access_control/multiowned_vulnerable.sol", "line": 56, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "3a7ba91ffe20", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "  function withdrawAll() onlyOwner {", "highlightLines": [56]}, "category": "code", "location": {"file": "dataset/access_control/multiowned_vulnerable.sol", "line": 56, "column": 26}, "severity": "info", "references": [], "description": ""}, {"id": "b26687154ac8", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "    msg.sender.transfer(this.balance);", "highlightLines": [57]}, "category": "code", "location": {"file": "dataset/access_control/multiowned_vulnerable.sol", "line": 57, "column": 5}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "b52c9d34d78c", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "    msg.sender.transfer(this.balance);", "highlightLines": [57]}, "category": "code", "location": {"file": "dataset/access_control/multiowned_vulnerable.sol", "line": 57, "column": 15}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "8a363960f62e", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function() payable {\n  }", "highlightLines": [60]}, "category": "code", "location": {"file": "dataset/access_control/multiowned_vulnerable.sol", "line": 60, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "0a054d21dce8", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.24;", "highlightLines": [8]}, "category": "code", "location": {"file": "dataset/access_control/mycontract.sol", "line": 8, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "f9f10b7edf75", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.24;", "highlightLines": [8]}, "category": "code", "location": {"file": "dataset/access_control/mycontract.sol", "line": 8, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "e1da588ff014", "fix": {"template": null, "available": false}, "title": "SWC-118: Function name matches contract name - likely intended as constructor (pre-0.4.22)", "ruleId": "rules.sol-swc-118-constructor-mismatch", "snippet": {"code": "contract MyContract {\n\n    address owner;\n\n    function MyContract() public {", "highlightLines": [10]}, "category": "code", "location": {"file": "dataset/access_control/mycontract.sol", "line": 10, "column": 1}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-118"], "description": ""}, {"id": "a7f1e944cd1a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    address owner;", "highlightLines": [11]}, "category": "code", "location": {"file": "dataset/access_control/mycontract.sol", "line": 11, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e56cc62fb0d1", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "    address owner;", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/access_control/mycontract.sol", "line": 12, "column": 5}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "9dd9bff30a2a", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        owner = msg.sender;", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/access_control/mycontract.sol", "line": 15, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "3c615525c0a1", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(tx.origin == owner);", "highlightLines": [20]}, "category": "code", "location": {"file": "dataset/access_control/mycontract.sol", "line": 20, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "4233ee39be68", "fix": {"template": null, "available": false}, "title": "tx.origin used for authorization - vulnerable to phishing attacks", "ruleId": "rules.sol-tx-origin-auth", "snippet": {"code": "        require(tx.origin == owner);", "highlightLines": [20]}, "category": "code", "location": {"file": "dataset/access_control/mycontract.sol", "line": 20, "column": 9}, "severity": "high", "references": [], "description": ""}, {"id": "4fb65a74d865", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        receiver.transfer(amount);", "highlightLines": [21]}, "category": "code", "location": {"file": "dataset/access_control/mycontract.sol", "line": 21, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "ae1097fe3633", "fix": {"template": null, "available": false}, "title": "Missing zero address validation - tokens/ETH could be lost", "ruleId": "rules.sol-missing-zero-address-check", "snippet": {"code": "        receiver.transfer(amount);", "highlightLines": [21]}, "category": "code", "location": {"file": "dataset/access_control/mycontract.sol", "line": 21, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "1a0a6a3f7069", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity 0.4.9; /* originally ^0.4.9, but doesn't compile with ^0.4.11 */", "highlightLines": [18]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 18, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "abee29efb436", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event Confirmation(address owner, bytes32 operation);", "highlightLines": [25]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 25, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "c25cb68b60b6", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event Confirmation(address owner, bytes32 operation);", "highlightLines": [25]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 25, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "7aa90273bf79", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event Revoke(address owner, bytes32 operation);", "highlightLines": [26]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 26, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "109cd2d3eed4", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event Revoke(address owner, bytes32 operation);", "highlightLines": [26]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 26, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "7efe0f9e6f76", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event OwnerChanged(address oldOwner, address newOwner);", "highlightLines": [29]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 29, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "26ae5b5a4b84", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event OwnerChanged(address oldOwner, address newOwner);", "highlightLines": [29]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 29, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "601d5b0efcd4", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event OwnerAdded(address newOwner);", "highlightLines": [30]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 30, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "f2f45aa53937", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event OwnerAdded(address newOwner);", "highlightLines": [30]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 30, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "636863cb4d3a", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event OwnerRemoved(address oldOwner);", "highlightLines": [31]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 31, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "c6c1c5b25d99", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event OwnerRemoved(address oldOwner);", "highlightLines": [31]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 31, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "83f13128b17c", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event RequirementChanged(uint newRequirement);", "highlightLines": [34]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 34, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "feacece67ee4", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event Deposit(address _from, uint value);", "highlightLines": [37]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 37, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "ad35fa831822", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event Deposit(address _from, uint value);", "highlightLines": [37]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 37, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "d0dba9b6ec9f", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event SingleTransact(address owner, uint value, address to, bytes data, address created);", "highlightLines": [39]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 39, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "b6ff849d6ec1", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event SingleTransact(address owner, uint value, address to, bytes data, address created);", "highlightLines": [39]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 39, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "241bce0e3ffc", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event MultiTransact(address owner, bytes32 operation, uint value, address to, bytes data, address created);", "highlightLines": [41]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 41, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "feda9d26e0a4", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event MultiTransact(address owner, bytes32 operation, uint value, address to, bytes data, address created);", "highlightLines": [41]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 41, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "8e8c2b9c900e", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event ConfirmationNeeded(bytes32 operation, address initiator, uint value, address to, bytes data);", "highlightLines": [43]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 43, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "e404ee1f9ab3", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "  function changeOwner(address _from, address _to) external;", "highlightLines": [51]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 51, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "0b0c4f186ad0", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function changeOwner(address _from, address _to) external;", "highlightLines": [51]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 51, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "ca54add285f2", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function addOwner(address _owner) external;", "highlightLines": [53]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 53, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "197c77120ffe", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function removeOwner(address _owner) external;", "highlightLines": [55]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 55, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "35f099963476", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function isOwner(address _addr) constant returns (bool);", "highlightLines": [59]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 59, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "24acb458144b", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function execute(address _to, uint _value, bytes _data) external returns (bytes32 o_hash);", "highlightLines": [66]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 66, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "538309f0e4b4", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract WalletLibrary is WalletEvents {\n  // TYPES\n\n  // struct for the status of a pending operation.\n  struct PendingState {\n    uint yetNeeded;\n    uint ownersDone;\n    uint index;", "highlightLines": [70]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 70, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "7318775821f5", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint yetNeeded;", "highlightLines": [75]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 75, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b407363e1ed2", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint ownersDone;", "highlightLines": [76]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 76, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4a9e44f1ad24", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint index;", "highlightLines": [77]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 77, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b6edfbe8f71d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address to;", "highlightLines": [82]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 82, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8984cbceadc8", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint value;", "highlightLines": [83]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 83, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "59a7d971240a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    bytes data;", "highlightLines": [84]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 84, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a0c72ba761fc", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  modifier onlyowner {\n    if (isOwner(msg.sender))\n      _;\n  }", "highlightLines": [90]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 90, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "a6d525b6aa40", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "      _;", "highlightLines": [92]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 92, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "b2cd81896cc7", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  modifier onlymanyowners(bytes32 _operation) {\n    if (confirmAndCheck(_operation))\n      _;\n  }", "highlightLines": [97]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 97, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "4342a53fa4ef", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "  modifier onlymanyowners(bytes32 _operation) {\n    if (confirmAndCheck(_operation))\n      _;\n  }", "highlightLines": [97]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 97, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "618bd5c7118c", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "      _;", "highlightLines": [99]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 99, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "123411b047ee", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function() payable {\n    // just being sent some cash?\n    if (msg.value > 0)\n      Deposit(msg.sender, msg.value);\n  }", "highlightLines": [105]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 105, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "49b5bfbf47a5", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function initMultiowned(address[] _owners, uint _required) {\n    m_numOwners = _owners.length + 1;\n    m_owners[1] = uint(msg.sender);\n    m_ownerIndex[uint(msg.sender)] = 1;\n    for (uint i = 0; i < _owners.length; ++i)\n    {\n      m_owners[2 + i] = uint(_owners[i]);\n      m_ownerIndex[uint(_owners[i])] = 2 + i;\n    }\n    m_required = _required;\n  }", "highlightLines": [113]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 113, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "6ffc1349f120", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    m_numOwners = _owners.length + 1;\n    m_owners[1] = uint(msg.sender);", "highlightLines": [114]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 114, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "22926d3ab7bc", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    m_owners[1] = uint(msg.sender);\n    m_ownerIndex[uint(msg.sender)] = 1;", "highlightLines": [115]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 115, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "926c5544748b", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "    m_owners[1] = uint(msg.sender);", "highlightLines": [115]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 115, "column": 19}, "severity": "info", "references": [], "description": ""}, {"id": "ee25b31c4af6", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    m_ownerIndex[uint(msg.sender)] = 1;\n    for (uint i = 0; i < _owners.length; ++i)\n    {\n      m_owners[2 + i] = uint(_owners[i]);\n      m_ownerIndex[uint(_owners[i])] = 2 + i;\n    }", "highlightLines": [116]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 116, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "8c9532ee57a5", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "    m_ownerIndex[uint(msg.sender)] = 1;", "highlightLines": [116]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 116, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "0881c70f0e95", "fix": {"template": null, "available": false}, "title": "Empty array bypasses loop logic - add length check before loop", "ruleId": "rules.sol-empty-array-loop-bypass", "snippet": {"code": "    for (uint i = 0; i < _owners.length; ++i)\n    {", "highlightLines": [117]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 117, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/empty-loop.sol"], "description": ""}, {"id": "020dd281da04", "fix": {"template": null, "available": false}, "title": "Storage variable modified in loop - should cache in memory for gas savings", "ruleId": "rules.sol-memory-vs-storage-loop", "snippet": {"code": "    for (uint i = 0; i < _owners.length; ++i)\n    {\n      m_owners[2 + i] = uint(_owners[i]);", "highlightLines": [117]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 117, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "480a7a883635", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "      m_owners[2 + i] = uint(_owners[i]);\n      m_ownerIndex[uint(_owners[i])] = 2 + i;", "highlightLines": [119]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 119, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "b15505f82672", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "      m_owners[2 + i] = uint(_owners[i]);", "highlightLines": [119]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 119, "column": 25}, "severity": "info", "references": [], "description": ""}, {"id": "ca44fb172871", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "      m_ownerIndex[uint(_owners[i])] = 2 + i;", "highlightLines": [120]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 120, "column": 20}, "severity": "info", "references": [], "description": ""}, {"id": "d5418f08f5ab", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint ownerIndex = m_ownerIndex[uint(msg.sender)];", "highlightLines": [127]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 127, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "aadb9cae2c03", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint ownerIndex = m_ownerIndex[uint(msg.sender)];\n    // make sure they're an owner\n    if (ownerIndex == 0) return;\n    uint ownerIndexBit = 2**ownerIndex;", "highlightLines": [127]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 127, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "a08f550e3de1", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "    uint ownerIndex = m_ownerIndex[uint(msg.sender)];", "highlightLines": [127]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 127, "column": 36}, "severity": "info", "references": [], "description": ""}, {"id": "c75479a84f51", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint ownerIndexBit = 2**ownerIndex;", "highlightLines": [130]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 130, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8565e14b47e5", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint ownerIndexBit = 2**ownerIndex;\n    var pending = m_pending[_operation];", "highlightLines": [130]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 130, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "718bb866af20", "fix": {"template": null, "available": false}, "title": "Deprecated 'var' keyword can cause type confusion - resolves to smallest type (e.g., uint8 in loops)", "ruleId": "rules.sol-deprecated-var-keyword", "snippet": {"code": "    var pending = m_pending[_operation];", "highlightLines": [131]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 131, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/honeypots"], "description": ""}, {"id": "e9925eafd5a3", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "    if (pending.ownersDone & ownerIndexBit > 0) {", "highlightLines": [132]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 132, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "991400ae7f61", "fix": {"template": null, "available": false}, "title": "sha3() is deprecated - use keccak256() instead", "ruleId": "rules.sol-deprecated-sha3", "snippet": {"code": "  function changeOwner(address _from, address _to) onlymanyowners(sha3(msg.data)) external {", "highlightLines": [140]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 140, "column": 67}, "severity": "info", "references": [], "description": ""}, {"id": "4d310712f736", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint ownerIndex = m_ownerIndex[uint(_from)];", "highlightLines": [142]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 142, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "cb8885cebed4", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint ownerIndex = m_ownerIndex[uint(_from)];\n    if (ownerIndex == 0) return;\n\n    clearPending();\n    m_owners[ownerIndex] = uint(_to);", "highlightLines": [142]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 142, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "7c77952b29ec", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "    uint ownerIndex = m_ownerIndex[uint(_from)];", "highlightLines": [142]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 142, "column": 36}, "severity": "info", "references": [], "description": ""}, {"id": "7aa709894042", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    m_owners[ownerIndex] = uint(_to);\n    m_ownerIndex[uint(_from)] = 0;", "highlightLines": [146]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 146, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "9b9ba1119b66", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "    m_owners[ownerIndex] = uint(_to);", "highlightLines": [146]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 146, "column": 28}, "severity": "info", "references": [], "description": ""}, {"id": "a53a57d46466", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    m_ownerIndex[uint(_from)] = 0;\n    m_ownerIndex[uint(_to)] = ownerIndex;", "highlightLines": [147]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 147, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "f49bda03d47e", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "    m_ownerIndex[uint(_from)] = 0;", "highlightLines": [147]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 147, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "a59ff24e2af8", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "    m_ownerIndex[uint(_to)] = ownerIndex;", "highlightLines": [148]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 148, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "6fccfd276fbe", "fix": {"template": null, "available": false}, "title": "sha3() is deprecated - use keccak256() instead", "ruleId": "rules.sol-deprecated-sha3", "snippet": {"code": "  function addOwner(address _owner) onlymanyowners(sha3(msg.data)) external {", "highlightLines": [152]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 152, "column": 52}, "severity": "info", "references": [], "description": ""}, {"id": "6f952bb55e47", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "      return;", "highlightLines": [159]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 159, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "8a6bccd3ea8b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    m_owners[m_numOwners] = uint(_owner);\n    m_ownerIndex[uint(_owner)] = m_numOwners;", "highlightLines": [161]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 161, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "2a82a78f3e93", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "    m_owners[m_numOwners] = uint(_owner);", "highlightLines": [161]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 161, "column": 29}, "severity": "info", "references": [], "description": ""}, {"id": "8ce153831357", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "    m_ownerIndex[uint(_owner)] = m_numOwners;", "highlightLines": [162]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 162, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "ddbe9634eb47", "fix": {"template": null, "available": false}, "title": "sha3() is deprecated - use keccak256() instead", "ruleId": "rules.sol-deprecated-sha3", "snippet": {"code": "  function removeOwner(address _owner) onlymanyowners(sha3(msg.data)) external {", "highlightLines": [166]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 166, "column": 55}, "severity": "info", "references": [], "description": ""}, {"id": "be341974cd7a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint ownerIndex = m_ownerIndex[uint(_owner)];", "highlightLines": [167]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 167, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "bc0371da9b50", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint ownerIndex = m_ownerIndex[uint(_owner)];\n    if (ownerIndex == 0) return;\n    if (m_required > m_numOwners - 1) return;\n\n    m_owners[ownerIndex] = 0;", "highlightLines": [167]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 167, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "51f0e97cc72d", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "    uint ownerIndex = m_ownerIndex[uint(_owner)];", "highlightLines": [167]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 167, "column": 36}, "severity": "info", "references": [], "description": ""}, {"id": "8851f7ae7068", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    m_owners[ownerIndex] = 0;\n    m_ownerIndex[uint(_owner)] = 0;", "highlightLines": [171]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 171, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "cf677c7f5f82", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "    m_ownerIndex[uint(_owner)] = 0;", "highlightLines": [172]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 172, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "ab7187c5aee0", "fix": {"template": null, "available": false}, "title": "sha3() is deprecated - use keccak256() instead", "ruleId": "rules.sol-deprecated-sha3", "snippet": {"code": "  function changeRequirement(uint _newRequired) onlymanyowners(sha3(msg.data)) external {", "highlightLines": [178]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 178, "column": 64}, "severity": "info", "references": [], "description": ""}, {"id": "e7d786f16a5f", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function isOwner(address _addr) constant returns (bool) {\n    return m_ownerIndex[uint(_addr)] > 0;\n  }", "highlightLines": [190]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 190, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "69b2efa91e8e", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "    return m_ownerIndex[uint(_addr)] > 0;", "highlightLines": [191]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 191, "column": 25}, "severity": "info", "references": [], "description": ""}, {"id": "aa791ae54301", "fix": {"template": null, "available": false}, "title": "Deprecated 'var' keyword can cause type confusion - resolves to smallest type (e.g., uint8 in loops)", "ruleId": "rules.sol-deprecated-var-keyword", "snippet": {"code": "    var pending = m_pending[_operation];", "highlightLines": [195]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 195, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/honeypots"], "description": ""}, {"id": "ab648495f0e1", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    var pending = m_pending[_operation];\n    uint ownerIndex = m_ownerIndex[uint(_owner)];", "highlightLines": [195]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 195, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "588ead62a3d2", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint ownerIndex = m_ownerIndex[uint(_owner)];", "highlightLines": [196]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 196, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "fc7bc18d007b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint ownerIndex = m_ownerIndex[uint(_owner)];\n\n    // make sure they're an owner\n    if (ownerIndex == 0) return false;\n\n    // determine the bit to set for this owner.\n    uint ownerIndexBit = 2**ownerIndex;", "highlightLines": [196]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 196, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "c10feeb75e00", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "    uint ownerIndex = m_ownerIndex[uint(_owner)];", "highlightLines": [196]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 196, "column": 36}, "severity": "info", "references": [], "description": ""}, {"id": "c0ddc2ba9898", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint ownerIndexBit = 2**ownerIndex;", "highlightLines": [202]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 202, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "da5e2f364db1", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "    return !(pending.ownersDone & ownerIndexBit == 0);", "highlightLines": [203]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 203, "column": 14}, "severity": "medium", "references": [], "description": ""}, {"id": "87ce660784ac", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function initDaylimit(uint _limit) {\n    m_dailyLimit = _limit;\n    m_lastDay = today();\n  }", "highlightLines": [207]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 207, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "33d1ed22b202", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    m_dailyLimit = _limit;\n    m_lastDay = today();", "highlightLines": [208]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 208, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "5b73cbf61e46", "fix": {"template": null, "available": false}, "title": "sha3() is deprecated - use keccak256() instead", "ruleId": "rules.sol-deprecated-sha3", "snippet": {"code": "  function setDailyLimit(uint _newLimit) onlymanyowners(sha3(msg.data)) external {", "highlightLines": [212]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 212, "column": 57}, "severity": "info", "references": [], "description": ""}, {"id": "689e29d9a20e", "fix": {"template": null, "available": false}, "title": "sha3() is deprecated - use keccak256() instead", "ruleId": "rules.sol-deprecated-sha3", "snippet": {"code": "  function resetSpentToday() onlymanyowners(sha3(msg.data)) external {", "highlightLines": [216]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 216, "column": 45}, "severity": "info", "references": [], "description": ""}, {"id": "1629e61eda16", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function initWallet(address[] _owners, uint _required, uint _daylimit) {\n    initDaylimit(_daylimit);\n    initMultiowned(_owners, _required);\n  }", "highlightLines": [223]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 223, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "77d1b6218dea", "fix": {"template": null, "available": false}, "title": "sha3() is deprecated - use keccak256() instead", "ruleId": "rules.sol-deprecated-sha3", "snippet": {"code": "  function kill(address _to) onlymanyowners(sha3(msg.data)) external {", "highlightLines": [229]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 229, "column": 45}, "severity": "info", "references": [], "description": ""}, {"id": "600048179f46", "fix": {"template": null, "available": false}, "title": "Contract can be destructed by anyone - missing access control on selfdestruct", "ruleId": "rules.sol-accessible-selfdestruct", "snippet": {"code": "    suicide(_to);", "highlightLines": [230]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 230, "column": 5}, "severity": "high", "references": ["https://www.parity.io/blog/a-postmortem-on-the-parity-multi-sig-library-self-destruct/"], "description": ""}, {"id": "4fd32f800a96", "fix": {"template": null, "available": false}, "title": "suicide() is deprecated - use selfdestruct() instead", "ruleId": "rules.sol-deprecated-suicide", "snippet": {"code": "    suicide(_to);", "highlightLines": [230]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 230, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "bea01f951ac4", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "  // If not, goes into multisig process. We provide a hash on return to allow the sender to provide\n  // shortcuts for the other confirmations (allowing them to avoid replicating the _to, _value\n  // and _data arguments). They still get the option of using them if they want, anyways.\n  function execute(address _to, uint _value, bytes _data) external onlyowner returns (bytes32 o_hash) {\n    // first, take the opportunity to check that we're under the daily limit.\n    if ((_data.length == 0 && underLimit(_value)) || m_required == 1) {\n      // yes - just execute the call.\n      address created;\n      if (_to == 0) {", "highlightLines": [234]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 234, "column": 63}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "1630c196b939", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "  function execute(address _to, uint _value, bytes _data) external onlyowner returns (bytes32 o_hash) {\n    // first, take the opportunity to check that we're under the daily limit.\n    if ((_data.length == 0 && underLimit(_value)) || m_required == 1) {\n      // yes - just execute the call.\n      address created;\n      if (_to == 0) {", "highlightLines": [237]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 237, "column": 3}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "c063dee6b779", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "      address created;", "highlightLines": [241]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 241, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "06517be4b580", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "      if (_to == 0) {\n        created = create(_value, _data);\n      } else {\n        if (!_to.call.value(_value)(_data))\n          throw;\n      }", "highlightLines": [242]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 242, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "aae2dae93f0f", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "          throw;", "highlightLines": [246]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 246, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "c625f430b9f9", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "      o_hash = sha3(msg.data, block.number);\n      // store if it's new\n      if (m_txs[o_hash].to == 0 && m_txs[o_hash].value == 0 && m_txs[o_hash].data.length == 0) {\n        m_txs[o_hash].to = _to;\n        m_txs[o_hash].value = _value;\n        m_txs[o_hash].data = _data;\n      }", "highlightLines": [251]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 251, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "347d150d1b29", "fix": {"template": null, "available": false}, "title": "sha3() is deprecated - use keccak256() instead", "ruleId": "rules.sol-deprecated-sha3", "snippet": {"code": "      o_hash = sha3(msg.data, block.number);", "highlightLines": [251]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 251, "column": 16}, "severity": "info", "references": [], "description": ""}, {"id": "1412307d3478", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        m_txs[o_hash].to = _to;\n        m_txs[o_hash].value = _value;", "highlightLines": [254]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 254, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "6a1106c80c57", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        m_txs[o_hash].value = _value;\n        m_txs[o_hash].data = _data;", "highlightLines": [255]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 255, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "1ab6a3b96019", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "    assembly {", "highlightLines": [265]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 265, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "5d2e3ca9c31c", "fix": {"template": null, "available": false}, "title": "Raw bytecode deployment via create/create2 - verify bytecode source and intent (MagicNumber pattern)", "ruleId": "rules.sol-raw-bytecode-create", "snippet": {"code": "      o_addr := create(_value, add(_code, 0x20), mload(_code))", "highlightLines": [266]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 266, "column": 17}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/18"], "description": ""}, {"id": "10f592bb7476", "fix": {"template": null, "available": false}, "title": "extcodesize check can be bypassed during constructor - contracts have size 0 while being created", "ruleId": "rules.sol-extcodesize-check", "snippet": {"code": "      jumpi(invalidJumpLabel, iszero(extcodesize(o_addr)))", "highlightLines": [267]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 267, "column": 38}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/18"], "description": ""}, {"id": "0f83b34dbea5", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function confirm(bytes32 _h) onlymanyowners(_h) returns (bool o_success) {\n    if (m_txs[_h].to != 0 || m_txs[_h].value != 0 || m_txs[_h].data.length != 0) {\n      address created;\n      if (m_txs[_h].to == 0) {\n        created = create(m_txs[_h].value, m_txs[_h].data);\n      } else {\n        if (!m_txs[_h].to.call.value(m_txs[_h].value)(m_txs[_h].data))\n          throw;\n      }\n\n      MultiTransact(msg.sender, _h, m_txs[_h].value, m_txs[_h].to, m_txs[_h].data, created);\n      delete m_txs[_h];\n      return true;\n    }\n  }", "highlightLines": [273]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 273, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "33a90e80044f", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "      address created;", "highlightLines": [275]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 275, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "6d89dfafc90c", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "      if (m_txs[_h].to == 0) {\n        created = create(m_txs[_h].value, m_txs[_h].data);\n      } else {\n        if (!m_txs[_h].to.call.value(m_txs[_h].value)(m_txs[_h].data))\n          throw;\n      }", "highlightLines": [276]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 276, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "e175f6f70de9", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "          throw;", "highlightLines": [280]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 280, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "cc7ab17a2974", "fix": {"template": null, "available": false}, "title": "Deleting mapping inside struct leaves nested data - use separate mapping deletion", "ruleId": "rules.sol-mapping-deletion", "snippet": {"code": "      delete m_txs[_h];", "highlightLines": [284]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 284, "column": 7}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#deletion-on-mapping-containing-a-structure"], "description": ""}, {"id": "0756044b1280", "fix": {"template": null, "available": false}, "title": "delete array[i] leaves gap with zero value - use swap-and-pop pattern instead", "ruleId": "rules.sol-array-element-delete", "snippet": {"code": "      delete m_txs[_h];", "highlightLines": [284]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 284, "column": 7}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/Array-deletion.sol"], "description": ""}, {"id": "4fd5a6b8f78d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint ownerIndex = m_ownerIndex[uint(msg.sender)];", "highlightLines": [293]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 293, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7467f1907bd7", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint ownerIndex = m_ownerIndex[uint(msg.sender)];\n    // make sure they're an owner\n    if (ownerIndex == 0) return;\n\n    var pending = m_pending[_operation];", "highlightLines": [293]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 293, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "41306a711652", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "    uint ownerIndex = m_ownerIndex[uint(msg.sender)];", "highlightLines": [293]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 293, "column": 36}, "severity": "info", "references": [], "description": ""}, {"id": "840117cbc09c", "fix": {"template": null, "available": false}, "title": "Deprecated 'var' keyword can cause type confusion - resolves to smallest type (e.g., uint8 in loops)", "ruleId": "rules.sol-deprecated-var-keyword", "snippet": {"code": "    var pending = m_pending[_operation];", "highlightLines": [297]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 297, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/honeypots"], "description": ""}, {"id": "194eebeeb735", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    var pending = m_pending[_operation];\n    // if we're not yet working on this operation, switch over and reset the confirmation status.\n    if (pending.yetNeeded == 0) {\n      // reset count of confirmations needed.\n      pending.yetNeeded = m_required;\n      // reset which owners have confirmed (none) - set our bitmap to 0.\n      pending.ownersDone = 0;\n      pending.index = m_pendingIndex.length++;\n      m_pendingIndex[pending.index] = _operation;\n    }", "highlightLines": [297]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 297, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "a5c68d284619", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "      pending.yetNeeded = m_required;\n      // reset which owners have confirmed (none) - set our bitmap to 0.\n      pending.ownersDone = 0;", "highlightLines": [301]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 301, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "23433b605eec", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "      pending.ownersDone = 0;\n      pending.index = m_pendingIndex.length++;", "highlightLines": [303]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 303, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "04547020c309", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "      pending.index = m_pendingIndex.length++;\n      m_pendingIndex[pending.index] = _operation;", "highlightLines": [304]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 304, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "5c98314089ce", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint ownerIndexBit = 2**ownerIndex;", "highlightLines": [308]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 308, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0c434bd4b8d4", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "    if (pending.ownersDone & ownerIndexBit == 0) {", "highlightLines": [310]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 310, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "619351d3b1a4", "fix": {"template": null, "available": false}, "title": "Deleting mapping inside struct leaves nested data - use separate mapping deletion", "ruleId": "rules.sol-mapping-deletion", "snippet": {"code": "        delete m_pending[_operation];", "highlightLines": [316]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 316, "column": 9}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#deletion-on-mapping-containing-a-structure"], "description": ""}, {"id": "6a425f2dcef6", "fix": {"template": null, "available": false}, "title": "delete array[i] leaves gap with zero value - use swap-and-pop pattern instead", "ruleId": "rules.sol-array-element-delete", "snippet": {"code": "        delete m_pending[_operation];", "highlightLines": [316]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 316, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/Array-deletion.sol"], "description": ""}, {"id": "a35a36634ff0", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint free = 1;", "highlightLines": [329]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 329, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e89893ea78a1", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint free = 1;\n    while (free < m_numOwners)\n    {\n      while (free < m_numOwners && m_owners[free] != 0) free++;\n      while (m_numOwners > 1 && m_owners[m_numOwners] == 0) m_numOwners--;\n      if (free < m_numOwners && m_owners[m_numOwners] != 0 && m_owners[free] == 0)\n      {\n        m_owners[free] = m_owners[m_numOwners];\n        m_ownerIndex[m_owners[free]] = free;\n        m_owners[m_numOwners] = 0;\n      }\n    }", "highlightLines": [329]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 329, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "20f11d4fa1a2", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        m_owners[free] = m_owners[m_numOwners];\n        m_ownerIndex[m_owners[free]] = free;", "highlightLines": [336]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 336, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "6530d77b01c9", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        m_ownerIndex[m_owners[free]] = free;\n        m_owners[m_numOwners] = 0;", "highlightLines": [337]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 337, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "9d45caa79b79", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "      m_spentToday = 0;\n      m_lastDay = today();", "highlightLines": [348]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 348, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "e78967725a50", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "    // check to see if there's enough left - if so, subtract and return true.\n    // overflow protection                    // dailyLimit check\n    if (m_spentToday + _value >= m_spentToday && m_spentToday + _value <= m_dailyLimit) {\n      m_spentToday += _value;\n      return true;", "highlightLines": [351]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 351, "column": 66}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "a3afffc45c16", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint length = m_pendingIndex.length;", "highlightLines": [364]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 364, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b6b8553bc1fc", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract Wallet is WalletEvents {\n\n  // WALLET CONSTRUCTOR\n  //   calls the `initWallet` method of the Library in this context\n  function Wallet(address[] _owners, uint _required, uint _daylimit) {\n    // Signature of the Wallet Library's init function\n    bytes4 sig = bytes4(sha3(\"initWallet(address[],uint256,uint256)\"));\n    address target = _walletLibrary;\n\n    // Compute the size of the call data : arrays has 2\n    // 32bytes for offset and length, plus 32bytes per element ;\n    // plus 2 32bytes for each uint\n    uint argarraysize = (2 + _owners.length);\n    uint argsize = (2 + argarraysize) * 32;", "highlightLines": [402]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 402, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "5a177959c35d", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function Wallet(address[] _owners, uint _required, uint _daylimit) {\n    // Signature of the Wallet Library's init function\n    bytes4 sig = bytes4(sha3(\"initWallet(address[],uint256,uint256)\"));\n    address target = _walletLibrary;\n\n    // Compute the size of the call data : arrays has 2\n    // 32bytes for offset and length, plus 32bytes per element ;\n    // plus 2 32bytes for each uint\n    uint argarraysize = (2 + _owners.length);\n    uint argsize = (2 + argarraysize) * 32;\n\n    assembly {\n      // Add the signature first to memory\n      mstore(0x0, sig)\n      // Add the call data, which is at the end of the\n      // code\n      codecopy(0x4,  sub(codesize, argsize), argsize)\n      // Delegate call to the library\n      delegatecall(sub(gas, 10000), target, 0x0, add(argsize, 0x4), 0x0, 0x0)\n    }\n  }", "highlightLines": [406]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 406, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "687e0e0167c8", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    bytes4 sig = bytes4(sha3(\"initWallet(address[],uint256,uint256)\"));", "highlightLines": [408]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 408, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3e326f4d768a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    bytes4 sig = bytes4(sha3(\"initWallet(address[],uint256,uint256)\"));\n    address target = _walletLibrary;", "highlightLines": [408]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 408, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "9aea26c816ff", "fix": {"template": null, "available": false}, "title": "sha3() is deprecated - use keccak256() instead", "ruleId": "rules.sol-deprecated-sha3", "snippet": {"code": "    bytes4 sig = bytes4(sha3(\"initWallet(address[],uint256,uint256)\"));", "highlightLines": [408]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 408, "column": 25}, "severity": "info", "references": [], "description": ""}, {"id": "14cd05fbf50a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address target = _walletLibrary;", "highlightLines": [409]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 409, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "350298672ab6", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    address target = _walletLibrary;\n\n    // Compute the size of the call data : arrays has 2\n    // 32bytes for offset and length, plus 32bytes per element ;\n    // plus 2 32bytes for each uint\n    uint argarraysize = (2 + _owners.length);", "highlightLines": [409]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 409, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "45f51bb5f50a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint argarraysize = (2 + _owners.length);", "highlightLines": [414]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 414, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "2b997e3b9653", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint argarraysize = (2 + _owners.length);\n    uint argsize = (2 + argarraysize) * 32;", "highlightLines": [414]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 414, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "eca1606494dd", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint argsize = (2 + argarraysize) * 32;", "highlightLines": [415]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 415, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "1978aa8feda1", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "    assembly {", "highlightLines": [417]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 417, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "e9c8725fa81d", "fix": {"template": null, "available": false}, "title": "Assembly codecopy can deploy arbitrary bytecode - ensure code source is trusted (MagicNumber pattern)", "ruleId": "rules.sol-assembly-codecopy", "snippet": {"code": "      codecopy(0x4,  sub(codesize, argsize), argsize)", "highlightLines": [422]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 422, "column": 7}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/18"], "description": ""}, {"id": "b5a09a6fdbeb", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function() payable {\n    // just being sent some cash?\n    if (msg.value > 0)\n      Deposit(msg.sender, msg.value);\n    else if (msg.data.length > 0)\n     // <yes> <report> ACCESS_CONTROL\n      _walletLibrary.delegatecall(msg.data); //it should have whitelisted specific methods that the user is allowed to call\n  }", "highlightLines": [431]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 431, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "44d67c19c896", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "      _walletLibrary.delegatecall(msg.data); //it should have whitelisted specific methods that the user is allowed to call", "highlightLines": [437]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 437, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "21cfdbe6e9e9", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function getOwner(uint ownerIndex) constant returns (address) {\n    return address(m_owners[ownerIndex + 1]);\n  }", "highlightLines": [441]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 441, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "1831452577ef", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "    return _walletLibrary.delegatecall(msg.data);", "highlightLines": [448]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 448, "column": 12}, "severity": "medium", "references": [], "description": ""}, {"id": "eee30de35498", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function isOwner(address _addr) constant returns (bool) {\n    return _walletLibrary.delegatecall(msg.data);\n  }", "highlightLines": [451]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 451, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "363ac6a384ff", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "    return _walletLibrary.delegatecall(msg.data);", "highlightLines": [452]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_1.sol", "line": 452, "column": 12}, "severity": "medium", "references": [], "description": ""}, {"id": "abcedabde2f9", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.9;", "highlightLines": [18]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 18, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "5687ec5c2182", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.9;", "highlightLines": [18]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 18, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "bd332a505624", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event Confirmation(address owner, bytes32 operation);", "highlightLines": [25]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 25, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "21f03cdbb73d", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event Confirmation(address owner, bytes32 operation);", "highlightLines": [25]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 25, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "70faee2e634c", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event Revoke(address owner, bytes32 operation);", "highlightLines": [26]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 26, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "c96ed75b5fa6", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event Revoke(address owner, bytes32 operation);", "highlightLines": [26]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 26, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "6b7165c14b98", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event OwnerChanged(address oldOwner, address newOwner);", "highlightLines": [29]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 29, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "11bd7439f2bc", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event OwnerChanged(address oldOwner, address newOwner);", "highlightLines": [29]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 29, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "8ebad258cdf6", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event OwnerAdded(address newOwner);", "highlightLines": [30]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 30, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "41408e3914e6", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event OwnerAdded(address newOwner);", "highlightLines": [30]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 30, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "4107c100e667", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event OwnerRemoved(address oldOwner);", "highlightLines": [31]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 31, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "7bbe11946dda", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event OwnerRemoved(address oldOwner);", "highlightLines": [31]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 31, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "3d6be2c4c52e", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event RequirementChanged(uint newRequirement);", "highlightLines": [34]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 34, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "840ded06119d", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event Deposit(address _from, uint value);", "highlightLines": [37]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 37, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "3c02e91acfca", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event Deposit(address _from, uint value);", "highlightLines": [37]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 37, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "2435dc7a7c9d", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event SingleTransact(address owner, uint value, address to, bytes data, address created);", "highlightLines": [39]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 39, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "93e191e465c4", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event SingleTransact(address owner, uint value, address to, bytes data, address created);", "highlightLines": [39]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 39, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "57bd00af28c9", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event MultiTransact(address owner, bytes32 operation, uint value, address to, bytes data, address created);", "highlightLines": [41]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 41, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "4e08cd6b99ff", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event MultiTransact(address owner, bytes32 operation, uint value, address to, bytes data, address created);", "highlightLines": [41]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 41, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "2c352732894d", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event ConfirmationNeeded(bytes32 operation, address initiator, uint value, address to, bytes data);", "highlightLines": [43]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 43, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "e436f8303d6d", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "  function changeOwner(address _from, address _to) external;", "highlightLines": [51]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 51, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "63876ef43ccb", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function changeOwner(address _from, address _to) external;", "highlightLines": [51]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 51, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "ab5f0b61a74f", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function addOwner(address _owner) external;", "highlightLines": [53]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 53, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "c2b08f11a182", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function removeOwner(address _owner) external;", "highlightLines": [55]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 55, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "92d97bc2c2b4", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function isOwner(address _addr) constant returns (bool);", "highlightLines": [59]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 59, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "d2c638a4fdc2", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function execute(address _to, uint _value, bytes _data) external returns (bytes32 o_hash);", "highlightLines": [66]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 66, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "740f15bebe3c", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract WalletLibrary is WalletEvents {\n  // TYPES\n\n  // struct for the status of a pending operation.\n  struct PendingState {\n    uint yetNeeded;\n    uint ownersDone;\n    uint index;", "highlightLines": [70]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 70, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "05c153b6ee9c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint yetNeeded;", "highlightLines": [75]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 75, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "70d7d79be928", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint ownersDone;", "highlightLines": [76]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 76, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c4776b0884b7", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint index;", "highlightLines": [77]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 77, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "aaa536b7dd57", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address to;", "highlightLines": [82]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 82, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0d6de7939a38", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint value;", "highlightLines": [83]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 83, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "1076095261f2", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    bytes data;", "highlightLines": [84]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 84, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "973e99c37377", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  modifier onlyowner {\n    if (isOwner(msg.sender))\n      _;\n  }", "highlightLines": [90]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 90, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "0e390dea42c9", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "      _;", "highlightLines": [92]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 92, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "a73c04447246", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  modifier onlymanyowners(bytes32 _operation) {\n    if (confirmAndCheck(_operation))\n      _;\n  }", "highlightLines": [97]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 97, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "e625c4b2e942", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "  modifier onlymanyowners(bytes32 _operation) {\n    if (confirmAndCheck(_operation))\n      _;\n  }", "highlightLines": [97]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 97, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "c14476b4fad1", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "      _;", "highlightLines": [99]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 99, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "c903c77a62d7", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function() payable {\n    // just being sent some cash?\n    if (msg.value > 0)\n      Deposit(msg.sender, msg.value);\n  }", "highlightLines": [105]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 105, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "5c57d1f267bb", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function initMultiowned(address[] _owners, uint _required) only_uninitialized {\n    m_numOwners = _owners.length + 1;\n    m_owners[1] = uint(msg.sender);\n    m_ownerIndex[uint(msg.sender)] = 1;\n    for (uint i = 0; i < _owners.length; ++i)\n    {\n      m_owners[2 + i] = uint(_owners[i]);\n      m_ownerIndex[uint(_owners[i])] = 2 + i;\n    }\n    m_required = _required;\n  }", "highlightLines": [113]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 113, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "5a8e4fdd9cf2", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    m_numOwners = _owners.length + 1;\n    m_owners[1] = uint(msg.sender);", "highlightLines": [114]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 114, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "446ac8435dce", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    m_owners[1] = uint(msg.sender);\n    m_ownerIndex[uint(msg.sender)] = 1;", "highlightLines": [115]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 115, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "00b94a91f4d1", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "    m_owners[1] = uint(msg.sender);", "highlightLines": [115]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 115, "column": 19}, "severity": "info", "references": [], "description": ""}, {"id": "6da24e0a314b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    m_ownerIndex[uint(msg.sender)] = 1;\n    for (uint i = 0; i < _owners.length; ++i)\n    {\n      m_owners[2 + i] = uint(_owners[i]);\n      m_ownerIndex[uint(_owners[i])] = 2 + i;\n    }", "highlightLines": [116]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 116, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "657602fa3fe7", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "    m_ownerIndex[uint(msg.sender)] = 1;", "highlightLines": [116]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 116, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "cdfe71a3f8b6", "fix": {"template": null, "available": false}, "title": "Empty array bypasses loop logic - add length check before loop", "ruleId": "rules.sol-empty-array-loop-bypass", "snippet": {"code": "    for (uint i = 0; i < _owners.length; ++i)\n    {", "highlightLines": [117]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 117, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/empty-loop.sol"], "description": ""}, {"id": "a7fe1be1e596", "fix": {"template": null, "available": false}, "title": "Storage variable modified in loop - should cache in memory for gas savings", "ruleId": "rules.sol-memory-vs-storage-loop", "snippet": {"code": "    for (uint i = 0; i < _owners.length; ++i)\n    {\n      m_owners[2 + i] = uint(_owners[i]);", "highlightLines": [117]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 117, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "257f9af5f9df", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "      m_owners[2 + i] = uint(_owners[i]);\n      m_ownerIndex[uint(_owners[i])] = 2 + i;", "highlightLines": [119]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 119, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "4213b257c66b", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "      m_owners[2 + i] = uint(_owners[i]);", "highlightLines": [119]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 119, "column": 25}, "severity": "info", "references": [], "description": ""}, {"id": "086202614803", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "      m_ownerIndex[uint(_owners[i])] = 2 + i;", "highlightLines": [120]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 120, "column": 20}, "severity": "info", "references": [], "description": ""}, {"id": "a7750ac0243b", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint ownerIndex = m_ownerIndex[uint(msg.sender)];", "highlightLines": [127]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 127, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c31aadf6c02e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint ownerIndex = m_ownerIndex[uint(msg.sender)];\n    // make sure they're an owner\n    if (ownerIndex == 0) return;\n    uint ownerIndexBit = 2**ownerIndex;", "highlightLines": [127]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 127, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "08fc502224ed", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "    uint ownerIndex = m_ownerIndex[uint(msg.sender)];", "highlightLines": [127]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 127, "column": 36}, "severity": "info", "references": [], "description": ""}, {"id": "98c4b02700e1", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint ownerIndexBit = 2**ownerIndex;", "highlightLines": [130]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 130, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8db93aad9328", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint ownerIndexBit = 2**ownerIndex;\n    var pending = m_pending[_operation];", "highlightLines": [130]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 130, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "5d6dfd4af587", "fix": {"template": null, "available": false}, "title": "Deprecated 'var' keyword can cause type confusion - resolves to smallest type (e.g., uint8 in loops)", "ruleId": "rules.sol-deprecated-var-keyword", "snippet": {"code": "    var pending = m_pending[_operation];", "highlightLines": [131]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 131, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/honeypots"], "description": ""}, {"id": "419adea6faad", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "    if (pending.ownersDone & ownerIndexBit > 0) {", "highlightLines": [132]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 132, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "23a297ae0f22", "fix": {"template": null, "available": false}, "title": "sha3() is deprecated - use keccak256() instead", "ruleId": "rules.sol-deprecated-sha3", "snippet": {"code": "  function changeOwner(address _from, address _to) onlymanyowners(sha3(msg.data)) external {", "highlightLines": [140]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 140, "column": 67}, "severity": "info", "references": [], "description": ""}, {"id": "df8e24fbf33e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint ownerIndex = m_ownerIndex[uint(_from)];", "highlightLines": [142]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 142, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "94f48004fe30", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint ownerIndex = m_ownerIndex[uint(_from)];\n    if (ownerIndex == 0) return;\n\n    clearPending();\n    m_owners[ownerIndex] = uint(_to);", "highlightLines": [142]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 142, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "174cb17fc631", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "    uint ownerIndex = m_ownerIndex[uint(_from)];", "highlightLines": [142]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 142, "column": 36}, "severity": "info", "references": [], "description": ""}, {"id": "8b9862a0f136", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    m_owners[ownerIndex] = uint(_to);\n    m_ownerIndex[uint(_from)] = 0;", "highlightLines": [146]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 146, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "246cf5bd8b93", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "    m_owners[ownerIndex] = uint(_to);", "highlightLines": [146]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 146, "column": 28}, "severity": "info", "references": [], "description": ""}, {"id": "7bd4260e9057", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    m_ownerIndex[uint(_from)] = 0;\n    m_ownerIndex[uint(_to)] = ownerIndex;", "highlightLines": [147]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 147, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "a2dc3894d81d", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "    m_ownerIndex[uint(_from)] = 0;", "highlightLines": [147]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 147, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "c3c2f2e42015", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "    m_ownerIndex[uint(_to)] = ownerIndex;", "highlightLines": [148]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 148, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "44563fde6739", "fix": {"template": null, "available": false}, "title": "sha3() is deprecated - use keccak256() instead", "ruleId": "rules.sol-deprecated-sha3", "snippet": {"code": "  function addOwner(address _owner) onlymanyowners(sha3(msg.data)) external {", "highlightLines": [152]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 152, "column": 52}, "severity": "info", "references": [], "description": ""}, {"id": "45a99800884b", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "      return;", "highlightLines": [159]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 159, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "9f013df04d84", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    m_owners[m_numOwners] = uint(_owner);\n    m_ownerIndex[uint(_owner)] = m_numOwners;", "highlightLines": [161]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 161, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "9435bba4da50", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "    m_owners[m_numOwners] = uint(_owner);", "highlightLines": [161]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 161, "column": 29}, "severity": "info", "references": [], "description": ""}, {"id": "2bd5a7b60396", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "    m_ownerIndex[uint(_owner)] = m_numOwners;", "highlightLines": [162]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 162, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "ba227c591915", "fix": {"template": null, "available": false}, "title": "sha3() is deprecated - use keccak256() instead", "ruleId": "rules.sol-deprecated-sha3", "snippet": {"code": "  function removeOwner(address _owner) onlymanyowners(sha3(msg.data)) external {", "highlightLines": [166]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 166, "column": 55}, "severity": "info", "references": [], "description": ""}, {"id": "490f59f9fbf4", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint ownerIndex = m_ownerIndex[uint(_owner)];", "highlightLines": [167]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 167, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "2d39f3004914", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint ownerIndex = m_ownerIndex[uint(_owner)];\n    if (ownerIndex == 0) return;\n    if (m_required > m_numOwners - 1) return;\n\n    m_owners[ownerIndex] = 0;", "highlightLines": [167]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 167, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "9c1544b79ef6", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "    uint ownerIndex = m_ownerIndex[uint(_owner)];", "highlightLines": [167]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 167, "column": 36}, "severity": "info", "references": [], "description": ""}, {"id": "8040883c19d7", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    m_owners[ownerIndex] = 0;\n    m_ownerIndex[uint(_owner)] = 0;", "highlightLines": [171]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 171, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "12621cb33fb1", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "    m_ownerIndex[uint(_owner)] = 0;", "highlightLines": [172]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 172, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "7a5c3b0d54fe", "fix": {"template": null, "available": false}, "title": "sha3() is deprecated - use keccak256() instead", "ruleId": "rules.sol-deprecated-sha3", "snippet": {"code": "  function changeRequirement(uint _newRequired) onlymanyowners(sha3(msg.data)) external {", "highlightLines": [178]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 178, "column": 64}, "severity": "info", "references": [], "description": ""}, {"id": "1acd2e17c5de", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function isOwner(address _addr) constant returns (bool) {\n    return m_ownerIndex[uint(_addr)] > 0;\n  }", "highlightLines": [190]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 190, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "66f7ae0968fe", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "    return m_ownerIndex[uint(_addr)] > 0;", "highlightLines": [191]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 191, "column": 25}, "severity": "info", "references": [], "description": ""}, {"id": "d8f9938ff6ba", "fix": {"template": null, "available": false}, "title": "Deprecated 'var' keyword can cause type confusion - resolves to smallest type (e.g., uint8 in loops)", "ruleId": "rules.sol-deprecated-var-keyword", "snippet": {"code": "    var pending = m_pending[_operation];", "highlightLines": [195]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 195, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/honeypots"], "description": ""}, {"id": "b54c88bf52ea", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    var pending = m_pending[_operation];\n    uint ownerIndex = m_ownerIndex[uint(_owner)];", "highlightLines": [195]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 195, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "9d1e464f2a3c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint ownerIndex = m_ownerIndex[uint(_owner)];", "highlightLines": [196]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 196, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "be37e179f73e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint ownerIndex = m_ownerIndex[uint(_owner)];\n\n    // make sure they're an owner\n    if (ownerIndex == 0) return false;\n\n    // determine the bit to set for this owner.\n    uint ownerIndexBit = 2**ownerIndex;", "highlightLines": [196]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 196, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "f1f86b188e5f", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "    uint ownerIndex = m_ownerIndex[uint(_owner)];", "highlightLines": [196]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 196, "column": 36}, "severity": "info", "references": [], "description": ""}, {"id": "84429ec06c9b", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint ownerIndexBit = 2**ownerIndex;", "highlightLines": [202]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 202, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0b7cad007a5e", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "    return !(pending.ownersDone & ownerIndexBit == 0);", "highlightLines": [203]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 203, "column": 14}, "severity": "medium", "references": [], "description": ""}, {"id": "99f1e18f4d5f", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function initDaylimit(uint _limit) only_uninitialized {\n    m_dailyLimit = _limit;\n    m_lastDay = today();\n  }", "highlightLines": [207]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 207, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "0e0a364ded44", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    m_dailyLimit = _limit;\n    m_lastDay = today();", "highlightLines": [208]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 208, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "1160c95b469d", "fix": {"template": null, "available": false}, "title": "sha3() is deprecated - use keccak256() instead", "ruleId": "rules.sol-deprecated-sha3", "snippet": {"code": "  function setDailyLimit(uint _newLimit) onlymanyowners(sha3(msg.data)) external {", "highlightLines": [212]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 212, "column": 57}, "severity": "info", "references": [], "description": ""}, {"id": "5a746c931856", "fix": {"template": null, "available": false}, "title": "sha3() is deprecated - use keccak256() instead", "ruleId": "rules.sol-deprecated-sha3", "snippet": {"code": "  function resetSpentToday() onlymanyowners(sha3(msg.data)) external {", "highlightLines": [216]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 216, "column": 45}, "severity": "info", "references": [], "description": ""}, {"id": "874513cc3049", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  modifier only_uninitialized { if (m_numOwners > 0) throw; _; }", "highlightLines": [221]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 221, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "ad9bd7f17b33", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function initWallet(address[] _owners, uint _required, uint _daylimit) only_uninitialized {\n    initDaylimit(_daylimit);\n    initMultiowned(_owners, _required);\n  }", "highlightLines": [226]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 226, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "487f1c474532", "fix": {"template": null, "available": false}, "title": "sha3() is deprecated - use keccak256() instead", "ruleId": "rules.sol-deprecated-sha3", "snippet": {"code": "  function kill(address _to) onlymanyowners(sha3(msg.data)) external {", "highlightLines": [233]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 233, "column": 45}, "severity": "info", "references": [], "description": ""}, {"id": "b7aa9300d772", "fix": {"template": null, "available": false}, "title": "Contract can be destructed by anyone - missing access control on selfdestruct", "ruleId": "rules.sol-accessible-selfdestruct", "snippet": {"code": "    suicide(_to);", "highlightLines": [234]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 234, "column": 5}, "severity": "high", "references": ["https://www.parity.io/blog/a-postmortem-on-the-parity-multi-sig-library-self-destruct/"], "description": ""}, {"id": "c7371b5b7936", "fix": {"template": null, "available": false}, "title": "suicide() is deprecated - use selfdestruct() instead", "ruleId": "rules.sol-deprecated-suicide", "snippet": {"code": "    suicide(_to);", "highlightLines": [234]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 234, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "688076ca0a59", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "  // If not, goes into multisig process. We provide a hash on return to allow the sender to provide\n  // shortcuts for the other confirmations (allowing them to avoid replicating the _to, _value\n  // and _data arguments). They still get the option of using them if they want, anyways.\n  function execute(address _to, uint _value, bytes _data) external onlyowner returns (bytes32 o_hash) {\n    // first, take the opportunity to check that we're under the daily limit.\n    if ((_data.length == 0 && underLimit(_value)) || m_required == 1) {\n      // yes - just execute the call.\n      address created;\n      if (_to == 0) {", "highlightLines": [238]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 238, "column": 63}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "0e7d9dfbff33", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "  function execute(address _to, uint _value, bytes _data) external onlyowner returns (bytes32 o_hash) {\n    // first, take the opportunity to check that we're under the daily limit.\n    if ((_data.length == 0 && underLimit(_value)) || m_required == 1) {\n      // yes - just execute the call.\n      address created;\n      if (_to == 0) {", "highlightLines": [241]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 241, "column": 3}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "a94ccf24803c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "      address created;", "highlightLines": [245]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 245, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "77d0e08f6f8f", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "      if (_to == 0) {\n        created = create(_value, _data);\n      } else {\n        if (!_to.call.value(_value)(_data))\n          throw;\n      }", "highlightLines": [246]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 246, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "6d2f01efa76b", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "          throw;", "highlightLines": [250]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 250, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "45a2c7b68b7d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "      o_hash = sha3(msg.data, block.number);\n      // store if it's new\n      if (m_txs[o_hash].to == 0 && m_txs[o_hash].value == 0 && m_txs[o_hash].data.length == 0) {\n        m_txs[o_hash].to = _to;\n        m_txs[o_hash].value = _value;\n        m_txs[o_hash].data = _data;\n      }", "highlightLines": [255]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 255, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "f10506a4b7a5", "fix": {"template": null, "available": false}, "title": "sha3() is deprecated - use keccak256() instead", "ruleId": "rules.sol-deprecated-sha3", "snippet": {"code": "      o_hash = sha3(msg.data, block.number);", "highlightLines": [255]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 255, "column": 16}, "severity": "info", "references": [], "description": ""}, {"id": "43c6e143100e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        m_txs[o_hash].to = _to;\n        m_txs[o_hash].value = _value;", "highlightLines": [258]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 258, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "8bb8b55ba06d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        m_txs[o_hash].value = _value;\n        m_txs[o_hash].data = _data;", "highlightLines": [259]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 259, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "88068f89bebb", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "    assembly {", "highlightLines": [270]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 270, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "536dbbdb6553", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function confirm(bytes32 _h) onlymanyowners(_h) returns (bool o_success) {\n    if (m_txs[_h].to != 0 || m_txs[_h].value != 0 || m_txs[_h].data.length != 0) {\n      address created;\n      if (m_txs[_h].to == 0) {\n        created = create(m_txs[_h].value, m_txs[_h].data);\n      } else {\n        if (!m_txs[_h].to.call.value(m_txs[_h].value)(m_txs[_h].data))\n          throw;\n      }\n\n      MultiTransact(msg.sender, _h, m_txs[_h].value, m_txs[_h].to, m_txs[_h].data, created);\n      delete m_txs[_h];\n      return true;\n    }\n  }", "highlightLines": [279]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 279, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "7d6cba102f50", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "      address created;", "highlightLines": [281]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 281, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "cee12a0ec369", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "      if (m_txs[_h].to == 0) {\n        created = create(m_txs[_h].value, m_txs[_h].data);\n      } else {\n        if (!m_txs[_h].to.call.value(m_txs[_h].value)(m_txs[_h].data))\n          throw;\n      }", "highlightLines": [282]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 282, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "73c9ec28effa", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "          throw;", "highlightLines": [286]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 286, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "eb439a60d5fb", "fix": {"template": null, "available": false}, "title": "Deleting mapping inside struct leaves nested data - use separate mapping deletion", "ruleId": "rules.sol-mapping-deletion", "snippet": {"code": "      delete m_txs[_h];", "highlightLines": [290]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 290, "column": 7}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#deletion-on-mapping-containing-a-structure"], "description": ""}, {"id": "dbbd9a661781", "fix": {"template": null, "available": false}, "title": "delete array[i] leaves gap with zero value - use swap-and-pop pattern instead", "ruleId": "rules.sol-array-element-delete", "snippet": {"code": "      delete m_txs[_h];", "highlightLines": [290]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 290, "column": 7}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/Array-deletion.sol"], "description": ""}, {"id": "80db40813d2d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint ownerIndex = m_ownerIndex[uint(msg.sender)];", "highlightLines": [299]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 299, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0703b9045f71", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint ownerIndex = m_ownerIndex[uint(msg.sender)];\n    // make sure they're an owner\n    if (ownerIndex == 0) return;\n\n    var pending = m_pending[_operation];", "highlightLines": [299]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 299, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "a1c39354d702", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "    uint ownerIndex = m_ownerIndex[uint(msg.sender)];", "highlightLines": [299]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 299, "column": 36}, "severity": "info", "references": [], "description": ""}, {"id": "6b226bacba39", "fix": {"template": null, "available": false}, "title": "Deprecated 'var' keyword can cause type confusion - resolves to smallest type (e.g., uint8 in loops)", "ruleId": "rules.sol-deprecated-var-keyword", "snippet": {"code": "    var pending = m_pending[_operation];", "highlightLines": [303]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 303, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/honeypots"], "description": ""}, {"id": "3f7d55a77498", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    var pending = m_pending[_operation];\n    // if we're not yet working on this operation, switch over and reset the confirmation status.\n    if (pending.yetNeeded == 0) {\n      // reset count of confirmations needed.\n      pending.yetNeeded = m_required;\n      // reset which owners have confirmed (none) - set our bitmap to 0.\n      pending.ownersDone = 0;\n      pending.index = m_pendingIndex.length++;\n      m_pendingIndex[pending.index] = _operation;\n    }", "highlightLines": [303]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 303, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "fd1e2ea86b9e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "      pending.yetNeeded = m_required;\n      // reset which owners have confirmed (none) - set our bitmap to 0.\n      pending.ownersDone = 0;", "highlightLines": [307]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 307, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "f7296ab8b631", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "      pending.ownersDone = 0;\n      pending.index = m_pendingIndex.length++;", "highlightLines": [309]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 309, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "1b2be6f6fbfe", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "      pending.index = m_pendingIndex.length++;\n      m_pendingIndex[pending.index] = _operation;", "highlightLines": [310]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 310, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "2baf6b9a6c3e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint ownerIndexBit = 2**ownerIndex;", "highlightLines": [314]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 314, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "05b9dfb797e0", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "    if (pending.ownersDone & ownerIndexBit == 0) {", "highlightLines": [316]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 316, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "506270f8a190", "fix": {"template": null, "available": false}, "title": "Deleting mapping inside struct leaves nested data - use separate mapping deletion", "ruleId": "rules.sol-mapping-deletion", "snippet": {"code": "        delete m_pending[_operation];", "highlightLines": [322]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 322, "column": 9}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#deletion-on-mapping-containing-a-structure"], "description": ""}, {"id": "4a7355da683f", "fix": {"template": null, "available": false}, "title": "delete array[i] leaves gap with zero value - use swap-and-pop pattern instead", "ruleId": "rules.sol-array-element-delete", "snippet": {"code": "        delete m_pending[_operation];", "highlightLines": [322]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 322, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/Array-deletion.sol"], "description": ""}, {"id": "f459c02ee9eb", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint free = 1;", "highlightLines": [335]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 335, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "aabf5699502b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint free = 1;\n    while (free < m_numOwners)\n    {\n      while (free < m_numOwners && m_owners[free] != 0) free++;\n      while (m_numOwners > 1 && m_owners[m_numOwners] == 0) m_numOwners--;\n      if (free < m_numOwners && m_owners[m_numOwners] != 0 && m_owners[free] == 0)\n      {\n        m_owners[free] = m_owners[m_numOwners];\n        m_ownerIndex[m_owners[free]] = free;\n        m_owners[m_numOwners] = 0;\n      }\n    }", "highlightLines": [335]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 335, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "d3e92eaad1d2", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        m_owners[free] = m_owners[m_numOwners];\n        m_ownerIndex[m_owners[free]] = free;", "highlightLines": [342]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 342, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "90d887ad6842", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        m_ownerIndex[m_owners[free]] = free;\n        m_owners[m_numOwners] = 0;", "highlightLines": [343]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 343, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "202c20be5b6d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "      m_spentToday = 0;\n      m_lastDay = today();", "highlightLines": [354]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 354, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "13657545ec74", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "    // check to see if there's enough left - if so, subtract and return true.\n    // overflow protection                    // dailyLimit check\n    if (m_spentToday + _value >= m_spentToday && m_spentToday + _value <= m_dailyLimit) {\n      m_spentToday += _value;\n      return true;", "highlightLines": [357]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 357, "column": 66}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "885556aa6a02", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint length = m_pendingIndex.length;", "highlightLines": [370]}, "category": "code", "location": {"file": "dataset/access_control/parity_wallet_bug_2.sol", "line": 370, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f29910710168", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": " pragma solidity ^0.4.22;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/access_control/phishable.sol", "line": 7, "column": 2}, "severity": "info", "references": [], "description": ""}, {"id": "14d6794cfc67", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": " pragma solidity ^0.4.22;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/access_control/phishable.sol", "line": 7, "column": 2}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "110269c83585", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor (address _owner) {\n        owner = _owner;\n    }", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/access_control/phishable.sol", "line": 12, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "1f40ed6887df", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        owner = _owner;", "highlightLines": [13]}, "category": "code", "location": {"file": "dataset/access_control/phishable.sol", "line": 13, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "a065ebe46734", "fix": {"template": null, "available": false}, "title": "SWC-105: Ether withdrawal without access control - anyone can drain funds", "ruleId": "rules.sol-swc-105-unprotected-withdrawal", "snippet": {"code": "    function withdrawAll(address _recipient) public {\n        // <yes> <report> ACCESS_CONTROL\n        require(tx.origin == owner);\n        _recipient.transfer(this.balance);", "highlightLines": [18]}, "category": "code", "location": {"file": "dataset/access_control/phishable.sol", "line": 18, "column": 5}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-105"], "description": ""}, {"id": "457e531c7712", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(tx.origin == owner);", "highlightLines": [20]}, "category": "code", "location": {"file": "dataset/access_control/phishable.sol", "line": 20, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "d64824f149b7", "fix": {"template": null, "available": false}, "title": "tx.origin used for authorization - vulnerable to phishing attacks", "ruleId": "rules.sol-tx-origin-auth", "snippet": {"code": "        require(tx.origin == owner);", "highlightLines": [20]}, "category": "code", "location": {"file": "dataset/access_control/phishable.sol", "line": 20, "column": 9}, "severity": "high", "references": [], "description": ""}, {"id": "39297870171f", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        _recipient.transfer(this.balance);", "highlightLines": [21]}, "category": "code", "location": {"file": "dataset/access_control/phishable.sol", "line": 21, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "236196f14b35", "fix": {"template": null, "available": false}, "title": "Missing zero address validation - tokens/ETH could be lost", "ruleId": "rules.sol-missing-zero-address-check", "snippet": {"code": "        _recipient.transfer(this.balance);", "highlightLines": [21]}, "category": "code", "location": {"file": "dataset/access_control/phishable.sol", "line": 21, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "b2f836c066c8", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "        _recipient.transfer(this.balance);", "highlightLines": [21]}, "category": "code", "location": {"file": "dataset/access_control/phishable.sol", "line": 21, "column": 19}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "2ff6c81bb7f3", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.24;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/access_control/proxy.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "003863eb56ce", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.24;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/access_control/proxy.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "fabc0da4d289", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n  address owner;", "highlightLines": [10]}, "category": "code", "location": {"file": "dataset/access_control/proxy.sol", "line": 10, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "968dcc44513d", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "  address owner;", "highlightLines": [11]}, "category": "code", "location": {"file": "dataset/access_control/proxy.sol", "line": 11, "column": 3}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "56626cc968bf", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "    owner = msg.sender;", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/access_control/proxy.sol", "line": 14, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "43157d35f016", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(callee.delegatecall(_data)); //Use delegatecall with caution and make sure to never call into untrusted contracts", "highlightLines": [19]}, "category": "code", "location": {"file": "dataset/access_control/proxy.sol", "line": 19, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "c8e5ee379726", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "    require(callee.delegatecall(_data)); //Use delegatecall with caution and make sure to never call into untrusted contracts", "highlightLines": [19]}, "category": "code", "location": {"file": "dataset/access_control/proxy.sol", "line": 19, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "9901d63b0ee6", "fix": {"template": null, "available": false}, "title": "Delegatecall to user-controlled address - attacker can execute arbitrary code in contract context", "ruleId": "rules.sol-delegatecall-to-arbitrary-address", "snippet": {"code": "    require(callee.delegatecall(_data)); //Use delegatecall with caution and make sure to never call into untrusted contracts", "highlightLines": [19]}, "category": "code", "location": {"file": "dataset/access_control/proxy.sol", "line": 19, "column": 13}, "severity": "high", "references": ["https://entethalliance.org/specs/ethtrust-sl/v1/#req-1-delegatecall"], "description": ""}, {"id": "e837ae6b4614", "fix": {"template": null, "available": false}, "title": "Delegatecall with user-controlled data - storage slot collision possible", "ruleId": "rules.sol-arbitrary-delegatecall-data", "snippet": {"code": "    require(callee.delegatecall(_data)); //Use delegatecall with caution and make sure to never call into untrusted contracts", "highlightLines": [19]}, "category": "code", "location": {"file": "dataset/access_control/proxy.sol", "line": 19, "column": 19}, "severity": "high", "references": [], "description": ""}, {"id": "da844ca3ccd7", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": " pragma solidity ^0.4.15;", "highlightLines": [8]}, "category": "code", "location": {"file": "dataset/access_control/rubixi.sol", "line": 8, "column": 2}, "severity": "info", "references": [], "description": ""}, {"id": "2429930db81f", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": " pragma solidity ^0.4.15;", "highlightLines": [8]}, "category": "code", "location": {"file": "dataset/access_control/rubixi.sol", "line": 8, "column": 2}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "fe1dd40faa86", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "         function DynamicPyramid() {\n                 creator = msg.sender; //anyone can call this\n         }", "highlightLines": [23]}, "category": "code", "location": {"file": "dataset/access_control/rubixi.sol", "line": 23, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "d748a0553a21", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "         modifier onlyowner {\n                 if (msg.sender == creator) _;\n         }", "highlightLines": [27]}, "category": "code", "location": {"file": "dataset/access_control/rubixi.sol", "line": 27, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "37ed61d83551", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "                 address etherAddress;", "highlightLines": [32]}, "category": "code", "location": {"file": "dataset/access_control/rubixi.sol", "line": 32, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "deec5f7ba363", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "                 uint payout;", "highlightLines": [33]}, "category": "code", "location": {"file": "dataset/access_control/rubixi.sol", "line": 33, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "72f57a014860", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "         function() {\n                 init();\n         }", "highlightLines": [39]}, "category": "code", "location": {"file": "dataset/access_control/rubixi.sol", "line": 39, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "a16507f72716", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "                         return;", "highlightLines": [48]}, "category": "code", "location": {"file": "dataset/access_control/rubixi.sol", "line": 48, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "17ed3a760852", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n                 uint _fee = feePercent;", "highlightLines": [50]}, "category": "code", "location": {"file": "dataset/access_control/rubixi.sol", "line": 50, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4a501293dd1f", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "                         uint payoutToSend = participants[payoutOrder].payout;", "highlightLines": [73]}, "category": "code", "location": {"file": "dataset/access_control/rubixi.sol", "line": 73, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c7099cc1ebc0", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "                         participants[payoutOrder].etherAddress.send(payoutToSend);", "highlightLines": [74]}, "category": "code", "location": {"file": "dataset/access_control/rubixi.sol", "line": 74, "column": 26}, "severity": "high", "references": [], "description": ""}, {"id": "4b1b60080e9c", "fix": {"template": null, "available": false}, "title": "send() return value not checked - Ether may be stuck if recipient reverts", "ruleId": "rules.sol-unchecked-send-return", "snippet": {"code": "                         participants[payoutOrder].etherAddress.send(payoutToSend);", "highlightLines": [74]}, "category": "code", "location": {"file": "dataset/access_control/rubixi.sol", "line": 74, "column": 64}, "severity": "high", "references": [], "description": ""}, {"id": "99440588e5f5", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "         function collectAllFees() onlyowner {\n                 if (collectedFees == 0) throw;\n\n                 creator.send(collectedFees);\n                 collectedFees = 0;\n         }", "highlightLines": [82]}, "category": "code", "location": {"file": "dataset/access_control/rubixi.sol", "line": 82, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "430521c77d45", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "                 if (collectedFees == 0) throw;\n\n                 creator.send(collectedFees);", "highlightLines": [83]}, "category": "code", "location": {"file": "dataset/access_control/rubixi.sol", "line": 83, "column": 42}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "86eea56d23a7", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "                 creator.send(collectedFees);", "highlightLines": [85]}, "category": "code", "location": {"file": "dataset/access_control/rubixi.sol", "line": 85, "column": 18}, "severity": "high", "references": [], "description": ""}, {"id": "573f2f49ce73", "fix": {"template": null, "available": false}, "title": "send() return value not checked - Ether may be stuck if recipient reverts", "ruleId": "rules.sol-unchecked-send-return", "snippet": {"code": "                 creator.send(collectedFees);", "highlightLines": [85]}, "category": "code", "location": {"file": "dataset/access_control/rubixi.sol", "line": 85, "column": 25}, "severity": "high", "references": [], "description": ""}, {"id": "1b38e1c2fada", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "         function collectFeesInEther(uint _amt) onlyowner {\n                 _amt *= 1 ether;\n                 if (_amt > collectedFees) collectAllFees();\n\n                 if (collectedFees == 0) throw;\n\n                 creator.send(_amt);\n                 collectedFees -= _amt;\n         }", "highlightLines": [89]}, "category": "code", "location": {"file": "dataset/access_control/rubixi.sol", "line": 89, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "46a6034ee009", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "                 if (collectedFees == 0) throw;\n\n                 creator.send(_amt);", "highlightLines": [93]}, "category": "code", "location": {"file": "dataset/access_control/rubixi.sol", "line": 93, "column": 42}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "9e6f21e26154", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "                 creator.send(_amt);", "highlightLines": [95]}, "category": "code", "location": {"file": "dataset/access_control/rubixi.sol", "line": 95, "column": 18}, "severity": "high", "references": [], "description": ""}, {"id": "27c6f75dc12e", "fix": {"template": null, "available": false}, "title": "send() return value not checked - Ether may be stuck if recipient reverts", "ruleId": "rules.sol-unchecked-send-return", "snippet": {"code": "                 creator.send(_amt);", "highlightLines": [95]}, "category": "code", "location": {"file": "dataset/access_control/rubixi.sol", "line": 95, "column": 25}, "severity": "high", "references": [], "description": ""}, {"id": "eced7731549b", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "         function collectPercentOfFees(uint _pcent) onlyowner {\n                 if (collectedFees == 0 || _pcent > 100) throw;\n\n                 uint feesToCollect = collectedFees / 100 * _pcent;\n                 creator.send(feesToCollect);\n                 collectedFees -= feesToCollect;\n         }", "highlightLines": [99]}, "category": "code", "location": {"file": "dataset/access_control/rubixi.sol", "line": 99, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "721ca5f1bddb", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "                 if (collectedFees == 0 || _pcent > 100) throw;\n\n                 uint feesToCollect = collectedFees / 100 * _pcent;", "highlightLines": [100]}, "category": "code", "location": {"file": "dataset/access_control/rubixi.sol", "line": 100, "column": 58}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "296d3264c00a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n                 uint feesToCollect = collectedFees / 100 * _pcent;", "highlightLines": [101]}, "category": "code", "location": {"file": "dataset/access_control/rubixi.sol", "line": 101, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ce18d1720d47", "fix": {"template": null, "available": false}, "title": "Division before multiplication causes precision loss", "ruleId": "rules.sol-division-before-multiplication", "snippet": {"code": "                 uint feesToCollect = collectedFees / 100 * _pcent;", "highlightLines": [102]}, "category": "code", "location": {"file": "dataset/access_control/rubixi.sol", "line": 102, "column": 39}, "severity": "medium", "references": [], "description": ""}, {"id": "ae141cd17baa", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "                 creator.send(feesToCollect);", "highlightLines": [103]}, "category": "code", "location": {"file": "dataset/access_control/rubixi.sol", "line": 103, "column": 18}, "severity": "high", "references": [], "description": ""}, {"id": "8b6ad91788de", "fix": {"template": null, "available": false}, "title": "send() return value not checked - Ether may be stuck if recipient reverts", "ruleId": "rules.sol-unchecked-send-return", "snippet": {"code": "                 creator.send(feesToCollect);", "highlightLines": [103]}, "category": "code", "location": {"file": "dataset/access_control/rubixi.sol", "line": 103, "column": 25}, "severity": "high", "references": [], "description": ""}, {"id": "053b9b9bc9dc", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "         function changeOwner(address _owner) onlyowner {\n                 creator = _owner;\n         }", "highlightLines": [108]}, "category": "code", "location": {"file": "dataset/access_control/rubixi.sol", "line": 108, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "b97a911a3c70", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "         function changeMultiplier(uint _mult) onlyowner {\n                 if (_mult > 300 || _mult < 120) throw;\n\n                 pyramidMultiplier = _mult;\n         }", "highlightLines": [112]}, "category": "code", "location": {"file": "dataset/access_control/rubixi.sol", "line": 112, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "fa93d568b887", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "                 if (_mult > 300 || _mult < 120) throw;\n\n                 pyramidMultiplier = _mult;", "highlightLines": [113]}, "category": "code", "location": {"file": "dataset/access_control/rubixi.sol", "line": 113, "column": 50}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "e218507c91d2", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "         function changeFeePercentage(uint _fee) onlyowner {\n                 if (_fee > 10) throw;\n\n                 feePercent = _fee;\n         }", "highlightLines": [118]}, "category": "code", "location": {"file": "dataset/access_control/rubixi.sol", "line": 118, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "d1508c5ad41f", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "                 if (_fee > 10) throw;\n\n                 feePercent = _fee;", "highlightLines": [119]}, "category": "code", "location": {"file": "dataset/access_control/rubixi.sol", "line": 119, "column": 33}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "8ef0e57ffcef", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "         function currentMultiplier() constant returns(uint multiplier, string info) {\n                 multiplier = pyramidMultiplier;\n                 info = 'This multiplier applies to you as soon as transaction is received, may be lowered to hasten payouts or increased if payouts are fast enough. Due to no float or decimals, multiplier is x100 for a fractional multiplier e.g. 250 is actually a 2.5x multiplier. Capped at 3x max and 1.2x min.';\n         }", "highlightLines": [125]}, "category": "code", "location": {"file": "dataset/access_control/rubixi.sol", "line": 125, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "12439b778a6d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "                 multiplier = pyramidMultiplier;\n                 info = 'This multiplier applies to you as soon as transaction is received, may be lowered to hasten payouts or increased if payouts are fast enough. Due to no float or decimals, multiplier is x100 for a fractional multiplier e.g. 250 is actually a 2.5x multiplier. Capped at 3x max and 1.2x min.';", "highlightLines": [126]}, "category": "code", "location": {"file": "dataset/access_control/rubixi.sol", "line": 126, "column": 18}, "severity": "medium", "references": [], "description": ""}, {"id": "a7893d3a84df", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "         function currentFeePercentage() constant returns(uint fee, string info) {\n                 fee = feePercent;\n                 info = 'Shown in % form. Fee is halved(50%) for amounts equal or greater than 50 ethers. (Fee may change, but is capped to a maximum of 10%)';\n         }", "highlightLines": [130]}, "category": "code", "location": {"file": "dataset/access_control/rubixi.sol", "line": 130, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "e01e364e4d5c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "                 fee = feePercent;\n                 info = 'Shown in % form. Fee is halved(50%) for amounts equal or greater than 50 ethers. (Fee may change, but is capped to a maximum of 10%)';", "highlightLines": [131]}, "category": "code", "location": {"file": "dataset/access_control/rubixi.sol", "line": 131, "column": 18}, "severity": "medium", "references": [], "description": ""}, {"id": "3bfce0a1ee37", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "         function currentPyramidBalanceApproximately() constant returns(uint pyramidBalance, string info) {\n                 pyramidBalance = balance / 1 ether;\n                 info = 'All balance values are measured in Ethers, note that due to no decimal placing, these values show up as integers only, within the contract itself you will get the exact decimal value you are supposed to';\n         }", "highlightLines": [135]}, "category": "code", "location": {"file": "dataset/access_control/rubixi.sol", "line": 135, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "d6dde102b6ed", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "                 pyramidBalance = balance / 1 ether;\n                 info = 'All balance values are measured in Ethers, note that due to no decimal placing, these values show up as integers only, within the contract itself you will get the exact decimal value you are supposed to';", "highlightLines": [136]}, "category": "code", "location": {"file": "dataset/access_control/rubixi.sol", "line": 136, "column": 18}, "severity": "medium", "references": [], "description": ""}, {"id": "82e2cf4e9ca5", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "         function nextPayoutWhenPyramidBalanceTotalsApproximately() constant returns(uint balancePayout) {\n                 balancePayout = participants[payoutOrder].payout / 1 ether;\n         }", "highlightLines": [140]}, "category": "code", "location": {"file": "dataset/access_control/rubixi.sol", "line": 140, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "3647f379bc76", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "         function feesSeperateFromBalanceApproximately() constant returns(uint fees) {\n                 fees = collectedFees / 1 ether;\n         }", "highlightLines": [144]}, "category": "code", "location": {"file": "dataset/access_control/rubixi.sol", "line": 144, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "5e27d980e983", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "         function totalParticipants() constant returns(uint count) {\n                 count = participants.length;\n         }", "highlightLines": [148]}, "category": "code", "location": {"file": "dataset/access_control/rubixi.sol", "line": 148, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "044f9bac85ae", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "         function numberOfParticipantsWaitingForPayout() constant returns(uint count) {\n                 count = participants.length - payoutOrder;\n         }", "highlightLines": [152]}, "category": "code", "location": {"file": "dataset/access_control/rubixi.sol", "line": 152, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "c335ab1a6bfb", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "         function participantDetails(uint orderInPyramid) constant returns(address Address, uint Payout) {\n                 if (orderInPyramid <= participants.length) {\n                         Address = participants[orderInPyramid].etherAddress;\n                         Payout = participants[orderInPyramid].payout / 1 ether;\n                 }\n         }", "highlightLines": [156]}, "category": "code", "location": {"file": "dataset/access_control/rubixi.sol", "line": 156, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "ad7e871e15bc", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "                         Address = participants[orderInPyramid].etherAddress;\n                         Payout = participants[orderInPyramid].payout / 1 ether;", "highlightLines": [158]}, "category": "code", "location": {"file": "dataset/access_control/rubixi.sol", "line": 158, "column": 26}, "severity": "medium", "references": [], "description": ""}, {"id": "1e4a8c96696d", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.0;", "highlightLines": [8]}, "category": "code", "location": {"file": "dataset/access_control/simple_suicide.sol", "line": 8, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "30913fbc1ccf", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.0;", "highlightLines": [8]}, "category": "code", "location": {"file": "dataset/access_control/simple_suicide.sol", "line": 8, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "f561feb6a722", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function sudicideAnyone() {\n    selfdestruct(msg.sender);\n  }", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/access_control/simple_suicide.sol", "line": 12, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "551823c5d064", "fix": {"template": null, "available": false}, "title": "Contract can be destructed by anyone - missing access control on selfdestruct", "ruleId": "rules.sol-accessible-selfdestruct", "snippet": {"code": "    selfdestruct(msg.sender);", "highlightLines": [13]}, "category": "code", "location": {"file": "dataset/access_control/simple_suicide.sol", "line": 13, "column": 5}, "severity": "high", "references": ["https://www.parity.io/blog/a-postmortem-on-the-parity-multi-sig-library-self-destruct/"], "description": ""}, {"id": "debb705f3d8d", "fix": {"template": null, "available": false}, "title": "Selfdestruct with user-controlled recipient - funds can be sent anywhere", "ruleId": "rules.sol-selfdestruct-arbitrary", "snippet": {"code": "    selfdestruct(msg.sender);", "highlightLines": [13]}, "category": "code", "location": {"file": "dataset/access_control/simple_suicide.sol", "line": 13, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "8a45934d78a2", "fix": {"template": null, "available": false}, "title": "selfdestruct can force ETH to any address - contracts cannot prevent receiving ETH this way (Force pattern)", "ruleId": "rules.sol-selfdestruct-force-eth", "snippet": {"code": "    selfdestruct(msg.sender);", "highlightLines": [13]}, "category": "code", "location": {"file": "dataset/access_control/simple_suicide.sol", "line": 13, "column": 5}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/7"], "description": ""}, {"id": "b5559b9df1ea", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": " pragma solidity ^0.4.15;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/access_control/unprotected0.sol", "line": 7, "column": 2}, "severity": "info", "references": [], "description": ""}, {"id": "fd1afdfbd71e", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": " pragma solidity ^0.4.15;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/access_control/unprotected0.sol", "line": 7, "column": 2}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "80f42bd9cc30", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "     modifier onlyowner {\n         require(msg.sender==owner);\n         _;\n     }", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/access_control/unprotected0.sol", "line": 12, "column": 6}, "severity": "medium", "references": [], "description": ""}, {"id": "66e770a1284f", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "         require(msg.sender==owner);", "highlightLines": [13]}, "category": "code", "location": {"file": "dataset/access_control/unprotected0.sol", "line": 13, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "ae4a6db623fd", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "         require(msg.sender==owner);", "highlightLines": [13]}, "category": "code", "location": {"file": "dataset/access_control/unprotected0.sol", "line": 13, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "7785cad22f77", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "         _;", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/access_control/unprotected0.sol", "line": 14, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "aac5b90273d2", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "         owner = msg.sender;", "highlightLines": [20]}, "category": "code", "location": {"file": "dataset/access_control/unprotected0.sol", "line": 20, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "73b8266f59f3", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "     function changeOwner(address _newOwner)\n         public", "highlightLines": [25]}, "category": "code", "location": {"file": "dataset/access_control/unprotected0.sol", "line": 25, "column": 6}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "da76968db25f", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        owner = _newOwner;", "highlightLines": [28]}, "category": "code", "location": {"file": "dataset/access_control/unprotected0.sol", "line": 28, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "9475abff20a3", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": " pragma solidity ^0.4.24;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/access_control/wallet_02_refund_nosub.sol", "line": 7, "column": 2}, "severity": "info", "references": [], "description": ""}, {"id": "eb730f97878b", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": " pragma solidity ^0.4.24;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/access_control/wallet_02_refund_nosub.sol", "line": 7, "column": 2}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "59217ba3a903", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "     address creator;", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/access_control/wallet_02_refund_nosub.sol", "line": 15, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8322f67c55fa", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "     function deposit() public payable {", "highlightLines": [23]}, "category": "code", "location": {"file": "dataset/access_control/wallet_02_refund_nosub.sol", "line": 23, "column": 6}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "5b1fbc276ff6", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "     function withdraw(uint256 amount) public {", "highlightLines": [28]}, "category": "code", "location": {"file": "dataset/access_control/wallet_02_refund_nosub.sol", "line": 28, "column": 6}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "eb4b62990832", "fix": {"template": null, "available": false}, "title": "Function accepts zero amount without validation - can cause division by zero or empty operations", "ruleId": "rules.sol-missing-zero-amount-check", "snippet": {"code": "     function withdraw(uint256 amount) public {", "highlightLines": [28]}, "category": "code", "location": {"file": "dataset/access_control/wallet_02_refund_nosub.sol", "line": 28, "column": 6}, "severity": "info", "references": [], "description": ""}, {"id": "7147f3ef3092", "fix": {"template": null, "available": false}, "title": "require() in withdrawal path - griefing possible if condition can be manipulated", "ruleId": "rules.sol-force-revert-griefing", "snippet": {"code": "     function withdraw(uint256 amount) public {\n         require(amount <= balances[msg.sender]);", "highlightLines": [28]}, "category": "code", "location": {"file": "dataset/access_control/wallet_02_refund_nosub.sol", "line": 28, "column": 6}, "severity": "info", "references": [], "description": ""}, {"id": "56ef9c6942f2", "fix": {"template": null, "available": false}, "title": "SWC-105: Ether withdrawal without access control - anyone can drain funds", "ruleId": "rules.sol-swc-105-unprotected-withdrawal", "snippet": {"code": "     function withdraw(uint256 amount) public {\n         require(amount <= balances[msg.sender]);\n         msg.sender.transfer(amount);", "highlightLines": [28]}, "category": "code", "location": {"file": "dataset/access_control/wallet_02_refund_nosub.sol", "line": 28, "column": 6}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-105"], "description": ""}, {"id": "6e1b681f552d", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "         require(amount <= balances[msg.sender]);", "highlightLines": [29]}, "category": "code", "location": {"file": "dataset/access_control/wallet_02_refund_nosub.sol", "line": 29, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "004102bf2838", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "         msg.sender.transfer(amount);", "highlightLines": [30]}, "category": "code", "location": {"file": "dataset/access_control/wallet_02_refund_nosub.sol", "line": 30, "column": 10}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "c7eb0f1edeb2", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "         msg.sender.transfer(balances[msg.sender]);", "highlightLines": [36]}, "category": "code", "location": {"file": "dataset/access_control/wallet_02_refund_nosub.sol", "line": 36, "column": 10}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "f8b02a8b2168", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "         require(creator == msg.sender);", "highlightLines": [42]}, "category": "code", "location": {"file": "dataset/access_control/wallet_02_refund_nosub.sol", "line": 42, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "35e2087da059", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "         to.transfer(this.balance);", "highlightLines": [43]}, "category": "code", "location": {"file": "dataset/access_control/wallet_02_refund_nosub.sol", "line": 43, "column": 10}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "244f1b9c9102", "fix": {"template": null, "available": false}, "title": "Missing zero address validation - tokens/ETH could be lost", "ruleId": "rules.sol-missing-zero-address-check", "snippet": {"code": "         to.transfer(this.balance);", "highlightLines": [43]}, "category": "code", "location": {"file": "dataset/access_control/wallet_02_refund_nosub.sol", "line": 43, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "24b5ba9c26df", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "         to.transfer(this.balance);", "highlightLines": [43]}, "category": "code", "location": {"file": "dataset/access_control/wallet_02_refund_nosub.sol", "line": 43, "column": 12}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "1b195f0bc2a6", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": " pragma solidity ^0.4.24;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/access_control/wallet_03_wrong_constructor.sol", "line": 7, "column": 2}, "severity": "info", "references": [], "description": ""}, {"id": "1e051d8a4fa2", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": " pragma solidity ^0.4.24;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/access_control/wallet_03_wrong_constructor.sol", "line": 7, "column": 2}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "85372a1549c5", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "     address creator;", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/access_control/wallet_03_wrong_constructor.sol", "line": 14, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a39472f0fe47", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "     function deposit() public payable {", "highlightLines": [23]}, "category": "code", "location": {"file": "dataset/access_control/wallet_03_wrong_constructor.sol", "line": 23, "column": 6}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "b161fe0f1099", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "     function withdraw(uint256 amount) public {", "highlightLines": [28]}, "category": "code", "location": {"file": "dataset/access_control/wallet_03_wrong_constructor.sol", "line": 28, "column": 6}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "25924e14cd9b", "fix": {"template": null, "available": false}, "title": "Function accepts zero amount without validation - can cause division by zero or empty operations", "ruleId": "rules.sol-missing-zero-amount-check", "snippet": {"code": "     function withdraw(uint256 amount) public {", "highlightLines": [28]}, "category": "code", "location": {"file": "dataset/access_control/wallet_03_wrong_constructor.sol", "line": 28, "column": 6}, "severity": "info", "references": [], "description": ""}, {"id": "8ae2f50beddf", "fix": {"template": null, "available": false}, "title": "require() in withdrawal path - griefing possible if condition can be manipulated", "ruleId": "rules.sol-force-revert-griefing", "snippet": {"code": "     function withdraw(uint256 amount) public {\n         require(amount <= balances[msg.sender]);", "highlightLines": [28]}, "category": "code", "location": {"file": "dataset/access_control/wallet_03_wrong_constructor.sol", "line": 28, "column": 6}, "severity": "info", "references": [], "description": ""}, {"id": "af9d21fd86e8", "fix": {"template": null, "available": false}, "title": "SWC-105: Ether withdrawal without access control - anyone can drain funds", "ruleId": "rules.sol-swc-105-unprotected-withdrawal", "snippet": {"code": "     function withdraw(uint256 amount) public {\n         require(amount <= balances[msg.sender]);\n         msg.sender.transfer(amount);", "highlightLines": [28]}, "category": "code", "location": {"file": "dataset/access_control/wallet_03_wrong_constructor.sol", "line": 28, "column": 6}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-105"], "description": ""}, {"id": "bed38629246c", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "         require(amount <= balances[msg.sender]);", "highlightLines": [29]}, "category": "code", "location": {"file": "dataset/access_control/wallet_03_wrong_constructor.sol", "line": 29, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "f407eeeb9256", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "         msg.sender.transfer(amount);", "highlightLines": [30]}, "category": "code", "location": {"file": "dataset/access_control/wallet_03_wrong_constructor.sol", "line": 30, "column": 10}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "1de2e973bad7", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "         require(creator == msg.sender);", "highlightLines": [37]}, "category": "code", "location": {"file": "dataset/access_control/wallet_03_wrong_constructor.sol", "line": 37, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "5b331a605e6b", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "         to.transfer(this.balance);", "highlightLines": [38]}, "category": "code", "location": {"file": "dataset/access_control/wallet_03_wrong_constructor.sol", "line": 38, "column": 10}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "cf4f4bcde728", "fix": {"template": null, "available": false}, "title": "Missing zero address validation - tokens/ETH could be lost", "ruleId": "rules.sol-missing-zero-address-check", "snippet": {"code": "         to.transfer(this.balance);", "highlightLines": [38]}, "category": "code", "location": {"file": "dataset/access_control/wallet_03_wrong_constructor.sol", "line": 38, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "c6d7e5a00ed5", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "         to.transfer(this.balance);", "highlightLines": [38]}, "category": "code", "location": {"file": "dataset/access_control/wallet_03_wrong_constructor.sol", "line": 38, "column": 12}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "61c23520f134", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": " pragma solidity ^0.4.24;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/access_control/wallet_04_confused_sign.sol", "line": 7, "column": 2}, "severity": "info", "references": [], "description": ""}, {"id": "84a7e8d76463", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": " pragma solidity ^0.4.24;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/access_control/wallet_04_confused_sign.sol", "line": 7, "column": 2}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "ba5f9b56abc9", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "     address creator;", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/access_control/wallet_04_confused_sign.sol", "line": 15, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "1e268710e18b", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "     function deposit() public payable {", "highlightLines": [23]}, "category": "code", "location": {"file": "dataset/access_control/wallet_04_confused_sign.sol", "line": 23, "column": 6}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "ce345d5252b8", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "     function withdraw(uint256 amount) public {", "highlightLines": [28]}, "category": "code", "location": {"file": "dataset/access_control/wallet_04_confused_sign.sol", "line": 28, "column": 6}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "3f6828227c13", "fix": {"template": null, "available": false}, "title": "Function accepts zero amount without validation - can cause division by zero or empty operations", "ruleId": "rules.sol-missing-zero-amount-check", "snippet": {"code": "     function withdraw(uint256 amount) public {", "highlightLines": [28]}, "category": "code", "location": {"file": "dataset/access_control/wallet_04_confused_sign.sol", "line": 28, "column": 6}, "severity": "info", "references": [], "description": ""}, {"id": "2305e1e1315c", "fix": {"template": null, "available": false}, "title": "require() in withdrawal path - griefing possible if condition can be manipulated", "ruleId": "rules.sol-force-revert-griefing", "snippet": {"code": "     function withdraw(uint256 amount) public {\n         // <yes> <report> ACCESS_CONTROL\n         require(amount >= balances[msg.sender]);", "highlightLines": [28]}, "category": "code", "location": {"file": "dataset/access_control/wallet_04_confused_sign.sol", "line": 28, "column": 6}, "severity": "info", "references": [], "description": ""}, {"id": "567d1d991b6a", "fix": {"template": null, "available": false}, "title": "SWC-105: Ether withdrawal without access control - anyone can drain funds", "ruleId": "rules.sol-swc-105-unprotected-withdrawal", "snippet": {"code": "     function withdraw(uint256 amount) public {\n         // <yes> <report> ACCESS_CONTROL\n         require(amount >= balances[msg.sender]);\n         msg.sender.transfer(amount);", "highlightLines": [28]}, "category": "code", "location": {"file": "dataset/access_control/wallet_04_confused_sign.sol", "line": 28, "column": 6}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-105"], "description": ""}, {"id": "f8d5a7dffc57", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "         require(amount >= balances[msg.sender]);", "highlightLines": [30]}, "category": "code", "location": {"file": "dataset/access_control/wallet_04_confused_sign.sol", "line": 30, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "091eaf8c07ea", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "         msg.sender.transfer(amount);", "highlightLines": [31]}, "category": "code", "location": {"file": "dataset/access_control/wallet_04_confused_sign.sol", "line": 31, "column": 10}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "eaddf597251b", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "         require(creator == msg.sender);", "highlightLines": [38]}, "category": "code", "location": {"file": "dataset/access_control/wallet_04_confused_sign.sol", "line": 38, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "73fcc6ea97d2", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "         to.transfer(this.balance);", "highlightLines": [39]}, "category": "code", "location": {"file": "dataset/access_control/wallet_04_confused_sign.sol", "line": 39, "column": 10}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "9aac72ad4dd3", "fix": {"template": null, "available": false}, "title": "Missing zero address validation - tokens/ETH could be lost", "ruleId": "rules.sol-missing-zero-address-check", "snippet": {"code": "         to.transfer(this.balance);", "highlightLines": [39]}, "category": "code", "location": {"file": "dataset/access_control/wallet_04_confused_sign.sol", "line": 39, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "62e13279fd8e", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "         to.transfer(this.balance);", "highlightLines": [39]}, "category": "code", "location": {"file": "dataset/access_control/wallet_04_confused_sign.sol", "line": 39, "column": 12}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "a3e92e4e7a51", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.16;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "dcfc1fe5e2b0", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.16;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "534df588b1c7", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "  function mul(uint256 a, uint256 b) internal constant returns (uint256) {\n    uint256 c = a * b;\n    require(a == 0 || c / a == b);", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 14, "column": 3}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "a2be75c514bf", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 c = a * b;", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 15, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a1af3ce1cfd0", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(a == 0 || c / a == b);", "highlightLines": [16]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 16, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "fd4b93254a7e", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "  function div(uint256 a, uint256 b) internal constant returns (uint256) {\n    // require(b > 0); // Solidity automatically throws when dividing by 0\n    uint256 c = a / b;\n    // require(a == b * c + a % b); // There is no case in which this doesn't hold", "highlightLines": [20]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 20, "column": 3}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "1b972ca5cca2", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 c = a / b;", "highlightLines": [22]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 22, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4c9f9e9e171f", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(b <= a);", "highlightLines": [28]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 28, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "d87e00619b5e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 c = a + b;", "highlightLines": [33]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 33, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4dd38630af94", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(c >= a);", "highlightLines": [34]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 34, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "60fc6280e076", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function balanceOf(address who) public constant returns (uint256);", "highlightLines": [46]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 46, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "a435ab284bd2", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "  function balanceOf(address who) public constant returns (uint256);\n  function transfer(address to, uint256 value) public returns (bool);\n  event Transfer(address indexed from, address indexed to, uint256 value);\n}\n\n/**\n * @title Basic token\n * @dev Basic version of StandardToken, with no allowances.\n */\ncontract BasicToken is ERC20Basic {\n  using SafeMath for uint256;\n\n  mapping(address => uint256) balances;", "highlightLines": [46]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 46, "column": 3}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "5db16d9accad", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function transfer(address to, uint256 value) public returns (bool);", "highlightLines": [47]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 47, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "4b14c030c98f", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without msg.data.length validation - vulnerable to short address attack padding", "ruleId": "rules.sol-short-address-no-payload-check", "snippet": {"code": "  function transfer(address to, uint256 value) public returns (bool);\n  event Transfer(address indexed from, address indexed to, uint256 value);\n}\n\n/**\n * @title Basic token\n * @dev Basic version of StandardToken, with no allowances.\n */\ncontract BasicToken is ERC20Basic {", "highlightLines": [47]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 47, "column": 3}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address", "https://vessenes.com/the-erc20-short-address-attack-explained/"], "description": ""}, {"id": "ce38d24dbcf6", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event Transfer(address indexed from, address indexed to, uint256 value);", "highlightLines": [48]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 48, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "32efbbf43ed3", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "  function transfer(address _to, uint256 _value) public returns (bool) {", "highlightLines": [65]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 65, "column": 3}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "0a4f4a703928", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without msg.data.length validation - vulnerable to short address attack padding", "ruleId": "rules.sol-short-address-no-payload-check", "snippet": {"code": "  function transfer(address _to, uint256 _value) public returns (bool) {", "highlightLines": [65]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 65, "column": 3}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address", "https://vessenes.com/the-erc20-short-address-attack-explained/"], "description": ""}, {"id": "28965a9b6b0d", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "  function transfer(address _to, uint256 _value) public returns (bool) {\n    require(_to != address(0));\n    require(_value > 0 && _value <= balances[msg.sender]);", "highlightLines": [65]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 65, "column": 3}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "e6816427dd2f", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - will never return false, only revert", "ruleId": "rules.sol-return-bool-always-reverts", "snippet": {"code": "  function transfer(address _to, uint256 _value) public returns (bool) {\n    require(_to != address(0));\n    require(_value > 0 && _value <= balances[msg.sender]);\n\n    // SafeMath.sub will throw if there is not enough balance.\n    balances[msg.sender] = balances[msg.sender].sub(_value);\n    balances[_to] = balances[_to].add(_value);\n    Transfer(msg.sender, _to, _value);\n    return true;\n  }", "highlightLines": [65]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 65, "column": 3}, "severity": "info", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "bb356a6de19a", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(_to != address(0));", "highlightLines": [66]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 66, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "a642ee4919a5", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(_value > 0 && _value <= balances[msg.sender]);", "highlightLines": [67]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 67, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "1ccec2b16231", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    balances[msg.sender] = balances[msg.sender].sub(_value);\n    balances[_to] = balances[_to].add(_value);", "highlightLines": [70]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 70, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "8ba9d004fed2", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function allowance(address owner, address spender) public constant returns (uint256);", "highlightLines": [91]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 91, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "8db817e2a3da", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "  function allowance(address owner, address spender) public constant returns (uint256);\n  function transferFrom(address from, address to, uint256 value) public returns (bool);\n  function approve(address spender, uint256 value) public returns (bool);\n  event Approval(address indexed owner, address indexed spender, uint256 value);\n}\n\n\n/**\n * @title Standard ERC20 token\n *\n * @dev Implementation of the basic standard token.\n * @dev https://github.com/ethereum/EIPs/issues/20\n * @dev Based on code by FirstBlood: https://github.com/Firstbloodio/token/blob/master/smart_contract/FirstBloodToken.sol\n */\ncontract StandardToken is ERC20, BasicToken {\n\n  mapping (address => mapping (address => uint256)) internal allowed;", "highlightLines": [91]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 91, "column": 3}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "bd7adf69438f", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function transferFrom(address from, address to, uint256 value) public returns (bool);", "highlightLines": [92]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 92, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "fed009beb8ff", "fix": {"template": null, "available": false}, "title": "ERC20 transferFrom without payload size validation - consider adding onlyPayloadSize modifier", "ruleId": "rules.sol-erc20-missing-payload-modifier", "snippet": {"code": "  function transferFrom(address from, address to, uint256 value) public returns (bool);\n  function approve(address spender, uint256 value) public returns (bool);\n  event Approval(address indexed owner, address indexed spender, uint256 value);\n}\n\n\n/**\n * @title Standard ERC20 token\n *\n * @dev Implementation of the basic standard token.\n * @dev https://github.com/ethereum/EIPs/issues/20\n * @dev Based on code by FirstBlood: https://github.com/Firstbloodio/token/blob/master/smart_contract/FirstBloodToken.sol\n */\ncontract StandardToken is ERC20, BasicToken {", "highlightLines": [92]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 92, "column": 3}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address"], "description": ""}, {"id": "39b172c7e0a6", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function approve(address spender, uint256 value) public returns (bool);", "highlightLines": [93]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 93, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "fa0061d36742", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event Approval(address indexed owner, address indexed spender, uint256 value);", "highlightLines": [94]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 94, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "a240e3adeace", "fix": {"template": null, "available": false}, "title": "ERC20 transferFrom without payload size validation - consider adding onlyPayloadSize modifier", "ruleId": "rules.sol-erc20-missing-payload-modifier", "snippet": {"code": "  function transferFrom(address _from, address _to, uint256 _value) public returns (bool) {", "highlightLines": [116]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 116, "column": 3}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address"], "description": ""}, {"id": "1101a743cb40", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "  function transferFrom(address _from, address _to, uint256 _value) public returns (bool) {", "highlightLines": [116]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 116, "column": 3}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "aa3e6175a351", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "  function transferFrom(address _from, address _to, uint256 _value) public returns (bool) {\n    require(_to != address(0));\n    require(_value > 0 && _value <= balances[_from]);\n    require(_value <= allowed[_from][msg.sender]);", "highlightLines": [116]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 116, "column": 3}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "252514976870", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - will never return false, only revert", "ruleId": "rules.sol-return-bool-always-reverts", "snippet": {"code": "  function transferFrom(address _from, address _to, uint256 _value) public returns (bool) {\n    require(_to != address(0));\n    require(_value > 0 && _value <= balances[_from]);\n    require(_value <= allowed[_from][msg.sender]);\n\n    balances[_from] = balances[_from].sub(_value);\n    balances[_to] = balances[_to].add(_value);\n    allowed[_from][msg.sender] = allowed[_from][msg.sender].sub(_value);\n    Transfer(_from, _to, _value);\n    return true;\n  }", "highlightLines": [116]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 116, "column": 3}, "severity": "info", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "b1af694c177c", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(_to != address(0));", "highlightLines": [117]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 117, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "287041657e66", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(_value > 0 && _value <= balances[_from]);", "highlightLines": [118]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 118, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "662ebd180b96", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(_value <= allowed[_from][msg.sender]);", "highlightLines": [119]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 119, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "ebbe714b7beb", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    balances[_from] = balances[_from].sub(_value);\n    balances[_to] = balances[_to].add(_value);", "highlightLines": [121]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 121, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "ef46a6d77da5", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    balances[_to] = balances[_to].add(_value);\n    allowed[_from][msg.sender] = allowed[_from][msg.sender].sub(_value);", "highlightLines": [122]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 122, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "85ee1c88d559", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "  function approve(address _spender, uint256 _value) public returns (bool) {", "highlightLines": [138]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 138, "column": 3}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "725abdef1ef7", "fix": {"template": null, "available": false}, "title": "SWC-118: Function name matches contract name - likely intended as constructor (pre-0.4.22)", "ruleId": "rules.sol-swc-118-constructor-mismatch", "snippet": {"code": "contract Ownable {\n  address public owner;\n\n\n  event OwnershipTransferred(address indexed previousOwner, address indexed newOwner);\n\n\n  /**\n   * @dev The Ownable constructor sets the original `owner` of the contract to the sender\n   * account.\n   */\n  function Ownable() {", "highlightLines": [160]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 160, "column": 1}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-118"], "description": ""}, {"id": "3d8d2cf6096e", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event OwnershipTransferred(address indexed previousOwner, address indexed newOwner);", "highlightLines": [164]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 164, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "c07e63bcb0ed", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function Ownable() {\n    owner = msg.sender;\n  }", "highlightLines": [171]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 171, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "6e6eff47da60", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "    owner = msg.sender;", "highlightLines": [172]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 172, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "21c7205bc27b", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  modifier onlyOwner() {\n    require(msg.sender == owner);\n    _;\n  }", "highlightLines": [179]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 179, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "74a5595ca571", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "  modifier onlyOwner() {\n    require(msg.sender == owner);\n    _;\n  }", "highlightLines": [179]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 179, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "bc17ecf28eea", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    require(msg.sender == owner);", "highlightLines": [180]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 180, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "5cd7d884c971", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(msg.sender == owner);", "highlightLines": [180]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 180, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "d541b4ae7347", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    _;", "highlightLines": [181]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 181, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "7ab26ff202b7", "fix": {"template": null, "available": false}, "title": "Access control change without event emission - harder to monitor and audit", "ruleId": "rules.sol-missing-events-access-control", "snippet": {"code": "  function transferOwnership(address newOwner) onlyOwner public {", "highlightLines": [189]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 189, "column": 3}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-access-control"], "description": ""}, {"id": "fa44e63218ba", "fix": {"template": null, "available": false}, "title": "Critical ownership transfer in single step - use two-step transfer with pending owner acceptance", "ruleId": "rules.sol-two-step-ownership", "snippet": {"code": "  function transferOwnership(address newOwner) onlyOwner public {\n    require(newOwner != address(0));\n    OwnershipTransferred(owner, newOwner);\n    owner = newOwner;\n  }", "highlightLines": [189]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 189, "column": 3}, "severity": "info", "references": ["https://docs.openzeppelin.com/contracts/access-control"], "description": ""}, {"id": "9f7479bc0db7", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "  function transferOwnership(address newOwner) onlyOwner public {", "highlightLines": [189]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 189, "column": 48}, "severity": "info", "references": [], "description": ""}, {"id": "889861f553d2", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(newOwner != address(0));", "highlightLines": [190]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 190, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "7d0600022fd1", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "    owner = newOwner;", "highlightLines": [192]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 192, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "c40167958a19", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract Pausable is Ownable {\n  event Pause();\n  event Unpause();\n\n  bool public paused = false;", "highlightLines": [201]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 201, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "e4a152ee5d3c", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  modifier whenNotPaused() {\n    require(!paused);\n    _;\n  }", "highlightLines": [211]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 211, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "157608bd963a", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(!paused);", "highlightLines": [212]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 212, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "22f0e7ca49d1", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    _;", "highlightLines": [213]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 213, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "04bf3d08050d", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  modifier whenPaused() {\n    require(paused);\n    _;\n  }", "highlightLines": [219]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 219, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "5afd99ee0727", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "  modifier whenPaused() {\n    require(paused);\n    _;\n  }", "highlightLines": [219]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 219, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "f8226468d1aa", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(paused);", "highlightLines": [220]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 220, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "ad09545f587b", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    _;", "highlightLines": [221]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 221, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "117645fc4f9a", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "  function pause() onlyOwner whenNotPaused public {", "highlightLines": [227]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 227, "column": 20}, "severity": "info", "references": [], "description": ""}, {"id": "7880f297c559", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "  function unpause() onlyOwner whenPaused public {", "highlightLines": [235]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 235, "column": 22}, "severity": "info", "references": [], "description": ""}, {"id": "d43ca7aaf40c", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "  function transfer(address _to, uint256 _value) public whenNotPaused returns (bool) {", "highlightLines": [249]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 249, "column": 3}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "3f166df90e2b", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without msg.data.length validation - vulnerable to short address attack padding", "ruleId": "rules.sol-short-address-no-payload-check", "snippet": {"code": "  function transfer(address _to, uint256 _value) public whenNotPaused returns (bool) {", "highlightLines": [249]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 249, "column": 3}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address", "https://vessenes.com/the-erc20-short-address-attack-explained/"], "description": ""}, {"id": "c6e7ad09cbec", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "    return super.transfer(_to, _value);", "highlightLines": [250]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 250, "column": 12}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "b28f9534e300", "fix": {"template": null, "available": false}, "title": "Missing zero address validation - tokens/ETH could be lost", "ruleId": "rules.sol-missing-zero-address-check", "snippet": {"code": "    return super.transfer(_to, _value);", "highlightLines": [250]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 250, "column": 12}, "severity": "info", "references": [], "description": ""}, {"id": "9ca79bf1bd7e", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "    return super.transfer(_to, _value);", "highlightLines": [250]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 250, "column": 12}, "severity": "medium", "references": [], "description": ""}, {"id": "6dbc47bbec24", "fix": {"template": null, "available": false}, "title": "ERC20 transfer() return value not checked - tokens like USDT don't return bool", "ruleId": "rules.sol-erc20-transfer-no-return-check", "snippet": {"code": "    return super.transfer(_to, _value);", "highlightLines": [250]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 250, "column": 12}, "severity": "medium", "references": [], "description": ""}, {"id": "7f8158749553", "fix": {"template": null, "available": false}, "title": "ERC20 transferFrom without payload size validation - consider adding onlyPayloadSize modifier", "ruleId": "rules.sol-erc20-missing-payload-modifier", "snippet": {"code": "  function transferFrom(address _from, address _to, uint256 _value) public whenNotPaused returns (bool) {", "highlightLines": [253]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 253, "column": 3}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address"], "description": ""}, {"id": "55cd463df406", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "  function transferFrom(address _from, address _to, uint256 _value) public whenNotPaused returns (bool) {", "highlightLines": [253]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 253, "column": 3}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "3a03c62a3c50", "fix": {"template": null, "available": false}, "title": "NFT transfer without approval/ownership check - add _isApprovedOrOwner validation", "ruleId": "rules.sol-nft-transfer-no-approval-check", "snippet": {"code": "  function transferFrom(address _from, address _to, uint256 _value) public whenNotPaused returns (bool) {", "highlightLines": [253]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 253, "column": 3}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/NFT-transfer.sol"], "description": ""}, {"id": "17a147934c6e", "fix": {"template": null, "available": false}, "title": "ERC721/ERC20 transferFrom with user-controlled from address - potential unauthorized transfer", "ruleId": "rules.sol-arbitrary-transferfrom", "snippet": {"code": "    return super.transferFrom(_from, _to, _value);", "highlightLines": [254]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 254, "column": 12}, "severity": "high", "references": [], "description": ""}, {"id": "73a681b0291d", "fix": {"template": null, "available": false}, "title": "Token transfer without checking actual received amount - deflationary tokens may transfer less", "ruleId": "rules.sol-deflationary-token-transfer", "snippet": {"code": "    return super.transferFrom(_from, _to, _value);", "highlightLines": [254]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 254, "column": 12}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "0f18fef48e00", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "    return super.transferFrom(_from, _to, _value);", "highlightLines": [254]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 254, "column": 12}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "20b1817d464e", "fix": {"template": null, "available": false}, "title": "Token amount after transfer may differ - check actual received amount", "ruleId": "rules.sol-fee-on-transfer-token", "snippet": {"code": "    return super.transferFrom(_from, _to, _value);", "highlightLines": [254]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 254, "column": 12}, "severity": "info", "references": [], "description": ""}, {"id": "f0f792e61a7a", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "  function approve(address _spender, uint256 _value) public whenNotPaused returns (bool) {", "highlightLines": [257]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 257, "column": 3}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "cbef91082956", "fix": {"template": null, "available": false}, "title": "ERC20 approve() return value not checked - some tokens return false instead of revert", "ruleId": "rules.sol-erc20-approve-no-return-check", "snippet": {"code": "    return super.approve(_spender, _value);", "highlightLines": [258]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 258, "column": 12}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#no-revert-on-failure"], "description": ""}, {"id": "b43591e7877a", "fix": {"template": null, "available": false}, "title": "ERC20 approve without setting to 0 first - frontrunning double-spend possible", "ruleId": "rules.sol-frontrunnable-approval", "snippet": {"code": "    return super.approve(_spender, _value);", "highlightLines": [258]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 258, "column": 17}, "severity": "medium", "references": ["https://github.com/ethereum/EIPs/issues/20#issuecomment-263524729"], "description": ""}, {"id": "4f5614a8eff2", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "  function batchTransfer(address[] _receivers, uint256 _value) public whenNotPaused returns (bool) {\n    uint cnt = _receivers.length;\n    // <yes> <report> ARITHMETIC\n    uint256 amount = uint256(cnt) * _value;\n    require(cnt > 0 && cnt <= 20);\n    require(_value > 0 && balances[msg.sender] >= amount);", "highlightLines": [261]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 261, "column": 3}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "41a7933e4a5d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint cnt = _receivers.length;", "highlightLines": [262]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 262, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "5c983f6aebaa", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint cnt = _receivers.length;\n    // <yes> <report> ARITHMETIC\n    uint256 amount = uint256(cnt) * _value;", "highlightLines": [262]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 262, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "ba3697b09369", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 amount = uint256(cnt) * _value;", "highlightLines": [264]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 264, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "9404655022c9", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 amount = uint256(cnt) * _value;\n    require(cnt > 0 && cnt <= 20);\n    require(_value > 0 && balances[msg.sender] >= amount);\n\n    balances[msg.sender] = balances[msg.sender].sub(amount);", "highlightLines": [264]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 264, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "c1b0c834c930", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(cnt > 0 && cnt <= 20);", "highlightLines": [265]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 265, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "76ace7f495a3", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(_value > 0 && balances[msg.sender] >= amount);", "highlightLines": [266]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 266, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "6b471e15a508", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    balances[msg.sender] = balances[msg.sender].sub(amount);\n    for (uint i = 0; i < cnt; i++) {\n        balances[_receivers[i]] = balances[_receivers[i]].add(_value);\n        Transfer(msg.sender, _receivers[i], _value);\n    }", "highlightLines": [268]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 268, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "eeb1d894cb5b", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract BecToken is PausableToken {\n    /**\n    * Public variables of the token\n    * The following variables are OPTIONAL vanities. One does not have to include them.\n    * They allow one to customise the token contract & in no way influences the core functionality.\n    * Some wallets/interfaces might not even bother to look at this information.\n    */\n    string public name = \"BeautyChain\";\n    string public symbol = \"BEC\";\n    string public version = '1.0.0';\n    uint8 public decimals = 18;", "highlightLines": [282]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 282, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "59c0147a93de", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function BecToken() {\n      totalSupply = 7000000000 * (10**(uint256(decimals)));\n      balances[msg.sender] = totalSupply;    // Give the creator all initial tokens\n    }", "highlightLines": [297]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 297, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "5fb75541b211", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "      totalSupply = 7000000000 * (10**(uint256(decimals)));\n      balances[msg.sender] = totalSupply;    // Give the creator all initial tokens", "highlightLines": [298]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 298, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "0fc269ae3d76", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function () {\n        //if ether is sent to this address, send it back.\n        revert();\n    }", "highlightLines": [302]}, "category": "code", "location": {"file": "dataset/arithmetic/BECToken.sol", "line": 302, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "8d841bf89381", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.10;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/arithmetic/insecure_transfer.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "8288e1518214", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.10;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/arithmetic/insecure_transfer.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "b13d95646d1f", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function transfer(address _to, uint256 _value) public{", "highlightLines": [13]}, "category": "code", "location": {"file": "dataset/arithmetic/insecure_transfer.sol", "line": 13, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "9858288a24a7", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without msg.data.length validation - vulnerable to short address attack padding", "ruleId": "rules.sol-short-address-no-payload-check", "snippet": {"code": "    function transfer(address _to, uint256 _value) public{", "highlightLines": [13]}, "category": "code", "location": {"file": "dataset/arithmetic/insecure_transfer.sol", "line": 13, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address", "https://vessenes.com/the-erc20-short-address-attack-explained/"], "description": ""}, {"id": "906dcb03543d", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(balanceOf[msg.sender] >= _value);", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/arithmetic/insecure_transfer.sol", "line": 15, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "eb077b639d7a", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": " pragma solidity ^0.4.15;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/arithmetic/integer_overflow_1.sol", "line": 7, "column": 2}, "severity": "info", "references": [], "description": ""}, {"id": "ba2bccfdd1e5", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": " pragma solidity ^0.4.15;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/arithmetic/integer_overflow_1.sol", "line": 7, "column": 2}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "ea9fc1b9b789", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "     function add(uint value) returns (bool){\n         // <yes> <report> ARITHMETIC\n         sellerBalance += value; // possible overflow\n\n         // possible auditor assert\n         // assert(sellerBalance >= value);\n     }", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/arithmetic/integer_overflow_1.sol", "line": 12, "column": 6}, "severity": "medium", "references": [], "description": ""}, {"id": "12e427988a09", "fix": {"template": null, "available": false}, "title": "SWC-110: assert() used for input validation - use require() instead, assert is for invariants", "ruleId": "rules.sol-swc-110-assert-user-input", "snippet": {"code": "         // assert(sellerBalance >= value);", "highlightLines": [17]}, "category": "code", "location": {"file": "dataset/arithmetic/integer_overflow_1.sol", "line": 17, "column": 13}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-110"], "description": ""}, {"id": "78c4aac467e7", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "  // function safe_add(uint value) returns (bool){\n  //   require(value + sellerBalance >= sellerBalance);", "highlightLines": [20]}, "category": "code", "location": {"file": "dataset/arithmetic/integer_overflow_1.sol", "line": 20, "column": 6}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "0df1c00e9d7f", "fix": {"template": null, "available": false}, "title": "Tautological overflow check (a + b >= a) is always true - provides no protection (TokenBank pattern)", "ruleId": "rules.sol-tautological-overflow-check", "snippet": {"code": "  //   require(value + sellerBalance >= sellerBalance);", "highlightLines": [21]}, "category": "code", "location": {"file": "dataset/arithmetic/integer_overflow_1.sol", "line": 21, "column": 8}, "severity": "high", "references": ["https://capturetheether.com/challenges/miscellaneous/token-bank/"], "description": ""}, {"id": "a6d09f4f4419", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [10]}, "category": "code", "location": {"file": "dataset/arithmetic/integer_overflow_add.sol", "line": 10, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "2ae8e5d00bf3", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [10]}, "category": "code", "location": {"file": "dataset/arithmetic/integer_overflow_add.sol", "line": 10, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "4bf345fdac31", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [10]}, "category": "code", "location": {"file": "dataset/arithmetic/integer_overflow_benign_1.sol", "line": 10, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "2428bd7939e8", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [10]}, "category": "code", "location": {"file": "dataset/arithmetic/integer_overflow_benign_1.sol", "line": 10, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "804dc53e7b8a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint res = count - input;", "highlightLines": [17]}, "category": "code", "location": {"file": "dataset/arithmetic/integer_overflow_benign_1.sol", "line": 17, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "21aa74fd83ed", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.11;", "highlightLines": [9]}, "category": "code", "location": {"file": "dataset/arithmetic/integer_overflow_mapping_sym_1.sol", "line": 9, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "f88c39bbcd9f", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.11;", "highlightLines": [9]}, "category": "code", "location": {"file": "dataset/arithmetic/integer_overflow_mapping_sym_1.sol", "line": 9, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "dafc08f7028a", "fix": {"template": null, "available": false}, "title": "Initialization function can be front-run - use initializer modifier or constructor", "ruleId": "rules.sol-initialization-frontrun", "snippet": {"code": "    function init(uint256 k, uint256 v) public {", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/arithmetic/integer_overflow_mapping_sym_1.sol", "line": 14, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "6323d9452e58", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [10]}, "category": "code", "location": {"file": "dataset/arithmetic/integer_overflow_minimal.sol", "line": 10, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "9cc1124b0b33", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [10]}, "category": "code", "location": {"file": "dataset/arithmetic/integer_overflow_minimal.sol", "line": 10, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "1006f32f8a2c", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [10]}, "category": "code", "location": {"file": "dataset/arithmetic/integer_overflow_mul.sol", "line": 10, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "a2d4d77bb95f", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [10]}, "category": "code", "location": {"file": "dataset/arithmetic/integer_overflow_mul.sol", "line": 10, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "ee41eab40d35", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.23;", "highlightLines": [10]}, "category": "code", "location": {"file": "dataset/arithmetic/integer_overflow_multitx_multifunc_feasible.sol", "line": 10, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "2a8285f844bb", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.23;", "highlightLines": [10]}, "category": "code", "location": {"file": "dataset/arithmetic/integer_overflow_multitx_multifunc_feasible.sol", "line": 10, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "3144b60227a0", "fix": {"template": null, "available": false}, "title": "Initialization function can be front-run - use initializer modifier or constructor", "ruleId": "rules.sol-initialization-frontrun", "snippet": {"code": "    function init() public {", "highlightLines": [16]}, "category": "code", "location": {"file": "dataset/arithmetic/integer_overflow_multitx_multifunc_feasible.sol", "line": 16, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "9f833a94261b", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function run(uint256 input) {\n        if (initialized == 0) {\n            return;\n        }\n        // <yes> <report> ARITHMETIC\n        count -= input;\n    }", "highlightLines": [20]}, "category": "code", "location": {"file": "dataset/arithmetic/integer_overflow_multitx_multifunc_feasible.sol", "line": 20, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "b82f9cebb752", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "            return;", "highlightLines": [22]}, "category": "code", "location": {"file": "dataset/arithmetic/integer_overflow_multitx_multifunc_feasible.sol", "line": 22, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "15d097a2cb5e", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.23;", "highlightLines": [10]}, "category": "code", "location": {"file": "dataset/arithmetic/integer_overflow_multitx_onefunc_feasible.sol", "line": 10, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "941a0cad3013", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.23;", "highlightLines": [10]}, "category": "code", "location": {"file": "dataset/arithmetic/integer_overflow_multitx_onefunc_feasible.sol", "line": 10, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "a4df34cd740f", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "            return;", "highlightLines": [19]}, "category": "code", "location": {"file": "dataset/arithmetic/integer_overflow_multitx_onefunc_feasible.sol", "line": 19, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "18411ed8a7f4", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity 0.4.25;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/arithmetic/overflow_simple_add.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "9a2a59516a17", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.23;", "highlightLines": [10]}, "category": "code", "location": {"file": "dataset/arithmetic/overflow_single_tx.sol", "line": 10, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "fb48627f5494", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.23;", "highlightLines": [10]}, "category": "code", "location": {"file": "dataset/arithmetic/overflow_single_tx.sol", "line": 10, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "a691a313520d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint res = count + input;", "highlightLines": [36]}, "category": "code", "location": {"file": "dataset/arithmetic/overflow_single_tx.sol", "line": 36, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "5d7e88d22643", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint res = count * input;", "highlightLines": [42]}, "category": "code", "location": {"file": "dataset/arithmetic/overflow_single_tx.sol", "line": 42, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7bcf067aebe5", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "       \tuint res = count - input;", "highlightLines": [48]}, "category": "code", "location": {"file": "dataset/arithmetic/overflow_single_tx.sol", "line": 48, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "234880e83c85", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": " pragma solidity ^0.4.10;", "highlightLines": [8]}, "category": "code", "location": {"file": "dataset/arithmetic/timelock.sol", "line": 8, "column": 2}, "severity": "info", "references": [], "description": ""}, {"id": "59019a055993", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": " pragma solidity ^0.4.10;", "highlightLines": [8]}, "category": "code", "location": {"file": "dataset/arithmetic/timelock.sol", "line": 8, "column": 2}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "ea50e5b85d00", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "     function deposit() public payable {", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/arithmetic/timelock.sol", "line": 15, "column": 6}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "9daa4f0bf8f1", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "     function withdraw() public {", "highlightLines": [25]}, "category": "code", "location": {"file": "dataset/arithmetic/timelock.sol", "line": 25, "column": 6}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "91e7eb21fcee", "fix": {"template": null, "available": false}, "title": "require() in withdrawal path - griefing possible if condition can be manipulated", "ruleId": "rules.sol-force-revert-griefing", "snippet": {"code": "     function withdraw() public {\n         require(balances[msg.sender] > 0);", "highlightLines": [25]}, "category": "code", "location": {"file": "dataset/arithmetic/timelock.sol", "line": 25, "column": 6}, "severity": "info", "references": [], "description": ""}, {"id": "618a89265e13", "fix": {"template": null, "available": false}, "title": "SWC-105: Ether withdrawal without access control - anyone can drain funds", "ruleId": "rules.sol-swc-105-unprotected-withdrawal", "snippet": {"code": "     function withdraw() public {\n         require(balances[msg.sender] > 0);\n         require(now > lockTime[msg.sender]);\n         uint transferValue = balances[msg.sender];\n         balances[msg.sender] = 0;\n         msg.sender.transfer(transferValue);", "highlightLines": [25]}, "category": "code", "location": {"file": "dataset/arithmetic/timelock.sol", "line": 25, "column": 6}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-105"], "description": ""}, {"id": "9e3ee725df62", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "         require(balances[msg.sender] > 0);", "highlightLines": [26]}, "category": "code", "location": {"file": "dataset/arithmetic/timelock.sol", "line": 26, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "75870a7af128", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "         require(now > lockTime[msg.sender]);", "highlightLines": [27]}, "category": "code", "location": {"file": "dataset/arithmetic/timelock.sol", "line": 27, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "2da9d18dd7e0", "fix": {"template": null, "available": false}, "title": "Block timestamp used for critical logic - miners can manipulate within ~15 second window", "ruleId": "rules.sol-block-timestamp-manipulation", "snippet": {"code": "         require(now > lockTime[msg.sender]);", "highlightLines": [27]}, "category": "code", "location": {"file": "dataset/arithmetic/timelock.sol", "line": 27, "column": 18}, "severity": "medium", "references": ["https://consensys.github.io/smart-contract-best-practices/development-recommendations/solidity-specific/timestamp-dependence/"], "description": ""}, {"id": "eacd205bf044", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "         uint transferValue = balances[msg.sender];", "highlightLines": [28]}, "category": "code", "location": {"file": "dataset/arithmetic/timelock.sol", "line": 28, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "9c5b49cee0c5", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         uint transferValue = balances[msg.sender];\n         balances[msg.sender] = 0;", "highlightLines": [28]}, "category": "code", "location": {"file": "dataset/arithmetic/timelock.sol", "line": 28, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "55c1559d7a21", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "         msg.sender.transfer(transferValue);", "highlightLines": [30]}, "category": "code", "location": {"file": "dataset/arithmetic/timelock.sol", "line": 30, "column": 10}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "7ecd951bcef2", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": " pragma solidity ^0.4.18;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/arithmetic/token.sol", "line": 7, "column": 2}, "severity": "info", "references": [], "description": ""}, {"id": "5336d8e4414d", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": " pragma solidity ^0.4.18;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/arithmetic/token.sol", "line": 7, "column": 2}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "7f425d95dca4", "fix": {"template": null, "available": false}, "title": "SWC-118: Function name matches contract name - likely intended as constructor (pre-0.4.22)", "ruleId": "rules.sol-swc-118-constructor-mismatch", "snippet": {"code": " contract Token {\n\n   mapping(address => uint) balances;\n   uint public totalSupply;\n\n   function Token(uint _initialSupply) {", "highlightLines": [9]}, "category": "code", "location": {"file": "dataset/arithmetic/token.sol", "line": 9, "column": 2}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-118"], "description": ""}, {"id": "7902a92375ba", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "   function Token(uint _initialSupply) {\n     balances[msg.sender] = totalSupply = _initialSupply;\n   }", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/arithmetic/token.sol", "line": 14, "column": 4}, "severity": "medium", "references": [], "description": ""}, {"id": "32ad619e21d7", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "   function transfer(address _to, uint _value) public returns (bool) {", "highlightLines": [18]}, "category": "code", "location": {"file": "dataset/arithmetic/token.sol", "line": 18, "column": 4}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "769bbf57cc66", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without msg.data.length validation - vulnerable to short address attack padding", "ruleId": "rules.sol-short-address-no-payload-check", "snippet": {"code": "   function transfer(address _to, uint _value) public returns (bool) {", "highlightLines": [18]}, "category": "code", "location": {"file": "dataset/arithmetic/token.sol", "line": 18, "column": 4}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address", "https://vessenes.com/the-erc20-short-address-attack-explained/"], "description": ""}, {"id": "521ac4b337c1", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "   function transfer(address _to, uint _value) public returns (bool) {\n     // <yes> <report> ARITHMETIC\n     require(balances[msg.sender] - _value >= 0);", "highlightLines": [18]}, "category": "code", "location": {"file": "dataset/arithmetic/token.sol", "line": 18, "column": 4}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "9ba23b70a718", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - will never return false, only revert", "ruleId": "rules.sol-return-bool-always-reverts", "snippet": {"code": "   function transfer(address _to, uint _value) public returns (bool) {\n     // <yes> <report> ARITHMETIC\n     require(balances[msg.sender] - _value >= 0);\n     // <yes> <report> ARITHMETIC\n     balances[msg.sender] -= _value;\n     balances[_to] += _value;\n     return true;\n   }", "highlightLines": [18]}, "category": "code", "location": {"file": "dataset/arithmetic/token.sol", "line": 18, "column": 4}, "severity": "info", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "225f36e697cd", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "     require(balances[msg.sender] - _value >= 0);", "highlightLines": [20]}, "category": "code", "location": {"file": "dataset/arithmetic/token.sol", "line": 20, "column": 6}, "severity": "info", "references": [], "description": ""}, {"id": "073f562a3bd7", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.21;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/arithmetic/tokensalechallenge.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "6a1c2bb28ff6", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.21;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/arithmetic/tokensalechallenge.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "e0777c2808a6", "fix": {"template": null, "available": false}, "title": "SWC-118: Function name matches contract name - likely intended as constructor (pre-0.4.22)", "ruleId": "rules.sol-swc-118-constructor-mismatch", "snippet": {"code": "contract TokenSaleChallenge {\n    mapping(address => uint256) public balanceOf;\n    uint256 constant PRICE_PER_TOKEN = 1 ether;\n\n    function TokenSaleChallenge(address _player) public payable {", "highlightLines": [9]}, "category": "code", "location": {"file": "dataset/arithmetic/tokensalechallenge.sol", "line": 9, "column": 1}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-118"], "description": ""}, {"id": "8ae669ac1935", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.value == 1 ether);", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/arithmetic/tokensalechallenge.sol", "line": 14, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "1dd4f66ab0bc", "fix": {"template": null, "available": false}, "title": "ETH balance check without accounting for selfdestruct donations - can be manipulated", "ruleId": "rules.sol-eth-balance-accounting", "snippet": {"code": "        return address(this).balance < 1 ether;", "highlightLines": [18]}, "category": "code", "location": {"file": "dataset/arithmetic/tokensalechallenge.sol", "line": 18, "column": 16}, "severity": "medium", "references": [], "description": ""}, {"id": "b837e037c8e0", "fix": {"template": null, "available": false}, "title": "Token swap/buy without slippage protection - MEV/sandwich attack risk", "ruleId": "rules.sol-missing-slippage-protection", "snippet": {"code": "    function buy(uint256 numTokens) public payable {", "highlightLines": [21]}, "category": "code", "location": {"file": "dataset/arithmetic/tokensalechallenge.sol", "line": 21, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "deb73977337d", "fix": {"template": null, "available": false}, "title": "SWC-114: Transaction order dependence - vulnerable to front-running/sandwich attacks", "ruleId": "rules.sol-swc-114-front-running", "snippet": {"code": "    function buy(uint256 numTokens) public payable {\n        // <yes> <report> ARITHMETIC\n        require(msg.value == numTokens * PRICE_PER_TOKEN);", "highlightLines": [21]}, "category": "code", "location": {"file": "dataset/arithmetic/tokensalechallenge.sol", "line": 21, "column": 5}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-114"], "description": ""}, {"id": "88bafde0ec95", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.value == numTokens * PRICE_PER_TOKEN);", "highlightLines": [23]}, "category": "code", "location": {"file": "dataset/arithmetic/tokensalechallenge.sol", "line": 23, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "70375222de3e", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(balanceOf[msg.sender] >= numTokens);", "highlightLines": [29]}, "category": "code", "location": {"file": "dataset/arithmetic/tokensalechallenge.sol", "line": 29, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "8be8ad68f6a9", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        msg.sender.transfer(numTokens * PRICE_PER_TOKEN);", "highlightLines": [33]}, "category": "code", "location": {"file": "dataset/arithmetic/tokensalechallenge.sol", "line": 33, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "33434843bbad", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": " pragma solidity ^0.4.9;", "highlightLines": [8]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 8, "column": 2}, "severity": "info", "references": [], "description": ""}, {"id": "7ebb1bee011a", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": " pragma solidity ^0.4.9;", "highlightLines": [8]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 8, "column": 2}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "af045605424b", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\t\tuint b = block.number;", "highlightLines": [17]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 17, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c1551f780556", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "\t\tuint b = block.number;\n\t\t// <yes> <report> BAD_RANDOMNESS\n\t\tuint timestamp = block.timestamp;", "highlightLines": [17]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 17, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "7c67107dc09b", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\t\tuint timestamp = block.timestamp;", "highlightLines": [19]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 19, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a9632379a47d", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "\t\tuint timestamp = block.timestamp;", "highlightLines": [19]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 19, "column": 20}, "severity": "medium", "references": [], "description": ""}, {"id": "8e938877a151", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "\t\treturn uint8(uint256(keccak256(block.blockhash(b), player, cardNumber, timestamp)) % 52);", "highlightLines": [21]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 21, "column": 10}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "3908db163795", "fix": {"template": null, "available": false}, "title": "blockhash only works for last 256 blocks - older blocks return 0 (PredictTheBlockHash pattern)", "ruleId": "rules.sol-blockhash-256-limit", "snippet": {"code": "\t\treturn uint8(uint256(keccak256(block.blockhash(b), player, cardNumber, timestamp)) % 52);", "highlightLines": [21]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 21, "column": 34}, "severity": "medium", "references": ["https://capturetheether.com/challenges/lottery/predict-block-hash/"], "description": ""}, {"id": "9f5cad7bb514", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\t\tuint8 value = card / 4;", "highlightLines": [25]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 25, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "de50fb39272d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n\tuint8 BLACKJACK = 21;", "highlightLines": [50]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 50, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "6bf83856dbfc", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\t\taddress player; // address ", "highlightLines": [56]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 56, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0eaa7c3f9cd9", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\t\tuint bet; // ", "highlightLines": [57]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 57, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "2d4f3ae70cc8", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\t\tuint8 cardsDealt;", "highlightLines": [63]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 63, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ec7f959a36a1", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "\tmodifier gameIsGoingOn() {\n\t\tif (games[msg.sender].player == 0 || games[msg.sender].state != GameState.Ongoing) {\n\t\t\tthrow; // game doesn't exist or already finished\n\t\t}\n\t\t_;\n\t}", "highlightLines": [68]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 68, "column": 2}, "severity": "medium", "references": [], "description": ""}, {"id": "aeb442b75058", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "\t\t_;", "highlightLines": [72]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 72, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "175a238dcac9", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "\tevent Deal(\n        bool isUser,\n        uint8 _card\n    );", "highlightLines": [75]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 75, "column": 2}, "severity": "info", "references": [], "description": ""}, {"id": "e6f78920e6c6", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event GameStatus(\n    \tuint8 houseScore,\n    \tuint8 houseScoreBig,\n    \tuint8 playerScore,\n    \tuint8 playerScoreBig\n    );", "highlightLines": [80]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 80, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "69f8fbae3476", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event Log(\n    \tuint8 value\n    );", "highlightLines": [87]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 87, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "494b9d3b6623", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "\tfunction BlackJack() {\n\n\t}", "highlightLines": [91]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 91, "column": 2}, "severity": "medium", "references": [], "description": ""}, {"id": "b9f282a0192c", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "\tfunction () payable {\n\n\t}", "highlightLines": [95]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 95, "column": 2}, "severity": "medium", "references": [], "description": ""}, {"id": "370161dc8644", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "\t\tuint8[] memory houseCards = new uint8[](1);\n\t\tuint8[] memory playerCards = new uint8[](2);", "highlightLines": [109]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 109, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "5ed6a115bbce", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "\t\tuint8[] memory houseCards = new uint8[](1);", "highlightLines": [109]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 109, "column": 31}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "356e03f4ce0f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "\t\tuint8[] memory playerCards = new uint8[](2);\n\n\t\t// deal the cards\n\t\tplayerCards[0] = Deck.deal(msg.sender, 0);", "highlightLines": [110]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 110, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "39558a3e7717", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "\t\tuint8[] memory playerCards = new uint8[](2);", "highlightLines": [110]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 110, "column": 32}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "630f1aba4b78", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "\t\tplayerCards[0] = Deck.deal(msg.sender, 0);\n\t\tDeal(true, playerCards[0]);\n\t\thouseCards[0] = Deck.deal(msg.sender, 1);", "highlightLines": [113]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 113, "column": 3}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "b9e0dc791187", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "\t\tplayerCards[0] = Deck.deal(msg.sender, 0);\n\t\tDeal(true, playerCards[0]);\n\t\thouseCards[0] = Deck.deal(msg.sender, 1);", "highlightLines": [113]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 113, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "e4832827b16d", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "\t\thouseCards[0] = Deck.deal(msg.sender, 1);\n\t\tDeal(false, houseCards[0]);\n\t\tplayerCards[1] = Deck.deal(msg.sender, 2);", "highlightLines": [115]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 115, "column": 3}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "8b2df4a5f451", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "\t\thouseCards[0] = Deck.deal(msg.sender, 1);\n\t\tDeal(false, houseCards[0]);\n\t\tplayerCards[1] = Deck.deal(msg.sender, 2);", "highlightLines": [115]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 115, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "d92653d3d653", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "\t\tplayerCards[1] = Deck.deal(msg.sender, 2);\n\t\tDeal(true, playerCards[1]);\n\n\t\tgames[msg.sender] = Game({\n\t\t\tplayer: msg.sender,\n\t\t\tbet: msg.value,\n\t\t\thouseCards: houseCards,\n\t\t\tplayerCards: playerCards,\n\t\t\tstate: GameState.Ongoing,\n\t\t\tcardsDealt: 3\n\t\t});", "highlightLines": [117]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 117, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "9ff84fcdd785", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\t\tuint8 nextCard = games[msg.sender].cardsDealt;", "highlightLines": [134]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 134, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7e050e4b275f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "\t\tuint8 nextCard = games[msg.sender].cardsDealt;\n\t\tgames[msg.sender].playerCards.push(Deck.deal(msg.sender, nextCard));\n\t\tgames[msg.sender].cardsDealt = nextCard + 1;", "highlightLines": [134]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 134, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "51deda46664d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "\t\tvar (houseScore, houseScoreBig) = calculateScore(games[msg.sender].houseCards);\n\n\t\twhile (houseScoreBig < 17) {\n\t\t\tuint8 nextCard = games[msg.sender].cardsDealt;\n\t\t\tuint8 newCard = Deck.deal(msg.sender, nextCard);\n\t\t\tgames[msg.sender].houseCards.push(newCard);\n\t\t\tgames[msg.sender].cardsDealt = nextCard + 1;\n\t\t\thouseScoreBig += Deck.valueOf(newCard, true);\n\t\t\tDeal(false, newCard);\n\t\t}", "highlightLines": [144]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 144, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "8f810898b913", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "\t\tvar (houseScore, houseScoreBig) = calculateScore(games[msg.sender].houseCards);", "highlightLines": [144]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 144, "column": 8}, "severity": "info", "references": [], "description": ""}, {"id": "af5e7f446e13", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\t\t\tuint8 nextCard = games[msg.sender].cardsDealt;", "highlightLines": [147]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 147, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4e05baf1a369", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "\t\t\tuint8 nextCard = games[msg.sender].cardsDealt;\n\t\t\tuint8 newCard = Deck.deal(msg.sender, nextCard);", "highlightLines": [147]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 147, "column": 4}, "severity": "medium", "references": [], "description": ""}, {"id": "a5550bcaab21", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\t\t\tuint8 newCard = Deck.deal(msg.sender, nextCard);", "highlightLines": [148]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 148, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d0eef3f570b4", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "\t\t\tuint8 newCard = Deck.deal(msg.sender, nextCard);\n\t\t\tgames[msg.sender].houseCards.push(newCard);\n\t\t\tgames[msg.sender].cardsDealt = nextCard + 1;", "highlightLines": [148]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 148, "column": 4}, "severity": "medium", "references": [], "description": ""}, {"id": "b558d7102bbc", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "\t\tvar (houseScore, houseScoreBig) = calculateScore(game.houseCards);\n\t\t// calculate player score\n\t\tvar (playerScore, playerScoreBig) = calculateScore(game.playerCards);", "highlightLines": [161]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 161, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "f24173fe9ed2", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "\t\tvar (houseScore, houseScoreBig) = calculateScore(game.houseCards);", "highlightLines": [161]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 161, "column": 8}, "severity": "info", "references": [], "description": ""}, {"id": "b1b3d50a6e8b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "\t\tvar (playerScore, playerScoreBig) = calculateScore(game.playerCards);\n\n\t\tGameStatus(houseScore, houseScoreBig, playerScore, playerScoreBig);\n\n\t\tif (houseScoreBig == BLACKJACK || houseScore == BLACKJACK) {\n\t\t\tif (playerScore == BLACKJACK || playerScoreBig == BLACKJACK) {\n\t\t\t\t// TIE\n\t\t\t\tif (!msg.sender.send(game.bet)) throw; // return bet to the player\n\t\t\t\tgames[msg.sender].state = GameState.Tie; // finish the game\n\t\t\t\treturn;\n\t\t\t} else {\n\t\t\t\t// HOUSE WON\n\t\t\t\tgames[msg.sender].state = GameState.House; // simply finish the game\n\t\t\t\treturn;\n\t\t\t}\n\t\t} else {\n\t\t\tif (playerScore == BLACKJACK || playerScoreBig == BLACKJACK) {\n\t\t\t\t// PLAYER WON\n\t\t\t\tif (game.playerCards.length == 2 && (Deck.isTen(game.playerCards[0]) || Deck.isTen(game.playerCards[1]))) {\n\t\t\t\t\t// Natural blackjack => return x2.5\n\t\t\t\t\tif (!msg.sender.send((game.bet * 5) / 2)) throw; // send prize to the player\n\t\t\t\t} else {\n\t\t\t\t\t// Usual blackjack => return x2\n\t\t\t\t\tif (!msg.sender.send(game.bet * 2)) throw; // send prize to the player\n\t\t\t\t}\n\t\t\t\tgames[msg.sender].state = GameState.Player; // finish the game\n\t\t\t\treturn;\n\t\t\t} else {\n\n\t\t\t\tif (playerScore > BLACKJACK) {\n\t\t\t\t\t// BUST, HOUSE WON\n\t\t\t\t\tLog(1);\n\t\t\t\t\tgames[msg.sender].state = GameState.House; // finish the game\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!finishGame) {\n\t\t\t\t\treturn; // continue the game\n\t\t\t\t}\n\n                // \n\t\t\t\tuint8 playerShortage = 0;\n\t\t\t\tuint8 houseShortage = 0;\n\n\t\t\t\t// player decided to finish the game\n\t\t\t\tif (playerScoreBig > BLACKJACK) {\n\t\t\t\t\tif (playerScore > BLACKJACK) {\n\t\t\t\t\t\t// HOUSE WON\n\t\t\t\t\t\tgames[msg.sender].state = GameState.House; // simply finish the game\n\t\t\t\t\t\treturn;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tplayerShortage = BLACKJACK - playerScore;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tplayerShortage = BLACKJACK - playerScoreBig;\n\t\t\t\t}\n\n\t\t\t\tif (houseScoreBig > BLACKJACK) {\n\t\t\t\t\tif (houseScore > BLACKJACK) {\n\t\t\t\t\t\t// PLAYER WON\n\t\t\t\t\t\tif (!msg.sender.send(game.bet * 2)) throw; // send prize to the player\n\t\t\t\t\t\tgames[msg.sender].state = GameState.Player;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t} else {\n\t\t\t\t\t\thouseShortage = BLACKJACK - houseScore;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\thouseShortage = BLACKJACK - houseScoreBig;\n\t\t\t\t}\n\n                // ??????????????????????   ?\n\t\t\t\tif (houseShortage == playerShortage) {\n\t\t\t\t\t// TIE\n\t\t\t\t\tif (!msg.sender.send(game.bet)) throw; // return bet to the player\n\t\t\t\t\tgames[msg.sender].state = GameState.Tie;\n\t\t\t\t} else if (houseShortage > playerShortage) {\n\t\t\t\t\t// PLAYER WON\n\t\t\t\t\tif (!msg.sender.send(game.bet * 2)) throw; // send prize to the player\n\t\t\t\t\tgames[msg.sender].state = GameState.Player;\n\t\t\t\t} else {\n\t\t\t\t\tgames[msg.sender].state = GameState.House;\n\t\t\t\t}\n\t\t\t}\n\t\t}", "highlightLines": [163]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 163, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "53668bd52baf", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "\t\tvar (playerScore, playerScoreBig) = calculateScore(game.playerCards);", "highlightLines": [163]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 163, "column": 8}, "severity": "info", "references": [], "description": ""}, {"id": "c7f192f867e7", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "\t\tGameStatus(houseScore, houseScoreBig, playerScore, playerScoreBig);", "highlightLines": [165]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 165, "column": 14}, "severity": "info", "references": [], "description": ""}, {"id": "db8705322e67", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "\t\t\t\treturn;", "highlightLines": [172]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 172, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "51c5a208a1c3", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "\t\t\t\treturn;", "highlightLines": [176]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 176, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "d373a9688336", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "\t\t\t\treturn;", "highlightLines": [189]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 189, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "2d9ada89f224", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "\t\t\t\t\treturn;", "highlightLines": [196]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 196, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "ece4609d927f", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\t\t\t\tuint8 playerShortage = 0;", "highlightLines": [204]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 204, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b1cd137e63f8", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "\t\t\t\tuint8 playerShortage = 0;\n\t\t\t\tuint8 houseShortage = 0;", "highlightLines": [204]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 204, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "f188113e23f0", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\t\t\t\tuint8 houseShortage = 0;", "highlightLines": [205]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 205, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b4e2dceaa057", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "\t\t\t\tuint8 houseShortage = 0;\n\n\t\t\t\t// player decided to finish the game\n\t\t\t\tif (playerScoreBig > BLACKJACK) {\n\t\t\t\t\tif (playerScore > BLACKJACK) {\n\t\t\t\t\t\t// HOUSE WON\n\t\t\t\t\t\tgames[msg.sender].state = GameState.House; // simply finish the game\n\t\t\t\t\t\treturn;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tplayerShortage = BLACKJACK - playerScore;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tplayerShortage = BLACKJACK - playerScoreBig;\n\t\t\t\t}", "highlightLines": [205]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 205, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "8c8da5bfab31", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "\t\t\t\t\t\treturn;", "highlightLines": [212]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 212, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "0e01bc73083a", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "\t\t\t\t\t\treturn;", "highlightLines": [225]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 225, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "e9bd45764996", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\t\tuint8 score = 0;", "highlightLines": [250]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 250, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "92d8aca769eb", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "\t\tuint8 score = 0;\n\t\tuint8 scoreBig = 0; // in case of Ace there could be 2 different scores", "highlightLines": [250]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 250, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "59f6ea326c18", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\t\tuint8 scoreBig = 0; // in case of Ace there could be 2 different scores", "highlightLines": [251]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 251, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "649f1bf2518f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "\t\tuint8 scoreBig = 0; // in case of Ace there could be 2 different scores\n\t\tbool bigAceUsed = false;", "highlightLines": [251]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 251, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "9c25c84f7764", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\t\tbool bigAceUsed = false;", "highlightLines": [252]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 252, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3e094e08fe26", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "\t\tbool bigAceUsed = false;\n\t\tfor (uint i = 0; i < cards.length; ++i) {\n\t\t\tuint8 card = cards[i];\n\t\t\tif (Deck.isAce(card) && !bigAceUsed) { // doesn't make sense to use the second Ace as 11, because it leads to the losing\n\t\t\t\tscoreBig += Deck.valueOf(card, true);\n\t\t\t\tbigAceUsed = true;\n\t\t\t} else {\n\t\t\t\tscoreBig += Deck.valueOf(card, false);\n\t\t\t}\n\t\t\tscore += Deck.valueOf(card, false);\n\t\t}", "highlightLines": [252]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 252, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "1269a67452de", "fix": {"template": null, "available": false}, "title": "Empty array bypasses loop logic - add length check before loop", "ruleId": "rules.sol-empty-array-loop-bypass", "snippet": {"code": "\t\tfor (uint i = 0; i < cards.length; ++i) {", "highlightLines": [253]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 253, "column": 3}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/empty-loop.sol"], "description": ""}, {"id": "2d41e59dbabb", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\t\t\tuint8 card = cards[i];", "highlightLines": [254]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 254, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "916449cca1e0", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "\t\t\tuint8 card = cards[i];\n\t\t\tif (Deck.isAce(card) && !bigAceUsed) { // doesn't make sense to use the second Ace as 11, because it leads to the losing\n\t\t\t\tscoreBig += Deck.valueOf(card, true);\n\t\t\t\tbigAceUsed = true;\n\t\t\t} else {\n\t\t\t\tscoreBig += Deck.valueOf(card, false);\n\t\t\t}", "highlightLines": [254]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 254, "column": 4}, "severity": "medium", "references": [], "description": ""}, {"id": "dc66521283fa", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "\t\treturn (score, scoreBig);", "highlightLines": [263]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 263, "column": 11}, "severity": "info", "references": [], "description": ""}, {"id": "0688de1d2e95", "fix": {"template": null, "available": false}, "title": "Condition is always true/false (tautology/contradiction) - logic error", "ruleId": "rules.sol-tautology-condition", "snippet": {"code": "\tfunction getPlayerCard(uint8 id) public gameIsGoingOn constant returns(uint8) {\n\t\tif (id < 0 || id > games[msg.sender].playerCards.length) {", "highlightLines": [266]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 266, "column": 25}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#tautology-or-contradiction"], "description": ""}, {"id": "09c74682a40f", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "\t\t\tthrow;", "highlightLines": [268]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 268, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "29d2ad55a9b0", "fix": {"template": null, "available": false}, "title": "Condition is always true/false (tautology/contradiction) - logic error", "ruleId": "rules.sol-tautology-condition", "snippet": {"code": "\tfunction getHouseCard(uint8 id) public gameIsGoingOn constant returns(uint8) {\n\t\tif (id < 0 || id > games[msg.sender].houseCards.length) {", "highlightLines": [273]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 273, "column": 24}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#tautology-or-contradiction"], "description": ""}, {"id": "706a7a7c2fe5", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "\t\t\tthrow;", "highlightLines": [275]}, "category": "code", "location": {"file": "dataset/bad_randomness/blackjack.sol", "line": 275, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "5343efd97640", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": " pragma solidity ^0.4.16;", "highlightLines": [8]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 8, "column": 2}, "severity": "info", "references": [], "description": ""}, {"id": "f76b61689aa1", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": " pragma solidity ^0.4.16;", "highlightLines": [8]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 8, "column": 2}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "e3a3415b8859", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address addr;", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 12, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3fbb2248c3f6", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint raffleId;", "highlightLines": [13]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 13, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ca7496465373", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event RaffleResult(\n        uint raffleId,\n        uint winningNumber,\n        address winningAddress,\n        address seed1,\n        address seed2,\n        uint seed3,\n        bytes32 randHash\n    );", "highlightLines": [16]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 16, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "4a477654fded", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event TicketPurchase(\n        uint raffleId,\n        address contestant,\n        uint number\n    );", "highlightLines": [26]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 26, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "045d5b7aead3", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event TicketRefund(\n        uint raffleId,\n        address contestant,\n        uint number\n    );", "highlightLines": [32]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 32, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "84e6209b81fe", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address feeAddress;", "highlightLines": [43]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 43, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f13c15533fd2", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint nextTicket = 0;", "highlightLines": [50]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 50, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0de327ebfabd", "fix": {"template": null, "available": false}, "title": "Token swap/buy without slippage protection - MEV/sandwich attack risk", "ruleId": "rules.sol-missing-slippage-protection", "snippet": {"code": "    function buyTickets() payable public {", "highlightLines": [64]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 64, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "1c6ace4da361", "fix": {"template": null, "available": false}, "title": "SWC-114: Transaction order dependence - vulnerable to front-running/sandwich attacks", "ruleId": "rules.sol-swc-114-front-running", "snippet": {"code": "    function buyTickets() payable public {\n        if (paused) {\n            msg.sender.transfer(msg.value);", "highlightLines": [64]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 64, "column": 5}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-114"], "description": ""}, {"id": "961e2aa761b9", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "            msg.sender.transfer(msg.value);", "highlightLines": [66]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 66, "column": 13}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "693bec08f474", "fix": {"template": null, "available": false}, "title": "ERC20 transfer() return value not checked - tokens like USDT don't return bool", "ruleId": "rules.sol-erc20-transfer-no-return-check", "snippet": {"code": "            msg.sender.transfer(msg.value);\n            return;\n        }\n\n        uint moneySent = msg.value;\n\n        while (moneySent >= pricePerTicket && nextTicket < totalTickets) {\n            uint currTicket = 0;\n            if (gaps.length > 0) {\n                currTicket = gaps[gaps.length-1];\n                gaps.length--;\n            } else {\n                currTicket = nextTicket++;\n            }\n\n            contestants[currTicket] = Contestant(msg.sender, raffleId);", "highlightLines": [66]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 66, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "1b6493c71cc2", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "            return;", "highlightLines": [67]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 67, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "484693940608", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint moneySent = msg.value;", "highlightLines": [69]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 69, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f66b8a5c142f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint moneySent = msg.value;\n\n        while (moneySent >= pricePerTicket && nextTicket < totalTickets) {\n            uint currTicket = 0;\n            if (gaps.length > 0) {\n                currTicket = gaps[gaps.length-1];\n                gaps.length--;\n            } else {\n                currTicket = nextTicket++;\n            }\n\n            contestants[currTicket] = Contestant(msg.sender, raffleId);\n            TicketPurchase(raffleId, msg.sender, currTicket);\n            moneySent -= pricePerTicket;\n        }", "highlightLines": [70]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 70, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "8c303d31437f", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint currTicket = 0;", "highlightLines": [73]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 73, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b99ecc4fa718", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            uint currTicket = 0;\n            if (gaps.length > 0) {\n                currTicket = gaps[gaps.length-1];\n                gaps.length--;\n            } else {\n                currTicket = nextTicket++;\n            }", "highlightLines": [73]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 73, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "f4aed082153c", "fix": {"template": null, "available": false}, "title": "Array length can be manipulated - potential storage slot overflow attack (AlienCodex pattern)", "ruleId": "rules.sol-array-length-manipulation", "snippet": {"code": "                gaps.length--;", "highlightLines": [76]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 76, "column": 17}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/level/19"], "description": ""}, {"id": "91988f220668", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "        if (nextTicket == totalTickets) {\n            chooseWinner();\n        }", "highlightLines": [87]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 87, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "7fd9b9b013a9", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "            msg.sender.transfer(moneySent);", "highlightLines": [93]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 93, "column": 13}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "296834e666fe", "fix": {"template": null, "available": false}, "title": "ERC20 transfer() return value not checked - tokens like USDT don't return bool", "ruleId": "rules.sol-erc20-transfer-no-return-check", "snippet": {"code": "            msg.sender.transfer(moneySent);\n        }\n    }\n\n    function chooseWinner() private {\n        // <yes> <report> BAD_RANDOMNESS\n        address seed1 = contestants[uint(block.coinbase) % totalTickets].addr;\n        // <yes> <report> BAD_RANDOMNESS\n        address seed2 = contestants[uint(msg.sender) % totalTickets].addr;\n        // <yes> <report> BAD_RANDOMNESS\n        uint seed3 = block.difficulty;\n        bytes32 randHash = keccak256(seed1, seed2, seed3);", "highlightLines": [93]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 93, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "86507772c1ee", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address seed1 = contestants[uint(block.coinbase) % totalTickets].addr;", "highlightLines": [99]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 99, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "07c351688b29", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address seed1 = contestants[uint(block.coinbase) % totalTickets].addr;\n        // <yes> <report> BAD_RANDOMNESS\n        address seed2 = contestants[uint(msg.sender) % totalTickets].addr;", "highlightLines": [99]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 99, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "447cec4c2bfb", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "        address seed1 = contestants[uint(block.coinbase) % totalTickets].addr;", "highlightLines": [99]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 99, "column": 37}, "severity": "info", "references": [], "description": ""}, {"id": "d3fe11954865", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address seed2 = contestants[uint(msg.sender) % totalTickets].addr;", "highlightLines": [101]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 101, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d95467c710ba", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address seed2 = contestants[uint(msg.sender) % totalTickets].addr;\n        // <yes> <report> BAD_RANDOMNESS\n        uint seed3 = block.difficulty;", "highlightLines": [101]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 101, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d7d30230e7c0", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "        address seed2 = contestants[uint(msg.sender) % totalTickets].addr;", "highlightLines": [101]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 101, "column": 37}, "severity": "info", "references": [], "description": ""}, {"id": "cc9622e0ec37", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint seed3 = block.difficulty;", "highlightLines": [103]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 103, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0c542bafea53", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint seed3 = block.difficulty;\n        bytes32 randHash = keccak256(seed1, seed2, seed3);", "highlightLines": [103]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 103, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "a1302f865a1b", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        uint seed3 = block.difficulty;", "highlightLines": [103]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 103, "column": 22}, "severity": "medium", "references": [], "description": ""}, {"id": "aba6c5fe7d2f", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 randHash = keccak256(seed1, seed2, seed3);", "highlightLines": [104]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 104, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4d0c663f8f63", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes32 randHash = keccak256(seed1, seed2, seed3);\n\n        uint winningNumber = uint(randHash) % totalTickets;", "highlightLines": [104]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 104, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "7021ccf0f73e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint winningNumber = uint(randHash) % totalTickets;", "highlightLines": [105]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 105, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "762b4821a372", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint winningNumber = uint(randHash) % totalTickets;\n        address winningAddress = contestants[winningNumber].addr;", "highlightLines": [106]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 106, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "dcbd91b18ce1", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "        uint winningNumber = uint(randHash) % totalTickets;", "highlightLines": [106]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 106, "column": 30}, "severity": "info", "references": [], "description": ""}, {"id": "297bd7855262", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address winningAddress = contestants[winningNumber].addr;", "highlightLines": [107]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 107, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "63d515b09b08", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address winningAddress = contestants[winningNumber].addr;\n        RaffleResult(raffleId, winningNumber, winningAddress, seed1, seed2, seed3, randHash);\n\n        // Start next raffle\n        raffleId++;\n        nextTicket = 0;", "highlightLines": [107]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 107, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "fea43a812766", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        nextTicket = 0;\n        // <yes> <report> BAD_RANDOMNESS\n        blockNumber = block.number;", "highlightLines": [112]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 112, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "0989c8262557", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        winningAddress.transfer(prize);", "highlightLines": [121]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 121, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "3aaf906d54bf", "fix": {"template": null, "available": false}, "title": "ERC20 transfer() return value not checked - tokens like USDT don't return bool", "ruleId": "rules.sol-erc20-transfer-no-return-check", "snippet": {"code": "        winningAddress.transfer(prize);\n        feeAddress.transfer(fee);\n    }\n\n    // Get your money back before the raffle occurs\n    function getRefund() public {\n        uint refund = 0;\n        for (uint i = 0; i < totalTickets; i++) {\n            if (msg.sender == contestants[i].addr && raffleId == contestants[i].raffleId) {\n                refund += pricePerTicket;\n                contestants[i] = Contestant(address(0), 0);", "highlightLines": [121]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 121, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "8dd8d347d96c", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        feeAddress.transfer(fee);", "highlightLines": [122]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 122, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "5ec0bcbe5d4a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint refund = 0;", "highlightLines": [127]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 127, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b00663fb985f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint refund = 0;\n        for (uint i = 0; i < totalTickets; i++) {\n            if (msg.sender == contestants[i].addr && raffleId == contestants[i].raffleId) {\n                refund += pricePerTicket;\n                contestants[i] = Contestant(address(0), 0);\n                gaps.push(i);\n                TicketRefund(raffleId, msg.sender, i);\n            }\n        }", "highlightLines": [127]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 127, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "73f57aaa4813", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "            msg.sender.transfer(refund);", "highlightLines": [138]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 138, "column": 13}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "ebc24e303a9c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            paused = true;\n\n            for (uint i = 0; i < totalTickets; i++) {\n                if (raffleId == contestants[i].raffleId) {\n                    TicketRefund(raffleId, contestants[i].addr, i);\n                    contestants[i].addr.transfer(pricePerTicket);\n                }\n            }\n\n            RaffleResult(raffleId, totalTickets, address(0), address(0), address(0), 0, 0);\n            raffleId++;\n            nextTicket = 0;", "highlightLines": [145]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 145, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "5ec2666d21ab", "fix": {"template": null, "available": false}, "title": "Loop with external transfers - one failing recipient blocks all others", "ruleId": "rules.sol-denial-of-service-loop-transfer", "snippet": {"code": "            for (uint i = 0; i < totalTickets; i++) {\n                if (raffleId == contestants[i].raffleId) {\n                    TicketRefund(raffleId, contestants[i].addr, i);\n                    contestants[i].addr.transfer(pricePerTicket);", "highlightLines": [147]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 147, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "975d14ccfd77", "fix": {"template": null, "available": false}, "title": "ETH transfer inside loop - single failed transfer blocks all others (DoS pattern)", "ruleId": "rules.sol-loop-with-transfer", "snippet": {"code": "            for (uint i = 0; i < totalTickets; i++) {\n                if (raffleId == contestants[i].raffleId) {\n                    TicketRefund(raffleId, contestants[i].addr, i);\n                    contestants[i].addr.transfer(pricePerTicket);", "highlightLines": [147]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 147, "column": 13}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "e967cc5bbda7", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "                    contestants[i].addr.transfer(pricePerTicket);", "highlightLines": [150]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 150, "column": 21}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "63e0c1cb8aec", "fix": {"template": null, "available": false}, "title": "External call in loop - gas griefing and DOS risk", "ruleId": "rules.sol-external-call-in-loop", "snippet": {"code": "                    contestants[i].addr.transfer(pricePerTicket);", "highlightLines": [150]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 150, "column": 21}, "severity": "high", "references": [], "description": ""}, {"id": "b4edfa6d66ad", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            nextTicket = 0;\n            // <yes> <report> BAD_RANDOMNESS\n            blockNumber = block.number;", "highlightLines": [156]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 156, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "d9f4fc160178", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            blockNumber = block.number;\n            gaps.length = 0;", "highlightLines": [158]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 158, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "0c2673f8a5ce", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "        if (msg.sender == feeAddress) {\n            selfdestruct(feeAddress);\n        }", "highlightLines": [170]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 170, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "aa311c0fd5a6", "fix": {"template": null, "available": false}, "title": "Contract can be destructed by anyone - missing access control on selfdestruct", "ruleId": "rules.sol-accessible-selfdestruct", "snippet": {"code": "            selfdestruct(feeAddress);", "highlightLines": [171]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 171, "column": 13}, "severity": "high", "references": ["https://www.parity.io/blog/a-postmortem-on-the-parity-multi-sig-library-self-destruct/"], "description": ""}, {"id": "e535a0e06cfd", "fix": {"template": null, "available": false}, "title": "Selfdestruct with user-controlled recipient - funds can be sent anywhere", "ruleId": "rules.sol-selfdestruct-arbitrary", "snippet": {"code": "            selfdestruct(feeAddress);", "highlightLines": [171]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 171, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "6479261036ee", "fix": {"template": null, "available": false}, "title": "selfdestruct can force ETH to any address - contracts cannot prevent receiving ETH this way (Force pattern)", "ruleId": "rules.sol-selfdestruct-force-eth", "snippet": {"code": "            selfdestruct(feeAddress);", "highlightLines": [171]}, "category": "code", "location": {"file": "dataset/bad_randomness/etheraffle.sol", "line": 171, "column": 13}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/7"], "description": ""}, {"id": "1563dd7934bd", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.21;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/bad_randomness/guess_the_random_number.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "d5f3659bcf2a", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.21;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/bad_randomness/guess_the_random_number.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "1fb7864a8747", "fix": {"template": null, "available": false}, "title": "SWC-118: Function name matches contract name - likely intended as constructor (pre-0.4.22)", "ruleId": "rules.sol-swc-118-constructor-mismatch", "snippet": {"code": "contract GuessTheRandomNumberChallenge {\n    uint8 answer;\n\n    function GuessTheRandomNumberChallenge() public payable {", "highlightLines": [9]}, "category": "code", "location": {"file": "dataset/bad_randomness/guess_the_random_number.sol", "line": 9, "column": 1}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-118"], "description": ""}, {"id": "7bdd28aee589", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint8 answer;", "highlightLines": [10]}, "category": "code", "location": {"file": "dataset/bad_randomness/guess_the_random_number.sol", "line": 10, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b7a56d1bfc5e", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.value == 1 ether);", "highlightLines": [13]}, "category": "code", "location": {"file": "dataset/bad_randomness/guess_the_random_number.sol", "line": 13, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "510d9f5dd8e2", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        answer = uint8(keccak256(block.blockhash(block.number - 1), now));", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/bad_randomness/guess_the_random_number.sol", "line": 15, "column": 18}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "ae64148aa19f", "fix": {"template": null, "available": false}, "title": "blockhash only works for last 256 blocks - older blocks return 0 (PredictTheBlockHash pattern)", "ruleId": "rules.sol-blockhash-256-limit", "snippet": {"code": "        answer = uint8(keccak256(block.blockhash(block.number - 1), now));", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/bad_randomness/guess_the_random_number.sol", "line": 15, "column": 34}, "severity": "medium", "references": ["https://capturetheether.com/challenges/lottery/predict-block-hash/"], "description": ""}, {"id": "fb088faab5e9", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - predictable by miners, 0 after 256 blocks", "ruleId": "rules.sol-blockhash-randomness", "snippet": {"code": "        answer = uint8(keccak256(block.blockhash(block.number - 1), now));", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/bad_randomness/guess_the_random_number.sol", "line": 15, "column": 40}, "severity": "high", "references": [], "description": ""}, {"id": "2f5ef186dee0", "fix": {"template": null, "available": false}, "title": "blockhash(block.number - 1) used for randomness - miners can manipulate", "ruleId": "rules.sol-blockhash-previous-block", "snippet": {"code": "        answer = uint8(keccak256(block.blockhash(block.number - 1), now));", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/bad_randomness/guess_the_random_number.sol", "line": 15, "column": 40}, "severity": "medium", "references": [], "description": ""}, {"id": "bf1246f39588", "fix": {"template": null, "available": false}, "title": "ETH balance check without accounting for selfdestruct donations - can be manipulated", "ruleId": "rules.sol-eth-balance-accounting", "snippet": {"code": "        return address(this).balance == 0;", "highlightLines": [19]}, "category": "code", "location": {"file": "dataset/bad_randomness/guess_the_random_number.sol", "line": 19, "column": 16}, "severity": "medium", "references": [], "description": ""}, {"id": "f00130c2d0c1", "fix": {"template": null, "available": false}, "title": "Strict equality on balance - can be manipulated via selfdestruct or direct transfer", "ruleId": "rules.sol-dangerous-strict-equality", "snippet": {"code": "        return address(this).balance == 0;", "highlightLines": [19]}, "category": "code", "location": {"file": "dataset/bad_randomness/guess_the_random_number.sol", "line": 19, "column": 16}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dangerous-strict-equalities"], "description": ""}, {"id": "f3b0eafcc70b", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function guess(uint8 n) public payable {\n        require(msg.value == 1 ether);\n\n        if (n == answer) {", "highlightLines": [22]}, "category": "code", "location": {"file": "dataset/bad_randomness/guess_the_random_number.sol", "line": 22, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "b068d678aa35", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.value == 1 ether);", "highlightLines": [23]}, "category": "code", "location": {"file": "dataset/bad_randomness/guess_the_random_number.sol", "line": 23, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "e5e585847061", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "        if (n == answer) {\n            msg.sender.transfer(2 ether);\n        }", "highlightLines": [25]}, "category": "code", "location": {"file": "dataset/bad_randomness/guess_the_random_number.sol", "line": 25, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "9d5b29909399", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "            msg.sender.transfer(2 ether);", "highlightLines": [26]}, "category": "code", "location": {"file": "dataset/bad_randomness/guess_the_random_number.sol", "line": 26, "column": 13}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "b1028e480153", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "  pragma solidity ^0.4.0;", "highlightLines": [9]}, "category": "code", "location": {"file": "dataset/bad_randomness/lottery.sol", "line": 9, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "8a3f9bb7755e", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "  pragma solidity ^0.4.0;", "highlightLines": [9]}, "category": "code", "location": {"file": "dataset/bad_randomness/lottery.sol", "line": 9, "column": 3}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "f5fe2b37bb36", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "     event GetBet(uint betAmount, uint blockNumber, bool won);", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/bad_randomness/lottery.sol", "line": 12, "column": 6}, "severity": "info", "references": [], "description": ""}, {"id": "a4e79601ed95", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "         uint betAmount;", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/bad_randomness/lottery.sol", "line": 15, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0938ba411636", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "         uint blockNumber;", "highlightLines": [16]}, "category": "code", "location": {"file": "dataset/bad_randomness/lottery.sol", "line": 16, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "868075140780", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "         bool won;", "highlightLines": [17]}, "category": "code", "location": {"file": "dataset/bad_randomness/lottery.sol", "line": 17, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c46502b85c6c", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "     function Lottery() {\n         organizer = msg.sender;\n     }", "highlightLines": [24]}, "category": "code", "location": {"file": "dataset/bad_randomness/lottery.sol", "line": 24, "column": 6}, "severity": "medium", "references": [], "description": ""}, {"id": "471b74c4dfa1", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "     function() {\n         throw;\n     }", "highlightLines": [29]}, "category": "code", "location": {"file": "dataset/bad_randomness/lottery.sol", "line": 29, "column": 6}, "severity": "medium", "references": [], "description": ""}, {"id": "171e275806b6", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "         throw;", "highlightLines": [30]}, "category": "code", "location": {"file": "dataset/bad_randomness/lottery.sol", "line": 30, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "8c3235d07f13", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "     function makeBet() {\n         // Won if block number is even\n         // (note: this is a terrible source of randomness, please don't use this with real money)\n         // <yes> <report> BAD_RANDOMNESS\n         bool won = (block.number % 2) == 0;\n\n         // Record the bet with an event\n         // <yes> <report> BAD_RANDOMNESS\n         bets.push(Bet(msg.value, block.number, won));\n\n         // Payout if the user won, otherwise take their money\n         if(won) {\n             if(!msg.sender.send(msg.value)) {\n                 // Return ether to sender\n                 throw;\n             }\n         }\n     }", "highlightLines": [34]}, "category": "code", "location": {"file": "dataset/bad_randomness/lottery.sol", "line": 34, "column": 6}, "severity": "medium", "references": [], "description": ""}, {"id": "f502e3c25760", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "         bool won = (block.number % 2) == 0;", "highlightLines": [38]}, "category": "code", "location": {"file": "dataset/bad_randomness/lottery.sol", "line": 38, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d2143fab3330", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "                 throw;", "highlightLines": [48]}, "category": "code", "location": {"file": "dataset/bad_randomness/lottery.sol", "line": 48, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "03e4f7964432", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "     function getBets() {\n         if(msg.sender != organizer) { throw; }\n\n         for (uint i = 0; i < bets.length; i++) {\n             GetBet(bets[i].betAmount, bets[i].blockNumber, bets[i].won);\n         }\n     }", "highlightLines": [54]}, "category": "code", "location": {"file": "dataset/bad_randomness/lottery.sol", "line": 54, "column": 6}, "severity": "medium", "references": [], "description": ""}, {"id": "73358348303b", "fix": {"template": null, "available": false}, "title": "Empty array bypasses loop logic - add length check before loop", "ruleId": "rules.sol-empty-array-loop-bypass", "snippet": {"code": "         for (uint i = 0; i < bets.length; i++) {", "highlightLines": [57]}, "category": "code", "location": {"file": "dataset/bad_randomness/lottery.sol", "line": 57, "column": 10}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/empty-loop.sol"], "description": ""}, {"id": "ae2943239ab9", "fix": {"template": null, "available": false}, "title": "Unbounded loop over array - potential DOS via gas limit", "ruleId": "rules.sol-unbounded-loop", "snippet": {"code": "         for (uint i = 0; i < bets.length; i++) {\n             GetBet(bets[i].betAmount, bets[i].blockNumber, bets[i].won);\n         }", "highlightLines": [57]}, "category": "code", "location": {"file": "dataset/bad_randomness/lottery.sol", "line": 57, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "30159e19df15", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "     function destroy() {\n         if(msg.sender != organizer) { throw; }\n\n         suicide(organizer);\n     }", "highlightLines": [63]}, "category": "code", "location": {"file": "dataset/bad_randomness/lottery.sol", "line": 63, "column": 6}, "severity": "medium", "references": [], "description": ""}, {"id": "20382bd1888c", "fix": {"template": null, "available": false}, "title": "Contract can be destructed by anyone - missing access control on selfdestruct", "ruleId": "rules.sol-accessible-selfdestruct", "snippet": {"code": "         suicide(organizer);", "highlightLines": [66]}, "category": "code", "location": {"file": "dataset/bad_randomness/lottery.sol", "line": 66, "column": 10}, "severity": "high", "references": ["https://www.parity.io/blog/a-postmortem-on-the-parity-multi-sig-library-self-destruct/"], "description": ""}, {"id": "83a219c3e0bc", "fix": {"template": null, "available": false}, "title": "suicide() is deprecated - use selfdestruct() instead", "ruleId": "rules.sol-deprecated-suicide", "snippet": {"code": "         suicide(organizer);", "highlightLines": [66]}, "category": "code", "location": {"file": "dataset/bad_randomness/lottery.sol", "line": 66, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "dff791acd16c", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.0;", "highlightLines": [9]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 9, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "d29dc9df2f44", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.0;", "highlightLines": [9]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 9, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "b7b08213eca8", "fix": {"template": null, "available": false}, "title": "SWC-118: Function name matches contract name - likely intended as constructor (pre-0.4.22)", "ruleId": "rules.sol-swc-118-constructor-mismatch", "snippet": {"code": " contract LuckyDoubler {\n//##########################################################\n//#### LuckyDoubler: A doubler with random payout order ####\n//#### Deposit 1 ETHER to participate                   ####\n//##########################################################\n//COPYRIGHT 2016 KATATSUKI ALL RIGHTS RESERVED\n//No part of this source code may be reproduced, distributed,\n//modified or transmitted in any form or by any means without\n//the prior written permission of the creator.\n\n    address private owner;\n\n    //Stored variables\n    uint private balance = 0;\n    uint private fee = 5;\n    uint private multiplier = 125;\n\n    mapping (address => User) private users;\n    Entry[] private entries;\n    uint[] private unpaidEntries;\n\n    //Set owner on contract creation\n    function LuckyDoubler() {", "highlightLines": [11]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 11, "column": 2}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-118"], "description": ""}, {"id": "2b36479e80da", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function LuckyDoubler() {\n        owner = msg.sender;\n    }", "highlightLines": [33]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 33, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "7e0cff33586b", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        owner = msg.sender;", "highlightLines": [34]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 34, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "7684d19f5f02", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyowner { if (msg.sender == owner) _; }", "highlightLines": [37]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 37, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "d73b2fc297af", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address id;", "highlightLines": [40]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 40, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f30baafb9353", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint deposits;", "highlightLines": [41]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 41, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b6cfa0a9ab13", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint payoutsReceived;", "highlightLines": [42]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 42, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "740c2f90d010", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address entryAddress;", "highlightLines": [46]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 46, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3e752dfd3cef", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint deposit;", "highlightLines": [47]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 47, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "49b6499c1e5c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint payout;", "highlightLines": [48]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 48, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c6b57f98e610", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool paid;", "highlightLines": [49]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 49, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f408afd56a26", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function() {\n        init();\n    }", "highlightLines": [53]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 53, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "777167ddb5cb", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "             msg.sender.send(msg.value);", "highlightLines": [60]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 60, "column": 14}, "severity": "high", "references": [], "description": ""}, {"id": "eda32622742b", "fix": {"template": null, "available": false}, "title": "send() return value not checked - Ether may be stuck if recipient reverts", "ruleId": "rules.sol-unchecked-send-return", "snippet": {"code": "             msg.sender.send(msg.value);", "highlightLines": [60]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 60, "column": 24}, "severity": "high", "references": [], "description": ""}, {"id": "47671063d594", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "            return;", "highlightLines": [61]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 61, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "e3c6f3bf6471", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint dValue = 1 ether;", "highlightLines": [70]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 70, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "702053ef88ed", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint dValue = 1 ether;\n\n        if (msg.value > 1 ether) {\n\n        \tmsg.sender.send(msg.value - 1 ether);\n        \tdValue = 1 ether;\n        }", "highlightLines": [70]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 70, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "fa4a3d811539", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "        \tmsg.sender.send(msg.value - 1 ether);", "highlightLines": [74]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 74, "column": 10}, "severity": "high", "references": [], "description": ""}, {"id": "4b0ef0888018", "fix": {"template": null, "available": false}, "title": "send() return value not checked - Ether may be stuck if recipient reverts", "ruleId": "rules.sol-unchecked-send-return", "snippet": {"code": "        \tmsg.sender.send(msg.value - 1 ether);", "highlightLines": [74]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 74, "column": 20}, "severity": "high", "references": [], "description": ""}, {"id": "5ed96488a688", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            users[msg.sender].id = msg.sender;\n            users[msg.sender].deposits = 0;", "highlightLines": [81]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 81, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "d6b61c5771f2", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            users[msg.sender].deposits = 0;\n            users[msg.sender].payoutsReceived = 0;", "highlightLines": [82]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 82, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "a5c44eb659b1", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint index = unpaidEntries.length > 1 ? rand(unpaidEntries.length) : 0;", "highlightLines": [93]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 93, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "5253e1654d0b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint index = unpaidEntries.length > 1 ? rand(unpaidEntries.length) : 0;\n        Entry theEntry = entries[unpaidEntries[index]];", "highlightLines": [94]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 94, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "c5a18e51791b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        Entry theEntry = entries[unpaidEntries[index]];\n\n        //Pay pending entries if the new balance allows for it\n        if (balance > theEntry.payout) {\n\n            uint payout = theEntry.payout;\n\n            theEntry.entryAddress.send(payout);\n            theEntry.paid = true;\n            users[theEntry.entryAddress].payoutsReceived++;\n\n            balance -= payout;\n\n            if (index < unpaidEntries.length - 1)\n                unpaidEntries[index] = unpaidEntries[unpaidEntries.length - 1];\n\n            unpaidEntries.length--;\n\n        }", "highlightLines": [95]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 95, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e262846afba8", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n            uint payout = theEntry.payout;", "highlightLines": [99]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 99, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "542701c6b69a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            uint payout = theEntry.payout;\n\n            theEntry.entryAddress.send(payout);\n            theEntry.paid = true;", "highlightLines": [100]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 100, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "80fe2259d68e", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "            theEntry.entryAddress.send(payout);", "highlightLines": [102]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 102, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "6183dceb1f0d", "fix": {"template": null, "available": false}, "title": "send() return value not checked - Ether may be stuck if recipient reverts", "ruleId": "rules.sol-unchecked-send-return", "snippet": {"code": "            theEntry.entryAddress.send(payout);", "highlightLines": [102]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 102, "column": 34}, "severity": "high", "references": [], "description": ""}, {"id": "c0f9d1acef0e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            theEntry.paid = true;\n            users[theEntry.entryAddress].payoutsReceived++;\n\n            balance -= payout;\n\n            if (index < unpaidEntries.length - 1)\n                unpaidEntries[index] = unpaidEntries[unpaidEntries.length - 1];", "highlightLines": [103]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 103, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "7f259c0a1ea2", "fix": {"template": null, "available": false}, "title": "Array length can be manipulated - potential storage slot overflow attack (AlienCodex pattern)", "ruleId": "rules.sol-array-length-manipulation", "snippet": {"code": "            unpaidEntries.length--;", "highlightLines": [111]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 111, "column": 13}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/level/19"], "description": ""}, {"id": "0e1a1318e13a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint fees = this.balance - balance;", "highlightLines": [116]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 116, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e292e7aa28fd", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "                owner.send(fees);", "highlightLines": [119]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 119, "column": 17}, "severity": "high", "references": [], "description": ""}, {"id": "fafa9fa0dc83", "fix": {"template": null, "available": false}, "title": "send() return value not checked - Ether may be stuck if recipient reverts", "ruleId": "rules.sol-unchecked-send-return", "snippet": {"code": "                owner.send(fees);", "highlightLines": [119]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 119, "column": 22}, "severity": "high", "references": [], "description": ""}, {"id": "6ced88d3fdff", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 factor = FACTOR * 100 / max;", "highlightLines": [128]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 128, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "68f7e90b06fd", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 factor = FACTOR * 100 / max;\n        uint256 lastBlockNumber = block.number - 1;", "highlightLines": [128]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 128, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e5c7d96c3cf7", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 lastBlockNumber = block.number - 1;", "highlightLines": [129]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 129, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e6beffcb70bf", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 lastBlockNumber = block.number - 1;\n        uint256 hashVal = uint256(block.blockhash(lastBlockNumber));", "highlightLines": [129]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 129, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "82acb95d2d5e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 hashVal = uint256(block.blockhash(lastBlockNumber));", "highlightLines": [130]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 130, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "cf0bb8cb14e2", "fix": {"template": null, "available": false}, "title": "blockhash only works for last 256 blocks - older blocks return 0 (PredictTheBlockHash pattern)", "ruleId": "rules.sol-blockhash-256-limit", "snippet": {"code": "        uint256 hashVal = uint256(block.blockhash(lastBlockNumber));", "highlightLines": [130]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 130, "column": 35}, "severity": "medium", "references": ["https://capturetheether.com/challenges/lottery/predict-block-hash/"], "description": ""}, {"id": "b9704ed9abf9", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function changeOwner(address newOwner) onlyowner {\n        owner = newOwner;\n    }", "highlightLines": [137]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 137, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "891350df6e5b", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        owner = newOwner;", "highlightLines": [138]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 138, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "097947bb6005", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function changeMultiplier(uint multi) onlyowner {\n        if (multi < 110 || multi > 150) throw;\n\n        multiplier = multi;\n    }", "highlightLines": [141]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 141, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "7c8710c05076", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "        if (multi < 110 || multi > 150) throw;\n\n        multiplier = multi;", "highlightLines": [142]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 142, "column": 41}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "e2ee4a5d399d", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function changeFee(uint newFee) onlyowner {\n        if (fee > 5)\n            throw;\n        fee = newFee;\n    }", "highlightLines": [147]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 147, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "a3dd992be6ab", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "            throw;", "highlightLines": [149]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 149, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "c1878246777d", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "            throw;\n        fee = newFee;", "highlightLines": [149]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 149, "column": 13}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "35f46a6be418", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function multiplierFactor() constant returns (uint factor, string info) {\n        factor = multiplier;\n        info = 'The current multiplier applied to all deposits. Min 110%, max 150%.';\n    }", "highlightLines": [155]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 155, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "b98fcd7449fa", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        factor = multiplier;\n        info = 'The current multiplier applied to all deposits. Min 110%, max 150%.';", "highlightLines": [156]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 156, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "376035e2248b", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function currentFee() constant returns (uint feePercentage, string info) {\n        feePercentage = fee;\n        info = 'The fee percentage applied to all deposits. It can change to speed payouts (max 5%).';\n    }", "highlightLines": [160]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 160, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "6e70e2dde728", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        feePercentage = fee;\n        info = 'The fee percentage applied to all deposits. It can change to speed payouts (max 5%).';", "highlightLines": [161]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 161, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "6d6198b51e99", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function totalEntries() constant returns (uint count, string info) {\n        count = entries.length;\n        info = 'The number of deposits.';\n    }", "highlightLines": [165]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 165, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "e1914230fcba", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        count = entries.length;\n        info = 'The number of deposits.';", "highlightLines": [166]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 166, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "8b00c86e6680", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function userStats(address user) constant returns (uint deposits, uint payouts, string info)\n    {\n        if (users[user].id != address(0x0))\n        {\n            deposits = users[user].deposits;\n            payouts = users[user].payoutsReceived;\n            info = 'Users stats: total deposits, payouts received.';\n        }\n    }", "highlightLines": [170]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 170, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "a9571611cbd4", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            deposits = users[user].deposits;\n            payouts = users[user].payoutsReceived;", "highlightLines": [174]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 174, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "813641f3efca", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            payouts = users[user].payoutsReceived;\n            info = 'Users stats: total deposits, payouts received.';", "highlightLines": [175]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 175, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "b5e208a5d1b5", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function entryDetails(uint index) constant returns (address user, uint payout, bool paid, string info)\n    {\n        if (index < entries.length) {\n            user = entries[index].entryAddress;\n            payout = entries[index].payout / 1 finney;\n            paid = entries[index].paid;\n            info = 'Entry info: user address, expected payout in Finneys, payout status.';\n        }\n    }", "highlightLines": [180]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 180, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "9a09181dc5b6", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            user = entries[index].entryAddress;\n            payout = entries[index].payout / 1 finney;", "highlightLines": [183]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 183, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "a5d82e27eb58", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            payout = entries[index].payout / 1 finney;\n            paid = entries[index].paid;", "highlightLines": [184]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 184, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "8013169db17a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            paid = entries[index].paid;\n            info = 'Entry info: user address, expected payout in Finneys, payout status.';", "highlightLines": [185]}, "category": "code", "location": {"file": "dataset/bad_randomness/lucky_doubler.sol", "line": 185, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "1849539bfdc2", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.24;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/bad_randomness/old_blockhash.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "0e8685618585", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.24;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/bad_randomness/old_blockhash.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "0011a729cec5", "fix": {"template": null, "available": false}, "title": "Possible incorrect exponentiation - ^ is XOR in Solidity, use ** for power", "ruleId": "rules.sol-incorrect-exponentiation", "snippet": {"code": "//Note that while it seems to have a 1/2^256 chance you guess the right hash, actually blockhash returns zero for blocks numbers that are more than 256 blocks ago so you can guess zero and wait.", "highlightLines": [10]}, "category": "code", "location": {"file": "dataset/bad_randomness/old_blockhash.sol", "line": 10, "column": 40}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-exponentiation"], "description": ""}, {"id": "83a2a230165b", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "      uint block;", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/bad_randomness/old_blockhash.sol", "line": 14, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8a305e02fa81", "fix": {"template": null, "available": false}, "title": "Variable shadows Solidity builtin (msg, block, tx, now, etc.) - very confusing", "ruleId": "rules.sol-shadowing-builtin", "snippet": {"code": "      uint block;", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/bad_randomness/old_blockhash.sol", "line": 14, "column": 7}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#builtin-symbol-shadowing"], "description": ""}, {"id": "89b6e4b58e1c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "      bytes32 guess;", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/bad_randomness/old_blockhash.sol", "line": 15, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ae41184ea16e", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.value == 1 ether);", "highlightLines": [21]}, "category": "code", "location": {"file": "dataset/bad_randomness/old_blockhash.sol", "line": 21, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "2a25d3869ca6", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(guesses[msg.sender].block == 0);", "highlightLines": [25]}, "category": "code", "location": {"file": "dataset/bad_randomness/old_blockhash.sol", "line": 25, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "7043df90a6de", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.value == 1 ether);", "highlightLines": [26]}, "category": "code", "location": {"file": "dataset/bad_randomness/old_blockhash.sol", "line": 26, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "9e73a604cda5", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        guesses[msg.sender].guess = hash;\n        guesses[msg.sender].block  = block.number + 1;", "highlightLines": [28]}, "category": "code", "location": {"file": "dataset/bad_randomness/old_blockhash.sol", "line": 28, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "7fd6afad2531", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(block.number > guesses[msg.sender].block);", "highlightLines": [33]}, "category": "code", "location": {"file": "dataset/bad_randomness/old_blockhash.sol", "line": 33, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "c2d142ef382d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 answer = blockhash(guesses[msg.sender].block);", "highlightLines": [35]}, "category": "code", "location": {"file": "dataset/bad_randomness/old_blockhash.sol", "line": 35, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "03ca54062d25", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes32 answer = blockhash(guesses[msg.sender].block);\n\n        guesses[msg.sender].block = 0;", "highlightLines": [35]}, "category": "code", "location": {"file": "dataset/bad_randomness/old_blockhash.sol", "line": 35, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "13aa98063330", "fix": {"template": null, "available": false}, "title": "blockhash only works for last 256 blocks - older blocks return 0 (PredictTheBlockHash pattern)", "ruleId": "rules.sol-blockhash-256-limit", "snippet": {"code": "        bytes32 answer = blockhash(guesses[msg.sender].block);", "highlightLines": [35]}, "category": "code", "location": {"file": "dataset/bad_randomness/old_blockhash.sol", "line": 35, "column": 26}, "severity": "medium", "references": ["https://capturetheether.com/challenges/lottery/predict-block-hash/"], "description": ""}, {"id": "dbd5756c2e1c", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        bytes32 answer = blockhash(guesses[msg.sender].block);", "highlightLines": [35]}, "category": "code", "location": {"file": "dataset/bad_randomness/old_blockhash.sol", "line": 35, "column": 26}, "severity": "medium", "references": [], "description": ""}, {"id": "dd8f675f36bf", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "        if (guesses[msg.sender].guess == answer) {\n            msg.sender.transfer(2 ether);\n        }", "highlightLines": [38]}, "category": "code", "location": {"file": "dataset/bad_randomness/old_blockhash.sol", "line": 38, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "47d0d4608a0a", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "            msg.sender.transfer(2 ether);", "highlightLines": [39]}, "category": "code", "location": {"file": "dataset/bad_randomness/old_blockhash.sol", "line": 39, "column": 13}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "098c1864be9f", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.25;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/bad_randomness/random_number_generator.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "4a54ec5b2f25", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.25;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/bad_randomness/random_number_generator.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "69ed68d3844f", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "  uint256 private salt =  block.timestamp;", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/bad_randomness/random_number_generator.sol", "line": 12, "column": 27}, "severity": "medium", "references": [], "description": ""}, {"id": "52fd21038d1b", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "  function random(uint max) view private returns (uint256 result) {\n    // Get the best seed for randomness\n    uint256 x = salt * 100 / max;\n    // <yes> <report> BAD_RANDOMNESS\n    uint256 y = salt * block.number / (salt % 5);\n    // <yes> <report> BAD_RANDOMNESS\n    uint256 seed = block.number / 3 + (salt % 300) + y;\n    // <yes> <report> BAD_RANDOMNESS\n    uint256 h = uint256(blockhash(seed));", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/bad_randomness/random_number_generator.sol", "line": 14, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "5b509112ceba", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 x = salt * 100 / max;", "highlightLines": [16]}, "category": "code", "location": {"file": "dataset/bad_randomness/random_number_generator.sol", "line": 16, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4671905862db", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 x = salt * 100 / max;\n    // <yes> <report> BAD_RANDOMNESS\n    uint256 y = salt * block.number / (salt % 5);", "highlightLines": [16]}, "category": "code", "location": {"file": "dataset/bad_randomness/random_number_generator.sol", "line": 16, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "0b687ba66d46", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 y = salt * block.number / (salt % 5);", "highlightLines": [18]}, "category": "code", "location": {"file": "dataset/bad_randomness/random_number_generator.sol", "line": 18, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3384dffdde77", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 y = salt * block.number / (salt % 5);\n    // <yes> <report> BAD_RANDOMNESS\n    uint256 seed = block.number / 3 + (salt % 300) + y;", "highlightLines": [18]}, "category": "code", "location": {"file": "dataset/bad_randomness/random_number_generator.sol", "line": 18, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "87213d15fcd3", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 seed = block.number / 3 + (salt % 300) + y;", "highlightLines": [20]}, "category": "code", "location": {"file": "dataset/bad_randomness/random_number_generator.sol", "line": 20, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "561f0d5889d2", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 seed = block.number / 3 + (salt % 300) + y;\n    // <yes> <report> BAD_RANDOMNESS\n    uint256 h = uint256(blockhash(seed));", "highlightLines": [20]}, "category": "code", "location": {"file": "dataset/bad_randomness/random_number_generator.sol", "line": 20, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "d6ced5f6e380", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 h = uint256(blockhash(seed));", "highlightLines": [22]}, "category": "code", "location": {"file": "dataset/bad_randomness/random_number_generator.sol", "line": 22, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "755edd69a670", "fix": {"template": null, "available": false}, "title": "blockhash only works for last 256 blocks - older blocks return 0 (PredictTheBlockHash pattern)", "ruleId": "rules.sol-blockhash-256-limit", "snippet": {"code": "    uint256 h = uint256(blockhash(seed));", "highlightLines": [22]}, "category": "code", "location": {"file": "dataset/bad_randomness/random_number_generator.sol", "line": 22, "column": 25}, "severity": "medium", "references": ["https://capturetheether.com/challenges/lottery/predict-block-hash/"], "description": ""}, {"id": "af11d2449357", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "    uint256 h = uint256(blockhash(seed));", "highlightLines": [22]}, "category": "code", "location": {"file": "dataset/bad_randomness/random_number_generator.sol", "line": 22, "column": 25}, "severity": "medium", "references": [], "description": ""}, {"id": "d885b9208e3a", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.13;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "3074f5e3bca0", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.13;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "e624ee67b153", "fix": {"template": null, "available": false}, "title": "SWC-110: assert() used for input validation - use require() instead, assert is for invariants", "ruleId": "rules.sol-swc-110-assert-user-input", "snippet": {"code": "    assert(b <= a);", "highlightLines": [11]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 11, "column": 5}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-110"], "description": ""}, {"id": "c23f3690d5a9", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint c = a + b;", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 15, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c983e86a1d5c", "fix": {"template": null, "available": false}, "title": "SWC-110: assert() used for input validation - use require() instead, assert is for invariants", "ruleId": "rules.sol-swc-110-assert-user-input", "snippet": {"code": "    assert(c >= a);", "highlightLines": [16]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 16, "column": 5}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-110"], "description": ""}, {"id": "7e7823dba038", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function balanceOf(address who) constant returns (uint);", "highlightLines": [25]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 25, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "4066608139f8", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function transfer(address to, uint value);", "highlightLines": [26]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 26, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "5ec6745f1874", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without msg.data.length validation - vulnerable to short address attack padding", "ruleId": "rules.sol-short-address-no-payload-check", "snippet": {"code": "  function transfer(address to, uint value);\n  event Transfer(address indexed from, address indexed to, uint value);\n  function commitDividend(address who) internal; // pays remaining dividend\n}\n\ncontract ERC20 is ERC20Basic {", "highlightLines": [26]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 26, "column": 3}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address", "https://vessenes.com/the-erc20-short-address-attack-explained/"], "description": ""}, {"id": "6c84346d9a43", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event Transfer(address indexed from, address indexed to, uint value);", "highlightLines": [27]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 27, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "8db0326d3517", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function commitDividend(address who) internal; // pays remaining dividend", "highlightLines": [28]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 28, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "e7f9a0a5d5e5", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function allowance(address owner, address spender) constant returns (uint);", "highlightLines": [32]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 32, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "2f203a9acfc1", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "  function allowance(address owner, address spender) constant returns (uint);\n  function transferFrom(address from, address to, uint value);\n  function approve(address spender, uint value);\n  event Approval(address indexed owner, address indexed spender, uint value);\n}\n\ncontract BasicToken is ERC20Basic {\n  using SafeMath for uint;\n  mapping(address => uint) balances;", "highlightLines": [32]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 32, "column": 3}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "7ace33817563", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function transferFrom(address from, address to, uint value);", "highlightLines": [33]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 33, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "ab494e688f87", "fix": {"template": null, "available": false}, "title": "NFT transfer without approval/ownership check - add _isApprovedOrOwner validation", "ruleId": "rules.sol-nft-transfer-no-approval-check", "snippet": {"code": "  function transferFrom(address from, address to, uint value);\n  function approve(address spender, uint value);\n  event Approval(address indexed owner, address indexed spender, uint value);\n}\n\ncontract BasicToken is ERC20Basic {", "highlightLines": [33]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 33, "column": 3}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/NFT-transfer.sol"], "description": ""}, {"id": "4dd53c55de3c", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function approve(address spender, uint value);", "highlightLines": [34]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 34, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "f5df713424a3", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event Approval(address indexed owner, address indexed spender, uint value);", "highlightLines": [35]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 35, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "177cbdb0e9b0", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  modifier onlyPayloadSize(uint size) {\n     assert(msg.data.length >= size + 4);\n     _;\n  }", "highlightLines": [42]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 42, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "4e7e78ec2928", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "  modifier onlyPayloadSize(uint size) {\n     assert(msg.data.length >= size + 4);\n     _;\n  }", "highlightLines": [42]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 42, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "c184bb78d88e", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "     _;", "highlightLines": [44]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 44, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "3b3be52c363a", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without msg.data.length validation - vulnerable to short address attack padding", "ruleId": "rules.sol-short-address-no-payload-check", "snippet": {"code": "  function transfer(address _to, uint _value) onlyPayloadSize(2 * 32) {", "highlightLines": [51]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 51, "column": 3}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address", "https://vessenes.com/the-erc20-short-address-attack-explained/"], "description": ""}, {"id": "7789f80a9634", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "  function transfer(address _to, uint _value) onlyPayloadSize(2 * 32) {\n    commitDividend(msg.sender);\n    balances[msg.sender] = balances[msg.sender].sub(_value);\n    if(_to == address(this)) {", "highlightLines": [51]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 51, "column": 3}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "9384f384480a", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function transfer(address _to, uint _value) onlyPayloadSize(2 * 32) {\n    commitDividend(msg.sender);\n    balances[msg.sender] = balances[msg.sender].sub(_value);\n    if(_to == address(this)) {\n        commitDividend(owner);\n        balances[owner] = balances[owner].add(_value);\n        Transfer(msg.sender, owner, _value);\n    }\n    else {\n        commitDividend(_to);\n        balances[_to] = balances[_to].add(_value);\n        Transfer(msg.sender, _to, _value);\n    }\n  }", "highlightLines": [51]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 51, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "14ca517cf310", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    balances[msg.sender] = balances[msg.sender].sub(_value);\n    if(_to == address(this)) {\n        commitDividend(owner);\n        balances[owner] = balances[owner].add(_value);\n        Transfer(msg.sender, owner, _value);\n    }\n    else {\n        commitDividend(_to);\n        balances[_to] = balances[_to].add(_value);\n        Transfer(msg.sender, _to, _value);\n    }", "highlightLines": [53]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 53, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "99b637ffd7b3", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function balanceOf(address _owner) constant returns (uint balance) {\n    return balances[_owner];\n  }", "highlightLines": [70]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 70, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "f5300eb59262", "fix": {"template": null, "available": false}, "title": "ERC20 transferFrom without payload size validation - consider adding onlyPayloadSize modifier", "ruleId": "rules.sol-erc20-missing-payload-modifier", "snippet": {"code": "  function transferFrom(address _from, address _to, uint _value) onlyPayloadSize(3 * 32) {", "highlightLines": [84]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 84, "column": 3}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address"], "description": ""}, {"id": "b662307e2399", "fix": {"template": null, "available": false}, "title": "NFT transfer without approval/ownership check - add _isApprovedOrOwner validation", "ruleId": "rules.sol-nft-transfer-no-approval-check", "snippet": {"code": "  function transferFrom(address _from, address _to, uint _value) onlyPayloadSize(3 * 32) {", "highlightLines": [84]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 84, "column": 3}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/NFT-transfer.sol"], "description": ""}, {"id": "f58a5ba1156f", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function transferFrom(address _from, address _to, uint _value) onlyPayloadSize(3 * 32) {\n    var _allowance = allowed[_from][msg.sender];\n    commitDividend(_from);\n    commitDividend(_to);\n    balances[_to] = balances[_to].add(_value);\n    balances[_from] = balances[_from].sub(_value);\n    allowed[_from][msg.sender] = _allowance.sub(_value);\n    Transfer(_from, _to, _value);\n  }", "highlightLines": [84]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 84, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "0b6da90c214e", "fix": {"template": null, "available": false}, "title": "Deprecated 'var' keyword can cause type confusion - resolves to smallest type (e.g., uint8 in loops)", "ruleId": "rules.sol-deprecated-var-keyword", "snippet": {"code": "    var _allowance = allowed[_from][msg.sender];", "highlightLines": [85]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 85, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/honeypots"], "description": ""}, {"id": "1a524dbe0cec", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    var _allowance = allowed[_from][msg.sender];\n    commitDividend(_from);\n    commitDividend(_to);\n    balances[_to] = balances[_to].add(_value);", "highlightLines": [85]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 85, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "fb8157d18e21", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    balances[_to] = balances[_to].add(_value);\n    balances[_from] = balances[_from].sub(_value);", "highlightLines": [88]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 88, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "316af01edec5", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    balances[_from] = balances[_from].sub(_value);\n    allowed[_from][msg.sender] = _allowance.sub(_value);", "highlightLines": [89]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 89, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "55c758198966", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function approve(address _spender, uint _value) {\n    //  https://github.com/ethereum/EIPs/issues/20#issuecomment-263524729\n    assert(!((_value != 0) && (allowed[msg.sender][_spender] != 0)));\n    allowed[msg.sender][_spender] = _value;\n    Approval(msg.sender, _spender, _value);\n  }", "highlightLines": [98]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 98, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "1161dc7a863a", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function allowance(address _owner, address _spender) constant returns (uint remaining) {\n    return allowed[_owner][_spender];\n  }", "highlightLines": [110]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 110, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "874e67dfb1c1", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract SmartBillions is StandardToken {\n\n    // metadata\n    string public constant name = \"SmartBillions Token\";\n    string public constant symbol = \"PLAY\";\n    uint public constant decimals = 0;\n\n    // contract state\n    struct Wallet {\n        uint208 balance; // current balance of user\n    \tuint16 lastDividendPeriod; // last processed dividend period of user's tokens\n    \tuint32 nextWithdrawBlock; // next withdrawal possible after this block number", "highlightLines": [118]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 118, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "684573c569f6", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint208 balance; // current balance of user", "highlightLines": [127]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 127, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "764eacfb9b44", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "        uint208 balance; // current balance of user", "highlightLines": [127]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 127, "column": 9}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "4e8a6e5a77e4", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    \tuint16 lastDividendPeriod; // last processed dividend period of user's tokens", "highlightLines": [128]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 128, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8c6a0b4fac66", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    \tuint32 nextWithdrawBlock; // next withdrawal possible after this block number", "highlightLines": [129]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 129, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "6cc6946ec9d5", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint192 value; // bet size", "highlightLines": [133]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 133, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "11b50dbfc134", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint32 betHash; // selected numbers", "highlightLines": [134]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 134, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "5eef09338d0b", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint32 blockNum; // blocknumber when lottery runs", "highlightLines": [135]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 135, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "9bb9de096e9d", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event LogBet(address indexed player, uint bethash, uint blocknumber, uint betsize);", "highlightLines": [163]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 163, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "c1681d0659a7", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event LogLoss(address indexed player, uint bethash, uint hash);", "highlightLines": [164]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 164, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "a5b587dac60a", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event LogWin(address indexed player, uint bethash, uint hash, uint prize);", "highlightLines": [165]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 165, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "6918aef1d1b4", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event LogInvestment(address indexed investor, address indexed partner, uint amount);", "highlightLines": [166]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 166, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "470840a5861e", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event LogRecordWin(address indexed player, uint amount);", "highlightLines": [167]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 167, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "e5e50117e3f3", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event LogLate(address indexed player,uint playerBlockNumber,uint currentBlockNumber);", "highlightLines": [168]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 168, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "1a1d3a04ead7", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event LogDividend(address indexed investor, uint amount, uint period);", "highlightLines": [169]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 169, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "79714c23a062", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyOwner() {\n        assert(msg.sender == owner);\n        _;\n    }", "highlightLines": [171]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 171, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "5d4743c85c47", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [173]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 173, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "6e218df7be1a", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyAnimator() {\n        assert(msg.sender == animator);\n        _;\n    }", "highlightLines": [176]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 176, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "956ada746459", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "    modifier onlyAnimator() {\n        assert(msg.sender == animator);\n        _;\n    }", "highlightLines": [176]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 176, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "0e39fdd219d4", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [178]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 178, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "e5f8a7ad780a", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function SmartBillions() {\n        owner = msg.sender;\n        animator = msg.sender;\n        wallets[owner].lastDividendPeriod = uint16(dividendPeriod);\n        dividends.push(0); // not used\n        dividends.push(0); // current dividend\n    }", "highlightLines": [182]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 182, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "17813c30b1d9", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        owner = msg.sender;", "highlightLines": [183]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 183, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "aa5a82444f05", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        owner = msg.sender;\n        animator = msg.sender;", "highlightLines": [183]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 183, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "61182d555c11", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        animator = msg.sender;\n        wallets[owner].lastDividendPeriod = uint16(dividendPeriod);", "highlightLines": [184]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 184, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "761c59b4f5c4", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        wallets[owner].lastDividendPeriod = uint16(dividendPeriod);", "highlightLines": [185]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 185, "column": 45}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "e6a251603a46", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "        return uint(hashes.length);", "highlightLines": [196]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 196, "column": 16}, "severity": "info", "references": [], "description": ""}, {"id": "dff7184a5c89", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "        return uint(wallets[_owner].balance);", "highlightLines": [204]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 204, "column": 16}, "severity": "info", "references": [], "description": ""}, {"id": "4906be8ba6da", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "        return uint(wallets[_owner].lastDividendPeriod);", "highlightLines": [212]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 212, "column": 16}, "severity": "info", "references": [], "description": ""}, {"id": "b35ba94bcdb4", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "        return uint(wallets[_owner].nextWithdrawBlock);", "highlightLines": [220]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 220, "column": 16}, "severity": "info", "references": [], "description": ""}, {"id": "6e2d5c16a19a", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "        return uint(bets[_owner].value);", "highlightLines": [228]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 228, "column": 16}, "severity": "info", "references": [], "description": ""}, {"id": "f79f790de642", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "        return uint(bets[_owner].betHash);", "highlightLines": [236]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 236, "column": 16}, "severity": "info", "references": [], "description": ""}, {"id": "e86a3232b47b", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "        return uint(bets[_owner].blockNum);", "highlightLines": [244]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 244, "column": 16}, "severity": "info", "references": [], "description": ""}, {"id": "58e7e711aec5", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint period = (block.number - hashFirst) / (10 * hashesSize);", "highlightLines": [254]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 254, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3d0f53f5d194", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function changeOwner(address _who) external onlyOwner {", "highlightLines": [267]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 267, "column": 49}, "severity": "info", "references": [], "description": ""}, {"id": "c29144be19c7", "fix": {"template": null, "available": false}, "title": "SWC-110: assert() used for input validation - use require() instead, assert is for invariants", "ruleId": "rules.sol-swc-110-assert-user-input", "snippet": {"code": "        assert(_who != address(0));", "highlightLines": [268]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 268, "column": 9}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-110"], "description": ""}, {"id": "2f947e8e3fdc", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        owner = _who;", "highlightLines": [271]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 271, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "603397cc7c6a", "fix": {"template": null, "available": false}, "title": "SWC-110: assert() used for input validation - use require() instead, assert is for invariants", "ruleId": "rules.sol-swc-110-assert-user-input", "snippet": {"code": "        assert(_who != address(0));", "highlightLines": [279]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 279, "column": 9}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-110"], "description": ""}, {"id": "8ec08daf034e", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function setInvestStart(uint _when) external onlyOwner {", "highlightLines": [289]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 289, "column": 50}, "severity": "info", "references": [], "description": ""}, {"id": "7401af660537", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(investStart == 1 && hashFirst > 0 && block.number < _when);", "highlightLines": [290]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 290, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "4036fafbd904", "fix": {"template": null, "available": false}, "title": "Variable written twice without being read between - first write is dead store", "ruleId": "rules.sol-write-after-write", "snippet": {"code": "        require(investStart == 1 && hashFirst > 0 && block.number < _when);\n        investStart = _when;", "highlightLines": [290]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 290, "column": 17}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#write-after-write"], "description": ""}, {"id": "338586616d8d", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function setBetMax(uint _maxsum) external onlyOwner {", "highlightLines": [298]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 298, "column": 47}, "severity": "info", "references": [], "description": ""}, {"id": "d84b950f1bab", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function resetBet() external onlyOwner {", "highlightLines": [305]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 305, "column": 34}, "severity": "info", "references": [], "description": ""}, {"id": "ab2803a9390b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        hashNext = block.number + 3;\n        hashBetSum = 0;", "highlightLines": [306]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 306, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e504f8819929", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function coldStore(uint _amount) external onlyOwner {", "highlightLines": [316]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 316, "column": 47}, "severity": "info", "references": [], "description": ""}, {"id": "7709335307a1", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_amount > 0 && this.balance >= (investBalance * 9 / 10) + walletBalance + _amount);", "highlightLines": [318]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 318, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "31021b6c822e", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "            require((_amount <= this.balance / 400) && coldStoreLast + 4 * 60 * 24 * 7 <= block.number);", "highlightLines": [320]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 320, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "e7450012059a", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        msg.sender.transfer(_amount);", "highlightLines": [322]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 322, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "07a4ebfebb0b", "fix": {"template": null, "available": false}, "title": "ETH transfer via .transfer() before state update - potential reentrancy via fallback", "ruleId": "rules.sol-transfer-before-state-update-reentrancy", "snippet": {"code": "        msg.sender.transfer(_amount);\n        coldStoreLast = block.number;", "highlightLines": [322]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 322, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "32161a67520a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\t\t        uint period = (block.number - hashFirst) / (10 * hashesSize );", "highlightLines": [344]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 344, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "794c0d6d6bdf", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint balance = wallets[msg.sender].balance;", "highlightLines": [362]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 362, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "53f2ecb73bb8", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "            uint balance = wallets[msg.sender].balance;", "highlightLines": [362]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 362, "column": 13}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "bcc297d13c33", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            uint balance = wallets[msg.sender].balance;\n            wallets[msg.sender].balance = 0;", "highlightLines": [362]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 362, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "442f237193d2", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint maxpay = this.balance / 2;", "highlightLines": [370]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 370, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "cdce26cd00b6", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint maxpay = this.balance / 2;\n        if(maxpay >= _amount) {\n            msg.sender.transfer(_amount);\n            if(_amount > 1 finney) {\n                houseKeeping();\n            }\n        }\n        else {\n            uint keepbalance = _amount - maxpay;\n            walletBalance += keepbalance;\n            wallets[msg.sender].balance += uint208(keepbalance);\n            wallets[msg.sender].nextWithdrawBlock = uint32(block.number + 4 * 60 * 24 * 30); // wait 1 month for more funds\n            msg.sender.transfer(maxpay);\n        }", "highlightLines": [370]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 370, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "f53f7a2d861b", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "            msg.sender.transfer(_amount);", "highlightLines": [372]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 372, "column": 13}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "c6d24f06d9c4", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint keepbalance = _amount - maxpay;", "highlightLines": [378]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 378, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "58b4fe3825c3", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            uint keepbalance = _amount - maxpay;\n            walletBalance += keepbalance;\n            wallets[msg.sender].balance += uint208(keepbalance);\n            wallets[msg.sender].nextWithdrawBlock = uint32(block.number + 4 * 60 * 24 * 30); // wait 1 month for more funds", "highlightLines": [378]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 378, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "b149b6b5d480", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "            wallets[msg.sender].nextWithdrawBlock = uint32(block.number + 4 * 60 * 24 * 30); // wait 1 month for more funds", "highlightLines": [381]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 381, "column": 53}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "21b06d150642", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "            msg.sender.transfer(maxpay);", "highlightLines": [382]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 382, "column": 13}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "8b3c1bfc642e", "fix": {"template": null, "available": false}, "title": "Unnecessary comparison to boolean constant - use variable directly", "ruleId": "rules.sol-boolean-constant-comparison", "snippet": {"code": "        //require(fromUSA()==false); // fromUSA() not yet implemented :-(", "highlightLines": [400]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 400, "column": 28}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#boolean-equality"], "description": ""}, {"id": "7a9fa243dcb7", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(investStart > 1 && block.number < investStart + (hashesSize * 5) && investBalance < investBalanceMax);", "highlightLines": [401]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 401, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "d2004fe92b2f", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint investing = msg.value;", "highlightLines": [402]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 402, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "14c421c51f34", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint investing = msg.value;\n        if(investing > investBalanceMax - investBalance) {\n            investing = investBalanceMax - investBalance;\n            investBalance = investBalanceMax;\n            investStart = 0; // close investment round\n            msg.sender.transfer(msg.value.sub(investing)); // send back funds immediately\n        }\n        else{\n            investBalance += investing;\n        }", "highlightLines": [402]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 402, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "cc11c32c7d83", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            investing = investBalanceMax - investBalance;\n            investBalance = investBalanceMax;", "highlightLines": [404]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 404, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "045c8baecf39", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            investBalance = investBalanceMax;\n            investStart = 0; // close investment round", "highlightLines": [405]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 405, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "ee54a405d8f1", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "            msg.sender.transfer(msg.value.sub(investing)); // send back funds immediately", "highlightLines": [407]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 407, "column": 13}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "998052be7bcd", "fix": {"template": null, "available": false}, "title": "Division before multiplication causes precision loss", "ruleId": "rules.sol-division-before-multiplication", "snippet": {"code": "            walletBalance += (investing * 5 / 100) * 2;", "highlightLines": [416]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 416, "column": 31}, "severity": "medium", "references": [], "description": ""}, {"id": "b7f183cc095c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        wallets[msg.sender].lastDividendPeriod = uint16(dividendPeriod); // assert(dividendPeriod == 1);\n        uint senderBalance = investing / 10**15;", "highlightLines": [419]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 419, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "9bf9fadf5f2f", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        wallets[msg.sender].lastDividendPeriod = uint16(dividendPeriod); // assert(dividendPeriod == 1);", "highlightLines": [419]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 419, "column": 50}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "29c0429c5507", "fix": {"template": null, "available": false}, "title": "SWC-110: assert() used for input validation - use require() instead, assert is for invariants", "ruleId": "rules.sol-swc-110-assert-user-input", "snippet": {"code": "        wallets[msg.sender].lastDividendPeriod = uint16(dividendPeriod); // assert(dividendPeriod == 1);", "highlightLines": [419]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 419, "column": 77}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-110"], "description": ""}, {"id": "5a2f8afec0be", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint senderBalance = investing / 10**15;", "highlightLines": [420]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 420, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "5b0e961fe608", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint senderBalance = investing / 10**15;\n        uint ownerBalance = investing * 16 / 10**17  ;", "highlightLines": [420]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 420, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "cea79595fcb1", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint ownerBalance = investing * 16 / 10**17  ;", "highlightLines": [421]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 421, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0a04f9416e22", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint ownerBalance = investing * 16 / 10**17  ;\n        uint animatorBalance = investing * 10 / 10**17  ;", "highlightLines": [421]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 421, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "b43596ab7e96", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint animatorBalance = investing * 10 / 10**17  ;", "highlightLines": [422]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 422, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a116d176998a", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "        Transfer(address(0),msg.sender,senderBalance); // for etherscan", "highlightLines": [427]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 427, "column": 33}, "severity": "info", "references": [], "description": ""}, {"id": "8d90fcbd94aa", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "        Transfer(address(0),owner,ownerBalance); // for etherscan", "highlightLines": [428]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 428, "column": 29}, "severity": "info", "references": [], "description": ""}, {"id": "029a87c2dd8f", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "        Transfer(address(0),animator,animatorBalance); // for etherscan", "highlightLines": [429]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 429, "column": 29}, "severity": "info", "references": [], "description": ""}, {"id": "314c06d46e2b", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "     * @dev Delete all tokens owned by sender and return unpaid dividends and 90% of initial investment\n     */\n    function disinvest() external {\n        require(investStart == 0);\n        commitDividend(msg.sender);", "highlightLines": [434]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 434, "column": 51}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "0439fca687aa", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(investStart == 0);", "highlightLines": [437]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 437, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "3621897874dc", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint initialInvestment = balances[msg.sender] * 10**15;", "highlightLines": [439]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 439, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c6fc8860fb19", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(investStart == 0);", "highlightLines": [451]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 451, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "049d3700b86d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint last = wallets[_who].lastDividendPeriod;", "highlightLines": [460]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 460, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "5c59dd44774a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint last = wallets[_who].lastDividendPeriod;\n        if((balances[_who]==0) || (last==0)){\n            wallets[_who].lastDividendPeriod=uint16(dividendPeriod);\n            return;\n        }", "highlightLines": [460]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 460, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "487d7591e274", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "            wallets[_who].lastDividendPeriod=uint16(dividendPeriod);", "highlightLines": [462]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 462, "column": 46}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "8fdcf0825e64", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "            return;", "highlightLines": [463]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 463, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "01c69faa9b82", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "            return;", "highlightLines": [466]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 466, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "c37d3f88c41c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint share = balances[_who] * 0xffffffff / totalSupply;", "highlightLines": [468]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 468, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "34c0981e6ece", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint share = balances[_who] * 0xffffffff / totalSupply;\n        uint balance = 0;", "highlightLines": [468]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 468, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "f198a930df3c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint balance = 0;", "highlightLines": [469]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 469, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e1343b6b0a5d", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "        uint balance = 0;", "highlightLines": [469]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 469, "column": 9}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "5dcbb83f2e4c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint balance = 0;\n        for(;last<dividendPeriod;last++) {\n            balance += share * dividends[last];\n        }\n        balance = (balance / 0xffffffff);", "highlightLines": [469]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 469, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "2cceb94fd57c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        balance = (balance / 0xffffffff);\n        walletBalance += balance;\n        wallets[_who].balance += uint208(balance);\n        wallets[_who].lastDividendPeriod = uint16(last);", "highlightLines": [473]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 473, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d922e5f8971b", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        wallets[_who].lastDividendPeriod = uint16(last);", "highlightLines": [476]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 476, "column": 44}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "63f8f83bde4a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint24 bethash = uint24(_player.betHash);", "highlightLines": [483]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 483, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e7a48b93af5a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint24 bethash = uint24(_player.betHash);\n        uint24 hit = bethash ^ _hash;", "highlightLines": [483]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 483, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "f590a1d18546", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint24 hit = bethash ^ _hash;", "highlightLines": [484]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 484, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "003d13c7cfa6", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint24 hit = bethash ^ _hash;\n        uint24 matches =\n            ((hit & 0xF) == 0 ? 1 : 0 ) +\n            ((hit & 0xF0) == 0 ? 1 : 0 ) +\n            ((hit & 0xF00) == 0 ? 1 : 0 ) +\n            ((hit & 0xF000) == 0 ? 1 : 0 ) +\n            ((hit & 0xF0000) == 0 ? 1 : 0 ) +\n            ((hit & 0xF00000) == 0 ? 1 : 0 );", "highlightLines": [484]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 484, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "7fd4d4d20800", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint24 matches =", "highlightLines": [485]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 485, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ca967d147156", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "            ((hit & 0xF) == 0 ? 1 : 0 ) +", "highlightLines": [486]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 486, "column": 15}, "severity": "medium", "references": [], "description": ""}, {"id": "a869b4c75cb6", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "            ((hit & 0xF0) == 0 ? 1 : 0 ) +", "highlightLines": [487]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 487, "column": 15}, "severity": "medium", "references": [], "description": ""}, {"id": "865d552f471d", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "            ((hit & 0xF00) == 0 ? 1 : 0 ) +", "highlightLines": [488]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 488, "column": 15}, "severity": "medium", "references": [], "description": ""}, {"id": "6f7595809979", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "            ((hit & 0xF000) == 0 ? 1 : 0 ) +", "highlightLines": [489]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 489, "column": 15}, "severity": "medium", "references": [], "description": ""}, {"id": "5e9f841f3cd2", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "            ((hit & 0xF0000) == 0 ? 1 : 0 ) +", "highlightLines": [490]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 490, "column": 15}, "severity": "medium", "references": [], "description": ""}, {"id": "6d52d89fb3d4", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "            ((hit & 0xF00000) == 0 ? 1 : 0 );", "highlightLines": [491]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 491, "column": 15}, "severity": "medium", "references": [], "description": ""}, {"id": "efe7e350da3d", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "            return(uint(_player.value) * 7000000);", "highlightLines": [493]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 493, "column": 20}, "severity": "info", "references": [], "description": ""}, {"id": "185d8379dbf2", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "            return(uint(_player.value) * 20000);", "highlightLines": [496]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 496, "column": 20}, "severity": "info", "references": [], "description": ""}, {"id": "b0910436a623", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "            return(uint(_player.value) * 500);", "highlightLines": [499]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 499, "column": 20}, "severity": "info", "references": [], "description": ""}, {"id": "d40a925771fe", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "            return(uint(_player.value) * 25);", "highlightLines": [502]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 502, "column": 20}, "severity": "info", "references": [], "description": ""}, {"id": "ca44c3aa4f2a", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "            return(uint(_player.value) * 3);", "highlightLines": [505]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 505, "column": 20}, "severity": "info", "references": [], "description": ""}, {"id": "5a398de4905b", "fix": {"template": null, "available": false}, "title": "Struct copied to memory from mapping - modifications won't persist to storage", "ruleId": "rules.sol-memory-struct-from-mapping", "snippet": {"code": "        Bet memory player = bets[_who];", "highlightLines": [514]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 514, "column": 9}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/DataLocation.sol"], "description": ""}, {"id": "7500a3cd587c", "fix": {"template": null, "available": false}, "title": "Struct copied to memory then modified - changes lost, use storage reference", "ruleId": "rules.sol-data-location-memory-update", "snippet": {"code": "        Bet memory player = bets[_who];\n        if( (player.value==0) ||", "highlightLines": [514]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 514, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/DataLocation.sol"], "description": ""}, {"id": "1e8136ad3bfb", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        Bet memory player = bets[_who];\n        if( (player.value==0) ||\n            (player.blockNum<=1) ||\n            (block.number<player.blockNum) ||\n            (block.number>=player.blockNum + (10 * hashesSize))){\n            return(0);\n        }\n        if(block.number<player.blockNum+256){\n            // <yes> <report> BAD_RANDOMNESS\n            return(betPrize(player,uint24(block.blockhash(player.blockNum))));\n        }\n        if(hashFirst>0){\n            uint32 hash = getHash(player.blockNum);\n            if(hash == 0x1000000) { // load hash failed :-(, return funds\n                return(uint(player.value));\n            }\n            else{\n                return(betPrize(player,uint24(hash)));\n            }\n\t}", "highlightLines": [514]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 514, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "c51862af4b88", "fix": {"template": null, "available": false}, "title": "blockhash only works for last 256 blocks - older blocks return 0 (PredictTheBlockHash pattern)", "ruleId": "rules.sol-blockhash-256-limit", "snippet": {"code": "            return(betPrize(player,uint24(block.blockhash(player.blockNum))));", "highlightLines": [523]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 523, "column": 43}, "severity": "medium", "references": ["https://capturetheether.com/challenges/lottery/predict-block-hash/"], "description": ""}, {"id": "1991f40662cd", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint32 hash = getHash(player.blockNum);", "highlightLines": [526]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 526, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "fd86f10e0afa", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "                return(uint(player.value));", "highlightLines": [528]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 528, "column": 24}, "severity": "info", "references": [], "description": ""}, {"id": "e6af39028408", "fix": {"template": null, "available": false}, "title": "Struct copied to memory from mapping - modifications won't persist to storage", "ruleId": "rules.sol-memory-struct-from-mapping", "snippet": {"code": "        Bet memory player = bets[msg.sender];", "highlightLines": [541]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 541, "column": 9}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/DataLocation.sol"], "description": ""}, {"id": "dcf800fedb5f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        Bet memory player = bets[msg.sender];\n        if(player.blockNum==0){ // create a new player\n            bets[msg.sender] = Bet({value: 0, betHash: 0, blockNum: 1});\n            return;\n        }", "highlightLines": [541]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 541, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "a194b6967fa8", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "            return;", "highlightLines": [544]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 544, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "2e9ace29399e", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "            return;", "highlightLines": [548]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 548, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "ca5953bd4be1", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(block.number>player.blockNum); // if there is an active bet, throw()", "highlightLines": [550]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 550, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "84b3f3e261b2", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "            return;", "highlightLines": [554]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 554, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "4cc7f74b8f0e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint prize = 0;", "highlightLines": [556]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 556, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "2f27ca5660a6", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint prize = 0;\n        uint32 hash = 0;", "highlightLines": [556]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 556, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "bd3f64946e09", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint32 hash = 0;", "highlightLines": [557]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 557, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7766e52ddbb4", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint32 hash = 0;\n        if(block.number<player.blockNum+256){\n            // <yes> <report> BAD_RANDOMNESS\n            hash = uint24(block.blockhash(player.blockNum));\n            prize = betPrize(player,uint24(hash));\n        }\n        else {\n            if(hashFirst>0){ // lottery is open even before swap space (hashes) is ready, but player must collect results within 256 blocks after run\n                hash = getHash(player.blockNum);\n                if(hash == 0x1000000) { // load hash failed :-(, return funds\n                    prize = uint(player.value);\n                }\n                else{\n                    prize = betPrize(player,uint24(hash));\n                }\n\t    }\n            else{\n                LogLate(msg.sender,player.blockNum,block.number);\n                bets[msg.sender] = Bet({value: 0, betHash: 0, blockNum: 1});\n                return();\n            }\n        }", "highlightLines": [557]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 557, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "c8b5b0614af4", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            hash = uint24(block.blockhash(player.blockNum));\n            prize = betPrize(player,uint24(hash));", "highlightLines": [560]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 560, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "e43e97697746", "fix": {"template": null, "available": false}, "title": "blockhash only works for last 256 blocks - older blocks return 0 (PredictTheBlockHash pattern)", "ruleId": "rules.sol-blockhash-256-limit", "snippet": {"code": "            hash = uint24(block.blockhash(player.blockNum));", "highlightLines": [560]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 560, "column": 27}, "severity": "medium", "references": ["https://capturetheether.com/challenges/lottery/predict-block-hash/"], "description": ""}, {"id": "a9237c8af505", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "                hash = getHash(player.blockNum);\n                if(hash == 0x1000000) { // load hash failed :-(, return funds\n                    prize = uint(player.value);\n                }\n                else{\n                    prize = betPrize(player,uint24(hash));\n                }", "highlightLines": [565]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 565, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "c3f50df5542b", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "                    prize = uint(player.value);", "highlightLines": [567]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 567, "column": 29}, "severity": "info", "references": [], "description": ""}, {"id": "6a2bc36cf758", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bets[msg.sender] = Bet({value: 0, betHash: 0, blockNum: 1});\n        if(prize>0) {\n            LogWin(msg.sender,uint(player.betHash),uint(hash),prize);\n            if(prize > maxWin){\n                maxWin = prize;\n                LogRecordWin(msg.sender,prize);\n            }\n            pay(prize);\n        }\n        else{\n            LogLoss(msg.sender,uint(player.betHash),uint(hash));\n        }", "highlightLines": [579]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 579, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "ed206b53e649", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "            LogWin(msg.sender,uint(player.betHash),uint(hash),prize);", "highlightLines": [581]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 581, "column": 31}, "severity": "info", "references": [], "description": ""}, {"id": "e33e23044a5f", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "            LogLoss(msg.sender,uint(player.betHash),uint(hash));", "highlightLines": [589]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 589, "column": 32}, "severity": "info", "references": [], "description": ""}, {"id": "fd1197d5d657", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "            return;", "highlightLines": [606]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 606, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "26b808a54be5", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "        return playSystem(uint(sha3(msg.sender,block.number)), address(0));", "highlightLines": [618]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 618, "column": 27}, "severity": "info", "references": [], "description": ""}, {"id": "af4de349a89a", "fix": {"template": null, "available": false}, "title": "sha3() is deprecated - use keccak256() instead", "ruleId": "rules.sol-deprecated-sha3", "snippet": {"code": "        return playSystem(uint(sha3(msg.sender,block.number)), address(0));", "highlightLines": [618]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 618, "column": 32}, "severity": "info", "references": [], "description": ""}, {"id": "77802f8cf99c", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "        return playSystem(uint(sha3(msg.sender,block.number)), _partner);", "highlightLines": [626]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 626, "column": 27}, "severity": "info", "references": [], "description": ""}, {"id": "c24fe19f5d17", "fix": {"template": null, "available": false}, "title": "sha3() is deprecated - use keccak256() instead", "ruleId": "rules.sol-deprecated-sha3", "snippet": {"code": "        return playSystem(uint(sha3(msg.sender,block.number)), _partner);", "highlightLines": [626]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 626, "column": 32}, "severity": "info", "references": [], "description": ""}, {"id": "ae00db659f16", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint24 bethash = uint24(_hash);", "highlightLines": [635]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 635, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "80d3a1020a98", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint24 bethash = uint24(_hash);\n        require(msg.value <= 1 ether && msg.value < hashBetMax);\n        if(msg.value > 0){\n            if(investStart==0) { // dividends only after investment finished\n                dividends[dividendPeriod] += msg.value / 20; // 5% dividend\n            }\n            if(_partner != address(0)) {\n                uint fee = msg.value / 100;\n                walletBalance += fee;\n                wallets[_partner].balance += uint208(fee); // 1% for affiliates\n            }\n            if(hashNext < block.number + 3) {\n                hashNext = block.number + 3;\n                hashBetSum = msg.value;\n            }\n            else{\n                if(hashBetSum > hashBetMax) {\n                    hashNext++;\n                    hashBetSum = msg.value;\n                }\n                else{\n                    hashBetSum += msg.value;\n                }\n            }\n            bets[msg.sender] = Bet({value: uint192(msg.value), betHash: uint32(bethash), blockNum: uint32(hashNext)});\n            LogBet(msg.sender,uint(bethash),hashNext,msg.value);\n        }", "highlightLines": [635]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 635, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "4126e20e4a98", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.value <= 1 ether && msg.value < hashBetMax);", "highlightLines": [636]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 636, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "cc2d15681078", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "                uint fee = msg.value / 100;", "highlightLines": [642]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 642, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f992b802ce2a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "                hashNext = block.number + 3;\n                hashBetSum = msg.value;", "highlightLines": [647]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 647, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "096e2568c412", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "            bets[msg.sender] = Bet({value: uint192(msg.value), betHash: uint32(bethash), blockNum: uint32(hashNext)});", "highlightLines": [659]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 659, "column": 73}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "defc01e20881", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "            LogBet(msg.sender,uint(bethash),hashNext,msg.value);", "highlightLines": [660]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 660, "column": 31}, "severity": "info", "references": [], "description": ""}, {"id": "dc2583a93fa2", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(hashFirst == 0 && _sadd > 0 && _sadd <= hashesSize);", "highlightLines": [673]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 673, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "173a510ca044", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint n = hashes.length;", "highlightLines": [674]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 674, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3a624bccf50a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint n = hashes.length;\n        if(n + _sadd > hashesSize){\n            hashes.length = hashesSize;\n        }\n        else{\n            hashes.length += _sadd;\n        }", "highlightLines": [674]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 674, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "ffaed8712fa2", "fix": {"template": null, "available": false}, "title": "Storage variable modified in loop - should cache in memory for gas savings", "ruleId": "rules.sol-memory-vs-storage-loop", "snippet": {"code": "        for(;n<hashes.length;n++){ // make sure to burn gas\n            hashes[n] = 1;", "highlightLines": [681]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 681, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "e9e67dd25afe", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            hashFirst = block.number - ( block.number % 10);\n            hashLast = hashFirst;", "highlightLines": [685]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 685, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "7d0dcbc24de8", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "        return( ( uint(block.blockhash(_lastb  )) & 0xFFFFFF )", "highlightLines": [700]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 700, "column": 19}, "severity": "info", "references": [], "description": ""}, {"id": "807c236cec9d", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "        return( ( uint(block.blockhash(_lastb  )) & 0xFFFFFF )", "highlightLines": [700]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 700, "column": 19}, "severity": "medium", "references": [], "description": ""}, {"id": "0347ed4ac5d9", "fix": {"template": null, "available": false}, "title": "blockhash only works for last 256 blocks - older blocks return 0 (PredictTheBlockHash pattern)", "ruleId": "rules.sol-blockhash-256-limit", "snippet": {"code": "        return( ( uint(block.blockhash(_lastb  )) & 0xFFFFFF )", "highlightLines": [700]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 700, "column": 24}, "severity": "medium", "references": ["https://capturetheether.com/challenges/lottery/predict-block-hash/"], "description": ""}, {"id": "48595760eba5", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "            | ( ( uint(block.blockhash(_lastb+1)) & 0xFFFFFF ) << 24 )", "highlightLines": [702]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 702, "column": 19}, "severity": "info", "references": [], "description": ""}, {"id": "9684f12ca54f", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "            | ( ( uint(block.blockhash(_lastb+1)) & 0xFFFFFF ) << 24 )", "highlightLines": [702]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 702, "column": 19}, "severity": "medium", "references": [], "description": ""}, {"id": "c94117d60191", "fix": {"template": null, "available": false}, "title": "blockhash only works for last 256 blocks - older blocks return 0 (PredictTheBlockHash pattern)", "ruleId": "rules.sol-blockhash-256-limit", "snippet": {"code": "            | ( ( uint(block.blockhash(_lastb+1)) & 0xFFFFFF ) << 24 )", "highlightLines": [702]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 702, "column": 24}, "severity": "medium", "references": ["https://capturetheether.com/challenges/lottery/predict-block-hash/"], "description": ""}, {"id": "76c683726111", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "            | ( ( uint(block.blockhash(_lastb+2)) & 0xFFFFFF ) << 48 )", "highlightLines": [704]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 704, "column": 19}, "severity": "info", "references": [], "description": ""}, {"id": "27688aba5f12", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "            | ( ( uint(block.blockhash(_lastb+2)) & 0xFFFFFF ) << 48 )", "highlightLines": [704]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 704, "column": 19}, "severity": "medium", "references": [], "description": ""}, {"id": "a51a034dfbe2", "fix": {"template": null, "available": false}, "title": "blockhash only works for last 256 blocks - older blocks return 0 (PredictTheBlockHash pattern)", "ruleId": "rules.sol-blockhash-256-limit", "snippet": {"code": "            | ( ( uint(block.blockhash(_lastb+2)) & 0xFFFFFF ) << 48 )", "highlightLines": [704]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 704, "column": 24}, "severity": "medium", "references": ["https://capturetheether.com/challenges/lottery/predict-block-hash/"], "description": ""}, {"id": "3c3818d7ea70", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "            | ( ( uint(block.blockhash(_lastb+3)) & 0xFFFFFF ) << 72 )", "highlightLines": [706]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 706, "column": 19}, "severity": "info", "references": [], "description": ""}, {"id": "c4673aa7da9a", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "            | ( ( uint(block.blockhash(_lastb+3)) & 0xFFFFFF ) << 72 )", "highlightLines": [706]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 706, "column": 19}, "severity": "medium", "references": [], "description": ""}, {"id": "5fcc7c367806", "fix": {"template": null, "available": false}, "title": "blockhash only works for last 256 blocks - older blocks return 0 (PredictTheBlockHash pattern)", "ruleId": "rules.sol-blockhash-256-limit", "snippet": {"code": "            | ( ( uint(block.blockhash(_lastb+3)) & 0xFFFFFF ) << 72 )", "highlightLines": [706]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 706, "column": 24}, "severity": "medium", "references": ["https://capturetheether.com/challenges/lottery/predict-block-hash/"], "description": ""}, {"id": "79c33386141e", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "            | ( ( uint(block.blockhash(_lastb+4)) & 0xFFFFFF ) << 96 )", "highlightLines": [708]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 708, "column": 19}, "severity": "info", "references": [], "description": ""}, {"id": "519fb3e6d984", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "            | ( ( uint(block.blockhash(_lastb+4)) & 0xFFFFFF ) << 96 )", "highlightLines": [708]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 708, "column": 19}, "severity": "medium", "references": [], "description": ""}, {"id": "e528b20604c0", "fix": {"template": null, "available": false}, "title": "blockhash only works for last 256 blocks - older blocks return 0 (PredictTheBlockHash pattern)", "ruleId": "rules.sol-blockhash-256-limit", "snippet": {"code": "            | ( ( uint(block.blockhash(_lastb+4)) & 0xFFFFFF ) << 96 )", "highlightLines": [708]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 708, "column": 24}, "severity": "medium", "references": ["https://capturetheether.com/challenges/lottery/predict-block-hash/"], "description": ""}, {"id": "5137454a90e9", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "            | ( ( uint(block.blockhash(_lastb+5)) & 0xFFFFFF ) << 120 )", "highlightLines": [710]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 710, "column": 19}, "severity": "info", "references": [], "description": ""}, {"id": "534daf9d0577", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "            | ( ( uint(block.blockhash(_lastb+5)) & 0xFFFFFF ) << 120 )", "highlightLines": [710]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 710, "column": 19}, "severity": "medium", "references": [], "description": ""}, {"id": "af30803ab7b8", "fix": {"template": null, "available": false}, "title": "blockhash only works for last 256 blocks - older blocks return 0 (PredictTheBlockHash pattern)", "ruleId": "rules.sol-blockhash-256-limit", "snippet": {"code": "            | ( ( uint(block.blockhash(_lastb+5)) & 0xFFFFFF ) << 120 )", "highlightLines": [710]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 710, "column": 24}, "severity": "medium", "references": ["https://capturetheether.com/challenges/lottery/predict-block-hash/"], "description": ""}, {"id": "0ff6e2782bd1", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "            | ( ( uint(block.blockhash(_lastb+6)) & 0xFFFFFF ) << 144 )", "highlightLines": [712]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 712, "column": 19}, "severity": "info", "references": [], "description": ""}, {"id": "c35a84466eaf", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "            | ( ( uint(block.blockhash(_lastb+6)) & 0xFFFFFF ) << 144 )", "highlightLines": [712]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 712, "column": 19}, "severity": "medium", "references": [], "description": ""}, {"id": "26a78ce812fa", "fix": {"template": null, "available": false}, "title": "blockhash only works for last 256 blocks - older blocks return 0 (PredictTheBlockHash pattern)", "ruleId": "rules.sol-blockhash-256-limit", "snippet": {"code": "            | ( ( uint(block.blockhash(_lastb+6)) & 0xFFFFFF ) << 144 )", "highlightLines": [712]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 712, "column": 24}, "severity": "medium", "references": ["https://capturetheether.com/challenges/lottery/predict-block-hash/"], "description": ""}, {"id": "4d37f088323a", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "            | ( ( uint(block.blockhash(_lastb+7)) & 0xFFFFFF ) << 168 )", "highlightLines": [714]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 714, "column": 19}, "severity": "info", "references": [], "description": ""}, {"id": "29bdd7b3fee8", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "            | ( ( uint(block.blockhash(_lastb+7)) & 0xFFFFFF ) << 168 )", "highlightLines": [714]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 714, "column": 19}, "severity": "medium", "references": [], "description": ""}, {"id": "9077acdee77e", "fix": {"template": null, "available": false}, "title": "blockhash only works for last 256 blocks - older blocks return 0 (PredictTheBlockHash pattern)", "ruleId": "rules.sol-blockhash-256-limit", "snippet": {"code": "            | ( ( uint(block.blockhash(_lastb+7)) & 0xFFFFFF ) << 168 )", "highlightLines": [714]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 714, "column": 24}, "severity": "medium", "references": ["https://capturetheether.com/challenges/lottery/predict-block-hash/"], "description": ""}, {"id": "83312027066e", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "            | ( ( uint(block.blockhash(_lastb+8)) & 0xFFFFFF ) << 192 )", "highlightLines": [716]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 716, "column": 19}, "severity": "info", "references": [], "description": ""}, {"id": "a8d0c96180cc", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "            | ( ( uint(block.blockhash(_lastb+8)) & 0xFFFFFF ) << 192 )", "highlightLines": [716]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 716, "column": 19}, "severity": "medium", "references": [], "description": ""}, {"id": "8eda457b3797", "fix": {"template": null, "available": false}, "title": "blockhash only works for last 256 blocks - older blocks return 0 (PredictTheBlockHash pattern)", "ruleId": "rules.sol-blockhash-256-limit", "snippet": {"code": "            | ( ( uint(block.blockhash(_lastb+8)) & 0xFFFFFF ) << 192 )", "highlightLines": [716]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 716, "column": 24}, "severity": "medium", "references": ["https://capturetheether.com/challenges/lottery/predict-block-hash/"], "description": ""}, {"id": "de50a9e0596f", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "            | ( ( uint(block.blockhash(_lastb+9)) & 0xFFFFFF ) << 216 )", "highlightLines": [718]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 718, "column": 19}, "severity": "info", "references": [], "description": ""}, {"id": "0b050747f9bb", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "            | ( ( uint(block.blockhash(_lastb+9)) & 0xFFFFFF ) << 216 )", "highlightLines": [718]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 718, "column": 19}, "severity": "medium", "references": [], "description": ""}, {"id": "7100b19fbe54", "fix": {"template": null, "available": false}, "title": "blockhash only works for last 256 blocks - older blocks return 0 (PredictTheBlockHash pattern)", "ruleId": "rules.sol-blockhash-256-limit", "snippet": {"code": "            | ( ( uint(block.blockhash(_lastb+9)) & 0xFFFFFF ) << 216 )", "highlightLines": [718]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 718, "column": 24}, "severity": "medium", "references": ["https://capturetheether.com/challenges/lottery/predict-block-hash/"], "description": ""}, {"id": "b1db9d5c59b8", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "            | ( ( uint(_delta) / hashesSize) << 240));", "highlightLines": [719]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 719, "column": 19}, "severity": "info", "references": [], "description": ""}, {"id": "14dd8b0c2bc0", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "            | ( ( uint(_delta) / hashesSize) << 240));", "highlightLines": [719]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 719, "column": 19}, "severity": "medium", "references": [], "description": ""}, {"id": "54820df7210f", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint delta = (_block - hashFirst) / 10;", "highlightLines": [723]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 723, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d61189073028", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint delta = (_block - hashFirst) / 10;\n        uint hash = hashes[delta % hashesSize];", "highlightLines": [723]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 723, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "9b0368e7f62d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint hash = hashes[delta % hashesSize];", "highlightLines": [724]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 724, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "2b85aeaefab4", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint hash = hashes[delta % hashesSize];\n        if(delta / hashesSize != hash >> 240) {\n            return(0x1000000); // load failed, incorrect data in hashes\n        }\n        uint slotp = (_block - hashFirst) % 10;", "highlightLines": [724]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 724, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "82b078d83b97", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "        if(delta / hashesSize != hash >> 240) {", "highlightLines": [725]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 725, "column": 34}, "severity": "medium", "references": [], "description": ""}, {"id": "d468c6f32fb7", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint slotp = (_block - hashFirst) % 10;", "highlightLines": [728]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 728, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "50ab2ca5511a", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "        return(uint32((hash >> (24 * slotp)) & 0xFFFFFF));", "highlightLines": [729]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 729, "column": 24}, "severity": "medium", "references": [], "description": ""}, {"id": "f9832b0247cf", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint lastb = hashLast;", "highlightLines": [736]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 736, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "fa0109398cd0", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint lastb = hashLast;\n        if(lastb == 0 || block.number <= lastb + 10) {\n            return(false);\n        }\n        uint blockn256;\n        if(block.number<256) { // useless test for testnet :-(\n            blockn256 = 0;\n        }\n        else{\n            blockn256 = block.number - 256;\n        }", "highlightLines": [736]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 736, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "37d731426759", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint blockn256;", "highlightLines": [740]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 740, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "fee1302d7218", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint num = blockn256;", "highlightLines": [748]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 748, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "fd49abab986b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            uint num = blockn256;\n            num += num % 10;\n            lastb = num;", "highlightLines": [748]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 748, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "e65d992e274e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint delta = (lastb - hashFirst) / 10;", "highlightLines": [752]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 752, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4e9fd2abbdd7", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint delta = (lastb - hashFirst) / 10;\n        hashes[delta % hashesSize] = calcHashes(uint32(lastb),uint32(delta));", "highlightLines": [752]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 752, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "eda7653b4b58", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        hashes[delta % hashesSize] = calcHashes(uint32(lastb),uint32(delta));\n        hashLast = lastb + 10;", "highlightLines": [753]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 753, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "755f4886dd18", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        hashes[delta % hashesSize] = calcHashes(uint32(lastb),uint32(delta));", "highlightLines": [753]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 753, "column": 49}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "eeca6f0cfacc", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint n=0;", "highlightLines": [763]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 763, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "68d84e777044", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "                return;", "highlightLines": [766]}, "category": "code", "location": {"file": "dataset/bad_randomness/smart_billions.sol", "line": 766, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "581c0d2ca11b", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.15;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/denial_of_service/auction.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "816126414933", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.15;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/denial_of_service/auction.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "fed892573cb1", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "  address currentFrontrunner;", "highlightLines": [11]}, "category": "code", "location": {"file": "dataset/denial_of_service/auction.sol", "line": 11, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "5d554a589db7", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "  uint currentBid;", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/denial_of_service/auction.sol", "line": 12, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0563b8a04f6a", "fix": {"template": null, "available": false}, "title": "SWC-114: Transaction order dependence - vulnerable to front-running/sandwich attacks", "ruleId": "rules.sol-swc-114-front-running", "snippet": {"code": "  function bid() payable {\n    require(msg.value > currentBid);", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/denial_of_service/auction.sol", "line": 15, "column": 3}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-114"], "description": ""}, {"id": "145c60d39ad6", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function bid() payable {\n    require(msg.value > currentBid);\n\n    //If the refund fails, the entire transaction reverts.\n    //Therefore a frontrunner who always fails will win\n    if (currentFrontrunner != 0) {\n      //E.g. if recipients fallback function is just revert()\n      // <yes> <report> DENIAL_OF_SERVICE\n      require(currentFrontrunner.send(currentBid));\n    }\n\n    currentFrontrunner = msg.sender;\n    currentBid         = msg.value;\n  }", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/denial_of_service/auction.sol", "line": 15, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "3a0c5f2ceba9", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(msg.value > currentBid);", "highlightLines": [16]}, "category": "code", "location": {"file": "dataset/denial_of_service/auction.sol", "line": 16, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "4756fb4ebfba", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "      require(currentFrontrunner.send(currentBid));", "highlightLines": [23]}, "category": "code", "location": {"file": "dataset/denial_of_service/auction.sol", "line": 23, "column": 7}, "severity": "info", "references": [], "description": ""}, {"id": "1645eaf3ba79", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    currentFrontrunner = msg.sender;\n    currentBid         = msg.value;", "highlightLines": [26]}, "category": "code", "location": {"file": "dataset/denial_of_service/auction.sol", "line": 26, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "82ca9fbc3fd5", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.25;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/denial_of_service/dos_address.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "c86b43a0396d", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.25;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/denial_of_service/dos_address.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "fc6799f7949b", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    bool win = false;", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/denial_of_service/dos_address.sol", "line": 12, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "45a54e809d99", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            creditorAddresses = new address[](0);\n            win = true;", "highlightLines": [17]}, "category": "code", "location": {"file": "dataset/denial_of_service/dos_address.sol", "line": 17, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "33ad0615a25c", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "            creditorAddresses = new address[](0);", "highlightLines": [17]}, "category": "code", "location": {"file": "dataset/denial_of_service/dos_address.sol", "line": 17, "column": 33}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "b4d65cc5e339", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.25;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/denial_of_service/dos_number.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "8d747fd8edc9", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.25;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/denial_of_service/dos_number.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "35094b2068b5", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint numElements = 0;", "highlightLines": [10]}, "category": "code", "location": {"file": "dataset/denial_of_service/dos_number.sol", "line": 10, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3811f629d0f3", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(numElements>1500);", "highlightLines": [27]}, "category": "code", "location": {"file": "dataset/denial_of_service/dos_number.sol", "line": 27, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "f0bac29d5ae2", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(numElements>1500);", "highlightLines": [35]}, "category": "code", "location": {"file": "dataset/denial_of_service/dos_number.sol", "line": 35, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "3ca76d064cd6", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        array = new uint[](0);\n        numElements = 0;", "highlightLines": [36]}, "category": "code", "location": {"file": "dataset/denial_of_service/dos_number.sol", "line": 36, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "44457f26d766", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        array = new uint[](0);", "highlightLines": [36]}, "category": "code", "location": {"file": "dataset/denial_of_service/dos_number.sol", "line": 36, "column": 17}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "b37958bf2949", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.25;", "highlightLines": [8]}, "category": "code", "location": {"file": "dataset/denial_of_service/dos_simple.sol", "line": 8, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "82d7f9b16f7f", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.25;", "highlightLines": [8]}, "category": "code", "location": {"file": "dataset/denial_of_service/dos_simple.sol", "line": 8, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "8fd1df0177a1", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "            listAddresses = new address[](0);", "highlightLines": [23]}, "category": "code", "location": {"file": "dataset/denial_of_service/dos_simple.sol", "line": 23, "column": 29}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "f17f50c50703", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.0;", "highlightLines": [8]}, "category": "code", "location": {"file": "dataset/denial_of_service/list_dos.sol", "line": 8, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "94197899f1c0", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.0;", "highlightLines": [8]}, "category": "code", "location": {"file": "dataset/denial_of_service/list_dos.sol", "line": 8, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "1c1c28b5d000", "fix": {"template": null, "available": false}, "title": "SWC-118: Function name matches contract name - likely intended as constructor (pre-0.4.22)", "ruleId": "rules.sol-swc-118-constructor-mismatch", "snippet": {"code": "contract Government {\n\n     // Global Variables\n     uint32 public lastCreditorPayedOut;\n     uint public lastTimeOfNewCredit;\n     uint public profitFromCrash;\n     address[] public creditorAddresses;\n     uint[] public creditorAmounts;\n     address public corruptElite;\n     mapping (address => uint) buddies;\n     uint constant TWELVE_HOURS = 43200;\n     uint8 public round;\n\n     function Government() {", "highlightLines": [10]}, "category": "code", "location": {"file": "dataset/denial_of_service/list_dos.sol", "line": 10, "column": 1}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-118"], "description": ""}, {"id": "50346fcc88f5", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "     function Government() {\n         // The corrupt elite establishes a new government\n         // this is the commitment of the corrupt Elite - everything that can not be saved from a crash\n         profitFromCrash = msg.value;\n         corruptElite = msg.sender;\n         lastTimeOfNewCredit = block.timestamp;\n     }", "highlightLines": [23]}, "category": "code", "location": {"file": "dataset/denial_of_service/list_dos.sol", "line": 23, "column": 6}, "severity": "medium", "references": [], "description": ""}, {"id": "a374a60bed99", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         profitFromCrash = msg.value;\n         corruptElite = msg.sender;", "highlightLines": [26]}, "category": "code", "location": {"file": "dataset/denial_of_service/list_dos.sol", "line": 26, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "adebcb1fbe1c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         corruptElite = msg.sender;\n         lastTimeOfNewCredit = block.timestamp;", "highlightLines": [27]}, "category": "code", "location": {"file": "dataset/denial_of_service/list_dos.sol", "line": 27, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "23215774803d", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "         lastTimeOfNewCredit = block.timestamp;", "highlightLines": [28]}, "category": "code", "location": {"file": "dataset/denial_of_service/list_dos.sol", "line": 28, "column": 32}, "severity": "medium", "references": [], "description": ""}, {"id": "926e7ffdd209", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "     function lendGovernmentMoney(address buddy) returns (bool) {\n         uint amount = msg.value;\n         // check if the system already broke down. If for 12h no new creditor gives new credit to the system it will brake down.\n         // 12h are on average = 60*60*12/12.5 = 3456\n         if (lastTimeOfNewCredit + TWELVE_HOURS < block.timestamp) {\n             // Return money to sender\n             msg.sender.send(amount);\n             // Sends all contract money to the last creditor\n             creditorAddresses[creditorAddresses.length - 1].send(profitFromCrash);\n             corruptElite.send(this.balance);\n             // Reset contract state\n             lastCreditorPayedOut = 0;\n             lastTimeOfNewCredit = block.timestamp;\n             profitFromCrash = 0;\n            // <yes> <report> DENIAL_OF_SERVICE\n             creditorAddresses = new address[](0);\n            // <yes> <report> DENIAL_OF_SERVICE\n             creditorAmounts = new uint[](0);\n             round += 1;\n             return false;\n         }\n         else {\n             // the system needs to collect at least 1% of the profit from a crash to stay alive\n             if (amount >= 10 ** 18) {\n                 // the System has received fresh money, it will survive at leat 12h more\n                 lastTimeOfNewCredit = block.timestamp;\n                 // register the new creditor and his amount with 10% interest rate\n                 creditorAddresses.push(msg.sender);\n                 creditorAmounts.push(amount * 110 / 100);\n                 // now the money is distributed\n                 // first the corrupt elite grabs 5% - thieves!\n                 corruptElite.send(amount * 5/100);\n                 // 5% are going into the economy (they will increase the value for the person seeing the crash comming)\n                 if (profitFromCrash < 10000 * 10**18) {\n                     profitFromCrash += amount * 5/100;\n                 }\n                 // if you have a buddy in the government (and he is in the creditor list) he can get 5% of your credits.\n                 // Make a deal with him.\n                 if(buddies[buddy] >= amount) {\n                     buddy.send(amount * 5/100);\n                 }\n                 buddies[msg.sender] += amount * 110 / 100;\n                 // 90% of the money will be used to pay out old creditors\n                 if (creditorAmounts[lastCreditorPayedOut] <= address(this).balance - profitFromCrash) {\n                     creditorAddresses[lastCreditorPayedOut].send(creditorAmounts[lastCreditorPayedOut]);\n                     buddies[creditorAddresses[lastCreditorPayedOut]] -= creditorAmounts[lastCreditorPayedOut];\n                     lastCreditorPayedOut += 1;\n                 }\n                 return true;\n             }\n             else {\n                 msg.sender.send(amount);\n                 return false;\n             }\n         }\n     }", "highlightLines": [31]}, "category": "code", "location": {"file": "dataset/denial_of_service/list_dos.sol", "line": 31, "column": 6}, "severity": "medium", "references": [], "description": ""}, {"id": "841703883a04", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "         uint amount = msg.value;", "highlightLines": [32]}, "category": "code", "location": {"file": "dataset/denial_of_service/list_dos.sol", "line": 32, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "76acc0f5e7cf", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         uint amount = msg.value;\n         // check if the system already broke down. If for 12h no new creditor gives new credit to the system it will brake down.\n         // 12h are on average = 60*60*12/12.5 = 3456\n         if (lastTimeOfNewCredit + TWELVE_HOURS < block.timestamp) {\n             // Return money to sender\n             msg.sender.send(amount);\n             // Sends all contract money to the last creditor\n             creditorAddresses[creditorAddresses.length - 1].send(profitFromCrash);\n             corruptElite.send(this.balance);\n             // Reset contract state\n             lastCreditorPayedOut = 0;\n             lastTimeOfNewCredit = block.timestamp;\n             profitFromCrash = 0;\n            // <yes> <report> DENIAL_OF_SERVICE\n             creditorAddresses = new address[](0);\n            // <yes> <report> DENIAL_OF_SERVICE\n             creditorAmounts = new uint[](0);\n             round += 1;\n             return false;\n         }\n         else {\n             // the system needs to collect at least 1% of the profit from a crash to stay alive\n             if (amount >= 10 ** 18) {\n                 // the System has received fresh money, it will survive at leat 12h more\n                 lastTimeOfNewCredit = block.timestamp;\n                 // register the new creditor and his amount with 10% interest rate\n                 creditorAddresses.push(msg.sender);\n                 creditorAmounts.push(amount * 110 / 100);\n                 // now the money is distributed\n                 // first the corrupt elite grabs 5% - thieves!\n                 corruptElite.send(amount * 5/100);\n                 // 5% are going into the economy (they will increase the value for the person seeing the crash comming)\n                 if (profitFromCrash < 10000 * 10**18) {\n                     profitFromCrash += amount * 5/100;\n                 }\n                 // if you have a buddy in the government (and he is in the creditor list) he can get 5% of your credits.\n                 // Make a deal with him.\n                 if(buddies[buddy] >= amount) {\n                     buddy.send(amount * 5/100);\n                 }\n                 buddies[msg.sender] += amount * 110 / 100;\n                 // 90% of the money will be used to pay out old creditors\n                 if (creditorAmounts[lastCreditorPayedOut] <= address(this).balance - profitFromCrash) {\n                     creditorAddresses[lastCreditorPayedOut].send(creditorAmounts[lastCreditorPayedOut]);\n                     buddies[creditorAddresses[lastCreditorPayedOut]] -= creditorAmounts[lastCreditorPayedOut];\n                     lastCreditorPayedOut += 1;\n                 }\n                 return true;\n             }\n             else {\n                 msg.sender.send(amount);\n                 return false;\n             }\n         }", "highlightLines": [32]}, "category": "code", "location": {"file": "dataset/denial_of_service/list_dos.sol", "line": 32, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "020e9778b860", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "         if (lastTimeOfNewCredit + TWELVE_HOURS < block.timestamp) {", "highlightLines": [35]}, "category": "code", "location": {"file": "dataset/denial_of_service/list_dos.sol", "line": 35, "column": 51}, "severity": "medium", "references": [], "description": ""}, {"id": "c21b37d46118", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "             msg.sender.send(amount);", "highlightLines": [37]}, "category": "code", "location": {"file": "dataset/denial_of_service/list_dos.sol", "line": 37, "column": 14}, "severity": "high", "references": [], "description": ""}, {"id": "b930baba1f48", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "             creditorAddresses[creditorAddresses.length - 1].send(profitFromCrash);", "highlightLines": [39]}, "category": "code", "location": {"file": "dataset/denial_of_service/list_dos.sol", "line": 39, "column": 14}, "severity": "high", "references": [], "description": ""}, {"id": "94dc50a9431c", "fix": {"template": null, "available": false}, "title": "send() return value not checked - Ether may be stuck if recipient reverts", "ruleId": "rules.sol-unchecked-send-return", "snippet": {"code": "             creditorAddresses[creditorAddresses.length - 1].send(profitFromCrash);", "highlightLines": [39]}, "category": "code", "location": {"file": "dataset/denial_of_service/list_dos.sol", "line": 39, "column": 61}, "severity": "high", "references": [], "description": ""}, {"id": "0f41d7181985", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "             corruptElite.send(this.balance);", "highlightLines": [40]}, "category": "code", "location": {"file": "dataset/denial_of_service/list_dos.sol", "line": 40, "column": 14}, "severity": "high", "references": [], "description": ""}, {"id": "59f842755f73", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "             corruptElite.send(this.balance);", "highlightLines": [40]}, "category": "code", "location": {"file": "dataset/denial_of_service/list_dos.sol", "line": 40, "column": 26}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "c6bc2717cf3c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "             lastCreditorPayedOut = 0;\n             lastTimeOfNewCredit = block.timestamp;", "highlightLines": [42]}, "category": "code", "location": {"file": "dataset/denial_of_service/list_dos.sol", "line": 42, "column": 14}, "severity": "medium", "references": [], "description": ""}, {"id": "14c3c0c47d31", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "             lastTimeOfNewCredit = block.timestamp;\n             profitFromCrash = 0;", "highlightLines": [43]}, "category": "code", "location": {"file": "dataset/denial_of_service/list_dos.sol", "line": 43, "column": 14}, "severity": "medium", "references": [], "description": ""}, {"id": "bd1cee3478c5", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "             lastTimeOfNewCredit = block.timestamp;", "highlightLines": [43]}, "category": "code", "location": {"file": "dataset/denial_of_service/list_dos.sol", "line": 43, "column": 36}, "severity": "medium", "references": [], "description": ""}, {"id": "8b4bcdcc14b5", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "             profitFromCrash = 0;\n            // <yes> <report> DENIAL_OF_SERVICE\n             creditorAddresses = new address[](0);", "highlightLines": [44]}, "category": "code", "location": {"file": "dataset/denial_of_service/list_dos.sol", "line": 44, "column": 14}, "severity": "medium", "references": [], "description": ""}, {"id": "6d121041fe5d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "             creditorAddresses = new address[](0);\n            // <yes> <report> DENIAL_OF_SERVICE\n             creditorAmounts = new uint[](0);", "highlightLines": [46]}, "category": "code", "location": {"file": "dataset/denial_of_service/list_dos.sol", "line": 46, "column": 14}, "severity": "medium", "references": [], "description": ""}, {"id": "948c90ab90b6", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "             creditorAddresses = new address[](0);", "highlightLines": [46]}, "category": "code", "location": {"file": "dataset/denial_of_service/list_dos.sol", "line": 46, "column": 34}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "3158be7189f5", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "             creditorAmounts = new uint[](0);", "highlightLines": [48]}, "category": "code", "location": {"file": "dataset/denial_of_service/list_dos.sol", "line": 48, "column": 32}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "27bfb6e766fd", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "             if (amount >= 10 ** 18) {", "highlightLines": [54]}, "category": "code", "location": {"file": "dataset/denial_of_service/list_dos.sol", "line": 54, "column": 28}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "363992a0e4f4", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "                 lastTimeOfNewCredit = block.timestamp;", "highlightLines": [56]}, "category": "code", "location": {"file": "dataset/denial_of_service/list_dos.sol", "line": 56, "column": 40}, "severity": "medium", "references": [], "description": ""}, {"id": "df6b7db89254", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "                 corruptElite.send(amount * 5/100);", "highlightLines": [62]}, "category": "code", "location": {"file": "dataset/denial_of_service/list_dos.sol", "line": 62, "column": 18}, "severity": "high", "references": [], "description": ""}, {"id": "9c3011b3abe5", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimal assumption - tokens with >18 or <18 decimals will cause overflow/underflow", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "                 if (profitFromCrash < 10000 * 10**18) {", "highlightLines": [64]}, "category": "code", "location": {"file": "dataset/denial_of_service/list_dos.sol", "line": 64, "column": 46}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20"], "description": ""}, {"id": "5607943ea49e", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "                 if (profitFromCrash < 10000 * 10**18) {", "highlightLines": [64]}, "category": "code", "location": {"file": "dataset/denial_of_service/list_dos.sol", "line": 64, "column": 48}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "008a809b4410", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "                     buddy.send(amount * 5/100);", "highlightLines": [70]}, "category": "code", "location": {"file": "dataset/denial_of_service/list_dos.sol", "line": 70, "column": 22}, "severity": "high", "references": [], "description": ""}, {"id": "6b30ee3437e6", "fix": {"template": null, "available": false}, "title": "send() return value not checked - Ether may be stuck if recipient reverts", "ruleId": "rules.sol-unchecked-send-return", "snippet": {"code": "                     buddy.send(amount * 5/100);", "highlightLines": [70]}, "category": "code", "location": {"file": "dataset/denial_of_service/list_dos.sol", "line": 70, "column": 27}, "severity": "high", "references": [], "description": ""}, {"id": "a499588a614b", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "                     creditorAddresses[lastCreditorPayedOut].send(creditorAmounts[lastCreditorPayedOut]);", "highlightLines": [75]}, "category": "code", "location": {"file": "dataset/denial_of_service/list_dos.sol", "line": 75, "column": 22}, "severity": "high", "references": [], "description": ""}, {"id": "6e896322b88d", "fix": {"template": null, "available": false}, "title": "send() return value not checked - Ether may be stuck if recipient reverts", "ruleId": "rules.sol-unchecked-send-return", "snippet": {"code": "                     creditorAddresses[lastCreditorPayedOut].send(creditorAmounts[lastCreditorPayedOut]);", "highlightLines": [75]}, "category": "code", "location": {"file": "dataset/denial_of_service/list_dos.sol", "line": 75, "column": 61}, "severity": "high", "references": [], "description": ""}, {"id": "c81dbb4ba193", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "                 msg.sender.send(amount);", "highlightLines": [82]}, "category": "code", "location": {"file": "dataset/denial_of_service/list_dos.sol", "line": 82, "column": 18}, "severity": "high", "references": [], "description": ""}, {"id": "034001a084ab", "fix": {"template": null, "available": false}, "title": "send() return value not checked - Ether may be stuck if recipient reverts", "ruleId": "rules.sol-unchecked-send-return", "snippet": {"code": "                 msg.sender.send(amount);", "highlightLines": [82]}, "category": "code", "location": {"file": "dataset/denial_of_service/list_dos.sol", "line": 82, "column": 28}, "severity": "high", "references": [], "description": ""}, {"id": "a1e1e486d3b7", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "     function() {\n         lendGovernmentMoney(0);\n     }", "highlightLines": [89]}, "category": "code", "location": {"file": "dataset/denial_of_service/list_dos.sol", "line": 89, "column": 6}, "severity": "medium", "references": [], "description": ""}, {"id": "54998b6dcded", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "     function totalDebt() returns (uint debt) {\n         for(uint i=lastCreditorPayedOut; i<creditorAmounts.length; i++){\n             debt += creditorAmounts[i];\n         }\n     }", "highlightLines": [93]}, "category": "code", "location": {"file": "dataset/denial_of_service/list_dos.sol", "line": 93, "column": 6}, "severity": "medium", "references": [], "description": ""}, {"id": "f0dab931b068", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "     function totalPayedOut() returns (uint payout) {\n         for(uint i=0; i<lastCreditorPayedOut; i++){\n             payout += creditorAmounts[i];\n         }\n     }", "highlightLines": [99]}, "category": "code", "location": {"file": "dataset/denial_of_service/list_dos.sol", "line": 99, "column": 6}, "severity": "medium", "references": [], "description": ""}, {"id": "75bbffa89686", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "     function investInTheSystem() {\n         profitFromCrash += msg.value;\n     }", "highlightLines": [106]}, "category": "code", "location": {"file": "dataset/denial_of_service/list_dos.sol", "line": 106, "column": 6}, "severity": "medium", "references": [], "description": ""}, {"id": "584a830ee299", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "     function inheritToNextGeneration(address nextGeneration) {\n         if (msg.sender == corruptElite) {\n             corruptElite = nextGeneration;\n         }\n     }", "highlightLines": [111]}, "category": "code", "location": {"file": "dataset/denial_of_service/list_dos.sol", "line": 111, "column": 6}, "severity": "medium", "references": [], "description": ""}, {"id": "5366ffa1a21e", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "     function getCreditorAddresses() returns (address[]) {\n         return creditorAddresses;\n     }", "highlightLines": [117]}, "category": "code", "location": {"file": "dataset/denial_of_service/list_dos.sol", "line": 117, "column": 6}, "severity": "medium", "references": [], "description": ""}, {"id": "12a659fb89ae", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "     function getCreditorAmounts() returns (uint[]) {\n         return creditorAmounts;\n     }", "highlightLines": [121]}, "category": "code", "location": {"file": "dataset/denial_of_service/list_dos.sol", "line": 121, "column": 6}, "severity": "medium", "references": [], "description": ""}, {"id": "207251a32715", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity 0.4.24;", "highlightLines": [8]}, "category": "code", "location": {"file": "dataset/denial_of_service/send_loop.sol", "line": 8, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "677b390c373b", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    constructor() {\n        refundAddresses.push(0x79B483371E87d664cd39491b5F06250165e4b184);\n        refundAddresses.push(0x79B483371E87d664cd39491b5F06250165e4b185);\n    }", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/denial_of_service/send_loop.sol", "line": 15, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "d5fa86080ed1", "fix": {"template": null, "available": false}, "title": "Loop with external transfers - one failing recipient blocks all others", "ruleId": "rules.sol-denial-of-service-loop-transfer", "snippet": {"code": "        for(uint x; x < refundAddresses.length; x++) { // arbitrary length iteration based on how many addresses participated\n        // <yes> <report> DENIAL_OF_SERVICE\n            require(refundAddresses[x].send(refunds[refundAddresses[x]])); // doubly bad, now a single failure on send will hold up all funds", "highlightLines": [22]}, "category": "code", "location": {"file": "dataset/denial_of_service/send_loop.sol", "line": 22, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "32bd45de5376", "fix": {"template": null, "available": false}, "title": "ETH transfer inside loop - single failed transfer blocks all others (DoS pattern)", "ruleId": "rules.sol-loop-with-transfer", "snippet": {"code": "        for(uint x; x < refundAddresses.length; x++) { // arbitrary length iteration based on how many addresses participated\n        // <yes> <report> DENIAL_OF_SERVICE\n            require(refundAddresses[x].send(refunds[refundAddresses[x]])); // doubly bad, now a single failure on send will hold up all funds", "highlightLines": [22]}, "category": "code", "location": {"file": "dataset/denial_of_service/send_loop.sol", "line": 22, "column": 9}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "8171a7ddebc7", "fix": {"template": null, "available": false}, "title": "Unbounded loop iterating over dynamic array - can cause out-of-gas DoS", "ruleId": "rules.sol-unbounded-loop-dos", "snippet": {"code": "        for(uint x; x < refundAddresses.length; x++) { // arbitrary length iteration based on how many addresses participated\n        // <yes> <report> DENIAL_OF_SERVICE\n            require(refundAddresses[x].send(refunds[refundAddresses[x]])); // doubly bad, now a single failure on send will hold up all funds", "highlightLines": [22]}, "category": "code", "location": {"file": "dataset/denial_of_service/send_loop.sol", "line": 22, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "f4b36eec85fa", "fix": {"template": null, "available": false}, "title": "Unbounded loop over dynamic array - can cause DoS if array grows large", "ruleId": "rules.sol-unbounded-protocol-loop", "snippet": {"code": "        for(uint x; x < refundAddresses.length; x++) { // arbitrary length iteration based on how many addresses participated\n        // <yes> <report> DENIAL_OF_SERVICE\n            require(refundAddresses[x].send(refunds[refundAddresses[x]])); // doubly bad, now a single failure on send will hold up all funds", "highlightLines": [22]}, "category": "code", "location": {"file": "dataset/denial_of_service/send_loop.sol", "line": 22, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "4999b9b0ab92", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "            require(refundAddresses[x].send(refunds[refundAddresses[x]])); // doubly bad, now a single failure on send will hold up all funds", "highlightLines": [24]}, "category": "code", "location": {"file": "dataset/denial_of_service/send_loop.sol", "line": 24, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "bc619c18e762", "fix": {"template": null, "available": false}, "title": "External call in loop - gas griefing and DOS risk", "ruleId": "rules.sol-external-call-in-loop", "snippet": {"code": "            require(refundAddresses[x].send(refunds[refundAddresses[x]])); // doubly bad, now a single failure on send will hold up all funds", "highlightLines": [24]}, "category": "code", "location": {"file": "dataset/denial_of_service/send_loop.sol", "line": 24, "column": 21}, "severity": "high", "references": [], "description": ""}, {"id": "5fc2c0f22f77", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.24;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/front_running/ERC20.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "ba72fedbfc19", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.24;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/front_running/ERC20.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "d0f7298612ab", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "  function mul(uint256 a, uint256 b) internal pure returns (uint256) {\n    // Gas optimization: this is cheaper than requiring 'a' not being zero, but the\n    // benefit is lost if 'b' is also tested.\n    // See: https://github.com/OpenZeppelin/openzeppelin-solidity/pull/522\n    if (a == 0) {", "highlightLines": [18]}, "category": "code", "location": {"file": "dataset/front_running/ERC20.sol", "line": 18, "column": 3}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "458f22876b56", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n    uint256 c = a * b;", "highlightLines": [25]}, "category": "code", "location": {"file": "dataset/front_running/ERC20.sol", "line": 25, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "731fea967c71", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(c / a == b);", "highlightLines": [27]}, "category": "code", "location": {"file": "dataset/front_running/ERC20.sol", "line": 27, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "f7044c7f9ddf", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "  function div(uint256 a, uint256 b) internal pure returns (uint256) {\n    require(b > 0); // Solidity only automatically asserts when dividing by 0\n    uint256 c = a / b;", "highlightLines": [35]}, "category": "code", "location": {"file": "dataset/front_running/ERC20.sol", "line": 35, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "122e5086651e", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "  function div(uint256 a, uint256 b) internal pure returns (uint256) {\n    require(b > 0); // Solidity only automatically asserts when dividing by 0\n    uint256 c = a / b;\n    // assert(a == b * c + a % b); // There is no case in which this doesn't hold", "highlightLines": [35]}, "category": "code", "location": {"file": "dataset/front_running/ERC20.sol", "line": 35, "column": 3}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "8a53a2fdc398", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(b > 0); // Solidity only automatically asserts when dividing by 0", "highlightLines": [36]}, "category": "code", "location": {"file": "dataset/front_running/ERC20.sol", "line": 36, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "03c97f2bd8c1", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 c = a / b;", "highlightLines": [37]}, "category": "code", "location": {"file": "dataset/front_running/ERC20.sol", "line": 37, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e10a72b5a58d", "fix": {"template": null, "available": false}, "title": "SWC-110: assert() used for input validation - use require() instead, assert is for invariants", "ruleId": "rules.sol-swc-110-assert-user-input", "snippet": {"code": "    // assert(a == b * c + a % b); // There is no case in which this doesn't hold", "highlightLines": [38]}, "category": "code", "location": {"file": "dataset/front_running/ERC20.sol", "line": 38, "column": 8}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-110"], "description": ""}, {"id": "b4a8ec0f3f2b", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "  function sub(uint256 a, uint256 b) internal pure returns (uint256) {\n    require(b <= a);\n    uint256 c = a - b;", "highlightLines": [46]}, "category": "code", "location": {"file": "dataset/front_running/ERC20.sol", "line": 46, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "34ff09289c0d", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(b <= a);", "highlightLines": [47]}, "category": "code", "location": {"file": "dataset/front_running/ERC20.sol", "line": 47, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "b1a83eac49e6", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 c = a - b;", "highlightLines": [48]}, "category": "code", "location": {"file": "dataset/front_running/ERC20.sol", "line": 48, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b99764a0eed7", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "  function add(uint256 a, uint256 b) internal pure returns (uint256) {\n    uint256 c = a + b;", "highlightLines": [56]}, "category": "code", "location": {"file": "dataset/front_running/ERC20.sol", "line": 56, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "5a6756f04643", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 c = a + b;", "highlightLines": [57]}, "category": "code", "location": {"file": "dataset/front_running/ERC20.sol", "line": 57, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7881851e8a00", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(c >= a);", "highlightLines": [58]}, "category": "code", "location": {"file": "dataset/front_running/ERC20.sol", "line": 58, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "9ad31b6891a3", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(b != 0);", "highlightLines": [68]}, "category": "code", "location": {"file": "dataset/front_running/ERC20.sol", "line": 68, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "cdcf0e95d74c", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event Transfer( address indexed from, address indexed to, uint256 value );", "highlightLines": [76]}, "category": "code", "location": {"file": "dataset/front_running/ERC20.sol", "line": 76, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "df56b1e06c25", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event Approval( address indexed owner, address indexed spender, uint256 value);", "highlightLines": [77]}, "category": "code", "location": {"file": "dataset/front_running/ERC20.sol", "line": 77, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "9259f8c833e8", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  constructor(uint totalSupply){\n    _balances[msg.sender] = totalSupply;\n  }", "highlightLines": [86]}, "category": "code", "location": {"file": "dataset/front_running/ERC20.sol", "line": 86, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "e924cbfd562b", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "  function transfer(address to, uint256 value) public returns (bool) {", "highlightLines": [100]}, "category": "code", "location": {"file": "dataset/front_running/ERC20.sol", "line": 100, "column": 3}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "ed2e33d5e12a", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without msg.data.length validation - vulnerable to short address attack padding", "ruleId": "rules.sol-short-address-no-payload-check", "snippet": {"code": "  function transfer(address to, uint256 value) public returns (bool) {", "highlightLines": [100]}, "category": "code", "location": {"file": "dataset/front_running/ERC20.sol", "line": 100, "column": 3}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address", "https://vessenes.com/the-erc20-short-address-attack-explained/"], "description": ""}, {"id": "23149781200c", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "  function transfer(address to, uint256 value) public returns (bool) {\n    require(value <= _balances[msg.sender]);\n    require(to != address(0));", "highlightLines": [100]}, "category": "code", "location": {"file": "dataset/front_running/ERC20.sol", "line": 100, "column": 3}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "0586eb04710e", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - will never return false, only revert", "ruleId": "rules.sol-return-bool-always-reverts", "snippet": {"code": "  function transfer(address to, uint256 value) public returns (bool) {\n    require(value <= _balances[msg.sender]);\n    require(to != address(0));\n\n    _balances[msg.sender] = _balances[msg.sender].sub(value);\n    _balances[to] = _balances[to].add(value);\n    emit Transfer(msg.sender, to, value);\n    return true;\n  }", "highlightLines": [100]}, "category": "code", "location": {"file": "dataset/front_running/ERC20.sol", "line": 100, "column": 3}, "severity": "info", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "3f0c2e30789a", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(value <= _balances[msg.sender]);", "highlightLines": [101]}, "category": "code", "location": {"file": "dataset/front_running/ERC20.sol", "line": 101, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "1e24b1ccfe61", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(to != address(0));", "highlightLines": [102]}, "category": "code", "location": {"file": "dataset/front_running/ERC20.sol", "line": 102, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "603f7dbc09bf", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    _balances[msg.sender] = _balances[msg.sender].sub(value);\n    _balances[to] = _balances[to].add(value);", "highlightLines": [104]}, "category": "code", "location": {"file": "dataset/front_running/ERC20.sol", "line": 104, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "78872fc6ad5d", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "  function approve(address spender, uint256 value) public returns (bool) {", "highlightLines": [110]}, "category": "code", "location": {"file": "dataset/front_running/ERC20.sol", "line": 110, "column": 3}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "fd059a9918fd", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "  function approve(address spender, uint256 value) public returns (bool) {\n    require(spender != address(0));", "highlightLines": [110]}, "category": "code", "location": {"file": "dataset/front_running/ERC20.sol", "line": 110, "column": 3}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "0d2afd8fd7f0", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - will never return false, only revert", "ruleId": "rules.sol-return-bool-always-reverts", "snippet": {"code": "  function approve(address spender, uint256 value) public returns (bool) {\n    require(spender != address(0));\n     // <yes> <report> FRONT_RUNNING\n    _allowed[msg.sender][spender] = value;\n    emit Approval(msg.sender, spender, value);\n    return true;\n  }", "highlightLines": [110]}, "category": "code", "location": {"file": "dataset/front_running/ERC20.sol", "line": 110, "column": 3}, "severity": "info", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "9a52b9a43621", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(spender != address(0));", "highlightLines": [111]}, "category": "code", "location": {"file": "dataset/front_running/ERC20.sol", "line": 111, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "917ed5b78707", "fix": {"template": null, "available": false}, "title": "ERC20 transferFrom without payload size validation - consider adding onlyPayloadSize modifier", "ruleId": "rules.sol-erc20-missing-payload-modifier", "snippet": {"code": "  function transferFrom(address from, address to, uint256 value) public returns (bool) {", "highlightLines": [118]}, "category": "code", "location": {"file": "dataset/front_running/ERC20.sol", "line": 118, "column": 3}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address"], "description": ""}, {"id": "abba07ff4149", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "  function transferFrom(address from, address to, uint256 value) public returns (bool) {", "highlightLines": [118]}, "category": "code", "location": {"file": "dataset/front_running/ERC20.sol", "line": 118, "column": 3}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "e8114dbeb2d9", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "  function transferFrom(address from, address to, uint256 value) public returns (bool) {\n    require(value <= _balances[from]);\n    require(value <= _allowed[from][msg.sender]);\n    require(to != address(0));", "highlightLines": [118]}, "category": "code", "location": {"file": "dataset/front_running/ERC20.sol", "line": 118, "column": 3}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "84e5bcea00f6", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - will never return false, only revert", "ruleId": "rules.sol-return-bool-always-reverts", "snippet": {"code": "  function transferFrom(address from, address to, uint256 value) public returns (bool) {\n    require(value <= _balances[from]);\n    require(value <= _allowed[from][msg.sender]);\n    require(to != address(0));\n\n    _balances[from] = _balances[from].sub(value);\n    _balances[to] = _balances[to].add(value);\n    _allowed[from][msg.sender] = _allowed[from][msg.sender].sub(value);\n    emit Transfer(from, to, value);\n    return true;\n  }", "highlightLines": [118]}, "category": "code", "location": {"file": "dataset/front_running/ERC20.sol", "line": 118, "column": 3}, "severity": "info", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "205d45844dee", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(value <= _balances[from]);", "highlightLines": [119]}, "category": "code", "location": {"file": "dataset/front_running/ERC20.sol", "line": 119, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "cb1d7c5a9c15", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(value <= _allowed[from][msg.sender]);", "highlightLines": [120]}, "category": "code", "location": {"file": "dataset/front_running/ERC20.sol", "line": 120, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "79e38394c00e", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(to != address(0));", "highlightLines": [121]}, "category": "code", "location": {"file": "dataset/front_running/ERC20.sol", "line": 121, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "f2c62f0a28cb", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    _balances[from] = _balances[from].sub(value);\n    _balances[to] = _balances[to].add(value);", "highlightLines": [123]}, "category": "code", "location": {"file": "dataset/front_running/ERC20.sol", "line": 123, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "e42dab46ccd7", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    _balances[to] = _balances[to].add(value);\n    _allowed[from][msg.sender] = _allowed[from][msg.sender].sub(value);", "highlightLines": [124]}, "category": "code", "location": {"file": "dataset/front_running/ERC20.sol", "line": 124, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "d9afb2455a98", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.22;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/front_running/FindThisHash.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "2e821219748e", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.22;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/front_running/FindThisHash.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "028bfc195417", "fix": {"template": null, "available": false}, "title": "Potential Ethereum private key detected - CRITICAL if real", "ruleId": "rules._shared.shared-ethereum-private-key", "snippet": {"code": "    bytes32 constant public hash = 0xb5b5b97fafd9855eec9b41f74dfb6c38f5951141f9a3ecd7f44d5479b630ee0a;", "highlightLines": [10]}, "category": "code", "location": {"file": "dataset/front_running/FindThisHash.sol", "line": 10, "column": 36}, "severity": "high", "references": [], "description": ""}, {"id": "95ebc6821344", "fix": {"template": null, "available": false}, "title": "Empty constructor or constructor with no effect - may indicate incomplete implementation", "ruleId": "rules.sol-void-constructor", "snippet": {"code": "    constructor() public payable {} // load with ether", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/front_running/FindThisHash.sol", "line": 12, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "cbc498bb654d", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(hash == sha3(solution));", "highlightLines": [17]}, "category": "code", "location": {"file": "dataset/front_running/FindThisHash.sol", "line": 17, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "d27f3a5cf5c6", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        msg.sender.transfer(1000 ether);", "highlightLines": [18]}, "category": "code", "location": {"file": "dataset/front_running/FindThisHash.sol", "line": 18, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "9013018c31b2", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.16;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/front_running/eth_tx_order_dependence_minimal.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "943adeda2f6d", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.16;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/front_running/eth_tx_order_dependence_minimal.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "9ff134df857d", "fix": {"template": null, "available": false}, "title": "SWC-118: Function name matches contract name - likely intended as constructor (pre-0.4.22)", "ruleId": "rules.sol-swc-118-constructor-mismatch", "snippet": {"code": "contract EthTxOrderDependenceMinimal {\n    address public owner;\n    bool public claimed;\n    uint public reward;\n\n    function EthTxOrderDependenceMinimal() public {", "highlightLines": [9]}, "category": "code", "location": {"file": "dataset/front_running/eth_tx_order_dependence_minimal.sol", "line": 9, "column": 1}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-118"], "description": ""}, {"id": "cf59fb56b9d7", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        owner = msg.sender;", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/front_running/eth_tx_order_dependence_minimal.sol", "line": 15, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "ae86fb4514bd", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require (!claimed);", "highlightLines": [19]}, "category": "code", "location": {"file": "dataset/front_running/eth_tx_order_dependence_minimal.sol", "line": 19, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "74b02715e962", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "        require(msg.sender == owner);", "highlightLines": [21]}, "category": "code", "location": {"file": "dataset/front_running/eth_tx_order_dependence_minimal.sol", "line": 21, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "bd3a00b60797", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender == owner);", "highlightLines": [21]}, "category": "code", "location": {"file": "dataset/front_running/eth_tx_order_dependence_minimal.sol", "line": 21, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "74642a9010ad", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        owner.transfer(reward);", "highlightLines": [23]}, "category": "code", "location": {"file": "dataset/front_running/eth_tx_order_dependence_minimal.sol", "line": 23, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "f33a9f5e90f7", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function claimReward(uint256 submission) {\n        require (!claimed);\n        require(submission < 10);\n        // <yes> <report> FRONT_RUNNING\n        msg.sender.transfer(reward);\n        claimed = true;\n    }", "highlightLines": [27]}, "category": "code", "location": {"file": "dataset/front_running/eth_tx_order_dependence_minimal.sol", "line": 27, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "d090e282a31d", "fix": {"template": null, "available": false}, "title": "Rewards can be claimed without proper accounting - protocol solvency at risk", "ruleId": "rules.sol-unclaimed-rewards-solvency", "snippet": {"code": "    function claimReward(uint256 submission) {\n        require (!claimed);\n        require(submission < 10);\n        // <yes> <report> FRONT_RUNNING\n        msg.sender.transfer(reward);\n        claimed = true;\n    }", "highlightLines": [27]}, "category": "code", "location": {"file": "dataset/front_running/eth_tx_order_dependence_minimal.sol", "line": 27, "column": 5}, "severity": "medium", "references": ["https://github.com/code-423n4/2023-04-rubicon-findings"], "description": ""}, {"id": "e5d911c980be", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require (!claimed);", "highlightLines": [28]}, "category": "code", "location": {"file": "dataset/front_running/eth_tx_order_dependence_minimal.sol", "line": 28, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "96410e6097e9", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(submission < 10);", "highlightLines": [29]}, "category": "code", "location": {"file": "dataset/front_running/eth_tx_order_dependence_minimal.sol", "line": 29, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "794e15e84119", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        msg.sender.transfer(reward);", "highlightLines": [31]}, "category": "code", "location": {"file": "dataset/front_running/eth_tx_order_dependence_minimal.sol", "line": 31, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "7cbf7cc1659b", "fix": {"template": null, "available": false}, "title": "ETH transfer via .transfer() before state update - potential reentrancy via fallback", "ruleId": "rules.sol-transfer-before-state-update-reentrancy", "snippet": {"code": "        msg.sender.transfer(reward);\n        claimed = true;", "highlightLines": [31]}, "category": "code", "location": {"file": "dataset/front_running/eth_tx_order_dependence_minimal.sol", "line": 31, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "0ae7b913639b", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.2;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/front_running/odds_and_evens.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "cb91644df1c1", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.2;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/front_running/odds_and_evens.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "342fd007a862", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address addr;", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/front_running/odds_and_evens.sol", "line": 12, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "bd8e81118a62", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint number;", "highlightLines": [13]}, "category": "code", "location": {"file": "dataset/front_running/odds_and_evens.sol", "line": 13, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "1087689a0da6", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n  uint8 tot;", "highlightLines": [17]}, "category": "code", "location": {"file": "dataset/front_running/odds_and_evens.sol", "line": 17, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ebf9dabc1aed", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "  address owner;", "highlightLines": [19]}, "category": "code", "location": {"file": "dataset/front_running/odds_and_evens.sol", "line": 19, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "73b364f024fb", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "  address owner;", "highlightLines": [19]}, "category": "code", "location": {"file": "dataset/front_running/odds_and_evens.sol", "line": 19, "column": 3}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "f4935134515f", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function OddsAndEvens() {\n    owner = msg.sender;\n  }", "highlightLines": [21]}, "category": "code", "location": {"file": "dataset/front_running/odds_and_evens.sol", "line": 21, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "ecebfd3bcf5e", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "    owner = msg.sender;", "highlightLines": [22]}, "category": "code", "location": {"file": "dataset/front_running/odds_and_evens.sol", "line": 22, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "ece41f2f5a79", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function play(uint number) payable{\n    if (msg.value != 1 ether) throw;\n    // <yes> <report> FRONT_RUNNING\n    players[tot] = Player(msg.sender, number);\n    tot++;\n\n    if (tot==2) andTheWinnerIs();\n  }", "highlightLines": [25]}, "category": "code", "location": {"file": "dataset/front_running/odds_and_evens.sol", "line": 25, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "19b6d05cd933", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "    if (tot==2) andTheWinnerIs();", "highlightLines": [31]}, "category": "code", "location": {"file": "dataset/front_running/odds_and_evens.sol", "line": 31, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "5043ab96f5ce", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    bool res ;", "highlightLines": [35]}, "category": "code", "location": {"file": "dataset/front_running/odds_and_evens.sol", "line": 35, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a460b3e16115", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint n = players[0].number+players[1].number;", "highlightLines": [36]}, "category": "code", "location": {"file": "dataset/front_running/odds_and_evens.sol", "line": 36, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f47be3ffbced", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint n = players[0].number+players[1].number;\n    if (n%2==0) {\n      res = players[0].addr.send(1800 finney);\n    }\n    else {\n      res = players[1].addr.send(1800 finney);\n    }", "highlightLines": [36]}, "category": "code", "location": {"file": "dataset/front_running/odds_and_evens.sol", "line": 36, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "a330ad7dfc62", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "    if (n%2==0) {\n      res = players[0].addr.send(1800 finney);\n    }\n    else {\n      res = players[1].addr.send(1800 finney);\n    }", "highlightLines": [37]}, "category": "code", "location": {"file": "dataset/front_running/odds_and_evens.sol", "line": 37, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "ca889c0564c5", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "      res = players[0].addr.send(1800 finney);", "highlightLines": [38]}, "category": "code", "location": {"file": "dataset/front_running/odds_and_evens.sol", "line": 38, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "9347b6d095c7", "fix": {"template": null, "available": false}, "title": "send() return value not checked - Ether may be stuck if recipient reverts", "ruleId": "rules.sol-unchecked-send-return", "snippet": {"code": "      res = players[0].addr.send(1800 finney);", "highlightLines": [38]}, "category": "code", "location": {"file": "dataset/front_running/odds_and_evens.sol", "line": 38, "column": 28}, "severity": "high", "references": [], "description": ""}, {"id": "fba9e5cd15d6", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "      res = players[1].addr.send(1800 finney);", "highlightLines": [41]}, "category": "code", "location": {"file": "dataset/front_running/odds_and_evens.sol", "line": 41, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "95a2e6803f4e", "fix": {"template": null, "available": false}, "title": "send() return value not checked - Ether may be stuck if recipient reverts", "ruleId": "rules.sol-unchecked-send-return", "snippet": {"code": "      res = players[1].addr.send(1800 finney);", "highlightLines": [41]}, "category": "code", "location": {"file": "dataset/front_running/odds_and_evens.sol", "line": 41, "column": 28}, "severity": "high", "references": [], "description": ""}, {"id": "4f9108f9e444", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function getProfit() {\n    if(msg.sender!=owner) throw;\n    bool res = msg.sender.send(this.balance);\n  }", "highlightLines": [48]}, "category": "code", "location": {"file": "dataset/front_running/odds_and_evens.sol", "line": 48, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "9cfab46365aa", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "    if(msg.sender!=owner) throw;\n    bool res = msg.sender.send(this.balance);", "highlightLines": [49]}, "category": "code", "location": {"file": "dataset/front_running/odds_and_evens.sol", "line": 49, "column": 27}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "cf52aca9ea76", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    bool res = msg.sender.send(this.balance);", "highlightLines": [50]}, "category": "code", "location": {"file": "dataset/front_running/odds_and_evens.sol", "line": 50, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "24cc5cc4ac66", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "    bool res = msg.sender.send(this.balance);", "highlightLines": [50]}, "category": "code", "location": {"file": "dataset/front_running/odds_and_evens.sol", "line": 50, "column": 16}, "severity": "high", "references": [], "description": ""}, {"id": "4ae65eaaceec", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "    bool res = msg.sender.send(this.balance);", "highlightLines": [50]}, "category": "code", "location": {"file": "dataset/front_running/odds_and_evens.sol", "line": 50, "column": 26}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "a6b3caa257f2", "fix": {"template": null, "available": false}, "title": "send() return value not checked - Ether may be stuck if recipient reverts", "ruleId": "rules.sol-unchecked-send-return", "snippet": {"code": "    bool res = msg.sender.send(this.balance);", "highlightLines": [50]}, "category": "code", "location": {"file": "dataset/front_running/odds_and_evens.sol", "line": 50, "column": 26}, "severity": "high", "references": [], "description": ""}, {"id": "f54439d7ad1d", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [5]}, "category": "code", "location": {"file": "dataset/other/crypto_roulette.sol", "line": 5, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "00af88b66b35", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [5]}, "category": "code", "location": {"file": "dataset/other/crypto_roulette.sol", "line": 5, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "5e00c358e028", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address player;", "highlightLines": [22]}, "category": "code", "location": {"file": "dataset/other/crypto_roulette.sol", "line": 22, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7218552cf2b7", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 number;", "highlightLines": [23]}, "category": "code", "location": {"file": "dataset/other/crypto_roulette.sol", "line": 23, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e574633ed095", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        secretNumber = uint8(sha3(now, block.blockhash(block.number-1))) % 20 + 1;", "highlightLines": [34]}, "category": "code", "location": {"file": "dataset/other/crypto_roulette.sol", "line": 34, "column": 24}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "6f0b363709f0", "fix": {"template": null, "available": false}, "title": "sha3() is deprecated - use keccak256() instead", "ruleId": "rules.sol-deprecated-sha3", "snippet": {"code": "        secretNumber = uint8(sha3(now, block.blockhash(block.number-1))) % 20 + 1;", "highlightLines": [34]}, "category": "code", "location": {"file": "dataset/other/crypto_roulette.sol", "line": 34, "column": 30}, "severity": "info", "references": [], "description": ""}, {"id": "ce89363a0643", "fix": {"template": null, "available": false}, "title": "blockhash only works for last 256 blocks - older blocks return 0 (PredictTheBlockHash pattern)", "ruleId": "rules.sol-blockhash-256-limit", "snippet": {"code": "        secretNumber = uint8(sha3(now, block.blockhash(block.number-1))) % 20 + 1;", "highlightLines": [34]}, "category": "code", "location": {"file": "dataset/other/crypto_roulette.sol", "line": 34, "column": 40}, "severity": "medium", "references": ["https://capturetheether.com/challenges/lottery/predict-block-hash/"], "description": ""}, {"id": "870d9bd81898", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - predictable by miners, 0 after 256 blocks", "ruleId": "rules.sol-blockhash-randomness", "snippet": {"code": "        secretNumber = uint8(sha3(now, block.blockhash(block.number-1))) % 20 + 1;", "highlightLines": [34]}, "category": "code", "location": {"file": "dataset/other/crypto_roulette.sol", "line": 34, "column": 46}, "severity": "high", "references": [], "description": ""}, {"id": "7b7100ac5811", "fix": {"template": null, "available": false}, "title": "blockhash(block.number - 1) used for randomness - miners can manipulate", "ruleId": "rules.sol-blockhash-previous-block", "snippet": {"code": "        secretNumber = uint8(sha3(now, block.blockhash(block.number-1))) % 20 + 1;", "highlightLines": [34]}, "category": "code", "location": {"file": "dataset/other/crypto_roulette.sol", "line": 34, "column": 46}, "severity": "medium", "references": [], "description": ""}, {"id": "4a71f4161bf8", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function play(uint256 number) payable public {\n        require(msg.value >= betPrice && number <= 10);\n        // <yes> <report> OTHER - uninitialized storage\n        Game game; //Uninitialized storage pointer\n        game.player = msg.sender;\n        game.number = number;\n        gamesPlayed.push(game);\n\n        if (number == secretNumber) {", "highlightLines": [37]}, "category": "code", "location": {"file": "dataset/other/crypto_roulette.sol", "line": 37, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "9b5d2727b804", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.value >= betPrice && number <= 10);", "highlightLines": [38]}, "category": "code", "location": {"file": "dataset/other/crypto_roulette.sol", "line": 38, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "b7ba80ffb910", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        game.player = msg.sender;\n        game.number = number;", "highlightLines": [41]}, "category": "code", "location": {"file": "dataset/other/crypto_roulette.sol", "line": 41, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "74fea08da11d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        game.number = number;\n        gamesPlayed.push(game);\n\n        if (number == secretNumber) {\n            // win!\n            msg.sender.transfer(this.balance);\n        }\n\n        shuffle();\n        lastPlayed = now;", "highlightLines": [42]}, "category": "code", "location": {"file": "dataset/other/crypto_roulette.sol", "line": 42, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "ed69b3c065ce", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "        if (number == secretNumber) {\n            // win!\n            msg.sender.transfer(this.balance);\n        }", "highlightLines": [45]}, "category": "code", "location": {"file": "dataset/other/crypto_roulette.sol", "line": 45, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "ca2ff7c5fad7", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "            msg.sender.transfer(this.balance);", "highlightLines": [47]}, "category": "code", "location": {"file": "dataset/other/crypto_roulette.sol", "line": 47, "column": 13}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "9bb637f78c39", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "            msg.sender.transfer(this.balance);", "highlightLines": [47]}, "category": "code", "location": {"file": "dataset/other/crypto_roulette.sol", "line": 47, "column": 23}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "067040f54668", "fix": {"template": null, "available": false}, "title": "Block timestamp used for critical logic - miners can manipulate within ~15 second window", "ruleId": "rules.sol-block-timestamp-manipulation", "snippet": {"code": "        if (msg.sender == ownerAddr && now > lastPlayed + 1 days) {", "highlightLines": [55]}, "category": "code", "location": {"file": "dataset/other/crypto_roulette.sol", "line": 55, "column": 40}, "severity": "medium", "references": ["https://consensys.github.io/smart-contract-best-practices/development-recommendations/solidity-specific/timestamp-dependence/"], "description": ""}, {"id": "b6b43167ee14", "fix": {"template": null, "available": false}, "title": "Contract can be destructed by anyone - missing access control on selfdestruct", "ruleId": "rules.sol-accessible-selfdestruct", "snippet": {"code": "            suicide(msg.sender);", "highlightLines": [56]}, "category": "code", "location": {"file": "dataset/other/crypto_roulette.sol", "line": 56, "column": 13}, "severity": "high", "references": ["https://www.parity.io/blog/a-postmortem-on-the-parity-multi-sig-library-self-destruct/"], "description": ""}, {"id": "6c2065a327fc", "fix": {"template": null, "available": false}, "title": "suicide() is deprecated - use selfdestruct() instead", "ruleId": "rules.sol-deprecated-suicide", "snippet": {"code": "            suicide(msg.sender);", "highlightLines": [56]}, "category": "code", "location": {"file": "dataset/other/crypto_roulette.sol", "line": 56, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "74d522b2dbbc", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.15;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/other/name_registrar.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "8a3527e126fe", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.15;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/other/name_registrar.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "a5f0eae03aa6", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 name;", "highlightLines": [13]}, "category": "code", "location": {"file": "dataset/other/name_registrar.sol", "line": 13, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4d22d364243a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address mappedAddress;", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/other/name_registrar.sol", "line": 14, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "69567dbe8d8d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        newRecord.name = _name;\n        newRecord.mappedAddress = _mappedAddress;", "highlightLines": [24]}, "category": "code", "location": {"file": "dataset/other/name_registrar.sol", "line": 24, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "1c656779f09f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        newRecord.mappedAddress = _mappedAddress;\n\n        resolve[_name] = _mappedAddress;", "highlightLines": [25]}, "category": "code", "location": {"file": "dataset/other/name_registrar.sol", "line": 25, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "b62776a34cf1", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        resolve[_name] = _mappedAddress;\n        registeredNameRecord[msg.sender] = newRecord;", "highlightLines": [27]}, "category": "code", "location": {"file": "dataset/other/name_registrar.sol", "line": 27, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "c792d04bd059", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(unlocked); // only allow registrations if contract is unlocked", "highlightLines": [30]}, "category": "code", "location": {"file": "dataset/other/name_registrar.sol", "line": 30, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "e8c4346824bf", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [6]}, "category": "code", "location": {"file": "dataset/other/open_address_lottery.sol", "line": 6, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "e8fa17965172", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [6]}, "category": "code", "location": {"file": "dataset/other/open_address_lottery.sol", "line": 6, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "7c7bf95a629b", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint component1;", "highlightLines": [28]}, "category": "code", "location": {"file": "dataset/other/open_address_lottery.sol", "line": 28, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "5e0bcc85bc28", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint component2;", "highlightLines": [29]}, "category": "code", "location": {"file": "dataset/other/open_address_lottery.sol", "line": 29, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "51a01e024dc0", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint component3;", "highlightLines": [30]}, "category": "code", "location": {"file": "dataset/other/open_address_lottery.sol", "line": 30, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "10336f6404b7", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint component4;", "highlightLines": [31]}, "category": "code", "location": {"file": "dataset/other/open_address_lottery.sol", "line": 31, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4a7a92b694b6", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    \n    address owner; //address of the owner", "highlightLines": [33]}, "category": "code", "location": {"file": "dataset/other/open_address_lottery.sol", "line": 33, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "afbbad309c42", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "    address owner; //address of the owner", "highlightLines": [34]}, "category": "code", "location": {"file": "dataset/other/open_address_lottery.sol", "line": 34, "column": 5}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "34ac0905c903", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint LuckyNumber = 7; //if the number of an address equals 7, it wins", "highlightLines": [37]}, "category": "code", "location": {"file": "dataset/other/open_address_lottery.sol", "line": 37, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "bc423f833a14", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function OpenAddressLottery() {\n        owner = msg.sender;\n        reseed(SeedComponents((uint)(block.coinbase), block.difficulty, block.gaslimit, block.timestamp)); //generate a quality random seed\n    }", "highlightLines": [41]}, "category": "code", "location": {"file": "dataset/other/open_address_lottery.sol", "line": 41, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "7a90f496a41d", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        owner = msg.sender;", "highlightLines": [42]}, "category": "code", "location": {"file": "dataset/other/open_address_lottery.sol", "line": 42, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "3ba27e5ac585", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        reseed(SeedComponents((uint)(block.coinbase), block.difficulty, block.gaslimit, block.timestamp)); //generate a quality random seed", "highlightLines": [43]}, "category": "code", "location": {"file": "dataset/other/open_address_lottery.sol", "line": 43, "column": 55}, "severity": "medium", "references": [], "description": ""}, {"id": "63beab88bf65", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function participate() payable {\n        if(msg.value<0.1 ether)\n            return; //verify ticket price\n        \n        // make sure he hasn't won already\n        require(winner[msg.sender] == false);\n        \n        if(luckyNumberOfAddress(msg.sender) == LuckyNumber){ //check if it equals 7\n            winner[msg.sender] = true; // every address can only win once\n            \n            uint win=msg.value*7; //win = 7 times the ticket price\n            \n            if(win>this.balance) //if the balance isnt sufficient...\n                win=this.balance; //...send everything we've got\n            msg.sender.transfer(win);\n        }\n        \n        if(block.number-lastReseed>1000) //reseed if needed\n            reseed(SeedComponents((uint)(block.coinbase), block.difficulty, block.gaslimit, block.timestamp)); //generate a quality random seed\n    }", "highlightLines": [46]}, "category": "code", "location": {"file": "dataset/other/open_address_lottery.sol", "line": 46, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "346f36f6aac2", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(winner[msg.sender] == false);", "highlightLines": [51]}, "category": "code", "location": {"file": "dataset/other/open_address_lottery.sol", "line": 51, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "78d974668df4", "fix": {"template": null, "available": false}, "title": "Unnecessary comparison to boolean constant - use variable directly", "ruleId": "rules.sol-boolean-constant-comparison", "snippet": {"code": "        require(winner[msg.sender] == false);", "highlightLines": [51]}, "category": "code", "location": {"file": "dataset/other/open_address_lottery.sol", "line": 51, "column": 36}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#boolean-equality"], "description": ""}, {"id": "bb2c196fb09e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            winner[msg.sender] = true; // every address can only win once\n            \n            uint win=msg.value*7; //win = 7 times the ticket price", "highlightLines": [54]}, "category": "code", "location": {"file": "dataset/other/open_address_lottery.sol", "line": 54, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "4c93938f26f9", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            \n            uint win=msg.value*7; //win = 7 times the ticket price", "highlightLines": [55]}, "category": "code", "location": {"file": "dataset/other/open_address_lottery.sol", "line": 55, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7567dd19f3a5", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            uint win=msg.value*7; //win = 7 times the ticket price\n            \n            if(win>this.balance) //if the balance isnt sufficient...\n                win=this.balance; //...send everything we've got", "highlightLines": [56]}, "category": "code", "location": {"file": "dataset/other/open_address_lottery.sol", "line": 56, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "85425ed129ee", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "            msg.sender.transfer(win);", "highlightLines": [60]}, "category": "code", "location": {"file": "dataset/other/open_address_lottery.sol", "line": 60, "column": 13}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "7ffde10c55bb", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "            reseed(SeedComponents((uint)(block.coinbase), block.difficulty, block.gaslimit, block.timestamp)); //generate a quality random seed", "highlightLines": [64]}, "category": "code", "location": {"file": "dataset/other/open_address_lottery.sol", "line": 64, "column": 59}, "severity": "medium", "references": [], "description": ""}, {"id": "b1334184b90b", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function luckyNumberOfAddress(address addr) constant returns(uint n){\n        // calculate the number of current address - 1 in 8 chance\n        n = uint(keccak256(uint(addr), secretSeed)[0]) % 8;\n    }", "highlightLines": [67]}, "category": "code", "location": {"file": "dataset/other/open_address_lottery.sol", "line": 67, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "31c2db0d9804", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "        n = uint(keccak256(uint(addr), secretSeed)[0]) % 8;", "highlightLines": [69]}, "category": "code", "location": {"file": "dataset/other/open_address_lottery.sol", "line": 69, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "555610b5ee31", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        secretSeed = uint256(keccak256(\n            components.component1,\n            components.component2,\n            components.component3,\n            components.component4\n        )); //hash the incoming parameters and use the hash to (re)initialize the seed\n        lastReseed = block.number;", "highlightLines": [73]}, "category": "code", "location": {"file": "dataset/other/open_address_lottery.sol", "line": 73, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "bf1f7a0ff476", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function kill() {\n        require(msg.sender==owner);\n        \n        selfdestruct(msg.sender);\n    }", "highlightLines": [82]}, "category": "code", "location": {"file": "dataset/other/open_address_lottery.sol", "line": 82, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "71bfe2b9b181", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "        require(msg.sender==owner);", "highlightLines": [83]}, "category": "code", "location": {"file": "dataset/other/open_address_lottery.sol", "line": 83, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "f5b326c94577", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender==owner);", "highlightLines": [83]}, "category": "code", "location": {"file": "dataset/other/open_address_lottery.sol", "line": 83, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "3ad9959ae7cc", "fix": {"template": null, "available": false}, "title": "Selfdestruct with user-controlled recipient - funds can be sent anywhere", "ruleId": "rules.sol-selfdestruct-arbitrary", "snippet": {"code": "        selfdestruct(msg.sender);", "highlightLines": [85]}, "category": "code", "location": {"file": "dataset/other/open_address_lottery.sol", "line": 85, "column": 9}, "severity": "high", "references": [], "description": ""}, {"id": "e8acf196a315", "fix": {"template": null, "available": false}, "title": "selfdestruct can force ETH to any address - contracts cannot prevent receiving ETH this way (Force pattern)", "ruleId": "rules.sol-selfdestruct-force-eth", "snippet": {"code": "        selfdestruct(msg.sender);", "highlightLines": [85]}, "category": "code", "location": {"file": "dataset/other/open_address_lottery.sol", "line": 85, "column": 9}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/7"], "description": ""}, {"id": "467a51dfa203", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function forceReseed() { //reseed initiated by the owner - for testing purposes\n        require(msg.sender==owner);\n        // <yes> <report> OTHER - uninitialized storage\n        SeedComponents s;\n        s.component1 = uint(msg.sender);\n        s.component2 = uint256(block.blockhash(block.number - 1));\n        s.component3 = block.difficulty*(uint)(block.coinbase);\n        s.component4 = tx.gasprice * 7;\n        \n        reseed(s); //reseed\n    }", "highlightLines": [88]}, "category": "code", "location": {"file": "dataset/other/open_address_lottery.sol", "line": 88, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "be3c659044c4", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "        require(msg.sender==owner);", "highlightLines": [89]}, "category": "code", "location": {"file": "dataset/other/open_address_lottery.sol", "line": 89, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "ae79b053025f", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender==owner);", "highlightLines": [89]}, "category": "code", "location": {"file": "dataset/other/open_address_lottery.sol", "line": 89, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "e3115ab34d35", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        s.component1 = uint(msg.sender);\n        s.component2 = uint256(block.blockhash(block.number - 1));", "highlightLines": [92]}, "category": "code", "location": {"file": "dataset/other/open_address_lottery.sol", "line": 92, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d55ced66b692", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "        s.component1 = uint(msg.sender);", "highlightLines": [92]}, "category": "code", "location": {"file": "dataset/other/open_address_lottery.sol", "line": 92, "column": 24}, "severity": "info", "references": [], "description": ""}, {"id": "62567d5aebd8", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        s.component2 = uint256(block.blockhash(block.number - 1));\n        s.component3 = block.difficulty*(uint)(block.coinbase);", "highlightLines": [93]}, "category": "code", "location": {"file": "dataset/other/open_address_lottery.sol", "line": 93, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "17dc5b652bd7", "fix": {"template": null, "available": false}, "title": "blockhash only works for last 256 blocks - older blocks return 0 (PredictTheBlockHash pattern)", "ruleId": "rules.sol-blockhash-256-limit", "snippet": {"code": "        s.component2 = uint256(block.blockhash(block.number - 1));", "highlightLines": [93]}, "category": "code", "location": {"file": "dataset/other/open_address_lottery.sol", "line": 93, "column": 32}, "severity": "medium", "references": ["https://capturetheether.com/challenges/lottery/predict-block-hash/"], "description": ""}, {"id": "9cc256ecfc72", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - predictable by miners, 0 after 256 blocks", "ruleId": "rules.sol-blockhash-randomness", "snippet": {"code": "        s.component2 = uint256(block.blockhash(block.number - 1));", "highlightLines": [93]}, "category": "code", "location": {"file": "dataset/other/open_address_lottery.sol", "line": 93, "column": 38}, "severity": "high", "references": [], "description": ""}, {"id": "060998e6b90e", "fix": {"template": null, "available": false}, "title": "blockhash(block.number - 1) used for randomness - miners can manipulate", "ruleId": "rules.sol-blockhash-previous-block", "snippet": {"code": "        s.component2 = uint256(block.blockhash(block.number - 1));", "highlightLines": [93]}, "category": "code", "location": {"file": "dataset/other/open_address_lottery.sol", "line": 93, "column": 38}, "severity": "medium", "references": [], "description": ""}, {"id": "9bb8e19fee58", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        s.component3 = block.difficulty*(uint)(block.coinbase);\n        s.component4 = tx.gasprice * 7;", "highlightLines": [94]}, "category": "code", "location": {"file": "dataset/other/open_address_lottery.sol", "line": 94, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "ed7ab217ea0a", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        s.component3 = block.difficulty*(uint)(block.coinbase);", "highlightLines": [94]}, "category": "code", "location": {"file": "dataset/other/open_address_lottery.sol", "line": 94, "column": 24}, "severity": "medium", "references": [], "description": ""}, {"id": "e9aeeb96f0e1", "fix": {"template": null, "available": false}, "title": "tx.gasprice can be manipulated by miners - avoid using for financial calculations", "ruleId": "rules.sol-tx-gasprice-manipulation", "snippet": {"code": "        s.component4 = tx.gasprice * 7;", "highlightLines": [95]}, "category": "code", "location": {"file": "dataset/other/open_address_lottery.sol", "line": 95, "column": 24}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/gas-price.sol"], "description": ""}, {"id": "2db3ad8aa38f", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function () payable { //if someone sends money without any function call, just assume he wanted to participate\n        if(msg.value>=0.1 ether && msg.sender!=owner) //owner can't participate, he can only fund the jackpot\n            participate();\n    }", "highlightLines": [100]}, "category": "code", "location": {"file": "dataset/other/open_address_lottery.sol", "line": 100, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "85a5e12a10b8", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/0x01f8c4e3fa3edeb29e514cba738d87ce8c091d3f.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "899392d6af5f", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/0x01f8c4e3fa3edeb29e514cba738d87ce8c091d3f.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "45a6b795eec1", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    \n    bool intitalized;", "highlightLines": [16]}, "category": "code", "location": {"file": "dataset/reentrancy/0x01f8c4e3fa3edeb29e514cba738d87ce8c091d3f.sol", "line": 16, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "503071520210", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "        if(intitalized)revert();\n        MinSum = _val;", "highlightLines": [22]}, "category": "code", "location": {"file": "dataset/reentrancy/0x01f8c4e3fa3edeb29e514cba738d87ce8c091d3f.sol", "line": 22, "column": 24}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "cabb602bcdc7", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "        if(intitalized)revert();\n        Log = LogFile(_log);", "highlightLines": [29]}, "category": "code", "location": {"file": "dataset/reentrancy/0x01f8c4e3fa3edeb29e514cba738d87ce8c091d3f.sol", "line": 29, "column": 24}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "b7ec859b6e61", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address Sender;", "highlightLines": [77]}, "category": "code", "location": {"file": "dataset/reentrancy/0x01f8c4e3fa3edeb29e514cba738d87ce8c091d3f.sol", "line": 77, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f6d8a9b54f40", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        string  Data;", "highlightLines": [78]}, "category": "code", "location": {"file": "dataset/reentrancy/0x01f8c4e3fa3edeb29e514cba738d87ce8c091d3f.sol", "line": 78, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "41399d3a0ba0", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint Val;", "highlightLines": [79]}, "category": "code", "location": {"file": "dataset/reentrancy/0x01f8c4e3fa3edeb29e514cba738d87ce8c091d3f.sol", "line": 79, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f1ab48136ad9", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint  Time;", "highlightLines": [80]}, "category": "code", "location": {"file": "dataset/reentrancy/0x01f8c4e3fa3edeb29e514cba738d87ce8c091d3f.sol", "line": 80, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "bb8f7c6d7f8e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Sender = _adr;\n        LastMsg.Time = now;", "highlightLines": [90]}, "category": "code", "location": {"file": "dataset/reentrancy/0x01f8c4e3fa3edeb29e514cba738d87ce8c091d3f.sol", "line": 90, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "5f8ebf8d7a06", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Time = now;\n        LastMsg.Val = _val;", "highlightLines": [91]}, "category": "code", "location": {"file": "dataset/reentrancy/0x01f8c4e3fa3edeb29e514cba738d87ce8c091d3f.sol", "line": 91, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e7e97c03ad13", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Val = _val;\n        LastMsg.Data = _data;", "highlightLines": [92]}, "category": "code", "location": {"file": "dataset/reentrancy/0x01f8c4e3fa3edeb29e514cba738d87ce8c091d3f.sol", "line": 92, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "c0c6fa649e31", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/0x23a91059fdc9579a9fbd0edc5f2ea0bfdb70deb4.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "76c8b1fd07d0", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/0x23a91059fdc9579a9fbd0edc5f2ea0bfdb70deb4.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "fa2eaa0e6422", "fix": {"template": null, "available": false}, "title": "SWC-118: Function name matches contract name - likely intended as constructor (pre-0.4.22)", "ruleId": "rules.sol-swc-118-constructor-mismatch", "snippet": {"code": "contract PrivateBank\n{\n    mapping (address => uint) public balances;\n    \n    uint public MinDeposit = 1 ether;\n    \n    Log TransferLog;\n    \n    function PrivateBank(address _log)", "highlightLines": [9]}, "category": "code", "location": {"file": "dataset/reentrancy/0x23a91059fdc9579a9fbd0edc5f2ea0bfdb70deb4.sol", "line": 9, "column": 1}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-118"], "description": ""}, {"id": "17e002d100c7", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function PrivateBank(address _log)\n    {\n        TransferLog = Log(_log);\n    }", "highlightLines": [17]}, "category": "code", "location": {"file": "dataset/reentrancy/0x23a91059fdc9579a9fbd0edc5f2ea0bfdb70deb4.sol", "line": 17, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "21e78066dba1", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function CashOut(uint _am)\n    {\n        if(_am<=balances[msg.sender])\n        {            \n            // <yes> <report> REENTRANCY\n            if(msg.sender.call.value(_am)())\n            {\n                balances[msg.sender]-=_am;\n                TransferLog.AddMessage(msg.sender,_am,\"CashOut\");\n            }\n        }\n    }", "highlightLines": [33]}, "category": "code", "location": {"file": "dataset/reentrancy/0x23a91059fdc9579a9fbd0edc5f2ea0bfdb70deb4.sol", "line": 33, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "fcc41c36362a", "fix": {"template": null, "available": false}, "title": "Function pointer stored in state variable - potential hijack target", "ruleId": "rules.sol-function-pointer-state", "snippet": {"code": "    function() public payable{}    \n    \n}\n\ncontract Log \n{\n   \n    struct Message\n    {\n        address Sender;", "highlightLines": [46]}, "category": "code", "location": {"file": "dataset/reentrancy/0x23a91059fdc9579a9fbd0edc5f2ea0bfdb70deb4.sol", "line": 46, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "e13445293097", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address Sender;", "highlightLines": [55]}, "category": "code", "location": {"file": "dataset/reentrancy/0x23a91059fdc9579a9fbd0edc5f2ea0bfdb70deb4.sol", "line": 55, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a68d1ec8db24", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        string  Data;", "highlightLines": [56]}, "category": "code", "location": {"file": "dataset/reentrancy/0x23a91059fdc9579a9fbd0edc5f2ea0bfdb70deb4.sol", "line": 56, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "912b6d786a3a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint Val;", "highlightLines": [57]}, "category": "code", "location": {"file": "dataset/reentrancy/0x23a91059fdc9579a9fbd0edc5f2ea0bfdb70deb4.sol", "line": 57, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "5668d7a7f314", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint  Time;", "highlightLines": [58]}, "category": "code", "location": {"file": "dataset/reentrancy/0x23a91059fdc9579a9fbd0edc5f2ea0bfdb70deb4.sol", "line": 58, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "eeb3b3552bc5", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Sender = _adr;\n        LastMsg.Time = now;", "highlightLines": [68]}, "category": "code", "location": {"file": "dataset/reentrancy/0x23a91059fdc9579a9fbd0edc5f2ea0bfdb70deb4.sol", "line": 68, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "3731ec521602", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Time = now;\n        LastMsg.Val = _val;", "highlightLines": [69]}, "category": "code", "location": {"file": "dataset/reentrancy/0x23a91059fdc9579a9fbd0edc5f2ea0bfdb70deb4.sol", "line": 69, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e790d3ea6bbf", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Val = _val;\n        LastMsg.Data = _data;", "highlightLines": [70]}, "category": "code", "location": {"file": "dataset/reentrancy/0x23a91059fdc9579a9fbd0edc5f2ea0bfdb70deb4.sol", "line": 70, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "0b508f6333fb", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [8]}, "category": "code", "location": {"file": "dataset/reentrancy/0x4320e6f8c05b27ab4707cd1f6d5ce6f3e4b3a5a1.sol", "line": 8, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "66ded1483a69", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [8]}, "category": "code", "location": {"file": "dataset/reentrancy/0x4320e6f8c05b27ab4707cd1f6d5ce6f3e4b3a5a1.sol", "line": 8, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "fd72f28d55e2", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    \n    bool intitalized;", "highlightLines": [17]}, "category": "code", "location": {"file": "dataset/reentrancy/0x4320e6f8c05b27ab4707cd1f6d5ce6f3e4b3a5a1.sol", "line": 17, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "6c13895ebd83", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "        if(intitalized)revert();\n        MinSum = _val;", "highlightLines": [23]}, "category": "code", "location": {"file": "dataset/reentrancy/0x4320e6f8c05b27ab4707cd1f6d5ce6f3e4b3a5a1.sol", "line": 23, "column": 24}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "bf022f6335d9", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "        if(intitalized)revert();\n        Log = LogFile(_log);", "highlightLines": [30]}, "category": "code", "location": {"file": "dataset/reentrancy/0x4320e6f8c05b27ab4707cd1f6d5ce6f3e4b3a5a1.sol", "line": 30, "column": 24}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "7d15ff4e15ea", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address Sender;", "highlightLines": [78]}, "category": "code", "location": {"file": "dataset/reentrancy/0x4320e6f8c05b27ab4707cd1f6d5ce6f3e4b3a5a1.sol", "line": 78, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "490e62e048b2", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        string  Data;", "highlightLines": [79]}, "category": "code", "location": {"file": "dataset/reentrancy/0x4320e6f8c05b27ab4707cd1f6d5ce6f3e4b3a5a1.sol", "line": 79, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "2685d064b4a2", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint Val;", "highlightLines": [80]}, "category": "code", "location": {"file": "dataset/reentrancy/0x4320e6f8c05b27ab4707cd1f6d5ce6f3e4b3a5a1.sol", "line": 80, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4caed18c2dc9", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint  Time;", "highlightLines": [81]}, "category": "code", "location": {"file": "dataset/reentrancy/0x4320e6f8c05b27ab4707cd1f6d5ce6f3e4b3a5a1.sol", "line": 81, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "9697cae7d54d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Sender = _adr;\n        LastMsg.Time = now;", "highlightLines": [91]}, "category": "code", "location": {"file": "dataset/reentrancy/0x4320e6f8c05b27ab4707cd1f6d5ce6f3e4b3a5a1.sol", "line": 91, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "6e301f843823", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Time = now;\n        LastMsg.Val = _val;", "highlightLines": [92]}, "category": "code", "location": {"file": "dataset/reentrancy/0x4320e6f8c05b27ab4707cd1f6d5ce6f3e4b3a5a1.sol", "line": 92, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "50b47cdea3d8", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Val = _val;\n        LastMsg.Data = _data;", "highlightLines": [93]}, "category": "code", "location": {"file": "dataset/reentrancy/0x4320e6f8c05b27ab4707cd1f6d5ce6f3e4b3a5a1.sol", "line": 93, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "94daad51a24f", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "d61531f08d98", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "c9b5ff145460", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    \n    bool intitalized;", "highlightLines": [16]}, "category": "code", "location": {"file": "dataset/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "line": 16, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ead0cac6c5ea", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(!intitalized);", "highlightLines": [22]}, "category": "code", "location": {"file": "dataset/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "line": 22, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "bdf105bd854c", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(!intitalized);", "highlightLines": [29]}, "category": "code", "location": {"file": "dataset/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "line": 29, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "d1516698df63", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address Sender;", "highlightLines": [77]}, "category": "code", "location": {"file": "dataset/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "line": 77, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "5087086f39c6", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        string  Data;", "highlightLines": [78]}, "category": "code", "location": {"file": "dataset/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "line": 78, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "abdc22257836", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint Val;", "highlightLines": [79]}, "category": "code", "location": {"file": "dataset/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "line": 79, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "18c2ccd66796", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint  Time;", "highlightLines": [80]}, "category": "code", "location": {"file": "dataset/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "line": 80, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d65af7f45280", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Sender = _adr;\n        LastMsg.Time = now;", "highlightLines": [90]}, "category": "code", "location": {"file": "dataset/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "line": 90, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "8215a93363cd", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Time = now;\n        LastMsg.Val = _val;", "highlightLines": [91]}, "category": "code", "location": {"file": "dataset/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "line": 91, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "dc409f4f0a7a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Val = _val;\n        LastMsg.Data = _data;", "highlightLines": [92]}, "category": "code", "location": {"file": "dataset/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "line": 92, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "7fd7f642dd25", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "9ce60fe8ad6a", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "9669ab027b06", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    \n    bool intitalized;", "highlightLines": [16]}, "category": "code", "location": {"file": "dataset/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "line": 16, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "68497e30532b", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "        if(intitalized)throw;\n        MinSum = _val;", "highlightLines": [22]}, "category": "code", "location": {"file": "dataset/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "line": 22, "column": 24}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "b4a60607cb35", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "        if(intitalized)throw;\n        Log = LogFile(_log);", "highlightLines": [29]}, "category": "code", "location": {"file": "dataset/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "line": 29, "column": 24}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "d27391058d8a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address Sender;", "highlightLines": [77]}, "category": "code", "location": {"file": "dataset/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "line": 77, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "df7d1c20f8fe", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        string  Data;", "highlightLines": [78]}, "category": "code", "location": {"file": "dataset/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "line": 78, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a320fbebe68d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint Val;", "highlightLines": [79]}, "category": "code", "location": {"file": "dataset/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "line": 79, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "5e93c2e568aa", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint  Time;", "highlightLines": [80]}, "category": "code", "location": {"file": "dataset/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "line": 80, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "412199d9e66e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Sender = _adr;\n        LastMsg.Time = now;", "highlightLines": [90]}, "category": "code", "location": {"file": "dataset/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "line": 90, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d474687a195b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Time = now;\n        LastMsg.Val = _val;", "highlightLines": [91]}, "category": "code", "location": {"file": "dataset/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "line": 91, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "9bd3e0046229", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Val = _val;\n        LastMsg.Data = _data;", "highlightLines": [92]}, "category": "code", "location": {"file": "dataset/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "line": 92, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "4ad14fc5275b", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/0x627fa62ccbb1c1b04ffaecd72a53e37fc0e17839.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "c83ee77b6cd0", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/0x627fa62ccbb1c1b04ffaecd72a53e37fc0e17839.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "eec8097eb32a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address newOwner;", "highlightLines": [11]}, "category": "code", "location": {"file": "dataset/reentrancy/0x627fa62ccbb1c1b04ffaecd72a53e37fc0e17839.sol", "line": 11, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ccfe640627ba", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address owner = msg.sender;", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/reentrancy/0x627fa62ccbb1c1b04ffaecd72a53e37fc0e17839.sol", "line": 12, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "af74b62b5cec", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "    address owner = msg.sender;", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/reentrancy/0x627fa62ccbb1c1b04ffaecd72a53e37fc0e17839.sol", "line": 12, "column": 5}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "b69a7fdbec4f", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "    address owner = msg.sender;", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/reentrancy/0x627fa62ccbb1c1b04ffaecd72a53e37fc0e17839.sol", "line": 12, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "8ba1b7b17192", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    onlyOwner", "highlightLines": [16]}, "category": "code", "location": {"file": "dataset/reentrancy/0x627fa62ccbb1c1b04ffaecd72a53e37fc0e17839.sol", "line": 16, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "416de6931c41", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "            owner=newOwner;", "highlightLines": [26]}, "category": "code", "location": {"file": "dataset/reentrancy/0x627fa62ccbb1c1b04ffaecd72a53e37fc0e17839.sol", "line": 26, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "376c19c23790", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyOwner\n    {\n        if(owner == msg.sender)_;\n    }", "highlightLines": [30]}, "category": "code", "location": {"file": "dataset/reentrancy/0x627fa62ccbb1c1b04ffaecd72a53e37fc0e17839.sol", "line": 30, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "fe2bd7c3958b", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract Token is Ownable\n{\n    address owner = msg.sender;", "highlightLines": [36]}, "category": "code", "location": {"file": "dataset/reentrancy/0x627fa62ccbb1c1b04ffaecd72a53e37fc0e17839.sol", "line": 36, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "ec89abfa3c5b", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address owner = msg.sender;", "highlightLines": [38]}, "category": "code", "location": {"file": "dataset/reentrancy/0x627fa62ccbb1c1b04ffaecd72a53e37fc0e17839.sol", "line": 38, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d3620c664fb3", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "    address owner = msg.sender;", "highlightLines": [38]}, "category": "code", "location": {"file": "dataset/reentrancy/0x627fa62ccbb1c1b04ffaecd72a53e37fc0e17839.sol", "line": 38, "column": 5}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "8230494c1b51", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "    address owner = msg.sender;", "highlightLines": [38]}, "category": "code", "location": {"file": "dataset/reentrancy/0x627fa62ccbb1c1b04ffaecd72a53e37fc0e17839.sol", "line": 38, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "3edc566b001f", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    onlyOwner", "highlightLines": [41]}, "category": "code", "location": {"file": "dataset/reentrancy/0x627fa62ccbb1c1b04ffaecd72a53e37fc0e17839.sol", "line": 41, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "c89e34bb0dad", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "        token.call(bytes4(sha3(\"transfer(address,uint256)\")),to,amount);", "highlightLines": [43]}, "category": "code", "location": {"file": "dataset/reentrancy/0x627fa62ccbb1c1b04ffaecd72a53e37fc0e17839.sol", "line": 43, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "372f0d9649e8", "fix": {"template": null, "available": false}, "title": "sha3() is deprecated - use keccak256() instead", "ruleId": "rules.sol-deprecated-sha3", "snippet": {"code": "        token.call(bytes4(sha3(\"transfer(address,uint256)\")),to,amount);", "highlightLines": [43]}, "category": "code", "location": {"file": "dataset/reentrancy/0x627fa62ccbb1c1b04ffaecd72a53e37fc0e17839.sol", "line": 43, "column": 27}, "severity": "info", "references": [], "description": ""}, {"id": "4071bfb7cd56", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract TokenBank is Token\n{\n    uint public MinDeposit;", "highlightLines": [47]}, "category": "code", "location": {"file": "dataset/reentrancy/0x627fa62ccbb1c1b04ffaecd72a53e37fc0e17839.sol", "line": 47, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "86f6d522a718", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        owner = msg.sender;", "highlightLines": [56]}, "category": "code", "location": {"file": "dataset/reentrancy/0x627fa62ccbb1c1b04ffaecd72a53e37fc0e17839.sol", "line": 56, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "720c83ab3507", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        owner = msg.sender;\n        MinDeposit = 1 ether;", "highlightLines": [56]}, "category": "code", "location": {"file": "dataset/reentrancy/0x627fa62ccbb1c1b04ffaecd72a53e37fc0e17839.sol", "line": 56, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "546bc7583e2c", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function()\n    payable\n    {\n        Deposit();\n    }", "highlightLines": [60]}, "category": "code", "location": {"file": "dataset/reentrancy/0x627fa62ccbb1c1b04ffaecd72a53e37fc0e17839.sol", "line": 60, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "350ca7ce3001", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function Deposit() \n    payable\n    {\n        if(msg.value>MinDeposit)\n        {\n            Holders[msg.sender]+=msg.value;\n        }\n    }", "highlightLines": [66]}, "category": "code", "location": {"file": "dataset/reentrancy/0x627fa62ccbb1c1b04ffaecd72a53e37fc0e17839.sol", "line": 66, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "f9f776c5a60c", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    onlyOwner", "highlightLines": [77]}, "category": "code", "location": {"file": "dataset/reentrancy/0x627fa62ccbb1c1b04ffaecd72a53e37fc0e17839.sol", "line": 77, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "ce2413c34640", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    onlyOwner", "highlightLines": [88]}, "category": "code", "location": {"file": "dataset/reentrancy/0x627fa62ccbb1c1b04ffaecd72a53e37fc0e17839.sol", "line": 88, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "6561ae691fcf", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.25;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7541b76cb60f4c60af330c208b0623b7f54bf615.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "f9d54f18d378", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.25;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7541b76cb60f4c60af330c208b0623b7f54bf615.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "0fd0cf61e3a1", "fix": {"template": null, "available": false}, "title": "Deprecated 'var' keyword can cause type confusion - resolves to smallest type (e.g., uint8 in loops)", "ruleId": "rules.sol-deprecated-var-keyword", "snippet": {"code": "        var acc = Acc[msg.sender];", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7541b76cb60f4c60af330c208b0623b7f54bf615.sol", "line": 15, "column": 9}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/honeypots"], "description": ""}, {"id": "554b475dd2ba", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        var acc = Acc[msg.sender];\n        acc.balance += msg.value;\n        acc.unlockTime = _unlockTime>now?_unlockTime:now;", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7541b76cb60f4c60af330c208b0623b7f54bf615.sol", "line": 15, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "61b19ddb173c", "fix": {"template": null, "available": false}, "title": "Deprecated 'var' keyword can cause type confusion - resolves to smallest type (e.g., uint8 in loops)", "ruleId": "rules.sol-deprecated-var-keyword", "snippet": {"code": "        var acc = Acc[msg.sender];", "highlightLines": [25]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7541b76cb60f4c60af330c208b0623b7f54bf615.sol", "line": 25, "column": 9}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/honeypots"], "description": ""}, {"id": "b1b769675b4b", "fix": {"template": null, "available": false}, "title": "Block timestamp used for critical logic - miners can manipulate within ~15 second window", "ruleId": "rules.sol-block-timestamp-manipulation", "snippet": {"code": "        if( acc.balance>=MinSum && acc.balance>=_am && now>acc.unlockTime)", "highlightLines": [26]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7541b76cb60f4c60af330c208b0623b7f54bf615.sol", "line": 26, "column": 56}, "severity": "medium", "references": ["https://consensys.github.io/smart-contract-best-practices/development-recommendations/solidity-specific/timestamp-dependence/"], "description": ""}, {"id": "be443c37c8d0", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint unlockTime;", "highlightLines": [46]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7541b76cb60f4c60af330c208b0623b7f54bf615.sol", "line": 46, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "eb792072c0d5", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint balance;", "highlightLines": [47]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7541b76cb60f4c60af330c208b0623b7f54bf615.sol", "line": 47, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7501f4f107f7", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "        uint balance;", "highlightLines": [47]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7541b76cb60f4c60af330c208b0623b7f54bf615.sol", "line": 47, "column": 9}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "8c1eda1a7c4b", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address Sender;", "highlightLines": [66]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7541b76cb60f4c60af330c208b0623b7f54bf615.sol", "line": 66, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ea16fba66d50", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        string  Data;", "highlightLines": [67]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7541b76cb60f4c60af330c208b0623b7f54bf615.sol", "line": 67, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3a440a4713f3", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint Val;", "highlightLines": [68]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7541b76cb60f4c60af330c208b0623b7f54bf615.sol", "line": 68, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d56a90d24b92", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint  Time;", "highlightLines": [69]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7541b76cb60f4c60af330c208b0623b7f54bf615.sol", "line": 69, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "36ddfbb49483", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Sender = _adr;\n        LastMsg.Time = now;", "highlightLines": [79]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7541b76cb60f4c60af330c208b0623b7f54bf615.sol", "line": 79, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "eeef7aa55994", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Time = now;\n        LastMsg.Val = _val;", "highlightLines": [80]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7541b76cb60f4c60af330c208b0623b7f54bf615.sol", "line": 80, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "32ac37871a30", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Val = _val;\n        LastMsg.Data = _data;", "highlightLines": [81]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7541b76cb60f4c60af330c208b0623b7f54bf615.sol", "line": 81, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "c0911da5ec45", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7a8721a9d64c74da899424c1b52acbf58ddc9782.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "93eee4a27ee0", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7a8721a9d64c74da899424c1b52acbf58ddc9782.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "aa1247d1004d", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyOwner() {\n        require(tx.origin == owner);\n        _;\n    }", "highlightLines": [18]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7a8721a9d64c74da899424c1b52acbf58ddc9782.sol", "line": 18, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "ef7255a7a7b6", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "    modifier onlyOwner() {\n        require(tx.origin == owner);\n        _;\n    }", "highlightLines": [18]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7a8721a9d64c74da899424c1b52acbf58ddc9782.sol", "line": 18, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "19e6bd6faccc", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(tx.origin == owner);", "highlightLines": [19]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7a8721a9d64c74da899424c1b52acbf58ddc9782.sol", "line": 19, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "0eb300693d7b", "fix": {"template": null, "available": false}, "title": "tx.origin used for authorization - vulnerable to phishing attacks", "ruleId": "rules.sol-tx-origin-auth", "snippet": {"code": "        require(tx.origin == owner);", "highlightLines": [19]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7a8721a9d64c74da899424c1b52acbf58ddc9782.sol", "line": 19, "column": 9}, "severity": "high", "references": [], "description": ""}, {"id": "b13423025b17", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [20]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7a8721a9d64c74da899424c1b52acbf58ddc9782.sol", "line": 20, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "9a997dc124ba", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function PrivateDeposit()\n    {\n        owner = msg.sender;\n        TransferLog = new Log();\n    }", "highlightLines": [23]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7a8721a9d64c74da899424c1b52acbf58ddc9782.sol", "line": 23, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "74eb872cce1b", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        owner = msg.sender;", "highlightLines": [25]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7a8721a9d64c74da899424c1b52acbf58ddc9782.sol", "line": 25, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "983f465b6e11", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        owner = msg.sender;\n        TransferLog = new Log();", "highlightLines": [25]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7a8721a9d64c74da899424c1b52acbf58ddc9782.sol", "line": 25, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e43aa3a04763", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        TransferLog = new Log();", "highlightLines": [26]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7a8721a9d64c74da899424c1b52acbf58ddc9782.sol", "line": 26, "column": 23}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "b1808e46e93e", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function setLog(address _lib) onlyOwner\n    {\n        TransferLog = Log(_lib);\n    }", "highlightLines": [31]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7a8721a9d64c74da899424c1b52acbf58ddc9782.sol", "line": 31, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "0347fc1891fd", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function setLog(address _lib) onlyOwner", "highlightLines": [31]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7a8721a9d64c74da899424c1b52acbf58ddc9782.sol", "line": 31, "column": 35}, "severity": "info", "references": [], "description": ""}, {"id": "64a9d6b831a1", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function CashOut(uint _am)\n    {\n        if(_am<=balances[msg.sender])\n        {            \n            // <yes> <report> REENTRANCY\n            if(msg.sender.call.value(_am)())\n            {\n                balances[msg.sender]-=_am;\n                TransferLog.AddMessage(msg.sender,_am,\"CashOut\");\n            }\n        }\n    }", "highlightLines": [47]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7a8721a9d64c74da899424c1b52acbf58ddc9782.sol", "line": 47, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "a31ab2102cba", "fix": {"template": null, "available": false}, "title": "Function pointer stored in state variable - potential hijack target", "ruleId": "rules.sol-function-pointer-state", "snippet": {"code": "    function() public payable{}    \n    \n}\n\ncontract Log \n{\n   \n    struct Message\n    {\n        address Sender;", "highlightLines": [60]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7a8721a9d64c74da899424c1b52acbf58ddc9782.sol", "line": 60, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "3551d0341586", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address Sender;", "highlightLines": [69]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7a8721a9d64c74da899424c1b52acbf58ddc9782.sol", "line": 69, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "392cf39aad62", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        string  Data;", "highlightLines": [70]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7a8721a9d64c74da899424c1b52acbf58ddc9782.sol", "line": 70, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "268c52c25e0a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint Val;", "highlightLines": [71]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7a8721a9d64c74da899424c1b52acbf58ddc9782.sol", "line": 71, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "fe5df8054c77", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint  Time;", "highlightLines": [72]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7a8721a9d64c74da899424c1b52acbf58ddc9782.sol", "line": 72, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "6b51c597aeeb", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Sender = _adr;\n        LastMsg.Time = now;", "highlightLines": [82]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7a8721a9d64c74da899424c1b52acbf58ddc9782.sol", "line": 82, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "bfbb36a410ea", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Time = now;\n        LastMsg.Val = _val;", "highlightLines": [83]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7a8721a9d64c74da899424c1b52acbf58ddc9782.sol", "line": 83, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "35063c3f0174", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Val = _val;\n        LastMsg.Data = _data;", "highlightLines": [84]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7a8721a9d64c74da899424c1b52acbf58ddc9782.sol", "line": 84, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "179d5e28f7d1", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.25;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7b368c4e805c3870b6c49a3f1f49f69af8662cf3.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "14b4ee94dc15", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.25;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7b368c4e805c3870b6c49a3f1f49f69af8662cf3.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "0571c6784c02", "fix": {"template": null, "available": false}, "title": "Deprecated 'var' keyword can cause type confusion - resolves to smallest type (e.g., uint8 in loops)", "ruleId": "rules.sol-deprecated-var-keyword", "snippet": {"code": "        var acc = Acc[msg.sender];", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7b368c4e805c3870b6c49a3f1f49f69af8662cf3.sol", "line": 15, "column": 9}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/honeypots"], "description": ""}, {"id": "18c1d02a1369", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        var acc = Acc[msg.sender];\n        acc.balance += msg.value;\n        acc.unlockTime = _unlockTime>now?_unlockTime:now;", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7b368c4e805c3870b6c49a3f1f49f69af8662cf3.sol", "line": 15, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "fc31e22e1419", "fix": {"template": null, "available": false}, "title": "Deprecated 'var' keyword can cause type confusion - resolves to smallest type (e.g., uint8 in loops)", "ruleId": "rules.sol-deprecated-var-keyword", "snippet": {"code": "        var acc = Acc[msg.sender];", "highlightLines": [25]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7b368c4e805c3870b6c49a3f1f49f69af8662cf3.sol", "line": 25, "column": 9}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/honeypots"], "description": ""}, {"id": "ede6593bb31d", "fix": {"template": null, "available": false}, "title": "Block timestamp used for critical logic - miners can manipulate within ~15 second window", "ruleId": "rules.sol-block-timestamp-manipulation", "snippet": {"code": "        if( acc.balance>=MinSum && acc.balance>=_am && now>acc.unlockTime)", "highlightLines": [26]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7b368c4e805c3870b6c49a3f1f49f69af8662cf3.sol", "line": 26, "column": 56}, "severity": "medium", "references": ["https://consensys.github.io/smart-contract-best-practices/development-recommendations/solidity-specific/timestamp-dependence/"], "description": ""}, {"id": "16804735de47", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint unlockTime;", "highlightLines": [46]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7b368c4e805c3870b6c49a3f1f49f69af8662cf3.sol", "line": 46, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "922410f2f882", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint balance;", "highlightLines": [47]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7b368c4e805c3870b6c49a3f1f49f69af8662cf3.sol", "line": 47, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d924e64a6c45", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "        uint balance;", "highlightLines": [47]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7b368c4e805c3870b6c49a3f1f49f69af8662cf3.sol", "line": 47, "column": 9}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "4e7cbf068cd8", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address Sender;", "highlightLines": [66]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7b368c4e805c3870b6c49a3f1f49f69af8662cf3.sol", "line": 66, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "61e95d84e731", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        string  Data;", "highlightLines": [67]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7b368c4e805c3870b6c49a3f1f49f69af8662cf3.sol", "line": 67, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d9f3313bc918", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint Val;", "highlightLines": [68]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7b368c4e805c3870b6c49a3f1f49f69af8662cf3.sol", "line": 68, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "427f2fbec9d5", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint  Time;", "highlightLines": [69]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7b368c4e805c3870b6c49a3f1f49f69af8662cf3.sol", "line": 69, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a5f3489238c4", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Sender = _adr;\n        LastMsg.Time = now;", "highlightLines": [79]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7b368c4e805c3870b6c49a3f1f49f69af8662cf3.sol", "line": 79, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "c88b9375dc3f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Time = now;\n        LastMsg.Val = _val;", "highlightLines": [80]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7b368c4e805c3870b6c49a3f1f49f69af8662cf3.sol", "line": 80, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e9b6386feead", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Val = _val;\n        LastMsg.Data = _data;", "highlightLines": [81]}, "category": "code", "location": {"file": "dataset/reentrancy/0x7b368c4e805c3870b6c49a3f1f49f69af8662cf3.sol", "line": 81, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "481bb7c074ca", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/0x8c7777c45481dba411450c228cb692ac3d550344.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "f17a3cfa95dc", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/0x8c7777c45481dba411450c228cb692ac3d550344.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "a2b906c8a2d3", "fix": {"template": null, "available": false}, "title": "SWC-118: Function name matches contract name - likely intended as constructor (pre-0.4.22)", "ruleId": "rules.sol-swc-118-constructor-mismatch", "snippet": {"code": "contract ETH_VAULT\n{\n    mapping (address => uint) public balances;\n    \n    Log TransferLog;\n    \n    uint public MinDeposit = 1 ether;\n    \n    function ETH_VAULT(address _log)", "highlightLines": [9]}, "category": "code", "location": {"file": "dataset/reentrancy/0x8c7777c45481dba411450c228cb692ac3d550344.sol", "line": 9, "column": 1}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-118"], "description": ""}, {"id": "2b1efed8e1a7", "fix": {"template": null, "available": false}, "title": "Function pointer stored in state variable - potential hijack target", "ruleId": "rules.sol-function-pointer-state", "snippet": {"code": "    function() public payable{}    \n    \n}\n\ncontract Log \n{\n   \n    struct Message\n    {\n        address Sender;", "highlightLines": [49]}, "category": "code", "location": {"file": "dataset/reentrancy/0x8c7777c45481dba411450c228cb692ac3d550344.sol", "line": 49, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "cbfded3d0092", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address Sender;", "highlightLines": [58]}, "category": "code", "location": {"file": "dataset/reentrancy/0x8c7777c45481dba411450c228cb692ac3d550344.sol", "line": 58, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "1aece0b7de5e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        string  Data;", "highlightLines": [59]}, "category": "code", "location": {"file": "dataset/reentrancy/0x8c7777c45481dba411450c228cb692ac3d550344.sol", "line": 59, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "2e1f3c4c50f1", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint Val;", "highlightLines": [60]}, "category": "code", "location": {"file": "dataset/reentrancy/0x8c7777c45481dba411450c228cb692ac3d550344.sol", "line": 60, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e13661766c5c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint  Time;", "highlightLines": [61]}, "category": "code", "location": {"file": "dataset/reentrancy/0x8c7777c45481dba411450c228cb692ac3d550344.sol", "line": 61, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "599f01677ba3", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Sender = _adr;\n        LastMsg.Time = now;", "highlightLines": [71]}, "category": "code", "location": {"file": "dataset/reentrancy/0x8c7777c45481dba411450c228cb692ac3d550344.sol", "line": 71, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "5d16565585a3", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Time = now;\n        LastMsg.Val = _val;", "highlightLines": [72]}, "category": "code", "location": {"file": "dataset/reentrancy/0x8c7777c45481dba411450c228cb692ac3d550344.sol", "line": 72, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "eb94365988a7", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Val = _val;\n        LastMsg.Data = _data;", "highlightLines": [73]}, "category": "code", "location": {"file": "dataset/reentrancy/0x8c7777c45481dba411450c228cb692ac3d550344.sol", "line": 73, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "0ed3416595b0", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.25;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/0x93c32845fae42c83a70e5f06214c8433665c2ab5.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "cefcbe4904ed", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.25;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/0x93c32845fae42c83a70e5f06214c8433665c2ab5.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "76e48260baea", "fix": {"template": null, "available": false}, "title": "Deprecated 'var' keyword can cause type confusion - resolves to smallest type (e.g., uint8 in loops)", "ruleId": "rules.sol-deprecated-var-keyword", "snippet": {"code": "        var acc = Acc[msg.sender];", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/reentrancy/0x93c32845fae42c83a70e5f06214c8433665c2ab5.sol", "line": 15, "column": 9}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/honeypots"], "description": ""}, {"id": "b74c07fa9290", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        var acc = Acc[msg.sender];\n        acc.balance += msg.value;\n        acc.unlockTime = _unlockTime>now?_unlockTime:now;", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/reentrancy/0x93c32845fae42c83a70e5f06214c8433665c2ab5.sol", "line": 15, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "20f7a1875688", "fix": {"template": null, "available": false}, "title": "Deprecated 'var' keyword can cause type confusion - resolves to smallest type (e.g., uint8 in loops)", "ruleId": "rules.sol-deprecated-var-keyword", "snippet": {"code": "        var acc = Acc[msg.sender];", "highlightLines": [25]}, "category": "code", "location": {"file": "dataset/reentrancy/0x93c32845fae42c83a70e5f06214c8433665c2ab5.sol", "line": 25, "column": 9}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/honeypots"], "description": ""}, {"id": "d4245a03f582", "fix": {"template": null, "available": false}, "title": "Block timestamp used for critical logic - miners can manipulate within ~15 second window", "ruleId": "rules.sol-block-timestamp-manipulation", "snippet": {"code": "        if( acc.balance>=MinSum && acc.balance>=_am && now>acc.unlockTime)", "highlightLines": [26]}, "category": "code", "location": {"file": "dataset/reentrancy/0x93c32845fae42c83a70e5f06214c8433665c2ab5.sol", "line": 26, "column": 56}, "severity": "medium", "references": ["https://consensys.github.io/smart-contract-best-practices/development-recommendations/solidity-specific/timestamp-dependence/"], "description": ""}, {"id": "ada810cbb334", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint unlockTime;", "highlightLines": [46]}, "category": "code", "location": {"file": "dataset/reentrancy/0x93c32845fae42c83a70e5f06214c8433665c2ab5.sol", "line": 46, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "6ab732e54271", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint balance;", "highlightLines": [47]}, "category": "code", "location": {"file": "dataset/reentrancy/0x93c32845fae42c83a70e5f06214c8433665c2ab5.sol", "line": 47, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "9095bf710e17", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "        uint balance;", "highlightLines": [47]}, "category": "code", "location": {"file": "dataset/reentrancy/0x93c32845fae42c83a70e5f06214c8433665c2ab5.sol", "line": 47, "column": 9}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "f898e85a228d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address Sender;", "highlightLines": [66]}, "category": "code", "location": {"file": "dataset/reentrancy/0x93c32845fae42c83a70e5f06214c8433665c2ab5.sol", "line": 66, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8e94d1069abc", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        string  Data;", "highlightLines": [67]}, "category": "code", "location": {"file": "dataset/reentrancy/0x93c32845fae42c83a70e5f06214c8433665c2ab5.sol", "line": 67, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "6895183ca374", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint Val;", "highlightLines": [68]}, "category": "code", "location": {"file": "dataset/reentrancy/0x93c32845fae42c83a70e5f06214c8433665c2ab5.sol", "line": 68, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c521071d0a95", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint  Time;", "highlightLines": [69]}, "category": "code", "location": {"file": "dataset/reentrancy/0x93c32845fae42c83a70e5f06214c8433665c2ab5.sol", "line": 69, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "51a856a45785", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Sender = _adr;\n        LastMsg.Time = now;", "highlightLines": [79]}, "category": "code", "location": {"file": "dataset/reentrancy/0x93c32845fae42c83a70e5f06214c8433665c2ab5.sol", "line": 79, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "2bcd4b037d54", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Time = now;\n        LastMsg.Val = _val;", "highlightLines": [80]}, "category": "code", "location": {"file": "dataset/reentrancy/0x93c32845fae42c83a70e5f06214c8433665c2ab5.sol", "line": 80, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "678e811232ed", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Val = _val;\n        LastMsg.Data = _data;", "highlightLines": [81]}, "category": "code", "location": {"file": "dataset/reentrancy/0x93c32845fae42c83a70e5f06214c8433665c2ab5.sol", "line": 81, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "87ae37c8d8e4", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/0x941d225236464a25eb18076df7da6a91d0f95e9e.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "75065760320e", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/0x941d225236464a25eb18076df7da6a91d0f95e9e.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "ca113d86f8aa", "fix": {"template": null, "available": false}, "title": "SWC-118: Function name matches contract name - likely intended as constructor (pre-0.4.22)", "ruleId": "rules.sol-swc-118-constructor-mismatch", "snippet": {"code": "contract ETH_FUND\n{\n    mapping (address => uint) public balances;\n    \n    uint public MinDeposit = 1 ether;\n    \n    Log TransferLog;\n    \n    uint lastBlock;\n    \n    function ETH_FUND(address _log)", "highlightLines": [9]}, "category": "code", "location": {"file": "dataset/reentrancy/0x941d225236464a25eb18076df7da6a91d0f95e9e.sol", "line": 9, "column": 1}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-118"], "description": ""}, {"id": "6af889c40d93", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    \n    uint lastBlock;", "highlightLines": [16]}, "category": "code", "location": {"file": "dataset/reentrancy/0x941d225236464a25eb18076df7da6a91d0f95e9e.sol", "line": 16, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8ed8f928064c", "fix": {"template": null, "available": false}, "title": "Function pointer stored in state variable - potential hijack target", "ruleId": "rules.sol-function-pointer-state", "snippet": {"code": "    function() public payable{}    \n    \n}\n\ncontract Log \n{\n   \n    struct Message\n    {\n        address Sender;", "highlightLines": [52]}, "category": "code", "location": {"file": "dataset/reentrancy/0x941d225236464a25eb18076df7da6a91d0f95e9e.sol", "line": 52, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "ce621020321f", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address Sender;", "highlightLines": [61]}, "category": "code", "location": {"file": "dataset/reentrancy/0x941d225236464a25eb18076df7da6a91d0f95e9e.sol", "line": 61, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7db9b7b50b8d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        string  Data;", "highlightLines": [62]}, "category": "code", "location": {"file": "dataset/reentrancy/0x941d225236464a25eb18076df7da6a91d0f95e9e.sol", "line": 62, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0345cb7dbe27", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint Val;", "highlightLines": [63]}, "category": "code", "location": {"file": "dataset/reentrancy/0x941d225236464a25eb18076df7da6a91d0f95e9e.sol", "line": 63, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "136b40fe1555", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint  Time;", "highlightLines": [64]}, "category": "code", "location": {"file": "dataset/reentrancy/0x941d225236464a25eb18076df7da6a91d0f95e9e.sol", "line": 64, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3f4607fcbc49", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Sender = _adr;\n        LastMsg.Time = now;", "highlightLines": [74]}, "category": "code", "location": {"file": "dataset/reentrancy/0x941d225236464a25eb18076df7da6a91d0f95e9e.sol", "line": 74, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "90ad87a1f604", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Time = now;\n        LastMsg.Val = _val;", "highlightLines": [75]}, "category": "code", "location": {"file": "dataset/reentrancy/0x941d225236464a25eb18076df7da6a91d0f95e9e.sol", "line": 75, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "3996ca414ab2", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Val = _val;\n        LastMsg.Data = _data;", "highlightLines": [76]}, "category": "code", "location": {"file": "dataset/reentrancy/0x941d225236464a25eb18076df7da6a91d0f95e9e.sol", "line": 76, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "ed23c533c599", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/0x96edbe868531bd23a6c05e9d0c424ea64fb1b78b.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "e2d3d49c168c", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/0x96edbe868531bd23a6c05e9d0c424ea64fb1b78b.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "52830652ab07", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint unlockTime;", "highlightLines": [13]}, "category": "code", "location": {"file": "dataset/reentrancy/0x96edbe868531bd23a6c05e9d0c424ea64fb1b78b.sol", "line": 13, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "1b4d0a00f6ff", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint balance;", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/reentrancy/0x96edbe868531bd23a6c05e9d0c424ea64fb1b78b.sol", "line": 14, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "9c1e91f06404", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "        uint balance;", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/reentrancy/0x96edbe868531bd23a6c05e9d0c424ea64fb1b78b.sol", "line": 14, "column": 9}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "3c3da2032a87", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    \n    bool intitalized;", "highlightLines": [22]}, "category": "code", "location": {"file": "dataset/reentrancy/0x96edbe868531bd23a6c05e9d0c424ea64fb1b78b.sol", "line": 22, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "9242a1d115c3", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "        if(intitalized)throw;\n        MinSum = _val;", "highlightLines": [28]}, "category": "code", "location": {"file": "dataset/reentrancy/0x96edbe868531bd23a6c05e9d0c424ea64fb1b78b.sol", "line": 28, "column": 24}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "0a9a1c48a529", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "        if(intitalized)throw;\n        Log = LogFile(_log);", "highlightLines": [35]}, "category": "code", "location": {"file": "dataset/reentrancy/0x96edbe868531bd23a6c05e9d0c424ea64fb1b78b.sol", "line": 35, "column": 24}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "cc7be5985087", "fix": {"template": null, "available": false}, "title": "Deprecated 'var' keyword can cause type confusion - resolves to smallest type (e.g., uint8 in loops)", "ruleId": "rules.sol-deprecated-var-keyword", "snippet": {"code": "        var acc = Acc[msg.sender];", "highlightLines": [49]}, "category": "code", "location": {"file": "dataset/reentrancy/0x96edbe868531bd23a6c05e9d0c424ea64fb1b78b.sol", "line": 49, "column": 9}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/honeypots"], "description": ""}, {"id": "53321fb5bffe", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        var acc = Acc[msg.sender];\n        acc.balance += msg.value;\n        if(now+_lockTime>acc.unlockTime)acc.unlockTime=now+_lockTime;", "highlightLines": [49]}, "category": "code", "location": {"file": "dataset/reentrancy/0x96edbe868531bd23a6c05e9d0c424ea64fb1b78b.sol", "line": 49, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "b9c0a435461f", "fix": {"template": null, "available": false}, "title": "Deprecated 'var' keyword can cause type confusion - resolves to smallest type (e.g., uint8 in loops)", "ruleId": "rules.sol-deprecated-var-keyword", "snippet": {"code": "        var acc = Acc[msg.sender];", "highlightLines": [59]}, "category": "code", "location": {"file": "dataset/reentrancy/0x96edbe868531bd23a6c05e9d0c424ea64fb1b78b.sol", "line": 59, "column": 9}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/honeypots"], "description": ""}, {"id": "dd65983199fb", "fix": {"template": null, "available": false}, "title": "Block timestamp used for critical logic - miners can manipulate within ~15 second window", "ruleId": "rules.sol-block-timestamp-manipulation", "snippet": {"code": "        if( acc.balance>=MinSum && acc.balance>=_am && now>acc.unlockTime)", "highlightLines": [60]}, "category": "code", "location": {"file": "dataset/reentrancy/0x96edbe868531bd23a6c05e9d0c424ea64fb1b78b.sol", "line": 60, "column": 56}, "severity": "medium", "references": ["https://consensys.github.io/smart-contract-best-practices/development-recommendations/solidity-specific/timestamp-dependence/"], "description": ""}, {"id": "aa5156f1b363", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address Sender;", "highlightLines": [85]}, "category": "code", "location": {"file": "dataset/reentrancy/0x96edbe868531bd23a6c05e9d0c424ea64fb1b78b.sol", "line": 85, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b8c26262c0d6", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        string  Data;", "highlightLines": [86]}, "category": "code", "location": {"file": "dataset/reentrancy/0x96edbe868531bd23a6c05e9d0c424ea64fb1b78b.sol", "line": 86, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a6e5460c4c26", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint Val;", "highlightLines": [87]}, "category": "code", "location": {"file": "dataset/reentrancy/0x96edbe868531bd23a6c05e9d0c424ea64fb1b78b.sol", "line": 87, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c405efb517a1", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint  Time;", "highlightLines": [88]}, "category": "code", "location": {"file": "dataset/reentrancy/0x96edbe868531bd23a6c05e9d0c424ea64fb1b78b.sol", "line": 88, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f806dcb18110", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Sender = _adr;\n        LastMsg.Time = now;", "highlightLines": [98]}, "category": "code", "location": {"file": "dataset/reentrancy/0x96edbe868531bd23a6c05e9d0c424ea64fb1b78b.sol", "line": 98, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "03a273ae8549", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Time = now;\n        LastMsg.Val = _val;", "highlightLines": [99]}, "category": "code", "location": {"file": "dataset/reentrancy/0x96edbe868531bd23a6c05e9d0c424ea64fb1b78b.sol", "line": 99, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "0b59f74998c3", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Val = _val;\n        LastMsg.Data = _data;", "highlightLines": [100]}, "category": "code", "location": {"file": "dataset/reentrancy/0x96edbe868531bd23a6c05e9d0c424ea64fb1b78b.sol", "line": 100, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "1dbfaab6c01c", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/0xaae1f51cf3339f18b6d3f3bdc75a5facd744b0b8.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "3cbc1a9077c4", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/0xaae1f51cf3339f18b6d3f3bdc75a5facd744b0b8.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "0160825180c8", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    \n    bool intitalized;", "highlightLines": [16]}, "category": "code", "location": {"file": "dataset/reentrancy/0xaae1f51cf3339f18b6d3f3bdc75a5facd744b0b8.sol", "line": 16, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3492d15ec8ee", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "        if(intitalized)throw;\n        MinSum = _val;", "highlightLines": [22]}, "category": "code", "location": {"file": "dataset/reentrancy/0xaae1f51cf3339f18b6d3f3bdc75a5facd744b0b8.sol", "line": 22, "column": 24}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "12871c90866f", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "        if(intitalized)throw;\n        Log = LogFile(_log);", "highlightLines": [29]}, "category": "code", "location": {"file": "dataset/reentrancy/0xaae1f51cf3339f18b6d3f3bdc75a5facd744b0b8.sol", "line": 29, "column": 24}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "c8339b107c85", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address Sender;", "highlightLines": [76]}, "category": "code", "location": {"file": "dataset/reentrancy/0xaae1f51cf3339f18b6d3f3bdc75a5facd744b0b8.sol", "line": 76, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "abb332880f58", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        string  Data;", "highlightLines": [77]}, "category": "code", "location": {"file": "dataset/reentrancy/0xaae1f51cf3339f18b6d3f3bdc75a5facd744b0b8.sol", "line": 77, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "eee52e208f88", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint Val;", "highlightLines": [78]}, "category": "code", "location": {"file": "dataset/reentrancy/0xaae1f51cf3339f18b6d3f3bdc75a5facd744b0b8.sol", "line": 78, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "996559b7d66c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint  Time;", "highlightLines": [79]}, "category": "code", "location": {"file": "dataset/reentrancy/0xaae1f51cf3339f18b6d3f3bdc75a5facd744b0b8.sol", "line": 79, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "75044960cbd5", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Sender = _adr;\n        LastMsg.Time = now;", "highlightLines": [89]}, "category": "code", "location": {"file": "dataset/reentrancy/0xaae1f51cf3339f18b6d3f3bdc75a5facd744b0b8.sol", "line": 89, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d204b991db52", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Time = now;\n        LastMsg.Val = _val;", "highlightLines": [90]}, "category": "code", "location": {"file": "dataset/reentrancy/0xaae1f51cf3339f18b6d3f3bdc75a5facd744b0b8.sol", "line": 90, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "15cf3e32d40b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Val = _val;\n        LastMsg.Data = _data;", "highlightLines": [91]}, "category": "code", "location": {"file": "dataset/reentrancy/0xaae1f51cf3339f18b6d3f3bdc75a5facd744b0b8.sol", "line": 91, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "f645d1b30184", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/0xb5e1b1ee15c6fa0e48fce100125569d430f1bd12.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "c3ca3bccf260", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/0xb5e1b1ee15c6fa0e48fce100125569d430f1bd12.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "a9bbe61aa2b7", "fix": {"template": null, "available": false}, "title": "SWC-118: Function name matches contract name - likely intended as constructor (pre-0.4.22)", "ruleId": "rules.sol-swc-118-constructor-mismatch", "snippet": {"code": "contract Private_Bank\n{\n    mapping (address => uint) public balances;\n    \n    uint public MinDeposit = 1 ether;\n    \n    Log TransferLog;\n    \n    function Private_Bank(address _log)", "highlightLines": [9]}, "category": "code", "location": {"file": "dataset/reentrancy/0xb5e1b1ee15c6fa0e48fce100125569d430f1bd12.sol", "line": 9, "column": 1}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-118"], "description": ""}, {"id": "06f4b8bd153c", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function Private_Bank(address _log)\n    {\n        TransferLog = Log(_log);\n    }", "highlightLines": [17]}, "category": "code", "location": {"file": "dataset/reentrancy/0xb5e1b1ee15c6fa0e48fce100125569d430f1bd12.sol", "line": 17, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "eb2f13b09f6a", "fix": {"template": null, "available": false}, "title": "Function pointer stored in state variable - potential hijack target", "ruleId": "rules.sol-function-pointer-state", "snippet": {"code": "    function() public payable{}    \n    \n}\n\ncontract Log \n{\n   \n    struct Message\n    {\n        address Sender;", "highlightLines": [48]}, "category": "code", "location": {"file": "dataset/reentrancy/0xb5e1b1ee15c6fa0e48fce100125569d430f1bd12.sol", "line": 48, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "b4c58fd4bb8c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address Sender;", "highlightLines": [57]}, "category": "code", "location": {"file": "dataset/reentrancy/0xb5e1b1ee15c6fa0e48fce100125569d430f1bd12.sol", "line": 57, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "9f7e2ded2109", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        string  Data;", "highlightLines": [58]}, "category": "code", "location": {"file": "dataset/reentrancy/0xb5e1b1ee15c6fa0e48fce100125569d430f1bd12.sol", "line": 58, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b538fde3840f", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint Val;", "highlightLines": [59]}, "category": "code", "location": {"file": "dataset/reentrancy/0xb5e1b1ee15c6fa0e48fce100125569d430f1bd12.sol", "line": 59, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8a8391f2b1f0", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint  Time;", "highlightLines": [60]}, "category": "code", "location": {"file": "dataset/reentrancy/0xb5e1b1ee15c6fa0e48fce100125569d430f1bd12.sol", "line": 60, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3b43be8c4f35", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Sender = _adr;\n        LastMsg.Time = now;", "highlightLines": [70]}, "category": "code", "location": {"file": "dataset/reentrancy/0xb5e1b1ee15c6fa0e48fce100125569d430f1bd12.sol", "line": 70, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "72a51f60e983", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Time = now;\n        LastMsg.Val = _val;", "highlightLines": [71]}, "category": "code", "location": {"file": "dataset/reentrancy/0xb5e1b1ee15c6fa0e48fce100125569d430f1bd12.sol", "line": 71, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "f1055cc4c2d0", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Val = _val;\n        LastMsg.Data = _data;", "highlightLines": [72]}, "category": "code", "location": {"file": "dataset/reentrancy/0xb5e1b1ee15c6fa0e48fce100125569d430f1bd12.sol", "line": 72, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "f4ffcdd919b7", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/0xb93430ce38ac4a6bb47fb1fc085ea669353fd89e.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "480f2d972655", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/0xb93430ce38ac4a6bb47fb1fc085ea669353fd89e.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "bfc7877050f4", "fix": {"template": null, "available": false}, "title": "SWC-118: Function name matches contract name - likely intended as constructor (pre-0.4.22)", "ruleId": "rules.sol-swc-118-constructor-mismatch", "snippet": {"code": "contract PrivateBank\n{\n    mapping (address => uint) public balances;\n        \n    uint public MinDeposit = 1 ether;\n    \n    Log TransferLog;\n    \n    function PrivateBank(address _lib)", "highlightLines": [9]}, "category": "code", "location": {"file": "dataset/reentrancy/0xb93430ce38ac4a6bb47fb1fc085ea669353fd89e.sol", "line": 9, "column": 1}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-118"], "description": ""}, {"id": "c5e2dde4e47f", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function PrivateBank(address _lib)\n    {\n        TransferLog = Log(_lib);\n    }", "highlightLines": [17]}, "category": "code", "location": {"file": "dataset/reentrancy/0xb93430ce38ac4a6bb47fb1fc085ea669353fd89e.sol", "line": 17, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "7d3fdc37a2fe", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function CashOut(uint _am)\n    {\n        if(_am<=balances[msg.sender])\n        {            \n            // <yes> <report> REENTRANCY\n            if(msg.sender.call.value(_am)())\n            {\n                balances[msg.sender]-=_am;\n                TransferLog.AddMessage(msg.sender,_am,\"CashOut\");\n            }\n        }\n    }", "highlightLines": [33]}, "category": "code", "location": {"file": "dataset/reentrancy/0xb93430ce38ac4a6bb47fb1fc085ea669353fd89e.sol", "line": 33, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "aff9ab9c2a83", "fix": {"template": null, "available": false}, "title": "Function pointer stored in state variable - potential hijack target", "ruleId": "rules.sol-function-pointer-state", "snippet": {"code": "    function() public payable{}    \n    \n}\n\ncontract Log \n{\n   \n    struct Message\n    {\n        address Sender;", "highlightLines": [46]}, "category": "code", "location": {"file": "dataset/reentrancy/0xb93430ce38ac4a6bb47fb1fc085ea669353fd89e.sol", "line": 46, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "94f93aa1b7fc", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address Sender;", "highlightLines": [55]}, "category": "code", "location": {"file": "dataset/reentrancy/0xb93430ce38ac4a6bb47fb1fc085ea669353fd89e.sol", "line": 55, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d4d5cb7d306d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        string  Data;", "highlightLines": [56]}, "category": "code", "location": {"file": "dataset/reentrancy/0xb93430ce38ac4a6bb47fb1fc085ea669353fd89e.sol", "line": 56, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "bbdf79ed227d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint Val;", "highlightLines": [57]}, "category": "code", "location": {"file": "dataset/reentrancy/0xb93430ce38ac4a6bb47fb1fc085ea669353fd89e.sol", "line": 57, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a910882da220", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint  Time;", "highlightLines": [58]}, "category": "code", "location": {"file": "dataset/reentrancy/0xb93430ce38ac4a6bb47fb1fc085ea669353fd89e.sol", "line": 58, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "dcce2c378e9f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Sender = _adr;\n        LastMsg.Time = now;", "highlightLines": [68]}, "category": "code", "location": {"file": "dataset/reentrancy/0xb93430ce38ac4a6bb47fb1fc085ea669353fd89e.sol", "line": 68, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "f0a8ab857a33", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Time = now;\n        LastMsg.Val = _val;", "highlightLines": [69]}, "category": "code", "location": {"file": "dataset/reentrancy/0xb93430ce38ac4a6bb47fb1fc085ea669353fd89e.sol", "line": 69, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e4195db74d47", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Val = _val;\n        LastMsg.Data = _data;", "highlightLines": [70]}, "category": "code", "location": {"file": "dataset/reentrancy/0xb93430ce38ac4a6bb47fb1fc085ea669353fd89e.sol", "line": 70, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "2451c83a6d4b", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/0xbaf51e761510c1a11bf48dd87c0307ac8a8c8a4f.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "dcd5f523f834", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/0xbaf51e761510c1a11bf48dd87c0307ac8a8c8a4f.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "6a15b5f654bd", "fix": {"template": null, "available": false}, "title": "SWC-118: Function name matches contract name - likely intended as constructor (pre-0.4.22)", "ruleId": "rules.sol-swc-118-constructor-mismatch", "snippet": {"code": "contract ETH_VAULT\n{\n    mapping (address => uint) public balances;\n    \n    uint public MinDeposit = 1 ether;\n    \n    Log TransferLog;\n    \n    function ETH_VAULT(address _log)", "highlightLines": [9]}, "category": "code", "location": {"file": "dataset/reentrancy/0xbaf51e761510c1a11bf48dd87c0307ac8a8c8a4f.sol", "line": 9, "column": 1}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-118"], "description": ""}, {"id": "9748be3fb23b", "fix": {"template": null, "available": false}, "title": "Function pointer stored in state variable - potential hijack target", "ruleId": "rules.sol-function-pointer-state", "snippet": {"code": "    function() public payable{}    \n    \n}\n\ncontract Log \n{\n   \n    struct Message\n    {\n        address Sender;", "highlightLines": [49]}, "category": "code", "location": {"file": "dataset/reentrancy/0xbaf51e761510c1a11bf48dd87c0307ac8a8c8a4f.sol", "line": 49, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "c6db388d0806", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address Sender;", "highlightLines": [58]}, "category": "code", "location": {"file": "dataset/reentrancy/0xbaf51e761510c1a11bf48dd87c0307ac8a8c8a4f.sol", "line": 58, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7297600dee19", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        string  Data;", "highlightLines": [59]}, "category": "code", "location": {"file": "dataset/reentrancy/0xbaf51e761510c1a11bf48dd87c0307ac8a8c8a4f.sol", "line": 59, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "82cb8b6111b1", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint Val;", "highlightLines": [60]}, "category": "code", "location": {"file": "dataset/reentrancy/0xbaf51e761510c1a11bf48dd87c0307ac8a8c8a4f.sol", "line": 60, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "bef1086ed705", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint  Time;", "highlightLines": [61]}, "category": "code", "location": {"file": "dataset/reentrancy/0xbaf51e761510c1a11bf48dd87c0307ac8a8c8a4f.sol", "line": 61, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "99f0cffb1484", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Sender = _adr;\n        LastMsg.Time = now;", "highlightLines": [71]}, "category": "code", "location": {"file": "dataset/reentrancy/0xbaf51e761510c1a11bf48dd87c0307ac8a8c8a4f.sol", "line": 71, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d973164233e1", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Time = now;\n        LastMsg.Val = _val;", "highlightLines": [72]}, "category": "code", "location": {"file": "dataset/reentrancy/0xbaf51e761510c1a11bf48dd87c0307ac8a8c8a4f.sol", "line": 72, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "4918e9b2c02d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Val = _val;\n        LastMsg.Data = _data;", "highlightLines": [73]}, "category": "code", "location": {"file": "dataset/reentrancy/0xbaf51e761510c1a11bf48dd87c0307ac8a8c8a4f.sol", "line": 73, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "a910d86d0395", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/0xbe4041d55db380c5ae9d4a9b9703f1ed4e7e3888.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "788187cce4dc", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/0xbe4041d55db380c5ae9d4a9b9703f1ed4e7e3888.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "1b0bb6dec1f1", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint unlockTime;", "highlightLines": [13]}, "category": "code", "location": {"file": "dataset/reentrancy/0xbe4041d55db380c5ae9d4a9b9703f1ed4e7e3888.sol", "line": 13, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d9fd72c48241", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint balance;", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/reentrancy/0xbe4041d55db380c5ae9d4a9b9703f1ed4e7e3888.sol", "line": 14, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ca97f8830c91", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "        uint balance;", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/reentrancy/0xbe4041d55db380c5ae9d4a9b9703f1ed4e7e3888.sol", "line": 14, "column": 9}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "9dede4404bda", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    \n    bool intitalized;", "highlightLines": [22]}, "category": "code", "location": {"file": "dataset/reentrancy/0xbe4041d55db380c5ae9d4a9b9703f1ed4e7e3888.sol", "line": 22, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "cfb7527e6297", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "        if(intitalized)throw;\n        MinSum = _val;", "highlightLines": [28]}, "category": "code", "location": {"file": "dataset/reentrancy/0xbe4041d55db380c5ae9d4a9b9703f1ed4e7e3888.sol", "line": 28, "column": 24}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "813c9398ab91", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "        if(intitalized)throw;\n        LogFile = Log(_log);", "highlightLines": [35]}, "category": "code", "location": {"file": "dataset/reentrancy/0xbe4041d55db380c5ae9d4a9b9703f1ed4e7e3888.sol", "line": 35, "column": 24}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "acfa09f932bb", "fix": {"template": null, "available": false}, "title": "Deprecated 'var' keyword can cause type confusion - resolves to smallest type (e.g., uint8 in loops)", "ruleId": "rules.sol-deprecated-var-keyword", "snippet": {"code": "        var acc = Acc[msg.sender];", "highlightLines": [49]}, "category": "code", "location": {"file": "dataset/reentrancy/0xbe4041d55db380c5ae9d4a9b9703f1ed4e7e3888.sol", "line": 49, "column": 9}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/honeypots"], "description": ""}, {"id": "6fad778600e1", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        var acc = Acc[msg.sender];\n        acc.balance += msg.value;\n        if(now+_lockTime>acc.unlockTime)acc.unlockTime=now+_lockTime;", "highlightLines": [49]}, "category": "code", "location": {"file": "dataset/reentrancy/0xbe4041d55db380c5ae9d4a9b9703f1ed4e7e3888.sol", "line": 49, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e9a1fd6b0af1", "fix": {"template": null, "available": false}, "title": "Deprecated 'var' keyword can cause type confusion - resolves to smallest type (e.g., uint8 in loops)", "ruleId": "rules.sol-deprecated-var-keyword", "snippet": {"code": "        var acc = Acc[msg.sender];", "highlightLines": [59]}, "category": "code", "location": {"file": "dataset/reentrancy/0xbe4041d55db380c5ae9d4a9b9703f1ed4e7e3888.sol", "line": 59, "column": 9}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/honeypots"], "description": ""}, {"id": "98f936539390", "fix": {"template": null, "available": false}, "title": "Block timestamp used for critical logic - miners can manipulate within ~15 second window", "ruleId": "rules.sol-block-timestamp-manipulation", "snippet": {"code": "        if( acc.balance>=MinSum && acc.balance>=_am && now>acc.unlockTime)", "highlightLines": [60]}, "category": "code", "location": {"file": "dataset/reentrancy/0xbe4041d55db380c5ae9d4a9b9703f1ed4e7e3888.sol", "line": 60, "column": 56}, "severity": "medium", "references": ["https://consensys.github.io/smart-contract-best-practices/development-recommendations/solidity-specific/timestamp-dependence/"], "description": ""}, {"id": "c689ce4a938e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address Sender;", "highlightLines": [85]}, "category": "code", "location": {"file": "dataset/reentrancy/0xbe4041d55db380c5ae9d4a9b9703f1ed4e7e3888.sol", "line": 85, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ed1962d76e97", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        string  Data;", "highlightLines": [86]}, "category": "code", "location": {"file": "dataset/reentrancy/0xbe4041d55db380c5ae9d4a9b9703f1ed4e7e3888.sol", "line": 86, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "cbd1e9e71cc9", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint Val;", "highlightLines": [87]}, "category": "code", "location": {"file": "dataset/reentrancy/0xbe4041d55db380c5ae9d4a9b9703f1ed4e7e3888.sol", "line": 87, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d63fe9dafd67", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint  Time;", "highlightLines": [88]}, "category": "code", "location": {"file": "dataset/reentrancy/0xbe4041d55db380c5ae9d4a9b9703f1ed4e7e3888.sol", "line": 88, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "22ae75c7165e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Sender = _adr;\n        LastMsg.Time = now;", "highlightLines": [98]}, "category": "code", "location": {"file": "dataset/reentrancy/0xbe4041d55db380c5ae9d4a9b9703f1ed4e7e3888.sol", "line": 98, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "af6141d0c1d0", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Time = now;\n        LastMsg.Val = _val;", "highlightLines": [99]}, "category": "code", "location": {"file": "dataset/reentrancy/0xbe4041d55db380c5ae9d4a9b9703f1ed4e7e3888.sol", "line": 99, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "1b46778977ba", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Val = _val;\n        LastMsg.Data = _data;", "highlightLines": [100]}, "category": "code", "location": {"file": "dataset/reentrancy/0xbe4041d55db380c5ae9d4a9b9703f1ed4e7e3888.sol", "line": 100, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "fad7548e0bcd", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.25;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/0xcead721ef5b11f1a7b530171aab69b16c5e66b6e.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "2fca0404fc33", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.25;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/0xcead721ef5b11f1a7b530171aab69b16c5e66b6e.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "0248a047d6c2", "fix": {"template": null, "available": false}, "title": "Deprecated 'var' keyword can cause type confusion - resolves to smallest type (e.g., uint8 in loops)", "ruleId": "rules.sol-deprecated-var-keyword", "snippet": {"code": "        var acc = Acc[msg.sender];", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/reentrancy/0xcead721ef5b11f1a7b530171aab69b16c5e66b6e.sol", "line": 15, "column": 9}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/honeypots"], "description": ""}, {"id": "d5547d619712", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        var acc = Acc[msg.sender];\n        acc.balance += msg.value;\n        acc.unlockTime = _unlockTime>now?_unlockTime:now;", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/reentrancy/0xcead721ef5b11f1a7b530171aab69b16c5e66b6e.sol", "line": 15, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "43480c2c7b40", "fix": {"template": null, "available": false}, "title": "Deprecated 'var' keyword can cause type confusion - resolves to smallest type (e.g., uint8 in loops)", "ruleId": "rules.sol-deprecated-var-keyword", "snippet": {"code": "        var acc = Acc[msg.sender];", "highlightLines": [25]}, "category": "code", "location": {"file": "dataset/reentrancy/0xcead721ef5b11f1a7b530171aab69b16c5e66b6e.sol", "line": 25, "column": 9}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/honeypots"], "description": ""}, {"id": "0ca80e70ea20", "fix": {"template": null, "available": false}, "title": "Block timestamp used for critical logic - miners can manipulate within ~15 second window", "ruleId": "rules.sol-block-timestamp-manipulation", "snippet": {"code": "        if( acc.balance>=MinSum && acc.balance>=_am && now>acc.unlockTime)", "highlightLines": [26]}, "category": "code", "location": {"file": "dataset/reentrancy/0xcead721ef5b11f1a7b530171aab69b16c5e66b6e.sol", "line": 26, "column": 56}, "severity": "medium", "references": ["https://consensys.github.io/smart-contract-best-practices/development-recommendations/solidity-specific/timestamp-dependence/"], "description": ""}, {"id": "f6681338a68c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint unlockTime;", "highlightLines": [46]}, "category": "code", "location": {"file": "dataset/reentrancy/0xcead721ef5b11f1a7b530171aab69b16c5e66b6e.sol", "line": 46, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8b1987e49373", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint balance;", "highlightLines": [47]}, "category": "code", "location": {"file": "dataset/reentrancy/0xcead721ef5b11f1a7b530171aab69b16c5e66b6e.sol", "line": 47, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b61dc1e52948", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "        uint balance;", "highlightLines": [47]}, "category": "code", "location": {"file": "dataset/reentrancy/0xcead721ef5b11f1a7b530171aab69b16c5e66b6e.sol", "line": 47, "column": 9}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "55202c2c3715", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address Sender;", "highlightLines": [66]}, "category": "code", "location": {"file": "dataset/reentrancy/0xcead721ef5b11f1a7b530171aab69b16c5e66b6e.sol", "line": 66, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4ac01f7fbae3", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        string  Data;", "highlightLines": [67]}, "category": "code", "location": {"file": "dataset/reentrancy/0xcead721ef5b11f1a7b530171aab69b16c5e66b6e.sol", "line": 67, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e36fb6171449", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint Val;", "highlightLines": [68]}, "category": "code", "location": {"file": "dataset/reentrancy/0xcead721ef5b11f1a7b530171aab69b16c5e66b6e.sol", "line": 68, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "75047f061d76", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint  Time;", "highlightLines": [69]}, "category": "code", "location": {"file": "dataset/reentrancy/0xcead721ef5b11f1a7b530171aab69b16c5e66b6e.sol", "line": 69, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d505257c44b6", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Sender = _adr;\n        LastMsg.Time = now;", "highlightLines": [79]}, "category": "code", "location": {"file": "dataset/reentrancy/0xcead721ef5b11f1a7b530171aab69b16c5e66b6e.sol", "line": 79, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "036687ccff8a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Time = now;\n        LastMsg.Val = _val;", "highlightLines": [80]}, "category": "code", "location": {"file": "dataset/reentrancy/0xcead721ef5b11f1a7b530171aab69b16c5e66b6e.sol", "line": 80, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e0586e58db08", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Val = _val;\n        LastMsg.Data = _data;", "highlightLines": [81]}, "category": "code", "location": {"file": "dataset/reentrancy/0xcead721ef5b11f1a7b530171aab69b16c5e66b6e.sol", "line": 81, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "6717d22bdcd5", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.25;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/0xf015c35649c82f5467c9c74b7f28ee67665aad68.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "a5386ae712ff", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.25;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/0xf015c35649c82f5467c9c74b7f28ee67665aad68.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "6061753b7f3d", "fix": {"template": null, "available": false}, "title": "Deprecated 'var' keyword can cause type confusion - resolves to smallest type (e.g., uint8 in loops)", "ruleId": "rules.sol-deprecated-var-keyword", "snippet": {"code": "        var acc = Acc[msg.sender];", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/reentrancy/0xf015c35649c82f5467c9c74b7f28ee67665aad68.sol", "line": 15, "column": 9}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/honeypots"], "description": ""}, {"id": "13df86626eac", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        var acc = Acc[msg.sender];\n        acc.balance += msg.value;\n        acc.unlockTime = _unlockTime>now?_unlockTime:now;", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/reentrancy/0xf015c35649c82f5467c9c74b7f28ee67665aad68.sol", "line": 15, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "08af87f586ea", "fix": {"template": null, "available": false}, "title": "Deprecated 'var' keyword can cause type confusion - resolves to smallest type (e.g., uint8 in loops)", "ruleId": "rules.sol-deprecated-var-keyword", "snippet": {"code": "        var acc = Acc[msg.sender];", "highlightLines": [25]}, "category": "code", "location": {"file": "dataset/reentrancy/0xf015c35649c82f5467c9c74b7f28ee67665aad68.sol", "line": 25, "column": 9}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/honeypots"], "description": ""}, {"id": "f3effae0e613", "fix": {"template": null, "available": false}, "title": "Block timestamp used for critical logic - miners can manipulate within ~15 second window", "ruleId": "rules.sol-block-timestamp-manipulation", "snippet": {"code": "        if( acc.balance>=MinSum && acc.balance>=_am && now>acc.unlockTime)", "highlightLines": [26]}, "category": "code", "location": {"file": "dataset/reentrancy/0xf015c35649c82f5467c9c74b7f28ee67665aad68.sol", "line": 26, "column": 56}, "severity": "medium", "references": ["https://consensys.github.io/smart-contract-best-practices/development-recommendations/solidity-specific/timestamp-dependence/"], "description": ""}, {"id": "ec3da22b230d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint unlockTime;", "highlightLines": [46]}, "category": "code", "location": {"file": "dataset/reentrancy/0xf015c35649c82f5467c9c74b7f28ee67665aad68.sol", "line": 46, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a76a82efa1f0", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint balance;", "highlightLines": [47]}, "category": "code", "location": {"file": "dataset/reentrancy/0xf015c35649c82f5467c9c74b7f28ee67665aad68.sol", "line": 47, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "2b07fc700783", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "        uint balance;", "highlightLines": [47]}, "category": "code", "location": {"file": "dataset/reentrancy/0xf015c35649c82f5467c9c74b7f28ee67665aad68.sol", "line": 47, "column": 9}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "bbd7cadd8908", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address Sender;", "highlightLines": [66]}, "category": "code", "location": {"file": "dataset/reentrancy/0xf015c35649c82f5467c9c74b7f28ee67665aad68.sol", "line": 66, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "93986109b97e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        string  Data;", "highlightLines": [67]}, "category": "code", "location": {"file": "dataset/reentrancy/0xf015c35649c82f5467c9c74b7f28ee67665aad68.sol", "line": 67, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "5170b2cb9b9d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint Val;", "highlightLines": [68]}, "category": "code", "location": {"file": "dataset/reentrancy/0xf015c35649c82f5467c9c74b7f28ee67665aad68.sol", "line": 68, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "81a1ecaa1ade", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint  Time;", "highlightLines": [69]}, "category": "code", "location": {"file": "dataset/reentrancy/0xf015c35649c82f5467c9c74b7f28ee67665aad68.sol", "line": 69, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d11489d84861", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Sender = _adr;\n        LastMsg.Time = now;", "highlightLines": [79]}, "category": "code", "location": {"file": "dataset/reentrancy/0xf015c35649c82f5467c9c74b7f28ee67665aad68.sol", "line": 79, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "ed959c5322e3", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Time = now;\n        LastMsg.Val = _val;", "highlightLines": [80]}, "category": "code", "location": {"file": "dataset/reentrancy/0xf015c35649c82f5467c9c74b7f28ee67665aad68.sol", "line": 80, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "70a7a013d75b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        LastMsg.Val = _val;\n        LastMsg.Data = _data;", "highlightLines": [81]}, "category": "code", "location": {"file": "dataset/reentrancy/0xf015c35649c82f5467c9c74b7f28ee67665aad68.sol", "line": 81, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "2766b55ceef3", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.0;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/etherbank.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "966b2aeccbcd", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.0;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/etherbank.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "d771fd475f56", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function getBalance(address user) constant returns(uint) {  \n\t\treturn userBalances[user];\n\t}", "highlightLines": [10]}, "category": "code", "location": {"file": "dataset/reentrancy/etherbank.sol", "line": 10, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "3034ff4c55bd", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "\tfunction addToBalance() {  \n\t\tuserBalances[msg.sender] += msg.value;\n\t}", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/reentrancy/etherbank.sol", "line": 14, "column": 2}, "severity": "medium", "references": [], "description": ""}, {"id": "12aa7afb941e", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "\tfunction withdrawBalance() {  \n\t\tuint amountToWithdraw = userBalances[msg.sender];\n        // <yes> <report> REENTRANCY\n\t\tif (!(msg.sender.call.value(amountToWithdraw)())) { throw; }\n\t\tuserBalances[msg.sender] = 0;\n\t}", "highlightLines": [18]}, "category": "code", "location": {"file": "dataset/reentrancy/etherbank.sol", "line": 18, "column": 2}, "severity": "medium", "references": [], "description": ""}, {"id": "b995537780f4", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\t\tuint amountToWithdraw = userBalances[msg.sender];", "highlightLines": [19]}, "category": "code", "location": {"file": "dataset/reentrancy/etherbank.sol", "line": 19, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "1aac603afaa1", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "\t\tuint amountToWithdraw = userBalances[msg.sender];\n        // <yes> <report> REENTRANCY\n\t\tif (!(msg.sender.call.value(amountToWithdraw)())) { throw; }\n\t\tuserBalances[msg.sender] = 0;", "highlightLines": [19]}, "category": "code", "location": {"file": "dataset/reentrancy/etherbank.sol", "line": 19, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "ddad077eeddf", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.10;", "highlightLines": [8]}, "category": "code", "location": {"file": "dataset/reentrancy/etherstore.sol", "line": 8, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "4921d6d4619f", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.10;", "highlightLines": [8]}, "category": "code", "location": {"file": "dataset/reentrancy/etherstore.sol", "line": 8, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "7567c359e1f4", "fix": {"template": null, "available": false}, "title": "require() in withdrawal path - griefing possible if condition can be manipulated", "ruleId": "rules.sol-force-revert-griefing", "snippet": {"code": "    function withdrawFunds (uint256 _weiToWithdraw) public {\n        require(balances[msg.sender] >= _weiToWithdraw);", "highlightLines": [20]}, "category": "code", "location": {"file": "dataset/reentrancy/etherstore.sol", "line": 20, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "a5f071ade98e", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(balances[msg.sender] >= _weiToWithdraw);", "highlightLines": [21]}, "category": "code", "location": {"file": "dataset/reentrancy/etherstore.sol", "line": 21, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "3849c651082a", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_weiToWithdraw <= withdrawalLimit);", "highlightLines": [23]}, "category": "code", "location": {"file": "dataset/reentrancy/etherstore.sol", "line": 23, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "dc66644096df", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(now >= lastWithdrawTime[msg.sender] + 1 weeks);", "highlightLines": [25]}, "category": "code", "location": {"file": "dataset/reentrancy/etherstore.sol", "line": 25, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "331bc1ff6b94", "fix": {"template": null, "available": false}, "title": "Block timestamp used for critical logic - miners can manipulate within ~15 second window", "ruleId": "rules.sol-block-timestamp-manipulation", "snippet": {"code": "        require(now >= lastWithdrawTime[msg.sender] + 1 weeks);", "highlightLines": [25]}, "category": "code", "location": {"file": "dataset/reentrancy/etherstore.sol", "line": 25, "column": 17}, "severity": "medium", "references": ["https://consensys.github.io/smart-contract-best-practices/development-recommendations/solidity-specific/timestamp-dependence/"], "description": ""}, {"id": "34b09a6a3412", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender.call.value(_weiToWithdraw)());", "highlightLines": [27]}, "category": "code", "location": {"file": "dataset/reentrancy/etherstore.sol", "line": 27, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "77ac1e223979", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.24;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/modifier_reentrancy.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "d591267b6a82", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.24;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/modifier_reentrancy.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "4086b5f35102", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  modifier supportsToken() {\n    require(keccak256(abi.encodePacked(\"Nu Token\")) == Bank(msg.sender).supportsToken());\n    _;\n  }", "highlightLines": [20]}, "category": "code", "location": {"file": "dataset/reentrancy/modifier_reentrancy.sol", "line": 20, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "170e330e809c", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(keccak256(abi.encodePacked(\"Nu Token\")) == Bank(msg.sender).supportsToken());", "highlightLines": [21]}, "category": "code", "location": {"file": "dataset/reentrancy/modifier_reentrancy.sol", "line": 21, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "fe70462634c7", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "    require(keccak256(abi.encodePacked(\"Nu Token\")) == Bank(msg.sender).supportsToken());", "highlightLines": [21]}, "category": "code", "location": {"file": "dataset/reentrancy/modifier_reentrancy.sol", "line": 21, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "a9a5ded1e709", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    _;", "highlightLines": [22]}, "category": "code", "location": {"file": "dataset/reentrancy/modifier_reentrancy.sol", "line": 22, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "4a03a9c2a15f", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  modifier hasNoBalance {\n      require(tokenBalance[msg.sender] == 0);\n      _;\n  }", "highlightLines": [25]}, "category": "code", "location": {"file": "dataset/reentrancy/modifier_reentrancy.sol", "line": 25, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "83c996ca732a", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "      require(tokenBalance[msg.sender] == 0);", "highlightLines": [26]}, "category": "code", "location": {"file": "dataset/reentrancy/modifier_reentrancy.sol", "line": 26, "column": 7}, "severity": "info", "references": [], "description": ""}, {"id": "eaafec6bda15", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "      _;", "highlightLines": [27]}, "category": "code", "location": {"file": "dataset/reentrancy/modifier_reentrancy.sol", "line": 27, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "9578569f8ae8", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        return(keccak256(abi.encodePacked(\"Nu Token\")));", "highlightLines": [33]}, "category": "code", "location": {"file": "dataset/reentrancy/modifier_reentrancy.sol", "line": 33, "column": 16}, "severity": "high", "references": [], "description": ""}, {"id": "bb8397958a49", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    bool hasBeenCalled;", "highlightLines": [38]}, "category": "code", "location": {"file": "dataset/reentrancy/modifier_reentrancy.sol", "line": 38, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "fc040c63b4b6", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        return(keccak256(abi.encodePacked(\"Nu Token\")));", "highlightLines": [44]}, "category": "code", "location": {"file": "dataset/reentrancy/modifier_reentrancy.sol", "line": 44, "column": 16}, "severity": "high", "references": [], "description": ""}, {"id": "a379f9c9a04d", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "        ModifierEntrancy(token).airDrop();", "highlightLines": [47]}, "category": "code", "location": {"file": "dataset/reentrancy/modifier_reentrancy.sol", "line": 47, "column": 9}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "2927a210a9ab", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.18;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/reentrance.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "7ffb34328974", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.18;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/reentrance.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "47edf3f4a4c9", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "  function withdraw(uint _amount) public {", "highlightLines": [21]}, "category": "code", "location": {"file": "dataset/reentrancy/reentrance.sol", "line": 21, "column": 3}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "19ae47460bd5", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _amount;", "highlightLines": [25]}, "category": "code", "location": {"file": "dataset/reentrancy/reentrance.sol", "line": 25, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "1047ec1de0bb", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.24;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/reentrancy_bonus.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "6aeea86418fd", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.24;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/reentrancy_bonus.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "cdfee70772d5", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint amountToWithdraw = rewardsForA[recipient];", "highlightLines": [17]}, "category": "code", "location": {"file": "dataset/reentrancy/reentrancy_bonus.sol", "line": 17, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a8aa953b479a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint amountToWithdraw = rewardsForA[recipient];\n        rewardsForA[recipient] = 0;", "highlightLines": [17]}, "category": "code", "location": {"file": "dataset/reentrancy/reentrancy_bonus.sol", "line": 17, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "759be6182b52", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        rewardsForA[recipient] = 0;\n        (bool success, ) = recipient.call.value(amountToWithdraw)(\"\");", "highlightLines": [18]}, "category": "code", "location": {"file": "dataset/reentrancy/reentrancy_bonus.sol", "line": 18, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "a03360b0b8c6", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(success);", "highlightLines": [20]}, "category": "code", "location": {"file": "dataset/reentrancy/reentrancy_bonus.sol", "line": 20, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "14baa1f5ff94", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(!claimedBonus[recipient]); // Each recipient should only be able to claim the bonus once", "highlightLines": [24]}, "category": "code", "location": {"file": "dataset/reentrancy/reentrancy_bonus.sol", "line": 24, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "acf62d6affc7", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.24;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/reentrancy_cross_function.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "2ecdf69790e8", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.24;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/reentrancy_cross_function.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "bce7aba15957", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without msg.data.length validation - vulnerable to short address attack padding", "ruleId": "rules.sol-short-address-no-payload-check", "snippet": {"code": "    function transfer(address to, uint amount) {", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/reentrancy/reentrancy_cross_function.sol", "line": 14, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address", "https://vessenes.com/the-erc20-short-address-attack-explained/"], "description": ""}, {"id": "5e4b7401d97c", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function transfer(address to, uint amount) {\n        if (userBalances[msg.sender] >= amount) {\n            userBalances[to] += amount;\n            userBalances[msg.sender] -= amount;\n        }\n    }", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/reentrancy/reentrancy_cross_function.sol", "line": 14, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "f53ffa397d39", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint amountToWithdraw = userBalances[msg.sender];", "highlightLines": [22]}, "category": "code", "location": {"file": "dataset/reentrancy/reentrancy_cross_function.sol", "line": 22, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ca50719096a2", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint amountToWithdraw = userBalances[msg.sender];\n        // <yes> <report> REENTRANCY\n        (bool success, ) = msg.sender.call.value(amountToWithdraw)(\"\"); // At this point, the caller's code is executed, and can call transfer()", "highlightLines": [22]}, "category": "code", "location": {"file": "dataset/reentrancy/reentrancy_cross_function.sol", "line": 22, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "81593b998692", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        (bool success, ) = msg.sender.call.value(amountToWithdraw)(\"\"); // At this point, the caller's code is executed, and can call transfer()\n        require(success);\n        userBalances[msg.sender] = 0;", "highlightLines": [24]}, "category": "code", "location": {"file": "dataset/reentrancy/reentrancy_cross_function.sol", "line": 24, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "1f43dae6ce3c", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(success);", "highlightLines": [25]}, "category": "code", "location": {"file": "dataset/reentrancy/reentrancy_cross_function.sol", "line": 25, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "9802a48f76b5", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/reentrancy_dao.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "cc371ee27459", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/reentrancy_dao.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "96d0a97e7a38", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint balance;", "highlightLines": [11]}, "category": "code", "location": {"file": "dataset/reentrancy/reentrancy_dao.sol", "line": 11, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c3408629401f", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "    uint balance;", "highlightLines": [11]}, "category": "code", "location": {"file": "dataset/reentrancy/reentrancy_dao.sol", "line": 11, "column": 5}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "52158917e8cf", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint oCredit = credit[msg.sender];", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/reentrancy/reentrancy_dao.sol", "line": 14, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "bc7b9d9cbb81", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint oCredit = credit[msg.sender];\n        if (oCredit > 0) {\n            balance -= oCredit;\n            // <yes> <report> REENTRANCY\n            bool callResult = msg.sender.call.value(oCredit)();\n            require (callResult);\n            credit[msg.sender] = 0;\n        }", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/reentrancy/reentrancy_dao.sol", "line": 14, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "24b3f4e37a1a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            bool callResult = msg.sender.call.value(oCredit)();", "highlightLines": [18]}, "category": "code", "location": {"file": "dataset/reentrancy/reentrancy_dao.sol", "line": 18, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b2675c64c834", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            bool callResult = msg.sender.call.value(oCredit)();\n            require (callResult);\n            credit[msg.sender] = 0;", "highlightLines": [18]}, "category": "code", "location": {"file": "dataset/reentrancy/reentrancy_dao.sol", "line": 18, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "b90d1cbdc2b7", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "            require (callResult);", "highlightLines": [19]}, "category": "code", "location": {"file": "dataset/reentrancy/reentrancy_dao.sol", "line": 19, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "f30712d33ae9", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function deposit() public payable {", "highlightLines": [24]}, "category": "code", "location": {"file": "dataset/reentrancy/reentrancy_dao.sol", "line": 24, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "a178d8e82e56", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.5.0;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/reentrancy_insecure.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "61d592a544b6", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint amountToWithdraw = userBalances[msg.sender];", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/reentrancy/reentrancy_insecure.sol", "line": 15, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "234c88720fa6", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint amountToWithdraw = userBalances[msg.sender];\n        // <yes> <report> REENTRANCY\n        (bool success, ) = msg.sender.call.value(amountToWithdraw)(\"\"); // At this point, the caller's code is executed, and can call withdrawBalance again", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/reentrancy/reentrancy_insecure.sol", "line": 15, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "8f0b6f3c43a4", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        (bool success, ) = msg.sender.call.value(amountToWithdraw)(\"\"); // At this point, the caller's code is executed, and can call withdrawBalance again\n        require(success);\n        userBalances[msg.sender] = 0;", "highlightLines": [17]}, "category": "code", "location": {"file": "dataset/reentrancy/reentrancy_insecure.sol", "line": 17, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "eb63e50f3ce4", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(success);", "highlightLines": [18]}, "category": "code", "location": {"file": "dataset/reentrancy/reentrancy_insecure.sol", "line": 18, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "5f3d4c2843cf", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": " pragma solidity ^0.4.15;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/reentrancy_simple.sol", "line": 7, "column": 2}, "severity": "info", "references": [], "description": ""}, {"id": "bee64c2c02ba", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": " pragma solidity ^0.4.15;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/reentrancy_simple.sol", "line": 7, "column": 2}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "2f25e33570c0", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "     function getBalance(address u) constant returns(uint){\n         return userBalance[u];\n     }", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/reentrancy/reentrancy_simple.sol", "line": 12, "column": 6}, "severity": "medium", "references": [], "description": ""}, {"id": "74c33b2174ba", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "     function addToBalance() payable{\n         userBalance[msg.sender] += msg.value;\n     }", "highlightLines": [16]}, "category": "code", "location": {"file": "dataset/reentrancy/reentrancy_simple.sol", "line": 16, "column": 6}, "severity": "medium", "references": [], "description": ""}, {"id": "4c6ef30e404d", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "     function withdrawBalance(){\n         // send userBalance[msg.sender] ethers to msg.sender\n         // if mgs.sender is a contract, it will call its fallback function\n         // <yes> <report> REENTRANCY\n         if( ! (msg.sender.call.value(userBalance[msg.sender])() ) ){\n             throw;\n         }\n         userBalance[msg.sender] = 0;\n     }", "highlightLines": [20]}, "category": "code", "location": {"file": "dataset/reentrancy/reentrancy_simple.sol", "line": 20, "column": 6}, "severity": "medium", "references": [], "description": ""}, {"id": "a76f5240e63e", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "             throw;", "highlightLines": [25]}, "category": "code", "location": {"file": "dataset/reentrancy/reentrancy_simple.sol", "line": 25, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "a0f9ccac5a58", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.2;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/simple_dao.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "1319d86eaa2b", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.2;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/reentrancy/simple_dao.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "f0730d8e00d0", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function donate(address to) payable {\n    credit[to] += msg.value;\n  }", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/reentrancy/simple_dao.sol", "line": 12, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "429570a95286", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "  function withdraw(uint amount) {", "highlightLines": [16]}, "category": "code", "location": {"file": "dataset/reentrancy/simple_dao.sol", "line": 16, "column": 3}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "46c280fdf7a3", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function withdraw(uint amount) {\n    if (credit[msg.sender]>= amount) {\n      // <yes> <report> REENTRANCY\n      bool res = msg.sender.call.value(amount)();\n      credit[msg.sender]-=amount;\n    }\n  }", "highlightLines": [16]}, "category": "code", "location": {"file": "dataset/reentrancy/simple_dao.sol", "line": 16, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "92eb15b77dca", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "      bool res = msg.sender.call.value(amount)();", "highlightLines": [19]}, "category": "code", "location": {"file": "dataset/reentrancy/simple_dao.sol", "line": 19, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d248dc97281a", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function queryCredit(address to) returns (uint){\n    return credit[to];\n  }", "highlightLines": [24]}, "category": "code", "location": {"file": "dataset/reentrancy/simple_dao.sol", "line": 24, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "91867ed95f96", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": " pragma solidity ^0.4.23;", "highlightLines": [9]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 9, "column": 2}, "severity": "info", "references": [], "description": ""}, {"id": "36629545b7ad", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": " pragma solidity ^0.4.23;", "highlightLines": [9]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 9, "column": 2}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "16a54c7af342", "fix": {"template": null, "available": false}, "title": "Unchecked subtraction can underflow in Solidity <0.8.0 - use SafeMath (Token pattern)", "ruleId": "rules.sol-integer-underflow-pre-080", "snippet": {"code": " pragma solidity ^0.4.23;\n // produced by the Solididy File Flattener (c) David Appleton 2018\n // contact : dave@akomba.com\n // released under Apache 2.0 licence\n contract Token {\n     /* This is a slight change to the ERC20 base standard.\n     function totalSupply() constant returns (uint256 supply);\n     is replaced with:\n     uint256 public totalSupply;\n     This automatically creates a getter function for the totalSupply.\n     This is moved to the base contract since public getter functions are not\n     currently recognised as an implementation of the matching abstract\n     function by the compiler.\n     */\n     /// total amount of tokens\n     uint256 public totalSupply;\n\n     /// @param _owner The address from which the balance will be retrieved\n     /// @return The balance\n     function balanceOf(address _owner) public constant returns (uint256 balance);\n\n     /// @notice send `_value` token to `_to` from `msg.sender`\n     /// @param _to The address of the recipient\n     /// @param _value The amount of token to be transferred\n     /// @return Whether the transfer was successful or not\n     function transfer(address _to, uint256 _value) public returns (bool success);\n\n     /// @notice send `_value` token to `_to` from `_from` on the condition it is approved by `_from`\n     /// @param _from The address of the sender\n     /// @param _to The address of the recipient\n     /// @param _value The amount of token to be transferred\n     /// @return Whether the transfer was successful or not\n     function transferFrom(address _from, address _to, uint256 _value) public returns (bool success);\n\n     /// @notice `msg.sender` approves `_spender` to spend `_value` tokens\n     /// @param _spender The address of the account able to transfer the tokens\n     /// @param _value The amount of tokens to be approved for transfer\n     /// @return Whether the approval was successful or not\n     function approve(address _spender, uint256 _value) public returns (bool success);\n\n     /// @param _owner The address of the account owning tokens\n     /// @param _spender The address of the account able to transfer the tokens\n     /// @return Amount of remaining tokens allowed to spent\n     function allowance(address _owner, address _spender) public constant returns (uint256 remaining);\n\n     event Transfer(address indexed _from, address indexed _to, uint256 _value);\n     event Approval(address indexed _owner, address indexed _spender, uint256 _value);\n }\n\n library ECTools {\n\n     // @dev Recovers the address which has signed a message\n     // @thanks https://gist.github.com/axic/5b33912c6f61ae6fd96d6c4a47afde6d\n     function recoverSigner(bytes32 _hashedMsg, string _sig) public pure returns (address) {\n         require(_hashedMsg != 0x00);\n\n         // need this for test RPC\n         bytes memory prefix = \"\\x19Ethereum Signed Message:\\n32\";\n         bytes32 prefixedHash = keccak256(abi.encodePacked(prefix, _hashedMsg));\n\n         if (bytes(_sig).length != 132) {\n             return 0x0;\n         }\n         bytes32 r;\n         bytes32 s;\n         uint8 v;\n         bytes memory sig = hexstrToBytes(substring(_sig, 2, 132));\n         assembly {\n             r := mload(add(sig, 32))\n             s := mload(add(sig, 64))\n             v := byte(0, mload(add(sig, 96)))\n         }\n         if (v < 27) {\n             v += 27;\n         }\n         if (v < 27 || v > 28) {\n             return 0x0;\n         }\n         return ecrecover(prefixedHash, v, r, s);\n     }\n\n     // @dev Verifies if the message is signed by an address\n     function isSignedBy(bytes32 _hashedMsg, string _sig, address _addr) public pure returns (bool) {\n         require(_addr != 0x0);\n\n         return _addr == recoverSigner(_hashedMsg, _sig);\n     }\n\n     // @dev Converts an hexstring to bytes\n     function hexstrToBytes(string _hexstr) public pure returns (bytes) {\n         uint len = bytes(_hexstr).length;\n         require(len % 2 == 0);\n\n         bytes memory bstr = bytes(new string(len / 2));\n         uint k = 0;\n         string memory s;\n         string memory r;\n         for (uint i = 0; i < len; i += 2) {\n             s = substring(_hexstr, i, i + 1);\n             r = substring(_hexstr, i + 1, i + 2);\n             uint p = parseInt16Char(s) * 16 + parseInt16Char(r);\n             bstr[k++] = uintToBytes32(p)[31];\n         }\n         return bstr;\n     }\n\n     // @dev Parses a hexchar, like 'a', and returns its hex value, in this case 10\n     function parseInt16Char(string _char) public pure returns (uint) {\n         bytes memory bresult = bytes(_char);\n         // bool decimals = false;\n         if ((bresult[0] >= 48) && (bresult[0] <= 57)) {\n             return uint(bresult[0]) - 48;\n         } else if ((bresult[0] >= 65) && (bresult[0] <= 70)) {\n             return uint(bresult[0]) - 55;\n         } else if ((bresult[0] >= 97) && (bresult[0] <= 102)) {\n             return uint(bresult[0]) - 87;\n         } else {\n             revert();\n         }\n     }\n\n     // @dev Converts a uint to a bytes32\n     // @thanks https://ethereum.stackexchange.com/questions/4170/how-to-convert-a-uint-to-bytes-in-solidity\n     function uintToBytes32(uint _uint) public pure returns (bytes b) {\n         b = new bytes(32);\n         assembly {mstore(add(b, 32), _uint)}\n     }\n\n     // @dev Hashes the signed message\n     // @ref https://github.com/ethereum/go-ethereum/issues/3731#issuecomment-293866868\n     function toEthereumSignedMessage(string _msg) public pure returns (bytes32) {\n         uint len = bytes(_msg).length;\n         require(len > 0);\n         bytes memory prefix = \"\\x19Ethereum Signed Message:\\n\";\n         return keccak256(abi.encodePacked(prefix, uintToString(len), _msg));\n     }\n\n     // @dev Converts a uint in a string\n     function uintToString(uint _uint) public pure returns (string str) {\n         uint len = 0;\n         uint m = _uint + 0;\n         while (m != 0) {\n             len++;\n             m /= 10;\n         }\n         bytes memory b = new bytes(len);\n         uint i = len - 1;\n         while (_uint != 0) {\n             uint remainder = _uint % 10;\n             _uint = _uint / 10;\n             b[i--] = byte(48 + remainder);\n         }\n         str = string(b);\n     }\n\n\n     // @dev extract a substring\n     // @thanks https://ethereum.stackexchange.com/questions/31457/substring-in-solidity\n     function substring(string _str, uint _startIndex, uint _endIndex) public pure returns (string) {\n         bytes memory strBytes = bytes(_str);\n         require(_startIndex <= _endIndex);\n         require(_startIndex >= 0);\n         require(_endIndex <= strBytes.length);\n\n         bytes memory result = new bytes(_endIndex - _startIndex);\n         for (uint i = _startIndex; i < _endIndex; i++) {\n             result[i - _startIndex] = strBytes[i];\n         }\n         return string(result);\n     }\n }\n contract StandardToken is Token {\n\n     function transfer(address _to, uint256 _value) public returns (bool success) {\n         //Default assumes totalSupply can't be over max (2^256 - 1).\n         //If your token leaves out totalSupply and can issue more tokens as time goes on, you need to check if it doesn't wrap.\n         //Replace the if with this one instead.\n         //require(balances[msg.sender] >= _value && balances[_to] + _value > balances[_to]);\n         require(balances[msg.sender] >= _value);\n         balances[msg.sender] -= _value;\n         balances[_to] += _value;\n         emit Transfer(msg.sender, _to, _value);\n         return true;\n     }\n\n     function transferFrom(address _from, address _to, uint256 _value) public returns (bool success) {\n         //same as above. Replace this line with the following if you want to protect against wrapping uints.\n         //require(balances[_from] >= _value && allowed[_from][msg.sender] >= _value && balances[_to] + _value > balances[_to]);\n         require(balances[_from] >= _value && allowed[_from][msg.sender] >= _value);\n         balances[_to] += _value;\n         balances[_from] -= _value;", "highlightLines": [9]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 9, "column": 2}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/level/5"], "description": ""}, {"id": "b5c047a45d22", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "     function balanceOf(address _owner) public constant returns (uint256 balance);", "highlightLines": [28]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 28, "column": 6}, "severity": "info", "references": [], "description": ""}, {"id": "b5a5f1abbb8c", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "     function transfer(address _to, uint256 _value) public returns (bool success);", "highlightLines": [34]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 34, "column": 6}, "severity": "info", "references": [], "description": ""}, {"id": "36eef95c5cf4", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "     function transfer(address _to, uint256 _value) public returns (bool success);\n\n     /// @notice send `_value` token to `_to` from `_from` on the condition it is approved by `_from`\n     /// @param _from The address of the sender\n     /// @param _to The address of the recipient\n     /// @param _value The amount of token to be transferred\n     /// @return Whether the transfer was successful or not\n     function transferFrom(address _from, address _to, uint256 _value) public returns (bool success);\n\n     /// @notice `msg.sender` approves `_spender` to spend `_value` tokens\n     /// @param _spender The address of the account able to transfer the tokens\n     /// @param _value The amount of tokens to be approved for transfer\n     /// @return Whether the approval was successful or not\n     function approve(address _spender, uint256 _value) public returns (bool success);\n\n     /// @param _owner The address of the account owning tokens\n     /// @param _spender The address of the account able to transfer the tokens\n     /// @return Amount of remaining tokens allowed to spent\n     function allowance(address _owner, address _spender) public constant returns (uint256 remaining);\n\n     event Transfer(address indexed _from, address indexed _to, uint256 _value);\n     event Approval(address indexed _owner, address indexed _spender, uint256 _value);\n }\n\n library ECTools {", "highlightLines": [34]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 34, "column": 6}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "1106bbb8219d", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without msg.data.length validation - vulnerable to short address attack padding", "ruleId": "rules.sol-short-address-no-payload-check", "snippet": {"code": "     function transfer(address _to, uint256 _value) public returns (bool success);\n\n     /// @notice send `_value` token to `_to` from `_from` on the condition it is approved by `_from`\n     /// @param _from The address of the sender\n     /// @param _to The address of the recipient\n     /// @param _value The amount of token to be transferred\n     /// @return Whether the transfer was successful or not\n     function transferFrom(address _from, address _to, uint256 _value) public returns (bool success);\n\n     /// @notice `msg.sender` approves `_spender` to spend `_value` tokens\n     /// @param _spender The address of the account able to transfer the tokens\n     /// @param _value The amount of tokens to be approved for transfer\n     /// @return Whether the approval was successful or not\n     function approve(address _spender, uint256 _value) public returns (bool success);\n\n     /// @param _owner The address of the account owning tokens\n     /// @param _spender The address of the account able to transfer the tokens\n     /// @return Amount of remaining tokens allowed to spent\n     function allowance(address _owner, address _spender) public constant returns (uint256 remaining);\n\n     event Transfer(address indexed _from, address indexed _to, uint256 _value);\n     event Approval(address indexed _owner, address indexed _spender, uint256 _value);\n }\n\n library ECTools {", "highlightLines": [34]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 34, "column": 6}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address", "https://vessenes.com/the-erc20-short-address-attack-explained/"], "description": ""}, {"id": "e6fe30fcb00f", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "     function transferFrom(address _from, address _to, uint256 _value) public returns (bool success);", "highlightLines": [41]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 41, "column": 6}, "severity": "info", "references": [], "description": ""}, {"id": "6be17e783ce4", "fix": {"template": null, "available": false}, "title": "ERC20 transferFrom without payload size validation - consider adding onlyPayloadSize modifier", "ruleId": "rules.sol-erc20-missing-payload-modifier", "snippet": {"code": "     function transferFrom(address _from, address _to, uint256 _value) public returns (bool success);\n\n     /// @notice `msg.sender` approves `_spender` to spend `_value` tokens\n     /// @param _spender The address of the account able to transfer the tokens\n     /// @param _value The amount of tokens to be approved for transfer\n     /// @return Whether the approval was successful or not\n     function approve(address _spender, uint256 _value) public returns (bool success);\n\n     /// @param _owner The address of the account owning tokens\n     /// @param _spender The address of the account able to transfer the tokens\n     /// @return Amount of remaining tokens allowed to spent\n     function allowance(address _owner, address _spender) public constant returns (uint256 remaining);\n\n     event Transfer(address indexed _from, address indexed _to, uint256 _value);\n     event Approval(address indexed _owner, address indexed _spender, uint256 _value);\n }\n\n library ECTools {", "highlightLines": [41]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 41, "column": 6}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address"], "description": ""}, {"id": "fdcd67e35993", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "     function approve(address _spender, uint256 _value) public returns (bool success);", "highlightLines": [47]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 47, "column": 6}, "severity": "info", "references": [], "description": ""}, {"id": "68b8eebc1ce0", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "     /// @return Amount of remaining tokens allowed to spent\n     function allowance(address _owner, address _spender) public constant returns (uint256 remaining);\n\n     event Transfer(address indexed _from, address indexed _to, uint256 _value);", "highlightLines": [51]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 51, "column": 11}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "f2b205bf8f06", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "     function allowance(address _owner, address _spender) public constant returns (uint256 remaining);", "highlightLines": [52]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 52, "column": 6}, "severity": "info", "references": [], "description": ""}, {"id": "13b0a13d9d1a", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "     event Transfer(address indexed _from, address indexed _to, uint256 _value);", "highlightLines": [54]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 54, "column": 6}, "severity": "info", "references": [], "description": ""}, {"id": "0f59d243deed", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "     event Approval(address indexed _owner, address indexed _spender, uint256 _value);", "highlightLines": [55]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 55, "column": 6}, "severity": "info", "references": [], "description": ""}, {"id": "670447080ed4", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "     function recoverSigner(bytes32 _hashedMsg, string _sig) public pure returns (address) {\n         require(_hashedMsg != 0x00);\n\n         // need this for test RPC\n         bytes memory prefix = \"\\x19Ethereum Signed Message:\\n32\";\n         bytes32 prefixedHash = keccak256(abi.encodePacked(prefix, _hashedMsg));", "highlightLines": [62]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 62, "column": 6}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "2aaf1ddcc31b", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "         require(_hashedMsg != 0x00);", "highlightLines": [63]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 63, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "1cb1d05f79b9", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         bytes memory prefix = \"\\x19Ethereum Signed Message:\\n32\";\n         bytes32 prefixedHash = keccak256(abi.encodePacked(prefix, _hashedMsg));", "highlightLines": [66]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 66, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "5a22cda66f9d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "         bytes32 prefixedHash = keccak256(abi.encodePacked(prefix, _hashedMsg));", "highlightLines": [67]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 67, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "90a71979d000", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         bytes32 prefixedHash = keccak256(abi.encodePacked(prefix, _hashedMsg));\n\n         if (bytes(_sig).length != 132) {\n             return 0x0;\n         }\n         bytes32 r;\n         bytes32 s;\n         uint8 v;\n         bytes memory sig = hexstrToBytes(substring(_sig, 2, 132));", "highlightLines": [67]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 67, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "74ec44af06be", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "         bytes32 prefixedHash = keccak256(abi.encodePacked(prefix, _hashedMsg));", "highlightLines": [67]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 67, "column": 33}, "severity": "high", "references": [], "description": ""}, {"id": "dec578dd9159", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "         bytes32 prefixedHash = keccak256(abi.encodePacked(prefix, _hashedMsg));", "highlightLines": [67]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 67, "column": 43}, "severity": "medium", "references": [], "description": ""}, {"id": "4e2fd425430a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "         bytes32 r;", "highlightLines": [72]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 72, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "9d44fc4c3103", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "         bytes32 s;", "highlightLines": [73]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 73, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "560902b5f3d0", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "         uint8 v;", "highlightLines": [74]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 74, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "dfdc766e76ad", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         bytes memory sig = hexstrToBytes(substring(_sig, 2, 132));\n         assembly {\n             r := mload(add(sig, 32))\n             s := mload(add(sig, 64))\n             v := byte(0, mload(add(sig, 96)))\n         }", "highlightLines": [75]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 75, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "25e7474c55a8", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "         assembly {", "highlightLines": [76]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 76, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "24c5db67472a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "             r := mload(add(sig, 32))\n             s := mload(add(sig, 64))", "highlightLines": [77]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 77, "column": 14}, "severity": "medium", "references": [], "description": ""}, {"id": "50d5b0a64d04", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "             s := mload(add(sig, 64))\n             v := byte(0, mload(add(sig, 96)))", "highlightLines": [78]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 78, "column": 14}, "severity": "medium", "references": [], "description": ""}, {"id": "44fcfbd662ad", "fix": {"template": null, "available": false}, "title": "ecrecover is vulnerable to signature malleability - use OpenZeppelin ECDSA", "ruleId": "rules.sol-ecrecover-malleable", "snippet": {"code": "         return ecrecover(prefixedHash, v, r, s);", "highlightLines": [87]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 87, "column": 17}, "severity": "medium", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/utils/cryptography/ECDSA.sol"], "description": ""}, {"id": "5b6a7a92cce7", "fix": {"template": null, "available": false}, "title": "ecrecover result not checked for zero address - invalid signatures return address(0)", "ruleId": "rules.sol-ethernaut-ecrecover-no-zero-check", "snippet": {"code": "         return ecrecover(prefixedHash, v, r, s);", "highlightLines": [87]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 87, "column": 17}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-117", "https://swcregistry.io/docs/SWC-122"], "description": ""}, {"id": "54f23a40a4d6", "fix": {"template": null, "available": false}, "title": "Signature verification without s-value malleability check - signatures can be replayed with modified s", "ruleId": "rules.sol-ethernaut-signature-malleability", "snippet": {"code": "         return ecrecover(prefixedHash, v, r, s);", "highlightLines": [87]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 87, "column": 17}, "severity": "medium", "references": ["https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/utils/cryptography/ECDSA.sol"], "description": ""}, {"id": "cc3b7e4d7ec6", "fix": {"template": null, "available": false}, "title": "ECDSA signature without s-value check - signature malleability possible", "ruleId": "rules.sol-signature-malleability", "snippet": {"code": "         return ecrecover(prefixedHash, v, r, s);", "highlightLines": [87]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 87, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "fea2568d25a6", "fix": {"template": null, "available": false}, "title": "Signature verification without domain separator - cross-contract replay possible", "ruleId": "rules.sol-signature-no-domain-separator", "snippet": {"code": "         return ecrecover(prefixedHash, v, r, s);", "highlightLines": [87]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 87, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "3f52b1ec6f8d", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "     function isSignedBy(bytes32 _hashedMsg, string _sig, address _addr) public pure returns (bool) {\n         require(_addr != 0x0);", "highlightLines": [91]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 91, "column": 6}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "846752ce78b4", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "     function isSignedBy(bytes32 _hashedMsg, string _sig, address _addr) public pure returns (bool) {\n         require(_addr != 0x0);\n\n         return _addr == recoverSigner(_hashedMsg, _sig);", "highlightLines": [91]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 91, "column": 6}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "b030dfa32961", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "         require(_addr != 0x0);", "highlightLines": [92]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 92, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "fc46859a21b4", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "     function hexstrToBytes(string _hexstr) public pure returns (bytes) {\n         uint len = bytes(_hexstr).length;\n         require(len % 2 == 0);\n\n         bytes memory bstr = bytes(new string(len / 2));\n         uint k = 0;\n         string memory s;\n         string memory r;\n         for (uint i = 0; i < len; i += 2) {\n             s = substring(_hexstr, i, i + 1);\n             r = substring(_hexstr, i + 1, i + 2);\n             uint p = parseInt16Char(s) * 16 + parseInt16Char(r);", "highlightLines": [98]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 98, "column": 6}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "a82dc338fd33", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "         uint len = bytes(_hexstr).length;", "highlightLines": [99]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 99, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "2ee7a7b4b117", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         uint len = bytes(_hexstr).length;\n         require(len % 2 == 0);\n\n         bytes memory bstr = bytes(new string(len / 2));", "highlightLines": [99]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 99, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "9366117b51f8", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "         require(len % 2 == 0);", "highlightLines": [100]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 100, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "ef2d07187174", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         bytes memory bstr = bytes(new string(len / 2));\n         uint k = 0;", "highlightLines": [102]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 102, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "b3e5bb1d7b17", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "         bytes memory bstr = bytes(new string(len / 2));", "highlightLines": [102]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 102, "column": 36}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "e53cb486e848", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "         uint k = 0;", "highlightLines": [103]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 103, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a026011a3dbd", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         uint k = 0;\n         string memory s;\n         string memory r;\n         for (uint i = 0; i < len; i += 2) {\n             s = substring(_hexstr, i, i + 1);\n             r = substring(_hexstr, i + 1, i + 2);\n             uint p = parseInt16Char(s) * 16 + parseInt16Char(r);\n             bstr[k++] = uintToBytes32(p)[31];\n         }", "highlightLines": [103]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 103, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "d3d2abf8ab94", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "             s = substring(_hexstr, i, i + 1);\n             r = substring(_hexstr, i + 1, i + 2);", "highlightLines": [107]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 107, "column": 14}, "severity": "medium", "references": [], "description": ""}, {"id": "148803e7ac15", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "             r = substring(_hexstr, i + 1, i + 2);\n             uint p = parseInt16Char(s) * 16 + parseInt16Char(r);", "highlightLines": [108]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 108, "column": 14}, "severity": "medium", "references": [], "description": ""}, {"id": "475fb595c78a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "             uint p = parseInt16Char(s) * 16 + parseInt16Char(r);", "highlightLines": [109]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 109, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7829cbb13916", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "             uint p = parseInt16Char(s) * 16 + parseInt16Char(r);\n             bstr[k++] = uintToBytes32(p)[31];", "highlightLines": [109]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 109, "column": 14}, "severity": "medium", "references": [], "description": ""}, {"id": "df51b11385ad", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "     function parseInt16Char(string _char) public pure returns (uint) {\n         bytes memory bresult = bytes(_char);\n         // bool decimals = false;", "highlightLines": [116]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 116, "column": 6}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "fd3c71284d8c", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "             return uint(bresult[0]) - 48;", "highlightLines": [120]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 120, "column": 21}, "severity": "info", "references": [], "description": ""}, {"id": "2c62c8cf8506", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "             return uint(bresult[0]) - 55;", "highlightLines": [122]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 122, "column": 21}, "severity": "info", "references": [], "description": ""}, {"id": "6754b82a13a2", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "             return uint(bresult[0]) - 87;", "highlightLines": [124]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 124, "column": 21}, "severity": "info", "references": [], "description": ""}, {"id": "73046f59cbc8", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "     function uintToBytes32(uint _uint) public pure returns (bytes b) {\n         b = new bytes(32);", "highlightLines": [132]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 132, "column": 6}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "85ae5676e8d1", "fix": {"template": null, "available": false}, "title": "View/pure function uses assembly - may modify state unexpectedly", "ruleId": "rules.sol-constant-function-assembly", "snippet": {"code": "     function uintToBytes32(uint _uint) public pure returns (bytes b) {\n         b = new bytes(32);\n         assembly {mstore(add(b, 32), _uint)}", "highlightLines": [132]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 132, "column": 6}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-using-assembly-code"], "description": ""}, {"id": "090f61ba2d4d", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "         b = new bytes(32);", "highlightLines": [133]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 133, "column": 14}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "9ecf529cc263", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "         assembly {mstore(add(b, 32), _uint)}", "highlightLines": [134]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 134, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "c849a98e88b3", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "     function toEthereumSignedMessage(string _msg) public pure returns (bytes32) {\n         uint len = bytes(_msg).length;\n         require(len > 0);\n         bytes memory prefix = \"\\x19Ethereum Signed Message:\\n\";", "highlightLines": [139]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 139, "column": 6}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "9e42f9382264", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "         uint len = bytes(_msg).length;", "highlightLines": [140]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 140, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3bf4587e2c2e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         uint len = bytes(_msg).length;\n         require(len > 0);\n         bytes memory prefix = \"\\x19Ethereum Signed Message:\\n\";", "highlightLines": [140]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 140, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "7b4a6f70fc04", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "         require(len > 0);", "highlightLines": [141]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 141, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "17f851b1ad8a", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "         return keccak256(abi.encodePacked(prefix, uintToString(len), _msg));", "highlightLines": [143]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 143, "column": 17}, "severity": "high", "references": [], "description": ""}, {"id": "08cdf15dce8e", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "         return keccak256(abi.encodePacked(prefix, uintToString(len), _msg));", "highlightLines": [143]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 143, "column": 27}, "severity": "medium", "references": [], "description": ""}, {"id": "b7c564a678a9", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "     function uintToString(uint _uint) public pure returns (string str) {\n         uint len = 0;\n         uint m = _uint + 0;", "highlightLines": [147]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 147, "column": 6}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "2d5a3a975d76", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "         uint len = 0;", "highlightLines": [148]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 148, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8ef861a0b756", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         uint len = 0;\n         uint m = _uint + 0;", "highlightLines": [148]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 148, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "76990da42e72", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "         uint m = _uint + 0;", "highlightLines": [149]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 149, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0044f55e591b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         uint m = _uint + 0;\n         while (m != 0) {\n             len++;\n             m /= 10;\n         }\n         bytes memory b = new bytes(len);", "highlightLines": [149]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 149, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "aac013fd85e6", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         bytes memory b = new bytes(len);\n         uint i = len - 1;", "highlightLines": [154]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 154, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "9d4ccf1716cb", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "         bytes memory b = new bytes(len);", "highlightLines": [154]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 154, "column": 27}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "fe0cfd24a689", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "         uint i = len - 1;", "highlightLines": [155]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 155, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "64f574f8db6d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         uint i = len - 1;\n         while (_uint != 0) {\n             uint remainder = _uint % 10;\n             _uint = _uint / 10;\n             b[i--] = byte(48 + remainder);\n         }", "highlightLines": [155]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 155, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "8d1f83f68d8b", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "             uint remainder = _uint % 10;", "highlightLines": [157]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 157, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0bf24f6be03c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "             uint remainder = _uint % 10;\n             _uint = _uint / 10;", "highlightLines": [157]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 157, "column": 14}, "severity": "medium", "references": [], "description": ""}, {"id": "fd5653bcf42c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "             _uint = _uint / 10;\n             b[i--] = byte(48 + remainder);", "highlightLines": [158]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 158, "column": 14}, "severity": "medium", "references": [], "description": ""}, {"id": "8ef53bce5daa", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "     function substring(string _str, uint _startIndex, uint _endIndex) public pure returns (string) {\n         bytes memory strBytes = bytes(_str);\n         require(_startIndex <= _endIndex);\n         require(_startIndex >= 0);\n         require(_endIndex <= strBytes.length);\n\n         bytes memory result = new bytes(_endIndex - _startIndex);\n         for (uint i = _startIndex; i < _endIndex; i++) {", "highlightLines": [167]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 167, "column": 6}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "fa553bf73649", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         bytes memory strBytes = bytes(_str);\n         require(_startIndex <= _endIndex);\n         require(_startIndex >= 0);\n         require(_endIndex <= strBytes.length);\n\n         bytes memory result = new bytes(_endIndex - _startIndex);", "highlightLines": [168]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 168, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "a583b8199961", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "         require(_startIndex <= _endIndex);", "highlightLines": [169]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 169, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "81ca66f46d36", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "         require(_startIndex >= 0);", "highlightLines": [170]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 170, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "a2d93522ca8b", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "         require(_endIndex <= strBytes.length);", "highlightLines": [171]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 171, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "b3f0803d69c4", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         bytes memory result = new bytes(_endIndex - _startIndex);\n         for (uint i = _startIndex; i < _endIndex; i++) {\n             result[i - _startIndex] = strBytes[i];\n         }", "highlightLines": [173]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 173, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "70cfb159556e", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "         bytes memory result = new bytes(_endIndex - _startIndex);", "highlightLines": [173]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 173, "column": 32}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "f1da4937cbce", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "     function transfer(address _to, uint256 _value) public returns (bool success) {", "highlightLines": [182]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 182, "column": 6}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "fcf83eb1cfba", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without msg.data.length validation - vulnerable to short address attack padding", "ruleId": "rules.sol-short-address-no-payload-check", "snippet": {"code": "     function transfer(address _to, uint256 _value) public returns (bool success) {", "highlightLines": [182]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 182, "column": 6}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address", "https://vessenes.com/the-erc20-short-address-attack-explained/"], "description": ""}, {"id": "f925320f6a9f", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "     function transfer(address _to, uint256 _value) public returns (bool success) {\n         //Default assumes totalSupply can't be over max (2^256 - 1).\n         //If your token leaves out totalSupply and can issue more tokens as time goes on, you need to check if it doesn't wrap.\n         //Replace the if with this one instead.\n         //require(balances[msg.sender] >= _value && balances[_to] + _value > balances[_to]);\n         require(balances[msg.sender] >= _value);", "highlightLines": [182]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 182, "column": 6}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "6a54d361d644", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - will never return false, only revert", "ruleId": "rules.sol-return-bool-always-reverts", "snippet": {"code": "     function transfer(address _to, uint256 _value) public returns (bool success) {\n         //Default assumes totalSupply can't be over max (2^256 - 1).\n         //If your token leaves out totalSupply and can issue more tokens as time goes on, you need to check if it doesn't wrap.\n         //Replace the if with this one instead.\n         //require(balances[msg.sender] >= _value && balances[_to] + _value > balances[_to]);\n         require(balances[msg.sender] >= _value);\n         balances[msg.sender] -= _value;\n         balances[_to] += _value;\n         emit Transfer(msg.sender, _to, _value);\n         return true;\n     }", "highlightLines": [182]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 182, "column": 6}, "severity": "info", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "fb7d35d3de19", "fix": {"template": null, "available": false}, "title": "Possible incorrect exponentiation - ^ is XOR in Solidity, use ** for power", "ruleId": "rules.sol-incorrect-exponentiation", "snippet": {"code": "         //Default assumes totalSupply can't be over max (2^256 - 1).", "highlightLines": [183]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 183, "column": 59}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-exponentiation"], "description": ""}, {"id": "c0132fbee154", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "         require(balances[msg.sender] >= _value);", "highlightLines": [187]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 187, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "606d3fa0573b", "fix": {"template": null, "available": false}, "title": "ERC20 transferFrom without payload size validation - consider adding onlyPayloadSize modifier", "ruleId": "rules.sol-erc20-missing-payload-modifier", "snippet": {"code": "     function transferFrom(address _from, address _to, uint256 _value) public returns (bool success) {", "highlightLines": [194]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 194, "column": 6}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address"], "description": ""}, {"id": "168ce726c0f0", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "     function transferFrom(address _from, address _to, uint256 _value) public returns (bool success) {", "highlightLines": [194]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 194, "column": 6}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "5ff43ae4dcdb", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "     function transferFrom(address _from, address _to, uint256 _value) public returns (bool success) {\n         //same as above. Replace this line with the following if you want to protect against wrapping uints.\n         //require(balances[_from] >= _value && allowed[_from][msg.sender] >= _value && balances[_to] + _value > balances[_to]);\n         require(balances[_from] >= _value && allowed[_from][msg.sender] >= _value);", "highlightLines": [194]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 194, "column": 6}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "5d7726856f55", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - will never return false, only revert", "ruleId": "rules.sol-return-bool-always-reverts", "snippet": {"code": "     function transferFrom(address _from, address _to, uint256 _value) public returns (bool success) {\n         //same as above. Replace this line with the following if you want to protect against wrapping uints.\n         //require(balances[_from] >= _value && allowed[_from][msg.sender] >= _value && balances[_to] + _value > balances[_to]);\n         require(balances[_from] >= _value && allowed[_from][msg.sender] >= _value);\n         balances[_to] += _value;\n         balances[_from] -= _value;\n         allowed[_from][msg.sender] -= _value;\n         emit Transfer(_from, _to, _value);\n         return true;\n     }", "highlightLines": [194]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 194, "column": 6}, "severity": "info", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "d67f97940f90", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "         require(balances[_from] >= _value && allowed[_from][msg.sender] >= _value);", "highlightLines": [197]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 197, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "b48b92506d57", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "     function approve(address _spender, uint256 _value) public returns (bool success) {", "highlightLines": [209]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 209, "column": 6}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "c8fcaad051a7", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": " contract HumanStandardToken is StandardToken {\n\n     /* Public variables of the token */\n\n     /*\n     NOTE:\n     The following variables are OPTIONAL vanities. One does not have to include them.\n     They allow one to customise the token contract & in no way influences the core functionality.\n     Some wallets/interfaces might not even bother to look at this information.\n     */\n     string public name;                   //fancy name: eg Simon Bucks\n     uint8 public decimals;                //How many decimals to show. ie. There could 1000 base units with 3 decimals. Meaning 0.980 SBX = 980 base units. It's like comparing 1 wei to 1 ether.\n     string public symbol;                 //An identifier: eg SBX\n     string public version = 'H0.1';       //human 0.1 standard. Just an arbitrary versioning scheme.", "highlightLines": [223]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 223, "column": 2}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "bc683c4cb31c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         balances[msg.sender] = _initialAmount;               // Give the creator all initial tokens\n         totalSupply = _initialAmount;                        // Update total supply", "highlightLines": [244]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 244, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "2f94f3102b81", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         totalSupply = _initialAmount;                        // Update total supply\n         name = _tokenName;                                   // Set the name for display purposes", "highlightLines": [245]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 245, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "a0b1daa9ff43", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         name = _tokenName;                                   // Set the name for display purposes\n         decimals = _decimalUnits;                            // Amount of decimals for display purposes", "highlightLines": [246]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 246, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "757c2581f38c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         decimals = _decimalUnits;                            // Amount of decimals for display purposes\n         symbol = _tokenSymbol;                               // Set the symbol for display purposes", "highlightLines": [247]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 247, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "f8b83794a63b", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "     function approveAndCall(address _spender, uint256 _value, bytes _extraData) public returns (bool success) {\n         allowed[msg.sender][_spender] = _value;\n         emit Approval(msg.sender, _spender, _value);\n\n         //call the receiveApproval function on the contract you want to be notified. This crafts the function signature manually so one doesn't have to include a contract in here just for this.\n         //receiveApproval(address _from, uint256 _value, address _tokenContract, bytes _extraData)\n         //it is assumed that when does this that the call *should* succeed, otherwise one would use vanilla approve instead.\n         require(_spender.call(bytes4(bytes32(keccak256(\"receiveApproval(address,uint256,address,bytes)\"))), msg.sender, _value, this, _extraData));", "highlightLines": [252]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 252, "column": 6}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "3a640878e01d", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - will never return false, only revert", "ruleId": "rules.sol-return-bool-always-reverts", "snippet": {"code": "     function approveAndCall(address _spender, uint256 _value, bytes _extraData) public returns (bool success) {\n         allowed[msg.sender][_spender] = _value;\n         emit Approval(msg.sender, _spender, _value);\n\n         //call the receiveApproval function on the contract you want to be notified. This crafts the function signature manually so one doesn't have to include a contract in here just for this.\n         //receiveApproval(address _from, uint256 _value, address _tokenContract, bytes _extraData)\n         //it is assumed that when does this that the call *should* succeed, otherwise one would use vanilla approve instead.\n         require(_spender.call(bytes4(bytes32(keccak256(\"receiveApproval(address,uint256,address,bytes)\"))), msg.sender, _value, this, _extraData));\n         return true;\n     }", "highlightLines": [252]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 252, "column": 6}, "severity": "info", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "8f02656e9aef", "fix": {"template": null, "available": false}, "title": "approveAndCall pattern enables callback attacks - verify callback target", "ruleId": "rules.sol-approve-and-call-callback", "snippet": {"code": "     function approveAndCall(address _spender, uint256 _value, bytes _extraData) public returns (bool success) {", "highlightLines": [252]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 252, "column": 15}, "severity": "medium", "references": [], "description": ""}, {"id": "dbe5e2f45cbb", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "         require(_spender.call(bytes4(bytes32(keccak256(\"receiveApproval(address,uint256,address,bytes)\"))), msg.sender, _value, this, _extraData));", "highlightLines": [259]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 259, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "35a93f7e7438", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "         require(_spender.call(bytes4(bytes32(keccak256(\"receiveApproval(address,uint256,address,bytes)\"))), msg.sender, _value, this, _extraData));", "highlightLines": [259]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 259, "column": 18}, "severity": "medium", "references": [], "description": ""}, {"id": "c1977420e8a3", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "     event DidLCOpen (\n         bytes32 indexed channelId,\n         address indexed partyA,\n         address indexed partyI,\n         uint256 ethBalanceA,\n         address token,\n         uint256 tokenBalanceA,\n         uint256 LCopenTimeout\n     );", "highlightLines": [271]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 271, "column": 6}, "severity": "info", "references": [], "description": ""}, {"id": "377590133280", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "     event DidLCJoin (\n         bytes32 indexed channelId,\n         uint256 ethBalanceI,\n         uint256 tokenBalanceI\n     );", "highlightLines": [281]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 281, "column": 6}, "severity": "info", "references": [], "description": ""}, {"id": "f2b68f471f45", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "     event DidLCDeposit (\n         bytes32 indexed channelId,\n         address indexed recipient,\n         uint256 deposit,\n         bool isToken\n     );", "highlightLines": [287]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 287, "column": 6}, "severity": "info", "references": [], "description": ""}, {"id": "26c2959a5561", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "     event DidLCUpdateState (\n         bytes32 indexed channelId,\n         uint256 sequence,\n         uint256 numOpenVc,\n         uint256 ethBalanceA,\n         uint256 tokenBalanceA,\n         uint256 ethBalanceI,\n         uint256 tokenBalanceI,\n         bytes32 vcRoot,\n         uint256 updateLCtimeout\n     );", "highlightLines": [294]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 294, "column": 6}, "severity": "info", "references": [], "description": ""}, {"id": "3f799a9d0316", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "     event DidLCClose (\n         bytes32 indexed channelId,\n         uint256 sequence,\n         uint256 ethBalanceA,\n         uint256 tokenBalanceA,\n         uint256 ethBalanceI,\n         uint256 tokenBalanceI\n     );", "highlightLines": [306]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 306, "column": 6}, "severity": "info", "references": [], "description": ""}, {"id": "2cfd7e89f95d", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "     event DidVCInit (\n         bytes32 indexed lcId,\n         bytes32 indexed vcId,\n         bytes proof,\n         uint256 sequence,\n         address partyA,\n         address partyB,\n         uint256 balanceA,\n         uint256 balanceB\n     );", "highlightLines": [315]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 315, "column": 6}, "severity": "info", "references": [], "description": ""}, {"id": "82a892be58cf", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "     event DidVCSettle (\n         bytes32 indexed lcId,\n         bytes32 indexed vcId,\n         uint256 updateSeq,\n         uint256 updateBalA,\n         uint256 updateBalB,\n         address challenger,\n         uint256 updateVCtimeout\n     );", "highlightLines": [326]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 326, "column": 6}, "severity": "info", "references": [], "description": ""}, {"id": "135190de861e", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "     event DidVCClose(\n         bytes32 indexed lcId,\n         bytes32 indexed vcId,\n         uint256 balanceA,\n         uint256 balanceB\n     );", "highlightLines": [336]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 336, "column": 6}, "severity": "info", "references": [], "description": ""}, {"id": "8be2b8664d36", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "         uint256 sequence;", "highlightLines": [349]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 349, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "dd0a2205f9b2", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "         uint256 confirmTime;", "highlightLines": [350]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 350, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "13189e6922e7", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "         bytes32 VCrootHash;", "highlightLines": [351]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 351, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "197f3ff61331", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "         uint256 LCopenTimeout;", "highlightLines": [352]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 352, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f3b93d8782ba", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "         uint256 updateLCtimeout; // when update LC times out", "highlightLines": [353]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 353, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d40fc3d29f1c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "         bool isOpen; // true when both parties have joined", "highlightLines": [354]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 354, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3c63af3fae53", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "         bool isUpdateLCSettling;", "highlightLines": [355]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 355, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3abe62c03676", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "         uint256 numOpenVC;", "highlightLines": [356]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 356, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "17b7e9a7f017", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "         bool isClose;", "highlightLines": [362]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 362, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "980bbdd0abd2", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "         bool isInSettlementState;", "highlightLines": [363]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 363, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "1d6b1f31d7a7", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "         uint256 sequence;", "highlightLines": [364]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 364, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "bf14ad056497", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "         address challenger; // Initiator of challenge", "highlightLines": [365]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 365, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e0ab39262229", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "         uint256 updateVCtimeout; // when update VC times out", "highlightLines": [366]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 366, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "516ffe0fbeb7", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "         address partyA; // VC participant A", "highlightLines": [368]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 368, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "672406d5b408", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "         address partyB; // VC participant B", "highlightLines": [369]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 369, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "1aa29dbf0508", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "         address partyI; // LC hub", "highlightLines": [370]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 370, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "617992d9a833", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         Channels[_lcID].partyAddresses[0] = msg.sender;\n         Channels[_lcID].partyAddresses[1] = _partyI;", "highlightLines": [397]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 397, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "d9bcd1c2db36", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         Channels[_lcID].partyAddresses[1] = _partyI;\n\n         if(_balances[0] != 0) {\n             require(msg.value == _balances[0], \"Eth balance does not match sent value\");\n             Channels[_lcID].ethBalances[0] = msg.value;\n         }", "highlightLines": [398]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 398, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "3ccad5757aa8", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "             Channels[_lcID].token = HumanStandardToken(_token);\n             require(Channels[_lcID].token.transferFrom(msg.sender, this, _balances[1]),\"CreateChannel: token transfer failure\");\n             Channels[_lcID].erc20Balances[0] = _balances[1];", "highlightLines": [405]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 405, "column": 14}, "severity": "medium", "references": [], "description": ""}, {"id": "0a7a5e62d5d1", "fix": {"template": null, "available": false}, "title": "Token transfer without checking actual received amount - deflationary tokens may transfer less", "ruleId": "rules.sol-deflationary-token-transfer", "snippet": {"code": "             require(Channels[_lcID].token.transferFrom(msg.sender, this, _balances[1]),\"CreateChannel: token transfer failure\");", "highlightLines": [406]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 406, "column": 22}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "8401ec2c7a82", "fix": {"template": null, "available": false}, "title": "Token amount after transfer may differ - check actual received amount", "ruleId": "rules.sol-fee-on-transfer-token", "snippet": {"code": "             require(Channels[_lcID].token.transferFrom(msg.sender, this, _balances[1]),\"CreateChannel: token transfer failure\");", "highlightLines": [406]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 406, "column": 22}, "severity": "info", "references": [], "description": ""}, {"id": "a5743af9b810", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         Channels[_lcID].sequence = 0;\n         Channels[_lcID].confirmTime = _confirmTime;", "highlightLines": [410]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 410, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "7fb8cbdd1afe", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         Channels[_lcID].confirmTime = _confirmTime;\n         // is close flag, lc state sequence, number open vc, vc root hash, partyA...\n         //Channels[_lcID].stateHash = keccak256(uint256(0), uint256(0), uint256(0), bytes32(0x0), bytes32(msg.sender), bytes32(_partyI), balanceA, balanceI);\n         Channels[_lcID].LCopenTimeout = now + _confirmTime;", "highlightLines": [411]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 411, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "10a634eab2c6", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         Channels[_lcID].LCopenTimeout = now + _confirmTime;\n         Channels[_lcID].initialDeposit = _balances;", "highlightLines": [414]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 414, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "a1aecbe824a8", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "         require(msg.sender == Channels[_lcID].partyAddresses[0] && Channels[_lcID].isOpen == false);", "highlightLines": [421]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 421, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "1812246e9a0a", "fix": {"template": null, "available": false}, "title": "Unnecessary comparison to boolean constant - use variable directly", "ruleId": "rules.sol-boolean-constant-comparison", "snippet": {"code": "         require(msg.sender == Channels[_lcID].partyAddresses[0] && Channels[_lcID].isOpen == false);", "highlightLines": [421]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 421, "column": 92}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#boolean-equality"], "description": ""}, {"id": "4c151fc3951a", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "         require(now > Channels[_lcID].LCopenTimeout);", "highlightLines": [422]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 422, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "af71cf8df1a6", "fix": {"template": null, "available": false}, "title": "Block timestamp used for critical logic - miners can manipulate within ~15 second window", "ruleId": "rules.sol-block-timestamp-manipulation", "snippet": {"code": "         require(now > Channels[_lcID].LCopenTimeout);", "highlightLines": [422]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 422, "column": 18}, "severity": "medium", "references": ["https://consensys.github.io/smart-contract-best-practices/development-recommendations/solidity-specific/timestamp-dependence/"], "description": ""}, {"id": "d65cb0b4ebed", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "             Channels[_lcID].partyAddresses[0].transfer(Channels[_lcID].ethBalances[0]);", "highlightLines": [426]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 426, "column": 14}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "e60c1d32f0ab", "fix": {"template": null, "available": false}, "title": "Deleting mapping inside struct leaves nested data - use separate mapping deletion", "ruleId": "rules.sol-mapping-deletion", "snippet": {"code": "         delete Channels[_lcID];", "highlightLines": [436]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 436, "column": 10}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#deletion-on-mapping-containing-a-structure"], "description": ""}, {"id": "82a84eb1516b", "fix": {"template": null, "available": false}, "title": "delete array[i] leaves gap with zero value - use swap-and-pop pattern instead", "ruleId": "rules.sol-array-element-delete", "snippet": {"code": "         delete Channels[_lcID];", "highlightLines": [436]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 436, "column": 10}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/Array-deletion.sol"], "description": ""}, {"id": "1ae5ec6d4cb5", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "         require(Channels[_lcID].isOpen == false);", "highlightLines": [441]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 441, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "b9ee337243a3", "fix": {"template": null, "available": false}, "title": "Unnecessary comparison to boolean constant - use variable directly", "ruleId": "rules.sol-boolean-constant-comparison", "snippet": {"code": "         require(Channels[_lcID].isOpen == false);", "highlightLines": [441]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 441, "column": 41}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#boolean-equality"], "description": ""}, {"id": "792d830149b2", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "         require(msg.sender == Channels[_lcID].partyAddresses[1]);", "highlightLines": [442]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 442, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "7d7bd0d0fc92", "fix": {"template": null, "available": false}, "title": "Token transfer without checking actual received amount - deflationary tokens may transfer less", "ruleId": "rules.sol-deflationary-token-transfer", "snippet": {"code": "             require(Channels[_lcID].token.transferFrom(msg.sender, this, _balances[1]),\"joinChannel: token transfer failure\");", "highlightLines": [449]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 449, "column": 22}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "53d56048503e", "fix": {"template": null, "available": false}, "title": "Token amount after transfer may differ - check actual received amount", "ruleId": "rules.sol-fee-on-transfer-token", "snippet": {"code": "             require(Channels[_lcID].token.transferFrom(msg.sender, this, _balances[1]),\"joinChannel: token transfer failure\");", "highlightLines": [449]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 449, "column": 22}, "severity": "info", "references": [], "description": ""}, {"id": "42cfd501372a", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "     function deposit(bytes32 _lcID, address recipient, uint256 _balance, bool isToken) public payable {", "highlightLines": [465]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 465, "column": 6}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "7f17bc082648", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "     function deposit(bytes32 _lcID, address recipient, uint256 _balance, bool isToken) public payable {\n         require(Channels[_lcID].isOpen == true, \"Tried adding funds to a closed channel\");\n         require(recipient == Channels[_lcID].partyAddresses[0] || recipient == Channels[_lcID].partyAddresses[1]);", "highlightLines": [465]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 465, "column": 6}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "cee76e9c3250", "fix": {"template": null, "available": false}, "title": "Token transfer without before/after balance comparison - rebasing/fee tokens may transfer different amounts", "ruleId": "rules.sol-no-balance-before-after", "snippet": {"code": "     function deposit(bytes32 _lcID, address recipient, uint256 _balance, bool isToken) public payable {\n         require(Channels[_lcID].isOpen == true, \"Tried adding funds to a closed channel\");\n         require(recipient == Channels[_lcID].partyAddresses[0] || recipient == Channels[_lcID].partyAddresses[1]);\n\n         //if(Channels[_lcID].token)\n\n         if (Channels[_lcID].partyAddresses[0] == recipient) {\n             if(isToken) {\n                 require(Channels[_lcID].token.transferFrom(msg.sender, this, _balance),\"deposit: token transfer failure\");", "highlightLines": [465]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 465, "column": 6}, "severity": "medium", "references": [], "description": ""}, {"id": "0cfa65ac2236", "fix": {"template": null, "available": false}, "title": "ERC777 token interaction without reentrancy guard - token hooks can reenter", "ruleId": "rules.sol-erc777-without-reentrancy-guard", "snippet": {"code": "     function deposit(bytes32 _lcID, address recipient, uint256 _balance, bool isToken) public payable {\n         require(Channels[_lcID].isOpen == true, \"Tried adding funds to a closed channel\");\n         require(recipient == Channels[_lcID].partyAddresses[0] || recipient == Channels[_lcID].partyAddresses[1]);\n\n         //if(Channels[_lcID].token)\n\n         if (Channels[_lcID].partyAddresses[0] == recipient) {\n             if(isToken) {\n                 require(Channels[_lcID].token.transferFrom(msg.sender, this, _balance),\"deposit: token transfer failure\");", "highlightLines": [465]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 465, "column": 6}, "severity": "high", "references": [], "description": ""}, {"id": "cd622d7fd0f5", "fix": {"template": null, "available": false}, "title": "Unnecessary comparison to boolean constant - use variable directly", "ruleId": "rules.sol-boolean-constant-comparison", "snippet": {"code": "         require(Channels[_lcID].isOpen == true, \"Tried adding funds to a closed channel\");", "highlightLines": [466]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 466, "column": 41}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#boolean-equality"], "description": ""}, {"id": "0e69c3cab4a6", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "         require(recipient == Channels[_lcID].partyAddresses[0] || recipient == Channels[_lcID].partyAddresses[1]);", "highlightLines": [467]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 467, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "f508ff0e8b92", "fix": {"template": null, "available": false}, "title": "Token transfer without checking actual received amount - deflationary tokens may transfer less", "ruleId": "rules.sol-deflationary-token-transfer", "snippet": {"code": "                 require(Channels[_lcID].token.transferFrom(msg.sender, this, _balance),\"deposit: token transfer failure\");", "highlightLines": [473]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 473, "column": 26}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "8e1f7aedd211", "fix": {"template": null, "available": false}, "title": "Token amount after transfer may differ - check actual received amount", "ruleId": "rules.sol-fee-on-transfer-token", "snippet": {"code": "                 require(Channels[_lcID].token.transferFrom(msg.sender, this, _balance),\"deposit: token transfer failure\");", "highlightLines": [473]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 473, "column": 26}, "severity": "info", "references": [], "description": ""}, {"id": "f7c38fbfb11e", "fix": {"template": null, "available": false}, "title": "Token transfer without checking actual received amount - deflationary tokens may transfer less", "ruleId": "rules.sol-deflationary-token-transfer", "snippet": {"code": "                 require(Channels[_lcID].token.transferFrom(msg.sender, this, _balance),\"deposit: token transfer failure\");", "highlightLines": [483]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 483, "column": 26}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "ef9ddc6dc37c", "fix": {"template": null, "available": false}, "title": "Token amount after transfer may differ - check actual received amount", "ruleId": "rules.sol-fee-on-transfer-token", "snippet": {"code": "                 require(Channels[_lcID].token.transferFrom(msg.sender, this, _balance),\"deposit: token transfer failure\");", "highlightLines": [483]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 483, "column": 26}, "severity": "info", "references": [], "description": ""}, {"id": "94b3ffa78824", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "         require(Channels[_lcID].isOpen == true);", "highlightLines": [506]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 506, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "405ccdfcda7e", "fix": {"template": null, "available": false}, "title": "Unnecessary comparison to boolean constant - use variable directly", "ruleId": "rules.sol-boolean-constant-comparison", "snippet": {"code": "         require(Channels[_lcID].isOpen == true);", "highlightLines": [506]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 506, "column": 41}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#boolean-equality"], "description": ""}, {"id": "e5e98c6a2888", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "         uint256 totalEthDeposit = Channels[_lcID].initialDeposit[0] + Channels[_lcID].ethBalances[2] + Channels[_lcID].ethBalances[3];", "highlightLines": [507]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 507, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3b02730dac81", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "         uint256 totalEthDeposit = Channels[_lcID].initialDeposit[0] + Channels[_lcID].ethBalances[2] + Channels[_lcID].ethBalances[3];", "highlightLines": [507]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 507, "column": 10}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "b8a5fa390e35", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         uint256 totalEthDeposit = Channels[_lcID].initialDeposit[0] + Channels[_lcID].ethBalances[2] + Channels[_lcID].ethBalances[3];\n         uint256 totalTokenDeposit = Channels[_lcID].initialDeposit[1] + Channels[_lcID].erc20Balances[2] + Channels[_lcID].erc20Balances[3];", "highlightLines": [507]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 507, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "50ea28c3db41", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "         uint256 totalTokenDeposit = Channels[_lcID].initialDeposit[1] + Channels[_lcID].erc20Balances[2] + Channels[_lcID].erc20Balances[3];", "highlightLines": [508]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 508, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8e670cfc818d", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "         uint256 totalTokenDeposit = Channels[_lcID].initialDeposit[1] + Channels[_lcID].erc20Balances[2] + Channels[_lcID].erc20Balances[3];", "highlightLines": [508]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 508, "column": 10}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "2a5b032f7e9a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         uint256 totalTokenDeposit = Channels[_lcID].initialDeposit[1] + Channels[_lcID].erc20Balances[2] + Channels[_lcID].erc20Balances[3];\n         require(totalEthDeposit == _balances[0] + _balances[1]);\n         require(totalTokenDeposit == _balances[2] + _balances[3]);\n\n         bytes32 _state = keccak256(\n             abi.encodePacked(\n                 _lcID,\n                 true,\n                 _sequence,\n                 uint256(0),\n                 bytes32(0x0),\n                 Channels[_lcID].partyAddresses[0],\n                 Channels[_lcID].partyAddresses[1],\n                 _balances[0],\n                 _balances[1],\n                 _balances[2],\n                 _balances[3]\n             )\n         );", "highlightLines": [508]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 508, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "99fcca3b34f7", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "         require(totalEthDeposit == _balances[0] + _balances[1]);", "highlightLines": [509]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 509, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "d24834cf6c3e", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "         require(totalTokenDeposit == _balances[2] + _balances[3]);", "highlightLines": [510]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 510, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "4af691fafb36", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n         bytes32 _state = keccak256(", "highlightLines": [511]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 511, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "809fb8c13e8b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         bytes32 _state = keccak256(\n             abi.encodePacked(\n                 _lcID,\n                 true,\n                 _sequence,\n                 uint256(0),\n                 bytes32(0x0),\n                 Channels[_lcID].partyAddresses[0],\n                 Channels[_lcID].partyAddresses[1],\n                 _balances[0],\n                 _balances[1],\n                 _balances[2],\n                 _balances[3]\n             )\n         );\n\n         require(Channels[_lcID].partyAddresses[0] == ECTools.recoverSigner(_state, _sigA));\n         require(Channels[_lcID].partyAddresses[1] == ECTools.recoverSigner(_state, _sigI));\n\n         Channels[_lcID].isOpen = false;", "highlightLines": [512]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 512, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "2156c43b56d1", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "         bytes32 _state = keccak256(\n             abi.encodePacked(\n                 _lcID,\n                 true,\n                 _sequence,\n                 uint256(0),\n                 bytes32(0x0),\n                 Channels[_lcID].partyAddresses[0],\n                 Channels[_lcID].partyAddresses[1],\n                 _balances[0],\n                 _balances[1],\n                 _balances[2],\n                 _balances[3]\n             )\n         );", "highlightLines": [512]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 512, "column": 27}, "severity": "high", "references": [], "description": ""}, {"id": "2e1e37401a22", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "             abi.encodePacked(\n                 _lcID,\n                 true,\n                 _sequence,\n                 uint256(0),\n                 bytes32(0x0),\n                 Channels[_lcID].partyAddresses[0],\n                 Channels[_lcID].partyAddresses[1],\n                 _balances[0],\n                 _balances[1],\n                 _balances[2],\n                 _balances[3]\n             )", "highlightLines": [513]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 513, "column": 14}, "severity": "medium", "references": [], "description": ""}, {"id": "bdf248a51bf5", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "         require(Channels[_lcID].partyAddresses[0] == ECTools.recoverSigner(_state, _sigA));", "highlightLines": [528]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 528, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "395bbc9febf6", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "         require(Channels[_lcID].partyAddresses[1] == ECTools.recoverSigner(_state, _sigI));", "highlightLines": [529]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 529, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "a1ea8498e08a", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "             Channels[_lcID].partyAddresses[0].transfer(_balances[0]);", "highlightLines": [534]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 534, "column": 14}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "07128f34889b", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "             Channels[_lcID].partyAddresses[1].transfer(_balances[1]);", "highlightLines": [535]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 535, "column": 14}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "693e309677e4", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         Channel storage channel = Channels[_lcID];\n         require(channel.isOpen);\n         require(channel.sequence < updateParams[0]); // do same as vc sequence check\n         require(channel.ethBalances[0] + channel.ethBalances[1] >= updateParams[2] + updateParams[3]);\n         require(channel.erc20Balances[0] + channel.erc20Balances[1] >= updateParams[4] + updateParams[5]);\n\n         if(channel.isUpdateLCSettling == true) {\n             require(channel.updateLCtimeout > now);\n         }\n\n         bytes32 _state = keccak256(\n             abi.encodePacked(\n                 _lcID,\n                 false,\n                 updateParams[0],\n                 updateParams[1],\n                 _VCroot,\n                 channel.partyAddresses[0],\n                 channel.partyAddresses[1],\n                 updateParams[2],\n                 updateParams[3],\n                 updateParams[4],\n                 updateParams[5]\n             )\n         );", "highlightLines": [559]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 559, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "29a1c64b7fba", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "         require(channel.isOpen);", "highlightLines": [560]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 560, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "1433d8a10de1", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "         require(channel.sequence < updateParams[0]); // do same as vc sequence check", "highlightLines": [561]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 561, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "ed71c1ec95a0", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "         require(channel.ethBalances[0] + channel.ethBalances[1] >= updateParams[2] + updateParams[3]);", "highlightLines": [562]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 562, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "19573c8925f6", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "         require(channel.erc20Balances[0] + channel.erc20Balances[1] >= updateParams[4] + updateParams[5]);", "highlightLines": [563]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 563, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "f8cad806f815", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "         if(channel.isUpdateLCSettling == true) {\n             require(channel.updateLCtimeout > now);\n         }", "highlightLines": [565]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 565, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "da3834efa4b7", "fix": {"template": null, "available": false}, "title": "Unnecessary comparison to boolean constant - use variable directly", "ruleId": "rules.sol-boolean-constant-comparison", "snippet": {"code": "         if(channel.isUpdateLCSettling == true) {", "highlightLines": [565]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 565, "column": 40}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#boolean-equality"], "description": ""}, {"id": "5073895284e1", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "             require(channel.updateLCtimeout > now);", "highlightLines": [566]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 566, "column": 14}, "severity": "info", "references": [], "description": ""}, {"id": "dff95f540057", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n         bytes32 _state = keccak256(", "highlightLines": [568]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 568, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d5c932639e3f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         bytes32 _state = keccak256(\n             abi.encodePacked(\n                 _lcID,\n                 false,\n                 updateParams[0],\n                 updateParams[1],\n                 _VCroot,\n                 channel.partyAddresses[0],\n                 channel.partyAddresses[1],\n                 updateParams[2],\n                 updateParams[3],\n                 updateParams[4],\n                 updateParams[5]\n             )\n         );\n\n         require(channel.partyAddresses[0] == ECTools.recoverSigner(_state, _sigA));\n         require(channel.partyAddresses[1] == ECTools.recoverSigner(_state, _sigI));\n\n         // update LC state\n         channel.sequence = updateParams[0];", "highlightLines": [569]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 569, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "7f752bdcaf7d", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "         bytes32 _state = keccak256(\n             abi.encodePacked(\n                 _lcID,\n                 false,\n                 updateParams[0],\n                 updateParams[1],\n                 _VCroot,\n                 channel.partyAddresses[0],\n                 channel.partyAddresses[1],\n                 updateParams[2],\n                 updateParams[3],\n                 updateParams[4],\n                 updateParams[5]\n             )\n         );", "highlightLines": [569]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 569, "column": 27}, "severity": "high", "references": [], "description": ""}, {"id": "e83f871e286e", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "             abi.encodePacked(\n                 _lcID,\n                 false,\n                 updateParams[0],\n                 updateParams[1],\n                 _VCroot,\n                 channel.partyAddresses[0],\n                 channel.partyAddresses[1],\n                 updateParams[2],\n                 updateParams[3],\n                 updateParams[4],\n                 updateParams[5]\n             )", "highlightLines": [570]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 570, "column": 14}, "severity": "medium", "references": [], "description": ""}, {"id": "5bfe7cf7bf9a", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "         require(channel.partyAddresses[0] == ECTools.recoverSigner(_state, _sigA));", "highlightLines": [585]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 585, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "9fabe1b7c248", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "         require(channel.partyAddresses[1] == ECTools.recoverSigner(_state, _sigI));", "highlightLines": [586]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 586, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "94dfb69b9011", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         channel.sequence = updateParams[0];\n         channel.numOpenVC = updateParams[1];", "highlightLines": [589]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 589, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "ea4ee64ca5d8", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         channel.numOpenVC = updateParams[1];\n         channel.ethBalances[0] = updateParams[2];", "highlightLines": [590]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 590, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "273dc918c48d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         channel.ethBalances[0] = updateParams[2];\n         channel.ethBalances[1] = updateParams[3];", "highlightLines": [591]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 591, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "7cb0349e29eb", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         channel.ethBalances[1] = updateParams[3];\n         channel.erc20Balances[0] = updateParams[4];", "highlightLines": [592]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 592, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "90b9c8009861", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         channel.erc20Balances[0] = updateParams[4];\n         channel.erc20Balances[1] = updateParams[5];", "highlightLines": [593]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 593, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "e056bba919b0", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         channel.erc20Balances[1] = updateParams[5];\n         channel.VCrootHash = _VCroot;", "highlightLines": [594]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 594, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "fc4f4444401b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         channel.VCrootHash = _VCroot;\n         channel.isUpdateLCSettling = true;", "highlightLines": [595]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 595, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "d53c752282f1", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         channel.isUpdateLCSettling = true;\n         channel.updateLCtimeout = now + channel.confirmTime;", "highlightLines": [596]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 596, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "dfd89e196884", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "     function initVCstate(\n         bytes32 _lcID,\n         bytes32 _vcID,\n         bytes _proof,\n         address _partyA,\n         address _partyB,\n         uint256[2] _bond,\n         uint256[4] _balances, // 0: ethBalanceA 1:ethBalanceI 2:tokenBalanceA 3:tokenBalanceI\n         string sigA\n     )\n         public\n     {\n         require(Channels[_lcID].isOpen, \"LC is closed.\");\n         // sub-channel must be open\n         require(!virtualChannels[_vcID].isClose, \"VC is closed.\");\n         // Check time has passed on updateLCtimeout and has not passed the time to store a vc state\n         require(Channels[_lcID].updateLCtimeout < now, \"LC timeout not over.\");\n         // prevent rentry of initializing vc state\n         require(virtualChannels[_vcID].updateVCtimeout == 0);\n         // partyB is now Ingrid\n         bytes32 _initState = keccak256(\n             abi.encodePacked(_vcID, uint256(0), _partyA, _partyB, _bond[0], _bond[1], _balances[0], _balances[1], _balances[2], _balances[3])\n         );\n\n         // Make sure Alice has signed initial vc state (A/B in oldState)\n         require(_partyA == ECTools.recoverSigner(_initState, sigA));", "highlightLines": [615]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 615, "column": 6}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "96b187283dfc", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "         require(virtualChannels[_vcID].updateVCtimeout == 0);", "highlightLines": [633]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 633, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "2fab811cf6b5", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "         bytes32 _initState = keccak256(", "highlightLines": [635]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 635, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "2941741efd7e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         bytes32 _initState = keccak256(\n             abi.encodePacked(_vcID, uint256(0), _partyA, _partyB, _bond[0], _bond[1], _balances[0], _balances[1], _balances[2], _balances[3])\n         );\n\n         // Make sure Alice has signed initial vc state (A/B in oldState)\n         require(_partyA == ECTools.recoverSigner(_initState, sigA));\n\n         // Check the oldState is in the root hash\n         require(_isContained(_initState, _proof, Channels[_lcID].VCrootHash) == true);\n\n         virtualChannels[_vcID].partyA = _partyA; // VC participant A", "highlightLines": [635]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 635, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "a8b5acde1d67", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "         bytes32 _initState = keccak256(\n             abi.encodePacked(_vcID, uint256(0), _partyA, _partyB, _bond[0], _bond[1], _balances[0], _balances[1], _balances[2], _balances[3])\n         );", "highlightLines": [635]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 635, "column": 31}, "severity": "high", "references": [], "description": ""}, {"id": "de549b2cd5e9", "fix": {"template": null, "available": false}, "title": "Signature verification without EIP-712 domain separator - vulnerable to cross-chain/cross-contract replay", "ruleId": "rules.sol-ethernaut-missing-eip712-domain", "snippet": {"code": "         bytes32 _initState = keccak256(\n             abi.encodePacked(_vcID, uint256(0), _partyA, _partyB, _bond[0], _bond[1], _balances[0], _balances[1], _balances[2], _balances[3])\n         );", "highlightLines": [635]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 635, "column": 31}, "severity": "high", "references": ["https://eips.ethereum.org/EIPS/eip-712", "https://ethernaut.openzeppelin.com/"], "description": ""}, {"id": "a0f918d6006e", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "             abi.encodePacked(_vcID, uint256(0), _partyA, _partyB, _bond[0], _bond[1], _balances[0], _balances[1], _balances[2], _balances[3])", "highlightLines": [636]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 636, "column": 14}, "severity": "medium", "references": [], "description": ""}, {"id": "1b698b4bf78c", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "         require(_partyA == ECTools.recoverSigner(_initState, sigA));", "highlightLines": [640]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 640, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "03364eb1c4be", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "         require(_isContained(_initState, _proof, Channels[_lcID].VCrootHash) == true);", "highlightLines": [643]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 643, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "ac31d99f0f03", "fix": {"template": null, "available": false}, "title": "Unnecessary comparison to boolean constant - use variable directly", "ruleId": "rules.sol-boolean-constant-comparison", "snippet": {"code": "         require(_isContained(_initState, _proof, Channels[_lcID].VCrootHash) == true);", "highlightLines": [643]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 643, "column": 79}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#boolean-equality"], "description": ""}, {"id": "a3a068ed6025", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         virtualChannels[_vcID].partyA = _partyA; // VC participant A\n         virtualChannels[_vcID].partyB = _partyB; // VC participant B", "highlightLines": [645]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 645, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "08c707ec08c1", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         virtualChannels[_vcID].partyB = _partyB; // VC participant B\n         virtualChannels[_vcID].sequence = uint256(0);", "highlightLines": [646]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 646, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "38819468cec8", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         virtualChannels[_vcID].sequence = uint256(0);\n         virtualChannels[_vcID].ethBalances[0] = _balances[0];", "highlightLines": [647]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 647, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "6b79f06e6089", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         virtualChannels[_vcID].ethBalances[0] = _balances[0];\n         virtualChannels[_vcID].ethBalances[1] = _balances[1];", "highlightLines": [648]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 648, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "7434166114d3", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         virtualChannels[_vcID].ethBalances[1] = _balances[1];\n         virtualChannels[_vcID].erc20Balances[0] = _balances[2];", "highlightLines": [649]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 649, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "b53bb7513bc6", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         virtualChannels[_vcID].erc20Balances[0] = _balances[2];\n         virtualChannels[_vcID].erc20Balances[1] = _balances[3];", "highlightLines": [650]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 650, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "59d3baded266", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         virtualChannels[_vcID].erc20Balances[1] = _balances[3];\n         virtualChannels[_vcID].bond = _bond;", "highlightLines": [651]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 651, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "a39ab130b264", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         virtualChannels[_vcID].bond = _bond;\n         virtualChannels[_vcID].updateVCtimeout = now + Channels[_lcID].confirmTime;", "highlightLines": [652]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 652, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "0858011191f7", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         virtualChannels[_vcID].updateVCtimeout = now + Channels[_lcID].confirmTime;\n         virtualChannels[_vcID].isInSettlementState = true;", "highlightLines": [653]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 653, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "ccc62a066f08", "fix": {"template": null, "available": false}, "title": "Storage write without access control - arbitrary data manipulation", "ruleId": "rules.sol-unprotected-storage-write", "snippet": {"code": "     function settleVC(\n         bytes32 _lcID,\n         bytes32 _vcID,\n         uint256 updateSeq,\n         address _partyA,\n         address _partyB,\n         uint256[4] updateBal, // [ethupdateBalA, ethupdateBalB, tokenupdateBalA, tokenupdateBalB]\n         string sigA\n     )\n         public\n     {", "highlightLines": [662]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 662, "column": 6}, "severity": "high", "references": [], "description": ""}, {"id": "31851a4171cf", "fix": {"template": null, "available": false}, "title": "Block timestamp used for critical logic - miners can manipulate within ~15 second window", "ruleId": "rules.sol-block-timestamp-manipulation", "snippet": {"code": "         // require(Channels[_lcID].updateLCtimeout < now && now < virtualChannels[_vcID].updateVCtimeout);", "highlightLines": [688]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 688, "column": 62}, "severity": "medium", "references": ["https://consensys.github.io/smart-contract-best-practices/development-recommendations/solidity-specific/timestamp-dependence/"], "description": ""}, {"id": "6f2e39ee7375", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "         require(Channels[_lcID].updateLCtimeout < now); // for testing!", "highlightLines": [689]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 689, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "3d35dd097598", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n         bytes32 _updateState = keccak256(", "highlightLines": [690]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 690, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7bb99ed58506", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         bytes32 _updateState = keccak256(\n             abi.encodePacked(\n                 _vcID,\n                 updateSeq,\n                 _partyA,\n                 _partyB,\n                 virtualChannels[_vcID].bond[0],\n                 virtualChannels[_vcID].bond[1],\n                 updateBal[0],\n                 updateBal[1],\n                 updateBal[2],\n                 updateBal[3]\n             )\n         );\n\n         // Make sure Alice has signed a higher sequence new state\n         require(virtualChannels[_vcID].partyA == ECTools.recoverSigner(_updateState, sigA));\n\n         // store VC data\n         // we may want to record who is initiating on-chain settles\n         virtualChannels[_vcID].challenger = msg.sender;", "highlightLines": [691]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 691, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "d0ac9527c9f5", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "         bytes32 _updateState = keccak256(\n             abi.encodePacked(\n                 _vcID,\n                 updateSeq,\n                 _partyA,\n                 _partyB,\n                 virtualChannels[_vcID].bond[0],\n                 virtualChannels[_vcID].bond[1],\n                 updateBal[0],\n                 updateBal[1],\n                 updateBal[2],\n                 updateBal[3]\n             )\n         );", "highlightLines": [691]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 691, "column": 33}, "severity": "high", "references": [], "description": ""}, {"id": "6fa3db00fdcc", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "             abi.encodePacked(\n                 _vcID,\n                 updateSeq,\n                 _partyA,\n                 _partyB,\n                 virtualChannels[_vcID].bond[0],\n                 virtualChannels[_vcID].bond[1],\n                 updateBal[0],\n                 updateBal[1],\n                 updateBal[2],\n                 updateBal[3]\n             )", "highlightLines": [692]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 692, "column": 14}, "severity": "medium", "references": [], "description": ""}, {"id": "f539d4bd11ab", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "         require(virtualChannels[_vcID].partyA == ECTools.recoverSigner(_updateState, sigA));", "highlightLines": [707]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 707, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "b7f10a6e6eb8", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         virtualChannels[_vcID].challenger = msg.sender;\n         virtualChannels[_vcID].sequence = updateSeq;", "highlightLines": [711]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 711, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "db3cc77a1ba4", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         virtualChannels[_vcID].sequence = updateSeq;\n\n         // channel state\n         virtualChannels[_vcID].ethBalances[0] = updateBal[0];", "highlightLines": [712]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 712, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "d85c63107987", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         virtualChannels[_vcID].ethBalances[0] = updateBal[0];\n         virtualChannels[_vcID].ethBalances[1] = updateBal[1];", "highlightLines": [715]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 715, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "5cad5399e428", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         virtualChannels[_vcID].ethBalances[1] = updateBal[1];\n         virtualChannels[_vcID].erc20Balances[0] = updateBal[2];", "highlightLines": [716]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 716, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "f3be3a72e27c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         virtualChannels[_vcID].erc20Balances[0] = updateBal[2];\n         virtualChannels[_vcID].erc20Balances[1] = updateBal[3];", "highlightLines": [717]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 717, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "961dc61a641e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         virtualChannels[_vcID].erc20Balances[1] = updateBal[3];\n\n         virtualChannels[_vcID].updateVCtimeout = now + Channels[_lcID].confirmTime;", "highlightLines": [718]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 718, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "51a4e987273a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         Channel storage channel = Channels[_lcID];\n\n         // check settlement flag\n         require(channel.isOpen, \"Channel is not open\");\n         require(channel.isUpdateLCSettling == true);\n         require(channel.numOpenVC == 0);\n         require(channel.updateLCtimeout < now, \"LC timeout over.\");\n\n         // if off chain state update didnt reblance deposits, just return to deposit owner\n         uint256 totalEthDeposit = channel.initialDeposit[0] + channel.ethBalances[2] + channel.ethBalances[3];", "highlightLines": [757]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 757, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "55eaa33600d6", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "         require(channel.isUpdateLCSettling == true);", "highlightLines": [761]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 761, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "a1089195a98c", "fix": {"template": null, "available": false}, "title": "Unnecessary comparison to boolean constant - use variable directly", "ruleId": "rules.sol-boolean-constant-comparison", "snippet": {"code": "         require(channel.isUpdateLCSettling == true);", "highlightLines": [761]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 761, "column": 45}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#boolean-equality"], "description": ""}, {"id": "cddd233c2310", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "         require(channel.numOpenVC == 0);", "highlightLines": [762]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 762, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "b6ea4459681d", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "         // if off chain state update didnt reblance deposits, just return to deposit owner\n         uint256 totalEthDeposit = channel.initialDeposit[0] + channel.ethBalances[2] + channel.ethBalances[3];\n         uint256 totalTokenDeposit = channel.initialDeposit[1] + channel.erc20Balances[2] + channel.erc20Balances[3];", "highlightLines": [765]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 765, "column": 69}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "4ed0df3e3bff", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "         uint256 totalEthDeposit = channel.initialDeposit[0] + channel.ethBalances[2] + channel.ethBalances[3];", "highlightLines": [766]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 766, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d380247dfed9", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "         uint256 totalEthDeposit = channel.initialDeposit[0] + channel.ethBalances[2] + channel.ethBalances[3];", "highlightLines": [766]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 766, "column": 10}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "854a9c5d5948", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         uint256 totalEthDeposit = channel.initialDeposit[0] + channel.ethBalances[2] + channel.ethBalances[3];\n         uint256 totalTokenDeposit = channel.initialDeposit[1] + channel.erc20Balances[2] + channel.erc20Balances[3];", "highlightLines": [766]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 766, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "1bed7f961fed", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "         uint256 totalTokenDeposit = channel.initialDeposit[1] + channel.erc20Balances[2] + channel.erc20Balances[3];", "highlightLines": [767]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 767, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e199e2be705b", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "         uint256 totalTokenDeposit = channel.initialDeposit[1] + channel.erc20Balances[2] + channel.erc20Balances[3];", "highlightLines": [767]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 767, "column": 10}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "eb7a988f9278", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         uint256 totalTokenDeposit = channel.initialDeposit[1] + channel.erc20Balances[2] + channel.erc20Balances[3];\n\n         uint256 possibleTotalEthBeforeDeposit = channel.ethBalances[0] + channel.ethBalances[1];", "highlightLines": [767]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 767, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "7d6134f5dd62", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n         uint256 possibleTotalEthBeforeDeposit = channel.ethBalances[0] + channel.ethBalances[1];", "highlightLines": [768]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 768, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0fe4c65b5a25", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         uint256 possibleTotalEthBeforeDeposit = channel.ethBalances[0] + channel.ethBalances[1];\n         uint256 possibleTotalTokenBeforeDeposit = channel.erc20Balances[0] + channel.erc20Balances[1];", "highlightLines": [769]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 769, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "0cb4c2a9f129", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "         uint256 possibleTotalTokenBeforeDeposit = channel.erc20Balances[0] + channel.erc20Balances[1];", "highlightLines": [770]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 770, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b50aa8a77ab9", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         uint256 possibleTotalTokenBeforeDeposit = channel.erc20Balances[0] + channel.erc20Balances[1];\n\n         if(possibleTotalEthBeforeDeposit < totalEthDeposit) {\n             channel.ethBalances[0]+=channel.ethBalances[2];\n             channel.ethBalances[1]+=channel.ethBalances[3];\n         } else {\n             require(possibleTotalEthBeforeDeposit == totalEthDeposit);\n         }\n\n         if(possibleTotalTokenBeforeDeposit < totalTokenDeposit) {\n             channel.erc20Balances[0]+=channel.erc20Balances[2];\n             channel.erc20Balances[1]+=channel.erc20Balances[3];\n         } else {\n             require(possibleTotalTokenBeforeDeposit == totalTokenDeposit);\n         }\n\n         // reentrancy\n         uint256 ethbalanceA = channel.ethBalances[0];", "highlightLines": [770]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 770, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "0fd257ceaf99", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "             require(possibleTotalEthBeforeDeposit == totalEthDeposit);", "highlightLines": [776]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 776, "column": 14}, "severity": "info", "references": [], "description": ""}, {"id": "32f3b50cf95a", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "             require(possibleTotalTokenBeforeDeposit == totalTokenDeposit);", "highlightLines": [783]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 783, "column": 14}, "severity": "info", "references": [], "description": ""}, {"id": "604a028f97dc", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "         uint256 ethbalanceA = channel.ethBalances[0];", "highlightLines": [787]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 787, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ba4c81d4fddd", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         uint256 ethbalanceA = channel.ethBalances[0];\n         uint256 ethbalanceI = channel.ethBalances[1];", "highlightLines": [787]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 787, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "99600a8f1d9e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "         uint256 ethbalanceI = channel.ethBalances[1];", "highlightLines": [788]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 788, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "59a4962a9c37", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         uint256 ethbalanceI = channel.ethBalances[1];\n         uint256 tokenbalanceA = channel.erc20Balances[0];", "highlightLines": [788]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 788, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "d2e103cdb81e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "         uint256 tokenbalanceA = channel.erc20Balances[0];", "highlightLines": [789]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 789, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "03b3f19dc912", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         uint256 tokenbalanceA = channel.erc20Balances[0];\n         uint256 tokenbalanceI = channel.erc20Balances[1];", "highlightLines": [789]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 789, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "c7f5aa43dc2e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "         uint256 tokenbalanceI = channel.erc20Balances[1];", "highlightLines": [790]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 790, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3a4ec82e69e9", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         uint256 tokenbalanceI = channel.erc20Balances[1];\n\n         channel.ethBalances[0] = 0;", "highlightLines": [790]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 790, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "2f977333cf21", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         channel.ethBalances[0] = 0;\n         channel.ethBalances[1] = 0;", "highlightLines": [792]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 792, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "d14fe939efba", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         channel.ethBalances[1] = 0;\n         channel.erc20Balances[0] = 0;", "highlightLines": [793]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 793, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "0dffdd1fa135", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         channel.erc20Balances[0] = 0;\n         channel.erc20Balances[1] = 0;", "highlightLines": [794]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 794, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "d164cf61c076", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         channel.erc20Balances[1] = 0;\n\n         if(ethbalanceA != 0 || ethbalanceI != 0) {\n             channel.partyAddresses[0].transfer(ethbalanceA);\n             channel.partyAddresses[1].transfer(ethbalanceI);\n         }\n\n         if(tokenbalanceA != 0 || tokenbalanceI != 0) {\n             require(\n                 channel.token.transfer(channel.partyAddresses[0], tokenbalanceA),\n                 \"byzantineCloseChannel: token transfer failure\"\n             );\n             require(\n                 channel.token.transfer(channel.partyAddresses[1], tokenbalanceI),\n                 \"byzantineCloseChannel: token transfer failure\"\n             );\n         }\n\n         channel.isOpen = false;", "highlightLines": [795]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 795, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "acca654d4d08", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "             channel.partyAddresses[0].transfer(ethbalanceA);", "highlightLines": [798]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 798, "column": 14}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "f066453752b1", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "             channel.partyAddresses[1].transfer(ethbalanceI);", "highlightLines": [799]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 799, "column": 14}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "687480100ecc", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "     function _isContained(bytes32 _hash, bytes _proof, bytes32 _root) internal pure returns (bool) {\n         bytes32 cursor = _hash;\n         bytes32 proofElem;\n\n         for (uint256 i = 64; i <= _proof.length; i += 32) {", "highlightLines": [819]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 819, "column": 6}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "1966420e5f3a", "fix": {"template": null, "available": false}, "title": "View/pure function uses assembly - may modify state unexpectedly", "ruleId": "rules.sol-constant-function-assembly", "snippet": {"code": "     function _isContained(bytes32 _hash, bytes _proof, bytes32 _root) internal pure returns (bool) {\n         bytes32 cursor = _hash;\n         bytes32 proofElem;\n\n         for (uint256 i = 64; i <= _proof.length; i += 32) {\n             assembly { proofElem := mload(add(_proof, i)) }", "highlightLines": [819]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 819, "column": 6}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-using-assembly-code"], "description": ""}, {"id": "29e0aa104710", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "         bytes32 cursor = _hash;", "highlightLines": [820]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 820, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0f45b22ea94f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         bytes32 cursor = _hash;\n         bytes32 proofElem;\n\n         for (uint256 i = 64; i <= _proof.length; i += 32) {\n             assembly { proofElem := mload(add(_proof, i)) }\n\n             if (cursor < proofElem) {\n                 cursor = keccak256(abi.encodePacked(cursor, proofElem));\n             } else {\n                 cursor = keccak256(abi.encodePacked(proofElem, cursor));\n             }\n         }", "highlightLines": [820]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 820, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "4118138fcc7e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "         bytes32 proofElem;", "highlightLines": [821]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 821, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ef39da7f810e", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "             assembly { proofElem := mload(add(_proof, i)) }", "highlightLines": [824]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 824, "column": 14}, "severity": "info", "references": [], "description": ""}, {"id": "abffc52e7057", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "                 cursor = keccak256(abi.encodePacked(cursor, proofElem));", "highlightLines": [827]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 827, "column": 27}, "severity": "high", "references": [], "description": ""}, {"id": "ec904e461050", "fix": {"template": null, "available": false}, "title": "Signature verification without EIP-712 domain separator - vulnerable to cross-chain/cross-contract replay", "ruleId": "rules.sol-ethernaut-missing-eip712-domain", "snippet": {"code": "                 cursor = keccak256(abi.encodePacked(cursor, proofElem));", "highlightLines": [827]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 827, "column": 27}, "severity": "high", "references": ["https://eips.ethereum.org/EIPS/eip-712", "https://ethernaut.openzeppelin.com/"], "description": ""}, {"id": "2436a0f35ba4", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "                 cursor = keccak256(abi.encodePacked(cursor, proofElem));", "highlightLines": [827]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 827, "column": 37}, "severity": "medium", "references": [], "description": ""}, {"id": "77a48d6cb7f4", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "                 cursor = keccak256(abi.encodePacked(proofElem, cursor));", "highlightLines": [829]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 829, "column": 27}, "severity": "high", "references": [], "description": ""}, {"id": "44c8bf1afc5b", "fix": {"template": null, "available": false}, "title": "Signature verification without EIP-712 domain separator - vulnerable to cross-chain/cross-contract replay", "ruleId": "rules.sol-ethernaut-missing-eip712-domain", "snippet": {"code": "                 cursor = keccak256(abi.encodePacked(proofElem, cursor));", "highlightLines": [829]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 829, "column": 27}, "severity": "high", "references": ["https://eips.ethereum.org/EIPS/eip-712", "https://ethernaut.openzeppelin.com/"], "description": ""}, {"id": "db4b0acabe83", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "                 cursor = keccak256(abi.encodePacked(proofElem, cursor));", "highlightLines": [829]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 829, "column": 37}, "severity": "medium", "references": [], "description": ""}, {"id": "1b105d9e9041", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "     function getChannel(bytes32 id) public view returns (\n         address[2],\n         uint256[4],\n         uint256[4],\n         uint256[2],\n         uint256,\n         uint256,\n         bytes32,\n         uint256,\n         uint256,\n         bool,\n         bool,\n         uint256\n     ) {\n         Channel memory channel = Channels[id];", "highlightLines": [837]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 837, "column": 6}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "c72b6bf9505c", "fix": {"template": null, "available": false}, "title": "Struct copied to memory from mapping - modifications won't persist to storage", "ruleId": "rules.sol-memory-struct-from-mapping", "snippet": {"code": "         Channel memory channel = Channels[id];", "highlightLines": [851]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 851, "column": 10}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/DataLocation.sol"], "description": ""}, {"id": "f5d36044c377", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "     function getVirtualChannel(bytes32 id) public view returns(\n         bool,\n         bool,\n         uint256,\n         address,\n         uint256,\n         address,\n         address,\n         address,\n         uint256[2],\n         uint256[2],\n         uint256[2]\n     ) {\n         VirtualChannel memory virtualChannel = virtualChannels[id];", "highlightLines": [868]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 868, "column": 6}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "67c19f4aba74", "fix": {"template": null, "available": false}, "title": "Struct copied to memory from mapping - modifications won't persist to storage", "ruleId": "rules.sol-memory-struct-from-mapping", "snippet": {"code": "         VirtualChannel memory virtualChannel = virtualChannels[id];", "highlightLines": [881]}, "category": "code", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 881, "column": 10}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/DataLocation.sol"], "description": ""}, {"id": "b24d34502cd1", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": " pragma solidity ^0.4.11;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/short_addresses/short_address_example.sol", "line": 7, "column": 2}, "severity": "info", "references": [], "description": ""}, {"id": "b4941658f308", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": " pragma solidity ^0.4.11;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/short_addresses/short_address_example.sol", "line": 7, "column": 2}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "cf8f0a509203", "fix": {"template": null, "available": false}, "title": "SWC-118: Function name matches contract name - likely intended as constructor (pre-0.4.22)", "ruleId": "rules.sol-swc-118-constructor-mismatch", "snippet": {"code": " contract MyToken {\n     mapping (address => uint) balances;\n\n     event Transfer(address indexed _from, address indexed _to, uint256 _value);\n\n     function MyToken() {", "highlightLines": [9]}, "category": "code", "location": {"file": "dataset/short_addresses/short_address_example.sol", "line": 9, "column": 2}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-118"], "description": ""}, {"id": "97c9d813d2ff", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "     event Transfer(address indexed _from, address indexed _to, uint256 _value);", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/short_addresses/short_address_example.sol", "line": 12, "column": 6}, "severity": "info", "references": [], "description": ""}, {"id": "c17648b204ed", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "     function MyToken() {\n         balances[tx.origin] = 10000;\n     }", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/short_addresses/short_address_example.sol", "line": 14, "column": 6}, "severity": "medium", "references": [], "description": ""}, {"id": "953e382fdd4e", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "     function sendCoin(address to, uint amount) returns(bool sufficient) {\n         if (balances[msg.sender] < amount) return false;\n         balances[msg.sender] -= amount;\n         balances[to] += amount;\n         Transfer(msg.sender, to, amount);\n         return true;\n     }", "highlightLines": [18]}, "category": "code", "location": {"file": "dataset/short_addresses/short_address_example.sol", "line": 18, "column": 6}, "severity": "medium", "references": [], "description": ""}, {"id": "31d3e3715a39", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "         if (balances[msg.sender] < amount) return false;\n         balances[msg.sender] -= amount;", "highlightLines": [19]}, "category": "code", "location": {"file": "dataset/short_addresses/short_address_example.sol", "line": 19, "column": 45}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "eb6999ceb7c9", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "     function getBalance(address addr) constant returns(uint) {\n         return balances[addr];\n     }", "highlightLines": [26]}, "category": "code", "location": {"file": "dataset/short_addresses/short_address_example.sol", "line": 26, "column": 6}, "severity": "medium", "references": [], "description": ""}, {"id": "9bbac9f8fe84", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": " pragma solidity ^0.4.15;", "highlightLines": [8]}, "category": "code", "location": {"file": "dataset/time_manipulation/ether_lotto.sol", "line": 8, "column": 2}, "severity": "info", "references": [], "description": ""}, {"id": "8ddc490b5021", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": " pragma solidity ^0.4.15;", "highlightLines": [8]}, "category": "code", "location": {"file": "dataset/time_manipulation/ether_lotto.sol", "line": 8, "column": 2}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "5979c676cd1a", "fix": {"template": null, "available": false}, "title": "SWC-118: Function name matches contract name - likely intended as constructor (pre-0.4.22)", "ruleId": "rules.sol-swc-118-constructor-mismatch", "snippet": {"code": "contract EtherLotto {\n\n    // Amount of ether needed for participating in the lottery.\n    uint constant TICKET_AMOUNT = 10;\n\n    // Fixed amount fee for each lottery game.\n    uint constant FEE_AMOUNT = 1;\n\n    // Address where fee is sent.\n    address public bank;\n\n    // Public jackpot that each participant can win (minus fee).\n    uint public pot;\n\n    // Lottery constructor sets bank account from the smart-contract owner.\n    function EtherLotto() {", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/time_manipulation/ether_lotto.sol", "line": 12, "column": 1}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-118"], "description": ""}, {"id": "e21f72645900", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function EtherLotto() {\n        bank = msg.sender;\n    }", "highlightLines": [27]}, "category": "code", "location": {"file": "dataset/time_manipulation/ether_lotto.sol", "line": 27, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "76875dc8814d", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function play() payable {\n\n        // Participants must spend some fixed ether before playing lottery.\n        assert(msg.value == TICKET_AMOUNT);\n\n        // Increase pot for each participant.\n        pot += msg.value;\n\n        // Compute some *almost random* value for selecting winner from current transaction.\n        // <yes> <report> TIME_MANIPULATION\n        var random = uint(sha3(block.timestamp)) % 2;\n\n        // Distribution: 50% of participants will be winners.\n        if (random == 0) {\n\n            // Send fee to bank account.\n            bank.transfer(FEE_AMOUNT);\n\n            // Send jackpot to winner.\n            msg.sender.transfer(pot - FEE_AMOUNT);\n\n            // Restart jackpot.\n            pot = 0;\n        }\n    }", "highlightLines": [33]}, "category": "code", "location": {"file": "dataset/time_manipulation/ether_lotto.sol", "line": 33, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "05fd6c9b14e1", "fix": {"template": null, "available": false}, "title": "Deprecated 'var' keyword can cause type confusion - resolves to smallest type (e.g., uint8 in loops)", "ruleId": "rules.sol-deprecated-var-keyword", "snippet": {"code": "        var random = uint(sha3(block.timestamp)) % 2;", "highlightLines": [43]}, "category": "code", "location": {"file": "dataset/time_manipulation/ether_lotto.sol", "line": 43, "column": 9}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/honeypots"], "description": ""}, {"id": "722369beec0f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        var random = uint(sha3(block.timestamp)) % 2;\n\n        // Distribution: 50% of participants will be winners.\n        if (random == 0) {\n\n            // Send fee to bank account.\n            bank.transfer(FEE_AMOUNT);\n\n            // Send jackpot to winner.\n            msg.sender.transfer(pot - FEE_AMOUNT);\n\n            // Restart jackpot.\n            pot = 0;\n        }", "highlightLines": [43]}, "category": "code", "location": {"file": "dataset/time_manipulation/ether_lotto.sol", "line": 43, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "63771d55ac0a", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "        var random = uint(sha3(block.timestamp)) % 2;", "highlightLines": [43]}, "category": "code", "location": {"file": "dataset/time_manipulation/ether_lotto.sol", "line": 43, "column": 22}, "severity": "info", "references": [], "description": ""}, {"id": "8f503422a503", "fix": {"template": null, "available": false}, "title": "sha3() is deprecated - use keccak256() instead", "ruleId": "rules.sol-deprecated-sha3", "snippet": {"code": "        var random = uint(sha3(block.timestamp)) % 2;", "highlightLines": [43]}, "category": "code", "location": {"file": "dataset/time_manipulation/ether_lotto.sol", "line": 43, "column": 27}, "severity": "info", "references": [], "description": ""}, {"id": "d288bbf99666", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "        var random = uint(sha3(block.timestamp)) % 2;", "highlightLines": [43]}, "category": "code", "location": {"file": "dataset/time_manipulation/ether_lotto.sol", "line": 43, "column": 32}, "severity": "medium", "references": [], "description": ""}, {"id": "8bd405e48b28", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "            bank.transfer(FEE_AMOUNT);", "highlightLines": [49]}, "category": "code", "location": {"file": "dataset/time_manipulation/ether_lotto.sol", "line": 49, "column": 13}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "182e254ce417", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "            msg.sender.transfer(pot - FEE_AMOUNT);", "highlightLines": [52]}, "category": "code", "location": {"file": "dataset/time_manipulation/ether_lotto.sol", "line": 52, "column": 13}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "3403e19d5e7a", "fix": {"template": null, "available": false}, "title": "ETH transfer via .transfer() before state update - potential reentrancy via fallback", "ruleId": "rules.sol-transfer-before-state-update-reentrancy", "snippet": {"code": "            msg.sender.transfer(pot - FEE_AMOUNT);\n\n            // Restart jackpot.\n            pot = 0;", "highlightLines": [52]}, "category": "code", "location": {"file": "dataset/time_manipulation/ether_lotto.sol", "line": 52, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "a8bae8233a45", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.0;", "highlightLines": [8]}, "category": "code", "location": {"file": "dataset/time_manipulation/governmental_survey.sol", "line": 8, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "5efde9254033", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.0;", "highlightLines": [8]}, "category": "code", "location": {"file": "dataset/time_manipulation/governmental_survey.sol", "line": 8, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "9302fc4a2ea3", "fix": {"template": null, "available": false}, "title": "SWC-118: Function name matches contract name - likely intended as constructor (pre-0.4.22)", "ruleId": "rules.sol-swc-118-constructor-mismatch", "snippet": {"code": "contract Governmental {\n  address public owner;\n  address public lastInvestor;\n  uint public jackpot = 1 ether;\n  uint public lastInvestmentTimestamp;\n  uint public ONE_MINUTE = 1 minutes;\n\n  function Governmental() {", "highlightLines": [10]}, "category": "code", "location": {"file": "dataset/time_manipulation/governmental_survey.sol", "line": 10, "column": 1}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-118"], "description": ""}, {"id": "f77a45155939", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function Governmental() {\n    owner = msg.sender;\n    if (msg.value<1 ether) throw;\n  }", "highlightLines": [17]}, "category": "code", "location": {"file": "dataset/time_manipulation/governmental_survey.sol", "line": 17, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "b44f2228578a", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "    owner = msg.sender;", "highlightLines": [18]}, "category": "code", "location": {"file": "dataset/time_manipulation/governmental_survey.sol", "line": 18, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "ef5fa55d94ba", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function invest() {\n    if (msg.value<jackpot/2) throw;\n    lastInvestor = msg.sender;\n    jackpot += msg.value/2;\n    // <yes> <report> TIME_MANIPULATION\n    lastInvestmentTimestamp = block.timestamp;\n  }", "highlightLines": [22]}, "category": "code", "location": {"file": "dataset/time_manipulation/governmental_survey.sol", "line": 22, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "6a8b96fb877c", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "    if (msg.value<jackpot/2) throw;\n    lastInvestor = msg.sender;", "highlightLines": [23]}, "category": "code", "location": {"file": "dataset/time_manipulation/governmental_survey.sol", "line": 23, "column": 30}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "419da41e5946", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    lastInvestor = msg.sender;\n    jackpot += msg.value/2;\n    // <yes> <report> TIME_MANIPULATION\n    lastInvestmentTimestamp = block.timestamp;", "highlightLines": [24]}, "category": "code", "location": {"file": "dataset/time_manipulation/governmental_survey.sol", "line": 24, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "3c0d5055ab15", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "    lastInvestmentTimestamp = block.timestamp;", "highlightLines": [27]}, "category": "code", "location": {"file": "dataset/time_manipulation/governmental_survey.sol", "line": 27, "column": 31}, "severity": "medium", "references": [], "description": ""}, {"id": "e597b021378b", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function resetInvestment() {\n    if (block.timestamp < lastInvestmentTimestamp+ONE_MINUTE)\n      throw;\n\n    lastInvestor.send(jackpot);\n    owner.send(this.balance-1 ether);\n\n    lastInvestor = 0;\n    jackpot = 1 ether;\n    lastInvestmentTimestamp = 0;\n  }", "highlightLines": [30]}, "category": "code", "location": {"file": "dataset/time_manipulation/governmental_survey.sol", "line": 30, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "838f6f1021d6", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "    if (block.timestamp < lastInvestmentTimestamp+ONE_MINUTE)", "highlightLines": [31]}, "category": "code", "location": {"file": "dataset/time_manipulation/governmental_survey.sol", "line": 31, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "0b484585e802", "fix": {"template": null, "available": false}, "title": "Block timestamp used for critical logic - miners can manipulate within ~15 second window", "ruleId": "rules.sol-block-timestamp-manipulation", "snippet": {"code": "    if (block.timestamp < lastInvestmentTimestamp+ONE_MINUTE)", "highlightLines": [31]}, "category": "code", "location": {"file": "dataset/time_manipulation/governmental_survey.sol", "line": 31, "column": 9}, "severity": "medium", "references": ["https://consensys.github.io/smart-contract-best-practices/development-recommendations/solidity-specific/timestamp-dependence/"], "description": ""}, {"id": "039f7b98bb60", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "      throw;", "highlightLines": [32]}, "category": "code", "location": {"file": "dataset/time_manipulation/governmental_survey.sol", "line": 32, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "d3d6f02c3c60", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "      throw;\n\n    lastInvestor.send(jackpot);", "highlightLines": [32]}, "category": "code", "location": {"file": "dataset/time_manipulation/governmental_survey.sol", "line": 32, "column": 7}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "5a7bf383dd03", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "    lastInvestor.send(jackpot);", "highlightLines": [34]}, "category": "code", "location": {"file": "dataset/time_manipulation/governmental_survey.sol", "line": 34, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "6fff9c63c39e", "fix": {"template": null, "available": false}, "title": "send() return value not checked - Ether may be stuck if recipient reverts", "ruleId": "rules.sol-unchecked-send-return", "snippet": {"code": "    lastInvestor.send(jackpot);", "highlightLines": [34]}, "category": "code", "location": {"file": "dataset/time_manipulation/governmental_survey.sol", "line": 34, "column": 17}, "severity": "high", "references": [], "description": ""}, {"id": "dd08f095d2ad", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "    owner.send(this.balance-1 ether);", "highlightLines": [35]}, "category": "code", "location": {"file": "dataset/time_manipulation/governmental_survey.sol", "line": 35, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "83f203985efa", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "    owner.send(this.balance-1 ether);", "highlightLines": [35]}, "category": "code", "location": {"file": "dataset/time_manipulation/governmental_survey.sol", "line": 35, "column": 10}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "33ee7fd3183c", "fix": {"template": null, "available": false}, "title": "send() return value not checked - Ether may be stuck if recipient reverts", "ruleId": "rules.sol-unchecked-send-return", "snippet": {"code": "    owner.send(this.balance-1 ether);", "highlightLines": [35]}, "category": "code", "location": {"file": "dataset/time_manipulation/governmental_survey.sol", "line": 35, "column": 10}, "severity": "high", "references": [], "description": ""}, {"id": "278f7919a22a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    lastInvestor = 0;\n    jackpot = 1 ether;", "highlightLines": [37]}, "category": "code", "location": {"file": "dataset/time_manipulation/governmental_survey.sol", "line": 37, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "09bb4d0d7243", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    jackpot = 1 ether;\n    lastInvestmentTimestamp = 0;", "highlightLines": [38]}, "category": "code", "location": {"file": "dataset/time_manipulation/governmental_survey.sol", "line": 38, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "a38571dd5642", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function attack(address target, uint count) {\n    if (0<=count && count<1023) {\n      this.attack.gas(msg.gas-2000)(target, count+1);\n    }\n    else {\n      Governmental(target).resetInvestment();\n    }\n  }", "highlightLines": [45]}, "category": "code", "location": {"file": "dataset/time_manipulation/governmental_survey.sol", "line": 45, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "3f9eb1d7d801", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "      Governmental(target).resetInvestment();", "highlightLines": [50]}, "category": "code", "location": {"file": "dataset/time_manipulation/governmental_survey.sol", "line": 50, "column": 7}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "6e4f8183dc73", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.0;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/time_manipulation/lottopollo.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "8133bfe81518", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.0;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/time_manipulation/lottopollo.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "290b375c3035", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "  address leader;", "highlightLines": [9]}, "category": "code", "location": {"file": "dataset/time_manipulation/lottopollo.sol", "line": 9, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ee1527cc425a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "  uint    timestamp;", "highlightLines": [10]}, "category": "code", "location": {"file": "dataset/time_manipulation/lottopollo.sol", "line": 10, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d8e94a596b0c", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "      msg.sender.send( msg.value );", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/time_manipulation/lottopollo.sol", "line": 14, "column": 7}, "severity": "high", "references": [], "description": ""}, {"id": "9806004d9bc5", "fix": {"template": null, "available": false}, "title": "send() return value not checked - Ether may be stuck if recipient reverts", "ruleId": "rules.sol-unchecked-send-return", "snippet": {"code": "      msg.sender.send( msg.value );", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/time_manipulation/lottopollo.sol", "line": 14, "column": 17}, "severity": "high", "references": [], "description": ""}, {"id": "958f21fd359f", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "        leader.send( this.balance );", "highlightLines": [17]}, "category": "code", "location": {"file": "dataset/time_manipulation/lottopollo.sol", "line": 17, "column": 9}, "severity": "high", "references": [], "description": ""}, {"id": "c67a6a63f23c", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "        leader.send( this.balance );", "highlightLines": [17]}, "category": "code", "location": {"file": "dataset/time_manipulation/lottopollo.sol", "line": 17, "column": 15}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "0134d54f9992", "fix": {"template": null, "available": false}, "title": "send() return value not checked - Ether may be stuck if recipient reverts", "ruleId": "rules.sol-unchecked-send-return", "snippet": {"code": "        leader.send( this.balance );", "highlightLines": [17]}, "category": "code", "location": {"file": "dataset/time_manipulation/lottopollo.sol", "line": 17, "column": 15}, "severity": "high", "references": [], "description": ""}, {"id": "edd8fbdb0679", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "      leader = msg.sender;\n      timestamp = rand;", "highlightLines": [21]}, "category": "code", "location": {"file": "dataset/time_manipulation/lottopollo.sol", "line": 21, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "fc6fab028f03", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function randomGen() constant returns (uint randomNumber) {\n      // <yes> <report> TIME MANIPULATION\n      return block.timestamp;   \n    }", "highlightLines": [25]}, "category": "code", "location": {"file": "dataset/time_manipulation/lottopollo.sol", "line": 25, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "25973b3aa40e", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "      return block.timestamp;", "highlightLines": [27]}, "category": "code", "location": {"file": "dataset/time_manipulation/lottopollo.sol", "line": 27, "column": 14}, "severity": "medium", "references": [], "description": ""}, {"id": "aeaeb413b8a6", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function draw(uint seed){\n    uint randomNumber=randomGen(); \n    payOut(randomNumber);\n  }", "highlightLines": [29]}, "category": "code", "location": {"file": "dataset/time_manipulation/lottopollo.sol", "line": 29, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "63b21e67a46c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint randomNumber=randomGen();", "highlightLines": [30]}, "category": "code", "location": {"file": "dataset/time_manipulation/lottopollo.sol", "line": 30, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "caff79629d41", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.25;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/time_manipulation/roulette.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "4d589895ac46", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.25;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/time_manipulation/roulette.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "84d2066e2aa4", "fix": {"template": null, "available": false}, "title": "Empty constructor or constructor with no effect - may indicate incomplete implementation", "ruleId": "rules.sol-void-constructor", "snippet": {"code": "    constructor() public payable {} // initially fund contract", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/time_manipulation/roulette.sol", "line": 12, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "2c8bcd66ab63", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.value == 10 ether); // must send 10 ether to play", "highlightLines": [16]}, "category": "code", "location": {"file": "dataset/time_manipulation/roulette.sol", "line": 16, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "0b13e5768553", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(now != pastBlockTime); // only 1 transaction per block", "highlightLines": [18]}, "category": "code", "location": {"file": "dataset/time_manipulation/roulette.sol", "line": 18, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "ebc64a3f7f5d", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "        if(now % 15 == 0) { // winner\n            msg.sender.transfer(this.balance);\n        }", "highlightLines": [21]}, "category": "code", "location": {"file": "dataset/time_manipulation/roulette.sol", "line": 21, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "61f537f86020", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "            msg.sender.transfer(this.balance);", "highlightLines": [22]}, "category": "code", "location": {"file": "dataset/time_manipulation/roulette.sol", "line": 22, "column": 13}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "f6633510a97e", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "            msg.sender.transfer(this.balance);", "highlightLines": [22]}, "category": "code", "location": {"file": "dataset/time_manipulation/roulette.sol", "line": 22, "column": 23}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "4d47296c1cdf", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.25;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/time_manipulation/timed_crowdsale.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "9b41ac918951", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.25;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/time_manipulation/timed_crowdsale.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "9e86a27900be", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "    return block.timestamp >= 1546300800;", "highlightLines": [13]}, "category": "code", "location": {"file": "dataset/time_manipulation/timed_crowdsale.sol", "line": 13, "column": 12}, "severity": "medium", "references": [], "description": ""}, {"id": "9c34fc3a7589", "fix": {"template": null, "available": false}, "title": "Block timestamp used for critical logic - miners can manipulate within ~15 second window", "ruleId": "rules.sol-block-timestamp-manipulation", "snippet": {"code": "    return block.timestamp >= 1546300800;", "highlightLines": [13]}, "category": "code", "location": {"file": "dataset/time_manipulation/timed_crowdsale.sol", "line": 13, "column": 12}, "severity": "medium", "references": ["https://consensys.github.io/smart-contract-best-practices/development-recommendations/solidity-specific/timestamp-dependence/"], "description": ""}, {"id": "c90d3b6f59ca", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.24;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "b058dec4af97", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.24;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "149c08c49d85", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyOwner()\n    {\n        require(msg.sender == owner);\n        _;\n    }", "highlightLines": [16]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 16, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "53dd646727fb", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "        require(msg.sender == owner);", "highlightLines": [18]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 18, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "ecd17ba52903", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender == owner);", "highlightLines": [18]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 18, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "e2f1287c3e53", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [19]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 19, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "2e39db516c7f", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "   modifier isOpenToPublic()\n    {\n        require(openToPublic);\n        _;\n    }", "highlightLines": [22]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 22, "column": 4}, "severity": "medium", "references": [], "description": ""}, {"id": "7847fffb5d2b", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(openToPublic);", "highlightLines": [24]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 24, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "35ff1ded0d04", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [25]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 25, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "754e50a54d6c", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyRealPeople()\n    {\n          require (msg.sender == tx.origin);\n        _;\n    }", "highlightLines": [28]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 28, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "5f2f731b78b5", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "          require (msg.sender == tx.origin);", "highlightLines": [30]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 30, "column": 11}, "severity": "info", "references": [], "description": ""}, {"id": "f5e726077faa", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [31]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 31, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "5b2336b8e06d", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier  onlyPlayers()\n    { \n        require (wagers[msg.sender] > 0); \n        _; \n    }", "highlightLines": [34]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 34, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "92c6aad425f5", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "    modifier  onlyPlayers()\n    { \n        require (wagers[msg.sender] > 0); \n        _; \n    }", "highlightLines": [34]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 34, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "09132784ff38", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require (wagers[msg.sender] > 0);", "highlightLines": [36]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 36, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "96a64351ca79", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [37]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 37, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "26ea2f7654c0", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event Wager(uint256 amount, address depositer);", "highlightLines": [44]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 44, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "5d5c648e2da6", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event Win(uint256 amount, address paidTo);", "highlightLines": [45]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 45, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "bcf176ebb053", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event Lose(uint256 amount, address loser);", "highlightLines": [46]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 46, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "337e29fe4767", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event Donate(uint256 amount, address paidTo, address donator);", "highlightLines": [47]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 47, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "c62ba8c6fa10", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event DifficultyChanged(uint256 currentDifficulty);", "highlightLines": [48]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 48, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "e0de600cab14", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event BetLimitChanged(uint256 currentBetLimit);", "highlightLines": [49]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 49, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "cb9875ef544c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 betLimit;", "highlightLines": [55]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 55, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "fcc3c911322f", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint difficulty;", "highlightLines": [56]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 56, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4922d81fe9c0", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address owner;", "highlightLines": [58]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 58, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f3ae29dcd056", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "    address owner;", "highlightLines": [58]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 58, "column": 5}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "d7b632ce9f34", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    bool openToPublic;", "highlightLines": [61]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 61, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7570399536b5", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 totalDonated;", "highlightLines": [62]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 62, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e5ec27c1c6cc", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "    uint256 totalDonated;", "highlightLines": [62]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 62, "column": 5}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "8a5e8929696f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        openToPublic = false;\n        owner = msg.sender;", "highlightLines": [71]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 71, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "1a663e0e5ca3", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        owner = msg.sender;", "highlightLines": [72]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 72, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "af34decc55e3", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        owner = msg.sender;\n        whale = whaleAddress;", "highlightLines": [72]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 72, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "7372fdcfb3e0", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        whale = whaleAddress;\n        totalDonated = 0;", "highlightLines": [73]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 73, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "dd414e042fba", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        totalDonated = 0;\n        betLimit = wagerLimit;", "highlightLines": [74]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 74, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "c2fcd7c5172d", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    onlyOwner()", "highlightLines": [84]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 84, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "272e0004c2a0", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    onlyOwner()", "highlightLines": [94]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 94, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "7a39bdb634cb", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    onlyOwner()", "highlightLines": [106]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 106, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "3801249ff0a7", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.value == betLimit);", "highlightLines": [127]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 127, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "b9ee4fb04f91", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(wagers[msg.sender] == 0);", "highlightLines": [130]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 130, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "2453914c7928", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        timestamps[msg.sender] = block.number;\n        wagers[msg.sender] = msg.value;", "highlightLines": [133]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 133, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "faa0cc793ec6", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 blockNumber = timestamps[msg.sender];", "highlightLines": [147]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 147, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f0c86eba3d0c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 blockNumber = timestamps[msg.sender];\n        if(blockNumber < block.number)\n        {\n            timestamps[msg.sender] = 0;\n            wagers[msg.sender] = 0;\n    \n            uint256 winningNumber = uint256(keccak256(abi.encodePacked(blockhash(blockNumber),  msg.sender)))%difficulty +1;\n    \n            if(winningNumber == difficulty / 2)\n            {\n                payout(msg.sender);\n            }\n            else \n            {\n                //player loses\n                loseWager(betLimit / 2);\n            }    \n        }\n        else\n        {\n            revert();\n        }", "highlightLines": [147]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 147, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "a4a98247f01f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            timestamps[msg.sender] = 0;\n            wagers[msg.sender] = 0;", "highlightLines": [150]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 150, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "fae347e6b31b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            wagers[msg.sender] = 0;\n    \n            uint256 winningNumber = uint256(keccak256(abi.encodePacked(blockhash(blockNumber),  msg.sender)))%difficulty +1;", "highlightLines": [151]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 151, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "2ba28b75b470", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    \n            uint256 winningNumber = uint256(keccak256(abi.encodePacked(blockhash(blockNumber),  msg.sender)))%difficulty +1;", "highlightLines": [152]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 152, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "cecbf54b2703", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "            uint256 winningNumber = uint256(keccak256(abi.encodePacked(blockhash(blockNumber),  msg.sender)))%difficulty +1;", "highlightLines": [153]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 153, "column": 45}, "severity": "high", "references": [], "description": ""}, {"id": "c043817f9259", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "            uint256 winningNumber = uint256(keccak256(abi.encodePacked(blockhash(blockNumber),  msg.sender)))%difficulty +1;", "highlightLines": [153]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 153, "column": 55}, "severity": "medium", "references": [], "description": ""}, {"id": "dc732747a880", "fix": {"template": null, "available": false}, "title": "blockhash only works for last 256 blocks - older blocks return 0 (PredictTheBlockHash pattern)", "ruleId": "rules.sol-blockhash-256-limit", "snippet": {"code": "            uint256 winningNumber = uint256(keccak256(abi.encodePacked(blockhash(blockNumber),  msg.sender)))%difficulty +1;", "highlightLines": [153]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 153, "column": 72}, "severity": "medium", "references": ["https://capturetheether.com/challenges/lottery/predict-block-hash/"], "description": ""}, {"id": "b12570bd7534", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "            uint256 winningNumber = uint256(keccak256(abi.encodePacked(blockhash(blockNumber),  msg.sender)))%difficulty +1;", "highlightLines": [153]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 153, "column": 72}, "severity": "medium", "references": [], "description": ""}, {"id": "37e64fa03667", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "            if(winningNumber == difficulty / 2)\n            {\n                payout(msg.sender);\n            }\n            else \n            {\n                //player loses\n                loseWager(betLimit / 2);\n            }", "highlightLines": [155]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 155, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "66b23bf52527", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 ethToTransfer = address(this).balance / 2;", "highlightLines": [188]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 188, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "386b519921f0", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        winner.transfer(ethToTransfer);", "highlightLines": [190]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 190, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "624696467ac1", "fix": {"template": null, "available": false}, "title": "ERC20 transfer() return value not checked - tokens like USDT don't return bool", "ruleId": "rules.sol-erc20-transfer-no-return-check", "snippet": {"code": "        winner.transfer(ethToTransfer);\n        emit Win(ethToTransfer, winner);", "highlightLines": [190]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 190, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "c05bf1a98220", "fix": {"template": null, "available": false}, "title": "Event emitted after external call - reentrancy can cause events to be logged out of order", "ruleId": "rules.sol-event-after-external-call", "snippet": {"code": "        winner.transfer(ethToTransfer);\n        emit Win(ethToTransfer, winner);", "highlightLines": [190]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 190, "column": 15}, "severity": "info", "references": [], "description": ""}, {"id": "1034c7087087", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    onlyOwner()", "highlightLines": [286]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 286, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "31892edd8540", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        return ERC20Interface(tokenAddress).transfer(tokenOwner, tokens);", "highlightLines": [289]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 289, "column": 16}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "38352dee350a", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "        return ERC20Interface(tokenAddress).transfer(tokenOwner, tokens);", "highlightLines": [289]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 289, "column": 16}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "ca4231c8b467", "fix": {"template": null, "available": false}, "title": "Missing zero address validation - tokens/ETH could be lost", "ruleId": "rules.sol-missing-zero-address-check", "snippet": {"code": "        return ERC20Interface(tokenAddress).transfer(tokenOwner, tokens);", "highlightLines": [289]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 289, "column": 16}, "severity": "info", "references": [], "description": ""}, {"id": "40697c6fafdb", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "        return ERC20Interface(tokenAddress).transfer(tokenOwner, tokens);", "highlightLines": [289]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 289, "column": 16}, "severity": "medium", "references": [], "description": ""}, {"id": "302999f64c54", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function transfer(address to, uint256 tokens) public returns (bool success);", "highlightLines": [296]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x07f7ecb66d788ab01dc93b9b71a88401de7d0f2e.sol", "line": 296, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "e1cbf62904d2", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.10;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x0cbe050f75bc8f8c2d6c0d249fea125fd6e1acc9.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "045b0579e7d2", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.10;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x0cbe050f75bc8f8c2d6c0d249fea125fd6e1acc9.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "299bc1c939b8", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function callAddress(address a) {\n        // <yes> <report> UNCHECKED_LL_CALLS\n        a.call();\n    }", "highlightLines": [10]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x0cbe050f75bc8f8c2d6c0d249fea125fd6e1acc9.sol", "line": 10, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "0f01106563d1", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "        a.call();", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x0cbe050f75bc8f8c2d6c0d249fea125fd6e1acc9.sol", "line": 12, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "2f9ac5c47f0c", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.11;", "highlightLines": [8]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 8, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "4cb250d673b1", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.11;", "highlightLines": [8]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 8, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "00e0b827f981", "fix": {"template": null, "available": false}, "title": "Unchecked subtraction can underflow in Solidity <0.8.0 - use SafeMath (Token pattern)", "ruleId": "rules.sol-integer-underflow-pre-080", "snippet": {"code": "pragma solidity ^0.4.11;\ninterface tokenRecipient { function receiveApproval(address _from, uint256 _value, address _token, bytes _extraData) public; }\n\n\n// title Migration Agent interface\ncontract MigrationAgent {\n    function migrateFrom(address _from, uint256 _value);\n}\n\ncontract ERC20 {\n  uint public totalSupply;\n  function balanceOf(address who) constant returns (uint);\n  function allowance(address owner, address spender) constant returns (uint);\n\n  function transfer(address to, uint value) returns (bool ok);\n  function transferFrom(address from, address to, uint value) returns (bool ok);\n  function approve(address spender, uint value) returns (bool ok);\n  event Transfer(address indexed from, address indexed to, uint value);\n  event Approval(address indexed owner, address indexed spender, uint value);\n}\n\n\n\n/**\n * Math operations with safety checks\n */\ncontract SafeMath {\n  function safeMul(uint a, uint b) internal returns (uint) {\n    uint c = a * b;\n    assert(a == 0 || c / a == b);\n    return c;\n  }\n\n  function safeDiv(uint a, uint b) internal returns (uint) {\n    assert(b > 0);\n    uint c = a / b;\n    assert(a == b * c + a % b);\n    return c;\n  }\n\n  function safeSub(uint a, uint b) internal returns (uint) {\n    assert(b <= a);\n    return a - b;\n  }\n\n  function safeAdd(uint a, uint b) internal returns (uint) {\n    uint c = a + b;\n    assert(c>=a && c>=b);\n    return c;\n  }\n\n  function max64(uint64 a, uint64 b) internal constant returns (uint64) {\n    return a >= b ? a : b;\n  }\n\n  function min64(uint64 a, uint64 b) internal constant returns (uint64) {\n    return a < b ? a : b;\n  }\n\n  function max256(uint256 a, uint256 b) internal constant returns (uint256) {\n    return a >= b ? a : b;\n  }\n\n  function min256(uint256 a, uint256 b) internal constant returns (uint256) {\n    return a < b ? a : b;\n  }\n\n  function assert(bool assertion) internal {\n    if (!assertion) {\n      throw;\n    }\n  }\n}\n\n\n\n/**\n * Standard ERC20 token with Short Hand Attack and approve() race condition mitigation.\n *\n * Based on code by FirstBlood:\n * https://github.com/Firstbloodio/token/blob/master/smart_contract/FirstBloodToken.sol\n */\ncontract StandardToken is ERC20, SafeMath {\n\n  /* Token supply got increased and a new owner received these tokens */\n  event Minted(address receiver, uint amount);\n\n  /* Actual balances of token holders */\n  mapping(address => uint) balances;\n  // what exaclt ether was sent\n  mapping(address => uint) balancesRAW;\n  /* approve() allowances */\n  mapping (address => mapping (address => uint)) allowed;\n\n  /* Interface declaration */\n  function isToken() public constant returns (bool weAre) {\n    return true;\n  }\n\n  function transfer(address _to, uint _value) returns (bool success) {\n    balances[msg.sender] = safeSub(balances[msg.sender], _value);\n    balances[_to] = safeAdd(balances[_to], _value);\n    Transfer(msg.sender, _to, _value);\n    return true;\n  }\n\n  function transferFrom(address _from, address _to, uint _value) returns (bool success) {\n    uint _allowance = allowed[_from][msg.sender];\n\n    balances[_to] = safeAdd(balances[_to], _value);\n    balances[_from] = safeSub(balances[_from], _value);\n    allowed[_from][msg.sender] = safeSub(_allowance, _value);\n    Transfer(_from, _to, _value);\n    return true;\n  }\n\n  function balanceOf(address _owner) constant returns (uint balance) {\n    return balances[_owner];\n  }\n\n  function approve(address _spender, uint _value) returns (bool success) {\n\n    // To change the approve amount you first have to reduce the addresses`\n    //  allowance to zero by calling `approve(_spender, 0)` if it is not\n    //  already 0 to mitigate the race condition described here:\n    //  https://github.com/ethereum/EIPs/issues/20#issuecomment-263524729\n    if ((_value != 0) && (allowed[msg.sender][_spender] != 0)) throw;\n\n    allowed[msg.sender][_spender] = _value;\n    Approval(msg.sender, _spender, _value);\n    return true;\n  }\n\n  function allowance(address _owner, address _spender) constant returns (uint remaining) {\n    return allowed[_owner][_spender];\n  }\n\n  \n  \n}\n\n\n//  daoPOLSKAtokens\ncontract daoPOLSKAtokens{\n\n    string public name = \"DAO POLSKA TOKEN version 1\";\n    string public symbol = \"DPL\";\n    uint8 public constant decimals = 18;  // 18 decimal places, the same as ETC/ETH/HEE.\n\n    // Receives \n    address public owner;\n    address public migrationMaster;\t\n    // The current total token supply.\n\n    uint256 public otherchainstotalsupply =1.0 ether;\n    uint256 public supplylimit      = 10000.0 ether;\n\t//totalSupply   \n   uint256 public  totalSupply      = 0.0 ether;\n\t//chains:\n\taddress public Chain1 = 0x0;\n\taddress public Chain2 = 0x0;\n\taddress public Chain3 = 0x0;\n\taddress public Chain4 = 0x0;\n\n\taddress public migrationAgent=0x8585D5A25b1FA2A0E6c3BcfC098195bac9789BE2;\n    uint256 public totalMigrated;\n\n\n    event Migrate(address indexed _from, address indexed _to, uint256 _value);\n    event Refund(address indexed _from, uint256 _value);\n\n\t\n\tstruct sendTokenAway{\n\t\tStandardToken coinContract;\n\t\tuint amount;\n\t\taddress recipient;\n\t}\n\tmapping(uint => sendTokenAway) transfers;\n\tuint numTransfers=0;\n\t\n  mapping (address => uint256) balances;\nmapping (address => uint256) balancesRAW;\n  mapping (address => mapping (address => uint256)) allowed;\n\n\tevent UpdatedTokenInformation(string newName, string newSymbol);\t\n \n    event Transfer(address indexed _from, address indexed _to, uint256 _value);\n\tevent receivedEther(address indexed _from,uint256 _value);\n  event Approval(address indexed _owner, address indexed _spender, uint256 _value);\n\n      // This notifies clients about the amount burnt\n    event Burn(address indexed from, uint256 value);\n  //tokenCreationCap\n  bool public supplylimitset = false;\n  bool public otherchainstotalset = false;\n   \n  function daoPOLSKAtokens() {\nowner=msg.sender;\nmigrationMaster=msg.sender;\n}\n\nfunction  setSupply(uint256 supplyLOCKER) public {\n    \t   if (msg.sender != owner) {\n      throw;\n    }\n\t\t    \t   if (supplylimitset != false) {\n      throw;\n    }\n\tsupplylimitset = true;\n  \n\tsupplylimit = supplyLOCKER ** uint256(decimals);\n//balances[owner]=supplylimit;\n  } \nfunction setotherchainstotalsupply(uint256 supplyLOCKER) public {\n    \t   if (msg.sender != owner) {\n      throw;\n    }\n\t    \t   if (supplylimitset != false) {\n      throw;\n    }\n\n\totherchainstotalset = true;\n\totherchainstotalsupply = supplyLOCKER ** uint256(decimals);\n\t\n  } \n    /**\n     * Set allowance for other address and notify\n     *\n     * Allows `_spender` to spend no more than `_value` tokens on your behalf, and then ping the contract about it\n     *\n     * @param _spender The address authorized to spend\n     * @param _value the max amount they can spend\n     * @param _extraData some extra information to send to the approved contract\n     */\n    function approveAndCall(address _spender, uint256 _value, bytes _extraData)\n        public\n        returns (bool success) {\n        tokenRecipient spender = tokenRecipient(_spender);\n        if (approve(_spender, _value)) {\n            spender.receiveApproval(msg.sender, _value, this, _extraData);\n            return true;\n        }\n    }\n\n    /**\n     * Destroy tokens\n     *\n     * Remove `_value` tokens from the system irreversibly\n     *\n     * @param _value the amount of money to burn\n     */\n    function burn(uint256 _value) public returns (bool success) {\n        require(balances[msg.sender] >= _value);   // Check if the sender has enough\n        balances[msg.sender] -= _value;            // Subtract from the sender\n        totalSupply -= _value;                      // Updates totalSupply\n        Burn(msg.sender, _value);\n        return true;\n    }\n\n    /**\n     * Destroy tokens from other account\n     *\n     * Remove `_value` tokens from the system irreversibly on behalf of `_from`.\n     *\n     * @param _from the address of the sender\n     * @param _value the amount of money to burn\n     */\n    function burnFrom(address _from, uint256 _value) public returns (bool success) {\n        require(balances[_from] >= _value);                // Check if the targeted balance is enough\n        require(_value <= allowed[_from][msg.sender]);    // Check allowance\n        balances[_from] -= _value;                         // Subtract from the targeted balance", "highlightLines": [8]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 8, "column": 1}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/level/5"], "description": ""}, {"id": "0b3a7c9e6ba4", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "interface tokenRecipient { function receiveApproval(address _from, uint256 _value, address _token, bytes _extraData) public; }", "highlightLines": [9]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 9, "column": 28}, "severity": "info", "references": [], "description": ""}, {"id": "5271c841f655", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function migrateFrom(address _from, uint256 _value);", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 14, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "e77a77f57fc9", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function balanceOf(address who) constant returns (uint);", "highlightLines": [19]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 19, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "964b151a5024", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function allowance(address owner, address spender) constant returns (uint);", "highlightLines": [20]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 20, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "c0b917272b9b", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function transfer(address to, uint value) returns (bool ok);", "highlightLines": [22]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 22, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "12ab1e5f916c", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without msg.data.length validation - vulnerable to short address attack padding", "ruleId": "rules.sol-short-address-no-payload-check", "snippet": {"code": "  function transfer(address to, uint value) returns (bool ok);\n  function transferFrom(address from, address to, uint value) returns (bool ok);\n  function approve(address spender, uint value) returns (bool ok);\n  event Transfer(address indexed from, address indexed to, uint value);\n  event Approval(address indexed owner, address indexed spender, uint value);\n}\n\n\n\n/**\n * Math operations with safety checks\n */\ncontract SafeMath {", "highlightLines": [22]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 22, "column": 3}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address", "https://vessenes.com/the-erc20-short-address-attack-explained/"], "description": ""}, {"id": "fe4d1c54299b", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function transferFrom(address from, address to, uint value) returns (bool ok);", "highlightLines": [23]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 23, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "933d77acaed5", "fix": {"template": null, "available": false}, "title": "ERC20 transferFrom without payload size validation - consider adding onlyPayloadSize modifier", "ruleId": "rules.sol-erc20-missing-payload-modifier", "snippet": {"code": "  function transferFrom(address from, address to, uint value) returns (bool ok);\n  function approve(address spender, uint value) returns (bool ok);\n  event Transfer(address indexed from, address indexed to, uint value);\n  event Approval(address indexed owner, address indexed spender, uint value);\n}\n\n\n\n/**\n * Math operations with safety checks\n */\ncontract SafeMath {", "highlightLines": [23]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 23, "column": 3}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address"], "description": ""}, {"id": "5c1129dc26bf", "fix": {"template": null, "available": false}, "title": "NFT transfer without approval/ownership check - add _isApprovedOrOwner validation", "ruleId": "rules.sol-nft-transfer-no-approval-check", "snippet": {"code": "  function transferFrom(address from, address to, uint value) returns (bool ok);\n  function approve(address spender, uint value) returns (bool ok);\n  event Transfer(address indexed from, address indexed to, uint value);\n  event Approval(address indexed owner, address indexed spender, uint value);\n}\n\n\n\n/**\n * Math operations with safety checks\n */\ncontract SafeMath {", "highlightLines": [23]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 23, "column": 3}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/NFT-transfer.sol"], "description": ""}, {"id": "120b573a5cc0", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  function approve(address spender, uint value) returns (bool ok);", "highlightLines": [24]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 24, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "1aaafb26284a", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event Transfer(address indexed from, address indexed to, uint value);", "highlightLines": [25]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 25, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "dbbb079cc4ac", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event Approval(address indexed owner, address indexed spender, uint value);", "highlightLines": [26]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 26, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "ec9cea2515f5", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "  function safeMul(uint a, uint b) internal returns (uint) {\n    uint c = a * b;\n    assert(a == 0 || c / a == b);", "highlightLines": [35]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 35, "column": 3}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "cb9f63e44fb7", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint c = a * b;", "highlightLines": [36]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 36, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d87dc0ae5a21", "fix": {"template": null, "available": false}, "title": "SWC-110: assert() used for input validation - use require() instead, assert is for invariants", "ruleId": "rules.sol-swc-110-assert-user-input", "snippet": {"code": "    assert(a == 0 || c / a == b);", "highlightLines": [37]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 37, "column": 5}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-110"], "description": ""}, {"id": "7c8bc7f25406", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "  function safeDiv(uint a, uint b) internal returns (uint) {\n    assert(b > 0);\n    uint c = a / b;\n    assert(a == b * c + a % b);", "highlightLines": [41]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 41, "column": 3}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "70eb06428e04", "fix": {"template": null, "available": false}, "title": "SWC-110: assert() used for input validation - use require() instead, assert is for invariants", "ruleId": "rules.sol-swc-110-assert-user-input", "snippet": {"code": "    assert(b > 0);", "highlightLines": [42]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 42, "column": 5}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-110"], "description": ""}, {"id": "99818395bb31", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint c = a / b;", "highlightLines": [43]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 43, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8a0d7bea51af", "fix": {"template": null, "available": false}, "title": "SWC-110: assert() used for input validation - use require() instead, assert is for invariants", "ruleId": "rules.sol-swc-110-assert-user-input", "snippet": {"code": "    assert(a == b * c + a % b);", "highlightLines": [44]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 44, "column": 5}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-110"], "description": ""}, {"id": "b529921e454a", "fix": {"template": null, "available": false}, "title": "SWC-110: assert() used for input validation - use require() instead, assert is for invariants", "ruleId": "rules.sol-swc-110-assert-user-input", "snippet": {"code": "    assert(b <= a);", "highlightLines": [49]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 49, "column": 5}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-110"], "description": ""}, {"id": "b9b2e1247673", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint c = a + b;", "highlightLines": [54]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 54, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "42fc7564c32a", "fix": {"template": null, "available": false}, "title": "SWC-110: assert() used for input validation - use require() instead, assert is for invariants", "ruleId": "rules.sol-swc-110-assert-user-input", "snippet": {"code": "    assert(c>=a && c>=b);", "highlightLines": [55]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 55, "column": 5}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-110"], "description": ""}, {"id": "291b3551d55c", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "      throw;", "highlightLines": [77]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 77, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "b2b13b29f5aa", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "  event Minted(address receiver, uint amount);", "highlightLines": [93]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 93, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "a5c27b0437d3", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event Minted(address receiver, uint amount);", "highlightLines": [93]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 93, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "d67bdfefe586", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without msg.data.length validation - vulnerable to short address attack padding", "ruleId": "rules.sol-short-address-no-payload-check", "snippet": {"code": "  function transfer(address _to, uint _value) returns (bool success) {", "highlightLines": [107]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 107, "column": 3}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address", "https://vessenes.com/the-erc20-short-address-attack-explained/"], "description": ""}, {"id": "fc9591e5a3b6", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function transfer(address _to, uint _value) returns (bool success) {\n    balances[msg.sender] = safeSub(balances[msg.sender], _value);\n    balances[_to] = safeAdd(balances[_to], _value);\n    Transfer(msg.sender, _to, _value);\n    return true;\n  }", "highlightLines": [107]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 107, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "c0876dcc5e4f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    balances[msg.sender] = safeSub(balances[msg.sender], _value);\n    balances[_to] = safeAdd(balances[_to], _value);", "highlightLines": [108]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 108, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "461633461850", "fix": {"template": null, "available": false}, "title": "ERC20 transferFrom without payload size validation - consider adding onlyPayloadSize modifier", "ruleId": "rules.sol-erc20-missing-payload-modifier", "snippet": {"code": "  function transferFrom(address _from, address _to, uint _value) returns (bool success) {", "highlightLines": [114]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 114, "column": 3}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address"], "description": ""}, {"id": "cad03e0c0099", "fix": {"template": null, "available": false}, "title": "NFT transfer without approval/ownership check - add _isApprovedOrOwner validation", "ruleId": "rules.sol-nft-transfer-no-approval-check", "snippet": {"code": "  function transferFrom(address _from, address _to, uint _value) returns (bool success) {", "highlightLines": [114]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 114, "column": 3}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/NFT-transfer.sol"], "description": ""}, {"id": "d0d8ee107587", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function transferFrom(address _from, address _to, uint _value) returns (bool success) {\n    uint _allowance = allowed[_from][msg.sender];\n\n    balances[_to] = safeAdd(balances[_to], _value);\n    balances[_from] = safeSub(balances[_from], _value);\n    allowed[_from][msg.sender] = safeSub(_allowance, _value);\n    Transfer(_from, _to, _value);\n    return true;\n  }", "highlightLines": [114]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 114, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "08299d74496e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint _allowance = allowed[_from][msg.sender];", "highlightLines": [115]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 115, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "291714c6ad2c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint _allowance = allowed[_from][msg.sender];\n\n    balances[_to] = safeAdd(balances[_to], _value);", "highlightLines": [115]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 115, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "30d5bcfc361c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    balances[_to] = safeAdd(balances[_to], _value);\n    balances[_from] = safeSub(balances[_from], _value);", "highlightLines": [117]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 117, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "ba81d661ae94", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    balances[_from] = safeSub(balances[_from], _value);\n    allowed[_from][msg.sender] = safeSub(_allowance, _value);", "highlightLines": [118]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 118, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "5cb0e6ac7698", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function balanceOf(address _owner) constant returns (uint balance) {\n    return balances[_owner];\n  }", "highlightLines": [124]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 124, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "18a6b3b199d0", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function approve(address _spender, uint _value) returns (bool success) {\n\n    // To change the approve amount you first have to reduce the addresses`\n    //  allowance to zero by calling `approve(_spender, 0)` if it is not\n    //  already 0 to mitigate the race condition described here:\n    //  https://github.com/ethereum/EIPs/issues/20#issuecomment-263524729\n    if ((_value != 0) && (allowed[msg.sender][_spender] != 0)) throw;\n\n    allowed[msg.sender][_spender] = _value;\n    Approval(msg.sender, _spender, _value);\n    return true;\n  }", "highlightLines": [128]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 128, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "f09abc028e77", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "    if ((_value != 0) && (allowed[msg.sender][_spender] != 0)) throw;\n\n    allowed[msg.sender][_spender] = _value;", "highlightLines": [134]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 134, "column": 64}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "cebbcc8b5829", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function allowance(address _owner, address _spender) constant returns (uint remaining) {\n    return allowed[_owner][_spender];\n  }", "highlightLines": [141]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 141, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "4e8a12b3ac4d", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Migrate(address indexed _from, address indexed _to, uint256 _value);", "highlightLines": [176]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 176, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "da5c9f18cbfc", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Refund(address indexed _from, uint256 _value);", "highlightLines": [177]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 177, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "4986f7967f70", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\t\tuint amount;", "highlightLines": [182]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 182, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c17e96dc0ebc", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\t\taddress recipient;", "highlightLines": [183]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 183, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "577951d8651f", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\tuint numTransfers=0;", "highlightLines": [186]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 186, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "748577a83763", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "\tevent UpdatedTokenInformation(string newName, string newSymbol);", "highlightLines": [192]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 192, "column": 2}, "severity": "info", "references": [], "description": ""}, {"id": "0305ceca1f1a", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Transfer(address indexed _from, address indexed _to, uint256 _value);", "highlightLines": [194]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 194, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "e419dc32ecdc", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "\tevent receivedEther(address indexed _from,uint256 _value);", "highlightLines": [195]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 195, "column": 2}, "severity": "info", "references": [], "description": ""}, {"id": "63cab4d497be", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "  event Approval(address indexed _owner, address indexed _spender, uint256 _value);", "highlightLines": [196]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 196, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "e96cd7860817", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Burn(address indexed from, uint256 value);", "highlightLines": [199]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 199, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "ce05a664b202", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function daoPOLSKAtokens() {\nowner=msg.sender;\nmigrationMaster=msg.sender;\n}", "highlightLines": [204]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 204, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "6ebe6ec6f6f9", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "owner=msg.sender;", "highlightLines": [205]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 205, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "b44c038475f7", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "owner=msg.sender;\nmigrationMaster=msg.sender;", "highlightLines": [205]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 205, "column": 1}, "severity": "medium", "references": [], "description": ""}, {"id": "83ae0bfa1b33", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "      throw;", "highlightLines": [211]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 211, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "ac25ecc7c9b0", "fix": {"template": null, "available": false}, "title": "Unnecessary comparison to boolean constant - use variable directly", "ruleId": "rules.sol-boolean-constant-comparison", "snippet": {"code": "\t\t    \t   if (supplylimitset != false) {", "highlightLines": [213]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 213, "column": 30}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#boolean-equality"], "description": ""}, {"id": "e8806d18e738", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "      throw;", "highlightLines": [214]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 214, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "d256b07a1109", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "\tsupplylimitset = true;\n  \n\tsupplylimit = supplyLOCKER ** uint256(decimals);", "highlightLines": [216]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 216, "column": 2}, "severity": "medium", "references": [], "description": ""}, {"id": "578801ae9997", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "      throw;", "highlightLines": [223]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 223, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "64de5067e896", "fix": {"template": null, "available": false}, "title": "Unnecessary comparison to boolean constant - use variable directly", "ruleId": "rules.sol-boolean-constant-comparison", "snippet": {"code": "\t    \t   if (supplylimitset != false) {", "highlightLines": [225]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 225, "column": 29}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#boolean-equality"], "description": ""}, {"id": "ca96cfbd5f11", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "      throw;", "highlightLines": [226]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 226, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "84ef61e45158", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "\totherchainstotalset = true;\n\totherchainstotalsupply = supplyLOCKER ** uint256(decimals);", "highlightLines": [229]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 229, "column": 2}, "severity": "medium", "references": [], "description": ""}, {"id": "817050248992", "fix": {"template": null, "available": false}, "title": "approveAndCall pattern enables callback attacks - verify callback target", "ruleId": "rules.sol-approve-and-call-callback", "snippet": {"code": "    function approveAndCall(address _spender, uint256 _value, bytes _extraData)", "highlightLines": [242]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 242, "column": 14}, "severity": "medium", "references": [], "description": ""}, {"id": "6782b92b92ed", "fix": {"template": null, "available": false}, "title": "ERC20 approve race condition - use increaseAllowance instead", "ruleId": "rules.sol-erc20-double-approve", "snippet": {"code": "        if (approve(_spender, _value)) {", "highlightLines": [246]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 246, "column": 13}, "severity": "info", "references": ["https://github.com/ethereum/EIPs/issues/20#issuecomment-263524729"], "description": ""}, {"id": "26a7bcfe6117", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function burn(uint256 _value) public returns (bool success) {", "highlightLines": [259]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 259, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "ad1fb67a009e", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function burn(uint256 _value) public returns (bool success) {", "highlightLines": [259]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 259, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "861d43e4762a", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "    function burn(uint256 _value) public returns (bool success) {\n        require(balances[msg.sender] >= _value);   // Check if the sender has enough", "highlightLines": [259]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 259, "column": 5}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "038e5f60ec18", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - will never return false, only revert", "ruleId": "rules.sol-return-bool-always-reverts", "snippet": {"code": "    function burn(uint256 _value) public returns (bool success) {\n        require(balances[msg.sender] >= _value);   // Check if the sender has enough\n        balances[msg.sender] -= _value;            // Subtract from the sender\n        totalSupply -= _value;                      // Updates totalSupply\n        Burn(msg.sender, _value);\n        return true;\n    }", "highlightLines": [259]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 259, "column": 5}, "severity": "info", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "0fe902d3c335", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(balances[msg.sender] >= _value);   // Check if the sender has enough", "highlightLines": [260]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 260, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "20948af1c483", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "    function burnFrom(address _from, uint256 _value) public returns (bool success) {\n        require(balances[_from] >= _value);                // Check if the targeted balance is enough\n        require(_value <= allowed[_from][msg.sender]);    // Check allowance", "highlightLines": [275]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 275, "column": 5}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "f71532742404", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - will never return false, only revert", "ruleId": "rules.sol-return-bool-always-reverts", "snippet": {"code": "    function burnFrom(address _from, uint256 _value) public returns (bool success) {\n        require(balances[_from] >= _value);                // Check if the targeted balance is enough\n        require(_value <= allowed[_from][msg.sender]);    // Check allowance\n        balances[_from] -= _value;                         // Subtract from the targeted balance\n        allowed[_from][msg.sender] -= _value;             // Subtract from the sender's allowance\n        totalSupply -= _value;                              // Update totalSupply\n        Burn(_from, _value);\n        return true;\n    }", "highlightLines": [275]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 275, "column": 5}, "severity": "info", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "c068b1863225", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(balances[_from] >= _value);                // Check if the targeted balance is enough", "highlightLines": [276]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 276, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "7c75f408d0a1", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_value <= allowed[_from][msg.sender]);    // Check allowance", "highlightLines": [277]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 277, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "425ea1bfa40f", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without msg.data.length validation - vulnerable to short address attack padding", "ruleId": "rules.sol-short-address-no-payload-check", "snippet": {"code": "  function transfer(address _to, uint256 _value) returns (bool success) {", "highlightLines": [285]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 285, "column": 3}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address", "https://vessenes.com/the-erc20-short-address-attack-explained/"], "description": ""}, {"id": "3cdcde6633d7", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function transfer(address _to, uint256 _value) returns (bool success) {\n    //Default assumes totalSupply can't be over max (2^256 - 1).\n    //If your token leaves out totalSupply and can issue more tokens as time goes on, you need to check if it doesn't wrap.\n    //Replace the if with this one instead.\n    if (balances[msg.sender] >= _value && balances[_to] + _value > balances[_to]) {\n    //if (balances[msg.sender] >= _value && _value > 0) {\n      balances[msg.sender] -= _value;\n      balances[_to] += _value;\n      Transfer(msg.sender, _to, _value);\n      return true;\n    } else { return false; }\n  }", "highlightLines": [285]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 285, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "a0e4b33afd97", "fix": {"template": null, "available": false}, "title": "Possible incorrect exponentiation - ^ is XOR in Solidity, use ** for power", "ruleId": "rules.sol-incorrect-exponentiation", "snippet": {"code": "    //Default assumes totalSupply can't be over max (2^256 - 1).", "highlightLines": [286]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 286, "column": 54}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-exponentiation"], "description": ""}, {"id": "c06d5d16de5f", "fix": {"template": null, "available": false}, "title": "ERC20 transferFrom without payload size validation - consider adding onlyPayloadSize modifier", "ruleId": "rules.sol-erc20-missing-payload-modifier", "snippet": {"code": "  function transferFrom(address _from, address _to, uint256 _value) returns (bool success) {", "highlightLines": [298]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 298, "column": 3}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address"], "description": ""}, {"id": "755889aa5959", "fix": {"template": null, "available": false}, "title": "NFT transfer without approval/ownership check - add _isApprovedOrOwner validation", "ruleId": "rules.sol-nft-transfer-no-approval-check", "snippet": {"code": "  function transferFrom(address _from, address _to, uint256 _value) returns (bool success) {", "highlightLines": [298]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 298, "column": 3}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/NFT-transfer.sol"], "description": ""}, {"id": "b62ee4c26fe8", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function transferFrom(address _from, address _to, uint256 _value) returns (bool success) {\n    //same as above. Replace this line with the following if you want to protect against wrapping uints.\n    if (balances[_from] >= _value && allowed[_from][msg.sender] >= _value && balances[_to] + _value > balances[_to]) {\n    //if (balances[_from] >= _value && allowed[_from][msg.sender] >= _value && _value > 0) {\n      balances[_to] += _value;\n      balances[_from] -= _value;\n      allowed[_from][msg.sender] -= _value;\n      Transfer(_from, _to, _value);\n      return true;\n    } else { return false; }\n  }", "highlightLines": [298]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 298, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "9b91475e06d9", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function balanceOf(address _owner) constant returns (uint256 balance) {\n    return balances[_owner];\n  }", "highlightLines": [310]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 310, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "0ca38019274a", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function approve(address _spender, uint256 _value) returns (bool success) {\n    allowed[msg.sender][_spender] = _value;\n    Approval(msg.sender, _spender, _value);\n    return true;\n  }", "highlightLines": [314]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 314, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "d8617994338e", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function allowance(address _owner, address _spender) constant returns (uint256 remaining) {\n    return allowed[_owner][_spender];\n  }", "highlightLines": [320]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 320, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "f9de58a67dca", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function setTokenInformation(string _name, string _symbol) {\n    \n\t   if (msg.sender != owner) {\n      throw;\n    }\n\tname = _name;\n    symbol = _symbol;\n\n    UpdatedTokenInformation(name, symbol);\n  }", "highlightLines": [338]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 338, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "b024b240b427", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "      throw;", "highlightLines": [341]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 341, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "71370a9122af", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "\tname = _name;\n    symbol = _symbol;", "highlightLines": [343]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 343, "column": 2}, "severity": "medium", "references": [], "description": ""}, {"id": "19a2fae43fd5", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "function setChainsAddresses(address chainAd, int chainnumber) {\n    \n\t   if (msg.sender != owner) {\n      throw;\n    }\n\tif(chainnumber==1){Chain1=chainAd;}\n\tif(chainnumber==2){Chain2=chainAd;}\n\tif(chainnumber==3){Chain3=chainAd;}\n\tif(chainnumber==4){Chain4=chainAd;}\t\t\n  }", "highlightLines": [349]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 349, "column": 1}, "severity": "medium", "references": [], "description": ""}, {"id": "c971433debb4", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "      throw;", "highlightLines": [352]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 352, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "eedde6311dea", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "\tfunction sendTokenAw(address StandardTokenAddress, address receiver, uint amount){\n\t\tif (msg.sender != owner) {\n\t\tthrow;\n\t\t}\n\t\tsendTokenAway t = transfers[numTransfers];\n\t\tt.coinContract = StandardToken(StandardTokenAddress);\n\t\tt.amount = amount;\n\t\tt.recipient = receiver;\n\t\tt.coinContract.transfer(receiver, amount);\n\t\tnumTransfers++;\n\t}", "highlightLines": [366]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 366, "column": 2}, "severity": "medium", "references": [], "description": ""}, {"id": "d09077e7fba2", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "\t\tthrow;", "highlightLines": [368]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 368, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "e63b7ed03fce", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "\t\tsendTokenAway t = transfers[numTransfers];\n\t\tt.coinContract = StandardToken(StandardTokenAddress);", "highlightLines": [370]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 370, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "fcd0ec5ac304", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "\t\tt.coinContract = StandardToken(StandardTokenAddress);\n\t\tt.amount = amount;", "highlightLines": [371]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 371, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "c45988d9a5de", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "\t\tt.amount = amount;\n\t\tt.recipient = receiver;", "highlightLines": [372]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 372, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "4a125ae89f8a", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "\t\tt.coinContract.transfer(receiver, amount);", "highlightLines": [374]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 374, "column": 3}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "fdb3574a976d", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "\t\tt.coinContract.transfer(receiver, amount);", "highlightLines": [374]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 374, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "757ced2b6c71", "fix": {"template": null, "available": false}, "title": "ERC20 transfer() return value not checked - tokens like USDT don't return bool", "ruleId": "rules.sol-erc20-transfer-no-return-check", "snippet": {"code": "\t\tt.coinContract.transfer(receiver, amount);", "highlightLines": [374]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 374, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "e1adb6168a9a", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "        function createDaoPOLSKAtokens(address holder) payable {\n\n        if (!funding) throw;\n\n        // Do not allow creating 0 or more than the cap tokens.\n        if (msg.value == 0) throw;\n\t\t// check the maximum token creation cap\n        if (msg.value > (supplylimit - totalSupply) / CreationRate)\n          throw;\n\t\t\n\t\t//bonus structure\n// in early stage there is about 100% more details in ico regulations on website\n// price and converstion rate in tabled to PLN not ether, and is updated daily\n\n\n\n\t var numTokensRAW = msg.value;\n\n        var numTokens = msg.value * CreationRate;\n        totalSupply += numTokens;\n\n        // Assign new tokens to the sender\n        balances[holder] += numTokens;\n        balancesRAW[holder] += numTokensRAW;\n        // Log token creation event\n        Transfer(0, holder, numTokens);\n\t\t\n\t\t// Create additional Dao Tokens for the community and developers around 12%\n        uint256 percentOfTotal = 12;\n        uint256 additionalTokens = \tnumTokens * percentOfTotal / (100);\n\n        totalSupply += additionalTokens;\n\n        balances[migrationMaster] += additionalTokens;\n        Transfer(0, migrationMaster, additionalTokens);\n\t\n\t}", "highlightLines": [387]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 387, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "5877dacdb58a", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "          throw;", "highlightLines": [395]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 395, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "0c51bd653b3f", "fix": {"template": null, "available": false}, "title": "Deprecated 'var' keyword can cause type confusion - resolves to smallest type (e.g., uint8 in loops)", "ruleId": "rules.sol-deprecated-var-keyword", "snippet": {"code": "\t var numTokensRAW = msg.value;", "highlightLines": [403]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 403, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/honeypots"], "description": ""}, {"id": "77252899355f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "\t var numTokensRAW = msg.value;\n\n        var numTokens = msg.value * CreationRate;", "highlightLines": [403]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 403, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "d75633896ba7", "fix": {"template": null, "available": false}, "title": "Deprecated 'var' keyword can cause type confusion - resolves to smallest type (e.g., uint8 in loops)", "ruleId": "rules.sol-deprecated-var-keyword", "snippet": {"code": "        var numTokens = msg.value * CreationRate;", "highlightLines": [405]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 405, "column": 9}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/honeypots"], "description": ""}, {"id": "97ce7c930f32", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        var numTokens = msg.value * CreationRate;\n        totalSupply += numTokens;\n\n        // Assign new tokens to the sender\n        balances[holder] += numTokens;\n        balancesRAW[holder] += numTokensRAW;\n        // Log token creation event\n        Transfer(0, holder, numTokens);\n\t\t\n\t\t// Create additional Dao Tokens for the community and developers around 12%\n        uint256 percentOfTotal = 12;", "highlightLines": [405]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 405, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "76047341ed8d", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "        // Log token creation event\n        Transfer(0, holder, numTokens);", "highlightLines": [411]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 411, "column": 31}, "severity": "info", "references": [], "description": ""}, {"id": "ee23a7b17269", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 percentOfTotal = 12;", "highlightLines": [415]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 415, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "336e43f8bbb0", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 percentOfTotal = 12;\n        uint256 additionalTokens = \tnumTokens * percentOfTotal / (100);", "highlightLines": [415]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 415, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "86e2063214d3", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 additionalTokens = \tnumTokens * percentOfTotal / (100);", "highlightLines": [416]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 416, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f8cc44109f3a", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "\tfunction setBonusCreationRate(uint newRate){\n\tif(msg.sender == owner) {\n\tbonusCreationRate=newRate;\n\tCreationRate=tokenCreationRate+bonusCreationRate;\n\t}\n\t}", "highlightLines": [424]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 424, "column": 2}, "severity": "medium", "references": [], "description": ""}, {"id": "6fe02de0b0ae", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "\tbonusCreationRate=newRate;\n\tCreationRate=tokenCreationRate+bonusCreationRate;", "highlightLines": [426]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 426, "column": 2}, "severity": "medium", "references": [], "description": ""}, {"id": "ef7153e85de9", "fix": {"template": null, "available": false}, "title": "Variable written twice without being read between - first write is dead store", "ruleId": "rules.sol-write-after-write", "snippet": {"code": "\tbonusCreationRate=newRate;\n\tCreationRate=tokenCreationRate+bonusCreationRate;", "highlightLines": [426]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 426, "column": 7}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#write-after-write"], "description": ""}, {"id": "0390638fc127", "fix": {"template": null, "available": false}, "title": "Unnecessary comparison to boolean constant - use variable directly", "ruleId": "rules.sol-boolean-constant-comparison", "snippet": {"code": "\tif(funding==true) throw;", "highlightLines": [432]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 432, "column": 12}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#boolean-equality"], "description": ""}, {"id": "1e8d5be12ef3", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "\tif(funding==true) throw;\n\t\t \tif (!owner.send(this.balance)) throw;", "highlightLines": [432]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 432, "column": 20}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "62a27c8be6fc", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "\t\t \tif (!owner.send(this.balance)) throw;", "highlightLines": [433]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 433, "column": 15}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "4917db705051", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "        owner.send(this.balance - SubX);", "highlightLines": [439]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 439, "column": 9}, "severity": "high", "references": [], "description": ""}, {"id": "41713f33e29b", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "        owner.send(this.balance - SubX);", "highlightLines": [439]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 439, "column": 14}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "ed9fc813dd2d", "fix": {"template": null, "available": false}, "title": "send() return value not checked - Ether may be stuck if recipient reverts", "ruleId": "rules.sol-unchecked-send-return", "snippet": {"code": "        owner.send(this.balance - SubX);", "highlightLines": [439]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 439, "column": 14}, "severity": "high", "references": [], "description": ""}, {"id": "3b8583d82e63", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "\t      if (msg.sender != owner) throw;\n\trefundstate=!refundstate;", "highlightLines": [442]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 442, "column": 33}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "4e3aed650f2c", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "\t      if (msg.sender != owner) throw;\n\tfunding=!funding;", "highlightLines": [447]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 447, "column": 33}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "aae05a662b39", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "\t      if (msg.sender != migrationMaster) throw;\n\tmigratestate=!migratestate;", "highlightLines": [451]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 451, "column": 43}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "ada840a0b35c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        funding = false;\t\n\t\trefundstate=!refundstate;", "highlightLines": [460]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 460, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "2dea81526c43", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "        if (msg.sender==owner)\n        // <yes> <report> UNCHECKED_LL_CALLS\n\t\towner.send(this.balance);", "highlightLines": [463]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 463, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "a46788908711", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "\t\towner.send(this.balance);", "highlightLines": [465]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 465, "column": 3}, "severity": "high", "references": [], "description": ""}, {"id": "9501029bdefc", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "\t\towner.send(this.balance);", "highlightLines": [465]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 465, "column": 8}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "8ac29a9dbdc5", "fix": {"template": null, "available": false}, "title": "send() return value not checked - Ether may be stuck if recipient reverts", "ruleId": "rules.sol-unchecked-send-return", "snippet": {"code": "\t\towner.send(this.balance);", "highlightLines": [465]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 465, "column": 8}, "severity": "high", "references": [], "description": ""}, {"id": "2e8056685fda", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function migrate(uint256 _value) external {\n        // Abort if not in Operational Migration state.\n        if (migratestate) throw;\n\n\n        // Validate input value.\n        if (_value == 0) throw;", "highlightLines": [467]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 467, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "15f32d7e9997", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "        if (_value == 0) throw;\n        if (_value > balances[msg.sender]) throw;", "highlightLines": [473]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 473, "column": 26}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "ba7fc27ebe5c", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "        if (_value > balances[msg.sender]) throw;\n\n        balances[msg.sender] -= _value;", "highlightLines": [474]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 474, "column": 44}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "2136f287ec0c", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "        if (funding) throw;\n        if (!refundstate) throw;", "highlightLines": [485]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 485, "column": 22}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "f02b4f4ac5fc", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "        if (!refundstate) throw;\n\n        var DAOPLTokenValue = balances[msg.sender];", "highlightLines": [486]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 486, "column": 27}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "c90072081451", "fix": {"template": null, "available": false}, "title": "Deprecated 'var' keyword can cause type confusion - resolves to smallest type (e.g., uint8 in loops)", "ruleId": "rules.sol-deprecated-var-keyword", "snippet": {"code": "        var DAOPLTokenValue = balances[msg.sender];", "highlightLines": [488]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 488, "column": 9}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/honeypots"], "description": ""}, {"id": "4086bc9b7967", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        var DAOPLTokenValue = balances[msg.sender];\n        var ETHValue = balancesRAW[msg.sender];", "highlightLines": [488]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 488, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "69923578df7b", "fix": {"template": null, "available": false}, "title": "Deprecated 'var' keyword can cause type confusion - resolves to smallest type (e.g., uint8 in loops)", "ruleId": "rules.sol-deprecated-var-keyword", "snippet": {"code": "        var ETHValue = balancesRAW[msg.sender];", "highlightLines": [489]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 489, "column": 9}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/honeypots"], "description": ""}, {"id": "f30df76d6ea5", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        var ETHValue = balancesRAW[msg.sender];\n        if (ETHValue == 0) throw;\n        balancesRAW[msg.sender] = 0;", "highlightLines": [489]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 489, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "b0a6618b6e00", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "        if (ETHValue == 0) throw;\n        balancesRAW[msg.sender] = 0;", "highlightLines": [490]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 490, "column": 28}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "a9bea3682fc6", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        msg.sender.transfer(ETHValue);", "highlightLines": [495]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x19cf8481ea15427a98ba3cdd6d9e14690011ab10.sol", "line": 495, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "be9a1fe215cf", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.25;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x2972d548497286d18e92b5fa1f8f9139e5653fd2.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "35ae26cd1bef", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.25;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x2972d548497286d18e92b5fa1f8f9139e5653fd2.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "fbd5e92c7c97", "fix": {"template": null, "available": false}, "title": "Self transfer not checked - can cause balance corruption with from == to", "ruleId": "rules.sol-self-transfer-unchecked", "snippet": {"code": "    function transfer(address from,address caddress,address[] _tos,uint[] v)public returns (bool){", "highlightLines": [9]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x2972d548497286d18e92b5fa1f8f9139e5653fd2.sol", "line": 9, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/self-transfer.sol"], "description": ""}, {"id": "8f2db17e4d39", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "    function transfer(address from,address caddress,address[] _tos,uint[] v)public returns (bool){\n        require(_tos.length > 0);", "highlightLines": [9]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x2972d548497286d18e92b5fa1f8f9139e5653fd2.sol", "line": 9, "column": 5}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "a7dc90143b81", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_tos.length > 0);", "highlightLines": [10]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x2972d548497286d18e92b5fa1f8f9139e5653fd2.sol", "line": 10, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "cacb17b23ef2", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes4 id=bytes4(keccak256(\"transferFrom(address,address,uint256)\"));", "highlightLines": [11]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x2972d548497286d18e92b5fa1f8f9139e5653fd2.sol", "line": 11, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "399336b7583c", "fix": {"template": null, "available": false}, "title": "Empty array bypasses loop logic - add length check before loop", "ruleId": "rules.sol-empty-array-loop-bypass", "snippet": {"code": "        for(uint i=0;i<_tos.length;i++){", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x2972d548497286d18e92b5fa1f8f9139e5653fd2.sol", "line": 12, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/empty-loop.sol"], "description": ""}, {"id": "c77b5b052b02", "fix": {"template": null, "available": false}, "title": "Unbounded loop iterating over dynamic array - can cause out-of-gas DoS", "ruleId": "rules.sol-unbounded-loop-dos", "snippet": {"code": "        for(uint i=0;i<_tos.length;i++){\n             // <yes> <report> UNCHECKED_LL_CALLS\n            caddress.call(id,from,_tos[i],v[i]);", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x2972d548497286d18e92b5fa1f8f9139e5653fd2.sol", "line": 12, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "7acb948c47a4", "fix": {"template": null, "available": false}, "title": "Unbounded loop over dynamic array - can cause DoS if array grows large", "ruleId": "rules.sol-unbounded-protocol-loop", "snippet": {"code": "        for(uint i=0;i<_tos.length;i++){\n             // <yes> <report> UNCHECKED_LL_CALLS\n            caddress.call(id,from,_tos[i],v[i]);", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x2972d548497286d18e92b5fa1f8f9139e5653fd2.sol", "line": 12, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "ee56d7d80d59", "fix": {"template": null, "available": false}, "title": "Loop with external transfers - one failing recipient blocks all others", "ruleId": "rules.sol-denial-of-service-loop-transfer", "snippet": {"code": "        for(uint i=0;i<_tos.length;i++){\n             // <yes> <report> UNCHECKED_LL_CALLS\n            caddress.call(id,from,_tos[i],v[i]);", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x2972d548497286d18e92b5fa1f8f9139e5653fd2.sol", "line": 12, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "5f5d45ffb294", "fix": {"template": null, "available": false}, "title": "Unbounded loop over array - potential DOS via gas limit", "ruleId": "rules.sol-unbounded-loop", "snippet": {"code": "        for(uint i=0;i<_tos.length;i++){\n             // <yes> <report> UNCHECKED_LL_CALLS\n            caddress.call(id,from,_tos[i],v[i]);\n        }", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x2972d548497286d18e92b5fa1f8f9139e5653fd2.sol", "line": 12, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "5975b7cc4d58", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "            caddress.call(id,from,_tos[i],v[i]);", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x2972d548497286d18e92b5fa1f8f9139e5653fd2.sol", "line": 14, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "2ff0668cb7c5", "fix": {"template": null, "available": false}, "title": "External call in loop - gas griefing and DOS risk", "ruleId": "rules.sol-external-call-in-loop", "snippet": {"code": "            caddress.call(id,from,_tos[i],v[i]);", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x2972d548497286d18e92b5fa1f8f9139e5653fd2.sol", "line": 14, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "fa19ecda0888", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.18;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x39cfd754c85023648bf003bea2dd498c5612abfa.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "08d024a94629", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.18;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x39cfd754c85023648bf003bea2dd498c5612abfa.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "03e0f2d7cf31", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address newOwner;", "highlightLines": [11]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x39cfd754c85023648bf003bea2dd498c5612abfa.sol", "line": 11, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3a32a0acb9c7", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address owner = msg.sender;", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x39cfd754c85023648bf003bea2dd498c5612abfa.sol", "line": 12, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f57abaafbd4d", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "    address owner = msg.sender;", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x39cfd754c85023648bf003bea2dd498c5612abfa.sol", "line": 12, "column": 5}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "8b6809aad9b0", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "    address owner = msg.sender;", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x39cfd754c85023648bf003bea2dd498c5612abfa.sol", "line": 12, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "3831df20e514", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    onlyOwner", "highlightLines": [16]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x39cfd754c85023648bf003bea2dd498c5612abfa.sol", "line": 16, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "6b83693b3d9d", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "            owner=newOwner;", "highlightLines": [26]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x39cfd754c85023648bf003bea2dd498c5612abfa.sol", "line": 26, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "71f9c87181f2", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyOwner\n    {\n        if(owner == msg.sender)_;\n    }", "highlightLines": [30]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x39cfd754c85023648bf003bea2dd498c5612abfa.sol", "line": 30, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "b6c4bbdcfb14", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract Token is Ownable\n{\n    address owner = msg.sender;", "highlightLines": [36]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x39cfd754c85023648bf003bea2dd498c5612abfa.sol", "line": 36, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "7667bfc5d9ce", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address owner = msg.sender;", "highlightLines": [38]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x39cfd754c85023648bf003bea2dd498c5612abfa.sol", "line": 38, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d669602d6e87", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "    address owner = msg.sender;", "highlightLines": [38]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x39cfd754c85023648bf003bea2dd498c5612abfa.sol", "line": 38, "column": 5}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "4169140a566f", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "    address owner = msg.sender;", "highlightLines": [38]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x39cfd754c85023648bf003bea2dd498c5612abfa.sol", "line": 38, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "41bc201dfe80", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    onlyOwner", "highlightLines": [41]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x39cfd754c85023648bf003bea2dd498c5612abfa.sol", "line": 41, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "2defe6a759ff", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "        token.call(bytes4(sha3(\"transfer(address,uint256)\")),to,amount);", "highlightLines": [44]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x39cfd754c85023648bf003bea2dd498c5612abfa.sol", "line": 44, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "0040b17fed2c", "fix": {"template": null, "available": false}, "title": "sha3() is deprecated - use keccak256() instead", "ruleId": "rules.sol-deprecated-sha3", "snippet": {"code": "        token.call(bytes4(sha3(\"transfer(address,uint256)\")),to,amount);", "highlightLines": [44]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x39cfd754c85023648bf003bea2dd498c5612abfa.sol", "line": 44, "column": 27}, "severity": "info", "references": [], "description": ""}, {"id": "d723f65e5740", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract TokenBank is Token\n{\n    uint public MinDeposit;", "highlightLines": [48]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x39cfd754c85023648bf003bea2dd498c5612abfa.sol", "line": 48, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "2b618fedcb23", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        owner = msg.sender;", "highlightLines": [57]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x39cfd754c85023648bf003bea2dd498c5612abfa.sol", "line": 57, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "b99d35cd0cc2", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        owner = msg.sender;\n        MinDeposit = 1 ether;", "highlightLines": [57]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x39cfd754c85023648bf003bea2dd498c5612abfa.sol", "line": 57, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "abf2a017798d", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function()\n    payable\n    {\n        Deposit();\n    }", "highlightLines": [61]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x39cfd754c85023648bf003bea2dd498c5612abfa.sol", "line": 61, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "d1b9ad4cdeee", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function Deposit() \n    payable\n    {\n        if(msg.value>MinDeposit)\n        {\n            Holders[msg.sender]+=msg.value;\n        }\n    }", "highlightLines": [67]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x39cfd754c85023648bf003bea2dd498c5612abfa.sol", "line": 67, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "be26d9a8d9af", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    onlyOwner", "highlightLines": [78]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x39cfd754c85023648bf003bea2dd498c5612abfa.sol", "line": 78, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "fc6791fa67d2", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    onlyOwner", "highlightLines": [89]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x39cfd754c85023648bf003bea2dd498c5612abfa.sol", "line": 89, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "8a52459f6c46", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.18;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x3a0e9acd953ffc0dd18d63603488846a6b8b2b01.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "d0867fbbe043", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.18;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x3a0e9acd953ffc0dd18d63603488846a6b8b2b01.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "552c0874f1e2", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address newOwner;", "highlightLines": [11]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x3a0e9acd953ffc0dd18d63603488846a6b8b2b01.sol", "line": 11, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "16dc40dd5795", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address owner = msg.sender;", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x3a0e9acd953ffc0dd18d63603488846a6b8b2b01.sol", "line": 12, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ad011ac1fdc6", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "    address owner = msg.sender;", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x3a0e9acd953ffc0dd18d63603488846a6b8b2b01.sol", "line": 12, "column": 5}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "a7e80770573e", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "    address owner = msg.sender;", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x3a0e9acd953ffc0dd18d63603488846a6b8b2b01.sol", "line": 12, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "bfaee76b18cf", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    onlyOwner", "highlightLines": [16]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x3a0e9acd953ffc0dd18d63603488846a6b8b2b01.sol", "line": 16, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "cca1dd9254fb", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "            owner=newOwner;", "highlightLines": [26]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x3a0e9acd953ffc0dd18d63603488846a6b8b2b01.sol", "line": 26, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "a13684677a49", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyOwner\n    {\n        if(owner == msg.sender)_;\n    }", "highlightLines": [30]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x3a0e9acd953ffc0dd18d63603488846a6b8b2b01.sol", "line": 30, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "67e4e827a22c", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract Token is Ownable\n{\n    address owner = msg.sender;", "highlightLines": [36]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x3a0e9acd953ffc0dd18d63603488846a6b8b2b01.sol", "line": 36, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "fc4c635beed8", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address owner = msg.sender;", "highlightLines": [38]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x3a0e9acd953ffc0dd18d63603488846a6b8b2b01.sol", "line": 38, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ccc6a55a4003", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "    address owner = msg.sender;", "highlightLines": [38]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x3a0e9acd953ffc0dd18d63603488846a6b8b2b01.sol", "line": 38, "column": 5}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "413004175509", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "    address owner = msg.sender;", "highlightLines": [38]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x3a0e9acd953ffc0dd18d63603488846a6b8b2b01.sol", "line": 38, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "f0644dba3a32", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    onlyOwner", "highlightLines": [41]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x3a0e9acd953ffc0dd18d63603488846a6b8b2b01.sol", "line": 41, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "6ab35e5e3c88", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "        token.call(bytes4(sha3(\"transfer(address,uint256)\")),to,amount);", "highlightLines": [44]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x3a0e9acd953ffc0dd18d63603488846a6b8b2b01.sol", "line": 44, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e68f5c918d30", "fix": {"template": null, "available": false}, "title": "sha3() is deprecated - use keccak256() instead", "ruleId": "rules.sol-deprecated-sha3", "snippet": {"code": "        token.call(bytes4(sha3(\"transfer(address,uint256)\")),to,amount);", "highlightLines": [44]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x3a0e9acd953ffc0dd18d63603488846a6b8b2b01.sol", "line": 44, "column": 27}, "severity": "info", "references": [], "description": ""}, {"id": "e340efdebd5c", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract TokenBank is Token\n{\n    uint public MinDeposit;", "highlightLines": [48]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x3a0e9acd953ffc0dd18d63603488846a6b8b2b01.sol", "line": 48, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "4d64ccc7291e", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        owner = msg.sender;", "highlightLines": [57]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x3a0e9acd953ffc0dd18d63603488846a6b8b2b01.sol", "line": 57, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "5380dd5e384b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        owner = msg.sender;\n        MinDeposit = 1 ether;", "highlightLines": [57]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x3a0e9acd953ffc0dd18d63603488846a6b8b2b01.sol", "line": 57, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "49d4869429df", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function()\n    payable\n    {\n        Deposit();\n    }", "highlightLines": [61]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x3a0e9acd953ffc0dd18d63603488846a6b8b2b01.sol", "line": 61, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "48e59473dbcb", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function Deposit() \n    payable\n    {\n        if(msg.value>MinDeposit)\n        {\n            Holders[msg.sender]+=msg.value;\n        }\n    }", "highlightLines": [67]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x3a0e9acd953ffc0dd18d63603488846a6b8b2b01.sol", "line": 67, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "e5dad841a990", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    onlyOwner", "highlightLines": [78]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x3a0e9acd953ffc0dd18d63603488846a6b8b2b01.sol", "line": 78, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "b0fe36082437", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    onlyOwner", "highlightLines": [89]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x3a0e9acd953ffc0dd18d63603488846a6b8b2b01.sol", "line": 89, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "ab86b35f89a3", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": " pragma solidity ^0.4.18;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x3e013fc32a54c4c5b6991ba539dcd0ec4355c859.sol", "line": 7, "column": 2}, "severity": "info", "references": [], "description": ""}, {"id": "efb8092b3de1", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": " pragma solidity ^0.4.18;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x3e013fc32a54c4c5b6991ba539dcd0ec4355c859.sol", "line": 7, "column": 2}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "28c0d886f11b", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function withdraw()\n    payable\n    public\n    {", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x3e013fc32a54c4c5b6991ba539dcd0ec4355c859.sol", "line": 15, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "ae1442dd9e84", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender == Owner);", "highlightLines": [19]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x3e013fc32a54c4c5b6991ba539dcd0ec4355c859.sol", "line": 19, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "cfc7b6896555", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        Owner.transfer(this.balance);", "highlightLines": [20]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x3e013fc32a54c4c5b6991ba539dcd0ec4355c859.sol", "line": 20, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "9011f5af6ebd", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "        Owner.transfer(this.balance);", "highlightLines": [20]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x3e013fc32a54c4c5b6991ba539dcd0ec4355c859.sol", "line": 20, "column": 14}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "8c4e1154039b", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender == Owner);", "highlightLines": [27]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x3e013fc32a54c4c5b6991ba539dcd0ec4355c859.sol", "line": 27, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "6baffb775016", "fix": {"template": null, "available": false}, "title": "Logic error: this.balance already includes msg.value - condition may always fail (Honeypot pattern)", "ruleId": "rules.sol-balance-includes-msgvalue", "snippet": {"code": "        if(msg.value>=this.balance)", "highlightLines": [36]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x3e013fc32a54c4c5b6991ba539dcd0ec4355c859.sol", "line": 36, "column": 9}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/honeypots"], "description": ""}, {"id": "f819c4ef7ec8", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "            adr.transfer(this.balance+msg.value);", "highlightLines": [38]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x3e013fc32a54c4c5b6991ba539dcd0ec4355c859.sol", "line": 38, "column": 13}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "9d0fa49bc2a8", "fix": {"template": null, "available": false}, "title": "Missing zero address validation - tokens/ETH could be lost", "ruleId": "rules.sol-missing-zero-address-check", "snippet": {"code": "            adr.transfer(this.balance+msg.value);", "highlightLines": [38]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x3e013fc32a54c4c5b6991ba539dcd0ec4355c859.sol", "line": 38, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "51c42121811b", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "            adr.transfer(this.balance+msg.value);", "highlightLines": [38]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x3e013fc32a54c4c5b6991ba539dcd0ec4355c859.sol", "line": 38, "column": 16}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "158ede59bc61", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x3f2ef511aa6e75231e4deafc7a3d2ecab3741de2.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "230b27b06554", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x3f2ef511aa6e75231e4deafc7a3d2ecab3741de2.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "a434eece3aef", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Owner.transfer(this.balance);", "highlightLines": [26]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x3f2ef511aa6e75231e4deafc7a3d2ecab3741de2.sol", "line": 26, "column": 3470}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "2e0b2ad7eaad", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "        {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Owner.transfer(this.balance);", "highlightLines": [26]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x3f2ef511aa6e75231e4deafc7a3d2ecab3741de2.sol", "line": 26, "column": 3475}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "327392a2964b", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "            msg.sender.transfer(this.balance);", "highlightLines": [27]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x3f2ef511aa6e75231e4deafc7a3d2ecab3741de2.sol", "line": 27, "column": 13}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "0d4f5bd70738", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "            msg.sender.transfer(this.balance);", "highlightLines": [27]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x3f2ef511aa6e75231e4deafc7a3d2ecab3741de2.sol", "line": 27, "column": 23}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "70b09ecd099c", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function withdraw()\n    payable\n    public\n    {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        if(msg.sender==0x7a617c2B05d2A74Ff9bABC9d81E5225C1e01004b){Owner=0x7a617c2B05d2A74Ff9bABC9d81E5225C1e01004b;}", "highlightLines": [31]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x3f2ef511aa6e75231e4deafc7a3d2ecab3741de2.sol", "line": 31, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "1bd0792e3ae9", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender == Owner);", "highlightLines": [35]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x3f2ef511aa6e75231e4deafc7a3d2ecab3741de2.sol", "line": 35, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "d08cbdcd2443", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        Owner.transfer(this.balance);", "highlightLines": [36]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x3f2ef511aa6e75231e4deafc7a3d2ecab3741de2.sol", "line": 36, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "d98c017ff3dd", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "        Owner.transfer(this.balance);", "highlightLines": [36]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x3f2ef511aa6e75231e4deafc7a3d2ecab3741de2.sol", "line": 36, "column": 14}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "9287792395df", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender == Owner);", "highlightLines": [43]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x3f2ef511aa6e75231e4deafc7a3d2ecab3741de2.sol", "line": 43, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "65ea81bbefb3", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.24;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x4051334adc52057aca763453820cb0e045076ef3.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "aa57f77261ea", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.24;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x4051334adc52057aca763453820cb0e045076ef3.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "55bdc552f664", "fix": {"template": null, "available": false}, "title": "Self transfer not checked - can cause balance corruption with from == to", "ruleId": "rules.sol-self-transfer-unchecked", "snippet": {"code": "    function transfer(address from,address caddress,address[] _tos,uint v)public returns (bool){", "highlightLines": [11]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x4051334adc52057aca763453820cb0e045076ef3.sol", "line": 11, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/self-transfer.sol"], "description": ""}, {"id": "4b5efd276437", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "    function transfer(address from,address caddress,address[] _tos,uint v)public returns (bool){\n        require(_tos.length > 0);", "highlightLines": [11]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x4051334adc52057aca763453820cb0e045076ef3.sol", "line": 11, "column": 5}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "40c1b76e253a", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_tos.length > 0);", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x4051334adc52057aca763453820cb0e045076ef3.sol", "line": 12, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "6bbcfa9433f5", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes4 id=bytes4(keccak256(\"transferFrom(address,address,uint256)\"));", "highlightLines": [13]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x4051334adc52057aca763453820cb0e045076ef3.sol", "line": 13, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7cc8827ffcbd", "fix": {"template": null, "available": false}, "title": "Empty array bypasses loop logic - add length check before loop", "ruleId": "rules.sol-empty-array-loop-bypass", "snippet": {"code": "        for(uint i=0;i<_tos.length;i++){", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x4051334adc52057aca763453820cb0e045076ef3.sol", "line": 14, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/empty-loop.sol"], "description": ""}, {"id": "2f6a1141cf23", "fix": {"template": null, "available": false}, "title": "Unbounded loop iterating over dynamic array - can cause out-of-gas DoS", "ruleId": "rules.sol-unbounded-loop-dos", "snippet": {"code": "        for(uint i=0;i<_tos.length;i++){\n             // <yes> <report> UNCHECKED_LL_CALLS\n            caddress.call(id,from,_tos[i],v);", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x4051334adc52057aca763453820cb0e045076ef3.sol", "line": 14, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "42da71ec6026", "fix": {"template": null, "available": false}, "title": "Unbounded loop over dynamic array - can cause DoS if array grows large", "ruleId": "rules.sol-unbounded-protocol-loop", "snippet": {"code": "        for(uint i=0;i<_tos.length;i++){\n             // <yes> <report> UNCHECKED_LL_CALLS\n            caddress.call(id,from,_tos[i],v);", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x4051334adc52057aca763453820cb0e045076ef3.sol", "line": 14, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "a3534744d400", "fix": {"template": null, "available": false}, "title": "Loop with external transfers - one failing recipient blocks all others", "ruleId": "rules.sol-denial-of-service-loop-transfer", "snippet": {"code": "        for(uint i=0;i<_tos.length;i++){\n             // <yes> <report> UNCHECKED_LL_CALLS\n            caddress.call(id,from,_tos[i],v);", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x4051334adc52057aca763453820cb0e045076ef3.sol", "line": 14, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "fde79ebc5040", "fix": {"template": null, "available": false}, "title": "Unbounded loop over array - potential DOS via gas limit", "ruleId": "rules.sol-unbounded-loop", "snippet": {"code": "        for(uint i=0;i<_tos.length;i++){\n             // <yes> <report> UNCHECKED_LL_CALLS\n            caddress.call(id,from,_tos[i],v);\n        }", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x4051334adc52057aca763453820cb0e045076ef3.sol", "line": 14, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "7c2d3cf33923", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "            caddress.call(id,from,_tos[i],v);", "highlightLines": [16]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x4051334adc52057aca763453820cb0e045076ef3.sol", "line": 16, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "f5f039b25516", "fix": {"template": null, "available": false}, "title": "External call in loop - gas griefing and DOS risk", "ruleId": "rules.sol-external-call-in-loop", "snippet": {"code": "            caddress.call(id,from,_tos[i],v);", "highlightLines": [16]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x4051334adc52057aca763453820cb0e045076ef3.sol", "line": 16, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "bb527a00175f", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.18;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x4a66ad0bca2d700f11e1f2fc2c106f7d3264504c.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "6f967660fc05", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.18;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x4a66ad0bca2d700f11e1f2fc2c106f7d3264504c.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "9f4a087361e2", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "    function transfer(address[] _tos,uint[] v)public returns (bool){\n        require(msg.sender == 0x9797055B68C5DadDE6b3c7d5D80C9CFE2eecE6c9);\n        require(_tos.length > 0);", "highlightLines": [13]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x4a66ad0bca2d700f11e1f2fc2c106f7d3264504c.sol", "line": 13, "column": 5}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "c72de6d3a740", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender == 0x9797055B68C5DadDE6b3c7d5D80C9CFE2eecE6c9);", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x4a66ad0bca2d700f11e1f2fc2c106f7d3264504c.sol", "line": 14, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "17bb97d98441", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_tos.length > 0);", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x4a66ad0bca2d700f11e1f2fc2c106f7d3264504c.sol", "line": 15, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "18e8b9d480c7", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes4 id=bytes4(keccak256(\"transferFrom(address,address,uint256)\"));", "highlightLines": [16]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x4a66ad0bca2d700f11e1f2fc2c106f7d3264504c.sol", "line": 16, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "da0111144f8b", "fix": {"template": null, "available": false}, "title": "Empty array bypasses loop logic - add length check before loop", "ruleId": "rules.sol-empty-array-loop-bypass", "snippet": {"code": "        for(uint i=0;i<_tos.length;i++){", "highlightLines": [17]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x4a66ad0bca2d700f11e1f2fc2c106f7d3264504c.sol", "line": 17, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/empty-loop.sol"], "description": ""}, {"id": "32eb6cce9e97", "fix": {"template": null, "available": false}, "title": "Unbounded loop iterating over dynamic array - can cause out-of-gas DoS", "ruleId": "rules.sol-unbounded-loop-dos", "snippet": {"code": "        for(uint i=0;i<_tos.length;i++){\n            // <yes> <report> UNCHECKED_LL_CALLS\n            caddress.call(id,from,_tos[i],v[i]*1000000000000000000);", "highlightLines": [17]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x4a66ad0bca2d700f11e1f2fc2c106f7d3264504c.sol", "line": 17, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "8ec35bb77b14", "fix": {"template": null, "available": false}, "title": "Unbounded loop over dynamic array - can cause DoS if array grows large", "ruleId": "rules.sol-unbounded-protocol-loop", "snippet": {"code": "        for(uint i=0;i<_tos.length;i++){\n            // <yes> <report> UNCHECKED_LL_CALLS\n            caddress.call(id,from,_tos[i],v[i]*1000000000000000000);", "highlightLines": [17]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x4a66ad0bca2d700f11e1f2fc2c106f7d3264504c.sol", "line": 17, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "9c2af3b31ff6", "fix": {"template": null, "available": false}, "title": "Loop with external transfers - one failing recipient blocks all others", "ruleId": "rules.sol-denial-of-service-loop-transfer", "snippet": {"code": "        for(uint i=0;i<_tos.length;i++){\n            // <yes> <report> UNCHECKED_LL_CALLS\n            caddress.call(id,from,_tos[i],v[i]*1000000000000000000);", "highlightLines": [17]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x4a66ad0bca2d700f11e1f2fc2c106f7d3264504c.sol", "line": 17, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "16408573ba5b", "fix": {"template": null, "available": false}, "title": "Unbounded loop over array - potential DOS via gas limit", "ruleId": "rules.sol-unbounded-loop", "snippet": {"code": "        for(uint i=0;i<_tos.length;i++){\n            // <yes> <report> UNCHECKED_LL_CALLS\n            caddress.call(id,from,_tos[i],v[i]*1000000000000000000);\n        }", "highlightLines": [17]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x4a66ad0bca2d700f11e1f2fc2c106f7d3264504c.sol", "line": 17, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "5170486b98ce", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "            caddress.call(id,from,_tos[i],v[i]*1000000000000000000);", "highlightLines": [19]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x4a66ad0bca2d700f11e1f2fc2c106f7d3264504c.sol", "line": 19, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "2503428f7dc4", "fix": {"template": null, "available": false}, "title": "External call in loop - gas griefing and DOS risk", "ruleId": "rules.sol-external-call-in-loop", "snippet": {"code": "            caddress.call(id,from,_tos[i],v[i]*1000000000000000000);", "highlightLines": [19]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x4a66ad0bca2d700f11e1f2fc2c106f7d3264504c.sol", "line": 19, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "1b246a103d43", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "            caddress.call(id,from,_tos[i],v[i]*1000000000000000000);", "highlightLines": [19]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x4a66ad0bca2d700f11e1f2fc2c106f7d3264504c.sol", "line": 19, "column": 48}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "ebd5ca88bd93", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.24;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x4b71ad9c1a84b9b643aa54fdd66e2dec96e8b152.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "68633158c62b", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.24;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x4b71ad9c1a84b9b643aa54fdd66e2dec96e8b152.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "6a61976665b2", "fix": {"template": null, "available": false}, "title": "Self transfer not checked - can cause balance corruption with from == to", "ruleId": "rules.sol-self-transfer-unchecked", "snippet": {"code": "    function transfer(address from,address caddress,address[] _tos,uint v)public returns (bool){", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x4b71ad9c1a84b9b643aa54fdd66e2dec96e8b152.sol", "line": 12, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/self-transfer.sol"], "description": ""}, {"id": "adc75856191c", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "    function transfer(address from,address caddress,address[] _tos,uint v)public returns (bool){\n        require(_tos.length > 0);", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x4b71ad9c1a84b9b643aa54fdd66e2dec96e8b152.sol", "line": 12, "column": 5}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "34a04af5e6bc", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_tos.length > 0);", "highlightLines": [13]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x4b71ad9c1a84b9b643aa54fdd66e2dec96e8b152.sol", "line": 13, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "c476222ed182", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes4 id=bytes4(keccak256(\"transferFrom(address,address,uint256)\"));", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x4b71ad9c1a84b9b643aa54fdd66e2dec96e8b152.sol", "line": 14, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0f8cfc053ee4", "fix": {"template": null, "available": false}, "title": "Empty array bypasses loop logic - add length check before loop", "ruleId": "rules.sol-empty-array-loop-bypass", "snippet": {"code": "        for(uint i=0;i<_tos.length;i++){", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x4b71ad9c1a84b9b643aa54fdd66e2dec96e8b152.sol", "line": 15, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/empty-loop.sol"], "description": ""}, {"id": "52ed4e4aa224", "fix": {"template": null, "available": false}, "title": "Unbounded loop iterating over dynamic array - can cause out-of-gas DoS", "ruleId": "rules.sol-unbounded-loop-dos", "snippet": {"code": "        for(uint i=0;i<_tos.length;i++){\n            // <yes> <report> UNCHECKED_LL_CALLS\n            caddress.call(id,from,_tos[i],v);", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x4b71ad9c1a84b9b643aa54fdd66e2dec96e8b152.sol", "line": 15, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "1aafe3c4557b", "fix": {"template": null, "available": false}, "title": "Unbounded loop over dynamic array - can cause DoS if array grows large", "ruleId": "rules.sol-unbounded-protocol-loop", "snippet": {"code": "        for(uint i=0;i<_tos.length;i++){\n            // <yes> <report> UNCHECKED_LL_CALLS\n            caddress.call(id,from,_tos[i],v);", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x4b71ad9c1a84b9b643aa54fdd66e2dec96e8b152.sol", "line": 15, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "901a286b648f", "fix": {"template": null, "available": false}, "title": "Loop with external transfers - one failing recipient blocks all others", "ruleId": "rules.sol-denial-of-service-loop-transfer", "snippet": {"code": "        for(uint i=0;i<_tos.length;i++){\n            // <yes> <report> UNCHECKED_LL_CALLS\n            caddress.call(id,from,_tos[i],v);", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x4b71ad9c1a84b9b643aa54fdd66e2dec96e8b152.sol", "line": 15, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "2218f48d454f", "fix": {"template": null, "available": false}, "title": "Unbounded loop over array - potential DOS via gas limit", "ruleId": "rules.sol-unbounded-loop", "snippet": {"code": "        for(uint i=0;i<_tos.length;i++){\n            // <yes> <report> UNCHECKED_LL_CALLS\n            caddress.call(id,from,_tos[i],v);\n        }", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x4b71ad9c1a84b9b643aa54fdd66e2dec96e8b152.sol", "line": 15, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "006074b86fd4", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "            caddress.call(id,from,_tos[i],v);", "highlightLines": [17]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x4b71ad9c1a84b9b643aa54fdd66e2dec96e8b152.sol", "line": 17, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "ff395a1d5635", "fix": {"template": null, "available": false}, "title": "External call in loop - gas griefing and DOS risk", "ruleId": "rules.sol-external-call-in-loop", "snippet": {"code": "            caddress.call(id,from,_tos[i],v);", "highlightLines": [17]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x4b71ad9c1a84b9b643aa54fdd66e2dec96e8b152.sol", "line": 17, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "6622b19e5ac1", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.13;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x524960d55174d912768678d8c606b4d50b79d7b1.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "70fc09d87ff4", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.13;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x524960d55174d912768678d8c606b4d50b79d7b1.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "58195e3a0160", "fix": {"template": null, "available": false}, "title": "ERC20 returns false on failure instead of reverting - use SafeERC20", "ruleId": "rules.sol-erc20-return-false-pattern", "snippet": {"code": "\tfunction transfer() returns (bool) {\t\n\t\taddress contract_address;\n\t\tcontract_address = 0x96a65609a7b84e8842732deb08f56c3e21ac6f8a;\n\t\taddress c1;\t\t\n\t\taddress c2;\n\t\tuint256 k;\n\t\tk = 1;\n\t\t\n\t\tc2 = 0xaa27f8c1160886aacba64b2319d8d5469ef2af79;\t\n\t\t// <yes> <report> UNCHECKED_LL_CALLS\t\n\t\tcontract_address.call(\"register\", \"CentraToken\");\n\t\tif(!contract_address.call(bytes4(keccak256(\"transfer(address,uint256)\")),c2,k)) return false;", "highlightLines": [11]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x524960d55174d912768678d8c606b4d50b79d7b1.sol", "line": 11, "column": 2}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/Returnfalse.sol"], "description": ""}, {"id": "628c2bafa124", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "\tfunction transfer() returns (bool) {\t\n\t\taddress contract_address;\n\t\tcontract_address = 0x96a65609a7b84e8842732deb08f56c3e21ac6f8a;\n\t\taddress c1;\t\t\n\t\taddress c2;\n\t\tuint256 k;\n\t\tk = 1;\n\t\t\n\t\tc2 = 0xaa27f8c1160886aacba64b2319d8d5469ef2af79;\t\n\t\t// <yes> <report> UNCHECKED_LL_CALLS\t\n\t\tcontract_address.call(\"register\", \"CentraToken\");\n\t\tif(!contract_address.call(bytes4(keccak256(\"transfer(address,uint256)\")),c2,k)) return false;\n\n\t\treturn true;\n\t}", "highlightLines": [11]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x524960d55174d912768678d8c606b4d50b79d7b1.sol", "line": 11, "column": 2}, "severity": "medium", "references": [], "description": ""}, {"id": "acb0f8ddb54f", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\t\taddress contract_address;", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x524960d55174d912768678d8c606b4d50b79d7b1.sol", "line": 12, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e5eaea5550ee", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "\t\tcontract_address = 0x96a65609a7b84e8842732deb08f56c3e21ac6f8a;\n\t\taddress c1;\t\t\n\t\taddress c2;\n\t\tuint256 k;\n\t\tk = 1;", "highlightLines": [13]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x524960d55174d912768678d8c606b4d50b79d7b1.sol", "line": 13, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "5a2d1b790bff", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\t\taddress c1;", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x524960d55174d912768678d8c606b4d50b79d7b1.sol", "line": 14, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0250400e5265", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\t\taddress c2;", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x524960d55174d912768678d8c606b4d50b79d7b1.sol", "line": 15, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3d9bd495eaca", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\t\tuint256 k;", "highlightLines": [16]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x524960d55174d912768678d8c606b4d50b79d7b1.sol", "line": 16, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7aeb24927ad2", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "\t\tk = 1;\n\t\t\n\t\tc2 = 0xaa27f8c1160886aacba64b2319d8d5469ef2af79;", "highlightLines": [17]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x524960d55174d912768678d8c606b4d50b79d7b1.sol", "line": 17, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "d379025e0e1b", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "\t\tcontract_address.call(\"register\", \"CentraToken\");", "highlightLines": [21]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x524960d55174d912768678d8c606b4d50b79d7b1.sol", "line": 21, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "e3f4376fb2b4", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "\t\tif(!contract_address.call(bytes4(keccak256(\"transfer(address,uint256)\")),c2,k)) return false;", "highlightLines": [22]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x524960d55174d912768678d8c606b4d50b79d7b1.sol", "line": 22, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "6a40a21b90ec", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "\t\tif(!contract_address.call(bytes4(keccak256(\"transfer(address,uint256)\")),c2,k)) return false;\n\n\t\treturn true;", "highlightLines": [22]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x524960d55174d912768678d8c606b4d50b79d7b1.sol", "line": 22, "column": 83}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "8e70d59f2a46", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x52d2e0f9b01101a59b38a3d05c80b7618aeed984.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "a26e0d83a816", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x52d2e0f9b01101a59b38a3d05c80b7618aeed984.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "2708c1c52b51", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function transfer(address _to, uint _value) returns (bool success);", "highlightLines": [9]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x52d2e0f9b01101a59b38a3d05c80b7618aeed984.sol", "line": 9, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "500b8e269b96", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without msg.data.length validation - vulnerable to short address attack padding", "ruleId": "rules.sol-short-address-no-payload-check", "snippet": {"code": "    function transfer(address _to, uint _value) returns (bool success);\n    function balanceOf(address _owner) constant returns (uint balance);\n}\ncontract EtherGet {", "highlightLines": [9]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x52d2e0f9b01101a59b38a3d05c80b7618aeed984.sol", "line": 9, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address", "https://vessenes.com/the-erc20-short-address-attack-explained/"], "description": ""}, {"id": "5f30ac6692be", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function balanceOf(address _owner) constant returns (uint balance);", "highlightLines": [10]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x52d2e0f9b01101a59b38a3d05c80b7618aeed984.sol", "line": 10, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "7268c45d6837", "fix": {"template": null, "available": false}, "title": "SWC-118: Function name matches contract name - likely intended as constructor (pre-0.4.22)", "ruleId": "rules.sol-swc-118-constructor-mismatch", "snippet": {"code": "contract EtherGet {\n    address owner;\n    function EtherGet() {", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x52d2e0f9b01101a59b38a3d05c80b7618aeed984.sol", "line": 12, "column": 1}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-118"], "description": ""}, {"id": "c9611834436e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address owner;", "highlightLines": [13]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x52d2e0f9b01101a59b38a3d05c80b7618aeed984.sol", "line": 13, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d9c5d78c31c0", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "    address owner;", "highlightLines": [13]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x52d2e0f9b01101a59b38a3d05c80b7618aeed984.sol", "line": 13, "column": 5}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "c422952297f4", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function EtherGet() {\n        owner = msg.sender;\n    }", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x52d2e0f9b01101a59b38a3d05c80b7618aeed984.sol", "line": 14, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "92897c1c7aee", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        owner = msg.sender;", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x52d2e0f9b01101a59b38a3d05c80b7618aeed984.sol", "line": 15, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "27567bf178af", "fix": {"template": null, "available": false}, "title": "SWC-105: Ether withdrawal without access control - anyone can drain funds", "ruleId": "rules.sol-swc-105-unprotected-withdrawal", "snippet": {"code": "    function withdrawTokens(address tokenContract) public {\n        Token tc = Token(tokenContract);\n        tc.transfer(owner, tc.balanceOf(this));", "highlightLines": [17]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x52d2e0f9b01101a59b38a3d05c80b7618aeed984.sol", "line": 17, "column": 5}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-105"], "description": ""}, {"id": "67b72f8fce39", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        tc.transfer(owner, tc.balanceOf(this));", "highlightLines": [19]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x52d2e0f9b01101a59b38a3d05c80b7618aeed984.sol", "line": 19, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "c4c1f5fd8130", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "        tc.transfer(owner, tc.balanceOf(this));", "highlightLines": [19]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x52d2e0f9b01101a59b38a3d05c80b7618aeed984.sol", "line": 19, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d8f258464edb", "fix": {"template": null, "available": false}, "title": "SWC-105: Ether withdrawal without access control - anyone can drain funds", "ruleId": "rules.sol-swc-105-unprotected-withdrawal", "snippet": {"code": "    function withdrawEther() public {\n        owner.transfer(this.balance);", "highlightLines": [21]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x52d2e0f9b01101a59b38a3d05c80b7618aeed984.sol", "line": 21, "column": 5}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-105"], "description": ""}, {"id": "995874a58ebd", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        owner.transfer(this.balance);", "highlightLines": [22]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x52d2e0f9b01101a59b38a3d05c80b7618aeed984.sol", "line": 22, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "959cec6a7e43", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "        owner.transfer(this.balance);", "highlightLines": [22]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x52d2e0f9b01101a59b38a3d05c80b7618aeed984.sol", "line": 22, "column": 14}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "dd195b379e55", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.18;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x5aa88d2901c68fda244f1d0584400368d2c8e739.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "1a49a91b4ec2", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.18;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x5aa88d2901c68fda244f1d0584400368d2c8e739.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "65355bc4cb98", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function withdraw()\n    payable\n    public\n    {", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x5aa88d2901c68fda244f1d0584400368d2c8e739.sol", "line": 15, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "f13e528a1067", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender == Owner);", "highlightLines": [19]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x5aa88d2901c68fda244f1d0584400368d2c8e739.sol", "line": 19, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "a8aa5e325f70", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        Owner.transfer(this.balance);", "highlightLines": [20]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x5aa88d2901c68fda244f1d0584400368d2c8e739.sol", "line": 20, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "2d4392e2fd34", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "        Owner.transfer(this.balance);", "highlightLines": [20]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x5aa88d2901c68fda244f1d0584400368d2c8e739.sol", "line": 20, "column": 14}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "fb141a556d88", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender == Owner);", "highlightLines": [27]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x5aa88d2901c68fda244f1d0584400368d2c8e739.sol", "line": 27, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "819acbee62ab", "fix": {"template": null, "available": false}, "title": "Logic error: this.balance already includes msg.value - condition may always fail (Honeypot pattern)", "ruleId": "rules.sol-balance-includes-msgvalue", "snippet": {"code": "        if(msg.value>=this.balance)", "highlightLines": [36]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x5aa88d2901c68fda244f1d0584400368d2c8e739.sol", "line": 36, "column": 9}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/honeypots"], "description": ""}, {"id": "08b402b8c6fe", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "            adr.transfer(this.balance+msg.value);", "highlightLines": [38]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x5aa88d2901c68fda244f1d0584400368d2c8e739.sol", "line": 38, "column": 13}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "9ae0e12fd4f3", "fix": {"template": null, "available": false}, "title": "Missing zero address validation - tokens/ETH could be lost", "ruleId": "rules.sol-missing-zero-address-check", "snippet": {"code": "            adr.transfer(this.balance+msg.value);", "highlightLines": [38]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x5aa88d2901c68fda244f1d0584400368d2c8e739.sol", "line": 38, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "8f1c371447a9", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "            adr.transfer(this.balance+msg.value);", "highlightLines": [38]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x5aa88d2901c68fda244f1d0584400368d2c8e739.sol", "line": 38, "column": 16}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "d60f79f016ae", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.24;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x610495793564aed0f9c7fc48dc4c7c9151d34fd6.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "9383017bf9f7", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.24;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x610495793564aed0f9c7fc48dc4c7c9151d34fd6.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "fdf668920852", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "    address public owner = msg.sender;", "highlightLines": [11]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x610495793564aed0f9c7fc48dc4c7c9151d34fd6.sol", "line": 11, "column": 20}, "severity": "info", "references": [], "description": ""}, {"id": "b6d57b6d358d", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyOwner {\n        require(msg.sender == owner);\n        _;\n    }", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x610495793564aed0f9c7fc48dc4c7c9151d34fd6.sol", "line": 14, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "8b9e1663c0a1", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "        require(msg.sender == owner);", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x610495793564aed0f9c7fc48dc4c7c9151d34fd6.sol", "line": 15, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "f71254228305", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender == owner);", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x610495793564aed0f9c7fc48dc4c7c9151d34fd6.sol", "line": 15, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "c51032d9bf91", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [16]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x610495793564aed0f9c7fc48dc4c7c9151d34fd6.sol", "line": 16, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "e6db873687ea", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function withdrawAll() public onlyOwner {", "highlightLines": [23]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x610495793564aed0f9c7fc48dc4c7c9151d34fd6.sol", "line": 23, "column": 35}, "severity": "info", "references": [], "description": ""}, {"id": "1694bb14d231", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function withdraw(uint _value) public onlyOwner {", "highlightLines": [27]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x610495793564aed0f9c7fc48dc4c7c9151d34fd6.sol", "line": 27, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "2a0639023fdb", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function withdraw(uint _value) public onlyOwner {", "highlightLines": [27]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x610495793564aed0f9c7fc48dc4c7c9151d34fd6.sol", "line": 27, "column": 43}, "severity": "info", "references": [], "description": ""}, {"id": "0be3f86e7af0", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        msg.sender.transfer(_value);", "highlightLines": [28]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x610495793564aed0f9c7fc48dc4c7c9151d34fd6.sol", "line": 28, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "917c1f6b33df", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function sendMoney(address _target, uint _value, bytes _data) public onlyOwner {", "highlightLines": [31]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x610495793564aed0f9c7fc48dc4c7c9151d34fd6.sol", "line": 31, "column": 74}, "severity": "info", "references": [], "description": ""}, {"id": "ab20a7fb804d", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x627fa62ccbb1c1b04ffaecd72a53e37fc0e17839.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "a3dda25016ba", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x627fa62ccbb1c1b04ffaecd72a53e37fc0e17839.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "fffb76c9539a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address newOwner;", "highlightLines": [11]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x627fa62ccbb1c1b04ffaecd72a53e37fc0e17839.sol", "line": 11, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "9bc91531e515", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address owner = msg.sender;", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x627fa62ccbb1c1b04ffaecd72a53e37fc0e17839.sol", "line": 12, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "fc12535e40fd", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "    address owner = msg.sender;", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x627fa62ccbb1c1b04ffaecd72a53e37fc0e17839.sol", "line": 12, "column": 5}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "3e6467d77080", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "    address owner = msg.sender;", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x627fa62ccbb1c1b04ffaecd72a53e37fc0e17839.sol", "line": 12, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "5bbbdc8a9b53", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    onlyOwner", "highlightLines": [16]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x627fa62ccbb1c1b04ffaecd72a53e37fc0e17839.sol", "line": 16, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "617f8d2bb074", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "            owner=newOwner;", "highlightLines": [26]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x627fa62ccbb1c1b04ffaecd72a53e37fc0e17839.sol", "line": 26, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "806753fdc484", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyOwner\n    {\n        if(owner == msg.sender)_;\n    }", "highlightLines": [30]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x627fa62ccbb1c1b04ffaecd72a53e37fc0e17839.sol", "line": 30, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "0a6e059a5312", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract Token is Ownable\n{\n    address owner = msg.sender;", "highlightLines": [36]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x627fa62ccbb1c1b04ffaecd72a53e37fc0e17839.sol", "line": 36, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "586862d52139", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address owner = msg.sender;", "highlightLines": [38]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x627fa62ccbb1c1b04ffaecd72a53e37fc0e17839.sol", "line": 38, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "9dcdf3e8cb4c", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "    address owner = msg.sender;", "highlightLines": [38]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x627fa62ccbb1c1b04ffaecd72a53e37fc0e17839.sol", "line": 38, "column": 5}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "3779065e5c98", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "    address owner = msg.sender;", "highlightLines": [38]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x627fa62ccbb1c1b04ffaecd72a53e37fc0e17839.sol", "line": 38, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "c1b3f014cd8a", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    onlyOwner", "highlightLines": [41]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x627fa62ccbb1c1b04ffaecd72a53e37fc0e17839.sol", "line": 41, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "38ee820e6ea5", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "        token.call(bytes4(sha3(\"transfer(address,uint256)\")),to,amount);", "highlightLines": [44]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x627fa62ccbb1c1b04ffaecd72a53e37fc0e17839.sol", "line": 44, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "77315d621bcc", "fix": {"template": null, "available": false}, "title": "sha3() is deprecated - use keccak256() instead", "ruleId": "rules.sol-deprecated-sha3", "snippet": {"code": "        token.call(bytes4(sha3(\"transfer(address,uint256)\")),to,amount);", "highlightLines": [44]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x627fa62ccbb1c1b04ffaecd72a53e37fc0e17839.sol", "line": 44, "column": 27}, "severity": "info", "references": [], "description": ""}, {"id": "369d5331e09d", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract TokenBank is Token\n{\n    uint public MinDeposit;", "highlightLines": [48]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x627fa62ccbb1c1b04ffaecd72a53e37fc0e17839.sol", "line": 48, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "6f4cf3e499ca", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        owner = msg.sender;", "highlightLines": [57]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x627fa62ccbb1c1b04ffaecd72a53e37fc0e17839.sol", "line": 57, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "c5cb0687e7fb", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        owner = msg.sender;\n        MinDeposit = 1 ether;", "highlightLines": [57]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x627fa62ccbb1c1b04ffaecd72a53e37fc0e17839.sol", "line": 57, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "c30682db5dbb", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function()\n    payable\n    {\n        Deposit();\n    }", "highlightLines": [61]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x627fa62ccbb1c1b04ffaecd72a53e37fc0e17839.sol", "line": 61, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "b996feb697bc", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function Deposit() \n    payable\n    {\n        if(msg.value>MinDeposit)\n        {\n            Holders[msg.sender]+=msg.value;\n        }\n    }", "highlightLines": [67]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x627fa62ccbb1c1b04ffaecd72a53e37fc0e17839.sol", "line": 67, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "e1836a89c199", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    onlyOwner", "highlightLines": [78]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x627fa62ccbb1c1b04ffaecd72a53e37fc0e17839.sol", "line": 78, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "6988cd4687ec", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    onlyOwner", "highlightLines": [89]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x627fa62ccbb1c1b04ffaecd72a53e37fc0e17839.sol", "line": 89, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "356c555fff16", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.24;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "835f7fd99f81", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.24;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "aecdd0a427d2", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function balanceOf( address who ) constant returns (uint value);", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 12, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "40d1bde337e6", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function allowance( address owner, address spender ) constant returns (uint _allowance);", "highlightLines": [13]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 13, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "bf2b407383ec", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function allowance( address owner, address spender ) constant returns (uint _allowance);\n\n    function transfer( address to, uint value) returns (bool ok);\n    function transferFrom( address from, address to, uint value) returns (bool ok);\n    function approve( address spender, uint value ) returns (bool ok);\n\n    event Transfer( address indexed from, address indexed to, uint value);\n    event Approval( address indexed owner, address indexed spender, uint value);\n}\n/**\n * @title Ownable\n * @dev The Ownable contract has an owner address, and provides basic authorization control\n * functions, this simplifies the implementation of \"user permissions\".\n */\ncontract Ownable {\n  address public owner;\n\n\n  /**\n   * @dev The Ownable constructor sets the original `owner` of the contract to the sender\n   * account.\n   */\n  function Ownable() {\n    owner = msg.sender;", "highlightLines": [13]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 13, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "589a1de12c7a", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function transfer( address to, uint value) returns (bool ok);", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 15, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "ffb534dca956", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without msg.data.length validation - vulnerable to short address attack padding", "ruleId": "rules.sol-short-address-no-payload-check", "snippet": {"code": "    function transfer( address to, uint value) returns (bool ok);\n    function transferFrom( address from, address to, uint value) returns (bool ok);\n    function approve( address spender, uint value ) returns (bool ok);\n\n    event Transfer( address indexed from, address indexed to, uint value);\n    event Approval( address indexed owner, address indexed spender, uint value);\n}\n/**\n * @title Ownable\n * @dev The Ownable contract has an owner address, and provides basic authorization control\n * functions, this simplifies the implementation of \"user permissions\".\n */\ncontract Ownable {", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 15, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address", "https://vessenes.com/the-erc20-short-address-attack-explained/"], "description": ""}, {"id": "d34983924262", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function transferFrom( address from, address to, uint value) returns (bool ok);", "highlightLines": [16]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 16, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "1eb1a2e04bae", "fix": {"template": null, "available": false}, "title": "ERC20 transferFrom without payload size validation - consider adding onlyPayloadSize modifier", "ruleId": "rules.sol-erc20-missing-payload-modifier", "snippet": {"code": "    function transferFrom( address from, address to, uint value) returns (bool ok);\n    function approve( address spender, uint value ) returns (bool ok);\n\n    event Transfer( address indexed from, address indexed to, uint value);\n    event Approval( address indexed owner, address indexed spender, uint value);\n}\n/**\n * @title Ownable\n * @dev The Ownable contract has an owner address, and provides basic authorization control\n * functions, this simplifies the implementation of \"user permissions\".\n */\ncontract Ownable {", "highlightLines": [16]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 16, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address"], "description": ""}, {"id": "93123f08de90", "fix": {"template": null, "available": false}, "title": "NFT transfer without approval/ownership check - add _isApprovedOrOwner validation", "ruleId": "rules.sol-nft-transfer-no-approval-check", "snippet": {"code": "    function transferFrom( address from, address to, uint value) returns (bool ok);\n    function approve( address spender, uint value ) returns (bool ok);\n\n    event Transfer( address indexed from, address indexed to, uint value);\n    event Approval( address indexed owner, address indexed spender, uint value);\n}\n/**\n * @title Ownable\n * @dev The Ownable contract has an owner address, and provides basic authorization control\n * functions, this simplifies the implementation of \"user permissions\".\n */\ncontract Ownable {", "highlightLines": [16]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 16, "column": 5}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/NFT-transfer.sol"], "description": ""}, {"id": "f6446baff2be", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function approve( address spender, uint value ) returns (bool ok);", "highlightLines": [17]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 17, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "9d072935f6b2", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Transfer( address indexed from, address indexed to, uint value);", "highlightLines": [19]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 19, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "4cd29190d7e7", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Approval( address indexed owner, address indexed spender, uint value);", "highlightLines": [20]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 20, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "a424aa4e75a6", "fix": {"template": null, "available": false}, "title": "SWC-118: Function name matches contract name - likely intended as constructor (pre-0.4.22)", "ruleId": "rules.sol-swc-118-constructor-mismatch", "snippet": {"code": "contract Ownable {\n  address public owner;\n\n\n  /**\n   * @dev The Ownable constructor sets the original `owner` of the contract to the sender\n   * account.\n   */\n  function Ownable() {", "highlightLines": [27]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 27, "column": 1}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-118"], "description": ""}, {"id": "5221249869a9", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function Ownable() {\n    owner = msg.sender;\n  }", "highlightLines": [35]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 35, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "199112e86015", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "    owner = msg.sender;", "highlightLines": [36]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 36, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "931a99607a7e", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  modifier onlyOwner() {\n    require(msg.sender == owner);\n    _;\n  }", "highlightLines": [43]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 43, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "08b768c58251", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "  modifier onlyOwner() {\n    require(msg.sender == owner);\n    _;\n  }", "highlightLines": [43]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 43, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "ebef1fba2bfa", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    require(msg.sender == owner);", "highlightLines": [44]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 44, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "abcbbcac0555", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(msg.sender == owner);", "highlightLines": [44]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 44, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "3cfb2e7b264d", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    _;", "highlightLines": [45]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 45, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "d7bc3668a0fc", "fix": {"template": null, "available": false}, "title": "Access control change without event emission - harder to monitor and audit", "ruleId": "rules.sol-missing-events-access-control", "snippet": {"code": "  function transferOwnership(address newOwner) onlyOwner {", "highlightLines": [53]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 53, "column": 3}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-access-control"], "description": ""}, {"id": "00b900dc0cc1", "fix": {"template": null, "available": false}, "title": "Critical ownership transfer in single step - use two-step transfer with pending owner acceptance", "ruleId": "rules.sol-two-step-ownership", "snippet": {"code": "  function transferOwnership(address newOwner) onlyOwner {\n    if (newOwner != address(0)) {\n      owner = newOwner;\n    }", "highlightLines": [53]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 53, "column": 3}, "severity": "info", "references": ["https://docs.openzeppelin.com/contracts/access-control"], "description": ""}, {"id": "2da5b7fe3b8a", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function transferOwnership(address newOwner) onlyOwner {\n    if (newOwner != address(0)) {\n      owner = newOwner;\n    }\n  }", "highlightLines": [53]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 53, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "65be10ea7886", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "  function transferOwnership(address newOwner) onlyOwner {", "highlightLines": [53]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 53, "column": 48}, "severity": "info", "references": [], "description": ""}, {"id": "185a1abfb9a2", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "      owner = newOwner;", "highlightLines": [55]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 55, "column": 7}, "severity": "info", "references": [], "description": ""}, {"id": "93957643ab92", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function balanceOf(address _owner) public view returns (uint256 balance);", "highlightLines": [66]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 66, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "d6794e049a3d", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function ownerOf(uint256 _tokenId) external view returns (address owner);\n    function approve(address _to, uint256 _tokenId) external;\n    function transfer(address _to, uint256 _tokenId) external;\n    function transferFrom(address _from, address _to, uint256 _tokenId) external;\n\n    // Events\n    event Transfer(address from, address to, uint256 tokenId);\n    event Approval(address owner, address approved, uint256 tokenId);\n\n    // Optional\n    // function name() public view returns (string name);\n    // function symbol() public view returns (string symbol);\n    // function tokensOfOwner(address _owner) external view returns (uint256[] tokenIds);\n    // function tokenMetadata(uint256 _tokenId, string _preferredTransport) public view returns (string infoUrl);\n\n    // ERC-165 Compatibility (https://github.com/ethereum/EIPs/issues/165)\n    function supportsInterface(bytes4 _interfaceID) external view returns (bool);\n}\n\ncontract GeneScienceInterface {", "highlightLines": [67]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 67, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "ac3fa1e7d86c", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function approve(address _to, uint256 _tokenId) external;", "highlightLines": [68]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 68, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "cea0753fc48d", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function transfer(address _to, uint256 _tokenId) external;", "highlightLines": [69]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 69, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "feaea5d54a42", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without msg.data.length validation - vulnerable to short address attack padding", "ruleId": "rules.sol-short-address-no-payload-check", "snippet": {"code": "    function transfer(address _to, uint256 _tokenId) external;\n    function transferFrom(address _from, address _to, uint256 _tokenId) external;\n\n    // Events\n    event Transfer(address from, address to, uint256 tokenId);\n    event Approval(address owner, address approved, uint256 tokenId);\n\n    // Optional\n    // function name() public view returns (string name);\n    // function symbol() public view returns (string symbol);\n    // function tokensOfOwner(address _owner) external view returns (uint256[] tokenIds);\n    // function tokenMetadata(uint256 _tokenId, string _preferredTransport) public view returns (string infoUrl);\n\n    // ERC-165 Compatibility (https://github.com/ethereum/EIPs/issues/165)\n    function supportsInterface(bytes4 _interfaceID) external view returns (bool);\n}\n\ncontract GeneScienceInterface {", "highlightLines": [69]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 69, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address", "https://vessenes.com/the-erc20-short-address-attack-explained/"], "description": ""}, {"id": "74c06c8d4566", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function transferFrom(address _from, address _to, uint256 _tokenId) external;", "highlightLines": [70]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 70, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "ee0ddc39b45b", "fix": {"template": null, "available": false}, "title": "ERC20 transferFrom without payload size validation - consider adding onlyPayloadSize modifier", "ruleId": "rules.sol-erc20-missing-payload-modifier", "snippet": {"code": "    function transferFrom(address _from, address _to, uint256 _tokenId) external;\n\n    // Events\n    event Transfer(address from, address to, uint256 tokenId);\n    event Approval(address owner, address approved, uint256 tokenId);\n\n    // Optional\n    // function name() public view returns (string name);\n    // function symbol() public view returns (string symbol);\n    // function tokensOfOwner(address _owner) external view returns (uint256[] tokenIds);\n    // function tokenMetadata(uint256 _tokenId, string _preferredTransport) public view returns (string infoUrl);\n\n    // ERC-165 Compatibility (https://github.com/ethereum/EIPs/issues/165)\n    function supportsInterface(bytes4 _interfaceID) external view returns (bool);\n}\n\ncontract GeneScienceInterface {", "highlightLines": [70]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 70, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address"], "description": ""}, {"id": "5763a98618ec", "fix": {"template": null, "available": false}, "title": "NFT transfer without approval/ownership check - add _isApprovedOrOwner validation", "ruleId": "rules.sol-nft-transfer-no-approval-check", "snippet": {"code": "    function transferFrom(address _from, address _to, uint256 _tokenId) external;\n\n    // Events\n    event Transfer(address from, address to, uint256 tokenId);\n    event Approval(address owner, address approved, uint256 tokenId);\n\n    // Optional\n    // function name() public view returns (string name);\n    // function symbol() public view returns (string symbol);\n    // function tokensOfOwner(address _owner) external view returns (uint256[] tokenIds);\n    // function tokenMetadata(uint256 _tokenId, string _preferredTransport) public view returns (string infoUrl);\n\n    // ERC-165 Compatibility (https://github.com/ethereum/EIPs/issues/165)\n    function supportsInterface(bytes4 _interfaceID) external view returns (bool);\n}\n\ncontract GeneScienceInterface {", "highlightLines": [70]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 70, "column": 5}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/NFT-transfer.sol"], "description": ""}, {"id": "a7f1ed5986ad", "fix": {"template": null, "available": false}, "title": "ERC20 Transfer/Approval events should have indexed from/to/owner/spender parameters", "ruleId": "rules.sol-unindexed-erc20-events", "snippet": {"code": "    event Transfer(address from, address to, uint256 tokenId);", "highlightLines": [73]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 73, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#unindexed-erc20-event-parameters"], "description": ""}, {"id": "75a6c5d19ae5", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event Transfer(address from, address to, uint256 tokenId);", "highlightLines": [73]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 73, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "1ae845cddb4f", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Transfer(address from, address to, uint256 tokenId);", "highlightLines": [73]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 73, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "71b04021b5b6", "fix": {"template": null, "available": false}, "title": "ERC20 Transfer/Approval events should have indexed from/to/owner/spender parameters", "ruleId": "rules.sol-unindexed-erc20-events", "snippet": {"code": "    event Approval(address owner, address approved, uint256 tokenId);", "highlightLines": [74]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 74, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#unindexed-erc20-event-parameters"], "description": ""}, {"id": "3a07707db569", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event Approval(address owner, address approved, uint256 tokenId);", "highlightLines": [74]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 74, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "76abe8589423", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Approval(address owner, address approved, uint256 tokenId);", "highlightLines": [74]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 74, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "599409eb8fda", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function isGeneScience() public pure returns (bool);\n\n    /// @dev given genes of kitten 1 & 2, return a genetic combination - may have a random factor\n    /// @param genes1 genes of mom\n    /// @param genes2 genes of sire\n    /// @return the genes that are supposed to be passed down the child\n    function mixGenes(uint256[2] genes1, uint256[2] genes2,uint256 g1,uint256 g2, uint256 targetBlock) public returns (uint256[2]);\n\n    function getPureFromGene(uint256[2] gene) public view returns(uint256);\n\n    /// @dev get sex from genes 0: female 1: male\n    function getSex(uint256[2] gene) public view returns(uint256);\n\n    /// @dev get wizz type from gene\n    function getWizzType(uint256[2] gene) public view returns(uint256);\n\n    function clearWizzType(uint256[2] _gene) public returns(uint256[2]);\n}\n\n/// @title A facet of PandaCore that manages special access privileges.\n/// @author Axiom Zen (https://www.axiomzen.co)\n/// @dev See the PandaCore contract documentation to understand how the various contract facets are arranged.\ncontract PandaAccessControl {\n    // This facet controls access control for CryptoPandas. There are four roles managed here:\n    //\n    //     - The CEO: The CEO can reassign other roles and change the addresses of our dependent smart\n    //         contracts. It is also the only role that can unpause the smart contract. It is initially\n    //         set to the address that created the smart contract in the PandaCore constructor.\n    //\n    //     - The CFO: The CFO can withdraw funds from PandaCore and its auction contracts.\n    //\n    //     - The COO: The COO can release gen0 pandas to auction, and mint promo cats.\n    //\n    // It should be noted that these roles are distinct without overlap in their access abilities, the\n    // abilities listed for each role above are exhaustive. In particular, while the CEO can assign any\n    // address to any role, the CEO address itself doesn't have the ability to act in those roles. This\n    // restriction is intentional so that we aren't tempted to use the CEO address frequently out of\n    // convenience. The less we use an address, the less likely it is that we somehow compromise the\n    // account.\n\n    /// @dev Emited when contract is upgraded - See README.md for updgrade plan\n    event ContractUpgrade(address newContract);\n\n    // The addresses of the accounts (or contracts) that can execute actions within each roles.\n    address public ceoAddress;\n    address public cfoAddress;\n    address public cooAddress;\n\n    // @dev Keeps track whether the contract is paused. When that is true, most actions are blocked\n    bool public paused = false;", "highlightLines": [88]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 88, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "cbf691aa5514", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "    /// @dev given genes of kitten 1 & 2, return a genetic combination - may have a random factor\n    /// @param genes1 genes of mom\n    /// @param genes2 genes of sire\n    /// @return the genes that are supposed to be passed down the child\n    function mixGenes(uint256[2] genes1, uint256[2] genes2,uint256 g1,uint256 g2, uint256 targetBlock) public returns (uint256[2]);\n\n    function getPureFromGene(uint256[2] gene) public view returns(uint256);", "highlightLines": [90]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 90, "column": 43}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "0b1746c782c5", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event ContractUpgrade(address newContract);", "highlightLines": [129]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 129, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "6d4f19ff5f94", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event ContractUpgrade(address newContract);", "highlightLines": [129]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 129, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "bef666c8aa37", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyCEO() {\n        require(msg.sender == ceoAddress);\n        _;\n    }", "highlightLines": [140]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 140, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "dcf84481e9d1", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender == ceoAddress);", "highlightLines": [141]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 141, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "8aa254f1c056", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [142]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 142, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "703e79b4e33c", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyCFO() {\n        require(msg.sender == cfoAddress);\n        _;\n    }", "highlightLines": [146]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 146, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "acc5ce4409dd", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender == cfoAddress);", "highlightLines": [147]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 147, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "2884c2108cb4", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [148]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 148, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "aded5f0ea1c3", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyCOO() {\n        require(msg.sender == cooAddress);\n        _;\n    }", "highlightLines": [152]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 152, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "a240c6c6b4f1", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender == cooAddress);", "highlightLines": [153]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 153, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "e37b7365161b", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [154]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 154, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "7e3a84e4cc53", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyCLevel() {\n        require(\n            msg.sender == cooAddress ||\n            msg.sender == ceoAddress ||\n            msg.sender == cfoAddress\n        );\n        _;\n    }", "highlightLines": [157]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 157, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "fb09cbec2538", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "    modifier onlyCLevel() {\n        require(\n            msg.sender == cooAddress ||\n            msg.sender == ceoAddress ||\n            msg.sender == cfoAddress\n        );\n        _;\n    }", "highlightLines": [157]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 157, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "79356fede808", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(\n            msg.sender == cooAddress ||\n            msg.sender == ceoAddress ||\n            msg.sender == cfoAddress\n        );", "highlightLines": [158]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 158, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "062b1288b893", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [163]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 163, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "8815c9b24ba0", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_newCEO != address(0));", "highlightLines": [169]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 169, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "1c5bc10d8f12", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_newCFO != address(0));", "highlightLines": [177]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 177, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "12b0642f46ac", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_newCOO != address(0));", "highlightLines": [185]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 185, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "d42fbd1c811a", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier whenNotPaused() {\n        require(!paused);\n        _;\n    }", "highlightLines": [193]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 193, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "59d71c26ff29", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(!paused);", "highlightLines": [194]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 194, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "3458cd66e17a", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [195]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 195, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "9c8deee6872a", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier whenPaused {\n        require(paused);\n        _;\n    }", "highlightLines": [199]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 199, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "634ce553f444", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(paused);", "highlightLines": [200]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 200, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "94712b993f39", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [201]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 201, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "a9dd4d9d44e6", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function pause() external onlyCLevel whenNotPaused {", "highlightLines": [206]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 206, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "ece99d125b7f", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function unpause() public onlyCEO whenPaused {", "highlightLines": [215]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 215, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "0ae973811508", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract PandaBase is PandaAccessControl {\n    /*** EVENTS ***/\n\n    uint256 public constant GEN0_TOTAL_COUNT = 16200;\n    uint256 public gen0CreatedCount;\n\n    /// @dev The Birth event is fired whenever a new kitten comes into existence. This obviously\n    ///  includes any time a cat is created through the giveBirth method, but it is also called\n    ///  when a new gen0 cat is created.\n    event Birth(address owner, uint256 pandaId, uint256 matronId, uint256 sireId, uint256[2] genes);\n\n    /// @dev Transfer event as defined in current draft of ERC721. Emitted every time a kitten\n    ///  ownership is assigned, including births.\n    event Transfer(address from, address to, uint256 tokenId);\n\n    /*** DATA TYPES ***/\n\n    /// @dev The main Panda struct. Every cat in CryptoPandas is represented by a copy\n    ///  of this structure, so great care was taken to ensure that it fits neatly into\n    ///  exactly two 256-bit words. Note that the order of the members in this structure\n    ///  Ref: http://solidity.readthedocs.io/en/develop/miscellaneous.html\n    struct Panda {\n        // The Panda's genetic code is packed into these 256-bits, the format is\n        // sooper-sekret! A cat's genes never change.\n        uint256[2] genes;\n\n        // The timestamp from the block when this cat came into existence.\n        uint64 birthTime;\n\n        // The minimum timestamp after which this cat can engage in breeding\n        // activities again. This same timestamp is used for the pregnancy\n        // timer (for matrons) as well as the siring cooldown.\n        uint64 cooldownEndBlock;\n\n        // The ID of the parents of this panda, set to 0 for gen0 cats.\n        // Note that using 32-bit unsigned integers limits us to a \"mere\"\n        // 4 billion cats. This number might seem small until you realize\n        // that Ethereum currently has a limit of about 500 million\n        // transactions per year! So, this definitely won't be a problem\n        // for several years (even as Ethereum learns to scale).\n        uint32 matronId;\n        uint32 sireId;\n\n        // Set to the ID of the sire cat for matrons that are pregnant,\n        // zero otherwise. A non-zero value here is how we know a cat\n        // is pregnant. Used to retrieve the genetic material for the new\n        // kitten when the birth transpires.\n        uint32 siringWithId;\n\n        // Set to the index in the cooldown array (see below) that represents\n        // the current cooldown duration for this Panda. This starts at zero\n        // for gen0 cats, and is initialized to floor(generation/2) for others.\n        // Incremented by one for each successful breeding action, regardless\n        // of whether this cat is acting as matron or sire.\n        uint16 cooldownIndex;\n\n        // The \"generation number\" of this cat. Cats minted by the CK contract\n        // for sale are called \"gen0\" and have a generation number of 0. The\n        // generation number of all other cats is the larger of the two generation\n        // numbers of their parents, plus one.\n        // (i.e. max(matron.generation, sire.generation) + 1)\n        uint16 generation;", "highlightLines": [231]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 231, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "fd9601623d74", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event Birth(address owner, uint256 pandaId, uint256 matronId, uint256 sireId, uint256[2] genes);", "highlightLines": [240]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 240, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "13d2c81e2779", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Birth(address owner, uint256 pandaId, uint256 matronId, uint256 sireId, uint256[2] genes);", "highlightLines": [240]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 240, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "e3fa46fd0ef0", "fix": {"template": null, "available": false}, "title": "ERC20 Transfer/Approval events should have indexed from/to/owner/spender parameters", "ruleId": "rules.sol-unindexed-erc20-events", "snippet": {"code": "    event Transfer(address from, address to, uint256 tokenId);", "highlightLines": [244]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 244, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#unindexed-erc20-event-parameters"], "description": ""}, {"id": "ffa5570d47e1", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event Transfer(address from, address to, uint256 tokenId);", "highlightLines": [244]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 244, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "129ee13ac027", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Transfer(address from, address to, uint256 tokenId);", "highlightLines": [244]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 244, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "38f43955333a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint64 birthTime;", "highlightLines": [258]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 258, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "21095bdda4d2", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint64 cooldownEndBlock;", "highlightLines": [263]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 263, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "426e1d2b17f1", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint32 matronId;", "highlightLines": [271]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 271, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e248bb6cc8eb", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint32 sireId;", "highlightLines": [272]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 272, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "81edf0857fb8", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint32 siringWithId;", "highlightLines": [278]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 278, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "931d3a450093", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint16 cooldownIndex;", "highlightLines": [285]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 285, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3f8795f9d556", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint16 generation;", "highlightLines": [292]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 292, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7a85ab520e18", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        uint32(5 minutes),", "highlightLines": [304]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 304, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "1e44112b0b61", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        uint32(30 minutes),", "highlightLines": [305]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 305, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "1ce2ce637212", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        uint32(2 hours),", "highlightLines": [306]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 306, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "9e7cd3fda574", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        uint32(4 hours),", "highlightLines": [307]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 307, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "9efef8650d57", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        uint32(8 hours),", "highlightLines": [308]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 308, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "55f7ebd1e4bc", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        uint32(24 hours),", "highlightLines": [309]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 309, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "16cf278b76fb", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        uint32(48 hours),", "highlightLines": [310]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 310, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "721908cb6118", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        uint32(72 hours),", "highlightLines": [311]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 311, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "bb4ff68139a9", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        uint32(7 days)", "highlightLines": [312]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 312, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "6260d67b1d03", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function setTotalWizzPandaOf(uint256 _tp,uint256 _total) external onlyCLevel {\n        require (wizzPandaQuota[_tp]==0);\n        require (_total==uint256(uint32(_total)));", "highlightLines": [378]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 378, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "15dddc7b741e", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require (wizzPandaQuota[_tp]==0);", "highlightLines": [379]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 379, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "2574fe2ab4c7", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require (_total==uint256(uint32(_total)));", "highlightLines": [380]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 380, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "6a0b0a9f73c0", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        require (_total==uint256(uint32(_total)));", "highlightLines": [380]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 380, "column": 34}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "8ae833e62a2f", "fix": {"template": null, "available": false}, "title": "Oracle price update without deviation check - prices can change arbitrarily (Compromised pattern)", "ruleId": "rules.sol-oracle-no-price-deviation-check", "snippet": {"code": "        wizzPandaQuota[_tp] = _total;", "highlightLines": [381]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 381, "column": 9}, "severity": "medium", "references": ["https://www.damnvulnerabledefi.xyz/challenges/compromised/"], "description": ""}, {"id": "b24d21482d03", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function getWizzTypeOf(uint256 _id) view external returns(uint256) {\n        Panda memory _p = pandas[_id];", "highlightLines": [384]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 384, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "72860a350e7b", "fix": {"template": null, "available": false}, "title": "Struct copied to memory from mapping - modifications won't persist to storage", "ruleId": "rules.sol-memory-struct-from-mapping", "snippet": {"code": "        Panda memory _p = pandas[_id];", "highlightLines": [385]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 385, "column": 9}, "severity": "high", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/DataLocation.sol"], "description": ""}, {"id": "35a3f158b7f7", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function _transfer(address _from, address _to, uint256 _tokenId) internal {", "highlightLines": [390]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 390, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "a9614b42c362", "fix": {"template": null, "available": false}, "title": "Self transfer not checked - can cause balance corruption with from == to", "ruleId": "rules.sol-self-transfer-unchecked", "snippet": {"code": "    function _transfer(address _from, address _to, uint256 _tokenId) internal {", "highlightLines": [390]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 390, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/self-transfer.sol"], "description": ""}, {"id": "9193b0cc612b", "fix": {"template": null, "available": false}, "title": "Possible incorrect exponentiation - ^ is XOR in Solidity, use ** for power", "ruleId": "rules.sol-incorrect-exponentiation", "snippet": {"code": "        // Since the number of kittens is capped to 2^32 we can't overflow this", "highlightLines": [391]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 391, "column": 53}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-exponentiation"], "description": ""}, {"id": "c3a9152b637f", "fix": {"template": null, "available": false}, "title": "Deleting mapping inside struct leaves nested data - use separate mapping deletion", "ruleId": "rules.sol-mapping-deletion", "snippet": {"code": "            delete sireAllowedToAddress[_tokenId];", "highlightLines": [399]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 399, "column": 13}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#deletion-on-mapping-containing-a-structure"], "description": ""}, {"id": "750f876b8422", "fix": {"template": null, "available": false}, "title": "delete array[i] leaves gap with zero value - use swap-and-pop pattern instead", "ruleId": "rules.sol-array-element-delete", "snippet": {"code": "            delete sireAllowedToAddress[_tokenId];", "highlightLines": [399]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 399, "column": 13}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/Array-deletion.sol"], "description": ""}, {"id": "513cff366ab5", "fix": {"template": null, "available": false}, "title": "Deleting mapping inside struct leaves nested data - use separate mapping deletion", "ruleId": "rules.sol-mapping-deletion", "snippet": {"code": "            delete pandaIndexToApproved[_tokenId];", "highlightLines": [401]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 401, "column": 13}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#deletion-on-mapping-containing-a-structure"], "description": ""}, {"id": "c43a6a9a355e", "fix": {"template": null, "available": false}, "title": "delete array[i] leaves gap with zero value - use swap-and-pop pattern instead", "ruleId": "rules.sol-array-element-delete", "snippet": {"code": "            delete pandaIndexToApproved[_tokenId];", "highlightLines": [401]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 401, "column": 13}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/Array-deletion.sol"], "description": ""}, {"id": "1c5d48ea9d05", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function _createPanda(\n        uint256 _matronId,\n        uint256 _sireId,\n        uint256 _generation,\n        uint256[2] _genes,\n        address _owner\n    )\n        internal\n        returns (uint)\n    {\n        // These requires are not strictly necessary, our calling code should make\n        // sure that these conditions are never broken. However! _createPanda() is already\n        // an expensive call (for storage), and it doesn't hurt to be especially careful\n        // to ensure our data structures are always valid.\n        require(_matronId == uint256(uint32(_matronId)));\n        require(_sireId == uint256(uint32(_sireId)));\n        require(_generation == uint256(uint16(_generation)));", "highlightLines": [416]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 416, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "06609d5e0c1a", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_matronId == uint256(uint32(_matronId)));", "highlightLines": [430]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 430, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "e86b2d482197", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        require(_matronId == uint256(uint32(_matronId)));", "highlightLines": [430]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 430, "column": 38}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "8f78fba684b6", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_sireId == uint256(uint32(_sireId)));", "highlightLines": [431]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 431, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "403a809ffa1c", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        require(_sireId == uint256(uint32(_sireId)));", "highlightLines": [431]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 431, "column": 36}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "2e86be9ff032", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_generation == uint256(uint16(_generation)));", "highlightLines": [432]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 432, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "585ee4dc03d7", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        require(_generation == uint256(uint16(_generation)));", "highlightLines": [432]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 432, "column": 40}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "b01d7b519be6", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint16 cooldownIndex = 0;", "highlightLines": [436]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 436, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "2bf16961f913", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint16 cooldownIndex = 0;\n        // when contract creation, geneScience ref is null \n        if (pandas.length>0){\n            uint16 pureDegree = uint16(geneScience.getPureFromGene(_genes));\n            if (pureDegree==0) {\n                pureDegree = 1;\n            }\n            cooldownIndex = 1000/pureDegree;\n            if (cooldownIndex%10 < 5){\n                cooldownIndex = cooldownIndex/10;\n            }else{\n                cooldownIndex = cooldownIndex/10 + 1;\n            }\n            cooldownIndex = cooldownIndex - 1;\n            if (cooldownIndex > 8) {\n                cooldownIndex = 8;\n            }\n            uint256 _tp = geneScience.getWizzType(_genes);\n            if (_tp>0 && wizzPandaQuota[_tp]<=wizzPandaCount[_tp]) {\n                _genes = geneScience.clearWizzType(_genes);\n                _tp = 0;\n            }\n            // gensis panda cooldownIndex should be 24 hours\n            if (_tp == 1){\n                cooldownIndex = 5;\n            }\n\n            // increase wizz counter\n            if (_tp>0){\n                wizzPandaCount[_tp] = wizzPandaCount[_tp] + 1;\n            }\n            // all gen0&gen1 except gensis\n            if (_generation <= 1 && _tp != 1){\n                require(gen0CreatedCount<GEN0_TOTAL_COUNT);\n                gen0CreatedCount++;\n            }\n        }", "highlightLines": [436]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 436, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "8b59da077b72", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint16 pureDegree = uint16(geneScience.getPureFromGene(_genes));", "highlightLines": [439]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 439, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "520593450213", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            uint16 pureDegree = uint16(geneScience.getPureFromGene(_genes));\n            if (pureDegree==0) {\n                pureDegree = 1;\n            }", "highlightLines": [439]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 439, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "39594c47e930", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "            uint16 pureDegree = uint16(geneScience.getPureFromGene(_genes));\n            if (pureDegree==0) {\n                pureDegree = 1;\n            }\n            cooldownIndex = 1000/pureDegree;\n            if (cooldownIndex%10 < 5){\n                cooldownIndex = cooldownIndex/10;\n            }else{\n                cooldownIndex = cooldownIndex/10 + 1;\n            }\n            cooldownIndex = cooldownIndex - 1;\n            if (cooldownIndex > 8) {\n                cooldownIndex = 8;\n            }\n            uint256 _tp = geneScience.getWizzType(_genes);", "highlightLines": [439]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 439, "column": 13}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "a8902dc6fd88", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "            uint16 pureDegree = uint16(geneScience.getPureFromGene(_genes));", "highlightLines": [439]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 439, "column": 33}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "cd59f9b57442", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            cooldownIndex = 1000/pureDegree;\n            if (cooldownIndex%10 < 5){\n                cooldownIndex = cooldownIndex/10;\n            }else{\n                cooldownIndex = cooldownIndex/10 + 1;\n            }", "highlightLines": [443]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 443, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "9a879d2072bd", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            cooldownIndex = cooldownIndex - 1;\n            if (cooldownIndex > 8) {\n                cooldownIndex = 8;\n            }", "highlightLines": [449]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 449, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "8f44319c9da6", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint256 _tp = geneScience.getWizzType(_genes);", "highlightLines": [453]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 453, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "336c13645a05", "fix": {"template": null, "available": false}, "title": "External view function called multiple times - attacker can return different values (Elevator/Shop pattern)", "ruleId": "rules.sol-external-view-manipulation", "snippet": {"code": "            uint256 _tp = geneScience.getWizzType(_genes);\n            if (_tp>0 && wizzPandaQuota[_tp]<=wizzPandaCount[_tp]) {\n                _genes = geneScience.clearWizzType(_genes);\n                _tp = 0;\n            }", "highlightLines": [453]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 453, "column": 13}, "severity": "medium", "references": ["https://ethernaut.openzeppelin.com/level/11", "https://ethernaut.openzeppelin.com/level/21"], "description": ""}, {"id": "550bd07ae7b5", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            uint256 _tp = geneScience.getWizzType(_genes);\n            if (_tp>0 && wizzPandaQuota[_tp]<=wizzPandaCount[_tp]) {\n                _genes = geneScience.clearWizzType(_genes);\n                _tp = 0;\n            }", "highlightLines": [453]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 453, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "b5403adb7e66", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "                _genes = geneScience.clearWizzType(_genes);\n                _tp = 0;", "highlightLines": [455]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 455, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "b7e5bf5fbc39", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "                require(gen0CreatedCount<GEN0_TOTAL_COUNT);", "highlightLines": [469]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 469, "column": 17}, "severity": "info", "references": [], "description": ""}, {"id": "22fec09cc4c6", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        Panda memory _panda = Panda({\n            genes: _genes,\n            birthTime: uint64(now),\n            cooldownEndBlock: 0,\n            matronId: uint32(_matronId),\n            sireId: uint32(_sireId),\n            siringWithId: 0,\n            cooldownIndex: cooldownIndex,\n            generation: uint16(_generation)\n        });\n        uint256 newKittenId = pandas.push(_panda) - 1;", "highlightLines": [474]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 474, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "f334eef62a01", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "            birthTime: uint64(now),", "highlightLines": [476]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 476, "column": 24}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "d5b34499ffbc", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "            matronId: uint32(_matronId),", "highlightLines": [478]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 478, "column": 23}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "6aecf256831c", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "            sireId: uint32(_sireId),", "highlightLines": [479]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 479, "column": 21}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "410139135a16", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "            generation: uint16(_generation)", "highlightLines": [482]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 482, "column": 25}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "c97bcddaddff", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 newKittenId = pandas.push(_panda) - 1;", "highlightLines": [484]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 484, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "bbcf9a7e107c", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(newKittenId == uint256(uint32(newKittenId)));", "highlightLines": [488]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 488, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "07da88dc8bb7", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        require(newKittenId == uint256(uint32(newKittenId)));", "highlightLines": [488]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 488, "column": 40}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "0a9cb32ae6c1", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "        // emit the birth event\n        Birth(\n            _owner,\n            newKittenId,\n            uint256(_panda.matronId),", "highlightLines": [490]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 490, "column": 27}, "severity": "info", "references": [], "description": ""}, {"id": "5e484836c6dd", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(secs < cooldowns[0]);", "highlightLines": [508]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 508, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "f3613d021caf", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "///  it has one function that will return the data as bytes.\ncontract ERC721Metadata {\n    /// @dev Given a token Id, returns a byte array that is supposed to be converted into string.\n    function getMetadata(uint256 _tokenId, string) public view returns (bytes32[4] buffer, uint256 count) {\n        if (_tokenId == 1) {\n            buffer[0] = \"Hello World! :D\";\n            count = 15;", "highlightLines": [513]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 513, "column": 36}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "d7b4fd5b1113", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function getMetadata(uint256 _tokenId, string) public view returns (bytes32[4] buffer, uint256 count) {", "highlightLines": [516]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 516, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "8689156cc506", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function getMetadata(uint256 _tokenId, string) public view returns (bytes32[4] buffer, uint256 count) {\n        if (_tokenId == 1) {", "highlightLines": [516]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 516, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "d29406a947fc", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function getMetadata(uint256 _tokenId, string) public view returns (bytes32[4] buffer, uint256 count) {\n        if (_tokenId == 1) {\n            buffer[0] = \"Hello World! :D\";\n            count = 15;", "highlightLines": [516]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 516, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "f8a9b23cb28d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            buffer[0] = \"Hello World! :D\";\n            count = 15;", "highlightLines": [518]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 518, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "fd47ef77e3fa", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            buffer[0] = \"I would definitely choose a medi\";\n            buffer[1] = \"um length string.\";", "highlightLines": [521]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 521, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "3e170f6b1cf1", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            buffer[1] = \"um length string.\";\n            count = 49;", "highlightLines": [522]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 522, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "bc28612825d6", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            buffer[0] = \"Lorem ipsum dolor sit amet, mi e\";\n            buffer[1] = \"st accumsan dapibus augue lorem,\";", "highlightLines": [525]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 525, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "de79582b8213", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            buffer[1] = \"st accumsan dapibus augue lorem,\";\n            buffer[2] = \" tristique vestibulum id, libero\";", "highlightLines": [526]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 526, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "66b97cd421d0", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            buffer[2] = \" tristique vestibulum id, libero\";\n            buffer[3] = \" suscipit varius sapien aliquam.\";", "highlightLines": [527]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 527, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "80d314b025a8", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            buffer[3] = \" suscipit varius sapien aliquam.\";\n            count = 128;", "highlightLines": [528]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 528, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "3fdfc8309e8b", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "    function supportsInterface(bytes4 _interfaceID) external view returns (bool)\n    {\n        // DEBUG ONLY\n        //require((InterfaceSignature_ERC165 == 0x01ffc9a7) && (InterfaceSignature_ERC721 == 0x9a20483d));", "highlightLines": [568]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 568, "column": 5}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "1a3b3e8930c5", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function supportsInterface(bytes4 _interfaceID) external view returns (bool)\n    {\n        // DEBUG ONLY\n        //require((InterfaceSignature_ERC165 == 0x01ffc9a7) && (InterfaceSignature_ERC721 == 0x9a20483d));\n\n        return ((_interfaceID == InterfaceSignature_ERC165) || (_interfaceID == InterfaceSignature_ERC721));", "highlightLines": [568]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 568, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "2588e39fa67f", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function _owns(address _claimant, uint256 _tokenId) internal view returns (bool) {", "highlightLines": [583]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 583, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "c28bb411700d", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function _approvedFor(address _claimant, uint256 _tokenId) internal view returns (bool) {", "highlightLines": [590]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 590, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "66254cf4ed85", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function _approve(uint256 _tokenId, address _approved) internal {", "highlightLines": [599]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 599, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "b2e2e83f77cf", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function transfer(\n        address _to,\n        uint256 _tokenId\n    )\n        external\n        whenNotPaused\n    {", "highlightLines": [616]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 616, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "70522c17a7bb", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function transfer(\n        address _to,\n        uint256 _tokenId\n    )\n        external\n        whenNotPaused\n    {", "highlightLines": [616]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 616, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "f2b574a4b3a9", "fix": {"template": null, "available": false}, "title": "ERC20 transfer without msg.data.length validation - vulnerable to short address attack padding", "ruleId": "rules.sol-short-address-no-payload-check", "snippet": {"code": "    function transfer(\n        address _to,\n        uint256 _tokenId\n    )\n        external\n        whenNotPaused\n    {", "highlightLines": [616]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 616, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address", "https://vessenes.com/the-erc20-short-address-attack-explained/"], "description": ""}, {"id": "56073b715b2d", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_to != address(0));", "highlightLines": [624]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 624, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "615ad0753ff7", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_to != address(this));", "highlightLines": [628]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 628, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "90552b273bbe", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_to != address(saleAuction));", "highlightLines": [632]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 632, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "a439d3113805", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_to != address(siringAuction));", "highlightLines": [633]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 633, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "5679fa584afd", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_owns(msg.sender, _tokenId));", "highlightLines": [636]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 636, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "60fb51f9826f", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function approve(\n        address _to,\n        uint256 _tokenId\n    )\n        external\n        whenNotPaused\n    {", "highlightLines": [648]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 648, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "84086cf0b7f6", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function approve(\n        address _to,\n        uint256 _tokenId\n    )\n        external\n        whenNotPaused\n    {", "highlightLines": [648]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 648, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "d1c77bbda9bf", "fix": {"template": null, "available": false}, "title": "Using approve() without increaseAllowance/decreaseAllowance - vulnerable to front-running race condition", "ruleId": "rules.sol-erc20-approve-frontrun", "snippet": {"code": "    function approve(\n        address _to,\n        uint256 _tokenId\n    )\n        external\n        whenNotPaused\n    {\n        // Only an owner can grant transfer approval.\n        require(_owns(msg.sender, _tokenId));\n\n        // Register the approval (replacing any previous approval).\n        _approve(_tokenId, _to);\n\n        // Emit approval event.\n        Approval(msg.sender, _to, _tokenId);\n    }", "highlightLines": [648]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 648, "column": 5}, "severity": "info", "references": ["https://docs.google.com/document/d/1YLPtQxZu1UAvO9cZ1O2RPXBbT0mooh4DYKjA_jp-RLM"], "description": ""}, {"id": "152137d6bc43", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_owns(msg.sender, _tokenId));", "highlightLines": [656]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 656, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "fc24c9f56c50", "fix": {"template": null, "available": false}, "title": "ERC20 transferFrom without payload size validation - consider adding onlyPayloadSize modifier", "ruleId": "rules.sol-erc20-missing-payload-modifier", "snippet": {"code": "    function transferFrom(\n        address _from,\n        address _to,\n        uint256 _tokenId\n    )\n        external\n        whenNotPaused\n    {", "highlightLines": [672]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 672, "column": 5}, "severity": "info", "references": ["https://blog.sigmaprime.io/solidity-security.html#short-address"], "description": ""}, {"id": "54c0909e266f", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function transferFrom(\n        address _from,\n        address _to,\n        uint256 _tokenId\n    )\n        external\n        whenNotPaused\n    {", "highlightLines": [672]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 672, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "36d7e3ab9f15", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function transferFrom(\n        address _from,\n        address _to,\n        uint256 _tokenId\n    )\n        external\n        whenNotPaused\n    {", "highlightLines": [672]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 672, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "c5746c4ce58f", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_to != address(0));", "highlightLines": [681]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 681, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "5b4c9f9ba256", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_to != address(this));", "highlightLines": [685]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 685, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "bbb163c21f1d", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_approvedFor(msg.sender, _tokenId));", "highlightLines": [687]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 687, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "25f32d99bae9", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_owns(_from, _tokenId));", "highlightLines": [688]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 688, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "60c85505aa79", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function ownerOf(uint256 _tokenId)\n        external\n        view\n        returns (address owner)\n    {", "highlightLines": [702]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 702, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "2715bebfc08b", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function ownerOf(uint256 _tokenId)\n        external\n        view\n        returns (address owner)\n    {\n        owner = pandaIndexToOwner[_tokenId];", "highlightLines": [702]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 702, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "30a52f823b3a", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        owner = pandaIndexToOwner[_tokenId];", "highlightLines": [707]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 707, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "41e99bb1bf98", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(owner != address(0));", "highlightLines": [709]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 709, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "4a917928c64d", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function tokensOfOwner(address _owner) external view returns(uint256[] ownerTokens) {\n        uint256 tokenCount = balanceOf(_owner);", "highlightLines": [718]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 718, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "fc2e373f8d5c", "fix": {"template": null, "available": false}, "title": "View function reads state that may be stale during callback - read-only reentrancy risk", "ruleId": "rules.sol-read-only-reentrancy", "snippet": {"code": "    function tokensOfOwner(address _owner) external view returns(uint256[] ownerTokens) {\n        uint256 tokenCount = balanceOf(_owner);", "highlightLines": [718]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 718, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs", "https://chainsecurity.com/curve-lp-oracle-manipulation-post-mortem/"], "description": ""}, {"id": "31598bedc086", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 tokenCount = balanceOf(_owner);", "highlightLines": [719]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 719, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "6a96b65b5cf1", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 tokenCount = balanceOf(_owner);\n\n        if (tokenCount == 0) {\n            // Return an empty array\n            return new uint256[](0);\n        } else {\n            uint256[] memory result = new uint256[](tokenCount);\n            uint256 totalCats = totalSupply();\n            uint256 resultIndex = 0;\n\n            // We count on the fact that all cats have IDs starting at 1 and increasing\n            // sequentially up to the totalCat count.\n            uint256 catId;\n\n            for (catId = 1; catId <= totalCats; catId++) {\n                if (pandaIndexToOwner[catId] == _owner) {\n                    result[resultIndex] = catId;\n                    resultIndex++;\n                }\n            }\n\n            return result;\n        }", "highlightLines": [719]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 719, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "a3b1360b0e21", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "        if (tokenCount == 0) {\n            // Return an empty array\n            return new uint256[](0);\n        } else {\n            uint256[] memory result = new uint256[](tokenCount);\n            uint256 totalCats = totalSupply();\n            uint256 resultIndex = 0;\n\n            // We count on the fact that all cats have IDs starting at 1 and increasing\n            // sequentially up to the totalCat count.\n            uint256 catId;\n\n            for (catId = 1; catId <= totalCats; catId++) {\n                if (pandaIndexToOwner[catId] == _owner) {\n                    result[resultIndex] = catId;\n                    resultIndex++;\n                }\n            }\n\n            return result;\n        }", "highlightLines": [721]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 721, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "4ce7143434fa", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "            return new uint256[](0);", "highlightLines": [723]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 723, "column": 20}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "6ebf320f4a7f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            uint256[] memory result = new uint256[](tokenCount);\n            uint256 totalCats = totalSupply();", "highlightLines": [725]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 725, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "bc69b5fccb58", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "            uint256[] memory result = new uint256[](tokenCount);", "highlightLines": [725]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 725, "column": 39}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "2c12f9bba462", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint256 totalCats = totalSupply();", "highlightLines": [726]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 726, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "6430abcc89b9", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "            uint256 totalCats = totalSupply();", "highlightLines": [726]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 726, "column": 13}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "7d0d534f4a18", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            uint256 totalCats = totalSupply();\n            uint256 resultIndex = 0;", "highlightLines": [726]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 726, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "ad0c57947e9e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint256 resultIndex = 0;", "highlightLines": [727]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 727, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "99ecb95f739b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            uint256 resultIndex = 0;\n\n            // We count on the fact that all cats have IDs starting at 1 and increasing\n            // sequentially up to the totalCat count.\n            uint256 catId;\n\n            for (catId = 1; catId <= totalCats; catId++) {\n                if (pandaIndexToOwner[catId] == _owner) {\n                    result[resultIndex] = catId;\n                    resultIndex++;\n                }\n            }", "highlightLines": [727]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 727, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "f53337561efb", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint256 catId;", "highlightLines": [731]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 731, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "96700940e821", "fix": {"template": null, "available": false}, "title": "View/pure function uses assembly - may modify state unexpectedly", "ruleId": "rules.sol-constant-function-assembly", "snippet": {"code": "    function _memcpy(uint _dest, uint _src, uint _len) private view {\n        // Copy word-length chunks while possible\n        for(; _len >= 32; _len -= 32) {\n            assembly {", "highlightLines": [747]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 747, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-using-assembly-code"], "description": ""}, {"id": "2bb52e1ebc81", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "            assembly {", "highlightLines": [750]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 750, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "08062328e529", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 mask = 256 ** (32 - _len) - 1;", "highlightLines": [758]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 758, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a60591cfd967", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 mask = 256 ** (32 - _len) - 1;\n        assembly {\n            let srcpart := and(mload(_src), not(mask))\n            let destpart := and(mload(_dest), mask)\n            mstore(_dest, or(destpart, srcpart))\n        }", "highlightLines": [758]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 758, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "25e3d98bff12", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [759]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 759, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "8704670d252b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            let srcpart := and(mload(_src), not(mask))\n            let destpart := and(mload(_dest), mask)", "highlightLines": [760]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 760, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "61d817be701c", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function _toString(bytes32[4] _rawBytes, uint256 _stringLength) private view returns (string) {\n        var outputString = new string(_stringLength);", "highlightLines": [769]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 769, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "c6af6d21d4f6", "fix": {"template": null, "available": false}, "title": "View/pure function uses assembly - may modify state unexpectedly", "ruleId": "rules.sol-constant-function-assembly", "snippet": {"code": "    function _toString(bytes32[4] _rawBytes, uint256 _stringLength) private view returns (string) {\n        var outputString = new string(_stringLength);\n        uint256 outputPtr;\n        uint256 bytesPtr;\n\n        assembly {", "highlightLines": [769]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 769, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-using-assembly-code"], "description": ""}, {"id": "495f569824dc", "fix": {"template": null, "available": false}, "title": "Deprecated 'var' keyword can cause type confusion - resolves to smallest type (e.g., uint8 in loops)", "ruleId": "rules.sol-deprecated-var-keyword", "snippet": {"code": "        var outputString = new string(_stringLength);", "highlightLines": [770]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 770, "column": 9}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/honeypots"], "description": ""}, {"id": "2e0065b58013", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        var outputString = new string(_stringLength);\n        uint256 outputPtr;\n        uint256 bytesPtr;\n\n        assembly {\n            outputPtr := add(outputString, 32)\n            bytesPtr := _rawBytes\n        }", "highlightLines": [770]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 770, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "b4ff1a73558c", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "        var outputString = new string(_stringLength);", "highlightLines": [770]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 770, "column": 28}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "1d9ab7971b36", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 outputPtr;", "highlightLines": [771]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 771, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e6c53f9df655", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 bytesPtr;", "highlightLines": [772]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 772, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4afdb1dd99d2", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [774]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 774, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "d3e8b611c784", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            outputPtr := add(outputString, 32)\n            bytesPtr := _rawBytes", "highlightLines": [775]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 775, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "4b7a28ce30be", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract PandaBreeding is PandaOwnership {\n\n    uint256 public constant GENSIS_TOTAL_COUNT = 100;\n\n    /// @dev The Pregnant event is fired when two cats successfully breed and the pregnancy\n    ///  timer begins for the matron.\n    event Pregnant(address owner, uint256 matronId, uint256 sireId, uint256 cooldownEndBlock);\n    /// @dev The Abortion event is fired when two cats breed failed.\n    event Abortion(address owner, uint256 matronId, uint256 sireId);\n\n    /// @notice The minimum payment required to use breedWithAuto(). This fee goes towards\n    ///  the gas cost paid by whatever calls giveBirth(), and can be dynamically updated by\n    ///  the COO role as the gas price changes.\n    uint256 public autoBirthFee = 2 finney;\n\n    // Keeps track of number of pregnant pandas.\n    uint256 public pregnantPandas;\n\n    mapping(uint256 => address) childOwner;\n\n\n    /// @dev Update the address of the genetic contract, can only be called by the CEO.\n    /// @param _address An address of a GeneScience contract instance to be used from this point forward.\n    function setGeneScienceAddress(address _address) external onlyCEO {\n        GeneScienceInterface candidateContract = GeneScienceInterface(_address);\n\n        // NOTE: verify that a contract is what we expect - https://github.com/Lunyr/crowdsale-contracts/blob/cfadd15986c30521d8ba7d5b6f57b4fefcc7ac38/contracts/LunyrToken.sol#L117\n        require(candidateContract.isGeneScience());\n\n        // Set the new contract address\n        geneScience = candidateContract;", "highlightLines": [792]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 792, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "e492a2bb3ee9", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event Pregnant(address owner, uint256 matronId, uint256 sireId, uint256 cooldownEndBlock);", "highlightLines": [798]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 798, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "2411dcbcc30a", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Pregnant(address owner, uint256 matronId, uint256 sireId, uint256 cooldownEndBlock);", "highlightLines": [798]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 798, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "612c3f5c43f0", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event Abortion(address owner, uint256 matronId, uint256 sireId);", "highlightLines": [800]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 800, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "95c670a07d77", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Abortion(address owner, uint256 matronId, uint256 sireId);", "highlightLines": [800]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 800, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "2993b6be9229", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        GeneScienceInterface candidateContract = GeneScienceInterface(_address);\n\n        // NOTE: verify that a contract is what we expect - https://github.com/Lunyr/crowdsale-contracts/blob/cfadd15986c30521d8ba7d5b6f57b4fefcc7ac38/contracts/LunyrToken.sol#L117\n        require(candidateContract.isGeneScience());\n\n        // Set the new contract address\n        geneScience = candidateContract;", "highlightLines": [816]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 816, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d6643c3d4756", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(candidateContract.isGeneScience());", "highlightLines": [819]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 819, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "293f45b02b14", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        return (_kit.siringWithId == 0) && (_kit.cooldownEndBlock <= uint64(block.number));", "highlightLines": [832]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 832, "column": 70}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "4ea6b0953910", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function _isSiringPermitted(uint256 _sireId, uint256 _matronId) internal view returns(bool) {\n        address matronOwner = pandaIndexToOwner[_matronId];\n        address sireOwner = pandaIndexToOwner[_sireId];", "highlightLines": [838]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 838, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "b9b7c638bab0", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address matronOwner = pandaIndexToOwner[_matronId];", "highlightLines": [839]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 839, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "735e32fbd9a9", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address matronOwner = pandaIndexToOwner[_matronId];\n        address sireOwner = pandaIndexToOwner[_sireId];", "highlightLines": [839]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 839, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "b51ec83f103c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address sireOwner = pandaIndexToOwner[_sireId];", "highlightLines": [840]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 840, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b8c2a2a4a012", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_owns(msg.sender, _sireId));", "highlightLines": [870]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 870, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "e558eea1c18e", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        return (_matron.siringWithId != 0) && (_matron.cooldownEndBlock <= uint64(block.number));", "highlightLines": [884]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 884, "column": 76}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "e969d3634394", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "    function isReadyToBreed(uint256 _pandaId)\n    public\n    view\n    returns(bool) {\n        require(_pandaId > 0);", "highlightLines": [890]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 890, "column": 5}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "dd6a4bfa4b5c", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function isReadyToBreed(uint256 _pandaId)\n    public\n    view\n    returns(bool) {\n        require(_pandaId > 0);\n        Panda storage kit = pandas[_pandaId];", "highlightLines": [890]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 890, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "1cf6907171a2", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_pandaId > 0);", "highlightLines": [894]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 894, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "34f91c41632a", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "    function isPregnant(uint256 _pandaId)\n    public\n    view\n    returns(bool) {\n        require(_pandaId > 0);", "highlightLines": [901]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 901, "column": 5}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "e231ca8ddcc6", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_pandaId > 0);", "highlightLines": [905]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 905, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "f6e089c69744", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function _isValidMatingPair(\n        Panda storage _matron,\n        uint256 _matronId,\n        Panda storage _sire,\n        uint256 _sireId\n    )\n    private\n    view\n    returns(bool) {\n        // A Panda can't breed with itself!\n        if (_matronId == _sireId) {", "highlightLines": [916]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 916, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "7ec9c5e696a1", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function _canBreedWithViaAuction(uint256 _matronId, uint256 _sireId)\n    internal\n    view\n    returns(bool) {\n        Panda storage matron = pandas[_matronId];\n        Panda storage sire = pandas[_sireId];", "highlightLines": [963]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 963, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "f8881173f2e1", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        Panda storage matron = pandas[_matronId];\n        Panda storage sire = pandas[_sireId];", "highlightLines": [967]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 967, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "2671141dbf2c", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "    function canBreedWith(uint256 _matronId, uint256 _sireId)\n    external\n    view\n    returns(bool) {\n        require(_matronId > 0);\n        require(_sireId > 0);", "highlightLines": [978]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 978, "column": 5}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "de9d2b05d5a8", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function canBreedWith(uint256 _matronId, uint256 _sireId)\n    external\n    view\n    returns(bool) {\n        require(_matronId > 0);\n        require(_sireId > 0);\n        Panda storage matron = pandas[_matronId];\n        Panda storage sire = pandas[_sireId];", "highlightLines": [978]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 978, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "6c56f8cfe4fc", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_matronId > 0);", "highlightLines": [982]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 982, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "219d95db05b0", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_sireId > 0);", "highlightLines": [983]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 983, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "dd604bd1443c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        Panda storage matron = pandas[_matronId];\n        Panda storage sire = pandas[_sireId];", "highlightLines": [984]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 984, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "00ddce7860db", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        (_matronId, _sireId) = _exchangeMatronSireId(_matronId, _sireId);\n        // Grab a reference to the Pandas from storage.\n        Panda storage sire = pandas[_sireId];", "highlightLines": [1002]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1002, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "62b8813cd865", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        Panda storage sire = pandas[_sireId];\n        Panda storage matron = pandas[_matronId];", "highlightLines": [1004]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1004, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "8dcff8893722", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        Panda storage matron = pandas[_matronId];\n\n        // Mark the matron as pregnant, keeping track of who the sire is.\n        matron.siringWithId = uint32(_sireId);", "highlightLines": [1005]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1005, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "c88bceb63cfe", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        matron.siringWithId = uint32(_sireId);\n\n        // Trigger the cooldown for both parents.\n        _triggerCooldown(sire);\n        _triggerCooldown(matron);\n\n        // Clear siring permission for both parents. This may not be strictly necessary\n        // but it's likely to avoid confusion!\n        delete sireAllowedToAddress[_matronId];\n        delete sireAllowedToAddress[_sireId];\n\n        // Every time a panda gets pregnant, counter is incremented.\n        pregnantPandas++;\n\n        childOwner[_matronId] = _owner;", "highlightLines": [1008]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1008, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "1b15af08bace", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        matron.siringWithId = uint32(_sireId);", "highlightLines": [1008]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1008, "column": 31}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "318a3b617d7d", "fix": {"template": null, "available": false}, "title": "Deleting mapping inside struct leaves nested data - use separate mapping deletion", "ruleId": "rules.sol-mapping-deletion", "snippet": {"code": "        delete sireAllowedToAddress[_matronId];", "highlightLines": [1016]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1016, "column": 9}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#deletion-on-mapping-containing-a-structure"], "description": ""}, {"id": "04cb4c4b393d", "fix": {"template": null, "available": false}, "title": "delete array[i] leaves gap with zero value - use swap-and-pop pattern instead", "ruleId": "rules.sol-array-element-delete", "snippet": {"code": "        delete sireAllowedToAddress[_matronId];", "highlightLines": [1016]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1016, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/Array-deletion.sol"], "description": ""}, {"id": "a161b0609adb", "fix": {"template": null, "available": false}, "title": "Deleting mapping inside struct leaves nested data - use separate mapping deletion", "ruleId": "rules.sol-mapping-deletion", "snippet": {"code": "        delete sireAllowedToAddress[_sireId];", "highlightLines": [1017]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1017, "column": 9}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#deletion-on-mapping-containing-a-structure"], "description": ""}, {"id": "a175b641787e", "fix": {"template": null, "available": false}, "title": "delete array[i] leaves gap with zero value - use swap-and-pop pattern instead", "ruleId": "rules.sol-array-element-delete", "snippet": {"code": "        delete sireAllowedToAddress[_sireId];", "highlightLines": [1017]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1017, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/Array-deletion.sol"], "description": ""}, {"id": "b9eb78bb74d0", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function breedWithAuto(uint256 _matronId, uint256 _sireId)\n    external\n    payable\n    whenNotPaused {\n        // Checks for payment.\n        require(msg.value >= autoBirthFee);\n\n        // Caller must own the matron.\n        require(_owns(msg.sender, _matronId));\n\n        // Neither sire nor matron are allowed to be on auction during a normal\n        // breeding operation, but we don't need to check that explicitly.\n        // For matron: The caller of this function can't be the owner of the matron\n        //   because the owner of a Panda on auction is the auction house, and the\n        //   auction house will never call breedWith().\n        // For sire: Similarly, a sire on auction will be owned by the auction house\n        //   and the act of transferring ownership will have cleared any oustanding\n        //   siring approval.\n        // Thus we don't need to spend gas explicitly checking to see if either cat\n        // is on auction.\n\n        // Check that matron and sire are both owned by caller, or that the sire\n        // has given siring permission to caller (i.e. matron's owner).\n        // Will fail for _sireId = 0", "highlightLines": [1033]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1033, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "cd06b733fe28", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.value >= autoBirthFee);", "highlightLines": [1038]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1038, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "4cc6945c61c3", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_owns(msg.sender, _matronId));", "highlightLines": [1041]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1041, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "2b21a98e7163", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_isSiringPermitted(_sireId, _matronId));", "highlightLines": [1057]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1057, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "54db993c4e43", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        Panda storage matron = pandas[_matronId];\n\n        // Make sure matron isn't pregnant, or in the middle of a siring cooldown\n        require(_isReadyToBreed(matron));\n\n        // Grab a reference to the potential sire\n        Panda storage sire = pandas[_sireId];", "highlightLines": [1060]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1060, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "3313fc0ccbfd", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_isReadyToBreed(matron));", "highlightLines": [1063]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1063, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "e179ec49aec7", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_isReadyToBreed(sire));", "highlightLines": [1069]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1069, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "f790e4e6cbbf", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_isValidMatingPair(\n            matron,\n            _matronId,\n            sire,\n            _sireId\n        ));", "highlightLines": [1072]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1072, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "607c455af813", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        Panda storage matron = pandas[_matronId];\n\n        // Check that the matron is a valid cat.\n        require(matron.birthTime != 0);\n\n        // Check that the matron is pregnant, and that its time has come!\n        require(_isReadyToGiveBirth(matron));\n\n        // Grab a reference to the sire in storage.\n        uint256 sireId = matron.siringWithId;", "highlightLines": [1097]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1097, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "ad4eaaf7daad", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(matron.birthTime != 0);", "highlightLines": [1100]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1100, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "fa21f76ab751", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_isReadyToGiveBirth(matron));", "highlightLines": [1103]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1103, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "109e00ce686a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 sireId = matron.siringWithId;", "highlightLines": [1106]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1106, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b9003fdb24af", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 sireId = matron.siringWithId;\n        Panda storage sire = pandas[sireId];", "highlightLines": [1106]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1106, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "6bde3ff526cb", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        Panda storage sire = pandas[sireId];\n\n        // Determine the higher generation number of the two parents\n        uint16 parentGen = matron.generation;", "highlightLines": [1107]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1107, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "76bebcf3f9ae", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint16 parentGen = matron.generation;", "highlightLines": [1110]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1110, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4754634995cd", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint16 parentGen = matron.generation;\n        if (sire.generation > matron.generation) {\n            parentGen = sire.generation;\n        }", "highlightLines": [1110]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1110, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "85f2db085c7f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256[2] memory childGenes = _childGenes;\n\n        uint256 kittenId = 0;", "highlightLines": [1117]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1117, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "79ab95ac9f05", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 kittenId = 0;", "highlightLines": [1118]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1118, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "1ecf11c35cdf", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 kittenId = 0;\n\n        // birth failed\n        uint256 probability = (geneScience.getPureFromGene(matron.genes) + geneScience.getPureFromGene(sire.genes)) / 2 + _factors[0];", "highlightLines": [1119]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1119, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "6e834191d938", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 probability = (geneScience.getPureFromGene(matron.genes) + geneScience.getPureFromGene(sire.genes)) / 2 + _factors[0];", "highlightLines": [1122]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1122, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "fb33844e5672", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 probability = (geneScience.getPureFromGene(matron.genes) + geneScience.getPureFromGene(sire.genes)) / 2 + _factors[0];\n        if (probability >= (parentGen + 1) * _factors[1]) {\n            probability = probability - (parentGen + 1) * _factors[1];\n        } else {\n            probability = 0;\n        }", "highlightLines": [1122]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1122, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "1e39ecc9952d", "fix": {"template": null, "available": false}, "title": "blockhash only works for last 256 blocks - older blocks return 0 (PredictTheBlockHash pattern)", "ruleId": "rules.sol-blockhash-256-limit", "snippet": {"code": "        if (uint256(keccak256(block.blockhash(block.number - 2), now)) % 100 < probability) {", "highlightLines": [1131]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1131, "column": 31}, "severity": "medium", "references": ["https://capturetheether.com/challenges/lottery/predict-block-hash/"], "description": ""}, {"id": "e91de8b15117", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - predictable by miners, 0 after 256 blocks", "ruleId": "rules.sol-blockhash-randomness", "snippet": {"code": "        if (uint256(keccak256(block.blockhash(block.number - 2), now)) % 100 < probability) {", "highlightLines": [1131]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1131, "column": 37}, "severity": "high", "references": [], "description": ""}, {"id": "4c0bcbbc4327", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            address owner = childOwner[_matronId];", "highlightLines": [1133]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1133, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "28fc59ceb5db", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "            address owner = childOwner[_matronId];", "highlightLines": [1133]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1133, "column": 13}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "7d863b928cef", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            address owner = childOwner[_matronId];\n            kittenId = _createPanda(_matronId, matron.siringWithId, parentGen + 1, childGenes, owner);", "highlightLines": [1133]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1133, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "15a168c3affc", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "            address owner = childOwner[_matronId];", "highlightLines": [1133]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1133, "column": 21}, "severity": "info", "references": [], "description": ""}, {"id": "4303cf7b0f97", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "        //address owner = pandaIndexToOwner[_matronId];", "highlightLines": [1139]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1139, "column": 11}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "59dc2632af91", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "        //address owner = childOwner[_matronId];", "highlightLines": [1140]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1140, "column": 11}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "c1997040c0e8", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "        msg.sender.send(autoBirthFee);", "highlightLines": [1152]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1152, "column": 9}, "severity": "high", "references": [], "description": ""}, {"id": "f1680299fda8", "fix": {"template": null, "available": false}, "title": "send() return value not checked - Ether may be stuck if recipient reverts", "ruleId": "rules.sol-unchecked-send-return", "snippet": {"code": "        msg.sender.send(autoBirthFee);", "highlightLines": [1152]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1152, "column": 19}, "severity": "high", "references": [], "description": ""}, {"id": "bfc56d62da54", "fix": {"template": null, "available": false}, "title": "State deletion after external call - reentrancy can access deleted state", "ruleId": "rules.sol-reentrancy-state-delete", "snippet": {"code": "        msg.sender.send(autoBirthFee);\n\n        delete childOwner[_matronId];", "highlightLines": [1152]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1152, "column": 19}, "severity": "high", "references": [], "description": ""}, {"id": "d282cf219483", "fix": {"template": null, "available": false}, "title": "Deleting mapping inside struct leaves nested data - use separate mapping deletion", "ruleId": "rules.sol-mapping-deletion", "snippet": {"code": "        delete childOwner[_matronId];", "highlightLines": [1154]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1154, "column": 9}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#deletion-on-mapping-containing-a-structure"], "description": ""}, {"id": "56d0205c3df2", "fix": {"template": null, "available": false}, "title": "delete array[i] leaves gap with zero value - use swap-and-pop pattern instead", "ruleId": "rules.sol-array-element-delete", "snippet": {"code": "        delete childOwner[_matronId];", "highlightLines": [1154]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1154, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/Array-deletion.sol"], "description": ""}, {"id": "8efb7a826f26", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address seller;", "highlightLines": [1173]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1173, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ec28d6828bf5", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint128 startingPrice;", "highlightLines": [1175]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1175, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "af86488efe58", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint128 endingPrice;", "highlightLines": [1177]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1177, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "6b9f4e078f32", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint64 duration;", "highlightLines": [1179]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1179, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "445c2b61d2f1", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint64 startedAt;", "highlightLines": [1182]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1182, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "67ef3a0436a3", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint64 isGen0;", "highlightLines": [1184]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1184, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c53357b4ded8", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event AuctionCreated(uint256 tokenId, uint256 startingPrice, uint256 endingPrice, uint256 duration);", "highlightLines": [1197]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1197, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "383159fddc09", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event AuctionSuccessful(uint256 tokenId, uint256 totalPrice, address winner);", "highlightLines": [1198]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1198, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "539d7d7dc309", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event AuctionCancelled(uint256 tokenId);", "highlightLines": [1199]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1199, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "afcbedc938e6", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function _owns(address _claimant, uint256 _tokenId) internal view returns (bool) {", "highlightLines": [1204]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1204, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "85a99adc91ec", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function _escrow(address _owner, uint256 _tokenId) internal {", "highlightLines": [1212]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1212, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "bd48844de668", "fix": {"template": null, "available": false}, "title": "Token transfer without checking actual received amount - deflationary tokens may transfer less", "ruleId": "rules.sol-deflationary-token-transfer", "snippet": {"code": "        nonFungibleContract.transferFrom(_owner, this, _tokenId);", "highlightLines": [1214]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1214, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "898083c05b76", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        nonFungibleContract.transferFrom(_owner, this, _tokenId);", "highlightLines": [1214]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1214, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "c83cae25037c", "fix": {"template": null, "available": false}, "title": "Token amount after transfer may differ - check actual received amount", "ruleId": "rules.sol-fee-on-transfer-token", "snippet": {"code": "        nonFungibleContract.transferFrom(_owner, this, _tokenId);", "highlightLines": [1214]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1214, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "87415d17fa41", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function _transfer(address _receiver, uint256 _tokenId) internal {", "highlightLines": [1221]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1221, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "d6b7671b2102", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        nonFungibleContract.transfer(_receiver, _tokenId);", "highlightLines": [1223]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1223, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "7bb272671483", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "        nonFungibleContract.transfer(_receiver, _tokenId);", "highlightLines": [1223]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1223, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "818d2900c782", "fix": {"template": null, "available": false}, "title": "ERC20 transfer() return value not checked - tokens like USDT don't return bool", "ruleId": "rules.sol-erc20-transfer-no-return-check", "snippet": {"code": "        nonFungibleContract.transfer(_receiver, _tokenId);", "highlightLines": [1223]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1223, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d8be7a5e0c2b", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function _addAuction(uint256 _tokenId, Auction _auction) internal {", "highlightLines": [1230]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1230, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "f43ca5d727fc", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_auction.duration >= 1 minutes);", "highlightLines": [1233]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1233, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "40e7b2db9d47", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function _cancelAuction(uint256 _tokenId, address _seller) internal {", "highlightLines": [1246]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1246, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "eb0c6727891e", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function _bid(uint256 _tokenId, uint256 _bidAmount)\n        internal\n        returns (uint256)\n    {", "highlightLines": [1254]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1254, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "410d1e54796e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        Auction storage auction = tokenIdToAuction[_tokenId];\n\n        // Explicitly check that this auction is currently live.\n        // (Because of how Ethereum mappings work, we can't just count\n        // on the lookup above failing. An invalid _tokenId will just\n        // return an auction object that is all zeros.)\n        require(_isOnAuction(auction));\n\n        // Check that the bid is greater than or equal to the current price\n        uint256 price = _currentPrice(auction);", "highlightLines": [1259]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1259, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "f68d321869fe", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_isOnAuction(auction));", "highlightLines": [1265]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1265, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "14784627bcc4", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 price = _currentPrice(auction);", "highlightLines": [1268]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1268, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "338e21c9360b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 price = _currentPrice(auction);\n        require(_bidAmount >= price);\n\n        // Grab a reference to the seller before the auction struct\n        // gets deleted.\n        address seller = auction.seller;", "highlightLines": [1268]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1268, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "82cedab1d512", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_bidAmount >= price);", "highlightLines": [1269]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1269, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "9c9fb7821869", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address seller = auction.seller;", "highlightLines": [1273]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1273, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "07210e897928", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address seller = auction.seller;\n\n        // The bid is good! Remove the auction before sending the fees\n        // to the sender so we can't have a reentrancy attack.\n        _removeAuction(_tokenId);\n\n        // Transfer proceeds to seller (if there are any!)\n        if (price > 0) {\n            // Calculate the auctioneer's cut.\n            // (NOTE: _computeCut() is guaranteed to return a\n            // value <= price, so this subtraction can't go negative.)\n            uint256 auctioneerCut = _computeCut(price);\n            uint256 sellerProceeds = price - auctioneerCut;\n\n            // NOTE: Doing a transfer() in the middle of a complex\n            // method like this is generally discouraged because of\n            // reentrancy attacks and DoS attacks if the seller is\n            // a contract with an invalid fallback function. We explicitly\n            // guard against reentrancy attacks by removing the auction\n            // before calling transfer(), and the only thing the seller\n            // can DoS is the sale of their own asset! (And if it's an\n            // accident, they can call cancelAuction(). )\n            seller.transfer(sellerProceeds);\n        }", "highlightLines": [1273]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1273, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "aa2a670c03eb", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "            // (NOTE: _computeCut() is guaranteed to return a\n            // value <= price, so this subtraction can't go negative.)\n            uint256 auctioneerCut = _computeCut(price);\n            uint256 sellerProceeds = price - auctioneerCut;", "highlightLines": [1282]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1282, "column": 54}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "f6864f166780", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint256 auctioneerCut = _computeCut(price);", "highlightLines": [1284]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1284, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "2c8476bbc0bb", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            uint256 auctioneerCut = _computeCut(price);\n            uint256 sellerProceeds = price - auctioneerCut;", "highlightLines": [1284]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1284, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "dcfcf71d92dd", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint256 sellerProceeds = price - auctioneerCut;", "highlightLines": [1285]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1285, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0aff11497ba4", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "            seller.transfer(sellerProceeds);", "highlightLines": [1295]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1295, "column": 13}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "c11434a8d814", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 bidExcess = _bidAmount - price;", "highlightLines": [1302]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1302, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "31804212417c", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        msg.sender.transfer(bidExcess);", "highlightLines": [1307]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1307, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "6b8bc2f8ce52", "fix": {"template": null, "available": false}, "title": "ERC20 transfer() return value not checked - tokens like USDT don't return bool", "ruleId": "rules.sol-erc20-transfer-no-return-check", "snippet": {"code": "        msg.sender.transfer(bidExcess);\n\n        // Tell the world!\n        AuctionSuccessful(_tokenId, price, msg.sender);", "highlightLines": [1307]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1307, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "7e13abacde77", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function _removeAuction(uint256 _tokenId) internal {", "highlightLines": [1319]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1319, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "a1dac40d3e38", "fix": {"template": null, "available": false}, "title": "Deleting mapping inside struct leaves nested data - use separate mapping deletion", "ruleId": "rules.sol-mapping-deletion", "snippet": {"code": "        delete tokenIdToAuction[_tokenId];", "highlightLines": [1320]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1320, "column": 9}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#deletion-on-mapping-containing-a-structure"], "description": ""}, {"id": "43804ec3c59a", "fix": {"template": null, "available": false}, "title": "delete array[i] leaves gap with zero value - use swap-and-pop pattern instead", "ruleId": "rules.sol-array-element-delete", "snippet": {"code": "        delete tokenIdToAuction[_tokenId];", "highlightLines": [1320]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1320, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/Array-deletion.sol"], "description": ""}, {"id": "3858d234b3f8", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function _currentPrice(Auction storage _auction)\n        internal\n        view\n        returns (uint256)\n    {\n        uint256 secondsPassed = 0;\n\n        // A bit of insurance against negative values (or wraparound).\n        // Probably not necessary (since Ethereum guarnatees that the\n        // now variable doesn't ever go backwards).\n        if (now > _auction.startedAt) {\n            secondsPassed = now - _auction.startedAt;", "highlightLines": [1333]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1333, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "54d02f5b9697", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 secondsPassed = 0;", "highlightLines": [1338]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1338, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b01dff6ad620", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 secondsPassed = 0;\n\n        // A bit of insurance against negative values (or wraparound).\n        // Probably not necessary (since Ethereum guarnatees that the\n        // now variable doesn't ever go backwards).\n        if (now > _auction.startedAt) {\n            secondsPassed = now - _auction.startedAt;\n        }", "highlightLines": [1338]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1338, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "f7edfad6e9b9", "fix": {"template": null, "available": false}, "title": "Block timestamp used for critical logic - miners can manipulate within ~15 second window", "ruleId": "rules.sol-block-timestamp-manipulation", "snippet": {"code": "        if (now > _auction.startedAt) {", "highlightLines": [1343]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1343, "column": 13}, "severity": "medium", "references": ["https://consensys.github.io/smart-contract-best-practices/development-recommendations/solidity-specific/timestamp-dependence/"], "description": ""}, {"id": "6ada1e7d15d3", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            int256 totalPriceChange = int256(_endingPrice) - int256(_startingPrice);", "highlightLines": [1381]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1381, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "843728f556b1", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "            int256 totalPriceChange = int256(_endingPrice) - int256(_startingPrice);", "highlightLines": [1381]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1381, "column": 13}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "657ce581ec31", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            int256 totalPriceChange = int256(_endingPrice) - int256(_startingPrice);\n\n            // This multiplication can't overflow, _secondsPassed will easily fit within\n            // 64-bits, and totalPriceChange will easily fit within 128-bits, their product\n            // will always fit within 256-bits.\n            int256 currentPriceChange = totalPriceChange * int256(_secondsPassed) / int256(_duration);", "highlightLines": [1381]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1381, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "6d2f74bd9dad", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            int256 currentPriceChange = totalPriceChange * int256(_secondsPassed) / int256(_duration);", "highlightLines": [1386]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1386, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "81dd43442b1e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            int256 currentPriceChange = totalPriceChange * int256(_secondsPassed) / int256(_duration);\n\n            // currentPriceChange can be negative, but if so, will have a magnitude\n            // less that _startingPrice. Thus, this result will always end up positive.\n            int256 currentPrice = int256(_startingPrice) + currentPriceChange;", "highlightLines": [1386]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1386, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "912f247d8aa2", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            int256 currentPrice = int256(_startingPrice) + currentPriceChange;", "highlightLines": [1390]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1390, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "aa2fb040fe90", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract Pausable is Ownable {\n  event Pause();\n  event Unpause();\n\n  bool public paused = false;", "highlightLines": [1416]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1416, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "5aabe22ff080", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  modifier whenNotPaused() {\n    require(!paused);\n    _;\n  }", "highlightLines": [1426]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1426, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "8559a8a8c2a0", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(!paused);", "highlightLines": [1427]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1427, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "e42de7d11280", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    _;", "highlightLines": [1428]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1428, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "00b09ede9298", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  modifier whenPaused {\n    require(paused);\n    _;\n  }", "highlightLines": [1434]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1434, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "8f3a59a30330", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(paused);", "highlightLines": [1435]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1435, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "324ccd71ff88", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    _;", "highlightLines": [1436]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1436, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "b0241d402c5f", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function pause() onlyOwner whenNotPaused returns (bool) {\n    paused = true;\n    Pause();\n    return true;\n  }", "highlightLines": [1442]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1442, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "33c9346be2bd", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "  function pause() onlyOwner whenNotPaused returns (bool) {", "highlightLines": [1442]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1442, "column": 20}, "severity": "info", "references": [], "description": ""}, {"id": "0085ddf06c60", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "  function unpause() onlyOwner whenPaused returns (bool) {\n    paused = false;\n    Unpause();\n    return true;\n  }", "highlightLines": [1451]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1451, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "6519e60ee028", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "  function unpause() onlyOwner whenPaused returns (bool) {", "highlightLines": [1451]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1451, "column": 22}, "severity": "info", "references": [], "description": ""}, {"id": "8449a9050a40", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_cut <= 10000);", "highlightLines": [1475]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1475, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "dfe275282f70", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        ownerCut = _cut;\n\n        ERC721 candidateContract = ERC721(_nftAddress);", "highlightLines": [1476]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1476, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "4d8cff5b897f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        ERC721 candidateContract = ERC721(_nftAddress);\n        require(candidateContract.supportsInterface(InterfaceSignature_ERC721));\n        nonFungibleContract = candidateContract;", "highlightLines": [1478]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1478, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "81e98561360b", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(candidateContract.supportsInterface(InterfaceSignature_ERC721));", "highlightLines": [1479]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1479, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "9a48ac678f62", "fix": {"template": null, "available": false}, "title": "SWC-105: Ether withdrawal without access control - anyone can drain funds", "ruleId": "rules.sol-swc-105-unprotected-withdrawal", "snippet": {"code": "    function withdrawBalance() external {\n        address nftAddress = address(nonFungibleContract);\n\n        require(\n            msg.sender == owner ||\n            msg.sender == nftAddress\n        );\n        // We are using this boolean method to make sure that even if one fails it will still work\n        // <yes> <report> UNCHECKED_LL_CALLS\n        bool res = nftAddress.send(this.balance);", "highlightLines": [1487]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1487, "column": 5}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-105"], "description": ""}, {"id": "3d3d91a78713", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address nftAddress = address(nonFungibleContract);", "highlightLines": [1488]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1488, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "227c313b85b2", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address nftAddress = address(nonFungibleContract);\n\n        require(\n            msg.sender == owner ||\n            msg.sender == nftAddress\n        );\n        // We are using this boolean method to make sure that even if one fails it will still work\n        // <yes> <report> UNCHECKED_LL_CALLS\n        bool res = nftAddress.send(this.balance);", "highlightLines": [1488]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1488, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "8b439c7685d7", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(\n            msg.sender == owner ||\n            msg.sender == nftAddress\n        );", "highlightLines": [1490]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1490, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "1bb09e82a24a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool res = nftAddress.send(this.balance);", "highlightLines": [1496]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1496, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "6e77ba33887f", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "        bool res = nftAddress.send(this.balance);", "highlightLines": [1496]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1496, "column": 20}, "severity": "high", "references": [], "description": ""}, {"id": "7dc7c4f95c24", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "        bool res = nftAddress.send(this.balance);", "highlightLines": [1496]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1496, "column": 30}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "935351192f9c", "fix": {"template": null, "available": false}, "title": "send() return value not checked - Ether may be stuck if recipient reverts", "ruleId": "rules.sol-unchecked-send-return", "snippet": {"code": "        bool res = nftAddress.send(this.balance);", "highlightLines": [1496]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1496, "column": 30}, "severity": "high", "references": [], "description": ""}, {"id": "b5fdced3ffcb", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function createAuction(\n        uint256 _tokenId,\n        uint256 _startingPrice,\n        uint256 _endingPrice,\n        uint256 _duration,\n        address _seller\n    )\n        external\n        whenNotPaused\n    {", "highlightLines": [1506]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1506, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "c7d321ba32da", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function createAuction(\n        uint256 _tokenId,\n        uint256 _startingPrice,\n        uint256 _endingPrice,\n        uint256 _duration,\n        address _seller\n    )\n        external\n        whenNotPaused\n    {\n        // Sanity check that no inputs overflow how many bits we've allocated\n        // to store them in the auction struct.\n        require(_startingPrice == uint256(uint128(_startingPrice)));\n        require(_endingPrice == uint256(uint128(_endingPrice)));\n        require(_duration == uint256(uint64(_duration)));", "highlightLines": [1506]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1506, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "6ed78bfd2e88", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_startingPrice == uint256(uint128(_startingPrice)));", "highlightLines": [1518]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1518, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "42f8c8ad4bef", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        require(_startingPrice == uint256(uint128(_startingPrice)));", "highlightLines": [1518]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1518, "column": 43}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "07cdcedf8b69", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_endingPrice == uint256(uint128(_endingPrice)));", "highlightLines": [1519]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1519, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "68b49ffe2594", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        require(_endingPrice == uint256(uint128(_endingPrice)));", "highlightLines": [1519]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1519, "column": 41}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "06e17d2c9e51", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_duration == uint256(uint64(_duration)));", "highlightLines": [1520]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1520, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "89de4f1cd7fa", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        require(_duration == uint256(uint64(_duration)));", "highlightLines": [1520]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1520, "column": 38}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "4154e3a9b408", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_owns(msg.sender, _tokenId));", "highlightLines": [1522]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1522, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "71ef9795b8f2", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "            uint128(_startingPrice),", "highlightLines": [1526]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1526, "column": 13}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "d6dd931b4807", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "            uint128(_endingPrice),", "highlightLines": [1527]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1527, "column": 13}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "dc4bc036505f", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "            uint64(_duration),", "highlightLines": [1528]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1528, "column": 13}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "cbf27f31e9d3", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "            uint64(now),", "highlightLines": [1529]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1529, "column": 13}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "4b3cfacf7d37", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function bid(uint256 _tokenId)\n        external\n        payable\n        whenNotPaused\n    {", "highlightLines": [1538]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1538, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "731921744e7c", "fix": {"template": null, "available": false}, "title": "SWC-114: Transaction order dependence - vulnerable to front-running/sandwich attacks", "ruleId": "rules.sol-swc-114-front-running", "snippet": {"code": "    function bid(uint256 _tokenId)\n        external\n        payable\n        whenNotPaused\n    {\n        // _bid will throw if the bid or funds transfer fails\n        _bid(_tokenId, msg.value);", "highlightLines": [1538]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1538, "column": 5}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-114"], "description": ""}, {"id": "c9534e78e60f", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function cancelAuction(uint256 _tokenId)\n        external\n    {", "highlightLines": [1553]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1553, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "9092d7c37c91", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        Auction storage auction = tokenIdToAuction[_tokenId];\n        require(_isOnAuction(auction));\n        address seller = auction.seller;", "highlightLines": [1556]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1556, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "71aac7d8a18e", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_isOnAuction(auction));", "highlightLines": [1557]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1557, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "58bc5f896994", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address seller = auction.seller;", "highlightLines": [1558]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1558, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e21b57510572", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender == seller);", "highlightLines": [1559]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1559, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "5d2d653e8398", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function cancelAuctionWhenPaused(uint256 _tokenId)\n        whenPaused\n        onlyOwner\n        external\n    {", "highlightLines": [1567]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1567, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "56c86b0c0527", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "        onlyOwner", "highlightLines": [1569]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1569, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "a586d52def8e", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_isOnAuction(auction));", "highlightLines": [1573]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1573, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "a72b0a697f43", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function getAuction(uint256 _tokenId)\n        external\n        view\n        returns\n    (\n        address seller,\n        uint256 startingPrice,\n        uint256 endingPrice,\n        uint256 duration,\n        uint256 startedAt\n    ) {", "highlightLines": [1579]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1579, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "1172d3ca3926", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function getAuction(uint256 _tokenId)\n        external\n        view\n        returns\n    (\n        address seller,\n        uint256 startingPrice,\n        uint256 endingPrice,\n        uint256 duration,\n        uint256 startedAt\n    ) {\n        Auction storage auction = tokenIdToAuction[_tokenId];", "highlightLines": [1579]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1579, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "eafc9b109219", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_isOnAuction(auction));", "highlightLines": [1591]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1591, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "8fc6fc580d5d", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function getCurrentPrice(uint256 _tokenId)\n        external\n        view\n        returns (uint256)\n    {", "highlightLines": [1603]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1603, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "d86796f8b6d0", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function getCurrentPrice(uint256 _tokenId)\n        external\n        view\n        returns (uint256)\n    {\n        Auction storage auction = tokenIdToAuction[_tokenId];", "highlightLines": [1603]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1603, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "0a6bb7362d50", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_isOnAuction(auction));", "highlightLines": [1609]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1609, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "203a2e1dbc81", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract SiringClockAuction is ClockAuction {\n\n    // @dev Sanity check that allows us to ensure that we are pointing to the\n    //  right auction in our setSiringAuctionAddress() call.\n    bool public isSiringClockAuction = true;", "highlightLines": [1620]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1620, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "258432502544", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function createAuction(\n        uint256 _tokenId,\n        uint256 _startingPrice,\n        uint256 _endingPrice,\n        uint256 _duration,\n        address _seller\n    )\n        external\n    {", "highlightLines": [1637]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1637, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "858638e12fe0", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function createAuction(\n        uint256 _tokenId,\n        uint256 _startingPrice,\n        uint256 _endingPrice,\n        uint256 _duration,\n        address _seller\n    )\n        external\n    {\n        // Sanity check that no inputs overflow how many bits we've allocated\n        // to store them in the auction struct.\n        require(_startingPrice == uint256(uint128(_startingPrice)));\n        require(_endingPrice == uint256(uint128(_endingPrice)));\n        require(_duration == uint256(uint64(_duration)));", "highlightLines": [1637]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1637, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "01ee48ecb477", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_startingPrice == uint256(uint128(_startingPrice)));", "highlightLines": [1648]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1648, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "6bcc4fa3c442", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        require(_startingPrice == uint256(uint128(_startingPrice)));", "highlightLines": [1648]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1648, "column": 43}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "98bc5b7613c9", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_endingPrice == uint256(uint128(_endingPrice)));", "highlightLines": [1649]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1649, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "593e42728f74", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        require(_endingPrice == uint256(uint128(_endingPrice)));", "highlightLines": [1649]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1649, "column": 41}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "33826491741f", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_duration == uint256(uint64(_duration)));", "highlightLines": [1650]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1650, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "08ddb1d694b8", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        require(_duration == uint256(uint64(_duration)));", "highlightLines": [1650]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1650, "column": 38}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "cc46047d4081", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender == address(nonFungibleContract));", "highlightLines": [1652]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1652, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "d51e8d9edbbc", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "            uint128(_startingPrice),", "highlightLines": [1656]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1656, "column": 13}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "a147e6c93c49", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "            uint128(_endingPrice),", "highlightLines": [1657]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1657, "column": 13}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "f1da839064fa", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "            uint64(_duration),", "highlightLines": [1658]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1658, "column": 13}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "fc199d3c8d0c", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "            uint64(now),", "highlightLines": [1659]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1659, "column": 13}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "beafc939ce69", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function bid(uint256 _tokenId)\n        external\n        payable\n    {", "highlightLines": [1669]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1669, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "d24ac9318eb1", "fix": {"template": null, "available": false}, "title": "SWC-114: Transaction order dependence - vulnerable to front-running/sandwich attacks", "ruleId": "rules.sol-swc-114-front-running", "snippet": {"code": "    function bid(uint256 _tokenId)\n        external\n        payable\n    {\n        require(msg.sender == address(nonFungibleContract));\n        address seller = tokenIdToAuction[_tokenId].seller;\n        // _bid checks that token ID is valid and will throw if bid fails\n        _bid(_tokenId, msg.value);", "highlightLines": [1669]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1669, "column": 5}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-114"], "description": ""}, {"id": "825b8e62587d", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender == address(nonFungibleContract));", "highlightLines": [1673]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1673, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "d0af938ecd5b", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address seller = tokenIdToAuction[_tokenId].seller;", "highlightLines": [1674]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1674, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "db81d342a541", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract SaleClockAuction is ClockAuction {\n\n    // @dev Sanity check that allows us to ensure that we are pointing to the\n    //  right auction in our setSaleAuctionAddress() call.\n    bool public isSaleClockAuction = true;\n\n    // Tracks last 5 sale price of gen0 panda sales\n    uint256 public gen0SaleCount;\n    uint256[5] public lastGen0SalePrices;\n    uint256 public constant SurpriseValue = 10 finney;\n\n    uint256[] CommonPanda;\n    uint256[] RarePanda;\n    uint256   CommonPandaIndex;\n    uint256   RarePandaIndex;", "highlightLines": [1689]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1689, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "73dc916af901", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256   CommonPandaIndex;", "highlightLines": [1702]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1702, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "009ab484329e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256   RarePandaIndex;", "highlightLines": [1703]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1703, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b860ebfd420f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            CommonPandaIndex = 1;\n            RarePandaIndex   = 1;", "highlightLines": [1708]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1708, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "b2159643dabe", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function createAuction(\n        uint256 _tokenId,\n        uint256 _startingPrice,\n        uint256 _endingPrice,\n        uint256 _duration,\n        address _seller\n    )\n        external\n    {", "highlightLines": [1718]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1718, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "e5d07b95c35a", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function createAuction(\n        uint256 _tokenId,\n        uint256 _startingPrice,\n        uint256 _endingPrice,\n        uint256 _duration,\n        address _seller\n    )\n        external\n    {\n        // Sanity check that no inputs overflow how many bits we've allocated\n        // to store them in the auction struct.\n        require(_startingPrice == uint256(uint128(_startingPrice)));\n        require(_endingPrice == uint256(uint128(_endingPrice)));\n        require(_duration == uint256(uint64(_duration)));", "highlightLines": [1718]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1718, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "8effbe1a2a9b", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_startingPrice == uint256(uint128(_startingPrice)));", "highlightLines": [1729]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1729, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "d3c5909eb0a9", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        require(_startingPrice == uint256(uint128(_startingPrice)));", "highlightLines": [1729]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1729, "column": 43}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "73d53a0d8bfe", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_endingPrice == uint256(uint128(_endingPrice)));", "highlightLines": [1730]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1730, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "d035223c7e83", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        require(_endingPrice == uint256(uint128(_endingPrice)));", "highlightLines": [1730]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1730, "column": 41}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "0e8128451758", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_duration == uint256(uint64(_duration)));", "highlightLines": [1731]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1731, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "337e31db5949", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        require(_duration == uint256(uint64(_duration)));", "highlightLines": [1731]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1731, "column": 38}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "f86c0e6c7969", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender == address(nonFungibleContract));", "highlightLines": [1733]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1733, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "291f60244a7e", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "            uint128(_startingPrice),", "highlightLines": [1737]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1737, "column": 13}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "fba1309fc524", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "            uint128(_endingPrice),", "highlightLines": [1738]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1738, "column": 13}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "6b87b4ba1602", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "            uint64(_duration),", "highlightLines": [1739]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1739, "column": 13}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "02c453755d51", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "            uint64(now),", "highlightLines": [1740]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1740, "column": 13}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "c2f3f937fd0d", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function createGen0Auction(\n        uint256 _tokenId,\n        uint256 _startingPrice,\n        uint256 _endingPrice,\n        uint256 _duration,\n        address _seller\n    )\n        external\n    {", "highlightLines": [1746]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1746, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "2279a389cbaf", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function createGen0Auction(\n        uint256 _tokenId,\n        uint256 _startingPrice,\n        uint256 _endingPrice,\n        uint256 _duration,\n        address _seller\n    )\n        external\n    {\n        // Sanity check that no inputs overflow how many bits we've allocated\n        // to store them in the auction struct.\n        require(_startingPrice == uint256(uint128(_startingPrice)));\n        require(_endingPrice == uint256(uint128(_endingPrice)));\n        require(_duration == uint256(uint64(_duration)));", "highlightLines": [1746]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1746, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "e439c548d728", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_startingPrice == uint256(uint128(_startingPrice)));", "highlightLines": [1757]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1757, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "4a87707b3052", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        require(_startingPrice == uint256(uint128(_startingPrice)));", "highlightLines": [1757]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1757, "column": 43}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "9897e9a4e580", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_endingPrice == uint256(uint128(_endingPrice)));", "highlightLines": [1758]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1758, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "f79732b82a2e", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        require(_endingPrice == uint256(uint128(_endingPrice)));", "highlightLines": [1758]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1758, "column": 41}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "acdd8c4ec0c1", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_duration == uint256(uint64(_duration)));", "highlightLines": [1759]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1759, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "982d64b10b84", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        require(_duration == uint256(uint64(_duration)));", "highlightLines": [1759]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1759, "column": 38}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "6465fb3848d5", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender == address(nonFungibleContract));", "highlightLines": [1761]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1761, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "3e73714b6879", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "            uint128(_startingPrice),", "highlightLines": [1765]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1765, "column": 13}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "d95d386d5e00", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "            uint128(_endingPrice),", "highlightLines": [1766]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1766, "column": 13}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "50884b8e7ccb", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "            uint64(_duration),", "highlightLines": [1767]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1767, "column": 13}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "9a6f07975f2c", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "            uint64(now),", "highlightLines": [1768]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1768, "column": 13}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "9eb50fc944f0", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function bid(uint256 _tokenId)\n        external\n        payable\n    {", "highlightLines": [1776]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1776, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "56c12fe35129", "fix": {"template": null, "available": false}, "title": "SWC-114: Transaction order dependence - vulnerable to front-running/sandwich attacks", "ruleId": "rules.sol-swc-114-front-running", "snippet": {"code": "    function bid(uint256 _tokenId)\n        external\n        payable\n    {\n        // _bid verifies token ID size\n        uint64 isGen0 = tokenIdToAuction[_tokenId].isGen0;\n        uint256 price = _bid(_tokenId, msg.value);", "highlightLines": [1776]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1776, "column": 5}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-114"], "description": ""}, {"id": "499b81bd2ca9", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint64 isGen0 = tokenIdToAuction[_tokenId].isGen0;", "highlightLines": [1781]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1781, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "81cbee236546", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint64 isGen0 = tokenIdToAuction[_tokenId].isGen0;\n        uint256 price = _bid(_tokenId, msg.value);", "highlightLines": [1781]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1781, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "5a0690ec881d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 price = _bid(_tokenId, msg.value);", "highlightLines": [1782]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1782, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "9e1cf09f1134", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 price = _bid(_tokenId, msg.value);\n        _transfer(msg.sender, _tokenId);\n\n        // If not a gen0 auction, exit\n        if (isGen0 == 1) {\n            // Track gen0 sale prices\n            lastGen0SalePrices[gen0SaleCount % 5] = price;\n            gen0SaleCount++;\n        }", "highlightLines": [1782]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1782, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "18a5f89e5758", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function createPanda(uint256 _tokenId,uint256 _type)\n        external\n    {", "highlightLines": [1793]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1793, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "227f3654aee6", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function createPanda(uint256 _tokenId,uint256 _type)\n        external\n    {\n        require(msg.sender == address(nonFungibleContract));\n        if (_type == 0) {", "highlightLines": [1793]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1793, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "10cd908e5dc0", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender == address(nonFungibleContract));", "highlightLines": [1796]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1796, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "8d33b0b5c488", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "        if (_type == 0) {\n            CommonPanda.push(_tokenId);\n        }else {\n            RarePanda.push(_tokenId);\n        }", "highlightLines": [1797]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1797, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "b205b421c662", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 bHash = keccak256(block.blockhash(block.number),block.blockhash(block.number-1));", "highlightLines": [1808]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1808, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0bd509ba28c8", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes32 bHash = keccak256(block.blockhash(block.number),block.blockhash(block.number-1));\n        uint256 PandaIndex;\n        if (bHash[25] > 0xC8) {\n            require(uint256(RarePanda.length) >= RarePandaIndex);\n            PandaIndex = RarePandaIndex;\n            RarePandaIndex ++;\n\n        } else{\n            require(uint256(CommonPanda.length) >= CommonPandaIndex);\n            PandaIndex = CommonPandaIndex;\n            CommonPandaIndex ++;\n        }", "highlightLines": [1808]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1808, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "ca54bfbb6366", "fix": {"template": null, "available": false}, "title": "blockhash only works for last 256 blocks - older blocks return 0 (PredictTheBlockHash pattern)", "ruleId": "rules.sol-blockhash-256-limit", "snippet": {"code": "        bytes32 bHash = keccak256(block.blockhash(block.number),block.blockhash(block.number-1));", "highlightLines": [1808]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1808, "column": 35}, "severity": "medium", "references": ["https://capturetheether.com/challenges/lottery/predict-block-hash/"], "description": ""}, {"id": "670b10c0d4da", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - predictable by miners, 0 after 256 blocks", "ruleId": "rules.sol-blockhash-randomness", "snippet": {"code": "        bytes32 bHash = keccak256(block.blockhash(block.number),block.blockhash(block.number-1));", "highlightLines": [1808]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1808, "column": 41}, "severity": "high", "references": [], "description": ""}, {"id": "4e72cd09c58c", "fix": {"template": null, "available": false}, "title": "blockhash(block.number - 1) used for randomness - miners can manipulate", "ruleId": "rules.sol-blockhash-previous-block", "snippet": {"code": "        bytes32 bHash = keccak256(block.blockhash(block.number),block.blockhash(block.number-1));", "highlightLines": [1808]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1808, "column": 71}, "severity": "medium", "references": [], "description": ""}, {"id": "82cc8f3a4356", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 PandaIndex;", "highlightLines": [1809]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1809, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c24b85f75fcf", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "            require(uint256(RarePanda.length) >= RarePandaIndex);", "highlightLines": [1811]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1811, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "8ca8b55f0d16", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "            require(uint256(CommonPanda.length) >= CommonPandaIndex);", "highlightLines": [1816]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1816, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "908a3e91867b", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function packageCount() external view returns(uint256 common,uint256 surprise) {\n        common   = CommonPanda.length + 1 - CommonPandaIndex;\n        surprise = RarePanda.length + 1 - RarePandaIndex;", "highlightLines": [1823]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1823, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "a25323d39cbb", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        common   = CommonPanda.length + 1 - CommonPandaIndex;\n        surprise = RarePanda.length + 1 - RarePandaIndex;", "highlightLines": [1824]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1824, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "b06aa8c9f1e1", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function averageGen0SalePrice() external view returns (uint256) {\n        uint256 sum = 0;\n        for (uint256 i = 0; i < 5; i++) {", "highlightLines": [1828]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1828, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "40107a8fe386", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 sum = 0;", "highlightLines": [1829]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1829, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "cbbd97d76033", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract SaleClockAuctionERC20 is ClockAuction {\n\n\n    event AuctionERC20Created(uint256 tokenId, uint256 startingPrice, uint256 endingPrice, uint256 duration, address erc20Contract);\n\n    // @dev Sanity check that allows us to ensure that we are pointing to the\n    //  right auction in our setSaleAuctionAddress() call.\n    bool public isSaleClockAuctionERC20 = true;", "highlightLines": [1842]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1842, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "5f6b3108eaf6", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event AuctionERC20Created(uint256 tokenId, uint256 startingPrice, uint256 endingPrice, uint256 duration, address erc20Contract);", "highlightLines": [1845]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1845, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "34d35189fcd0", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require (msg.sender == address(nonFungibleContract));", "highlightLines": [1862]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1862, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "27d71e446768", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require (_erc20address != address(0));", "highlightLines": [1864]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1864, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "5653a53c95ca", "fix": {"template": null, "available": false}, "title": "Oracle price update without deviation check - prices can change arbitrarily (Compromised pattern)", "ruleId": "rules.sol-oracle-no-price-deviation-check", "snippet": {"code": "        erc20ContractsSwitcher[_erc20address] = _onoff;", "highlightLines": [1866]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1866, "column": 9}, "severity": "medium", "references": ["https://www.damnvulnerabledefi.xyz/challenges/compromised/"], "description": ""}, {"id": "7a103444a566", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function createAuction(\n        uint256 _tokenId,\n        address _erc20Address,\n        uint256 _startingPrice,\n        uint256 _endingPrice,\n        uint256 _duration,\n        address _seller\n    )\n        external\n    {", "highlightLines": [1874]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1874, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "3c182e901805", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function createAuction(\n        uint256 _tokenId,\n        address _erc20Address,\n        uint256 _startingPrice,\n        uint256 _endingPrice,\n        uint256 _duration,\n        address _seller\n    )\n        external\n    {\n        // Sanity check that no inputs overflow how many bits we've allocated\n        // to store them in the auction struct.\n        require(_startingPrice == uint256(uint128(_startingPrice)));\n        require(_endingPrice == uint256(uint128(_endingPrice)));\n        require(_duration == uint256(uint64(_duration)));", "highlightLines": [1874]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1874, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "329ded997955", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_startingPrice == uint256(uint128(_startingPrice)));", "highlightLines": [1886]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1886, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "fcba941c11fa", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        require(_startingPrice == uint256(uint128(_startingPrice)));", "highlightLines": [1886]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1886, "column": 43}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "8e2ea2661a43", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_endingPrice == uint256(uint128(_endingPrice)));", "highlightLines": [1887]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1887, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "e3adffde6ca4", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        require(_endingPrice == uint256(uint128(_endingPrice)));", "highlightLines": [1887]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1887, "column": 41}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "6d955141b654", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_duration == uint256(uint64(_duration)));", "highlightLines": [1888]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1888, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "3fe4e6c59a09", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        require(_duration == uint256(uint64(_duration)));", "highlightLines": [1888]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1888, "column": 38}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "7b33ddf84edf", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender == address(nonFungibleContract));", "highlightLines": [1890]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1890, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "c7ca316a55ae", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require (erc20ContractsSwitcher[_erc20Address] > 0);", "highlightLines": [1892]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1892, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "eba7f1f308e4", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        Auction memory auction = Auction(\n            _seller,\n            uint128(_startingPrice),\n            uint128(_endingPrice),\n            uint64(_duration),\n            uint64(now),\n            0\n        );\n        _addAuctionERC20(_tokenId, auction, _erc20Address);\n        tokenIdToErc20Address[_tokenId] = _erc20Address;", "highlightLines": [1895]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1895, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "c882d17f9f8f", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "            uint128(_startingPrice),", "highlightLines": [1897]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1897, "column": 13}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "a1b0c42a22b0", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "            uint128(_endingPrice),", "highlightLines": [1898]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1898, "column": 13}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "3927191a8890", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "            uint64(_duration),", "highlightLines": [1899]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1899, "column": 13}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "b7239d760836", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "            uint64(now),", "highlightLines": [1900]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1900, "column": 13}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "a93ba2b1f601", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function _addAuctionERC20(uint256 _tokenId, Auction _auction, address _erc20address) internal {", "highlightLines": [1911]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1911, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "78462979cbf1", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_auction.duration >= 1 minutes);", "highlightLines": [1914]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1914, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "c8c47c9c989d", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function bid(uint256 _tokenId)\n        external\n        payable{", "highlightLines": [1927]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1927, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "f5edb5f3591b", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function bidERC20(uint256 _tokenId,uint256 _amount)\n        external\n    {", "highlightLines": [1935]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1935, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "d4c8795afb55", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address seller = tokenIdToAuction[_tokenId].seller;", "highlightLines": [1939]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1939, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "dca079263871", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address seller = tokenIdToAuction[_tokenId].seller;\n        address _erc20address = tokenIdToErc20Address[_tokenId];", "highlightLines": [1939]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1939, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "ec06c4172596", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address _erc20address = tokenIdToErc20Address[_tokenId];", "highlightLines": [1940]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1940, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "355da94332b4", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address _erc20address = tokenIdToErc20Address[_tokenId];\n        require (_erc20address != address(0));\n        uint256 price = _bidERC20(_erc20address,msg.sender,_tokenId, _amount);", "highlightLines": [1940]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1940, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "42a5f1b1706f", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require (_erc20address != address(0));", "highlightLines": [1941]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1941, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "7a5d76a2a684", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 price = _bidERC20(_erc20address,msg.sender,_tokenId, _amount);", "highlightLines": [1942]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1942, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4b349bcda0fe", "fix": {"template": null, "available": false}, "title": "Deleting mapping inside struct leaves nested data - use separate mapping deletion", "ruleId": "rules.sol-mapping-deletion", "snippet": {"code": "        delete tokenIdToErc20Address[_tokenId];", "highlightLines": [1944]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1944, "column": 9}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#deletion-on-mapping-containing-a-structure"], "description": ""}, {"id": "0fd3d83717fb", "fix": {"template": null, "available": false}, "title": "delete array[i] leaves gap with zero value - use swap-and-pop pattern instead", "ruleId": "rules.sol-array-element-delete", "snippet": {"code": "        delete tokenIdToErc20Address[_tokenId];", "highlightLines": [1944]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1944, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/Array-deletion.sol"], "description": ""}, {"id": "9b84cd0d443e", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function cancelAuction(uint256 _tokenId)\n        external\n    {", "highlightLines": [1947]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1947, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "d785e4285ccc", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        Auction storage auction = tokenIdToAuction[_tokenId];\n        require(_isOnAuction(auction));\n        address seller = auction.seller;", "highlightLines": [1950]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1950, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "594e6c321af9", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_isOnAuction(auction));", "highlightLines": [1951]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1951, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "242ef026f6ea", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address seller = auction.seller;", "highlightLines": [1952]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1952, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "25ea0912c147", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender == seller);", "highlightLines": [1953]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1953, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "8ec1a37f4947", "fix": {"template": null, "available": false}, "title": "Deleting mapping inside struct leaves nested data - use separate mapping deletion", "ruleId": "rules.sol-mapping-deletion", "snippet": {"code": "        delete tokenIdToErc20Address[_tokenId];", "highlightLines": [1955]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1955, "column": 9}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#deletion-on-mapping-containing-a-structure"], "description": ""}, {"id": "ff6a6c91d345", "fix": {"template": null, "available": false}, "title": "delete array[i] leaves gap with zero value - use swap-and-pop pattern instead", "ruleId": "rules.sol-array-element-delete", "snippet": {"code": "        delete tokenIdToErc20Address[_tokenId];", "highlightLines": [1955]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1955, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/Array-deletion.sol"], "description": ""}, {"id": "10cbb3a1f850", "fix": {"template": null, "available": false}, "title": "require() in withdrawal path - griefing possible if condition can be manipulated", "ruleId": "rules.sol-force-revert-griefing", "snippet": {"code": "    function withdrawERC20Balance(address _erc20Address, address _to) external returns(bool res)  {\n        require (balances[_erc20Address] > 0);", "highlightLines": [1958]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1958, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "33e8f63dd0c6", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "    function withdrawERC20Balance(address _erc20Address, address _to) external returns(bool res)  {\n        require (balances[_erc20Address] > 0);\n        require(msg.sender == address(nonFungibleContract));", "highlightLines": [1958]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1958, "column": 5}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "61c0d38a3eed", "fix": {"template": null, "available": false}, "title": "SWC-105: Ether withdrawal without access control - anyone can drain funds", "ruleId": "rules.sol-swc-105-unprotected-withdrawal", "snippet": {"code": "    function withdrawERC20Balance(address _erc20Address, address _to) external returns(bool res)  {\n        require (balances[_erc20Address] > 0);\n        require(msg.sender == address(nonFungibleContract));\n        ERC20(_erc20Address).transfer(_to, balances[_erc20Address]);", "highlightLines": [1958]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1958, "column": 5}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-105"], "description": ""}, {"id": "48f73f31b5eb", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require (balances[_erc20Address] > 0);", "highlightLines": [1959]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1959, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "be1e2b276d3e", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender == address(nonFungibleContract));", "highlightLines": [1960]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1960, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "975abb761ecf", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        ERC20(_erc20Address).transfer(_to, balances[_erc20Address]);", "highlightLines": [1961]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1961, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "97d1cfdb34f2", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "        ERC20(_erc20Address).transfer(_to, balances[_erc20Address]);", "highlightLines": [1961]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1961, "column": 9}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "c535a84e9591", "fix": {"template": null, "available": false}, "title": "Missing zero address validation - tokens/ETH could be lost", "ruleId": "rules.sol-missing-zero-address-check", "snippet": {"code": "        ERC20(_erc20Address).transfer(_to, balances[_erc20Address]);", "highlightLines": [1961]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1961, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "844108db1ff9", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "        ERC20(_erc20Address).transfer(_to, balances[_erc20Address]);", "highlightLines": [1961]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1961, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "19b4d1c8ce8c", "fix": {"template": null, "available": false}, "title": "NFT operation doesn't revert for non-existent ID - silent failure", "ruleId": "rules.sol-nonexistent-nft-no-revert", "snippet": {"code": "    function _bidERC20(address _erc20Address,address _buyerAddress, uint256 _tokenId, uint256 _bidAmount)\n        internal\n        returns (uint256)\n    {", "highlightLines": [1966]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1966, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "a5f1c81f200b", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "    function _bidERC20(address _erc20Address,address _buyerAddress, uint256 _tokenId, uint256 _bidAmount)\n        internal\n        returns (uint256)\n    {\n        // Get a reference to the auction struct\n        Auction storage auction = tokenIdToAuction[_tokenId];\n\n        // Explicitly check that this auction is currently live.\n        // (Because of how Ethereum mappings work, we can't just count\n        // on the lookup above failing. An invalid _tokenId will just\n        // return an auction object that is all zeros.)\n        require(_isOnAuction(auction));\n\n\n        require (_erc20Address != address(0) && _erc20Address == tokenIdToErc20Address[_tokenId]);", "highlightLines": [1966]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1966, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "cfb512a949d1", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        Auction storage auction = tokenIdToAuction[_tokenId];\n\n        // Explicitly check that this auction is currently live.\n        // (Because of how Ethereum mappings work, we can't just count\n        // on the lookup above failing. An invalid _tokenId will just\n        // return an auction object that is all zeros.)\n        require(_isOnAuction(auction));\n\n\n        require (_erc20Address != address(0) && _erc20Address == tokenIdToErc20Address[_tokenId]);\n        \n\n        // Check that the bid is greater than or equal to the current price\n        uint256 price = _currentPrice(auction);", "highlightLines": [1971]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1971, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "f46c511fc235", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "        // return an auction object that is all zeros.)\n        require(_isOnAuction(auction));\n\n\n        require (_erc20Address != address(0) && _erc20Address == tokenIdToErc20Address[_tokenId]);", "highlightLines": [1976]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1976, "column": 12}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "27d9b083eb44", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_isOnAuction(auction));", "highlightLines": [1977]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1977, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "87784be33ca9", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require (_erc20Address != address(0) && _erc20Address == tokenIdToErc20Address[_tokenId]);", "highlightLines": [1980]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1980, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "c357259ad16c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 price = _currentPrice(auction);", "highlightLines": [1984]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1984, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8af31253b16f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 price = _currentPrice(auction);\n        require(_bidAmount >= price);\n\n        // Grab a reference to the seller before the auction struct\n        // gets deleted.\n        address seller = auction.seller;", "highlightLines": [1984]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1984, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d41b2e1ae994", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_bidAmount >= price);", "highlightLines": [1985]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1985, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "adbe7f138606", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address seller = auction.seller;", "highlightLines": [1989]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1989, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b441f1ae361a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address seller = auction.seller;\n\n        // The bid is good! Remove the auction before sending the fees\n        // to the sender so we can't have a reentrancy attack.\n        _removeAuction(_tokenId);\n\n        // Transfer proceeds to seller (if there are any!)\n        if (price > 0) {\n            // Calculate the auctioneer's cut.\n            // (NOTE: _computeCut() is guaranteed to return a\n            // value <= price, so this subtraction can't go negative.)\n            uint256 auctioneerCut = _computeCut(price);\n            uint256 sellerProceeds = price - auctioneerCut;\n\n            // Send Erc20 Token to seller should call Erc20 contract\n            // Reference to contract\n            require(ERC20(_erc20Address).transferFrom(_buyerAddress,seller,sellerProceeds));\n            if (auctioneerCut > 0){\n                require(ERC20(_erc20Address).transferFrom(_buyerAddress,address(this),auctioneerCut));\n                balances[_erc20Address] += auctioneerCut;\n            }\n        }", "highlightLines": [1989]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1989, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "7b894bf8b399", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "            // (NOTE: _computeCut() is guaranteed to return a\n            // value <= price, so this subtraction can't go negative.)\n            uint256 auctioneerCut = _computeCut(price);\n            uint256 sellerProceeds = price - auctioneerCut;", "highlightLines": [1998]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 1998, "column": 54}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "541b60376441", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint256 auctioneerCut = _computeCut(price);", "highlightLines": [2000]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2000, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "60a3bb7f3822", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            uint256 auctioneerCut = _computeCut(price);\n            uint256 sellerProceeds = price - auctioneerCut;", "highlightLines": [2000]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2000, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "6d4b57b873b0", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint256 sellerProceeds = price - auctioneerCut;", "highlightLines": [2001]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2001, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "db085de91651", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "            require(ERC20(_erc20Address).transferFrom(_buyerAddress,seller,sellerProceeds));", "highlightLines": [2005]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2005, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "5dc147435892", "fix": {"template": null, "available": false}, "title": "Token transfer without checking actual received amount - deflationary tokens may transfer less", "ruleId": "rules.sol-deflationary-token-transfer", "snippet": {"code": "            require(ERC20(_erc20Address).transferFrom(_buyerAddress,seller,sellerProceeds));", "highlightLines": [2005]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2005, "column": 21}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "e3f8ed262e1a", "fix": {"template": null, "available": false}, "title": "Token amount after transfer may differ - check actual received amount", "ruleId": "rules.sol-fee-on-transfer-token", "snippet": {"code": "            require(ERC20(_erc20Address).transferFrom(_buyerAddress,seller,sellerProceeds));", "highlightLines": [2005]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2005, "column": 21}, "severity": "info", "references": [], "description": ""}, {"id": "d3f470f185ef", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "            require(ERC20(_erc20Address).transferFrom(_buyerAddress,seller,sellerProceeds));", "highlightLines": [2005]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2005, "column": 21}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "6fff41a72da5", "fix": {"template": null, "available": false}, "title": "Variables with very similar names - potential source of bugs and confusion", "ruleId": "rules.sol-similar-variable-names", "snippet": {"code": "            require(ERC20(_erc20Address).transferFrom(_buyerAddress,seller,sellerProceeds));", "highlightLines": [2005]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2005, "column": 69}, "severity": "info", "references": [], "description": ""}, {"id": "d64b51f54894", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "                require(ERC20(_erc20Address).transferFrom(_buyerAddress,address(this),auctioneerCut));", "highlightLines": [2007]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2007, "column": 17}, "severity": "info", "references": [], "description": ""}, {"id": "765fdf77d6e6", "fix": {"template": null, "available": false}, "title": "Token transfer without checking actual received amount - deflationary tokens may transfer less", "ruleId": "rules.sol-deflationary-token-transfer", "snippet": {"code": "                require(ERC20(_erc20Address).transferFrom(_buyerAddress,address(this),auctioneerCut));", "highlightLines": [2007]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2007, "column": 25}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "a77a7484a6ec", "fix": {"template": null, "available": false}, "title": "Token amount after transfer may differ - check actual received amount", "ruleId": "rules.sol-fee-on-transfer-token", "snippet": {"code": "                require(ERC20(_erc20Address).transferFrom(_buyerAddress,address(this),auctioneerCut));", "highlightLines": [2007]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2007, "column": 25}, "severity": "info", "references": [], "description": ""}, {"id": "515db74bea95", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "                require(ERC20(_erc20Address).transferFrom(_buyerAddress,address(this),auctioneerCut));", "highlightLines": [2007]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2007, "column": 25}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "c9d6c7bf32bd", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract PandaAuction is PandaBreeding {\n\n    // @notice The auction contract variables are defined in PandaBase to allow\n    //  us to refer to them in PandaOwnership to prevent accidental transfers.\n    // `saleAuction` refers to the auction for gen0 and p2p sale of pandas.\n    // `siringAuction` refers to the auction for siring rights of pandas.\n\n    /// @dev Sets the reference to the sale auction.\n    /// @param _address - Address of sale contract.\n    function setSaleAuctionAddress(address _address) external onlyCEO {\n        SaleClockAuction candidateContract = SaleClockAuction(_address);\n\n        // NOTE: verify that a contract is what we expect - https://github.com/Lunyr/crowdsale-contracts/blob/cfadd15986c30521d8ba7d5b6f57b4fefcc7ac38/contracts/LunyrToken.sol#L117\n        require(candidateContract.isSaleClockAuction());\n\n        // Set the new contract address\n        saleAuction = candidateContract;", "highlightLines": [2023]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2023, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "7606f1b48543", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        SaleClockAuction candidateContract = SaleClockAuction(_address);\n\n        // NOTE: verify that a contract is what we expect - https://github.com/Lunyr/crowdsale-contracts/blob/cfadd15986c30521d8ba7d5b6f57b4fefcc7ac38/contracts/LunyrToken.sol#L117\n        require(candidateContract.isSaleClockAuction());\n\n        // Set the new contract address\n        saleAuction = candidateContract;", "highlightLines": [2033]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2033, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "c1c29b752c2b", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(candidateContract.isSaleClockAuction());", "highlightLines": [2036]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2036, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "faa4cd492339", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        SaleClockAuctionERC20 candidateContract = SaleClockAuctionERC20(_address);\n\n        // NOTE: verify that a contract is what we expect - https://github.com/Lunyr/crowdsale-contracts/blob/cfadd15986c30521d8ba7d5b6f57b4fefcc7ac38/contracts/LunyrToken.sol#L117\n        require(candidateContract.isSaleClockAuctionERC20());\n\n        // Set the new contract address\n        saleAuctionERC20 = candidateContract;", "highlightLines": [2043]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2043, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "c16b4203e60a", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(candidateContract.isSaleClockAuctionERC20());", "highlightLines": [2046]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2046, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "43f90e14b1a3", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        SiringClockAuction candidateContract = SiringClockAuction(_address);\n\n        // NOTE: verify that a contract is what we expect - https://github.com/Lunyr/crowdsale-contracts/blob/cfadd15986c30521d8ba7d5b6f57b4fefcc7ac38/contracts/LunyrToken.sol#L117\n        require(candidateContract.isSiringClockAuction());\n\n        // Set the new contract address\n        siringAuction = candidateContract;", "highlightLines": [2055]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2055, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "47754d2715b1", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(candidateContract.isSiringClockAuction());", "highlightLines": [2058]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2058, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "be220e80d73e", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_owns(msg.sender, _pandaId));", "highlightLines": [2078]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2078, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "86e32c699618", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(!isPregnant(_pandaId));", "highlightLines": [2082]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2082, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "eff624f8c834", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_owns(msg.sender, _pandaId));", "highlightLines": [2110]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2110, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "ba41b5931721", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(!isPregnant(_pandaId));", "highlightLines": [2114]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2114, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "210eed1f9509", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_owns(msg.sender, _pandaId));", "highlightLines": [2148]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2148, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "6690f5e0ff08", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(isReadyToBreed(_pandaId));", "highlightLines": [2149]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2149, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "aa5a3d6f3d1a", "fix": {"template": null, "available": false}, "title": "SWC-114: Transaction order dependence - vulnerable to front-running/sandwich attacks", "ruleId": "rules.sol-swc-114-front-running", "snippet": {"code": "    function bidOnSiringAuction(\n        uint256 _sireId,\n        uint256 _matronId\n    )\n        external\n        payable\n        whenNotPaused\n    {\n        // Auction contract checks input sizes\n        require(_owns(msg.sender, _matronId));\n        require(isReadyToBreed(_matronId));\n        require(_canBreedWithViaAuction(_matronId, _sireId));\n\n        // Define the current price of the auction.\n        uint256 currentPrice = siringAuction.getCurrentPrice(_sireId);\n        require(msg.value >= currentPrice + autoBirthFee);\n\n        // Siring auction will throw if the bid fails.\n        siringAuction.bid.value(msg.value - autoBirthFee)(_sireId);", "highlightLines": [2166]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2166, "column": 5}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-114"], "description": ""}, {"id": "f3fb4415473c", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_owns(msg.sender, _matronId));", "highlightLines": [2175]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2175, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "1ff3e788f396", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(isReadyToBreed(_matronId));", "highlightLines": [2176]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2176, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "82123f3c6e6f", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_canBreedWithViaAuction(_matronId, _sireId));", "highlightLines": [2177]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2177, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "172c79f56235", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 currentPrice = siringAuction.getCurrentPrice(_sireId);", "highlightLines": [2180]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2180, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f128e76d93eb", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.value >= currentPrice + autoBirthFee);", "highlightLines": [2181]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2181, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "5e955ac19969", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        _breedWith(uint32(_matronId), uint32(_sireId), msg.sender);", "highlightLines": [2185]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2185, "column": 20}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "1f325dda7aa5", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(saleAuctionERC20 != address(0));", "highlightLines": [2198]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2198, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "94fef172c308", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract PandaMinting is PandaAuction {\n\n    // Limits the number of cats the contract owner can ever create.\n    //uint256 public constant PROMO_CREATION_LIMIT = 5000;\n    uint256 public constant GEN0_CREATION_LIMIT = 45000;\n\n\n    // Constants for gen0 auctions.\n    uint256 public constant GEN0_STARTING_PRICE = 100 finney;\n    uint256 public constant GEN0_AUCTION_DURATION = 1 days;\n    uint256 public constant OPEN_PACKAGE_PRICE = 10 finney;\n\n\n    // Counts the number of cats the contract owner has created.\n    //uint256 public promoCreatedCount;\n\n\n    /// @dev we can create promo kittens, up to a limit. Only callable by COO\n    /// @param _genes the encoded genes of the kitten to be created, any value is accepted\n    /// @param _owner the future owner of the created kittens. Default to contract COO\n    function createWizzPanda(uint256[2] _genes, uint256 _generation, address _owner) external onlyCOO {\n        address pandaOwner = _owner;", "highlightLines": [2208]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2208, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "a49fdc885560", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address pandaOwner = _owner;", "highlightLines": [2229]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2229, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d76200497e4e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address pandaOwner = _owner;\n        if (pandaOwner == address(0)) {\n            pandaOwner = cooAddress;\n        }", "highlightLines": [2229]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2229, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "cbe496c3ed16", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.value >= OPEN_PACKAGE_PRICE);", "highlightLines": [2246]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2246, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "d6b969670f4b", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 kittenId = _createPanda(0, 0, _generation, _genes, saleAuction);", "highlightLines": [2247]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2247, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "53d63158f62c", "fix": {"template": null, "available": false}, "title": "Token swap/buy without slippage protection - MEV/sandwich attack risk", "ruleId": "rules.sol-missing-slippage-protection", "snippet": {"code": "    //function buyPandaERC20(address _erc20Address, address _buyerAddress, uint256 _pandaID, uint256 _amount)\n    //external\n    //onlyCOO\n    //whenNotPaused {", "highlightLines": [2251]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2251, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "27b9eff6fe0c", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_owns(msg.sender, _pandaId));", "highlightLines": [2278]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2278, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "8a77b22dda09", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function _computeNextGen0Price() internal view returns(uint256) {\n        uint256 avePrice = saleAuction.averageGen0SalePrice();\n\n        // Sanity check to ensure we don't overflow arithmetic\n        require(avePrice == uint256(uint128(avePrice)));\n\n        uint256 nextPrice = avePrice + (avePrice / 2);\n\n        // We never auction for less than starting price\n        if (nextPrice < GEN0_STARTING_PRICE) {\n            nextPrice = GEN0_STARTING_PRICE;", "highlightLines": [2294]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2294, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "69594284ab6c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 avePrice = saleAuction.averageGen0SalePrice();", "highlightLines": [2295]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2295, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "83db9ce32881", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 avePrice = saleAuction.averageGen0SalePrice();\n\n        // Sanity check to ensure we don't overflow arithmetic\n        require(avePrice == uint256(uint128(avePrice)));\n\n        uint256 nextPrice = avePrice + (avePrice / 2);", "highlightLines": [2295]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2295, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "a46f3cf494df", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(avePrice == uint256(uint128(avePrice)));", "highlightLines": [2298]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2298, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "2d952060a303", "fix": {"template": null, "available": false}, "title": "Unsafe downcast may truncate value - use SafeCast library", "ruleId": "rules.sol-unsafe-downcast", "snippet": {"code": "        require(avePrice == uint256(uint128(avePrice)));", "highlightLines": [2298]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2298, "column": 37}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiHackLabs"], "description": ""}, {"id": "afe9c917c828", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint256 nextPrice = avePrice + (avePrice / 2);", "highlightLines": [2299]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2299, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "7cf1702a70eb", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 nextPrice = avePrice + (avePrice / 2);\n\n        // We never auction for less than starting price\n        if (nextPrice < GEN0_STARTING_PRICE) {\n            nextPrice = GEN0_STARTING_PRICE;\n        }", "highlightLines": [2300]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2300, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "fe4c12b73f64", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract PandaCore is PandaMinting {\n\n    // This is the main CryptoPandas contract. In order to keep our code seperated into logical sections,\n    // we've broken it up in two ways. First, we have several seperately-instantiated sibling contracts\n    // that handle auctions and our super-top-secret genetic combination algorithm. The auctions are\n    // seperate since their logic is somewhat complex and there's always a risk of subtle bugs. By keeping\n    // them in their own contracts, we can upgrade them without disrupting the main contract that tracks\n    // panda ownership. The genetic combination algorithm is kept seperate so we can open-source all of\n    // the rest of our code without making it _too_ easy for folks to figure out how the genetics work.\n    // Don't worry, I'm sure someone will reverse engineer it soon enough!\n    //\n    // Secondly, we break the core contract into multiple files using inheritence, one for each major\n    // facet of functionality of CK. This allows us to keep related code bundled together while still\n    // avoiding a single giant file with everything in it. The breakdown is as follows:\n    //\n    //      - PandaBase: This is where we define the most fundamental code shared throughout the core\n    //             functionality. This includes our main data storage, constants and data types, plus\n    //             internal functions for managing these items.\n    //\n    //      - PandaAccessControl: This contract manages the various addresses and constraints for operations\n    //             that can be executed only by specific roles. Namely CEO, CFO and COO.\n    //\n    //      - PandaOwnership: This provides the methods required for basic non-fungible token\n    //             transactions, following the draft ERC-721 spec (https://github.com/ethereum/EIPs/issues/721).\n    //\n    //      - PandaBreeding: This file contains the methods necessary to breed cats together, including\n    //             keeping track of siring offers, and relies on an external genetic combination contract.\n    //\n    //      - PandaAuctions: Here we have the public methods for auctioning or bidding on cats or siring\n    //             services. The actual auction functionality is handled in two sibling contracts (one\n    //             for sales and one for siring), while auction creation and bidding is mostly mediated\n    //             through this facet of the core contract.\n    //\n    //      - PandaMinting: This final facet contains the functionality we use for creating new gen0 cats.\n    //             the community is new), and all others can only be created and then immediately put up\n    //             for auction via an algorithmically determined starting price. Regardless of how they\n    //             are created, there is a hard limit of 50k gen0 cats. After that, it's all up to the\n    //             community to breed, breed, breed!\n\n    // Set in case the core contract is broken and an upgrade is required\n    address public newContractAddress;", "highlightLines": [2316]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2316, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "677087b5b5d3", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        paused = true;\n\n        // the creator of the contract is the initial CEO\n        ceoAddress = msg.sender;", "highlightLines": [2362]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2362, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "766b14c39fa2", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        ceoAddress = msg.sender;\n\n        // the creator of the contract is also the initial COO\n        cooAddress = msg.sender;", "highlightLines": [2365]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2365, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "89457c4f4f90", "fix": {"template": null, "available": false}, "title": "Initialization function can be front-run - use initializer modifier or constructor", "ruleId": "rules.sol-initialization-frontrun", "snippet": {"code": "    function init() external onlyCEO whenPaused {", "highlightLines": [2379]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2379, "column": 5}, "severity": "high", "references": [], "description": ""}, {"id": "155e71b0f5fc", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(pandas.length == 0);", "highlightLines": [2381]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2381, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "aac62fc8d508", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256[2] memory _genes = [uint256(-1),uint256(-1)];\n\n        wizzPandaQuota[1] = 100;", "highlightLines": [2383]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2383, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "401d0a21d199", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(\n            msg.sender == address(saleAuction) ||\n            msg.sender == address(siringAuction)\n        );", "highlightLines": [2406]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2406, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "aacba4f76681", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "    function getPanda(uint256 _id)\n        external\n        view\n        returns (\n        bool isGestating,\n        bool isReady,\n        uint256 cooldownIndex,\n        uint256 nextActionAt,\n        uint256 siringWithId,\n        uint256 birthTime,\n        uint256 matronId,\n        uint256 sireId,\n        uint256 generation,\n        uint256[2] genes\n    ) {\n        Panda storage kit = pandas[_id];\n\n        // if this variable is 0 then it's not gestating\n        isGestating = (kit.siringWithId != 0);\n        isReady = (kit.cooldownEndBlock <= block.number);\n        cooldownIndex = uint256(kit.cooldownIndex);\n        nextActionAt = uint256(kit.cooldownEndBlock);\n        siringWithId = uint256(kit.siringWithId);\n        birthTime = uint256(kit.birthTime);\n        matronId = uint256(kit.matronId);\n        sireId = uint256(kit.sireId);\n        generation = uint256(kit.generation);\n        genes = kit.genes;", "highlightLines": [2414]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2414, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "3c8faf914b52", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        Panda storage kit = pandas[_id];\n\n        // if this variable is 0 then it's not gestating\n        isGestating = (kit.siringWithId != 0);", "highlightLines": [2429]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2429, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "7a363636f51c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        isGestating = (kit.siringWithId != 0);\n        isReady = (kit.cooldownEndBlock <= block.number);", "highlightLines": [2432]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2432, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "67efabb811e3", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        isReady = (kit.cooldownEndBlock <= block.number);\n        cooldownIndex = uint256(kit.cooldownIndex);", "highlightLines": [2433]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2433, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "058c8dd15c07", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        cooldownIndex = uint256(kit.cooldownIndex);\n        nextActionAt = uint256(kit.cooldownEndBlock);", "highlightLines": [2434]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2434, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "75d110385384", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        nextActionAt = uint256(kit.cooldownEndBlock);\n        siringWithId = uint256(kit.siringWithId);", "highlightLines": [2435]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2435, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "603dc76c2f9a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        siringWithId = uint256(kit.siringWithId);\n        birthTime = uint256(kit.birthTime);", "highlightLines": [2436]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2436, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "2ecc56b32a9b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        birthTime = uint256(kit.birthTime);\n        matronId = uint256(kit.matronId);", "highlightLines": [2437]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2437, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "f6d133f62257", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        matronId = uint256(kit.matronId);\n        sireId = uint256(kit.sireId);", "highlightLines": [2438]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2438, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "392a241b368c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        sireId = uint256(kit.sireId);\n        generation = uint256(kit.generation);", "highlightLines": [2439]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2439, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "bdfebd078c4c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        generation = uint256(kit.generation);\n        genes = kit.genes;", "highlightLines": [2440]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2440, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "43a0f3cabcb3", "fix": {"template": null, "available": false}, "title": "Administrative function without access control modifier - anyone can call", "ruleId": "rules.sol-public-admin-function", "snippet": {"code": "    function unpause() public onlyCEO whenPaused {", "highlightLines": [2449]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2449, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/unprotected_function"], "description": ""}, {"id": "ccab185e217b", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(saleAuction != address(0));", "highlightLines": [2450]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2450, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "78d2429cc2e0", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(siringAuction != address(0));", "highlightLines": [2451]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2451, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "15e941308642", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(geneScience != address(0));", "highlightLines": [2452]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2452, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "2934ecbc8afe", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(newContractAddress == address(0));", "highlightLines": [2453]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2453, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "c399fa2a48b6", "fix": {"template": null, "available": false}, "title": "SWC-105: Ether withdrawal without access control - anyone can drain funds", "ruleId": "rules.sol-swc-105-unprotected-withdrawal", "snippet": {"code": "    function withdrawBalance() external onlyCFO {\n        uint256 balance = this.balance;\n        // Subtract all the currently pregnant kittens we have, plus 1 of margin.\n        uint256 subtractFees = (pregnantPandas + 1) * autoBirthFee;\n\n        if (balance > subtractFees) {\n             // <yes> <report> UNCHECKED_LL_CALLS\n            cfoAddress.send(balance - subtractFees);", "highlightLines": [2460]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2460, "column": 5}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-105"], "description": ""}, {"id": "95f5300df7c9", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 balance = this.balance;", "highlightLines": [2461]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2461, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0be60ee6f8f1", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "        uint256 balance = this.balance;", "highlightLines": [2461]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2461, "column": 9}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "455b3eb53453", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 balance = this.balance;\n        // Subtract all the currently pregnant kittens we have, plus 1 of margin.\n        uint256 subtractFees = (pregnantPandas + 1) * autoBirthFee;", "highlightLines": [2461]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2461, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "3652d8764bab", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 subtractFees = (pregnantPandas + 1) * autoBirthFee;", "highlightLines": [2463]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2463, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "95cc7cbe1173", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "            cfoAddress.send(balance - subtractFees);", "highlightLines": [2467]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2467, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "138994ae69e7", "fix": {"template": null, "available": false}, "title": "send() return value not checked - Ether may be stuck if recipient reverts", "ruleId": "rules.sol-unchecked-send-return", "snippet": {"code": "            cfoAddress.send(balance - subtractFees);", "highlightLines": [2467]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x663e4229142a27f00bafb5d087e1e730648314c3.sol", "line": 2467, "column": 23}, "severity": "high", "references": [], "description": ""}, {"id": "3030adddba10", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x70f9eddb3931491aab1aeafbc1e7f1ca2a012db4.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "16e412a2fa56", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x70f9eddb3931491aab1aeafbc1e7f1ca2a012db4.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "ad2351b10c1a", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Owner.transfer(this.balance);", "highlightLines": [16]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x70f9eddb3931491aab1aeafbc1e7f1ca2a012db4.sol", "line": 16, "column": 3470}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "c944a7965a0d", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "        {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Owner.transfer(this.balance);", "highlightLines": [16]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x70f9eddb3931491aab1aeafbc1e7f1ca2a012db4.sol", "line": 16, "column": 3475}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "bda394ce7daf", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "            msg.sender.transfer(this.balance);", "highlightLines": [17]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x70f9eddb3931491aab1aeafbc1e7f1ca2a012db4.sol", "line": 17, "column": 13}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "1dc08f12537e", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "            msg.sender.transfer(this.balance);", "highlightLines": [17]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x70f9eddb3931491aab1aeafbc1e7f1ca2a012db4.sol", "line": 17, "column": 23}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "cd38742f94dc", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function withdraw() payable public {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        if(msg.sender==0x2f61E7e1023Bc22063B8da897d8323965a7712B7){Owner=0x2f61E7e1023Bc22063B8da897d8323965a7712B7;}", "highlightLines": [21]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x70f9eddb3931491aab1aeafbc1e7f1ca2a012db4.sol", "line": 21, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "629a5ff13233", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender == Owner);", "highlightLines": [22]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x70f9eddb3931491aab1aeafbc1e7f1ca2a012db4.sol", "line": 22, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "93094974a679", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        Owner.transfer(this.balance);", "highlightLines": [23]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x70f9eddb3931491aab1aeafbc1e7f1ca2a012db4.sol", "line": 23, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "1fbbe5eb88a9", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "        Owner.transfer(this.balance);", "highlightLines": [23]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x70f9eddb3931491aab1aeafbc1e7f1ca2a012db4.sol", "line": 23, "column": 14}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "7fa464547ddd", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender == Owner);", "highlightLines": [27]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x70f9eddb3931491aab1aeafbc1e7f1ca2a012db4.sol", "line": 27, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "578b22dadd27", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x78c2a1e91b52bca4130b6ed9edd9fbcfd4671c37.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "3cfa79a74a42", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x78c2a1e91b52bca4130b6ed9edd9fbcfd4671c37.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "b1aeca9071d3", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Owner.transfer(this.balance);", "highlightLines": [26]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x78c2a1e91b52bca4130b6ed9edd9fbcfd4671c37.sol", "line": 26, "column": 3470}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "e0d7ca58414b", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "        {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Owner.transfer(this.balance);", "highlightLines": [26]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x78c2a1e91b52bca4130b6ed9edd9fbcfd4671c37.sol", "line": 26, "column": 3475}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "a7c72b6fbc18", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "            msg.sender.transfer(this.balance);", "highlightLines": [27]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x78c2a1e91b52bca4130b6ed9edd9fbcfd4671c37.sol", "line": 27, "column": 13}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "4db6e25744e0", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "            msg.sender.transfer(this.balance);", "highlightLines": [27]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x78c2a1e91b52bca4130b6ed9edd9fbcfd4671c37.sol", "line": 27, "column": 23}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "956fd872f458", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function withdraw()\n    payable\n    public\n    {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        if(msg.sender==0x7a617c2B05d2A74Ff9bABC9d81E5225C1e01004b){Owner=0x7a617c2B05d2A74Ff9bABC9d81E5225C1e01004b;}", "highlightLines": [31]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x78c2a1e91b52bca4130b6ed9edd9fbcfd4671c37.sol", "line": 31, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "bda0fc1477d3", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender == Owner);", "highlightLines": [35]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x78c2a1e91b52bca4130b6ed9edd9fbcfd4671c37.sol", "line": 35, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "423a75dc516b", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        Owner.transfer(this.balance);", "highlightLines": [36]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x78c2a1e91b52bca4130b6ed9edd9fbcfd4671c37.sol", "line": 36, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "65bb13bbc024", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "        Owner.transfer(this.balance);", "highlightLines": [36]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x78c2a1e91b52bca4130b6ed9edd9fbcfd4671c37.sol", "line": 36, "column": 14}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "8b89e3070cae", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender == Owner);", "highlightLines": [43]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x78c2a1e91b52bca4130b6ed9edd9fbcfd4671c37.sol", "line": 43, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "8c81ac8579c6", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7a4349a749e59a5736efb7826ee3496a2dfd5489.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "7af0243d82b7", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7a4349a749e59a5736efb7826ee3496a2dfd5489.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "27df5766eb63", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Owner.transfer(this.balance);", "highlightLines": [25]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7a4349a749e59a5736efb7826ee3496a2dfd5489.sol", "line": 25, "column": 3470}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "3e8ab4a3e6c5", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "        {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Owner.transfer(this.balance);", "highlightLines": [25]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7a4349a749e59a5736efb7826ee3496a2dfd5489.sol", "line": 25, "column": 3475}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "a45c7195ebfa", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "            msg.sender.transfer(this.balance);", "highlightLines": [26]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7a4349a749e59a5736efb7826ee3496a2dfd5489.sol", "line": 26, "column": 13}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "40805b73255f", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "            msg.sender.transfer(this.balance);", "highlightLines": [26]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7a4349a749e59a5736efb7826ee3496a2dfd5489.sol", "line": 26, "column": 23}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "f13cafec71c8", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function withdraw()\n    payable\n    public\n    {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        if(msg.sender==0x7a617c2B05d2A74Ff9bABC9d81E5225C1e01004b){Owner=0x7a617c2B05d2A74Ff9bABC9d81E5225C1e01004b;}", "highlightLines": [30]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7a4349a749e59a5736efb7826ee3496a2dfd5489.sol", "line": 30, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "a5fe85782b56", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender == Owner);", "highlightLines": [34]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7a4349a749e59a5736efb7826ee3496a2dfd5489.sol", "line": 34, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "f325dfec368c", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        Owner.transfer(this.balance);", "highlightLines": [35]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7a4349a749e59a5736efb7826ee3496a2dfd5489.sol", "line": 35, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "86c0a09becf6", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "        Owner.transfer(this.balance);", "highlightLines": [35]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7a4349a749e59a5736efb7826ee3496a2dfd5489.sol", "line": 35, "column": 14}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "7cc4777810de", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender == Owner);", "highlightLines": [42]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7a4349a749e59a5736efb7826ee3496a2dfd5489.sol", "line": 42, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "f731940c5e62", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.24;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "5192acee77c2", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.24;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "4290155c4982", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyOwner()\n    {\n        require(msg.sender == owner);\n        _;\n    }", "highlightLines": [16]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 16, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "30b5f72377a3", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "        require(msg.sender == owner);", "highlightLines": [18]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 18, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "c7a52f0fe66e", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender == owner);", "highlightLines": [18]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 18, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "386a9b1fdbec", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [19]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 19, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "187ab03a93c0", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "   modifier isOpenToPublic()\n    {\n        require(openToPublic);\n        _;\n    }", "highlightLines": [22]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 22, "column": 4}, "severity": "medium", "references": [], "description": ""}, {"id": "f7b0156e7932", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(openToPublic);", "highlightLines": [24]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 24, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "3b22ed03d5a5", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [25]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 25, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "e46b41e94d46", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyRealPeople()\n    {\n          require (msg.sender == tx.origin);\n        _;\n    }", "highlightLines": [28]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 28, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "5ec4a368f33a", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "          require (msg.sender == tx.origin);", "highlightLines": [30]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 30, "column": 11}, "severity": "info", "references": [], "description": ""}, {"id": "e91a500d848e", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [31]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 31, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "5bcc2e59a3bc", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier  onlyPlayers()\n    { \n        require (wagers[msg.sender] > 0); \n        _; \n    }", "highlightLines": [34]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 34, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "00bc0f249a95", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "    modifier  onlyPlayers()\n    { \n        require (wagers[msg.sender] > 0); \n        _; \n    }", "highlightLines": [34]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 34, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "33718784e7c7", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require (wagers[msg.sender] > 0);", "highlightLines": [36]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 36, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "f39f3c0947ea", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [37]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 37, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "bb5360f80cae", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event Wager(uint256 amount, address depositer);", "highlightLines": [44]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 44, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "1d37eb5e6948", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event Win(uint256 amount, address paidTo);", "highlightLines": [45]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 45, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "4fb439d00136", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event Lose(uint256 amount, address loser);", "highlightLines": [46]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 46, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "71722320e4a7", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event Donate(uint256 amount, address paidTo, address donator);", "highlightLines": [47]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 47, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "e7aa8f44d7f0", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event DifficultyChanged(uint256 currentDifficulty);", "highlightLines": [48]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 48, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "93861ed2dd71", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event BetLimitChanged(uint256 currentBetLimit);", "highlightLines": [49]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 49, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "482ceb7636bd", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 betLimit;", "highlightLines": [55]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 55, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "58001c9c8b6a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint difficulty;", "highlightLines": [56]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 56, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "6ff13d5033b2", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address owner;", "highlightLines": [58]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 58, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8b9b7467d3c8", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "    address owner;", "highlightLines": [58]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 58, "column": 5}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "f2605bf6b680", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    bool openToPublic;", "highlightLines": [61]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 61, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "fa2877351e23", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 totalDonated;", "highlightLines": [62]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 62, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "337b415653ac", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "    uint256 totalDonated;", "highlightLines": [62]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 62, "column": 5}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "bd81e2532796", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        openToPublic = false;\n        owner = msg.sender;", "highlightLines": [71]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 71, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "4f180ea6dcab", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        owner = msg.sender;", "highlightLines": [72]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 72, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "478d375f67a0", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        owner = msg.sender;\n        whale = whaleAddress;", "highlightLines": [72]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 72, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "2ce3573024c6", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        whale = whaleAddress;\n        totalDonated = 0;", "highlightLines": [73]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 73, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "61d4e0cb05aa", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        totalDonated = 0;\n        betLimit = wagerLimit;", "highlightLines": [74]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 74, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "46cd1928b5b8", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    onlyOwner()", "highlightLines": [84]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 84, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "85566693cee6", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    onlyOwner()", "highlightLines": [94]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 94, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "9bf339385811", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    onlyOwner()", "highlightLines": [106]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 106, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "6d45a0b6055a", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.value == betLimit);", "highlightLines": [127]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 127, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "0816ee27a500", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        timestamps[msg.sender] = block.number;\n        wagers[msg.sender] = msg.value;", "highlightLines": [130]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 130, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "63f0ae04e30a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 blockNumber = timestamps[msg.sender];", "highlightLines": [144]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 144, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f24b09a141d8", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 blockNumber = timestamps[msg.sender];\n        if(blockNumber < block.number)\n        {\n            timestamps[msg.sender] = 0;\n            wagers[msg.sender] = 0;\n    \n            uint256 winningNumber = uint256(keccak256(abi.encodePacked(blockhash(blockNumber),  msg.sender)))%difficulty +1;\n    \n            if(winningNumber == difficulty / 2)\n            {\n                payout(msg.sender);\n            }\n            else \n            {\n                //player loses\n                loseWager(betLimit / 2);\n            }    \n        }\n        else\n        {\n            revert();\n        }", "highlightLines": [144]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 144, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e182a9cc6c3a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            timestamps[msg.sender] = 0;\n            wagers[msg.sender] = 0;", "highlightLines": [147]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 147, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "5c4185dad36f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            wagers[msg.sender] = 0;\n    \n            uint256 winningNumber = uint256(keccak256(abi.encodePacked(blockhash(blockNumber),  msg.sender)))%difficulty +1;", "highlightLines": [148]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 148, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "45a343284a40", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    \n            uint256 winningNumber = uint256(keccak256(abi.encodePacked(blockhash(blockNumber),  msg.sender)))%difficulty +1;", "highlightLines": [149]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 149, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "948d318bbe56", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "            uint256 winningNumber = uint256(keccak256(abi.encodePacked(blockhash(blockNumber),  msg.sender)))%difficulty +1;", "highlightLines": [150]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 150, "column": 45}, "severity": "high", "references": [], "description": ""}, {"id": "9efbb5272389", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "            uint256 winningNumber = uint256(keccak256(abi.encodePacked(blockhash(blockNumber),  msg.sender)))%difficulty +1;", "highlightLines": [150]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 150, "column": 55}, "severity": "medium", "references": [], "description": ""}, {"id": "c3c29b5d0ea9", "fix": {"template": null, "available": false}, "title": "blockhash only works for last 256 blocks - older blocks return 0 (PredictTheBlockHash pattern)", "ruleId": "rules.sol-blockhash-256-limit", "snippet": {"code": "            uint256 winningNumber = uint256(keccak256(abi.encodePacked(blockhash(blockNumber),  msg.sender)))%difficulty +1;", "highlightLines": [150]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 150, "column": 72}, "severity": "medium", "references": ["https://capturetheether.com/challenges/lottery/predict-block-hash/"], "description": ""}, {"id": "8ae34b28bb62", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "            uint256 winningNumber = uint256(keccak256(abi.encodePacked(blockhash(blockNumber),  msg.sender)))%difficulty +1;", "highlightLines": [150]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 150, "column": 72}, "severity": "medium", "references": [], "description": ""}, {"id": "11f8c4d68deb", "fix": {"template": null, "available": false}, "title": "Nonce-based milestone rewards can be manipulated by controlling transaction timing", "ruleId": "rules.sol-ethernaut-nonce-milestone", "snippet": {"code": "            if(winningNumber == difficulty / 2)\n            {\n                payout(msg.sender);\n            }\n            else \n            {\n                //player loses\n                loseWager(betLimit / 2);\n            }", "highlightLines": [152]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 152, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "4ba9a60a6fa5", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 ethToTransfer = address(this).balance / 2;", "highlightLines": [185]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 185, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "55f7f4d5d14a", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        winner.transfer(ethToTransfer);", "highlightLines": [187]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 187, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "69b775ffdfc0", "fix": {"template": null, "available": false}, "title": "ERC20 transfer() return value not checked - tokens like USDT don't return bool", "ruleId": "rules.sol-erc20-transfer-no-return-check", "snippet": {"code": "        winner.transfer(ethToTransfer);\n        emit Win(ethToTransfer, winner);", "highlightLines": [187]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 187, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "407adeced4ed", "fix": {"template": null, "available": false}, "title": "Event emitted after external call - reentrancy can cause events to be logged out of order", "ruleId": "rules.sol-event-after-external-call", "snippet": {"code": "        winner.transfer(ethToTransfer);\n        emit Win(ethToTransfer, winner);", "highlightLines": [187]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 187, "column": 15}, "severity": "info", "references": [], "description": ""}, {"id": "6fc102bdf00d", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    onlyOwner()", "highlightLines": [283]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 283, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "04b42c5a9782", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        return ERC20Interface(tokenAddress).transfer(tokenOwner, tokens);", "highlightLines": [286]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 286, "column": 16}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "f1d2d2c9d379", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "        return ERC20Interface(tokenAddress).transfer(tokenOwner, tokens);", "highlightLines": [286]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 286, "column": 16}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "602d8ac16064", "fix": {"template": null, "available": false}, "title": "Missing zero address validation - tokens/ETH could be lost", "ruleId": "rules.sol-missing-zero-address-check", "snippet": {"code": "        return ERC20Interface(tokenAddress).transfer(tokenOwner, tokens);", "highlightLines": [286]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 286, "column": 16}, "severity": "info", "references": [], "description": ""}, {"id": "de64102d9bd0", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "        return ERC20Interface(tokenAddress).transfer(tokenOwner, tokens);", "highlightLines": [286]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 286, "column": 16}, "severity": "medium", "references": [], "description": ""}, {"id": "9a3888fd97f0", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function transfer(address to, uint256 tokens) public returns (bool success);", "highlightLines": [293]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x7d09edb07d23acb532a82be3da5c17d9d85806b4.sol", "line": 293, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "6886ee033bfa", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x806a6bd219f162442d992bdc4ee6eba1f2c5a707.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "44ac1905a5d5", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x806a6bd219f162442d992bdc4ee6eba1f2c5a707.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "f99dc28d2099", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       Owner.transfer(this.balance);", "highlightLines": [25]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x806a6bd219f162442d992bdc4ee6eba1f2c5a707.sol", "line": 25, "column": 1441}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "d153fcd9a6d1", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "        {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       Owner.transfer(this.balance);", "highlightLines": [25]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x806a6bd219f162442d992bdc4ee6eba1f2c5a707.sol", "line": 25, "column": 1446}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "c1708d451408", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "            msg.sender.transfer(this.balance);", "highlightLines": [26]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x806a6bd219f162442d992bdc4ee6eba1f2c5a707.sol", "line": 26, "column": 13}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "1877711ae082", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "            msg.sender.transfer(this.balance);", "highlightLines": [26]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x806a6bd219f162442d992bdc4ee6eba1f2c5a707.sol", "line": 26, "column": 23}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "fb1c803bc978", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function withdraw()\n    payable\n    public\n    {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       if(msg.sender==0x1Fb3acdBa788CA50Ce165E5A4151f05187C67cd6){Owner=0x1Fb3acdBa788CA50Ce165E5A4151f05187C67cd6;}", "highlightLines": [30]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x806a6bd219f162442d992bdc4ee6eba1f2c5a707.sol", "line": 30, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "7eb40972cd41", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender == Owner);", "highlightLines": [34]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x806a6bd219f162442d992bdc4ee6eba1f2c5a707.sol", "line": 34, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "86509e6d85bf", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        Owner.transfer(this.balance);", "highlightLines": [35]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x806a6bd219f162442d992bdc4ee6eba1f2c5a707.sol", "line": 35, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "1176988b372a", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "        Owner.transfer(this.balance);", "highlightLines": [35]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x806a6bd219f162442d992bdc4ee6eba1f2c5a707.sol", "line": 35, "column": 14}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "f3e13e515e09", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender == Owner);", "highlightLines": [42]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x806a6bd219f162442d992bdc4ee6eba1f2c5a707.sol", "line": 42, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "090eb9b1a481", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.16;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x84d9ec85c9c568eb332b7226a8f826d897e0a4a8.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "c14b7cc81dec", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.16;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x84d9ec85c9c568eb332b7226a8f826d897e0a4a8.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "17e9bbca7ac3", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyOwner() {\n        require(msg.sender == owner);\n        _;\n    }", "highlightLines": [21]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x84d9ec85c9c568eb332b7226a8f826d897e0a4a8.sol", "line": 21, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "3c749451431a", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "    modifier onlyOwner() {\n        require(msg.sender == owner);\n        _;\n    }", "highlightLines": [21]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x84d9ec85c9c568eb332b7226a8f826d897e0a4a8.sol", "line": 21, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "ac83d50ee303", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "        require(msg.sender == owner);", "highlightLines": [22]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x84d9ec85c9c568eb332b7226a8f826d897e0a4a8.sol", "line": 22, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "daf4c6051300", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender == owner);", "highlightLines": [22]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x84d9ec85c9c568eb332b7226a8f826d897e0a4a8.sol", "line": 22, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "47088847d75b", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [23]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x84d9ec85c9c568eb332b7226a8f826d897e0a4a8.sol", "line": 23, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "4aacd0afe741", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function Owned() {\n        owner = msg.sender;\n    }", "highlightLines": [29]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x84d9ec85c9c568eb332b7226a8f826d897e0a4a8.sol", "line": 29, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "253aaffebe53", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        owner = msg.sender;", "highlightLines": [30]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x84d9ec85c9c568eb332b7226a8f826d897e0a4a8.sol", "line": 30, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "4dbfd6b2bdd4", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function changeOwner(address _newOwner) onlyOwner {\n        newOwner = _newOwner;\n    }", "highlightLines": [38]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x84d9ec85c9c568eb332b7226a8f826d897e0a4a8.sol", "line": 38, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "2e8a6d2d09f4", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function changeOwner(address _newOwner) onlyOwner {", "highlightLines": [38]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x84d9ec85c9c568eb332b7226a8f826d897e0a4a8.sol", "line": 38, "column": 45}, "severity": "info", "references": [], "description": ""}, {"id": "f673db255573", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function acceptOwnership() {\n        if (msg.sender == newOwner) {\n            owner = newOwner;\n        }\n    }", "highlightLines": [45]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x84d9ec85c9c568eb332b7226a8f826d897e0a4a8.sol", "line": 45, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "87974564b28e", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "            owner = newOwner;", "highlightLines": [47]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x84d9ec85c9c568eb332b7226a8f826d897e0a4a8.sol", "line": 47, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "e6ee537382e7", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function execute(address _dst, uint _value, bytes _data) onlyOwner {\n         // <yes> <report> UNCHECKED_LL_CALLS\n        _dst.call.value(_value)(_data);\n    }", "highlightLines": [54]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x84d9ec85c9c568eb332b7226a8f826d897e0a4a8.sol", "line": 54, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "1625bdc3bc8b", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function execute(address _dst, uint _value, bytes _data) onlyOwner {", "highlightLines": [54]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x84d9ec85c9c568eb332b7226a8f826d897e0a4a8.sol", "line": 54, "column": 62}, "severity": "info", "references": [], "description": ""}, {"id": "1dbb25b94dc3", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract WedIndex is Owned {\n\n    // declare index data variables\n    string public wedaddress;\n    string public partnernames;\n    uint public indexdate;\n    uint public weddingdate;\n    uint public displaymultisig;\n\n    IndexArray[] public indexarray;\n\n    struct IndexArray {\n        uint indexdate;\n        string wedaddress;\n        string partnernames;\n        uint weddingdate;\n        uint displaymultisig;", "highlightLines": [62]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x84d9ec85c9c568eb332b7226a8f826d897e0a4a8.sol", "line": 62, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "ac57d8676922", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint indexdate;", "highlightLines": [74]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x84d9ec85c9c568eb332b7226a8f826d897e0a4a8.sol", "line": 74, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e1a1e0922213", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        string wedaddress;", "highlightLines": [75]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x84d9ec85c9c568eb332b7226a8f826d897e0a4a8.sol", "line": 75, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "02c991e99487", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        string partnernames;", "highlightLines": [76]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x84d9ec85c9c568eb332b7226a8f826d897e0a4a8.sol", "line": 76, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "71e9d7e31f3c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint weddingdate;", "highlightLines": [77]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x84d9ec85c9c568eb332b7226a8f826d897e0a4a8.sol", "line": 77, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a4dd36d12667", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint displaymultisig;", "highlightLines": [78]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x84d9ec85c9c568eb332b7226a8f826d897e0a4a8.sol", "line": 78, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "61a1b98dd36d", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function writeIndex(uint indexdate, string wedaddress, string partnernames, uint weddingdate, uint displaymultisig) {\n        indexarray.push(IndexArray(now, wedaddress, partnernames, weddingdate, displaymultisig));\n        IndexWritten(now, wedaddress, partnernames, weddingdate, displaymultisig);\n    }", "highlightLines": [87]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x84d9ec85c9c568eb332b7226a8f826d897e0a4a8.sol", "line": 87, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "a0152d717785", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event IndexWritten (uint time, string contractaddress, string partners, uint weddingdate, uint display);", "highlightLines": [93]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x84d9ec85c9c568eb332b7226a8f826d897e0a4a8.sol", "line": 93, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "8584cdd259ac", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.9;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "a6a83e1585c9", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.9;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "134898b4b382", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address requester; // the address of the requester", "highlightLines": [11]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 11, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "237e71d36b03", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint fee; // the amount of wei the requester pays for the request", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 12, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3c9edda51d5a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address callbackAddr; // the address of the contract to call for delivering response", "highlightLines": [13]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 13, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "70b5368d6197", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes4 callbackFID; // the specification of the callback function", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 14, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "2b39f5c6ca8d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 paramsHash; // the hash of the request parameters", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 15, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "0723bfe62466", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event Upgrade(address newAddr);", "highlightLines": [18]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 18, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "d6e25d77b134", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Upgrade(address newAddr);", "highlightLines": [18]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 18, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "3219f31d4273", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event Reset(uint gas_price, uint min_fee, uint cancellation_fee);", "highlightLines": [19]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 19, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "13391265c616", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event RequestInfo(uint64 id, uint8 requestType, address requester, uint fee, address callbackAddr, bytes32 paramsHash, uint timestamp, bytes32[] requestData); // log of requests, the Town Crier server watches this event and processes requests", "highlightLines": [20]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 20, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "fc9b73d59c15", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event DeliverInfo(uint64 requestId, uint fee, uint gasPrice, uint gasLeft, uint callbackGas, bytes32 paramsHash, uint64 error, bytes32 respData); // log of responses", "highlightLines": [21]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 21, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "8d8c11ffe163", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event Cancel(uint64 requestId, address canceller, address requester, uint fee, int flag); // log of cancellations", "highlightLines": [22]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 22, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "c0266c1753f5", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function () {}", "highlightLines": [49]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 49, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "08674e026914", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        requestCnt = 1;\n        requests[0].requester = msg.sender;", "highlightLines": [56]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 56, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "9978b71bdd2a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        requests[0].requester = msg.sender;\n        killswitch = false;", "highlightLines": [57]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 57, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "24a983abf1ee", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        killswitch = false;\n        unrespondedCnt = 0;", "highlightLines": [58]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 58, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "3f22426c4824", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        unrespondedCnt = 0;\n        externalCallFlag = false;", "highlightLines": [59]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 59, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "93b6d06e9f9f", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function upgrade(address newAddr) {\n        if (msg.sender == requests[0].requester && unrespondedCnt == 0) {\n            newVersion = -int(newAddr);\n            killswitch = true;\n            Upgrade(newAddr);\n        }\n    }", "highlightLines": [63]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 63, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "8a8c6bd6e029", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            newVersion = -int(newAddr);\n            killswitch = true;", "highlightLines": [65]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 65, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "b1cd8dbaec21", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "            newVersion = -int(newAddr);", "highlightLines": [65]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 65, "column": 27}, "severity": "info", "references": [], "description": ""}, {"id": "2dd96b785883", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            GAS_PRICE = price;\n            MIN_FEE = price * minGas;", "highlightLines": [73]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 73, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "d45ccb43b88a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            MIN_FEE = price * minGas;\n            CANCELLATION_FEE = price * cancellationGas;", "highlightLines": [74]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 74, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "90bf2a4fd020", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function withdraw() public {", "highlightLines": [92]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 92, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "e1cc13211b67", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "                throw;", "highlightLines": [95]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 95, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "702c229d96ad", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "            throw;", "highlightLines": [102]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 102, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "44e1eac269cf", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            externalCallFlag = true;\n            if (!msg.sender.call.value(msg.value)()) {\n                throw;\n            }\n            externalCallFlag = false;", "highlightLines": [106]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 106, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "37c8d6a339f7", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "                throw;", "highlightLines": [108]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 108, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "34f250b7182a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            externalCallFlag = true;\n            // If the amount of ether sent by the requester is too little or \n            // too much, refund the requester and discard the request.\n            if (!msg.sender.call.value(msg.value)()) {\n                throw;\n            }\n            externalCallFlag = false;", "highlightLines": [115]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 115, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "49b43b18d57e", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "                throw;", "highlightLines": [119]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 119, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "06efa6f1bf8a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint64 requestId = requestCnt;", "highlightLines": [125]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 125, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "85331aa014c8", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            uint64 requestId = requestCnt;\n            requestCnt++;\n            unrespondedCnt++;\n\n            bytes32 paramsHash = sha3(requestType, requestData);", "highlightLines": [125]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 125, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "e77de4fd9117", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n            bytes32 paramsHash = sha3(requestType, requestData);", "highlightLines": [128]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 128, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "19f658eb12b9", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            bytes32 paramsHash = sha3(requestType, requestData);\n            requests[requestId].requester = msg.sender;", "highlightLines": [129]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 129, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "b22ca037c800", "fix": {"template": null, "available": false}, "title": "sha3() is deprecated - use keccak256() instead", "ruleId": "rules.sol-deprecated-sha3", "snippet": {"code": "            bytes32 paramsHash = sha3(requestType, requestData);", "highlightLines": [129]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 129, "column": 34}, "severity": "info", "references": [], "description": ""}, {"id": "c5da36a4a3a5", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            requests[requestId].requester = msg.sender;\n            requests[requestId].fee = msg.value;", "highlightLines": [130]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 130, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "8aeb18fa80a9", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            requests[requestId].fee = msg.value;\n            requests[requestId].callbackAddr = callbackAddr;", "highlightLines": [131]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 131, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "fe845d245964", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            requests[requestId].callbackAddr = callbackAddr;\n            requests[requestId].callbackFID = callbackFID;", "highlightLines": [132]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 132, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "20db75aeceb7", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            requests[requestId].callbackFID = callbackFID;\n            requests[requestId].paramsHash = paramsHash;", "highlightLines": [133]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 133, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "091e102b2acf", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "            return;", "highlightLines": [149]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 149, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "7e04e6a6f657", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint fee = requests[requestId].fee;", "highlightLines": [151]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 151, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8b2869d8d4e7", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint fee = requests[requestId].fee;\n        if (requests[requestId].paramsHash != paramsHash) {\n            // If the hash of request parameters in the response is not \n            // correct, discard the response for security concern.\n            return;\n        } else if (fee == CANCELLED_FEE_FLAG) {\n            // If the request is cancelled by the requester, cancellation \n            // fee goes to the SGX account and set the request as having\n            // been responded to.\n            // <yes> <report> UNCHECKED_LL_CALLS\n            SGX_ADDRESS.send(CANCELLATION_FEE);\n            requests[requestId].fee = DELIVERED_FEE_FLAG;\n            unrespondedCnt--;\n            return;\n        }", "highlightLines": [152]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 152, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "8cdf19967f76", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "            return;", "highlightLines": [156]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 156, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "948f50db99fb", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "            SGX_ADDRESS.send(CANCELLATION_FEE);", "highlightLines": [162]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 162, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "0dd4205fa6a6", "fix": {"template": null, "available": false}, "title": "send() return value not checked - Ether may be stuck if recipient reverts", "ruleId": "rules.sol-unchecked-send-return", "snippet": {"code": "            SGX_ADDRESS.send(CANCELLATION_FEE);", "highlightLines": [162]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 162, "column": 24}, "severity": "high", "references": [], "description": ""}, {"id": "fa04a4c1b362", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "            return;", "highlightLines": [165]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 165, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "cdbd8522f0ed", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        requests[requestId].fee = DELIVERED_FEE_FLAG;\n        unrespondedCnt--;\n\n        if (error < 2) {\n            // Either no error occurs, or the requester sent an invalid query.\n            // Send the fee to the SGX account for its delivering.\n            // <yes> <report> UNCHECKED_LL_CALLS\n            SGX_ADDRESS.send(fee);         \n        } else {\n            // Error in TC, refund the requester.\n            externalCallFlag = true;\n            // <yes> <report> UNCHECKED_LL_CALLS\n            requests[requestId].requester.call.gas(2300).value(fee)();\n            externalCallFlag = false;\n        }", "highlightLines": [168]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 168, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "144c1e95d482", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "            SGX_ADDRESS.send(fee);", "highlightLines": [175]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 175, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "4f30b005e7cd", "fix": {"template": null, "available": false}, "title": "send() return value not checked - Ether may be stuck if recipient reverts", "ruleId": "rules.sol-unchecked-send-return", "snippet": {"code": "            SGX_ADDRESS.send(fee);", "highlightLines": [175]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 175, "column": 24}, "severity": "high", "references": [], "description": ""}, {"id": "f700d36bd122", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            externalCallFlag = true;\n            // <yes> <report> UNCHECKED_LL_CALLS\n            requests[requestId].requester.call.gas(2300).value(fee)();\n            externalCallFlag = false;", "highlightLines": [178]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 178, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "8d67fefeb6aa", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint callbackGas = (fee - MIN_FEE) / tx.gasprice; // gas left for the callback function", "highlightLines": [183]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 183, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ef34088b322b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint callbackGas = (fee - MIN_FEE) / tx.gasprice; // gas left for the callback function\n        DeliverInfo(requestId, fee, tx.gasprice, msg.gas, callbackGas, paramsHash, error, respData); // log the response information\n        if (callbackGas > msg.gas - 5000) {\n            callbackGas = msg.gas - 5000;\n        }", "highlightLines": [184]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 184, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "928ea3a2a9fb", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "        uint callbackGas = (fee - MIN_FEE) / tx.gasprice; // gas left for the callback function\n        DeliverInfo(requestId, fee, tx.gasprice, msg.gas, callbackGas, paramsHash, error, respData); // log the response information\n        if (callbackGas > msg.gas - 5000) {\n            callbackGas = msg.gas - 5000;", "highlightLines": [184]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 184, "column": 88}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "aa62b006d2fb", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        externalCallFlag = true;\n        // <yes> <report> UNCHECKED_LL_CALLS\n        requests[requestId].callbackAddr.call.gas(callbackGas)(requests[requestId].callbackFID, requestId, error, respData); // call the callback function in the application contract\n        externalCallFlag = false;", "highlightLines": [190]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 190, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "fd6425ed2bb5", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "            throw;", "highlightLines": [198]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 198, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "2181e01cf399", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint fee = requests[requestId].fee;", "highlightLines": [204]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 204, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "16b25fdc983c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint fee = requests[requestId].fee;\n        if (requests[requestId].requester == msg.sender && fee >= CANCELLATION_FEE) {\n            // If the request was sent by this user and has money left on it,\n            // then cancel it.\n            requests[requestId].fee = CANCELLED_FEE_FLAG;\n            externalCallFlag = true;\n            if (!msg.sender.call.value(fee - CANCELLATION_FEE)()) {\n                throw;\n            }\n            externalCallFlag = false;\n            Cancel(requestId, msg.sender, requests[requestId].requester, requests[requestId].fee, 1);\n            return SUCCESS_FLAG;\n        } else {\n            Cancel(requestId, msg.sender, requests[requestId].requester, fee, -1);\n            return FAIL_FLAG;\n        }", "highlightLines": [205]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 205, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "16af06760286", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            requests[requestId].fee = CANCELLED_FEE_FLAG;\n            externalCallFlag = true;", "highlightLines": [209]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 209, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "030c5eb9ec3a", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            externalCallFlag = true;\n            if (!msg.sender.call.value(fee - CANCELLATION_FEE)()) {\n                throw;\n            }\n            externalCallFlag = false;", "highlightLines": [210]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 210, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "5a5ef3d8d37e", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "                throw;", "highlightLines": [212]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x89c1b3807d4c67df034fffb62f3509561218d30b.sol", "line": 212, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "82e69b6c02a3", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.18;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x8fd1e427396ddb511533cf9abdbebd0a7e08da35.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "13d10b71c82a", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.18;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x8fd1e427396ddb511533cf9abdbebd0a7e08da35.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "8176e9c2bd6e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address newOwner;", "highlightLines": [11]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x8fd1e427396ddb511533cf9abdbebd0a7e08da35.sol", "line": 11, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8c306f608444", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address owner = msg.sender;", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x8fd1e427396ddb511533cf9abdbebd0a7e08da35.sol", "line": 12, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "99bdcec77b1c", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "    address owner = msg.sender;", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x8fd1e427396ddb511533cf9abdbebd0a7e08da35.sol", "line": 12, "column": 5}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "2a73130c526a", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "    address owner = msg.sender;", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x8fd1e427396ddb511533cf9abdbebd0a7e08da35.sol", "line": 12, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "7f9829630e78", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    onlyOwner", "highlightLines": [16]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x8fd1e427396ddb511533cf9abdbebd0a7e08da35.sol", "line": 16, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "582c21f26575", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "            owner=newOwner;", "highlightLines": [26]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x8fd1e427396ddb511533cf9abdbebd0a7e08da35.sol", "line": 26, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "5c916376c18d", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyOwner\n    {\n        if(owner == msg.sender)_;\n    }", "highlightLines": [30]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x8fd1e427396ddb511533cf9abdbebd0a7e08da35.sol", "line": 30, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "b45bddf6358f", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract Token is Ownable\n{\n    address owner = msg.sender;", "highlightLines": [36]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x8fd1e427396ddb511533cf9abdbebd0a7e08da35.sol", "line": 36, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "8c4747d591f1", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address owner = msg.sender;", "highlightLines": [38]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x8fd1e427396ddb511533cf9abdbebd0a7e08da35.sol", "line": 38, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "99edd30167a5", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "    address owner = msg.sender;", "highlightLines": [38]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x8fd1e427396ddb511533cf9abdbebd0a7e08da35.sol", "line": 38, "column": 5}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "85eca08a0e6e", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "    address owner = msg.sender;", "highlightLines": [38]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x8fd1e427396ddb511533cf9abdbebd0a7e08da35.sol", "line": 38, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "55d18ed2bddb", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    onlyOwner", "highlightLines": [41]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x8fd1e427396ddb511533cf9abdbebd0a7e08da35.sol", "line": 41, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "9b579b22a555", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "        token.call(bytes4(sha3(\"transfer(address,uint256)\")),to,amount);", "highlightLines": [44]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x8fd1e427396ddb511533cf9abdbebd0a7e08da35.sol", "line": 44, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "af317e0d45b7", "fix": {"template": null, "available": false}, "title": "sha3() is deprecated - use keccak256() instead", "ruleId": "rules.sol-deprecated-sha3", "snippet": {"code": "        token.call(bytes4(sha3(\"transfer(address,uint256)\")),to,amount);", "highlightLines": [44]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x8fd1e427396ddb511533cf9abdbebd0a7e08da35.sol", "line": 44, "column": 27}, "severity": "info", "references": [], "description": ""}, {"id": "4ccc7a86dd2a", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract TokenBank is Token\n{\n    uint public MinDeposit;", "highlightLines": [48]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x8fd1e427396ddb511533cf9abdbebd0a7e08da35.sol", "line": 48, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "d8e876634b03", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        owner = msg.sender;", "highlightLines": [57]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x8fd1e427396ddb511533cf9abdbebd0a7e08da35.sol", "line": 57, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "68e7f206b5f3", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        owner = msg.sender;\n        MinDeposit = 1 ether;", "highlightLines": [57]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x8fd1e427396ddb511533cf9abdbebd0a7e08da35.sol", "line": 57, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "2d6068cfa9a9", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function()\n    payable\n    {\n        Deposit();\n    }", "highlightLines": [61]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x8fd1e427396ddb511533cf9abdbebd0a7e08da35.sol", "line": 61, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "ddbccfd1d13c", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function Deposit() \n    payable\n    {\n        if(msg.value>=MinDeposit)\n        {\n            Holders[msg.sender]+=msg.value;\n        }\n    }", "highlightLines": [67]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x8fd1e427396ddb511533cf9abdbebd0a7e08da35.sol", "line": 67, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "0b6c7c0d2c87", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    onlyOwner", "highlightLines": [78]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x8fd1e427396ddb511533cf9abdbebd0a7e08da35.sol", "line": 78, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "5c29fd9eba51", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    onlyOwner", "highlightLines": [89]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x8fd1e427396ddb511533cf9abdbebd0a7e08da35.sol", "line": 89, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "08d6715c9168", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.16;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x958a8f594101d2c0485a52319f29b2647f2ebc06.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "bde74c0e8d8d", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.16;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x958a8f594101d2c0485a52319f29b2647f2ebc06.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "bf04f1c2aab6", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyOwner() {\n        require(msg.sender == owner);\n        _;\n    }", "highlightLines": [20]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x958a8f594101d2c0485a52319f29b2647f2ebc06.sol", "line": 20, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "36ee894cb0c4", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "    modifier onlyOwner() {\n        require(msg.sender == owner);\n        _;\n    }", "highlightLines": [20]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x958a8f594101d2c0485a52319f29b2647f2ebc06.sol", "line": 20, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "5e5c6f25edbf", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "        require(msg.sender == owner);", "highlightLines": [21]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x958a8f594101d2c0485a52319f29b2647f2ebc06.sol", "line": 21, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "5b6891f1e1ef", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender == owner);", "highlightLines": [21]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x958a8f594101d2c0485a52319f29b2647f2ebc06.sol", "line": 21, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "0e3133165a40", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [22]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x958a8f594101d2c0485a52319f29b2647f2ebc06.sol", "line": 22, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "aa6c0e05245d", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function Owned() {\n        owner = msg.sender;\n    }", "highlightLines": [28]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x958a8f594101d2c0485a52319f29b2647f2ebc06.sol", "line": 28, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "4bfc29226146", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        owner = msg.sender;", "highlightLines": [29]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x958a8f594101d2c0485a52319f29b2647f2ebc06.sol", "line": 29, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "97087b85b195", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function changeOwner(address _newOwner) onlyOwner {\n        newOwner = _newOwner;\n    }", "highlightLines": [37]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x958a8f594101d2c0485a52319f29b2647f2ebc06.sol", "line": 37, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "00dd55de0a86", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function changeOwner(address _newOwner) onlyOwner {", "highlightLines": [37]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x958a8f594101d2c0485a52319f29b2647f2ebc06.sol", "line": 37, "column": 45}, "severity": "info", "references": [], "description": ""}, {"id": "f2b66e899557", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function acceptOwnership() {\n        if (msg.sender == newOwner) {\n            owner = newOwner;\n        }\n    }", "highlightLines": [44]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x958a8f594101d2c0485a52319f29b2647f2ebc06.sol", "line": 44, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "99c712469269", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "            owner = newOwner;", "highlightLines": [46]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x958a8f594101d2c0485a52319f29b2647f2ebc06.sol", "line": 46, "column": 13}, "severity": "info", "references": [], "description": ""}, {"id": "d361fdaa7f73", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function execute(address _dst, uint _value, bytes _data) onlyOwner {\n         // <yes> <report> UNCHECKED_LL_CALLS\n        _dst.call.value(_value)(_data);\n    }", "highlightLines": [53]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x958a8f594101d2c0485a52319f29b2647f2ebc06.sol", "line": 53, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "a11b56274331", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function execute(address _dst, uint _value, bytes _data) onlyOwner {", "highlightLines": [53]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x958a8f594101d2c0485a52319f29b2647f2ebc06.sol", "line": 53, "column": 62}, "severity": "info", "references": [], "description": ""}, {"id": "28a0f2933e45", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract Marriage is Owned\n{\n    // Marriage data variables\n    string public partner1;\n    string public partner2;\n    uint public marriageDate;\n    string public marriageStatus;\n    string public vows;\n\n    Event[] public majorEvents;\n    Message[] public messages;\n\n    struct Event {\n        uint date;\n        string name;\n        string description;\n        string url;", "highlightLines": [60]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x958a8f594101d2c0485a52319f29b2647f2ebc06.sol", "line": 60, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "ad2336dcf810", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint date;", "highlightLines": [73]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x958a8f594101d2c0485a52319f29b2647f2ebc06.sol", "line": 73, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a23d63cdc904", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        string name;", "highlightLines": [74]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x958a8f594101d2c0485a52319f29b2647f2ebc06.sol", "line": 74, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e7f1c3821579", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        string description;", "highlightLines": [75]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x958a8f594101d2c0485a52319f29b2647f2ebc06.sol", "line": 75, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d3eb46a31827", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        string url;", "highlightLines": [76]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x958a8f594101d2c0485a52319f29b2647f2ebc06.sol", "line": 76, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "1b7e3fcc9867", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint date;", "highlightLines": [80]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x958a8f594101d2c0485a52319f29b2647f2ebc06.sol", "line": 80, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4bda2fc25a98", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        string nameFrom;", "highlightLines": [81]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x958a8f594101d2c0485a52319f29b2647f2ebc06.sol", "line": 81, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "96ef115474df", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        string text;", "highlightLines": [82]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x958a8f594101d2c0485a52319f29b2647f2ebc06.sol", "line": 82, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "d0d6c66cf0e5", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        string url;", "highlightLines": [83]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x958a8f594101d2c0485a52319f29b2647f2ebc06.sol", "line": 83, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "6cefa7f342c1", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint value;", "highlightLines": [84]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x958a8f594101d2c0485a52319f29b2647f2ebc06.sol", "line": 84, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8168ae38d168", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier areMarried {\n        require(sha3(marriageStatus) == sha3(\"Married\"));\n        _;\n    }", "highlightLines": [87]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x958a8f594101d2c0485a52319f29b2647f2ebc06.sol", "line": 87, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "499bd24a9717", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(sha3(marriageStatus) == sha3(\"Married\"));", "highlightLines": [88]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x958a8f594101d2c0485a52319f29b2647f2ebc06.sol", "line": 88, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "397a9ac61d5d", "fix": {"template": null, "available": false}, "title": "sha3() is deprecated - use keccak256() instead", "ruleId": "rules.sol-deprecated-sha3", "snippet": {"code": "        require(sha3(marriageStatus) == sha3(\"Married\"));", "highlightLines": [88]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x958a8f594101d2c0485a52319f29b2647f2ebc06.sol", "line": 88, "column": 17}, "severity": "info", "references": [], "description": ""}, {"id": "78b3c6cbb838", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [89]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x958a8f594101d2c0485a52319f29b2647f2ebc06.sol", "line": 89, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "33be80a8a2f6", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function Marriage(address _owner) {\n        owner = _owner;\n    }", "highlightLines": [93]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x958a8f594101d2c0485a52319f29b2647f2ebc06.sol", "line": 93, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "af1305dc048d", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        owner = _owner;", "highlightLines": [94]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x958a8f594101d2c0485a52319f29b2647f2ebc06.sol", "line": 94, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "91fa39cc25f5", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function createMarriage(\n        string _partner1,\n        string _partner2,\n        string _vows,\n        string url) onlyOwner\n    {\n        require(majorEvents.length == 0);\n        partner1 = _partner1;\n        partner2 = _partner2;\n        marriageDate = now;\n        vows = _vows;\n        marriageStatus = \"Married\";\n        majorEvents.push(Event(now, \"Marriage\", vows, url));\n        MajorEvent(\"Marrigage\", vows, url);\n    }", "highlightLines": [106]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x958a8f594101d2c0485a52319f29b2647f2ebc06.sol", "line": 106, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "20997e4f7811", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "        string url) onlyOwner", "highlightLines": [110]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x958a8f594101d2c0485a52319f29b2647f2ebc06.sol", "line": 110, "column": 21}, "severity": "info", "references": [], "description": ""}, {"id": "f59c99d8a405", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(majorEvents.length == 0);", "highlightLines": [112]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x958a8f594101d2c0485a52319f29b2647f2ebc06.sol", "line": 112, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "c6e341efb0f7", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        partner1 = _partner1;\n        partner2 = _partner2;", "highlightLines": [113]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x958a8f594101d2c0485a52319f29b2647f2ebc06.sol", "line": 113, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "56ec145ccff2", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        partner2 = _partner2;\n        marriageDate = now;", "highlightLines": [114]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x958a8f594101d2c0485a52319f29b2647f2ebc06.sol", "line": 114, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "b94e5eb67a59", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        marriageDate = now;\n        vows = _vows;", "highlightLines": [115]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x958a8f594101d2c0485a52319f29b2647f2ebc06.sol", "line": 115, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "0432e47b80a2", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        vows = _vows;\n        marriageStatus = \"Married\";", "highlightLines": [116]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x958a8f594101d2c0485a52319f29b2647f2ebc06.sol", "line": 116, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "30a40fbc83db", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function setStatus(string status, string url) onlyOwner\n    {\n        marriageStatus = status;\n        setMajorEvent(\"Changed Status\", status, url);\n    }", "highlightLines": [123]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x958a8f594101d2c0485a52319f29b2647f2ebc06.sol", "line": 123, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "776cca8aa51b", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function setStatus(string status, string url) onlyOwner", "highlightLines": [123]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x958a8f594101d2c0485a52319f29b2647f2ebc06.sol", "line": 123, "column": 51}, "severity": "info", "references": [], "description": ""}, {"id": "63facba1816c", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function setMajorEvent(string name, string description, string url) onlyOwner areMarried\n    {\n        majorEvents.push(Event(now, name, description, url));\n        MajorEvent(name, description, url);\n    }", "highlightLines": [130]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x958a8f594101d2c0485a52319f29b2647f2ebc06.sol", "line": 130, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "f5d605a738c2", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function setMajorEvent(string name, string description, string url) onlyOwner areMarried", "highlightLines": [130]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x958a8f594101d2c0485a52319f29b2647f2ebc06.sol", "line": 130, "column": 73}, "severity": "info", "references": [], "description": ""}, {"id": "02be66689598", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function sendMessage(string nameFrom, string text, string url) payable areMarried {\n        if (msg.value > 0) {\n            owner.transfer(this.balance);\n        }\n        messages.push(Message(now, nameFrom, text, url, msg.value));\n        MessageSent(nameFrom, text, url, msg.value);\n    }", "highlightLines": [136]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x958a8f594101d2c0485a52319f29b2647f2ebc06.sol", "line": 136, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "336dcdc889e4", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "            owner.transfer(this.balance);", "highlightLines": [138]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x958a8f594101d2c0485a52319f29b2647f2ebc06.sol", "line": 138, "column": 13}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "561f8315aeb9", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "            owner.transfer(this.balance);", "highlightLines": [138]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x958a8f594101d2c0485a52319f29b2647f2ebc06.sol", "line": 138, "column": 18}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "e4fdb0e1b3a5", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event MajorEvent(string name, string description, string url);", "highlightLines": [146]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x958a8f594101d2c0485a52319f29b2647f2ebc06.sol", "line": 146, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "5cbbdc540d6c", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event MessageSent(string name, string description, string url, uint value);", "highlightLines": [147]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x958a8f594101d2c0485a52319f29b2647f2ebc06.sol", "line": 147, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "3d69b76f662f", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.23;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x9d06cbafa865037a01d322d3f4222fa3e04e5488.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "26049c850870", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.23;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x9d06cbafa865037a01d322d3f4222fa3e04e5488.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "d216af866209", "fix": {"template": null, "available": false}, "title": "Owner address is hardcoded - verify this is the correct trusted address", "ruleId": "rules.sol-ethernaut-owner-hardcoded", "snippet": {"code": "\taddress public owner = 0x788c45dd60ae4dbe5055b5ac02384d5dc84677b0;", "highlightLines": [25]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x9d06cbafa865037a01d322d3f4222fa3e04e5488.sol", "line": 25, "column": 2}, "severity": "info", "references": [], "description": ""}, {"id": "607150d3d9c9", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "\taddress public owner = 0x788c45dd60ae4dbe5055b5ac02384d5dc84677b0;", "highlightLines": [25]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x9d06cbafa865037a01d322d3f4222fa3e04e5488.sol", "line": 25, "column": 17}, "severity": "info", "references": [], "description": ""}, {"id": "1d1917d0fbf8", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "\tuint public token_price = 10**18*1/1000;", "highlightLines": [29]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x9d06cbafa865037a01d322d3f4222fa3e04e5488.sol", "line": 29, "column": 28}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "36f923c64d5f", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimal assumption - tokens with >18 or <18 decimals will cause overflow/underflow", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "\tuint public token_price = 10**18*1/1000;", "highlightLines": [29]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x9d06cbafa865037a01d322d3f4222fa3e04e5488.sol", "line": 29, "column": 28}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20"], "description": ""}, {"id": "5b81ac80820d", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "\tfunction() payable {        \n\t    tokens_buy();        \n\t}", "highlightLines": [32]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x9d06cbafa865037a01d322d3f4222fa3e04e5488.sol", "line": 32, "column": 2}, "severity": "medium", "references": [], "description": ""}, {"id": "7c663e625ce6", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "    function tokens_buy() payable returns (bool) {         \n        \n        require(active > 0);\n        require(msg.value >= token_price);        \n\n        uint tokens_buy = msg.value*10**18/token_price;\n\n        require(tokens_buy > 0);", "highlightLines": [39]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x9d06cbafa865037a01d322d3f4222fa3e04e5488.sol", "line": 39, "column": 5}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "79644384e396", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function tokens_buy() payable returns (bool) {         \n        \n        require(active > 0);\n        require(msg.value >= token_price);        \n\n        uint tokens_buy = msg.value*10**18/token_price;\n\n        require(tokens_buy > 0);\n\n        if(!c.call(bytes4(sha3(\"transferFrom(address,address,uint256)\")),owner, msg.sender,tokens_buy)){\n        \treturn false;\n        }\n\n        uint sum2 = msg.value * 3 / 10;           \n        // <yes> <report> UNCHECKED_LL_CALLS\n        owner2.send(sum2);\n\n        return true;\n      }", "highlightLines": [39]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x9d06cbafa865037a01d322d3f4222fa3e04e5488.sol", "line": 39, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "543af18ef4d3", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(active > 0);", "highlightLines": [41]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x9d06cbafa865037a01d322d3f4222fa3e04e5488.sol", "line": 41, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "ec27fd6ccbe0", "fix": {"template": null, "available": false}, "title": "Function mixes 'return false' with require() - inconsistent error handling pattern", "ruleId": "rules.sol-mixed-return-false-require", "snippet": {"code": "        require(active > 0);\n        require(msg.value >= token_price);        \n\n        uint tokens_buy = msg.value*10**18/token_price;\n\n        require(tokens_buy > 0);\n\n        if(!c.call(bytes4(sha3(\"transferFrom(address,address,uint256)\")),owner, msg.sender,tokens_buy)){\n        \treturn false;", "highlightLines": [41]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x9d06cbafa865037a01d322d3f4222fa3e04e5488.sol", "line": 41, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "0c4fa387624d", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.value >= token_price);", "highlightLines": [42]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x9d06cbafa865037a01d322d3f4222fa3e04e5488.sol", "line": 42, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "7fe2b6f506b1", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint tokens_buy = msg.value*10**18/token_price;", "highlightLines": [43]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x9d06cbafa865037a01d322d3f4222fa3e04e5488.sol", "line": 43, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "67183226b606", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint tokens_buy = msg.value*10**18/token_price;\n\n        require(tokens_buy > 0);\n\n        if(!c.call(bytes4(sha3(\"transferFrom(address,address,uint256)\")),owner, msg.sender,tokens_buy)){\n        \treturn false;\n        }\n\n        uint sum2 = msg.value * 3 / 10;", "highlightLines": [44]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x9d06cbafa865037a01d322d3f4222fa3e04e5488.sol", "line": 44, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "df453e2057c7", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimal assumption - tokens with >18 or <18 decimals will cause overflow/underflow", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        uint tokens_buy = msg.value*10**18/token_price;", "highlightLines": [44]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x9d06cbafa865037a01d322d3f4222fa3e04e5488.sol", "line": 44, "column": 36}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20"], "description": ""}, {"id": "84efe1589ccc", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "        uint tokens_buy = msg.value*10**18/token_price;", "highlightLines": [44]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x9d06cbafa865037a01d322d3f4222fa3e04e5488.sol", "line": 44, "column": 37}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "694b50506cee", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(tokens_buy > 0);", "highlightLines": [46]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x9d06cbafa865037a01d322d3f4222fa3e04e5488.sol", "line": 46, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "93f54900008f", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "        if(!c.call(bytes4(sha3(\"transferFrom(address,address,uint256)\")),owner, msg.sender,tokens_buy)){", "highlightLines": [48]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x9d06cbafa865037a01d322d3f4222fa3e04e5488.sol", "line": 48, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "45b0b45157e6", "fix": {"template": null, "available": false}, "title": "sha3() is deprecated - use keccak256() instead", "ruleId": "rules.sol-deprecated-sha3", "snippet": {"code": "        if(!c.call(bytes4(sha3(\"transferFrom(address,address,uint256)\")),owner, msg.sender,tokens_buy)){", "highlightLines": [48]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x9d06cbafa865037a01d322d3f4222fa3e04e5488.sol", "line": 48, "column": 27}, "severity": "info", "references": [], "description": ""}, {"id": "4d8a63c45ee3", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint sum2 = msg.value * 3 / 10;", "highlightLines": [51]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x9d06cbafa865037a01d322d3f4222fa3e04e5488.sol", "line": 51, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "52346b8bd2c8", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "        owner2.send(sum2);", "highlightLines": [54]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x9d06cbafa865037a01d322d3f4222fa3e04e5488.sol", "line": 54, "column": 9}, "severity": "high", "references": [], "description": ""}, {"id": "6861ff02be77", "fix": {"template": null, "available": false}, "title": "send() return value not checked - Ether may be stuck if recipient reverts", "ruleId": "rules.sol-unchecked-send-return", "snippet": {"code": "        owner2.send(sum2);", "highlightLines": [54]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x9d06cbafa865037a01d322d3f4222fa3e04e5488.sol", "line": 54, "column": 15}, "severity": "high", "references": [], "description": ""}, {"id": "2dc3beeea1eb", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "      function withdraw(uint256 _amount) onlyOwner returns (bool result) {", "highlightLines": [60]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x9d06cbafa865037a01d322d3f4222fa3e04e5488.sol", "line": 60, "column": 7}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "0d4035358fe4", "fix": {"template": null, "available": false}, "title": "Function accepts zero amount without validation - can cause division by zero or empty operations", "ruleId": "rules.sol-missing-zero-amount-check", "snippet": {"code": "      function withdraw(uint256 _amount) onlyOwner returns (bool result) {", "highlightLines": [60]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x9d06cbafa865037a01d322d3f4222fa3e04e5488.sol", "line": 60, "column": 7}, "severity": "info", "references": [], "description": ""}, {"id": "6412a476d334", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "      function withdraw(uint256 _amount) onlyOwner returns (bool result) {\n          uint256 balance;\n          balance = this.balance;\n          if(_amount > 0) balance = _amount;\n          // <yes> <report> UNCHECKED_LL_CALLS\n          owner.send(balance);\n          return true;\n      }", "highlightLines": [60]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x9d06cbafa865037a01d322d3f4222fa3e04e5488.sol", "line": 60, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "5a1d38f773a0", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "      function withdraw(uint256 _amount) onlyOwner returns (bool result) {", "highlightLines": [60]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x9d06cbafa865037a01d322d3f4222fa3e04e5488.sol", "line": 60, "column": 42}, "severity": "info", "references": [], "description": ""}, {"id": "4d10a5a416b6", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "          uint256 balance;", "highlightLines": [61]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x9d06cbafa865037a01d322d3f4222fa3e04e5488.sol", "line": 61, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "75dddd66b247", "fix": {"template": null, "available": false}, "title": "SWC-119: Local variable shadows state variable - may cause unintended behavior", "ruleId": "rules.sol-swc-119-shadowed-variable", "snippet": {"code": "          uint256 balance;", "highlightLines": [61]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x9d06cbafa865037a01d322d3f4222fa3e04e5488.sol", "line": 61, "column": 11}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-119"], "description": ""}, {"id": "e7a673740699", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "          balance = this.balance;\n          if(_amount > 0) balance = _amount;", "highlightLines": [62]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x9d06cbafa865037a01d322d3f4222fa3e04e5488.sol", "line": 62, "column": 11}, "severity": "medium", "references": [], "description": ""}, {"id": "7781e1d16986", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "          owner.send(balance);", "highlightLines": [65]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x9d06cbafa865037a01d322d3f4222fa3e04e5488.sol", "line": 65, "column": 11}, "severity": "high", "references": [], "description": ""}, {"id": "7ed9d7bb1f1e", "fix": {"template": null, "available": false}, "title": "send() return value not checked - Ether may be stuck if recipient reverts", "ruleId": "rules.sol-unchecked-send-return", "snippet": {"code": "          owner.send(balance);", "highlightLines": [65]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x9d06cbafa865037a01d322d3f4222fa3e04e5488.sol", "line": 65, "column": 16}, "severity": "high", "references": [], "description": ""}, {"id": "e18e2c5ed941", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "      function change_token_price(uint256 _token_price) onlyOwner returns (bool result) {\n        token_price = _token_price;\n        return true;\n      }", "highlightLines": [70]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x9d06cbafa865037a01d322d3f4222fa3e04e5488.sol", "line": 70, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "22a59d15bdb5", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "      function change_token_price(uint256 _token_price) onlyOwner returns (bool result) {", "highlightLines": [70]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x9d06cbafa865037a01d322d3f4222fa3e04e5488.sol", "line": 70, "column": 57}, "severity": "info", "references": [], "description": ""}, {"id": "e755655ebf0f", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "      function change_active(uint256 _active) onlyOwner returns (bool result) {\n        active = _active;\n        return true;\n      }", "highlightLines": [76]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x9d06cbafa865037a01d322d3f4222fa3e04e5488.sol", "line": 76, "column": 7}, "severity": "medium", "references": [], "description": ""}, {"id": "046a5ef22d46", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "      function change_active(uint256 _active) onlyOwner returns (bool result) {", "highlightLines": [76]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x9d06cbafa865037a01d322d3f4222fa3e04e5488.sol", "line": 76, "column": 47}, "severity": "info", "references": [], "description": ""}, {"id": "7d724b994fc0", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    \tmodifier onlyOwner() {\n        if (msg.sender != owner) {\n            throw;\n        }\n        _;\n    }", "highlightLines": [82]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x9d06cbafa865037a01d322d3f4222fa3e04e5488.sol", "line": 82, "column": 6}, "severity": "medium", "references": [], "description": ""}, {"id": "96cc8231c29d", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "            throw;", "highlightLines": [84]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x9d06cbafa865037a01d322d3f4222fa3e04e5488.sol", "line": 84, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "64ddfbd8690c", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [86]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0x9d06cbafa865037a01d322d3f4222fa3e04e5488.sol", "line": 86, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "9ef7c481f686", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.18;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xa1fceeff3acc57d257b917e30c4df661401d6431.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "6e7488d4f4de", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.18;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xa1fceeff3acc57d257b917e30c4df661401d6431.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "8b61da7e5441", "fix": {"template": null, "available": false}, "title": "SWC-118: Function name matches contract name - likely intended as constructor (pre-0.4.22)", "ruleId": "rules.sol-swc-118-constructor-mismatch", "snippet": {"code": "contract AirDropContract{\n\n    function AirDropContract() public {", "highlightLines": [9]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xa1fceeff3acc57d257b917e30c4df661401d6431.sol", "line": 9, "column": 1}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-118"], "description": ""}, {"id": "d229b7abc52a", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier validAddress( address addr ) {\n        require(addr != address(0x0));\n        require(addr != address(this));\n        _;\n    }", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xa1fceeff3acc57d257b917e30c4df661401d6431.sol", "line": 14, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "7eac5aaa7c54", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "    modifier validAddress( address addr ) {\n        require(addr != address(0x0));\n        require(addr != address(this));\n        _;\n    }", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xa1fceeff3acc57d257b917e30c4df661401d6431.sol", "line": 14, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "e6bc564a1c5e", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(addr != address(0x0));", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xa1fceeff3acc57d257b917e30c4df661401d6431.sol", "line": 15, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "2389372bcf4e", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(addr != address(this));", "highlightLines": [16]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xa1fceeff3acc57d257b917e30c4df661401d6431.sol", "line": 16, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "9e1e3278cc9d", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [17]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xa1fceeff3acc57d257b917e30c4df661401d6431.sol", "line": 17, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "6e383866f6c3", "fix": {"template": null, "available": false}, "title": "ERC20 function signature doesn't match standard - may cause integration issues", "ruleId": "rules.sol-incorrect-erc20-interface", "snippet": {"code": "    function transfer(address contract_address,address[] tos,uint[] vs)\n        public \n        validAddress(contract_address)\n        returns (bool){", "highlightLines": [20]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xa1fceeff3acc57d257b917e30c4df661401d6431.sol", "line": 20, "column": 5}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-erc20-interface"], "description": ""}, {"id": "6866ceb8e06d", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "    function transfer(address contract_address,address[] tos,uint[] vs)\n        public \n        validAddress(contract_address)\n        returns (bool){\n\n        require(tos.length > 0);\n        require(vs.length > 0);\n        require(tos.length == vs.length);", "highlightLines": [20]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xa1fceeff3acc57d257b917e30c4df661401d6431.sol", "line": 20, "column": 5}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "3370f21cc6e0", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(tos.length > 0);", "highlightLines": [25]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xa1fceeff3acc57d257b917e30c4df661401d6431.sol", "line": 25, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "c7d8e52bd462", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(vs.length > 0);", "highlightLines": [26]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xa1fceeff3acc57d257b917e30c4df661401d6431.sol", "line": 26, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "2a48437c19af", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(tos.length == vs.length);", "highlightLines": [27]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xa1fceeff3acc57d257b917e30c4df661401d6431.sol", "line": 27, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "806e693fe869", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes4 id = bytes4(keccak256(\"transferFrom(address,address,uint256)\"));", "highlightLines": [28]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xa1fceeff3acc57d257b917e30c4df661401d6431.sol", "line": 28, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c1b2a7cd5941", "fix": {"template": null, "available": false}, "title": "Empty array bypasses loop logic - add length check before loop", "ruleId": "rules.sol-empty-array-loop-bypass", "snippet": {"code": "        for(uint i = 0 ; i < tos.length; i++){", "highlightLines": [29]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xa1fceeff3acc57d257b917e30c4df661401d6431.sol", "line": 29, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/empty-loop.sol"], "description": ""}, {"id": "9819d0f5675a", "fix": {"template": null, "available": false}, "title": "Loop with external transfers - one failing recipient blocks all others", "ruleId": "rules.sol-denial-of-service-loop-transfer", "snippet": {"code": "        for(uint i = 0 ; i < tos.length; i++){\n            // <yes> <report> UNCHECKED_LL_CALLS\n            contract_address.call(id, msg.sender, tos[i], vs[i]);", "highlightLines": [29]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xa1fceeff3acc57d257b917e30c4df661401d6431.sol", "line": 29, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "8c15dd43db1f", "fix": {"template": null, "available": false}, "title": "Unbounded loop iterating over dynamic array - can cause out-of-gas DoS", "ruleId": "rules.sol-unbounded-loop-dos", "snippet": {"code": "        for(uint i = 0 ; i < tos.length; i++){\n            // <yes> <report> UNCHECKED_LL_CALLS\n            contract_address.call(id, msg.sender, tos[i], vs[i]);", "highlightLines": [29]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xa1fceeff3acc57d257b917e30c4df661401d6431.sol", "line": 29, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "ddd663e6eed1", "fix": {"template": null, "available": false}, "title": "Unbounded loop over dynamic array - can cause DoS if array grows large", "ruleId": "rules.sol-unbounded-protocol-loop", "snippet": {"code": "        for(uint i = 0 ; i < tos.length; i++){\n            // <yes> <report> UNCHECKED_LL_CALLS\n            contract_address.call(id, msg.sender, tos[i], vs[i]);", "highlightLines": [29]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xa1fceeff3acc57d257b917e30c4df661401d6431.sol", "line": 29, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "c45b20246ea1", "fix": {"template": null, "available": false}, "title": "Unbounded loop over array - potential DOS via gas limit", "ruleId": "rules.sol-unbounded-loop", "snippet": {"code": "        for(uint i = 0 ; i < tos.length; i++){\n            // <yes> <report> UNCHECKED_LL_CALLS\n            contract_address.call(id, msg.sender, tos[i], vs[i]);\n        }", "highlightLines": [29]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xa1fceeff3acc57d257b917e30c4df661401d6431.sol", "line": 29, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "db7107442850", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "            contract_address.call(id, msg.sender, tos[i], vs[i]);", "highlightLines": [31]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xa1fceeff3acc57d257b917e30c4df661401d6431.sol", "line": 31, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "388fc463c94f", "fix": {"template": null, "available": false}, "title": "External call in loop - gas griefing and DOS risk", "ruleId": "rules.sol-external-call-in-loop", "snippet": {"code": "            contract_address.call(id, msg.sender, tos[i], vs[i]);", "highlightLines": [31]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xa1fceeff3acc57d257b917e30c4df661401d6431.sol", "line": 31, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "26df70b24f5c", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.18;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xa46edd6a9a93feec36576ee5048146870ea2c3ae.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "9e4286c0784e", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.18;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xa46edd6a9a93feec36576ee5048146870ea2c3ae.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "d4a19e16e5f1", "fix": {"template": null, "available": false}, "title": "Self transfer not checked - can cause balance corruption with from == to", "ruleId": "rules.sol-self-transfer-unchecked", "snippet": {"code": "    function transfer(address from,address caddress,address[] _tos,uint[] v)public returns (bool){", "highlightLines": [11]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xa46edd6a9a93feec36576ee5048146870ea2c3ae.sol", "line": 11, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/self-transfer.sol"], "description": ""}, {"id": "8107379d9886", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "    function transfer(address from,address caddress,address[] _tos,uint[] v)public returns (bool){\n        require(_tos.length > 0);", "highlightLines": [11]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xa46edd6a9a93feec36576ee5048146870ea2c3ae.sol", "line": 11, "column": 5}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "6a663fd4429f", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_tos.length > 0);", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xa46edd6a9a93feec36576ee5048146870ea2c3ae.sol", "line": 12, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "357ffb8e9ae2", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes4 id=bytes4(keccak256(\"transferFrom(address,address,uint256)\"));", "highlightLines": [13]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xa46edd6a9a93feec36576ee5048146870ea2c3ae.sol", "line": 13, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e7b7855d8b9d", "fix": {"template": null, "available": false}, "title": "Empty array bypasses loop logic - add length check before loop", "ruleId": "rules.sol-empty-array-loop-bypass", "snippet": {"code": "        for(uint i=0;i<_tos.length;i++){", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xa46edd6a9a93feec36576ee5048146870ea2c3ae.sol", "line": 14, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/empty-loop.sol"], "description": ""}, {"id": "fd044ef13fb3", "fix": {"template": null, "available": false}, "title": "Unbounded loop iterating over dynamic array - can cause out-of-gas DoS", "ruleId": "rules.sol-unbounded-loop-dos", "snippet": {"code": "        for(uint i=0;i<_tos.length;i++){\n            // <yes> <report> UNCHECKED_LL_CALLS\n            caddress.call(id,from,_tos[i],v[i]);", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xa46edd6a9a93feec36576ee5048146870ea2c3ae.sol", "line": 14, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "59c1ca45ac79", "fix": {"template": null, "available": false}, "title": "Unbounded loop over dynamic array - can cause DoS if array grows large", "ruleId": "rules.sol-unbounded-protocol-loop", "snippet": {"code": "        for(uint i=0;i<_tos.length;i++){\n            // <yes> <report> UNCHECKED_LL_CALLS\n            caddress.call(id,from,_tos[i],v[i]);", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xa46edd6a9a93feec36576ee5048146870ea2c3ae.sol", "line": 14, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "800e8227f0dd", "fix": {"template": null, "available": false}, "title": "Loop with external transfers - one failing recipient blocks all others", "ruleId": "rules.sol-denial-of-service-loop-transfer", "snippet": {"code": "        for(uint i=0;i<_tos.length;i++){\n            // <yes> <report> UNCHECKED_LL_CALLS\n            caddress.call(id,from,_tos[i],v[i]);", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xa46edd6a9a93feec36576ee5048146870ea2c3ae.sol", "line": 14, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "a2f2de2a9d98", "fix": {"template": null, "available": false}, "title": "Unbounded loop over array - potential DOS via gas limit", "ruleId": "rules.sol-unbounded-loop", "snippet": {"code": "        for(uint i=0;i<_tos.length;i++){\n            // <yes> <report> UNCHECKED_LL_CALLS\n            caddress.call(id,from,_tos[i],v[i]);\n        }", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xa46edd6a9a93feec36576ee5048146870ea2c3ae.sol", "line": 14, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "3d1f9230ef5d", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "            caddress.call(id,from,_tos[i],v[i]);", "highlightLines": [16]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xa46edd6a9a93feec36576ee5048146870ea2c3ae.sol", "line": 16, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "c89368a51e73", "fix": {"template": null, "available": false}, "title": "External call in loop - gas griefing and DOS risk", "ruleId": "rules.sol-external-call-in-loop", "snippet": {"code": "            caddress.call(id,from,_tos[i],v[i]);", "highlightLines": [16]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xa46edd6a9a93feec36576ee5048146870ea2c3ae.sol", "line": 16, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "aa003744568f", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.23;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb0510d68f210b7db66e8c7c814f22680f2b8d1d6.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "e93052e576ab", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.23;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb0510d68f210b7db66e8c7c814f22680f2b8d1d6.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "bf472ddc0de6", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "\t\towner = msg.sender;", "highlightLines": [22]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb0510d68f210b7db66e8c7c814f22680f2b8d1d6.sol", "line": 22, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "e49467fd0f57", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "\t\towner = msg.sender;\n\t\tnewPuppet();\n\t\tnewPuppet();\n\t\tnewPuppet();\n\t\tnewPuppet();\n\t\textra[0] = puppets[0];", "highlightLines": [22]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb0510d68f210b7db66e8c7c814f22680f2b8d1d6.sol", "line": 22, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "658670ef9105", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "\t\textra[0] = puppets[0];\n        extra[1] = puppets[1];", "highlightLines": [27]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb0510d68f210b7db66e8c7c814f22680f2b8d1d6.sol", "line": 27, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "29d0b9ae178d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        extra[1] = puppets[1];\n        extra[2] = puppets[2];", "highlightLines": [28]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb0510d68f210b7db66e8c7c814f22680f2b8d1d6.sol", "line": 28, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "73018e21ffa1", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        extra[2] = puppets[2];\n        extra[3] = puppets[3];", "highlightLines": [29]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb0510d68f210b7db66e8c7c814f22680f2b8d1d6.sol", "line": 29, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "7122b06a2201", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "\tfunction withdraw() public{", "highlightLines": [35]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb0510d68f210b7db66e8c7c814f22680f2b8d1d6.sol", "line": 35, "column": 2}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "5886f322803a", "fix": {"template": null, "available": false}, "title": "SWC-105: Ether withdrawal without access control - anyone can drain funds", "ruleId": "rules.sol-swc-105-unprotected-withdrawal", "snippet": {"code": "\tfunction withdraw() public{\n\t\trequire(msg.sender == owner);\n\t\towner.transfer(address(this).balance);", "highlightLines": [35]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb0510d68f210b7db66e8c7c814f22680f2b8d1d6.sol", "line": 35, "column": 2}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-105"], "description": ""}, {"id": "115f43416618", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "\t\trequire(msg.sender == owner);", "highlightLines": [36]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb0510d68f210b7db66e8c7c814f22680f2b8d1d6.sol", "line": 36, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "a859e1a0edee", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "\t\trequire(msg.sender == owner);", "highlightLines": [36]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb0510d68f210b7db66e8c7c814f22680f2b8d1d6.sol", "line": 36, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "deca696910bf", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "\t\towner.transfer(address(this).balance);", "highlightLines": [37]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb0510d68f210b7db66e8c7c814f22680f2b8d1d6.sol", "line": 37, "column": 3}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "2e38cdaaa5c2", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "\t\towner.transfer(address(this).balance);", "highlightLines": [37]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb0510d68f210b7db66e8c7c814f22680f2b8d1d6.sol", "line": 37, "column": 8}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "3bb2354cc3c7", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "\t    require(msg.sender == owner);", "highlightLines": [49]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb0510d68f210b7db66e8c7c814f22680f2b8d1d6.sol", "line": 49, "column": 6}, "severity": "info", "references": [], "description": ""}, {"id": "650560026372", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "\t    require(msg.sender == owner);", "highlightLines": [49]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb0510d68f210b7db66e8c7c814f22680f2b8d1d6.sol", "line": 49, "column": 6}, "severity": "info", "references": [], "description": ""}, {"id": "d6b90b19f353", "fix": {"template": null, "available": false}, "title": "Contract addresses are deterministic - CREATE addresses can be computed from deployer + nonce (Recovery pattern)", "ruleId": "rules.sol-recovery-address-calculation", "snippet": {"code": "    \tPuppet p = new Puppet();", "highlightLines": [50]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb0510d68f210b7db66e8c7c814f22680f2b8d1d6.sol", "line": 50, "column": 17}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/17"], "description": ""}, {"id": "6d52e45ae32e", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_newExtra != address(0));", "highlightLines": [58]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb0510d68f210b7db66e8c7c814f22680f2b8d1d6.sol", "line": 58, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "85cd6a4fdf9e", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "        require(msg.sender == owner);", "highlightLines": [66]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb0510d68f210b7db66e8c7c814f22680f2b8d1d6.sol", "line": 66, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "20b162b365bc", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender == owner);", "highlightLines": [66]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb0510d68f210b7db66e8c7c814f22680f2b8d1d6.sol", "line": 66, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "6fa0453ef49b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "\t\ttarget[0] = 0x509Cb8cB2F8ba04aE81eEC394175707Edd37e109;\n        master[0] = 0x5C035Bb4Cb7dacbfeE076A5e61AA39a10da2E956;", "highlightLines": [92]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb0510d68f210b7db66e8c7c814f22680f2b8d1d6.sol", "line": 92, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "de97b2f7dbce", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "\tfunction withdraw() public{", "highlightLines": [107]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb0510d68f210b7db66e8c7c814f22680f2b8d1d6.sol", "line": 107, "column": 2}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "d49e78148c10", "fix": {"template": null, "available": false}, "title": "SWC-105: Ether withdrawal without access control - anyone can drain funds", "ruleId": "rules.sol-swc-105-unprotected-withdrawal", "snippet": {"code": "\tfunction withdraw() public{\n\t\trequire(msg.sender == master[0]);\n\t\tmaster[0].transfer(address(this).balance);", "highlightLines": [107]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb0510d68f210b7db66e8c7c814f22680f2b8d1d6.sol", "line": 107, "column": 2}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-105"], "description": ""}, {"id": "ed83d5510de6", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "\t\trequire(msg.sender == master[0]);", "highlightLines": [108]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb0510d68f210b7db66e8c7c814f22680f2b8d1d6.sol", "line": 108, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "d92979016b57", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "\t\tmaster[0].transfer(address(this).balance);", "highlightLines": [109]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb0510d68f210b7db66e8c7c814f22680f2b8d1d6.sol", "line": 109, "column": 3}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "8d4735ea23ef", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "\t\tmaster[0].transfer(address(this).balance);", "highlightLines": [109]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb0510d68f210b7db66e8c7c814f22680f2b8d1d6.sol", "line": 109, "column": 12}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "2510347fd561", "fix": {"template": null, "available": false}, "title": "Local variable shadows state variable - may cause confusion and bugs", "ruleId": "rules.sol-shadowing-local", "snippet": {"code": "  function mul(uint256 a, uint256 b) internal pure returns (uint256 c) {\n    if (a == 0) {", "highlightLines": [118]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb0510d68f210b7db66e8c7c814f22680f2b8d1d6.sol", "line": 118, "column": 3}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#local-variable-shadowing"], "description": ""}, {"id": "e63447cc803f", "fix": {"template": null, "available": false}, "title": "SWC-110: assert() used for input validation - use require() instead, assert is for invariants", "ruleId": "rules.sol-swc-110-assert-user-input", "snippet": {"code": "    assert(b <= a);", "highlightLines": [132]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb0510d68f210b7db66e8c7c814f22680f2b8d1d6.sol", "line": 132, "column": 5}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-110"], "description": ""}, {"id": "ed24a1ef1e19", "fix": {"template": null, "available": false}, "title": "View/pure function modifies state - violates function declaration", "ruleId": "rules.sol-constant-function-state", "snippet": {"code": "  function add(uint256 a, uint256 b) internal pure returns (uint256 c) {\n    c = a + b;", "highlightLines": [136]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb0510d68f210b7db66e8c7c814f22680f2b8d1d6.sol", "line": 136, "column": 3}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#constant-functions-changing-the-state"], "description": ""}, {"id": "4cc28206ff9d", "fix": {"template": null, "available": false}, "title": "SWC-110: assert() used for input validation - use require() instead, assert is for invariants", "ruleId": "rules.sol-swc-110-assert-user-input", "snippet": {"code": "    assert(c >= a);", "highlightLines": [138]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb0510d68f210b7db66e8c7c814f22680f2b8d1d6.sol", "line": 138, "column": 5}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-110"], "description": ""}, {"id": "51b6621c0a17", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.24;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb11b2fed6c9354f7aa2f658d3b4d7b31d8a13b77.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "510ec4f251d9", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.24;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb11b2fed6c9354f7aa2f658d3b4d7b31d8a13b77.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "14e64590c796", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyOwner { if (msg.sender == Owner) _; } address Owner = msg.sender;", "highlightLines": [10]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb11b2fed6c9354f7aa2f658d3b4d7b31d8a13b77.sol", "line": 10, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "67a0d27ac1f6", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function transferOwner(address _owner) public onlyOwner { Owner = _owner; }", "highlightLines": [11]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb11b2fed6c9354f7aa2f658d3b4d7b31d8a13b77.sol", "line": 11, "column": 51}, "severity": "info", "references": [], "description": ""}, {"id": "6897f66be899", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract DepositProxy is Proxy {\n    address public Owner;", "highlightLines": [18]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb11b2fed6c9354f7aa2f658d3b4d7b31d8a13b77.sol", "line": 18, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "1ed723418428", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function deposit() public payable {", "highlightLines": [31]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb11b2fed6c9354f7aa2f658d3b4d7b31d8a13b77.sol", "line": 31, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "4eee0a8770d0", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function withdraw(uint256 amount) public onlyOwner {", "highlightLines": [37]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb11b2fed6c9354f7aa2f658d3b4d7b31d8a13b77.sol", "line": 37, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "88b74de3c2c3", "fix": {"template": null, "available": false}, "title": "Function accepts zero amount without validation - can cause division by zero or empty operations", "ruleId": "rules.sol-missing-zero-amount-check", "snippet": {"code": "    function withdraw(uint256 amount) public onlyOwner {", "highlightLines": [37]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb11b2fed6c9354f7aa2f658d3b4d7b31d8a13b77.sol", "line": 37, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "9a0d23111115", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function withdraw(uint256 amount) public onlyOwner {", "highlightLines": [37]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb11b2fed6c9354f7aa2f658d3b4d7b31d8a13b77.sol", "line": 37, "column": 46}, "severity": "info", "references": [], "description": ""}, {"id": "9e5cfebd9452", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "            msg.sender.transfer(amount);", "highlightLines": [39]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb11b2fed6c9354f7aa2f658d3b4d7b31d8a13b77.sol", "line": 39, "column": 13}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "ce02d2391a42", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.24;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb37f18af15bafb869a065b61fc83cfc44ed9cc27.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "091bb951ac3f", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.24;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb37f18af15bafb869a065b61fc83cfc44ed9cc27.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "81e3d202ab4a", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "    address public owner = msg.sender;", "highlightLines": [11]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb37f18af15bafb869a065b61fc83cfc44ed9cc27.sol", "line": 11, "column": 20}, "severity": "info", "references": [], "description": ""}, {"id": "d57a517827e8", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyOwner {\n        require(msg.sender == owner);\n        _;\n    }", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb37f18af15bafb869a065b61fc83cfc44ed9cc27.sol", "line": 14, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "34abc0b135e9", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "        require(msg.sender == owner);", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb37f18af15bafb869a065b61fc83cfc44ed9cc27.sol", "line": 15, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "1c7241b082eb", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender == owner);", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb37f18af15bafb869a065b61fc83cfc44ed9cc27.sol", "line": 15, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "8c0d01d8701d", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [16]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb37f18af15bafb869a065b61fc83cfc44ed9cc27.sol", "line": 16, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "64f2b2e30e4a", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function withdrawAll() public onlyOwner {", "highlightLines": [23]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb37f18af15bafb869a065b61fc83cfc44ed9cc27.sol", "line": 23, "column": 35}, "severity": "info", "references": [], "description": ""}, {"id": "95b11391e26f", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function withdraw(uint _value) public onlyOwner {", "highlightLines": [27]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb37f18af15bafb869a065b61fc83cfc44ed9cc27.sol", "line": 27, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "cebd155737b9", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function withdraw(uint _value) public onlyOwner {", "highlightLines": [27]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb37f18af15bafb869a065b61fc83cfc44ed9cc27.sol", "line": 27, "column": 43}, "severity": "info", "references": [], "description": ""}, {"id": "08e07c5e9f69", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        msg.sender.transfer(_value);", "highlightLines": [28]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb37f18af15bafb869a065b61fc83cfc44ed9cc27.sol", "line": 28, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "ffe677e7141c", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function sendMoney(address _target, uint _value) public onlyOwner {", "highlightLines": [31]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb37f18af15bafb869a065b61fc83cfc44ed9cc27.sol", "line": 31, "column": 61}, "severity": "info", "references": [], "description": ""}, {"id": "364960b5c729", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.23;", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb620cee6b52f96f3c6b253e6eea556aa2d214a99.sol", "line": 12, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "85270f169656", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.23;", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb620cee6b52f96f3c6b253e6eea556aa2d214a99.sol", "line": 12, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "06135e33fb36", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "\towner = msg.sender;", "highlightLines": [33]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb620cee6b52f96f3c6b253e6eea556aa2d214a99.sol", "line": 33, "column": 2}, "severity": "info", "references": [], "description": ""}, {"id": "471388cc99bc", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "modifier onlyOwner() {\n    require(msg.sender == owner);\n    _;\n}", "highlightLines": [38]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb620cee6b52f96f3c6b253e6eea556aa2d214a99.sol", "line": 38, "column": 1}, "severity": "medium", "references": [], "description": ""}, {"id": "9f10b808da7b", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    require(msg.sender == owner);", "highlightLines": [39]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb620cee6b52f96f3c6b253e6eea556aa2d214a99.sol", "line": 39, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "95d73fc4376c", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(msg.sender == owner);", "highlightLines": [39]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb620cee6b52f96f3c6b253e6eea556aa2d214a99.sol", "line": 39, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "997e64ac3a94", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    _;", "highlightLines": [40]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb620cee6b52f96f3c6b253e6eea556aa2d214a99.sol", "line": 40, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "509fa90b7b4c", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "modifier onlyWinner() {\n    require(msg.sender == winner);\n    _;\n}", "highlightLines": [43]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb620cee6b52f96f3c6b253e6eea556aa2d214a99.sol", "line": 43, "column": 1}, "severity": "medium", "references": [], "description": ""}, {"id": "a9eda02792ca", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(msg.sender == winner);", "highlightLines": [44]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb620cee6b52f96f3c6b253e6eea556aa2d214a99.sol", "line": 44, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "275a781e1118", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    _;", "highlightLines": [45]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb620cee6b52f96f3c6b253e6eea556aa2d214a99.sol", "line": 45, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "7882da503747", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "modifier onlyPlayers() {\n    require(approvedPlayers[msg.sender]);\n    _;\n}", "highlightLines": [48]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb620cee6b52f96f3c6b253e6eea556aa2d214a99.sol", "line": 48, "column": 1}, "severity": "medium", "references": [], "description": ""}, {"id": "0ead61a5e83c", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "modifier onlyPlayers() {\n    require(approvedPlayers[msg.sender]);\n    _;\n}", "highlightLines": [48]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb620cee6b52f96f3c6b253e6eea556aa2d214a99.sol", "line": 48, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "1b37ede266b2", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(approvedPlayers[msg.sender]);", "highlightLines": [49]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb620cee6b52f96f3c6b253e6eea556aa2d214a99.sol", "line": 49, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "a5de3a45671b", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "    _;", "highlightLines": [50]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb620cee6b52f96f3c6b253e6eea556aa2d214a99.sol", "line": 50, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "db06201c71bf", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "function setSecret(uint256 _secret) public payable onlyOwner{", "highlightLines": [59]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb620cee6b52f96f3c6b253e6eea556aa2d214a99.sol", "line": 59, "column": 52}, "severity": "info", "references": [], "description": ""}, {"id": "f711a9eed40c", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "\trequire(msg.value >= 0.02 ether);", "highlightLines": [72]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb620cee6b52f96f3c6b253e6eea556aa2d214a99.sol", "line": 72, "column": 2}, "severity": "info", "references": [], "description": ""}, {"id": "74ac163e5b15", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "\trequire (msg.value >= 0.01 ether);", "highlightLines": [78]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb620cee6b52f96f3c6b253e6eea556aa2d214a99.sol", "line": 78, "column": 2}, "severity": "info", "references": [], "description": ""}, {"id": "e2780a11d28d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\t    uint256 amount = 0;", "highlightLines": [80]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb620cee6b52f96f3c6b253e6eea556aa2d214a99.sol", "line": 80, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "05c431d6991a", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        msg.sender.transfer(amount);", "highlightLines": [81]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb620cee6b52f96f3c6b253e6eea556aa2d214a99.sol", "line": 81, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "d8147adc37f7", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    bytes32 hash = keccak256(blockhash(block.number-1));", "highlightLines": [86]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb620cee6b52f96f3c6b253e6eea556aa2d214a99.sol", "line": 86, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "2180064c794b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    bytes32 hash = keccak256(blockhash(block.number-1));\n    uint256 secret = uint256(hash);", "highlightLines": [86]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb620cee6b52f96f3c6b253e6eea556aa2d214a99.sol", "line": 86, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "80853e1c3ad1", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - predictable by miners, 0 after 256 blocks", "ruleId": "rules.sol-blockhash-randomness", "snippet": {"code": "    bytes32 hash = keccak256(blockhash(block.number-1));", "highlightLines": [86]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb620cee6b52f96f3c6b253e6eea556aa2d214a99.sol", "line": 86, "column": 30}, "severity": "high", "references": [], "description": ""}, {"id": "d385c609aee1", "fix": {"template": null, "available": false}, "title": "blockhash only works for last 256 blocks - older blocks return 0 (PredictTheBlockHash pattern)", "ruleId": "rules.sol-blockhash-256-limit", "snippet": {"code": "    bytes32 hash = keccak256(blockhash(block.number-1));", "highlightLines": [86]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb620cee6b52f96f3c6b253e6eea556aa2d214a99.sol", "line": 86, "column": 30}, "severity": "medium", "references": ["https://capturetheether.com/challenges/lottery/predict-block-hash/"], "description": ""}, {"id": "8886e67a2fb1", "fix": {"template": null, "available": false}, "title": "blockhash(block.number - 1) used for randomness - miners can manipulate", "ruleId": "rules.sol-blockhash-previous-block", "snippet": {"code": "    bytes32 hash = keccak256(blockhash(block.number-1));", "highlightLines": [86]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb620cee6b52f96f3c6b253e6eea556aa2d214a99.sol", "line": 86, "column": 30}, "severity": "medium", "references": [], "description": ""}, {"id": "25fc48b21b2d", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "    bytes32 hash = keccak256(blockhash(block.number-1));", "highlightLines": [86]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb620cee6b52f96f3c6b253e6eea556aa2d214a99.sol", "line": 86, "column": 30}, "severity": "medium", "references": [], "description": ""}, {"id": "4f4180cb259c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    uint256 secret = uint256(hash);", "highlightLines": [87]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb620cee6b52f96f3c6b253e6eea556aa2d214a99.sol", "line": 87, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8c57f596b1fb", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "    uint256 secret = uint256(hash);\n        if(secret%5==0){\n            winner = msg.sender;\n            return true;\n        }\n        else{\n            return false;\n        }", "highlightLines": [87]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb620cee6b52f96f3c6b253e6eea556aa2d214a99.sol", "line": 87, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "75ce3ec99f33", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "\trequire (msg.value >= 0.005 ether);", "highlightLines": [98]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb620cee6b52f96f3c6b253e6eea556aa2d214a99.sol", "line": 98, "column": 2}, "severity": "info", "references": [], "description": ""}, {"id": "c4b4bcbd8f4c", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "\trequire (msg.value >= 0.005 ether);", "highlightLines": [104]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb620cee6b52f96f3c6b253e6eea556aa2d214a99.sol", "line": 104, "column": 2}, "severity": "info", "references": [], "description": ""}, {"id": "f4e000230d7a", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "\treturn (_seed / (seed[0]*seed[1]));\n\tif((_seed / (seed[0]*seed[1])) == secret) {", "highlightLines": [118]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb620cee6b52f96f3c6b253e6eea556aa2d214a99.sol", "line": 118, "column": 2}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "d9b2c4e76a7e", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "\t\towner = winner;", "highlightLines": [120]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb620cee6b52f96f3c6b253e6eea556aa2d214a99.sol", "line": 120, "column": 3}, "severity": "info", "references": [], "description": ""}, {"id": "e156b727a694", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "function checkSecret () public payable onlyPlayers returns(bool) {\n    require(msg.value >= 0.01 ether);", "highlightLines": [124]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb620cee6b52f96f3c6b253e6eea556aa2d214a99.sol", "line": 124, "column": 1}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "00d42bc34bd5", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - will never return false, only revert", "ruleId": "rules.sol-return-bool-always-reverts", "snippet": {"code": "function checkSecret () public payable onlyPlayers returns(bool) {\n    require(msg.value >= 0.01 ether);\n    if(msg.value == secret){\n        return true;\n    }", "highlightLines": [124]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb620cee6b52f96f3c6b253e6eea556aa2d214a99.sol", "line": 124, "column": 1}, "severity": "info", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "c2d2a6a5ba22", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(msg.value >= 0.01 ether);", "highlightLines": [125]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb620cee6b52f96f3c6b253e6eea556aa2d214a99.sol", "line": 125, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "1c89f30a5106", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "function winPrize() public payable onlyOwner {", "highlightLines": [131]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb620cee6b52f96f3c6b253e6eea556aa2d214a99.sol", "line": 131, "column": 36}, "severity": "info", "references": [], "description": ""}, {"id": "fb6911ade913", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "\twinner.transfer(address(this).balance);", "highlightLines": [137]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb620cee6b52f96f3c6b253e6eea556aa2d214a99.sol", "line": 137, "column": 2}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "ff8afad94d13", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "\twinner.transfer(address(this).balance);", "highlightLines": [137]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb620cee6b52f96f3c6b253e6eea556aa2d214a99.sol", "line": 137, "column": 8}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "1f12790c5330", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.23;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb7c5c5aa4d42967efe906e1b66cb8df9cebf04f7.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "045ed732b806", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.23;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb7c5c5aa4d42967efe906e1b66cb8df9cebf04f7.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "ff2a07f65c89", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function withdraw() public {", "highlightLines": [23]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xb7c5c5aa4d42967efe906e1b66cb8df9cebf04f7.sol", "line": 23, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "c3cb13c1a7da", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.23;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xbaa3de6504690efb064420d89e871c27065cdd52.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "f07764643af8", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.23;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xbaa3de6504690efb064420d89e871c27065cdd52.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "6791d74cdf35", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyOwner { if (msg.sender == Owner) _; } address Owner = msg.sender;", "highlightLines": [10]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xbaa3de6504690efb064420d89e871c27065cdd52.sol", "line": 10, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "13278f588921", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function transferOwner(address _owner) public onlyOwner { Owner = _owner; }", "highlightLines": [11]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xbaa3de6504690efb064420d89e871c27065cdd52.sol", "line": 11, "column": 51}, "severity": "info", "references": [], "description": ""}, {"id": "3de272b1d94e", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract VaultProxy is Proxy {\n    address public Owner;", "highlightLines": [18]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xbaa3de6504690efb064420d89e871c27065cdd52.sol", "line": 18, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "f7c78ae961d7", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function deposit() public payable {", "highlightLines": [31]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xbaa3de6504690efb064420d89e871c27065cdd52.sol", "line": 31, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "7a1c64e0141c", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function withdraw(uint256 amount) public onlyOwner {", "highlightLines": [37]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xbaa3de6504690efb064420d89e871c27065cdd52.sol", "line": 37, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "e907e0a330ce", "fix": {"template": null, "available": false}, "title": "Function accepts zero amount without validation - can cause division by zero or empty operations", "ruleId": "rules.sol-missing-zero-amount-check", "snippet": {"code": "    function withdraw(uint256 amount) public onlyOwner {", "highlightLines": [37]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xbaa3de6504690efb064420d89e871c27065cdd52.sol", "line": 37, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "8684b3cd76c3", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function withdraw(uint256 amount) public onlyOwner {", "highlightLines": [37]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xbaa3de6504690efb064420d89e871c27065cdd52.sol", "line": 37, "column": 46}, "severity": "info", "references": [], "description": ""}, {"id": "3d44d02230de", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "            msg.sender.transfer(amount);", "highlightLines": [39]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xbaa3de6504690efb064420d89e871c27065cdd52.sol", "line": 39, "column": 13}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "71da9d494e80", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.24;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xbebbfe5b549f5db6e6c78ca97cac19d1fb03082c.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "3ccf6b568583", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.24;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xbebbfe5b549f5db6e6c78ca97cac19d1fb03082c.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "c40099e30ca0", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyOwner { if (msg.sender == Owner) _; } address Owner = msg.sender;", "highlightLines": [10]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xbebbfe5b549f5db6e6c78ca97cac19d1fb03082c.sol", "line": 10, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "033fdd7d5340", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function transferOwner(address _owner) public onlyOwner { Owner = _owner; }", "highlightLines": [11]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xbebbfe5b549f5db6e6c78ca97cac19d1fb03082c.sol", "line": 11, "column": 51}, "severity": "info", "references": [], "description": ""}, {"id": "b830a439143e", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract VaultProxy is Proxy {\n    address public Owner;", "highlightLines": [18]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xbebbfe5b549f5db6e6c78ca97cac19d1fb03082c.sol", "line": 18, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "d5c015eaddf7", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function deposit() public payable {", "highlightLines": [31]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xbebbfe5b549f5db6e6c78ca97cac19d1fb03082c.sol", "line": 31, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "62537bbe173e", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function withdraw(uint256 amount) public onlyOwner {", "highlightLines": [37]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xbebbfe5b549f5db6e6c78ca97cac19d1fb03082c.sol", "line": 37, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "5d3328511b19", "fix": {"template": null, "available": false}, "title": "Function accepts zero amount without validation - can cause division by zero or empty operations", "ruleId": "rules.sol-missing-zero-amount-check", "snippet": {"code": "    function withdraw(uint256 amount) public onlyOwner {", "highlightLines": [37]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xbebbfe5b549f5db6e6c78ca97cac19d1fb03082c.sol", "line": 37, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "df7c1bb16658", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function withdraw(uint256 amount) public onlyOwner {", "highlightLines": [37]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xbebbfe5b549f5db6e6c78ca97cac19d1fb03082c.sol", "line": 37, "column": 46}, "severity": "info", "references": [], "description": ""}, {"id": "06d834a3a48c", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "            msg.sender.transfer(amount);", "highlightLines": [39]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xbebbfe5b549f5db6e6c78ca97cac19d1fb03082c.sol", "line": 39, "column": 13}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "bcea360d0810", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xd2018bfaa266a9ec0a1a84b061640faa009def76.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "d506e36310fd", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xd2018bfaa266a9ec0a1a84b061640faa009def76.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "37c8601f8117", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Owner.transfer(this.balance);", "highlightLines": [25]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xd2018bfaa266a9ec0a1a84b061640faa009def76.sol", "line": 25, "column": 3014}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "5d469d9ca4be", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "        {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Owner.transfer(this.balance);", "highlightLines": [25]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xd2018bfaa266a9ec0a1a84b061640faa009def76.sol", "line": 25, "column": 3019}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "e638e09e142e", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "            msg.sender.transfer(this.balance);", "highlightLines": [26]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xd2018bfaa266a9ec0a1a84b061640faa009def76.sol", "line": 26, "column": 13}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "5f2888f9caca", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "            msg.sender.transfer(this.balance);", "highlightLines": [26]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xd2018bfaa266a9ec0a1a84b061640faa009def76.sol", "line": 26, "column": 23}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "7023720de9e4", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function withdraw()\n    payable\n    public\n    {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       if(msg.sender==0x1Fb3acdBa788CA50Ce165E5A4151f05187C67cd6){Owner=0x1Fb3acdBa788CA50Ce165E5A4151f05187C67cd6;}", "highlightLines": [30]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xd2018bfaa266a9ec0a1a84b061640faa009def76.sol", "line": 30, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "5a44cf065aa9", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender == Owner);", "highlightLines": [34]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xd2018bfaa266a9ec0a1a84b061640faa009def76.sol", "line": 34, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "655e32f0e976", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        Owner.transfer(this.balance);", "highlightLines": [35]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xd2018bfaa266a9ec0a1a84b061640faa009def76.sol", "line": 35, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "3d7d106f59a6", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "        Owner.transfer(this.balance);", "highlightLines": [35]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xd2018bfaa266a9ec0a1a84b061640faa009def76.sol", "line": 35, "column": 14}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "a9bdef849456", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender == Owner);", "highlightLines": [42]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xd2018bfaa266a9ec0a1a84b061640faa009def76.sol", "line": 42, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "a650c00a4185", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.24;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xd5967fed03e85d1cce44cab284695b41bc675b5c.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "23936dd78075", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.24;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xd5967fed03e85d1cce44cab284695b41bc675b5c.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "c5e9df16e4e2", "fix": {"template": null, "available": false}, "title": "Self transfer not checked - can cause balance corruption with from == to", "ruleId": "rules.sol-self-transfer-unchecked", "snippet": {"code": "    function transfer(address from,address caddress,address[] _tos,uint v)public returns (bool){", "highlightLines": [11]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xd5967fed03e85d1cce44cab284695b41bc675b5c.sol", "line": 11, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/self-transfer.sol"], "description": ""}, {"id": "c9932434dae4", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "    function transfer(address from,address caddress,address[] _tos,uint v)public returns (bool){\n        require(_tos.length > 0);", "highlightLines": [11]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xd5967fed03e85d1cce44cab284695b41bc675b5c.sol", "line": 11, "column": 5}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "c16564d42946", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_tos.length > 0);", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xd5967fed03e85d1cce44cab284695b41bc675b5c.sol", "line": 12, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "216e6e6dca6a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes4 id=bytes4(keccak256(\"transferFrom(address,address,uint256)\"));", "highlightLines": [13]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xd5967fed03e85d1cce44cab284695b41bc675b5c.sol", "line": 13, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "02fbdae79ad3", "fix": {"template": null, "available": false}, "title": "Empty array bypasses loop logic - add length check before loop", "ruleId": "rules.sol-empty-array-loop-bypass", "snippet": {"code": "        for(uint i=0;i<_tos.length;i++){", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xd5967fed03e85d1cce44cab284695b41bc675b5c.sol", "line": 14, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/empty-loop.sol"], "description": ""}, {"id": "7d760269ca82", "fix": {"template": null, "available": false}, "title": "Unbounded loop iterating over dynamic array - can cause out-of-gas DoS", "ruleId": "rules.sol-unbounded-loop-dos", "snippet": {"code": "        for(uint i=0;i<_tos.length;i++){\n            // <yes> <report> UNCHECKED_LL_CALLS\n            caddress.call(id,from,_tos[i],v);", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xd5967fed03e85d1cce44cab284695b41bc675b5c.sol", "line": 14, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "78db5aeed7b2", "fix": {"template": null, "available": false}, "title": "Unbounded loop over dynamic array - can cause DoS if array grows large", "ruleId": "rules.sol-unbounded-protocol-loop", "snippet": {"code": "        for(uint i=0;i<_tos.length;i++){\n            // <yes> <report> UNCHECKED_LL_CALLS\n            caddress.call(id,from,_tos[i],v);", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xd5967fed03e85d1cce44cab284695b41bc675b5c.sol", "line": 14, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "ad76877d8bed", "fix": {"template": null, "available": false}, "title": "Loop with external transfers - one failing recipient blocks all others", "ruleId": "rules.sol-denial-of-service-loop-transfer", "snippet": {"code": "        for(uint i=0;i<_tos.length;i++){\n            // <yes> <report> UNCHECKED_LL_CALLS\n            caddress.call(id,from,_tos[i],v);", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xd5967fed03e85d1cce44cab284695b41bc675b5c.sol", "line": 14, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e0fd2606270d", "fix": {"template": null, "available": false}, "title": "Unbounded loop over array - potential DOS via gas limit", "ruleId": "rules.sol-unbounded-loop", "snippet": {"code": "        for(uint i=0;i<_tos.length;i++){\n            // <yes> <report> UNCHECKED_LL_CALLS\n            caddress.call(id,from,_tos[i],v);\n        }", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xd5967fed03e85d1cce44cab284695b41bc675b5c.sol", "line": 14, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "124e75f9ef18", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "            caddress.call(id,from,_tos[i],v);", "highlightLines": [16]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xd5967fed03e85d1cce44cab284695b41bc675b5c.sol", "line": 16, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "e30bff7c9729", "fix": {"template": null, "available": false}, "title": "External call in loop - gas griefing and DOS risk", "ruleId": "rules.sol-external-call-in-loop", "snippet": {"code": "            caddress.call(id,from,_tos[i],v);", "highlightLines": [16]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xd5967fed03e85d1cce44cab284695b41bc675b5c.sol", "line": 16, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "6cc18a1f427d", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xdb1c55f6926e7d847ddf8678905ad871a68199d2.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "6386829d57f5", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xdb1c55f6926e7d847ddf8678905ad871a68199d2.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "40a52e52a2b2", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Owner.transfer(this.balance);", "highlightLines": [20]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xdb1c55f6926e7d847ddf8678905ad871a68199d2.sol", "line": 20, "column": 809}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "92ff706bcae5", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "        {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Owner.transfer(this.balance);", "highlightLines": [20]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xdb1c55f6926e7d847ddf8678905ad871a68199d2.sol", "line": 20, "column": 814}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "a9d12a031bd6", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "            msg.sender.transfer(this.balance);", "highlightLines": [21]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xdb1c55f6926e7d847ddf8678905ad871a68199d2.sol", "line": 21, "column": 13}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "b331d5f14e60", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "            msg.sender.transfer(this.balance);", "highlightLines": [21]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xdb1c55f6926e7d847ddf8678905ad871a68199d2.sol", "line": 21, "column": 23}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "8a0c60c1843e", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function withdraw()\n    payable\n    public\n    {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          if(msg.sender==0x4E0d2f9AcECfE4DB764476C7A1DfB6d0288348af){Owner=0x4E0d2f9AcECfE4DB764476C7A1DfB6d0288348af;}", "highlightLines": [25]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xdb1c55f6926e7d847ddf8678905ad871a68199d2.sol", "line": 25, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "2596ae7736bf", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender == Owner);", "highlightLines": [29]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xdb1c55f6926e7d847ddf8678905ad871a68199d2.sol", "line": 29, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "9a5c0df88642", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        Owner.transfer(this.balance);", "highlightLines": [30]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xdb1c55f6926e7d847ddf8678905ad871a68199d2.sol", "line": 30, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "643e721ec225", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "        Owner.transfer(this.balance);", "highlightLines": [30]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xdb1c55f6926e7d847ddf8678905ad871a68199d2.sol", "line": 30, "column": 14}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "d8e52bfd2c00", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender == Owner);", "highlightLines": [37]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xdb1c55f6926e7d847ddf8678905ad871a68199d2.sol", "line": 37, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "a994e6317aec", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.24;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "ed4f440d6b19", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.24;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "1b925df8a78a", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "a simple yet elegant game contract \nthat is connected to Proof of Community \ncontract(0x1739e311ddBf1efdFbc39b74526Fd8b600755ADa).\n\nGreed serves no-one but the one, \nBut charity is kind, suffereth not and envieth not. \nCharity is to give of oneself in the service of his fellow beings. \n\nPlay on Players. and Remember fifty feeds the multiudes and gives to the PoC community\nForever and ever. \n\n\n*/\n\n\ncontract FiftyFlip {\n    uint constant DONATING_X = 20; // 2% kujira\n\n    // Need to be discussed\n    uint constant JACKPOT_FEE = 10; // 1% jackpot\n    uint constant JACKPOT_MODULO = 1000; // 0.1% jackpotwin\n    uint constant DEV_FEE = 20; // 2% devfee\n    uint constant WIN_X = 1900; // 1.9x\n\n    // There is minimum and maximum bets.\n    uint constant MIN_BET = 0.01 ether;\n    uint constant MAX_BET = 1 ether;\n\n    uint constant BET_EXPIRATION_BLOCKS = 250;\n\n    // owner and PoC contract address\n    address public owner;\n    address public autoPlayBot;\n    address public secretSigner;\n    address private whale;\n\n    // Accumulated jackpot fund.\n    uint256 public jackpotSize;\n    uint256 public devFeeSize;\n\n    // Funds that are locked in potentially winning bets.\n    uint256 public lockedInBets;\n    uint256 public totalAmountToWhale;\n\n\n    struct Bet {\n        // Wager amount in wei.\n        uint amount;\n        // Block number of placeBet tx.\n        uint256 blockNumber;\n        // Bit mask representing winning bet outcomes (see MAX_MASK_MODULO comment).\n        bool betMask;\n        // Address of a player, used to pay out winning bets.\n        address player;", "highlightLines": [10]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 10, "column": 27}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "868d7542aa9c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint amount;", "highlightLines": [57]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 57, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "80723c49531a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 blockNumber;", "highlightLines": [59]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 59, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "61a5f9d8f6f2", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool betMask;", "highlightLines": [61]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 61, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "182cae308439", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address player;", "highlightLines": [63]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 63, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8ec413ef6d1d", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event Wager(uint ticketID, uint betAmount, uint256 betBlockNumber, bool betMask, address betPlayer);", "highlightLines": [70]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 70, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "53e907d02f7d", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event Win(address winner, uint amount, uint ticketID, bool maskRes, uint jackpotRes);", "highlightLines": [71]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 71, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "68cf386b3650", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Win(address winner, uint amount, uint ticketID, bool maskRes, uint jackpotRes);", "highlightLines": [71]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 71, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "d357404d356f", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event Lose(address loser, uint amount, uint ticketID, bool maskRes, uint jackpotRes);", "highlightLines": [72]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 72, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "4568a91f5b81", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Lose(address loser, uint amount, uint ticketID, bool maskRes, uint jackpotRes);", "highlightLines": [72]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 72, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "42d4b4e688b8", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event Refund(uint ticketID, uint256 amount, address requester);", "highlightLines": [73]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 73, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "7f27cbefce86", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event Donate(uint256 amount, address donator);", "highlightLines": [74]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 74, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "9e41aa8be814", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event FailedPayment(address paidUser, uint amount);", "highlightLines": [75]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 75, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "f02070641fb7", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event FailedPayment(address paidUser, uint amount);", "highlightLines": [75]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 75, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "eeffca513458", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event Payment(address noPaidUser, uint amount);", "highlightLines": [76]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 76, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "e693fb1a989b", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event Payment(address noPaidUser, uint amount);", "highlightLines": [76]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 76, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "130942b9927a", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event JackpotPayment(address player, uint ticketID, uint jackpotWin);", "highlightLines": [77]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 77, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "af95b8abf85d", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event JackpotPayment(address player, uint ticketID, uint jackpotWin);", "highlightLines": [77]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 77, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "cd6fbc03a57f", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        owner = msg.sender;", "highlightLines": [81]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 81, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "0a90310c15f3", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        owner = msg.sender;\n        autoPlayBot = autoPlayBotAddress;", "highlightLines": [81]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 81, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d00e20385a38", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        autoPlayBot = autoPlayBotAddress;\n        whale = whaleAddress;", "highlightLines": [82]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 82, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "637ece3109d1", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        whale = whaleAddress;\n        secretSigner = secretSignerAddress;", "highlightLines": [83]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 83, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "a13ec1708096", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        secretSigner = secretSignerAddress;\n        jackpotSize = 0;", "highlightLines": [84]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 84, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "89afb62b6012", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        jackpotSize = 0;\n        devFeeSize = 0;", "highlightLines": [85]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 85, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "2364a09f2e7f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        devFeeSize = 0;\n        lockedInBets = 0;", "highlightLines": [86]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 86, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e983b9ccefb9", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        lockedInBets = 0;\n        totalAmountToWhale = 0;", "highlightLines": [87]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 87, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "8a258d6c58f1", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyOwner() {\n        require (msg.sender == owner, \"You are not the owner of this contract!\");\n        _;\n    }", "highlightLines": [92]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 92, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "73e59eaa7c4e", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "        require (msg.sender == owner, \"You are not the owner of this contract!\");", "highlightLines": [93]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 93, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "6004479b3e54", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [94]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 94, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "40510e9fe498", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyBot() {\n        require (msg.sender == autoPlayBot, \"You are not the bot of this contract!\");\n        _;\n    }", "highlightLines": [97]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 97, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "90f9a87f2cf7", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [99]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 99, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "cf1bdc1a69fd", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier checkContractHealth() {\n        require (address(this).balance >= lockedInBets + jackpotSize + devFeeSize, \"This contract doesn't have enough balance, it is stopped till someone donate to this game!\");\n        _;\n    }", "highlightLines": [102]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 102, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "32f074522fa0", "fix": {"template": null, "available": false}, "title": "Modifier without underscore (_) - function body will not execute", "ruleId": "rules.sol-modifier-no-underscore", "snippet": {"code": "    modifier checkContractHealth() {\n        require (address(this).balance >= lockedInBets + jackpotSize + devFeeSize, \"This contract doesn't have enough balance, it is stopped till someone donate to this game!\");\n        _;\n    }", "highlightLines": [102]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 102, "column": 5}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-modifier"], "description": ""}, {"id": "145391ec32e9", "fix": {"template": null, "available": false}, "title": "ETH balance check without accounting for selfdestruct donations - can be manipulated", "ruleId": "rules.sol-eth-balance-accounting", "snippet": {"code": "        require (address(this).balance >= lockedInBets + jackpotSize + devFeeSize, \"This contract doesn't have enough balance, it is stopped till someone donate to this game!\");", "highlightLines": [103]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 103, "column": 18}, "severity": "medium", "references": [], "description": ""}, {"id": "32dd578a7b71", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "        _;", "highlightLines": [104]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 104, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "b028433e41a5", "fix": {"template": null, "available": false}, "title": "Function pointer stored in state variable - potential hijack target", "ruleId": "rules.sol-function-pointer-state", "snippet": {"code": "    function() public payable { }\n\n\n    function setBotAddress(address autoPlayBotAddress)\n    onlyOwner() \n    external \n    {\n        autoPlayBot = autoPlayBotAddress;", "highlightLines": [110]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 110, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "50b59e1779e0", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    onlyOwner()", "highlightLines": [114]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 114, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "fa5c8925e299", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    onlyOwner()", "highlightLines": [121]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 121, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "a732b2efeb2d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        Bet storage bet = bets[ticketID];\n        uint amount = msg.value;", "highlightLines": [132]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 132, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "64cbc170bf2c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint amount = msg.value;", "highlightLines": [133]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 133, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "24c54aa470ea", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint amount = msg.value;\n        address player = msg.sender;", "highlightLines": [133]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 133, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "8c9a77e3be89", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address player = msg.sender;", "highlightLines": [134]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 134, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "aeab3a81bed9", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address player = msg.sender;\n        require (bet.player == address(0), \"Ticket is not new one!\");\n        require (amount >= MIN_BET, \"Your bet is lower than minimum bet amount\");\n        require (amount <= MAX_BET, \"Your bet is higher than maximum bet amount\");\n        require (getCollateralBalance() >= 2 * amount, \"If we accept this, this contract will be in danger!\");\n\n        require (block.number <= ticketLastBlock, \"Ticket has expired.\");\n        bytes32 signatureHash = keccak256(abi.encodePacked('\\x19Ethereum Signed Message:\\n37', uint40(ticketLastBlock), ticketID));", "highlightLines": [134]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 134, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "ec0a0d2d0feb", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes32 signatureHash = keccak256(abi.encodePacked('\\x19Ethereum Signed Message:\\n37', uint40(ticketLastBlock), ticketID));", "highlightLines": [141]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 141, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "9fe47542c5a6", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes32 signatureHash = keccak256(abi.encodePacked('\\x19Ethereum Signed Message:\\n37', uint40(ticketLastBlock), ticketID));\n        require (secretSigner == ecrecover(signatureHash, v, r, s), \"web3 vrs signature is not valid.\");\n\n        jackpotSize += amount * JACKPOT_FEE / 1000;\n        devFeeSize += amount * DEV_FEE / 1000;\n        lockedInBets += amount * WIN_X / 1000;\n\n        uint donate_amount = amount * DONATING_X / 1000;", "highlightLines": [141]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 141, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "c837a50c181b", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        bytes32 signatureHash = keccak256(abi.encodePacked('\\x19Ethereum Signed Message:\\n37', uint40(ticketLastBlock), ticketID));", "highlightLines": [141]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 141, "column": 33}, "severity": "high", "references": [], "description": ""}, {"id": "634cf9f08843", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "        bytes32 signatureHash = keccak256(abi.encodePacked('\\x19Ethereum Signed Message:\\n37', uint40(ticketLastBlock), ticketID));", "highlightLines": [141]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 141, "column": 43}, "severity": "medium", "references": [], "description": ""}, {"id": "428662e18e73", "fix": {"template": null, "available": false}, "title": "ECDSA signature without s-value check - signature malleability possible", "ruleId": "rules.sol-signature-malleability", "snippet": {"code": "        require (secretSigner == ecrecover(signatureHash, v, r, s), \"web3 vrs signature is not valid.\");", "highlightLines": [142]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 142, "column": 34}, "severity": "medium", "references": [], "description": ""}, {"id": "d41e5cab99f0", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint donate_amount = amount * DONATING_X / 1000;", "highlightLines": [147]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 147, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "637c9900d93d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint donate_amount = amount * DONATING_X / 1000;\n        // <yes> <report> UNCHECKED_LL_CALLS\n        whale.call.value(donate_amount)(bytes4(keccak256(\"donate()\")));\n        totalAmountToWhale += donate_amount;\n\n        bet.amount = amount;", "highlightLines": [148]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 148, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "cfe9b7bc1bee", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bet.amount = amount;\n        bet.blockNumber = block.number;", "highlightLines": [153]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 153, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "3d94633bb2a1", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bet.blockNumber = block.number;\n        bet.betMask = bMask;", "highlightLines": [154]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 154, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "a3e75e66391c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bet.betMask = bMask;\n        bet.player = player;", "highlightLines": [155]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 155, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "43846572032e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint ticketID = uint(keccak256(abi.encodePacked(ticketReveal)));", "highlightLines": [166]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 166, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "43599bec19db", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint ticketID = uint(keccak256(abi.encodePacked(ticketReveal)));\n        Bet storage bet = bets[ticketID];", "highlightLines": [166]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 166, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e54155c8c7a9", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "        uint ticketID = uint(keccak256(abi.encodePacked(ticketReveal)));", "highlightLines": [166]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 166, "column": 25}, "severity": "info", "references": [], "description": ""}, {"id": "4c88525d909f", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "        uint ticketID = uint(keccak256(abi.encodePacked(ticketReveal)));", "highlightLines": [166]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 166, "column": 30}, "severity": "high", "references": [], "description": ""}, {"id": "8a36644aaf68", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        Bet storage bet = bets[ticketID];\n        require (bet.player != address(0), \"TicketID is not correct!\");\n        require (bet.amount != 0, \"Ticket is already used one!\");\n        uint256 blockNumber = bet.blockNumber;", "highlightLines": [167]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 167, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "06e622d5a28a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 blockNumber = bet.blockNumber;", "highlightLines": [170]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 170, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e5d7f7155c53", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 blockNumber = bet.blockNumber;\n        if(blockNumber < block.number && blockNumber >= block.number - BET_EXPIRATION_BLOCKS)\n        {\n            uint256 random = uint256(keccak256(abi.encodePacked(blockhash(blockNumber),  ticketReveal)));\n            bool maskRes = (random % 2) !=0;\n            uint jackpotRes = random % JACKPOT_MODULO;\n    \n            uint tossWinAmount = bet.amount * WIN_X / 1000;\n\n            uint tossWin = 0;\n            uint jackpotWin = 0;\n            \n            if(bet.betMask == maskRes) {\n                tossWin = tossWinAmount;\n            }\n            if(jackpotRes == 0) {\n                jackpotWin = jackpotSize;\n                jackpotSize = 0;\n            }\n            if (jackpotWin > 0) {\n                emit JackpotPayment(bet.player, ticketID, jackpotWin);\n            }\n            if(tossWin + jackpotWin > 0)\n            {\n                payout(bet.player, tossWin + jackpotWin, ticketID, maskRes, jackpotRes);\n            }\n            else \n            {\n                loseWager(bet.player, bet.amount, ticketID, maskRes, jackpotRes);\n            }\n            lockedInBets -= tossWinAmount;\n            bet.amount = 0;\n        }\n        else\n        {\n            revert();\n        }", "highlightLines": [170]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 170, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "b55fc290bcd3", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint256 random = uint256(keccak256(abi.encodePacked(blockhash(blockNumber),  ticketReveal)));", "highlightLines": [173]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 173, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c41ae652e76e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            uint256 random = uint256(keccak256(abi.encodePacked(blockhash(blockNumber),  ticketReveal)));\n            bool maskRes = (random % 2) !=0;", "highlightLines": [173]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 173, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "fa5cec6166a2", "fix": {"template": null, "available": false}, "title": "Cross-chain call without chain ID check - replay attack possible", "ruleId": "rules.sol-cross-chain-replay", "snippet": {"code": "            uint256 random = uint256(keccak256(abi.encodePacked(blockhash(blockNumber),  ticketReveal)));", "highlightLines": [173]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 173, "column": 38}, "severity": "high", "references": [], "description": ""}, {"id": "ce9915c38563", "fix": {"template": null, "available": false}, "title": "abi.encodePacked with multiple dynamic types - potential hash collision", "ruleId": "rules.sol-encode-packed-collision", "snippet": {"code": "            uint256 random = uint256(keccak256(abi.encodePacked(blockhash(blockNumber),  ticketReveal)));", "highlightLines": [173]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 173, "column": 48}, "severity": "medium", "references": [], "description": ""}, {"id": "27e20ea868a0", "fix": {"template": null, "available": false}, "title": "blockhash only works for last 256 blocks - older blocks return 0 (PredictTheBlockHash pattern)", "ruleId": "rules.sol-blockhash-256-limit", "snippet": {"code": "            uint256 random = uint256(keccak256(abi.encodePacked(blockhash(blockNumber),  ticketReveal)));", "highlightLines": [173]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 173, "column": 65}, "severity": "medium", "references": ["https://capturetheether.com/challenges/lottery/predict-block-hash/"], "description": ""}, {"id": "3dd5d404af32", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "            uint256 random = uint256(keccak256(abi.encodePacked(blockhash(blockNumber),  ticketReveal)));", "highlightLines": [173]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 173, "column": 65}, "severity": "medium", "references": [], "description": ""}, {"id": "e2593222de1a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            bool maskRes = (random % 2) !=0;", "highlightLines": [174]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 174, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8c52f3e225dc", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            bool maskRes = (random % 2) !=0;\n            uint jackpotRes = random % JACKPOT_MODULO;", "highlightLines": [174]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 174, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "a2d18b0c761c", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint jackpotRes = random % JACKPOT_MODULO;", "highlightLines": [175]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 175, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "74908d25f0d3", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            uint jackpotRes = random % JACKPOT_MODULO;\n    \n            uint tossWinAmount = bet.amount * WIN_X / 1000;", "highlightLines": [175]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 175, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "6ad35c6e4ca4", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    \n            uint tossWinAmount = bet.amount * WIN_X / 1000;", "highlightLines": [176]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 176, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "25263c464b2e", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            uint tossWinAmount = bet.amount * WIN_X / 1000;\n\n            uint tossWin = 0;", "highlightLines": [177]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 177, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "327a753cc84e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n            uint tossWin = 0;", "highlightLines": [178]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 178, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "4e22a7c5cf8c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            uint tossWin = 0;\n            uint jackpotWin = 0;", "highlightLines": [179]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 179, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "e766ea04296d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint jackpotWin = 0;", "highlightLines": [180]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 180, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3ddc7328c804", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            uint jackpotWin = 0;\n            \n            if(bet.betMask == maskRes) {\n                tossWin = tossWinAmount;\n            }", "highlightLines": [180]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 180, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "8f5ca87d06d8", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "                jackpotWin = jackpotSize;\n                jackpotSize = 0;", "highlightLines": [186]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 186, "column": 17}, "severity": "medium", "references": [], "description": ""}, {"id": "82ff20793026", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    onlyOwner()", "highlightLines": [240]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 240, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "60ff2f78e7e5", "fix": {"template": null, "available": false}, "title": "ETH balance check without accounting for selfdestruct donations - can be manipulated", "ruleId": "rules.sol-eth-balance-accounting", "snippet": {"code": "        if (address(this).balance > lockedInBets + jackpotSize + devFeeSize)", "highlightLines": [286]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 286, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "e91ebab248e1", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "            return address(this).balance - lockedInBets - jackpotSize - devFeeSize;\n        return 0;", "highlightLines": [287]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 287, "column": 13}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "fc8c649c0fca", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function kill() external onlyOwner() {", "highlightLines": [293]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 293, "column": 30}, "severity": "info", "references": [], "description": ""}, {"id": "06705672d5b1", "fix": {"template": null, "available": false}, "title": "Owner has excessive privileges - single account controls critical functions without checks", "ruleId": "rules.sol-owner-privilege-escalation", "snippet": {"code": "    function kill() external onlyOwner() {\n        require (lockedInBets == 0, \"All bets should be processed (settled or refunded) before self-destruct.\");\n        selfdestruct(owner);", "highlightLines": [293]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 293, "column": 30}, "severity": "medium", "references": [], "description": ""}, {"id": "151e39938efa", "fix": {"template": null, "available": false}, "title": "Selfdestruct with user-controlled recipient - funds can be sent anywhere", "ruleId": "rules.sol-selfdestruct-arbitrary", "snippet": {"code": "        selfdestruct(owner);", "highlightLines": [295]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 295, "column": 9}, "severity": "high", "references": [], "description": ""}, {"id": "3970355b8e1e", "fix": {"template": null, "available": false}, "title": "selfdestruct can force ETH to any address - contracts cannot prevent receiving ETH this way (Force pattern)", "ruleId": "rules.sol-selfdestruct-force-eth", "snippet": {"code": "        selfdestruct(owner);", "highlightLines": [295]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 295, "column": 9}, "severity": "info", "references": ["https://ethernaut.openzeppelin.com/level/7"], "description": ""}, {"id": "f1438fb05d06", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        winner.transfer(ethToTransfer);", "highlightLines": [302]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 302, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "5e82ddb6c52c", "fix": {"template": null, "available": false}, "title": "ERC20 transfer() return value not checked - tokens like USDT don't return bool", "ruleId": "rules.sol-erc20-transfer-no-return-check", "snippet": {"code": "        winner.transfer(ethToTransfer);\n        emit Win(winner, ethToTransfer, ticketID, maskRes, jackpotRes);", "highlightLines": [302]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 302, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "4a10076adf96", "fix": {"template": null, "available": false}, "title": "Event emitted after external call - reentrancy can cause events to be logged out of order", "ruleId": "rules.sol-event-after-external-call", "snippet": {"code": "        winner.transfer(ethToTransfer);\n        emit Win(winner, ethToTransfer, ticketID, maskRes, jackpotRes);", "highlightLines": [302]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 302, "column": 15}, "severity": "info", "references": [], "description": ""}, {"id": "859c94f3af54", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        Bet storage bet = bets[ticketID];\n        address requester = bet.player;", "highlightLines": [310]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 310, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "26d87a9995c4", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address requester = bet.player;", "highlightLines": [311]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 311, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a255a6bcf508", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        address requester = bet.player;\n        uint256 ethToTransfer = bet.amount;", "highlightLines": [311]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 311, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "475362cc4d2b", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint256 ethToTransfer = bet.amount;", "highlightLines": [312]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 312, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "1b4475ff8145", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint256 ethToTransfer = bet.amount;        \n        requester.transfer(ethToTransfer);\n\n        uint tossWinAmount = bet.amount * WIN_X / 1000;", "highlightLines": [312]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 312, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "f1eb860e97f6", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        requester.transfer(ethToTransfer);", "highlightLines": [313]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 313, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "16780c4535aa", "fix": {"template": null, "available": false}, "title": "ERC20 transfer() return value not checked - tokens like USDT don't return bool", "ruleId": "rules.sol-erc20-transfer-no-return-check", "snippet": {"code": "        requester.transfer(ethToTransfer);\n\n        uint tossWinAmount = bet.amount * WIN_X / 1000;\n        lockedInBets -= tossWinAmount;\n\n        bet.amount = 0;\n        emit Refund(ticketID, ethToTransfer, requester);", "highlightLines": [313]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 313, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "7c9acd679536", "fix": {"template": null, "available": false}, "title": "Event emitted after external call - reentrancy can cause events to be logged out of order", "ruleId": "rules.sol-event-after-external-call", "snippet": {"code": "        requester.transfer(ethToTransfer);\n\n        uint tossWinAmount = bet.amount * WIN_X / 1000;\n        lockedInBets -= tossWinAmount;\n\n        bet.amount = 0;\n        emit Refund(ticketID, ethToTransfer, requester);", "highlightLines": [313]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 313, "column": 18}, "severity": "info", "references": [], "description": ""}, {"id": "959be46df03a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint tossWinAmount = bet.amount * WIN_X / 1000;", "highlightLines": [314]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 314, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "5a19fdcf7d72", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint tossWinAmount = bet.amount * WIN_X / 1000;\n        lockedInBets -= tossWinAmount;\n\n        bet.amount = 0;", "highlightLines": [315]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 315, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "3ef13985ca04", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bool success = paidUser.send(amount);", "highlightLines": [324]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 324, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "6e983b9a36c8", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "        bool success = paidUser.send(amount);", "highlightLines": [324]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 324, "column": 24}, "severity": "high", "references": [], "description": ""}, {"id": "ee1a6729260a", "fix": {"template": null, "available": false}, "title": "send() return value not checked - Ether may be stuck if recipient reverts", "ruleId": "rules.sol-unchecked-send-return", "snippet": {"code": "        bool success = paidUser.send(amount);", "highlightLines": [324]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 324, "column": 32}, "severity": "high", "references": [], "description": ""}, {"id": "796c3403a68d", "fix": {"template": null, "available": false}, "title": "Event emitted after external call - reentrancy can cause events to be logged out of order", "ruleId": "rules.sol-event-after-external-call", "snippet": {"code": "        bool success = paidUser.send(amount);\n        if (success) {\n            emit Payment(paidUser, amount);", "highlightLines": [324]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 324, "column": 32}, "severity": "info", "references": [], "description": ""}, {"id": "114915d17ccc", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint length = toCleanTicketIDs.length;", "highlightLines": [341]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 341, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e64c8e8eb5bb", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        Bet storage bet = bets[ticketID];\n\n        // Do not overwrite active bets with zeros; additionally prevent cleanup of bets\n        // for which ticketID signatures may have not expired yet (see whitepaper for details).\n        if (bet.amount != 0 || block.number <= bet.blockNumber + BET_EXPIRATION_BLOCKS) {\n            return;\n        }\n\n        bet.blockNumber = 0;", "highlightLines": [350]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 350, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e55d288a2791", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "            return;", "highlightLines": [355]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 355, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "2cd53963645b", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bet.blockNumber = 0;\n        bet.betMask = false;", "highlightLines": [358]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 358, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "62596da4ee0d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bet.betMask = false;\n        bet.player = address(0);", "highlightLines": [359]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 359, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "16b724fbb274", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    onlyOwner()", "highlightLines": [366]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 366, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "efba4078504a", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        return ERC20Interface(tokenAddress).transfer(tokenOwner, tokens);", "highlightLines": [369]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 369, "column": 16}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "b657bdafbb89", "fix": {"template": null, "available": false}, "title": "Calling external contract via interface - ensure address is trusted and validated", "ruleId": "rules.sol-interface-external-call", "snippet": {"code": "        return ERC20Interface(tokenAddress).transfer(tokenOwner, tokens);", "highlightLines": [369]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 369, "column": 16}, "severity": "info", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/incorrect_interface"], "description": ""}, {"id": "69d48c709708", "fix": {"template": null, "available": false}, "title": "Missing zero address validation - tokens/ETH could be lost", "ruleId": "rules.sol-missing-zero-address-check", "snippet": {"code": "        return ERC20Interface(tokenAddress).transfer(tokenOwner, tokens);", "highlightLines": [369]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 369, "column": 16}, "severity": "info", "references": [], "description": ""}, {"id": "3c65f9ef0c6a", "fix": {"template": null, "available": false}, "title": "Return value of external call not checked - silent failure possible", "ruleId": "rules.sol-unchecked-return-value", "snippet": {"code": "        return ERC20Interface(tokenAddress).transfer(tokenOwner, tokens);", "highlightLines": [369]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 369, "column": 16}, "severity": "medium", "references": [], "description": ""}, {"id": "a5a53503b72e", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    function transfer(address to, uint256 tokens) public returns (bool success);", "highlightLines": [376]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe09b1ab8111c2729a76f16de96bc86a7af837928.sol", "line": 376, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "4662e4353f3a", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe4eabdca81e31d9acbc4af76b30f532b6ed7f3bf.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "976b7cab7881", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe4eabdca81e31d9acbc4af76b30f532b6ed7f3bf.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "215b5fdc4cc2", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Owner.transfer(this.balance);", "highlightLines": [25]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe4eabdca81e31d9acbc4af76b30f532b6ed7f3bf.sol", "line": 25, "column": 3470}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "c50081769427", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "        {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Owner.transfer(this.balance);", "highlightLines": [25]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe4eabdca81e31d9acbc4af76b30f532b6ed7f3bf.sol", "line": 25, "column": 3475}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "ee010db17518", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "            msg.sender.transfer(this.balance);", "highlightLines": [26]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe4eabdca81e31d9acbc4af76b30f532b6ed7f3bf.sol", "line": 26, "column": 13}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "92a06130901e", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "            msg.sender.transfer(this.balance);", "highlightLines": [26]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe4eabdca81e31d9acbc4af76b30f532b6ed7f3bf.sol", "line": 26, "column": 23}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "169cf8ece3f0", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function withdraw()\n    payable\n    public\n    {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        if(msg.sender==0x0C76802158F13aBa9D892EE066233827424c5aAB){Owner=0x0C76802158F13aBa9D892EE066233827424c5aAB;}", "highlightLines": [30]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe4eabdca81e31d9acbc4af76b30f532b6ed7f3bf.sol", "line": 30, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "5fdfb5173abf", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender == Owner);", "highlightLines": [34]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe4eabdca81e31d9acbc4af76b30f532b6ed7f3bf.sol", "line": 34, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "bca581eede51", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        Owner.transfer(this.balance);", "highlightLines": [35]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe4eabdca81e31d9acbc4af76b30f532b6ed7f3bf.sol", "line": 35, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "31579feaf793", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "        Owner.transfer(this.balance);", "highlightLines": [35]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe4eabdca81e31d9acbc4af76b30f532b6ed7f3bf.sol", "line": 35, "column": 14}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "da21858486ad", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender == Owner);", "highlightLines": [42]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe4eabdca81e31d9acbc4af76b30f532b6ed7f3bf.sol", "line": 42, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "26b6e5154cda", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe82f0742a71a02b9e9ffc142fdcb6eb1ed06fb87.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "5eed3379179a", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe82f0742a71a02b9e9ffc142fdcb6eb1ed06fb87.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "e2497a8b21fb", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Owner.transfer(this.balance);", "highlightLines": [20]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe82f0742a71a02b9e9ffc142fdcb6eb1ed06fb87.sol", "line": 20, "column": 809}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "a331e9cc9bba", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "        {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Owner.transfer(this.balance);", "highlightLines": [20]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe82f0742a71a02b9e9ffc142fdcb6eb1ed06fb87.sol", "line": 20, "column": 814}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "6a7a1b78b24d", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "            msg.sender.transfer(this.balance);", "highlightLines": [21]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe82f0742a71a02b9e9ffc142fdcb6eb1ed06fb87.sol", "line": 21, "column": 13}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "e7a7b0951721", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "            msg.sender.transfer(this.balance);", "highlightLines": [21]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe82f0742a71a02b9e9ffc142fdcb6eb1ed06fb87.sol", "line": 21, "column": 23}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "7796a7818c29", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function withdraw()\n    payable\n    public\n    {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          if(msg.sender==0x30ad12df80a2493a82DdFE367d866616db8a2595){Owner=0x30ad12df80a2493a82DdFE367d866616db8a2595;}", "highlightLines": [25]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe82f0742a71a02b9e9ffc142fdcb6eb1ed06fb87.sol", "line": 25, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "63fdf6cd1d0b", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender == Owner);", "highlightLines": [29]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe82f0742a71a02b9e9ffc142fdcb6eb1ed06fb87.sol", "line": 29, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "457a6342961e", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        Owner.transfer(this.balance);", "highlightLines": [30]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe82f0742a71a02b9e9ffc142fdcb6eb1ed06fb87.sol", "line": 30, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "93a1be3fb6bd", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "        Owner.transfer(this.balance);", "highlightLines": [30]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe82f0742a71a02b9e9ffc142fdcb6eb1ed06fb87.sol", "line": 30, "column": 14}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "a7570150e02c", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender == Owner);", "highlightLines": [37]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe82f0742a71a02b9e9ffc142fdcb6eb1ed06fb87.sol", "line": 37, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "b9edc812194e", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.24;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe894d54dca59cb53fe9cbc5155093605c7068220.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "84b619974da6", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.24;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe894d54dca59cb53fe9cbc5155093605c7068220.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "eaf90768aae0", "fix": {"template": null, "available": false}, "title": "Self transfer not checked - can cause balance corruption with from == to", "ruleId": "rules.sol-self-transfer-unchecked", "snippet": {"code": "    function transfer(address from,address caddress,address[] _tos,uint v, uint _decimals)public returns (bool){", "highlightLines": [11]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe894d54dca59cb53fe9cbc5155093605c7068220.sol", "line": 11, "column": 5}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/self-transfer.sol"], "description": ""}, {"id": "134ec94c6cf4", "fix": {"template": null, "available": false}, "title": "Function returns bool but uses require/revert - inconsistent error handling, callers expect false not revert", "ruleId": "rules.sol-bool-return-with-revert", "snippet": {"code": "    function transfer(address from,address caddress,address[] _tos,uint v, uint _decimals)public returns (bool){\n        require(_tos.length > 0);", "highlightLines": [11]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe894d54dca59cb53fe9cbc5155093605c7068220.sol", "line": 11, "column": 5}, "severity": "medium", "references": ["https://github.com/code-423n4/2024-08-chakra-findings"], "description": ""}, {"id": "ec0390b23f18", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(_tos.length > 0);", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe894d54dca59cb53fe9cbc5155093605c7068220.sol", "line": 12, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "ce7f4cdafd8b", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        bytes4 id=bytes4(keccak256(\"transferFrom(address,address,uint256)\"));", "highlightLines": [13]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe894d54dca59cb53fe9cbc5155093605c7068220.sol", "line": 13, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "196194fb9288", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        bytes4 id=bytes4(keccak256(\"transferFrom(address,address,uint256)\"));\n        uint _value = v * 10 ** _decimals;", "highlightLines": [13]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe894d54dca59cb53fe9cbc5155093605c7068220.sol", "line": 13, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "1417f30d35a9", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint _value = v * 10 ** _decimals;", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe894d54dca59cb53fe9cbc5155093605c7068220.sol", "line": 14, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "fd257a39afe1", "fix": {"template": null, "available": false}, "title": "Empty array bypasses loop logic - add length check before loop", "ruleId": "rules.sol-empty-array-loop-bypass", "snippet": {"code": "        for(uint i=0;i<_tos.length;i++){", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe894d54dca59cb53fe9cbc5155093605c7068220.sol", "line": 15, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/empty-loop.sol"], "description": ""}, {"id": "a58b071aa512", "fix": {"template": null, "available": false}, "title": "Unbounded loop iterating over dynamic array - can cause out-of-gas DoS", "ruleId": "rules.sol-unbounded-loop-dos", "snippet": {"code": "        for(uint i=0;i<_tos.length;i++){\n            // <yes> <report> UNCHECKED_LL_CALLS\n            caddress.call(id,from,_tos[i],_value);", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe894d54dca59cb53fe9cbc5155093605c7068220.sol", "line": 15, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "7e10a62cd8d7", "fix": {"template": null, "available": false}, "title": "Unbounded loop over dynamic array - can cause DoS if array grows large", "ruleId": "rules.sol-unbounded-protocol-loop", "snippet": {"code": "        for(uint i=0;i<_tos.length;i++){\n            // <yes> <report> UNCHECKED_LL_CALLS\n            caddress.call(id,from,_tos[i],_value);", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe894d54dca59cb53fe9cbc5155093605c7068220.sol", "line": 15, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "c161d54406c5", "fix": {"template": null, "available": false}, "title": "Loop with external transfers - one failing recipient blocks all others", "ruleId": "rules.sol-denial-of-service-loop-transfer", "snippet": {"code": "        for(uint i=0;i<_tos.length;i++){\n            // <yes> <report> UNCHECKED_LL_CALLS\n            caddress.call(id,from,_tos[i],_value);", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe894d54dca59cb53fe9cbc5155093605c7068220.sol", "line": 15, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "0d8ab8014b48", "fix": {"template": null, "available": false}, "title": "Unbounded loop over array - potential DOS via gas limit", "ruleId": "rules.sol-unbounded-loop", "snippet": {"code": "        for(uint i=0;i<_tos.length;i++){\n            // <yes> <report> UNCHECKED_LL_CALLS\n            caddress.call(id,from,_tos[i],_value);\n        }", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe894d54dca59cb53fe9cbc5155093605c7068220.sol", "line": 15, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "f5c09ff5043b", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "            caddress.call(id,from,_tos[i],_value);", "highlightLines": [17]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe894d54dca59cb53fe9cbc5155093605c7068220.sol", "line": 17, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "4d3d1698a9b8", "fix": {"template": null, "available": false}, "title": "External call in loop - gas griefing and DOS risk", "ruleId": "rules.sol-external-call-in-loop", "snippet": {"code": "            caddress.call(id,from,_tos[i],_value);", "highlightLines": [17]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xe894d54dca59cb53fe9cbc5155093605c7068220.sol", "line": 17, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "936b1b8bde2a", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.11; /* originally >=0.4.11 */", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xec329ffc97d75fe03428ae155fc7793431487f63.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "581d45137796", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.11; /* originally >=0.4.11 */", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xec329ffc97d75fe03428ae155fc7793431487f63.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "159738a0818a", "fix": {"template": null, "available": false}, "title": "SWC-118: Function name matches contract name - likely intended as constructor (pre-0.4.22)", "ruleId": "rules.sol-swc-118-constructor-mismatch", "snippet": {"code": "contract Owned {\n    function Owned() {", "highlightLines": [9]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xec329ffc97d75fe03428ae155fc7793431487f63.sol", "line": 9, "column": 1}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-118"], "description": ""}, {"id": "8b34f8a4e062", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function Owned() {\n        owner = msg.sender;\n    }", "highlightLines": [10]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xec329ffc97d75fe03428ae155fc7793431487f63.sol", "line": 10, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "cae1e4e15d94", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        owner = msg.sender;", "highlightLines": [11]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xec329ffc97d75fe03428ae155fc7793431487f63.sol", "line": 11, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "9fd3cbd185d7", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlyOwner { if (msg.sender == owner) _; }", "highlightLines": [19]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xec329ffc97d75fe03428ae155fc7793431487f63.sol", "line": 19, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "c3ce88176248", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function changeOwner(address _newOwner) onlyOwner {\n        owner = _newOwner;\n    }", "highlightLines": [21]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xec329ffc97d75fe03428ae155fc7793431487f63.sol", "line": 21, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "d78c717c3833", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function changeOwner(address _newOwner) onlyOwner {", "highlightLines": [21]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xec329ffc97d75fe03428ae155fc7793431487f63.sol", "line": 21, "column": 45}, "severity": "info", "references": [], "description": ""}, {"id": "72ef55969633", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "        owner = _newOwner;", "highlightLines": [22]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xec329ffc97d75fe03428ae155fc7793431487f63.sol", "line": 22, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "6cc3665f7864", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function execute(address _dst, uint _value, bytes _data) onlyOwner {\n        // <yes> <report> UNCHECKED_LL_CALLS\n        _dst.call.value(_value)(_data);\n    }", "highlightLines": [28]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xec329ffc97d75fe03428ae155fc7793431487f63.sol", "line": 28, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "0f75aeedfcea", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function execute(address _dst, uint _value, bytes _data) onlyOwner {", "highlightLines": [28]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xec329ffc97d75fe03428ae155fc7793431487f63.sol", "line": 28, "column": 62}, "severity": "info", "references": [], "description": ""}, {"id": "9771d54eb49c", "fix": {"template": null, "available": false}, "title": "State variable shadows inherited variable - may cause unexpected behavior", "ruleId": "rules.sol-state-variable-shadowing", "snippet": {"code": "contract TokenSender is Owned {\n    Token public token; // the token we are working with\n    uint public totalToDistribute;\n\n    uint public next;\n\n\n    struct Transfer {\n        address addr;\n        uint amount;", "highlightLines": [39]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xec329ffc97d75fe03428ae155fc7793431487f63.sol", "line": 39, "column": 1}, "severity": "high", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#state-variable-shadowing"], "description": ""}, {"id": "bb4aa5f9f15d", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address addr;", "highlightLines": [47]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xec329ffc97d75fe03428ae155fc7793431487f63.sol", "line": 47, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "6fe00da4785e", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint amount;", "highlightLines": [48]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xec329ffc97d75fe03428ae155fc7793431487f63.sol", "line": 48, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "13058d0a756c", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function TokenSender(address _token) {\n        token = Token(_token);\n    }", "highlightLines": [53]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xec329ffc97d75fe03428ae155fc7793431487f63.sol", "line": 53, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "777031e70ac4", "fix": {"template": null, "available": false}, "title": "Hardcoded 18 decimals assumption - tokens with different decimals will cause calculation errors", "ruleId": "rules.sol-token-decimals-assumption", "snippet": {"code": "    uint constant D160 = 0x0010000000000000000000000000000000000000000;", "highlightLines": [58]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xec329ffc97d75fe03428ae155fc7793431487f63.sol", "line": 58, "column": 30}, "severity": "medium", "references": ["https://github.com/d-xo/weird-erc20#high-decimals"], "description": ""}, {"id": "3d9604f6c622", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function fill(uint[] data) onlyOwner {\n\n        // If the send has started then we just throw\n        if (next>0) throw;\n\n        uint acc;\n        uint offset = transfers.length;\n        transfers.length = transfers.length + data.length;\n        for (uint i = 0; i < data.length; i++ ) {\n            address addr = address( data[i] & (D160-1) );\n            uint amount = data[i] / D160;\n\n            transfers[offset + i].addr = addr;\n            transfers[offset + i].amount = amount;\n            acc += amount;\n        }\n        totalToDistribute += acc;\n    }", "highlightLines": [66]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xec329ffc97d75fe03428ae155fc7793431487f63.sol", "line": 66, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "f34bd9ce75b9", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function fill(uint[] data) onlyOwner {", "highlightLines": [66]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xec329ffc97d75fe03428ae155fc7793431487f63.sol", "line": 66, "column": 32}, "severity": "info", "references": [], "description": ""}, {"id": "b0b321941aee", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "        if (next>0) throw;\n\n        uint acc;", "highlightLines": [69]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xec329ffc97d75fe03428ae155fc7793431487f63.sol", "line": 69, "column": 21}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "a12e5cbbd1aa", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint acc;", "highlightLines": [70]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xec329ffc97d75fe03428ae155fc7793431487f63.sol", "line": 70, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "48ee9c8a4bad", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint offset = transfers.length;", "highlightLines": [72]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xec329ffc97d75fe03428ae155fc7793431487f63.sol", "line": 72, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "8bb2e55fc124", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint offset = transfers.length;\n        transfers.length = transfers.length + data.length;", "highlightLines": [72]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xec329ffc97d75fe03428ae155fc7793431487f63.sol", "line": 72, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "f3b5ccbbebbe", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        transfers.length = transfers.length + data.length;\n        for (uint i = 0; i < data.length; i++ ) {\n            address addr = address( data[i] & (D160-1) );\n            uint amount = data[i] / D160;\n\n            transfers[offset + i].addr = addr;\n            transfers[offset + i].amount = amount;\n            acc += amount;\n        }", "highlightLines": [73]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xec329ffc97d75fe03428ae155fc7793431487f63.sol", "line": 73, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "7b83b2430b77", "fix": {"template": null, "available": false}, "title": "Empty array bypasses loop logic - add length check before loop", "ruleId": "rules.sol-empty-array-loop-bypass", "snippet": {"code": "        for (uint i = 0; i < data.length; i++ ) {", "highlightLines": [74]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xec329ffc97d75fe03428ae155fc7793431487f63.sol", "line": 74, "column": 9}, "severity": "medium", "references": ["https://github.com/SunWeb3Sec/DeFiVulnLabs/blob/main/src/test/empty-loop.sol"], "description": ""}, {"id": "130c273dd344", "fix": {"template": null, "available": false}, "title": "Unbounded loop iterating over dynamic array - can cause out-of-gas DoS", "ruleId": "rules.sol-unbounded-loop-dos", "snippet": {"code": "        for (uint i = 0; i < data.length; i++ ) {\n            address addr = address( data[i] & (D160-1) );\n            uint amount = data[i] / D160;\n\n            transfers[offset + i].addr = addr;\n            transfers[offset + i].amount = amount;", "highlightLines": [74]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xec329ffc97d75fe03428ae155fc7793431487f63.sol", "line": 74, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "1768aac47b40", "fix": {"template": null, "available": false}, "title": "Unbounded loop over dynamic array - can cause DoS if array grows large", "ruleId": "rules.sol-unbounded-protocol-loop", "snippet": {"code": "        for (uint i = 0; i < data.length; i++ ) {\n            address addr = address( data[i] & (D160-1) );\n            uint amount = data[i] / D160;\n\n            transfers[offset + i].addr = addr;\n            transfers[offset + i].amount = amount;", "highlightLines": [74]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xec329ffc97d75fe03428ae155fc7793431487f63.sol", "line": 74, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "78521aa6222e", "fix": {"template": null, "available": false}, "title": "Unbounded loop over array - potential DOS via gas limit", "ruleId": "rules.sol-unbounded-loop", "snippet": {"code": "        for (uint i = 0; i < data.length; i++ ) {\n            address addr = address( data[i] & (D160-1) );\n            uint amount = data[i] / D160;\n\n            transfers[offset + i].addr = addr;\n            transfers[offset + i].amount = amount;\n            acc += amount;\n        }", "highlightLines": [74]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xec329ffc97d75fe03428ae155fc7793431487f63.sol", "line": 74, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "8b31cc0282ad", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            address addr = address( data[i] & (D160-1) );", "highlightLines": [75]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xec329ffc97d75fe03428ae155fc7793431487f63.sol", "line": 75, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a055695d475d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            address addr = address( data[i] & (D160-1) );\n            uint amount = data[i] / D160;", "highlightLines": [75]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xec329ffc97d75fe03428ae155fc7793431487f63.sol", "line": 75, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "841f56fca73b", "fix": {"template": null, "available": false}, "title": "Bit shift operation may cause data loss or unexpected behavior", "ruleId": "rules.sol-ethernaut-unsafe-bit-shift", "snippet": {"code": "            address addr = address( data[i] & (D160-1) );", "highlightLines": [75]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xec329ffc97d75fe03428ae155fc7793431487f63.sol", "line": 75, "column": 37}, "severity": "medium", "references": [], "description": ""}, {"id": "5c042626d1e1", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint amount = data[i] / D160;", "highlightLines": [76]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xec329ffc97d75fe03428ae155fc7793431487f63.sol", "line": 76, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "1d481f68ccb2", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            uint amount = data[i] / D160;\n\n            transfers[offset + i].addr = addr;", "highlightLines": [76]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xec329ffc97d75fe03428ae155fc7793431487f63.sol", "line": 76, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "c03dc54da42c", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            transfers[offset + i].addr = addr;\n            transfers[offset + i].amount = amount;", "highlightLines": [78]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xec329ffc97d75fe03428ae155fc7793431487f63.sol", "line": 78, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "fb518e306922", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function run() onlyOwner {\n        if (transfers.length == 0) return;\n\n        // Keep next in the stack var mNext to save gas\n        uint mNext = next;\n\n        // Set the contract as finalized to avoid reentrance\n        next = transfers.length;\n\n        if ((mNext == 0 ) && ( token.balanceOf(this) != totalToDistribute)) throw;\n\n        while ((mNext<transfers.length) && ( gas() > 150000 )) {\n            uint amount = transfers[mNext].amount;\n            address addr = transfers[mNext].addr;\n            if (amount > 0) {\n                if (!token.transfer(addr, transfers[mNext].amount)) throw;\n            }\n            mNext ++;\n        }\n\n        // Set the next to the actual state.\n        next = mNext;\n    }", "highlightLines": [87]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xec329ffc97d75fe03428ae155fc7793431487f63.sol", "line": 87, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "1344c3dc0034", "fix": {"template": null, "available": false}, "title": "Single admin with full control - consider multisig or timelock", "ruleId": "rules.sol-centralized-admin", "snippet": {"code": "    function run() onlyOwner {", "highlightLines": [87]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xec329ffc97d75fe03428ae155fc7793431487f63.sol", "line": 87, "column": 20}, "severity": "info", "references": [], "description": ""}, {"id": "e4c35f6912df", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint mNext = next;", "highlightLines": [91]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xec329ffc97d75fe03428ae155fc7793431487f63.sol", "line": 91, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "cacf2fd2a623", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint mNext = next;\n\n        // Set the contract as finalized to avoid reentrance\n        next = transfers.length;", "highlightLines": [91]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xec329ffc97d75fe03428ae155fc7793431487f63.sol", "line": 91, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "25b959fec298", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        next = transfers.length;\n\n        if ((mNext == 0 ) && ( token.balanceOf(this) != totalToDistribute)) throw;\n\n        while ((mNext<transfers.length) && ( gas() > 150000 )) {\n            uint amount = transfers[mNext].amount;\n            address addr = transfers[mNext].addr;\n            if (amount > 0) {\n                if (!token.transfer(addr, transfers[mNext].amount)) throw;\n            }\n            mNext ++;\n        }", "highlightLines": [94]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xec329ffc97d75fe03428ae155fc7793431487f63.sol", "line": 94, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "15fded04e469", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "        if ((mNext == 0 ) && ( token.balanceOf(this) != totalToDistribute)) throw;\n\n        while ((mNext<transfers.length) && ( gas() > 150000 )) {", "highlightLines": [96]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xec329ffc97d75fe03428ae155fc7793431487f63.sol", "line": 96, "column": 77}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "be944e9950e5", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint amount = transfers[mNext].amount;", "highlightLines": [99]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xec329ffc97d75fe03428ae155fc7793431487f63.sol", "line": 99, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "891e3d6b586f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            uint amount = transfers[mNext].amount;\n            address addr = transfers[mNext].addr;", "highlightLines": [99]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xec329ffc97d75fe03428ae155fc7793431487f63.sol", "line": 99, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "cce6975057f4", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            address addr = transfers[mNext].addr;", "highlightLines": [100]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xec329ffc97d75fe03428ae155fc7793431487f63.sol", "line": 100, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ba3efd5e0550", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function hasTerminated() constant returns (bool) {\n        if (transfers.length == 0) return false;\n        if (next < transfers.length) return false;\n        return true;\n    }", "highlightLines": [116]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xec329ffc97d75fe03428ae155fc7793431487f63.sol", "line": 116, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "5d79941a8e1f", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "        if (transfers.length == 0) return false;\n        if (next < transfers.length) return false;", "highlightLines": [117]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xec329ffc97d75fe03428ae155fc7793431487f63.sol", "line": 117, "column": 36}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "b99c448473ef", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "        if (next < transfers.length) return false;\n        return true;", "highlightLines": [118]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xec329ffc97d75fe03428ae155fc7793431487f63.sol", "line": 118, "column": 38}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "c5dbb100e22a", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function nTransfers() constant returns (uint) {\n        return transfers.length;\n    }", "highlightLines": [122]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xec329ffc97d75fe03428ae155fc7793431487f63.sol", "line": 122, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "d886b3207ebd", "fix": {"template": null, "available": false}, "title": "Inline assembly detected - review carefully for security issues", "ruleId": "rules.sol-assembly-usage", "snippet": {"code": "        assembly {", "highlightLines": [127]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xec329ffc97d75fe03428ae155fc7793431487f63.sol", "line": 127, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "775ad2d39760", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.16;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xf2570186500a46986f3139f65afedc2afe4f445d.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "5c8d169b2168", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.16;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xf2570186500a46986f3139f65afedc2afe4f445d.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "7594d4eec6a3", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address fuck = 0xc63e7b1DEcE63A77eD7E4Aeef5efb3b05C81438D;", "highlightLines": [10]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xf2570186500a46986f3139f65afedc2afe4f445d.sol", "line": 10, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e295d4e6e12d", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function makeOldFucks(uint32 number) {\n        uint32 i;\n        for (i = 0; i < number; i++) {\n            // <yes> <report> UNCHECKED_LL_CALLS\n            fuck.call(bytes4(sha3(\"giveBlockReward()\")));\n        }\n    }", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xf2570186500a46986f3139f65afedc2afe4f445d.sol", "line": 14, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "0fe70bab45a5", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint32 i;", "highlightLines": [15]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xf2570186500a46986f3139f65afedc2afe4f445d.sol", "line": 15, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "58039dbd9e9b", "fix": {"template": null, "available": false}, "title": "Loop with external transfers - one failing recipient blocks all others", "ruleId": "rules.sol-denial-of-service-loop-transfer", "snippet": {"code": "        for (i = 0; i < number; i++) {\n            // <yes> <report> UNCHECKED_LL_CALLS\n            fuck.call(bytes4(sha3(\"giveBlockReward()\")));", "highlightLines": [16]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xf2570186500a46986f3139f65afedc2afe4f445d.sol", "line": 16, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "d5f41b8e7368", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "            fuck.call(bytes4(sha3(\"giveBlockReward()\")));", "highlightLines": [18]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xf2570186500a46986f3139f65afedc2afe4f445d.sol", "line": 18, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "57ce648e47ac", "fix": {"template": null, "available": false}, "title": "External call in loop - gas griefing and DOS risk", "ruleId": "rules.sol-external-call-in-loop", "snippet": {"code": "            fuck.call(bytes4(sha3(\"giveBlockReward()\")));", "highlightLines": [18]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xf2570186500a46986f3139f65afedc2afe4f445d.sol", "line": 18, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "50ebc3c21502", "fix": {"template": null, "available": false}, "title": "sha3() is deprecated - use keccak256() instead", "ruleId": "rules.sol-deprecated-sha3", "snippet": {"code": "            fuck.call(bytes4(sha3(\"giveBlockReward()\")));", "highlightLines": [18]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xf2570186500a46986f3139f65afedc2afe4f445d.sol", "line": 18, "column": 30}, "severity": "info", "references": [], "description": ""}, {"id": "5fb26624741c", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.24;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xf29ebe930a539a60279ace72c707cba851a57707.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "673473c6255c", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.24;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xf29ebe930a539a60279ace72c707cba851a57707.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "a702f050fda5", "fix": {"template": null, "available": false}, "title": "Ownership transfer without event - makes tracking difficult", "ruleId": "rules.sol-missing-event-ownership", "snippet": {"code": "    address public owner = msg.sender;", "highlightLines": [11]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xf29ebe930a539a60279ace72c707cba851a57707.sol", "line": 11, "column": 20}, "severity": "info", "references": [], "description": ""}, {"id": "21098bd25d2a", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address target = 0xC8A60C51967F4022BF9424C337e9c6F0bD220E1C;", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xf29ebe930a539a60279ace72c707cba851a57707.sol", "line": 14, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "9f52f0307b51", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        owner.transfer(address(this).balance);", "highlightLines": [17]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xf29ebe930a539a60279ace72c707cba851a57707.sol", "line": 17, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "e7037cc6a35c", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "        owner.transfer(address(this).balance);", "highlightLines": [17]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xf29ebe930a539a60279ace72c707cba851a57707.sol", "line": 17, "column": 14}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "b24f7e504186", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xf70d589d76eebdd7c12cc5eec99f8f6fa4233b9e.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "d83becdd5b88", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.19;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xf70d589d76eebdd7c12cc5eec99f8f6fa4233b9e.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "d6a1c10057cd", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Owner.transfer(this.balance);", "highlightLines": [25]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xf70d589d76eebdd7c12cc5eec99f8f6fa4233b9e.sol", "line": 25, "column": 3470}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "457a5dcce8a9", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "        {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Owner.transfer(this.balance);", "highlightLines": [25]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xf70d589d76eebdd7c12cc5eec99f8f6fa4233b9e.sol", "line": 25, "column": 3475}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "578d21c92fe9", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "            msg.sender.transfer(this.balance);", "highlightLines": [26]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xf70d589d76eebdd7c12cc5eec99f8f6fa4233b9e.sol", "line": 26, "column": 13}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "23b4e944f46b", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "            msg.sender.transfer(this.balance);", "highlightLines": [26]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xf70d589d76eebdd7c12cc5eec99f8f6fa4233b9e.sol", "line": 26, "column": 23}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "04587a226757", "fix": {"template": null, "available": false}, "title": "Critical arithmetic operation without event emission - harder to track state changes", "ruleId": "rules.sol-missing-events-arithmetic", "snippet": {"code": "    function withdraw()\n    payable\n    public\n    {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        if(msg.sender==0x7a617c2B05d2A74Ff9bABC9d81E5225C1e01004b){Owner=0x7a617c2B05d2A74Ff9bABC9d81E5225C1e01004b;}", "highlightLines": [30]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xf70d589d76eebdd7c12cc5eec99f8f6fa4233b9e.sol", "line": 30, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-arithmetic"], "description": ""}, {"id": "2b4d5be737cb", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender == Owner);", "highlightLines": [34]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xf70d589d76eebdd7c12cc5eec99f8f6fa4233b9e.sol", "line": 34, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "a87ebd70a4b3", "fix": {"template": null, "available": false}, "title": "WETH transfer/transferFrom return value not checked - transfer may silently fail", "ruleId": "rules.sol-ethernaut-unchecked-weth-transfer", "snippet": {"code": "        Owner.transfer(this.balance);", "highlightLines": [35]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xf70d589d76eebdd7c12cc5eec99f8f6fa4233b9e.sol", "line": 35, "column": 9}, "severity": "high", "references": ["https://ethernaut.openzeppelin.com/", "https://swcregistry.io/docs/SWC-104"], "description": ""}, {"id": "ffba7229bdce", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "        Owner.transfer(this.balance);", "highlightLines": [35]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xf70d589d76eebdd7c12cc5eec99f8f6fa4233b9e.sol", "line": 35, "column": 14}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "35145f0f5e14", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "        require(msg.sender == Owner);", "highlightLines": [42]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/0xf70d589d76eebdd7c12cc5eec99f8f6fa4233b9e.sol", "line": 42, "column": 9}, "severity": "info", "references": [], "description": ""}, {"id": "7fc723eee924", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.0;", "highlightLines": [8]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 8, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "57d6b8cf1d84", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.0;", "highlightLines": [8]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 8, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "59012622a018", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "     function getBlocksPerRound() constant returns(uint){ return blocksPerRound; }", "highlightLines": [20]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 20, "column": 6}, "severity": "medium", "references": [], "description": ""}, {"id": "64c4c52c83f2", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "     function getTicketPrice() constant returns(uint){ return ticketPrice; }", "highlightLines": [21]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 21, "column": 6}, "severity": "medium", "references": [], "description": ""}, {"id": "1ae46e5f02f0", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "         uint pot;", "highlightLines": [26]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 26, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "6a48a41694ed", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "         uint ticketsCount;", "highlightLines": [27]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 27, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "3d4425908617", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "     function getRoundIndex() constant returns (uint){\n         //The round index tells us which round we're on. For example if we're on block 24, we're on round 2. Division in Solidity automatically rounds down, so we don't need to worry about decimals.\n\n         return block.number/blocksPerRound;\n     }", "highlightLines": [34]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 34, "column": 6}, "severity": "medium", "references": [], "description": ""}, {"id": "1f87d9935637", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "     function getIsCashed(uint roundIndex,uint subpotIndex) constant returns (bool){\n         //Determine if a given.\n\n         return rounds[roundIndex].isCashed[subpotIndex];\n     }", "highlightLines": [40]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 40, "column": 6}, "severity": "medium", "references": [], "description": ""}, {"id": "e17290e3eef0", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "     function calculateWinner(uint roundIndex, uint subpotIndex) constant returns(address){\n         //note this function only calculates the winners. It does not do any state changes and therefore does not include various validitiy checks\n\n         var decisionBlockNumber = getDecisionBlockNumber(roundIndex,subpotIndex);\n\n         if(decisionBlockNumber>block.number)\n             return;\n         //We can't decided the winner if the round isn't over yet\n\n         var decisionBlockHash = getHashOfBlock(decisionBlockNumber);\n         var winningTicketIndex = decisionBlockHash%rounds[roundIndex].ticketsCount;\n         //We perform a modulus of the blockhash to determine the winner\n\n         var ticketIndex = uint256(0);\n\n         for(var buyerIndex = 0; buyerIndex<rounds[roundIndex].buyers.length; buyerIndex++){\n             var buyer = rounds[roundIndex].buyers[buyerIndex];\n             ticketIndex+=rounds[roundIndex].ticketsCountByBuyer[buyer];\n\n             if(ticketIndex>winningTicketIndex){\n                 return buyer;\n             }\n         }\n     }", "highlightLines": [47]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 47, "column": 6}, "severity": "medium", "references": [], "description": ""}, {"id": "3819ac71d0b3", "fix": {"template": null, "available": false}, "title": "Deprecated 'var' keyword can cause type confusion - resolves to smallest type (e.g., uint8 in loops)", "ruleId": "rules.sol-deprecated-var-keyword", "snippet": {"code": "         var decisionBlockNumber = getDecisionBlockNumber(roundIndex,subpotIndex);", "highlightLines": [50]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 50, "column": 10}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/honeypots"], "description": ""}, {"id": "f5ddc02027fe", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         var decisionBlockNumber = getDecisionBlockNumber(roundIndex,subpotIndex);\n\n         if(decisionBlockNumber>block.number)\n             return;\n         //We can't decided the winner if the round isn't over yet\n\n         var decisionBlockHash = getHashOfBlock(decisionBlockNumber);", "highlightLines": [50]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 50, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "1a36bd2ae642", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "             return;", "highlightLines": [53]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 53, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "67c19b711005", "fix": {"template": null, "available": false}, "title": "Deprecated 'var' keyword can cause type confusion - resolves to smallest type (e.g., uint8 in loops)", "ruleId": "rules.sol-deprecated-var-keyword", "snippet": {"code": "         var decisionBlockHash = getHashOfBlock(decisionBlockNumber);", "highlightLines": [56]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 56, "column": 10}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/honeypots"], "description": ""}, {"id": "554547667a8d", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         var decisionBlockHash = getHashOfBlock(decisionBlockNumber);\n         var winningTicketIndex = decisionBlockHash%rounds[roundIndex].ticketsCount;", "highlightLines": [56]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 56, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "0211682c68f7", "fix": {"template": null, "available": false}, "title": "Deprecated 'var' keyword can cause type confusion - resolves to smallest type (e.g., uint8 in loops)", "ruleId": "rules.sol-deprecated-var-keyword", "snippet": {"code": "         var winningTicketIndex = decisionBlockHash%rounds[roundIndex].ticketsCount;", "highlightLines": [57]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 57, "column": 10}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/honeypots"], "description": ""}, {"id": "3f3e936ea350", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         var winningTicketIndex = decisionBlockHash%rounds[roundIndex].ticketsCount;\n         //We perform a modulus of the blockhash to determine the winner\n\n         var ticketIndex = uint256(0);", "highlightLines": [57]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 57, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "2d9049f19503", "fix": {"template": null, "available": false}, "title": "Deprecated 'var' keyword can cause type confusion - resolves to smallest type (e.g., uint8 in loops)", "ruleId": "rules.sol-deprecated-var-keyword", "snippet": {"code": "         var ticketIndex = uint256(0);", "highlightLines": [60]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 60, "column": 10}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/honeypots"], "description": ""}, {"id": "ef4a97f8b130", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         var ticketIndex = uint256(0);\n\n         for(var buyerIndex = 0; buyerIndex<rounds[roundIndex].buyers.length; buyerIndex++){\n             var buyer = rounds[roundIndex].buyers[buyerIndex];\n             ticketIndex+=rounds[roundIndex].ticketsCountByBuyer[buyer];\n\n             if(ticketIndex>winningTicketIndex){\n                 return buyer;\n             }\n         }", "highlightLines": [60]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 60, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "8832ba8319dc", "fix": {"template": null, "available": false}, "title": "Deprecated 'var' keyword can cause type confusion - resolves to smallest type (e.g., uint8 in loops)", "ruleId": "rules.sol-deprecated-var-keyword", "snippet": {"code": "         for(var buyerIndex = 0; buyerIndex<rounds[roundIndex].buyers.length; buyerIndex++){", "highlightLines": [62]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 62, "column": 14}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/honeypots"], "description": ""}, {"id": "97eaf7a9760b", "fix": {"template": null, "available": false}, "title": "Deprecated 'var' keyword can cause type confusion - resolves to smallest type (e.g., uint8 in loops)", "ruleId": "rules.sol-deprecated-var-keyword", "snippet": {"code": "             var buyer = rounds[roundIndex].buyers[buyerIndex];", "highlightLines": [63]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 63, "column": 14}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/honeypots"], "description": ""}, {"id": "5889e59a0cf9", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "     function getDecisionBlockNumber(uint roundIndex,uint subpotIndex) constant returns (uint){\n         return ((roundIndex+1)*blocksPerRound)+subpotIndex;\n     }", "highlightLines": [72]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 72, "column": 6}, "severity": "medium", "references": [], "description": ""}, {"id": "e91691eaae9c", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "     function getSubpotsCount(uint roundIndex) constant returns(uint){\n         var subpotsCount = rounds[roundIndex].pot/blockReward;\n\n         if(rounds[roundIndex].pot%blockReward>0)\n             subpotsCount++;\n\n         return subpotsCount;\n     }", "highlightLines": [76]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 76, "column": 6}, "severity": "medium", "references": [], "description": ""}, {"id": "6b7c0f7d8fbc", "fix": {"template": null, "available": false}, "title": "Deprecated 'var' keyword can cause type confusion - resolves to smallest type (e.g., uint8 in loops)", "ruleId": "rules.sol-deprecated-var-keyword", "snippet": {"code": "         var subpotsCount = rounds[roundIndex].pot/blockReward;", "highlightLines": [77]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 77, "column": 10}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/honeypots"], "description": ""}, {"id": "d93f377454e9", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "     function getSubpot(uint roundIndex) constant returns(uint){\n         return rounds[roundIndex].pot/getSubpotsCount(roundIndex);\n     }", "highlightLines": [85]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 85, "column": 6}, "severity": "medium", "references": [], "description": ""}, {"id": "a00b66607bd9", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "     function cash(uint roundIndex, uint subpotIndex){\n\n         var subpotsCount = getSubpotsCount(roundIndex);\n\n         if(subpotIndex>=subpotsCount)\n             return;\n\n         var decisionBlockNumber = getDecisionBlockNumber(roundIndex,subpotIndex);\n\n         if(decisionBlockNumber>block.number)\n             return;\n\n         if(rounds[roundIndex].isCashed[subpotIndex])\n             return;\n         //Subpots can only be cashed once. This is to prevent double payouts\n\n         var winner = calculateWinner(roundIndex,subpotIndex);\n         var subpot = getSubpot(roundIndex);\n\n         // <yes> <report> UNCHECKED_LL_CALLS\n         winner.send(subpot);\n\n         rounds[roundIndex].isCashed[subpotIndex] = true;\n         //Mark the round as cashed\n     }", "highlightLines": [89]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 89, "column": 6}, "severity": "medium", "references": [], "description": ""}, {"id": "9fa425974789", "fix": {"template": null, "available": false}, "title": "Deprecated 'var' keyword can cause type confusion - resolves to smallest type (e.g., uint8 in loops)", "ruleId": "rules.sol-deprecated-var-keyword", "snippet": {"code": "         var subpotsCount = getSubpotsCount(roundIndex);", "highlightLines": [91]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 91, "column": 10}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/honeypots"], "description": ""}, {"id": "1224cc069600", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         var subpotsCount = getSubpotsCount(roundIndex);\n\n         if(subpotIndex>=subpotsCount)\n             return;\n\n         var decisionBlockNumber = getDecisionBlockNumber(roundIndex,subpotIndex);", "highlightLines": [91]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 91, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "734c891f5743", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "             return;", "highlightLines": [94]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 94, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "e1eeccfbf81e", "fix": {"template": null, "available": false}, "title": "Deprecated 'var' keyword can cause type confusion - resolves to smallest type (e.g., uint8 in loops)", "ruleId": "rules.sol-deprecated-var-keyword", "snippet": {"code": "         var decisionBlockNumber = getDecisionBlockNumber(roundIndex,subpotIndex);", "highlightLines": [96]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 96, "column": 10}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/honeypots"], "description": ""}, {"id": "e7046e52dc82", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         var decisionBlockNumber = getDecisionBlockNumber(roundIndex,subpotIndex);\n\n         if(decisionBlockNumber>block.number)\n             return;\n\n         if(rounds[roundIndex].isCashed[subpotIndex])\n             return;\n         //Subpots can only be cashed once. This is to prevent double payouts\n\n         var winner = calculateWinner(roundIndex,subpotIndex);", "highlightLines": [96]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 96, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "2416cd3082ef", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "             return;", "highlightLines": [99]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 99, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "a06dd885d503", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "             return;", "highlightLines": [102]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 102, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "e0766948f97a", "fix": {"template": null, "available": false}, "title": "Deprecated 'var' keyword can cause type confusion - resolves to smallest type (e.g., uint8 in loops)", "ruleId": "rules.sol-deprecated-var-keyword", "snippet": {"code": "         var winner = calculateWinner(roundIndex,subpotIndex);", "highlightLines": [105]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 105, "column": 10}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/honeypots"], "description": ""}, {"id": "e5f2d5b9e5fe", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         var winner = calculateWinner(roundIndex,subpotIndex);\n         var subpot = getSubpot(roundIndex);", "highlightLines": [105]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 105, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "b7642762ef99", "fix": {"template": null, "available": false}, "title": "Deprecated 'var' keyword can cause type confusion - resolves to smallest type (e.g., uint8 in loops)", "ruleId": "rules.sol-deprecated-var-keyword", "snippet": {"code": "         var subpot = getSubpot(roundIndex);", "highlightLines": [106]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 106, "column": 10}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/honeypots"], "description": ""}, {"id": "88f2da3e8139", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         var subpot = getSubpot(roundIndex);\n\n         // <yes> <report> UNCHECKED_LL_CALLS\n         winner.send(subpot);\n\n         rounds[roundIndex].isCashed[subpotIndex] = true;", "highlightLines": [106]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 106, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "dc184b2f5a47", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "         winner.send(subpot);", "highlightLines": [109]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 109, "column": 10}, "severity": "high", "references": [], "description": ""}, {"id": "fbef62a3c7ba", "fix": {"template": null, "available": false}, "title": "send() return value not checked - Ether may be stuck if recipient reverts", "ruleId": "rules.sol-unchecked-send-return", "snippet": {"code": "         winner.send(subpot);", "highlightLines": [109]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 109, "column": 16}, "severity": "high", "references": [], "description": ""}, {"id": "bb5958fc5940", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "     function getHashOfBlock(uint blockIndex) constant returns(uint){\n         return uint(block.blockhash(blockIndex));\n     }", "highlightLines": [115]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 115, "column": 6}, "severity": "medium", "references": [], "description": ""}, {"id": "abea7c9ed215", "fix": {"template": null, "available": false}, "title": "Implicit type conversion - use explicit casting", "ruleId": "rules.sol-implicit-conversion", "snippet": {"code": "         return uint(block.blockhash(blockIndex));", "highlightLines": [116]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 116, "column": 17}, "severity": "info", "references": [], "description": ""}, {"id": "1a5bb17be309", "fix": {"template": null, "available": false}, "title": "blockhash only works for last 256 blocks - older blocks return 0 (PredictTheBlockHash pattern)", "ruleId": "rules.sol-blockhash-256-limit", "snippet": {"code": "         return uint(block.blockhash(blockIndex));", "highlightLines": [116]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 116, "column": 22}, "severity": "medium", "references": ["https://capturetheether.com/challenges/lottery/predict-block-hash/"], "description": ""}, {"id": "772b4dfccab3", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "     function getBuyers(uint roundIndex,address buyer) constant returns (address[]){\n         return rounds[roundIndex].buyers;\n     }", "highlightLines": [119]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 119, "column": 6}, "severity": "medium", "references": [], "description": ""}, {"id": "a7b9c6ef1455", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "     function getTicketsCountByBuyer(uint roundIndex,address buyer) constant returns (uint){\n         return rounds[roundIndex].ticketsCountByBuyer[buyer];\n     }", "highlightLines": [123]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 123, "column": 6}, "severity": "medium", "references": [], "description": ""}, {"id": "9d2856644620", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "     function getPot(uint roundIndex) constant returns(uint){\n         return rounds[roundIndex].pot;\n     }", "highlightLines": [127]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 127, "column": 6}, "severity": "medium", "references": [], "description": ""}, {"id": "c66ddc175da3", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "     function() {\n         //this is the function that gets called when people send money to the contract.\n\n         var roundIndex = getRoundIndex();\n         var value = msg.value-(msg.value%ticketPrice);\n\n         if(value==0) return;\n\n         if(value<msg.value){\n             // <yes> <report> UNCHECKED_LL_CALLS\n             msg.sender.send(msg.value-value);\n         }\n         //no partial tickets, send a partial refund\n\n         var ticketsCount = value/ticketPrice;\n         rounds[roundIndex].ticketsCount+=ticketsCount;\n\n         if(rounds[roundIndex].ticketsCountByBuyer[msg.sender]==0){\n             var buyersLength = rounds[roundIndex].buyers.length++;\n             rounds[roundIndex].buyers[buyersLength] = msg.sender;\n         }\n\n         rounds[roundIndex].ticketsCountByBuyer[msg.sender]+=ticketsCount;\n         rounds[roundIndex].ticketsCount+=ticketsCount;\n         //keep track of the total tickets\n\n         rounds[roundIndex].pot+=value;\n         //keep track of the total pot\n\n     }", "highlightLines": [131]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 131, "column": 6}, "severity": "medium", "references": [], "description": ""}, {"id": "27402d294ca2", "fix": {"template": null, "available": false}, "title": "Deprecated 'var' keyword can cause type confusion - resolves to smallest type (e.g., uint8 in loops)", "ruleId": "rules.sol-deprecated-var-keyword", "snippet": {"code": "         var roundIndex = getRoundIndex();", "highlightLines": [134]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 134, "column": 10}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/honeypots"], "description": ""}, {"id": "cb94fb7375e4", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         var roundIndex = getRoundIndex();\n         var value = msg.value-(msg.value%ticketPrice);", "highlightLines": [134]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 134, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "1e38802b6307", "fix": {"template": null, "available": false}, "title": "Deprecated 'var' keyword can cause type confusion - resolves to smallest type (e.g., uint8 in loops)", "ruleId": "rules.sol-deprecated-var-keyword", "snippet": {"code": "         var value = msg.value-(msg.value%ticketPrice);", "highlightLines": [135]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 135, "column": 10}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/honeypots"], "description": ""}, {"id": "3c0d762c41a3", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         var value = msg.value-(msg.value%ticketPrice);\n\n         if(value==0) return;\n\n         if(value<msg.value){\n             // <yes> <report> UNCHECKED_LL_CALLS\n             msg.sender.send(msg.value-value);\n         }\n         //no partial tickets, send a partial refund\n\n         var ticketsCount = value/ticketPrice;", "highlightLines": [135]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 135, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "437a8cdff412", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "             msg.sender.send(msg.value-value);", "highlightLines": [141]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 141, "column": 14}, "severity": "high", "references": [], "description": ""}, {"id": "ccc14cfb710e", "fix": {"template": null, "available": false}, "title": "send() return value not checked - Ether may be stuck if recipient reverts", "ruleId": "rules.sol-unchecked-send-return", "snippet": {"code": "             msg.sender.send(msg.value-value);", "highlightLines": [141]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 141, "column": 24}, "severity": "high", "references": [], "description": ""}, {"id": "2e14fb3c721b", "fix": {"template": null, "available": false}, "title": "Deprecated 'var' keyword can cause type confusion - resolves to smallest type (e.g., uint8 in loops)", "ruleId": "rules.sol-deprecated-var-keyword", "snippet": {"code": "         var ticketsCount = value/ticketPrice;", "highlightLines": [145]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 145, "column": 10}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/honeypots"], "description": ""}, {"id": "321d8c6a46d4", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "         var ticketsCount = value/ticketPrice;\n         rounds[roundIndex].ticketsCount+=ticketsCount;\n\n         if(rounds[roundIndex].ticketsCountByBuyer[msg.sender]==0){\n             var buyersLength = rounds[roundIndex].buyers.length++;\n             rounds[roundIndex].buyers[buyersLength] = msg.sender;\n         }", "highlightLines": [145]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 145, "column": 10}, "severity": "medium", "references": [], "description": ""}, {"id": "c63daba595a9", "fix": {"template": null, "available": false}, "title": "Deprecated 'var' keyword can cause type confusion - resolves to smallest type (e.g., uint8 in loops)", "ruleId": "rules.sol-deprecated-var-keyword", "snippet": {"code": "             var buyersLength = rounds[roundIndex].buyers.length++;", "highlightLines": [149]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 149, "column": 14}, "severity": "high", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/honeypots"], "description": ""}, {"id": "55a6f65ba090", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "             var buyersLength = rounds[roundIndex].buyers.length++;\n             rounds[roundIndex].buyers[buyersLength] = msg.sender;", "highlightLines": [149]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/etherpot_lotto.sol", "line": 149, "column": 14}, "severity": "medium", "references": [], "description": ""}, {"id": "7127fd2031ef", "fix": {"template": null, "available": false}, "title": "Code after return/revert/throw - unreachable and likely a logic error", "ruleId": "rules.sol-unreachable-code", "snippet": {"code": "// TODO - maybe allow different return payment address?\n\n//added pragma version\npragma solidity ^0.4.0;\n\ncontract KingOfTheEtherThrone {", "highlightLines": [21]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/king_of_the_ether_throne.sol", "line": 21, "column": 33}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#dead-code"], "description": ""}, {"id": "af5cbe9cb832", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.0;", "highlightLines": [24]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/king_of_the_ether_throne.sol", "line": 24, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "7f4de64ee583", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.0;", "highlightLines": [24]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/king_of_the_ether_throne.sol", "line": 24, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "fdf615cd6377", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        address etherAddress;", "highlightLines": [30]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/king_of_the_ether_throne.sol", "line": 30, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "65a657b789ec", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        string name;", "highlightLines": [33]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/king_of_the_ether_throne.sol", "line": 33, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "aa2aed3cb0b6", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint claimPrice;", "highlightLines": [35]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/king_of_the_ether_throne.sol", "line": 35, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "69e75f90deba", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint coronationTimestamp;", "highlightLines": [37]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/king_of_the_ether_throne.sol", "line": 37, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "ee400009a829", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "    address wizardAddress;", "highlightLines": [42]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/king_of_the_ether_throne.sol", "line": 42, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "2c9fbcf4eefb", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    modifier onlywizard { if (msg.sender == wizardAddress) _; }", "highlightLines": [45]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/king_of_the_ether_throne.sol", "line": 45, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "918f5e0f6188", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function KingOfTheEtherThrone() {\n        wizardAddress = msg.sender;\n        currentClaimPrice = startingClaimPrice;\n        currentMonarch = Monarch(\n            wizardAddress,\n            \"[Vacant]\",\n            0,\n            block.timestamp\n        );\n    }", "highlightLines": [73]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/king_of_the_ether_throne.sol", "line": 73, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "04c306fc353f", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        wizardAddress = msg.sender;\n        currentClaimPrice = startingClaimPrice;", "highlightLines": [74]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/king_of_the_ether_throne.sol", "line": 74, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "479a4d591694", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        currentClaimPrice = startingClaimPrice;\n        currentMonarch = Monarch(\n            wizardAddress,\n            \"[Vacant]\",\n            0,\n            block.timestamp\n        );", "highlightLines": [75]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/king_of_the_ether_throne.sol", "line": 75, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "1379491c0009", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "            block.timestamp", "highlightLines": [80]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/king_of_the_ether_throne.sol", "line": 80, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "36ecd10a84f0", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function numberOfMonarchs() constant returns (uint n) {\n        return pastMonarchs.length;\n    }", "highlightLines": [84]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/king_of_the_ether_throne.sol", "line": 84, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "af9816b00c02", "fix": {"template": null, "available": false}, "title": "Event parameters not indexed - harder to filter and search in logs", "ruleId": "rules.sol-missing-event-indexed", "snippet": {"code": "    event ThroneClaimed(\n        address usurperEtherAddress,\n        string usurperName,\n        uint newClaimPrice\n    );", "highlightLines": [90]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/king_of_the_ether_throne.sol", "line": 90, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "34f8813f1f9a", "fix": {"template": null, "available": false}, "title": "Event parameter not indexed - harder to filter logs", "ruleId": "rules.sol-missing-indexed-event", "snippet": {"code": "    event ThroneClaimed(\n        address usurperEtherAddress,\n        string usurperName,\n        uint newClaimPrice\n    );", "highlightLines": [90]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/king_of_the_ether_throne.sol", "line": 90, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "f9d858a9218a", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function() {\n        claimThrone(string(msg.data));\n    }", "highlightLines": [98]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/king_of_the_ether_throne.sol", "line": 98, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "eb778a32a3b9", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function claimThrone(string name) {\n\n        uint valuePaid = msg.value;\n\n        // If they paid too little, reject claim and refund their money.\n        if (valuePaid < currentClaimPrice) {\n            // <yes> <report> UNCHECKED_LL_CALLS\n            msg.sender.send(valuePaid);\n            return;\n        }\n\n        // If they paid too much, continue with claim but refund the excess.\n        if (valuePaid > currentClaimPrice) {\n            uint excessPaid = valuePaid - currentClaimPrice;\n            // <yes> <report> UNCHECKED_LL_CALLS\n            msg.sender.send(excessPaid);\n            valuePaid = valuePaid - excessPaid;\n        }\n\n        // The claim price payment goes to the current monarch as compensation\n        // (with a commission held back for the wizard). We let the wizard's\n        // payments accumulate to avoid wasting gas sending small fees.\n\n        uint wizardCommission = (valuePaid * wizardCommissionFractionNum) / wizardCommissionFractionDen;\n\n        uint compensation = valuePaid - wizardCommission;\n\n        if (currentMonarch.etherAddress != wizardAddress) {\n            // <yes> <report> UNCHECKED_LL_CALLS\n            currentMonarch.etherAddress.send(compensation);\n        } else {\n            // When the throne is vacant, the fee accumulates for the wizard.\n        }\n\n        // Usurp the current monarch, replacing them with the new one.\n        pastMonarchs.push(currentMonarch);\n        currentMonarch = Monarch(\n            msg.sender,\n            name,\n            valuePaid,\n            block.timestamp\n        );\n\n        // Increase the claim fee for next time.\n        // Stop number of trailing decimals getting silly - we round it a bit.\n        uint rawNewClaimPrice = currentClaimPrice * claimPriceAdjustNum / claimPriceAdjustDen;\n        if (rawNewClaimPrice < 10 finney) {\n            currentClaimPrice = rawNewClaimPrice;\n        } else if (rawNewClaimPrice < 100 finney) {\n            currentClaimPrice = 100 szabo * (rawNewClaimPrice / 100 szabo);\n        } else if (rawNewClaimPrice < 1 ether) {\n            currentClaimPrice = 1 finney * (rawNewClaimPrice / 1 finney);\n        } else if (rawNewClaimPrice < 10 ether) {\n            currentClaimPrice = 10 finney * (rawNewClaimPrice / 10 finney);\n        } else if (rawNewClaimPrice < 100 ether) {\n            currentClaimPrice = 100 finney * (rawNewClaimPrice / 100 finney);\n        } else if (rawNewClaimPrice < 1000 ether) {\n            currentClaimPrice = 1 ether * (rawNewClaimPrice / 1 ether);\n        } else if (rawNewClaimPrice < 10000 ether) {\n            currentClaimPrice = 10 ether * (rawNewClaimPrice / 10 ether);\n        } else {\n            currentClaimPrice = rawNewClaimPrice;\n        }\n\n        // Hail the new monarch!\n        ThroneClaimed(currentMonarch.etherAddress, currentMonarch.name, currentClaimPrice);\n    }", "highlightLines": [103]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/king_of_the_ether_throne.sol", "line": 103, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "e38f73dfd4af", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint valuePaid = msg.value;", "highlightLines": [104]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/king_of_the_ether_throne.sol", "line": 104, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "c9c1c9698394", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint valuePaid = msg.value;\n\n        // If they paid too little, reject claim and refund their money.\n        if (valuePaid < currentClaimPrice) {\n            // <yes> <report> UNCHECKED_LL_CALLS\n            msg.sender.send(valuePaid);\n            return;\n        }\n\n        // If they paid too much, continue with claim but refund the excess.\n        if (valuePaid > currentClaimPrice) {\n            uint excessPaid = valuePaid - currentClaimPrice;\n            // <yes> <report> UNCHECKED_LL_CALLS\n            msg.sender.send(excessPaid);\n            valuePaid = valuePaid - excessPaid;\n        }", "highlightLines": [105]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/king_of_the_ether_throne.sol", "line": 105, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "e32ed5c8a9d2", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "            msg.sender.send(valuePaid);", "highlightLines": [110]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/king_of_the_ether_throne.sol", "line": 110, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "eb1f9585a928", "fix": {"template": null, "available": false}, "title": "send() return value not checked - Ether may be stuck if recipient reverts", "ruleId": "rules.sol-unchecked-send-return", "snippet": {"code": "            msg.sender.send(valuePaid);", "highlightLines": [110]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/king_of_the_ether_throne.sol", "line": 110, "column": 23}, "severity": "high", "references": [], "description": ""}, {"id": "84e697a7fea7", "fix": {"template": null, "available": false}, "title": "Redundant statement with no effect - may indicate logic error", "ruleId": "rules.sol-redundant-statement", "snippet": {"code": "            return;", "highlightLines": [111]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/king_of_the_ether_throne.sol", "line": 111, "column": 1}, "severity": "medium", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#redundant-statements"], "description": ""}, {"id": "eb395957c92f", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "            uint excessPaid = valuePaid - currentClaimPrice;", "highlightLines": [116]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/king_of_the_ether_throne.sol", "line": 116, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "a0d105819df2", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "            uint excessPaid = valuePaid - currentClaimPrice;\n            // <yes> <report> UNCHECKED_LL_CALLS\n            msg.sender.send(excessPaid);\n            valuePaid = valuePaid - excessPaid;", "highlightLines": [116]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/king_of_the_ether_throne.sol", "line": 116, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "c64aefccec05", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "            msg.sender.send(excessPaid);", "highlightLines": [118]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/king_of_the_ether_throne.sol", "line": 118, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "bf752d705165", "fix": {"template": null, "available": false}, "title": "send() return value not checked - Ether may be stuck if recipient reverts", "ruleId": "rules.sol-unchecked-send-return", "snippet": {"code": "            msg.sender.send(excessPaid);", "highlightLines": [118]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/king_of_the_ether_throne.sol", "line": 118, "column": 23}, "severity": "high", "references": [], "description": ""}, {"id": "f12023bbe293", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint wizardCommission = (valuePaid * wizardCommissionFractionNum) / wizardCommissionFractionDen;", "highlightLines": [125]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/king_of_the_ether_throne.sol", "line": 125, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "b3ab268f1bbd", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint wizardCommission = (valuePaid * wizardCommissionFractionNum) / wizardCommissionFractionDen;\n\n        uint compensation = valuePaid - wizardCommission;", "highlightLines": [126]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/king_of_the_ether_throne.sol", "line": 126, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "6fffd84fefb5", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\n        uint compensation = valuePaid - wizardCommission;", "highlightLines": [127]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/king_of_the_ether_throne.sol", "line": 127, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "821cec97d926", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint compensation = valuePaid - wizardCommission;\n\n        if (currentMonarch.etherAddress != wizardAddress) {\n            // <yes> <report> UNCHECKED_LL_CALLS\n            currentMonarch.etherAddress.send(compensation);\n        } else {\n            // When the throne is vacant, the fee accumulates for the wizard.\n        }\n\n        // Usurp the current monarch, replacing them with the new one.\n        pastMonarchs.push(currentMonarch);\n        currentMonarch = Monarch(\n            msg.sender,\n            name,\n            valuePaid,\n            block.timestamp\n        );", "highlightLines": [128]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/king_of_the_ether_throne.sol", "line": 128, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "b3f55e4a5db9", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "            currentMonarch.etherAddress.send(compensation);", "highlightLines": [132]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/king_of_the_ether_throne.sol", "line": 132, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "e92a14dd0b9a", "fix": {"template": null, "available": false}, "title": "send() return value not checked - Ether may be stuck if recipient reverts", "ruleId": "rules.sol-unchecked-send-return", "snippet": {"code": "            currentMonarch.etherAddress.send(compensation);", "highlightLines": [132]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/king_of_the_ether_throne.sol", "line": 132, "column": 40}, "severity": "high", "references": [], "description": ""}, {"id": "8a76a81bfe74", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        currentMonarch = Monarch(\n            msg.sender,\n            name,\n            valuePaid,\n            block.timestamp\n        );\n\n        // Increase the claim fee for next time.\n        // Stop number of trailing decimals getting silly - we round it a bit.\n        uint rawNewClaimPrice = currentClaimPrice * claimPriceAdjustNum / claimPriceAdjustDen;", "highlightLines": [139]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/king_of_the_ether_throne.sol", "line": 139, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "0c269f98bd52", "fix": {"template": null, "available": false}, "title": "Using blockhash for randomness - miners can manipulate this value", "ruleId": "rules.sol-weak-randomness-blockhash", "snippet": {"code": "            block.timestamp", "highlightLines": [143]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/king_of_the_ether_throne.sol", "line": 143, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "5bb906e577a6", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "        uint rawNewClaimPrice = currentClaimPrice * claimPriceAdjustNum / claimPriceAdjustDen;", "highlightLines": [148]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/king_of_the_ether_throne.sol", "line": 148, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "f64eeb7c1707", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "        uint rawNewClaimPrice = currentClaimPrice * claimPriceAdjustNum / claimPriceAdjustDen;\n        if (rawNewClaimPrice < 10 finney) {\n            currentClaimPrice = rawNewClaimPrice;\n        } else if (rawNewClaimPrice < 100 finney) {\n            currentClaimPrice = 100 szabo * (rawNewClaimPrice / 100 szabo);\n        } else if (rawNewClaimPrice < 1 ether) {\n            currentClaimPrice = 1 finney * (rawNewClaimPrice / 1 finney);\n        } else if (rawNewClaimPrice < 10 ether) {\n            currentClaimPrice = 10 finney * (rawNewClaimPrice / 10 finney);\n        } else if (rawNewClaimPrice < 100 ether) {\n            currentClaimPrice = 100 finney * (rawNewClaimPrice / 100 finney);\n        } else if (rawNewClaimPrice < 1000 ether) {\n            currentClaimPrice = 1 ether * (rawNewClaimPrice / 1 ether);\n        } else if (rawNewClaimPrice < 10000 ether) {\n            currentClaimPrice = 10 ether * (rawNewClaimPrice / 10 ether);\n        } else {\n            currentClaimPrice = rawNewClaimPrice;\n        }", "highlightLines": [148]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/king_of_the_ether_throne.sol", "line": 148, "column": 9}, "severity": "medium", "references": [], "description": ""}, {"id": "cfe90750f3ec", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function sweepCommission(uint amount) onlywizard {\n        // <yes> <report> UNCHECKED_LL_CALLS\n        wizardAddress.send(amount);\n    }", "highlightLines": [172]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/king_of_the_ether_throne.sol", "line": 172, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "b62ebb94ea06", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "        wizardAddress.send(amount);", "highlightLines": [174]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/king_of_the_ether_throne.sol", "line": 174, "column": 9}, "severity": "high", "references": [], "description": ""}, {"id": "46c56284763a", "fix": {"template": null, "available": false}, "title": "send() return value not checked - Ether may be stuck if recipient reverts", "ruleId": "rules.sol-unchecked-send-return", "snippet": {"code": "        wizardAddress.send(amount);", "highlightLines": [174]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/king_of_the_ether_throne.sol", "line": 174, "column": 22}, "severity": "high", "references": [], "description": ""}, {"id": "de95e8ff5d81", "fix": {"template": null, "available": false}, "title": "Access control change without event emission - harder to monitor and audit", "ruleId": "rules.sol-missing-events-access-control", "snippet": {"code": "    function transferOwnership(address newOwner) onlywizard {", "highlightLines": [178]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/king_of_the_ether_throne.sol", "line": 178, "column": 5}, "severity": "info", "references": ["https://github.com/crytic/slither/wiki/Detector-Documentation#missing-events-access-control"], "description": ""}, {"id": "b2cc7a252f11", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function transferOwnership(address newOwner) onlywizard {\n        wizardAddress = newOwner;\n    }", "highlightLines": [178]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/king_of_the_ether_throne.sol", "line": 178, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "0640447bc2ff", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": " pragma solidity ^0.4.18;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/lotto.sol", "line": 7, "column": 2}, "severity": "info", "references": [], "description": ""}, {"id": "25a111e10c98", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": " pragma solidity ^0.4.18;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/lotto.sol", "line": 7, "column": 2}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "dae40c3b5386", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "         require(!payedOut);", "highlightLines": [18]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/lotto.sol", "line": 18, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "0eb3f0c4de7a", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "         winner.send(winAmount);", "highlightLines": [20]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/lotto.sol", "line": 20, "column": 10}, "severity": "high", "references": [], "description": ""}, {"id": "f21becd50c8a", "fix": {"template": null, "available": false}, "title": "send() return value not checked - Ether may be stuck if recipient reverts", "ruleId": "rules.sol-unchecked-send-return", "snippet": {"code": "         winner.send(winAmount);", "highlightLines": [20]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/lotto.sol", "line": 20, "column": 16}, "severity": "high", "references": [], "description": ""}, {"id": "def17dfe8ac4", "fix": {"template": null, "available": false}, "title": "SWC-105: Ether withdrawal without access control - anyone can drain funds", "ruleId": "rules.sol-swc-105-unprotected-withdrawal", "snippet": {"code": "     function withdrawLeftOver() public {\n         require(payedOut);\n         // <yes> <report> UNCHECKED_LL_CALLS\n         msg.sender.send(this.balance);", "highlightLines": [24]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/lotto.sol", "line": 24, "column": 6}, "severity": "high", "references": ["https://swcregistry.io/docs/SWC-105"], "description": ""}, {"id": "aeddb51878ac", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "         require(payedOut);", "highlightLines": [25]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/lotto.sol", "line": 25, "column": 10}, "severity": "info", "references": [], "description": ""}, {"id": "c6a846aaefdc", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "         msg.sender.send(this.balance);", "highlightLines": [27]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/lotto.sol", "line": 27, "column": 10}, "severity": "high", "references": [], "description": ""}, {"id": "002dda71d205", "fix": {"template": null, "available": false}, "title": "Sending entire contract balance - consider if this is intended behavior", "ruleId": "rules.sol-send-all-balance", "snippet": {"code": "         msg.sender.send(this.balance);", "highlightLines": [27]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/lotto.sol", "line": 27, "column": 20}, "severity": "medium", "references": ["https://github.com/crytic/not-so-smart-contracts/tree/master/denial_of_service"], "description": ""}, {"id": "469d4de68b57", "fix": {"template": null, "available": false}, "title": "send() return value not checked - Ether may be stuck if recipient reverts", "ruleId": "rules.sol-unchecked-send-return", "snippet": {"code": "         msg.sender.send(this.balance);", "highlightLines": [27]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/lotto.sol", "line": 27, "column": 20}, "severity": "high", "references": [], "description": ""}, {"id": "8a1489dab75b", "fix": {"template": null, "available": false}, "title": "Floating pragma version - pin to a specific version for production", "ruleId": "rules.sol-floating-pragma", "snippet": {"code": "pragma solidity ^0.4.0;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/mishandled.sol", "line": 7, "column": 1}, "severity": "info", "references": [], "description": ""}, {"id": "c3d582ba0470", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity ^0.4.0;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/mishandled.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "eb860ae265cf", "fix": {"template": null, "available": false}, "title": "Function missing explicit visibility specifier", "ruleId": "rules.sol-missing-visibility", "snippet": {"code": "    function withdrawBalance() {  \n\t\tuint amountToWithdraw = userBalances[msg.sender];\n\t\tuserBalances[msg.sender] = 0;\n        // <yes> <report> UNCHECKED_LL_CALLS\n\t\tmsg.sender.send(amountToWithdraw);\n\t}", "highlightLines": [10]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/mishandled.sol", "line": 10, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "1561b833ec2b", "fix": {"template": null, "available": false}, "title": "SWC-108: State variable missing explicit visibility specifier", "ruleId": "rules.sol-swc-108-state-visibility", "snippet": {"code": "\t\tuint amountToWithdraw = userBalances[msg.sender];", "highlightLines": [11]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/mishandled.sol", "line": 11, "column": 1}, "severity": "info", "references": ["https://swcregistry.io/docs/SWC-108"], "description": ""}, {"id": "e2206e2bdfe3", "fix": {"template": null, "available": false}, "title": "Reward calculation before state update - stale rewards possible", "ruleId": "rules.sol-reward-before-update", "snippet": {"code": "\t\tuint amountToWithdraw = userBalances[msg.sender];\n\t\tuserBalances[msg.sender] = 0;", "highlightLines": [11]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/mishandled.sol", "line": 11, "column": 3}, "severity": "medium", "references": [], "description": ""}, {"id": "ac602e2c8b24", "fix": {"template": null, "available": false}, "title": "send() return value not checked - silent failure", "ruleId": "rules.sol-send-without-check", "snippet": {"code": "\t\tmsg.sender.send(amountToWithdraw);", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/mishandled.sol", "line": 14, "column": 3}, "severity": "high", "references": [], "description": ""}, {"id": "81609eb200ad", "fix": {"template": null, "available": false}, "title": "send() return value not checked - Ether may be stuck if recipient reverts", "ruleId": "rules.sol-unchecked-send-return", "snippet": {"code": "\t\tmsg.sender.send(amountToWithdraw);", "highlightLines": [14]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/mishandled.sol", "line": 14, "column": 13}, "severity": "high", "references": [], "description": ""}, {"id": "43de3dfad770", "fix": {"template": null, "available": false}, "title": "SWC-102: Using outdated Solidity compiler version with known vulnerabilities", "ruleId": "rules.sol-swc-102-outdated-compiler", "snippet": {"code": "pragma solidity 0.4.25;", "highlightLines": [7]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/unchecked_return_value.sol", "line": 7, "column": 1}, "severity": "medium", "references": ["https://swcregistry.io/docs/SWC-102"], "description": ""}, {"id": "e6e07ea29f2b", "fix": {"template": null, "available": false}, "title": "require() without error message - harder to debug failures", "ruleId": "rules.sol-require-without-message", "snippet": {"code": "    require(callee.call());", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/unchecked_return_value.sol", "line": 12, "column": 5}, "severity": "info", "references": [], "description": ""}, {"id": "c19d56cc3099", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "    require(callee.call());", "highlightLines": [12]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/unchecked_return_value.sol", "line": 12, "column": 13}, "severity": "medium", "references": [], "description": ""}, {"id": "cb6e147fb217", "fix": {"template": null, "available": false}, "title": "Low-level call without contract existence check - call to empty address returns success", "ruleId": "rules.sol-contract-existence-check", "snippet": {"code": "    callee.call();", "highlightLines": [17]}, "category": "code", "location": {"file": "dataset/unchecked_low_level_calls/unchecked_return_value.sol", "line": 17, "column": 5}, "severity": "medium", "references": [], "description": ""}, {"id": "58cf60545613", "fix": {"template": null, "available": false}, "title": "parseInt without radix parameter - specify base to avoid unexpected behavior", "ruleId": "rules.parseint-radix-missing", "snippet": {"code": "                        if((parseInt(lines[index]) + 1) === parseInt(lines[index + 1])){", "highlightLines": [59]}, "category": "code", "location": {"file": "scripts/get_vulns_lines.js", "line": 59, "column": 29}, "severity": "info", "references": [], "description": ""}, {"id": "6da3206d44d0", "fix": {"template": null, "available": false}, "title": "parseInt without radix parameter - specify base to avoid unexpected behavior", "ruleId": "rules.parseint-radix-missing", "snippet": {"code": "                            while((parseInt(lines[index]) + 1) === parseInt(lines[index + 1])){", "highlightLines": [60]}, "category": "code", "location": {"file": "scripts/get_vulns_lines.js", "line": 60, "column": 36}, "severity": "info", "references": [], "description": ""}, {"id": "201b34444913", "fix": {"template": null, "available": false}, "title": "parseInt without radix parameter - specify base to avoid unexpected behavior", "ruleId": "rules.parseint-radix-missing", "snippet": {"code": "                                vuln_flow.push(parseInt(lines[index]))", "highlightLines": [61]}, "category": "code", "location": {"file": "scripts/get_vulns_lines.js", "line": 61, "column": 48}, "severity": "info", "references": [], "description": ""}, {"id": "efc13a207503", "fix": {"template": null, "available": false}, "title": "parseInt without radix parameter - specify base to avoid unexpected behavior", "ruleId": "rules.parseint-radix-missing", "snippet": {"code": "                            vuln_flow.push(parseInt(lines[index]))", "highlightLines": [64]}, "category": "code", "location": {"file": "scripts/get_vulns_lines.js", "line": 64, "column": 44}, "severity": "info", "references": [], "description": ""}, {"id": "5bcc34afbdf8", "fix": {"template": null, "available": false}, "title": "parseInt without radix parameter - specify base to avoid unexpected behavior", "ruleId": "rules.parseint-radix-missing", "snippet": {"code": "                            vuln_flow.push(parseInt(lines[index]))", "highlightLines": [72]}, "category": "code", "location": {"file": "scripts/get_vulns_lines.js", "line": 72, "column": 44}, "severity": "info", "references": [], "description": ""}, {"id": "99e92a85da7e", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "token = HumanStandardToken(_token);", "highlightLines": [405]}, "category": "secrets", "location": {"file": "dataset/reentrancy/spank_chain_payment.sol", "line": 405}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "6ed6c84565b6", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "secret = _secret;", "highlightLines": [60]}, "category": "secrets", "location": {"file": "dataset/unchecked_low_level_calls/0xb620cee6b52f96f3c6b253e6eea556aa2d214a99.sol", "line": 60}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "a0e59746617a", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "secret = uint256(hash);", "highlightLines": [87]}, "category": "secrets", "location": {"file": "dataset/unchecked_low_level_calls/0xb620cee6b52f96f3c6b253e6eea556aa2d214a99.sol", "line": 87}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}, {"id": "682f79af6189", "fix": {"template": "Move to environment variable and rotate the exposed secret immediately", "available": true}, "title": "Exposed Secret: Generic Secret Assignment in Config", "ruleId": "gitleaks-generic-secret-assignment", "snippet": {"code": "token = Token(_token);", "highlightLines": [54]}, "category": "secrets", "location": {"file": "dataset/unchecked_low_level_calls/0xec329ffc97d75fe03428ae155fc7793431487f63.sol", "line": 54}, "severity": "critical", "description": "Found generic-secret-assignment in source code"}]}]